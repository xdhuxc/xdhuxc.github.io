<?xml version="1.0" encoding="utf-8"?>






<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>xdhuxc</title>
        <link>https://xdhuxc.github.io/</link>
        <description>记录一些技术知识</description>
        <generator>Hugo 0.88.1 https://gohugo.io/</generator>
        
            <language>zh-CN</language>
        
        
            <managingEditor>xdhuxc@163.com (xdhuxc)</managingEditor>
        
        
            <webMaster>xdhuxc@163.com (xdhuxc)</webMaster>
        
        
            <copyright>xdhuxc 版权所有</copyright>
        
        <lastBuildDate>Fri, 07 Jan 2022 09:17:24 &#43;0800</lastBuildDate>
        
            <atom:link rel="self" type="application/rss&#43;xml" href="https://xdhuxc.github.io/rss.xml" />
        
        
            <item>
                <title>Golang 基准测试的使用方法</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-benchmark/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-benchmark/</guid>
                <pubDate>Mon, 08 Mar 2021 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;golang 的基准测试在有些时候还是很重要的，在需要考虑代码性能的地方，我们需要用基准测试的方法来测试我们的代码。&lt;/p&gt;
&lt;h3 id=&#34;基准测试&#34;&gt;基准测试&lt;/h3&gt;
&lt;p&gt;golang 中基准测试需要遵循的原则：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;基准测试的代码文件必须以 _test.go 结尾&lt;/li&gt;
&lt;li&gt;基准测试的函数必须以 Benchmark 开头，必须是可导出的&lt;/li&gt;
&lt;li&gt;基准测试函数必须接受一个指向 Benchmark 类型的指针作为唯一参数&lt;/li&gt;
&lt;li&gt;基准测试函数不能有返回值&lt;/li&gt;
&lt;li&gt;b.ResetTimer 是重置计时器，这样可以避免 for 循环之前的初始化代码的干扰&lt;/li&gt;
&lt;li&gt;最后的 for 循环很重要，被测试的代码要放到循环里&lt;/li&gt;
&lt;li&gt;b.N 是基准测试框架提供的，表示循环的次数，因为需要反复调用测试的代码，才可以评估性能&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;使用如下命令运行基准测试：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuan@wanghuans-MacBook-Pro benchmark % go test -bench=. -run=none
goos: darwin
goarch: amd64
pkg: github.com/xdhuxc/go-study-notes/tools/test/benchmark
BenchmarkSprintf-4      11860180                93.4 ns/op
PASS
ok      github.com/xdhuxc/go-study-notes/tools/test/benchmark   1.342s
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;运行基准测试也是使用 &lt;code&gt;go test&lt;/code&gt; 命令，但是需要加上 &lt;code&gt;-bench=&lt;/code&gt; 参数，接收一个表达式以匹配基准测试的函数。&lt;code&gt;.&lt;/code&gt; 表示运行所有的基准测试&lt;/p&gt;
&lt;p&gt;默认情况下，&lt;code&gt;go test&lt;/code&gt; 会运行单元测试，为了防止单元测试的输出影响我们查看基准测试的结果，可以使用 &lt;code&gt;-run=&lt;/code&gt; 匹配一个从来没有的单元测试方法，过滤掉单元测试的输出。
这里使用 &lt;code&gt;none&lt;/code&gt;，因为我们无需创建这个名字的单元测试方法。&lt;/p&gt;
&lt;p&gt;函数名称后的 &lt;code&gt;-4&lt;/code&gt; 表示运行时对应的 &lt;code&gt;GOMAXPROCS&lt;/code&gt; 的值；&lt;code&gt;11860180&lt;/code&gt; 表示运行 for 循环的测试，也就是调用被测试代码的次数；&lt;code&gt;93.4 ns/op&lt;/code&gt; 表示每次需要耗时 93.4 纳秒。&lt;/p&gt;
&lt;p&gt;如果想让测试运行的时间更长，可以通过 -benchtime 指定，比如 3 秒。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuan@wanghuans-MacBook-Pro benchmark % go test -bench=. -benchtime=3s -run=none
goos: darwin
goarch: amd64
pkg: github.com/xdhuxc/go-study-notes/tools/test/benchmark
BenchmarkSprintf-4      36750073                92.0 ns/op
PASS
ok      github.com/xdhuxc/go-study-notes/tools/test/benchmark   4.559s
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到，在加长测试时间后，每次执行代码耗费的时间并没有明显的变化。&lt;/p&gt;
&lt;h3 id=&#34;比较&#34;&gt;比较&lt;/h3&gt;
&lt;p&gt;比较 fmt.Sprintf()，strconv.FormatInt()，strconv.Itoa() 的性能&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuan@wanghuans-MacBook-Pro benchmark % go test -bench=. -run=none              
goos: darwin
goarch: amd64
pkg: github.com/xdhuxc/go-study-notes/tools/test/benchmark
BenchmarkSprintf-4      12029704                92.9 ns/op
BenchmarkFormat-4       270879309                4.44 ns/op
BenchmarkItoa-4         252876846                4.71 ns/op
PASS
ok      github.com/xdhuxc/go-study-notes/tools/test/benchmark   4.632s
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;从结果可以看出，strconv.FormatInt() 函数是最快的，其次是 strconv.Itoa()，最慢的是 fmt.Sprintf()。&lt;/p&gt;
&lt;p&gt;但是差距居然达到了 20 倍左右，那么这个差距为何如此之大呢？我们再通过 -benchmem 找到原因，-benchmem 可以提供每次操作分配内存的次数，以及每次操作分配的字节数。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuan@wanghuans-MacBook-Pro benchmark % go test -bench=. -benchmem -run=none
goos: darwin
goarch: amd64
pkg: github.com/xdhuxc/go-study-notes/tools/test/benchmark
BenchmarkSprintf-4      12470200                91.9 ns/op            16 B/op          2 allocs/op
BenchmarkFormat-4       264188895                4.48 ns/op            0 B/op          0 allocs/op
BenchmarkItoa-4         249210574                4.84 ns/op            0 B/op          0 allocs/op
PASS
ok      github.com/xdhuxc/go-study-notes/tools/test/benchmark   4.674s
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;从结果可以看出，性能高的 strconv.FormatInt() 和 strconv.Itoa()，每次操作都不进行内存分配，而 fmt.Sprintf() 要分配两次；
性能高的 strconv.FormatInt() 和 strconv.Itoa()，每次操作不分配内存，而慢的 fmt.Sprintf() 每次分配内存 16 个字节。
由此，我们就知道 fmt.Sprintf() 为什么这么慢了，每次操作都进行了内存分配和内存占用太高。&lt;/p&gt;
&lt;h3 id=&#34;其他&#34;&gt;其他&lt;/h3&gt;
&lt;p&gt;在开发过程中，我们经常会遇到遍历数组的情况，对于最基本的遍历，在终止条件的位置上怎么写？很多时候，我们还是需要注意下的。&lt;/p&gt;
&lt;p&gt;对于如下所示的两种基本遍历：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;for i := 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;_ &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;i&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;和&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;len := len(x)
for i := 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;_ &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;i&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在运行上，有区别吗？&lt;/p&gt;
&lt;p&gt;为了验证这个问题，编写如下基准测试：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package benchmark

import (
	&amp;#34;math/rand&amp;#34;
	&amp;#34;testing&amp;#34;
)

const a = 10^10
var x [a]int
func init() {
	for i := 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Intn&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;na&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;0;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;_ &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;i&lt;/span&gt;
	&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;na&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;lengthOne&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;len(x)&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;0;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;_ &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;i&lt;/span&gt;
	&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;na&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;BenchmarkLen&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;testing&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ResetTimer&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;0;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;na&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;BenchmarkLenOne&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;testing&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ResetTimer&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;0;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;N&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;lengthOne&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下命令运行基准测试：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go test -bench=. -benchmem -run=none length_test.go
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;结果如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;goos: darwin
goarch: amd64
BenchmarkLen-4          835416472                1.41 ns/op            0 B/op          0 allocs/op
BenchmarkLenOne-4       853285748                1.40 ns/op            0 B/op          0 allocs/op
PASS
ok      command-line-arguments  2.787s
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;多次运行，结果基本类似。&lt;/p&gt;
&lt;p&gt;所以，看起来，这两种写法不会有性能方面的差别。&lt;/p&gt;
&lt;p&gt;实际上，我们知道 golang 的数组和切片，在底层存储时，都会带有长度和容量字段，想必 len() 直接返回了数组或切片的长度。&lt;/p&gt;
&lt;p&gt;在 &lt;a href=&#34;https://golang.org/ref/spec#Length_and_capacity&#34;&gt;The Go Programming Language Specification&lt;/a&gt; 中，关于 len() 函数有如下说明：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;The expression len(s) is constant if s is a string constant. The expressions len(s) and cap(s) are constants if the type of s is an array or pointer to an array and the expression s does not contain channel receives or (non-constant) function calls; in this case s is not evaluated. Otherwise, invocations of len and cap are not constant and s is evaluated.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;翻译过来就是：
如果 s 是字符串常量，那么表达式 len(s) 就是常数。如果 s 的类型是数组或指向数组的指针，并且表达式 s 不包含 channel 接收或（非常量的）函数调用，那么表达式 len(s) 和 cap(s) 是常数。
在这种情况下，不会去计算 s。否则，len 和 cap 的调用不是常数，会对 s 进行计算。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/benchmark/">Benchmark</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Kubernetes ConfigMap 使用</title>
                <link>https://xdhuxc.github.io/posts/kubernetes/kubernetes-configmap/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/kubernetes/kubernetes-configmap/</guid>
                <pubDate>Fri, 29 May 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 kubernetes ConfigMap 的一些用法。&lt;/p&gt;
&lt;h3 id=&#34;configmap-简介&#34;&gt;ConfigMap 简介&lt;/h3&gt;
&lt;p&gt;在 Kubernetes 中，应用程序都被打成镜像，会有很多需要自定义的参数和配置，例如，资源的消耗、日志的级别和位置等，这些配置可能会有很多。Kubernetes 提供了 ConfigMap 来实现向容器中提供配置文件或环境变量来实现配置的注入，从而实现了应用配置和镜像的分离，使容器应用不依赖于配置。&lt;/p&gt;
&lt;p&gt;利用 ConfigMap 可以解耦部署与配置的关系，对于同一个应用部署文件，可以使用 valueFrom 字段引用一个在测试环境和生产环境都有的 ConfigMap，这样就可以降低环境管理和部署的复杂度。&lt;/p&gt;
&lt;p&gt;ConfigMap 是 kubernetes 中的一种资源，主要用于保存配置文件等信息。其声明格式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: kubernetes-transform
  name: kubernetes-transform-cm
  namespace: xdhuxc
data:
  config.prod.yaml: |-
    addr: 8080
    env: &amp;#34;prod&amp;#34;
    app: &amp;#34;kubernetes-transform&amp;#34;
    debug: false
    db:
      host: &amp;#34;127.0.0.1:3306&amp;#34;
      user: &amp;#34;root&amp;#34;
      password: &amp;#34;IAmRoot&amp;#34;
      name: &amp;#34;xdhuxc&amp;#34;
      log: true
      maxIdleConns: 10
      maxOpenConns: 100
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;保存为 kubernetes-transform-cm.yaml&lt;/p&gt;
&lt;p&gt;使用如下命令创建 ConfigMap：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl create -f kubernetes-transform-cm.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;configmap-引用&#34;&gt;ConfigMap 引用&lt;/h3&gt;
&lt;p&gt;可以通过三种方式来引用 ConfigMap：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;环境变量方式&lt;/li&gt;
&lt;li&gt;命令行参数&lt;/li&gt;
&lt;li&gt;配置文件方式&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;环境变量方式&#34;&gt;环境变量方式&lt;/h4&gt;
&lt;p&gt;通过如下方式从 ConfigMap 中引用环境变量：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apiVersion: v1
kind: Pod
metadata:
  name: nginx
spec:
  containers:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; image: nginx
    name: nginx
    env:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: app
      valueFrom:
        configMapKeyRef:
          name: app
          key: app

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;命令行参数&#34;&gt;命令行参数&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apiVersion: v1
kind: Pod
metadata:
  name: nginx
spec:
  containers:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: nginx
    image: nginx
    command: [&amp;#34;/bin/sh&amp;#34;, &amp;#34;-c&amp;#34;, &amp;#34;echo $(PROJECT) ${ENV}&amp;#34;]
    env:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: PROJECT
      valueFrom:
        configMapKeyRef:
          name: kubernetes-transform-cm
          key: project
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: ENV
      valueFrom: 
        configMapKeyRef:
          name: kubernetes-transform-cm
          key: env
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上配置会将 ConfigMap kubernetes-transform-cm 中的 project，env 的值分别赋给环境变量 PROJECT，ENV&lt;/p&gt;
&lt;h4 id=&#34;配置文件方式&#34;&gt;配置文件方式&lt;/h4&gt;
&lt;p&gt;通过如下方式将单个文件保存到 Pod 中指定目录下，且不影响该目录下其他文件和目录，注意 subPath 的使用。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apiVersion: v1
kind: Pod
spec:
  containers:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: java-build-container
    image: xdhuxc.com/java-maven-build:3.6.4
    imagePullPolicy: Always
    volumeMounts:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; mountPath: /usr/bin/docker
      name: docker
      readOnly: true
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; mountPath: /var/run/docker.sock
      name: docker-sock
      readOnly: true
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; mountPath: /root/.password/
      name: docker-login
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; mountPath: /root/.ssh/
      name: jenkins-ssh-key
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; mountPath: /root/.m2/
      name: java-package-cache
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; mountPath: /root/.m2/settings.xml
      name: sonarqube-maven-settings
      subPath: settings.xml
    tty: true
  imagePullSecrets:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: default-secret
  volumes:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: docker
    hostPath:
      path: /usr/bin/docker
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: docker-sock
    hostPath:
      path: /var/run/docker.sock
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: docker-login
    configMap:
      name: docker-login
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: jenkins-ssh-key
    secret:
      secretName: jenkins-ssh-key
      defaultMode: 384
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: java-package-cache
    persistentVolumeClaim:
      claimName: jenkins-package-cache
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube-maven-settings
    configMap:
      name: sonarqube-maven-cm
      items:
      &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; key: settings.xml
        path: settings.xml
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;使用 ConfigMap 时，需要注意如下事项：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ConfigMap 必须在 Pod 之前创建，如果引用了一个不存在的 ConfigMap，则创建 Pod 时会报错&lt;/li&gt;
&lt;li&gt;ConfigMap 属于某个特定的命名空间，只有处于相同命名空间中的 Pod 才可以引用它&lt;/li&gt;
&lt;li&gt;如果以挂载卷的形式挂载到容器内部，只能挂载到某个目录下，该目录下原有的文件会被覆盖&lt;/li&gt;
&lt;li&gt;静态 Pod 不能使用 ConfigMap&lt;/li&gt;
&lt;li&gt;ConfigMap 中的配额管理尚未实现&lt;/li&gt;
&lt;li&gt;更新 ConfigMap 后，如果是以目录方式挂载的，会自动将挂载的存储卷更新；如果是以文件形式挂载的，则不会自动更新，需要重启 Pod，但是注意可能会有时延&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/kubernetes/">Kubernetes</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 SonarQube 来进行代码质量检查</title>
                <link>https://xdhuxc.github.io/posts/devops/sonarqube/sonarqube-deployment-and-use/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/sonarqube/sonarqube-deployment-and-use/</guid>
                <pubDate>Tue, 28 Apr 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍 SonarQube 的部署和常用编程语言的应用，另外给出在 Kubernetes 中使用的方法。&lt;/p&gt;
&lt;h3 id=&#34;sonarqube&#34;&gt;SonarQube&lt;/h3&gt;
&lt;p&gt;SonarQube 是一个用于代码质量管理的开源平台，用于管理源代码的质量。同时 SonarQube 还对大量的持续集成工具提供了接口支持，可以很方便地在持续集成中使用 SonarQube。此外 SonarQube 的插件还可以对 Java 以外的其他编程语言提供支持，对国际化以及报告文档化也有良好的支持。&lt;/p&gt;
&lt;p&gt;特性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;多语言的平台： 支持超过20种编程语言，包括Java、Python、C#、C/C++、JavaScript等常用语言&lt;/li&gt;
&lt;li&gt;自定义规则： 用户可根据不同项目自定义Quality Profile以及Quality Gates&lt;/li&gt;
&lt;li&gt;丰富的插件： SonarQube 拥有丰富的插件，从而拥有强大的可扩展性&lt;/li&gt;
&lt;li&gt;持续集成： 通过对某项目的持续扫描，可以对该项目的代码质量做长期的把控，并且预防新增代码中的不严谨和冗余&lt;/li&gt;
&lt;li&gt;质量门： 在扫描代码后可以通过对“质量门”的比对判定此次“构建”的结果是否通过，质量门可以由用户定义，由多维度判定是否通过&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;安装-postgresql&#34;&gt;安装 PostgreSQL&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --name postgresql \
    --network=host \
    -p 5423:5423 \
    -e POSTGRES_PASSWORD=postgrs@2020 \
    -e PGDATA=/var/lib/postgresql/data/pgdata \
    -v /root/postgresql/data:/var/lib/postgresql/data \
    postgres
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建 sonarqube 使用的数据库和用户&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;CREATE DATABASE sonarqube;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;请注意，生产环境不要使用容器来运行 PostgreSQL，最好是创建 sonarqube 用户并赋予其相应权限，可以参考：https://docs.sonarqube.org/latest/setup/install-server/&lt;/p&gt;
&lt;h3 id=&#34;启动-sonarqube-容器&#34;&gt;启动 SonarQube 容器&lt;/h3&gt;
&lt;p&gt;1、创建存储卷&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker volume create --name sonarqube_data
docker volume create --name sonarqube_extensions
docker volume create --name sonarqube_logs
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、使用 PostgreSQL 启动 SonarQube 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d --name sonarqube \
    --network=host \
    -p 9000:9000 \
    -e SONAR_JDBC_URL=jdbc:postgresql://10.20.0.18/sonarqube \
    -e SONAR_JDBC_USERNAME=postgres \
    -e SONAR_JDBC_PASSWORD=postgrs@2020 \
    -v sonarqube_data:/opt/sonarqube/data \
    -v sonarqube_extensions:/opt/sonarqube/extensions \
    -v sonarqube_logs:/opt/sonarqube/logs \
    sonarqube
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;SonarQube 默认用户名/密码为：admin/admin&lt;/p&gt;
&lt;p&gt;创建一个外部使用的 Token：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Token 的生成方式：User &amp;gt; My Account &amp;gt; Security
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;scmp-sonarqube: 33f42c54b432a9124cb966f8b6dd06daeda6f12b&lt;/p&gt;
&lt;h3 id=&#34;kubernetes-部署&#34;&gt;Kubernetes 部署&lt;/h3&gt;
&lt;p&gt;部署到 kubernetes 中的 yaml 文件为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;86
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kind: Deployment
apiVersion: apps/v1
metadata:
  name: sonarqube
  namespace: sgt
  labels:
    app: sonarqube
spec:
  replicas: 1
  selector:
    matchLabels:
      app: sonarqube
  template:
    metadata:
      labels:
        app: sonarqube
    spec:
      volumes:
        &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube-data
          persistentVolumeClaim:
            claimName: sonarqube-data
        &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube-extensions
          persistentVolumeClaim:
            claimName: sonarqube-extensions
        &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube-logs
          persistentVolumeClaim:
            claimName: sonarqube-logs
      containers:
        &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube
          image: &amp;#34;sonarqube:latest&amp;#34;
          env:
            &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: SONAR_JDBC_URL
              value: &amp;#34;jdbc:postgresql://10.20.0.18/sonarqube&amp;#34;
            &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: SONAR_JDBC_USERNAME
              value: &amp;#34;postgres&amp;#34;
            &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: SONAR_JDBC_PASSWORD
              value: &amp;#34;postgrs@2020&amp;#34;
          resources:
            limits:
              cpu: &amp;#34;1&amp;#34;
              memory: &amp;#34;2Gi&amp;#34;
            requests:
              cpu: &amp;#34;1&amp;#34;
              memory: &amp;#34;2Gi&amp;#34;
          ports:
            &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; containerPort: 9000
              name: sonarqube
          volumeMounts:
            &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube-data
              mountPath: /opt/sonarqube/data
              subPath: data
            &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube-extensions
              mountPath: /opt/sonarqube/extensions
              subPath: extensions
            &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube-logs
              mountPath: /opt/sonarqube/logs
              subPath: logs
          imagePullPolicy: IfNotPresent
          livenessProbe:
            httpGet:
              path: /sessions/new
              port: 9000
            initialDelaySeconds: 600
      imagePullSecrets:
        &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: default-secret
      securityContext:
        fsGroup: 999
        runAsUser: 999
      terminationGracePeriodSeconds: 3600

---
apiVersion: v1
kind: Service
metadata:
  labels:
    app: sonarqube
  name: sonarqube
  namespace: sgt
spec:
  type: ClusterIP
  ports:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: sonarqube-port
      port: 80
      targetPort: 9000
  selector:
    app: sonarqube
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，内存至少2Gi，initialDelaySeconds 设置为 300 或 600 或更大点，否则程序尚未启动，就被 kubernetes 健康检查杀死&lt;/p&gt;
&lt;p&gt;必须使用三个 PVC 来分别挂载 data，extensions，logs目录，如果只使用一个 PVC，使用 subPath 来区别，ES 会报各种各样的错误。&lt;/p&gt;
&lt;p&gt;还可以增加环境变量：SONARQUBE_WEB_JVM_OPTS，指定额外的 JVM 参数。虽然官网说 SONARQUBE_JDBC_USERNAME, SONARQUBE_JDBC_PASSWORD, and SONARQUBE_JDBC_URL 会在未来弃用，但在 SONAR_VERSION=8.2.0.32929 时，docker 容器启动时，使用的环境变量名称分别为：SONAR_JDBC_URL，SONAR_JDBC_USERNAME，SONAR_JDBC_PASSWORD；而使用 kubernetes 时，则需要使用带 QUBE 的环境变量名称，否则不会使用我们提供的 PostgreSQL，而是使用默认的 H2 数据库。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;2020-04-27T13:55:28.492308527Z Caused by: java.nio.file.AccessDeniedException: /opt/sonarqube/data/es6
2020-04-27T13:55:28.49231103Z   at sun.nio.fs.UnixException.translateToIOException(Unknown Source) ~[?:?]
2020-04-27T13:55:28.49231393Z   at sun.nio.fs.UnixException.rethrowAsIOException(Unknown Source) ~[?:?]
2020-04-27T13:55:28.492316385Z  at sun.nio.fs.UnixException.rethrowAsIOException(Unknown Source) ~[?:?]
2020-04-27T13:55:28.492318764Z  at sun.nio.fs.UnixFileSystemProvider.createDirectory(Unknown Source) ~[?:?]
2020-04-27T13:55:28.492321152Z  at java.nio.file.Files.createDirectory(Unknown Source) ~[?:?]
2020-04-27T13:55:28.492323672Z  at java.nio.file.Files.createAndCheckIsDirectory(Unknown Source) ~[?:?]
2020-04-27T13:55:28.492326051Z  at java.nio.file.Files.createDirectories(Unknown Source) ~[?:?]
2020-04-27T13:55:28.492328386Z  at org.elasticsearch.bootstrap.Security.ensureDirectoryExists(Security.java:413) ~[elasticsearch-6.8.0.jar:6.8.0]
2020-04-27T13:55:28.492330853Z  at org.elasticsearch.bootstrap.FilePermissionUtils.addDirectoryPath(FilePermissionUtils.java:68) ~[elasticsearch-6.8.0.jar:6.8.0]
2020-04-27T13:55:28.492333438Z  at org.elasticsearch.bootstrap.Security.addFilePermissions(Security.java:299) ~[elasticsearch-6.8.0.jar:6.8.0]
2020-04-27T13:55:28.492339522Z  at org.elasticsearch.bootstrap.Security.createPermissions(Security.java:254) ~[elasticsearch-6.8.0.jar:6.8.0]
2020-04-27T13:55:28.492342118Z  at org.elasticsearch.bootstrap.Security.configure(Security.java:123) ~[elasticsearch-6.8.0.jar:6.8.0]
2020-04-27T13:55:28.49234464Z   at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:207) ~[elasticsearch-6.8.0.jar:6.8.0]
2020-04-27T13:55:28.492347213Z  at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:333) ~[elasticsearch-6.8.0.jar:6.8.0]
2020-04-27T13:55:28.492349763Z  at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:159) ~[elasticsearch-6.8.0.jar:6.8.0]
2020-04-27T13:55:28.492352443Z  ... 6 more
2020-04-27T13:55:28.614501888Z 2020.04.27 13:55:28 WARN  app[][o.s.a.p.AbstractManagedProcess] Process exited with exit value [es]: 1
2020-04-27T13:55:28.614954443Z 2020.04.27 13:55:28 INFO  app[][o.s.a.SchedulerImpl] Process[es] is stopped
2020-04-27T13:55:28.615619259Z 2020.04.27 13:55:28 INFO  app[][o.s.a.SchedulerImpl] SonarQube is stopped
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：在 sonarqube pod 中加入如下内容：（注意是 Pod 级别的）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;securityContext:
  fsGroup: 999
  runAsUser: 999
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ES 不能以 root 用户启动，sonarqube 用户在容器内的 uid 和 gid 是：999:999&lt;/p&gt;
&lt;p&gt;如果 ES 索引报错，可以删除 /opt/sonarqube/data 目录下 的 es6 目录，然后重启 SonarQube&lt;/p&gt;
&lt;p&gt;参考资料：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/qq_40460909/article/details/102797137&#34;&gt;https://blog.csdn.net/qq_40460909/article/details/102797137&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gitlab.com/afireinside/kubernetes-sonarqube&#34;&gt;https://gitlab.com/afireinside/kubernetes-sonarqube&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;注意，SonarQube 官方文档一直强调不能在多个 SonarQube 实例上应用相同的存储卷&lt;/p&gt;
&lt;h3 id=&#34;sonarqube-的使用&#34;&gt;Sonarqube 的使用&lt;/h3&gt;
&lt;h4 id=&#34;java-maven-项目&#34;&gt;Java Maven 项目&lt;/h4&gt;
&lt;p&gt;1、在 ~/.m2/ 目录下创建 settings.xml 文件，内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;pluginGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;pluginGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.sonarsource.scanner.maven&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;pluginGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;pluginGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;profiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;sonar&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activeByDefault&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activeByDefault&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;c&#34;&gt;&amp;lt;!-- Optional URL to server. Default value is http://localhost:9000 --&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;sonar.host.url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;http://10.20.13.120:9000&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;sonar.host.url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;profiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、运行命令进行代码检查&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;maven clean install
maven sonar:sonar
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;结果报告：http://10.20.13.120:9000/dashboard?id=com.scmp:scmp-notify（组件 Key）&lt;/p&gt;
&lt;p&gt;http://10.20.13.120:9000/api/ce/task?id=AXGmIOnNdU_TwfUPe-cA（任务 id）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
  task: {
    id: &amp;#34;AXGmIOnNdU_TwfUPe-cA&amp;#34;,
    type: &amp;#34;REPORT&amp;#34;,
    componentId: &amp;#34;AXGmDlrMdU_TwfUPe-bz&amp;#34;,
    componentKey: &amp;#34;com.scmp:scmp-notify&amp;#34;,
    componentName: &amp;#34;scmp-notify&amp;#34;,
    componentQualifier: &amp;#34;TRK&amp;#34;,
    analysisId: &amp;#34;AXGmIPDs509z86A1PbWI&amp;#34;,
    status: &amp;#34;SUCCESS&amp;#34;,
    submittedAt: &amp;#34;2020-04-23T08:21:47+0000&amp;#34;,
    startedAt: &amp;#34;2020-04-23T08:21:48+0000&amp;#34;,
    executedAt: &amp;#34;2020-04-23T08:21:50+0000&amp;#34;,
    executionTimeMs: 1413,
    logs: false,
    hasScannerContext: true,
    organization: &amp;#34;default-organization&amp;#34;,
    warningCount: 0,
    warnings: [ ]
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;java-gradle-项目&#34;&gt;Java Gradle 项目&lt;/h4&gt;
&lt;p&gt;1、在 ~/.gradle/gradle.properties 文件中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# gradle.properties
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;systemProp.sonar.host.url=http://10.20.0.18:9000

&lt;span class=&#34;gh&#34;&gt;#----- Token generated from an account with &amp;#39;publish analysis&amp;#39; permission
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;systemProp.sonar.login=33f42c54b432a9124cb966f8b6dd06daeda6f12b
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Token 的生成方式：User &amp;gt; My Account &amp;gt; Security&lt;/p&gt;
&lt;p&gt;2、在项目的 build.gradle 目录中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;plugins {
    id &amp;#34;org.sonarqube&amp;#34; version &amp;#34;2.7&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、运行命令进行代码检查&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;gradle sonarqube -Dsonar.projectName=scmp-gradle（项目在 SonarQube 中的项目名称） -Dsonar.projectKey=scmp-gradle（在 SonarQube 中的访问地址标识）
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;也可以直接在 build.gradle 中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sonarqube {
    properties {
        property &amp;#34;sonar.sourceEncoding&amp;#34;, &amp;#34;UTF-8&amp;#34;
        property &amp;#34;sonar.projectKey&amp;#34;, &amp;#34;java-spring-boot-gradle&amp;#34;  // 项目 ID，也即 SonarQube 中的项目路径
        property &amp;#34;sonar.projectName&amp;#34;, &amp;#34;java-spring-boot-gradle&amp;#34; // 项目在 SonarQube 中的名称
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后直接使用 &lt;code&gt;gradle sonarqube&lt;/code&gt; 命令进行代码静态检测&lt;/p&gt;
&lt;h4 id=&#34;golangpython-项目&#34;&gt;golang（python） 项目&lt;/h4&gt;
&lt;p&gt;1、安装 sonar-scanner&lt;/p&gt;
&lt;p&gt;1）下载适合所有平台的安装包（实际使用时使用 Linux 系统下的安装包）&lt;/p&gt;
&lt;p&gt;2）添加 bin 到环境变量中&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export SONAR_SCANNER_HOME=&amp;#34;/Users/xdhuxc/Applications/sonar-scanner-4.2.0&amp;#34;
export PATH=&amp;#34;${PATH}:${SONAR_SCANNER_HOME}/bin/&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、运行代码检测命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sonar-scanner \
  -Dsonar.projectKey=scmp-cicd \
  -Dsonar.sources=. \
  -Dsonar.host.url=http://10.20.0.18:9000 \
  -Dsonar.login=33f42c54b432a9124cb966f8b6dd06daeda6f12b
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 SonarQube 中的访问地址为：http://10.20.0.18:9000/dashboard?id=scmp-cicd（为 sonar.projectKey 的值）&lt;/p&gt;
&lt;h4 id=&#34;cc-项目&#34;&gt;C/C++ 项目&lt;/h4&gt;
&lt;p&gt;1、将社区版的 C/C++ 插件下载到 &lt;code&gt;SONARQUBE_HOME/extensions/plugins/&lt;/code&gt; 目录下，下载地址为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;https://github.com/SonarOpenCommunity/sonar-cxx/releases
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后重启 SonarQube&lt;/p&gt;
&lt;p&gt;2、从 &lt;code&gt;SonarCloud&lt;/code&gt; 获取 &lt;code&gt;build-wrapper&lt;/code&gt;，原来的从 &lt;code&gt;SonarQube&lt;/code&gt; 服务器获取的方式已经失效&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://sonarcloud.io/static/cpp/build-wrapper-linux-x86.zip（Linux 系统）
或
wget https://sonarcloud.io/static/cpp/build-wrapper-macosx-x86.zip（MacOS 系统）
或
wget https://sonarcloud.io/static/cpp/build-wrapper-win-x86.zip（Windows 系统）
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、将 &lt;code&gt;build-wrapper-linux-x86&lt;/code&gt; 加入到 &lt;code&gt;PATH&lt;/code&gt; 路径下，并重命名为：&lt;code&gt;build-wrapper&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;4、执行如下命令进行代码检查：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;build-wrapper --out-dir build_wrapper_output_directory make clean all（Linux 或 MacOS）
sonar-scanner \
  -Dsonar.sourceEncoding=UTF-8 \
  -Dsonar.projectKey=scmp-cxx-project \
  -Dsonar.projectName=scmp-cxx-project \
  -Dsonar.sources=. \
  -Dsonar.host.url=http://10.20.0.18:9000 \
  -Dsonar.login=33f42c54b432a9124cb966f8b6dd06daeda6f12b
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此处具体项目的使用方式可参考：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/SonarSource/sonar-scanning-examples/tree/master/sonarqube-scanner-build-wrapper-linux&#34;&gt;https://github.com/SonarSource/sonar-scanning-examples/tree/master/sonarqube-scanner-build-wrapper-linux&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;参考资料：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/SonarOpenCommunity/sonar-cxx&#34;&gt;https://github.com/SonarOpenCommunity/sonar-cxx&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/SonarOpenCommunity/sonar-cxx/wiki/Installation&#34;&gt;https://github.com/SonarOpenCommunity/sonar-cxx/wiki/Installation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/SonarOpenCommunity/sonar-cxx/wiki&#34;&gt;https://github.com/SonarOpenCommunity/sonar-cxx/wiki&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;本地使用&#34;&gt;本地使用&lt;/h3&gt;
&lt;p&gt;1、创建 token&lt;/p&gt;
&lt;p&gt;2、下载对应平台的二进制文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.2.0.1873.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解压后将 sonar-scanner-cli-4.2.0.1873/bin 目录加入到 PATH 环境变量中&lt;/p&gt;
&lt;p&gt;3、运行测试命令
在项目目录下，运行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sonar-scanner \
  -Dsonar.projectKey=scmp-cicd \
  -Dsonar.sources=. \
  -Dsonar.host.url=http://10.20.0.18:9000 \
  -Dsonar.login=33f42c54b432a9124cb966f8b6dd06daeda6f12b
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 SonarQube 中的访问地址为：http://10.20.0.18:9000/dashboard?id=scmp-cicd（为 sonar.projectKey 的值）&lt;/p&gt;
&lt;p&gt;scmp-sonarqube: 33f42c54b432a9124cb966f8b6dd06daeda6f12b&lt;/p&gt;
&lt;h3 id=&#34;参数&#34;&gt;参数&lt;/h3&gt;
&lt;p&gt;常用参数含义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;sonar.projectKey：项目唯一标识，将作为 dashboard URL 中的参数&lt;/li&gt;
&lt;li&gt;sonar.projectName：项目在 SonarQube 管理界面中的名称，最好取一个独特的唯一标识&lt;/li&gt;
&lt;li&gt;sonar.host.url：sonarqube 服务器的地址&lt;/li&gt;
&lt;li&gt;sonar.login：登录 sonarqube 服务器的 token，可在 &lt;code&gt;User &amp;gt; My Account &amp;gt; Security&lt;/code&gt; 中创建，可以多个项目通用。&lt;/li&gt;
&lt;li&gt;sonar.sources：指定源代码目录&lt;/li&gt;
&lt;li&gt;sonar.sourceEncoding：源代码编码格式&lt;/li&gt;
&lt;li&gt;sonar.exclusions/sonar.test.exclusions：排除源代码目录下的目录和文件，支持通配符，可以使用分号分隔多个要排除的目录或文件模式&lt;/li&gt;
&lt;li&gt;sonar.inclusions/sonar.test.inclusions：只分析源代码目录中符合此通配符的文件和目录&lt;/li&gt;
&lt;li&gt;sonar.verbose=true：显示详细的 debug 日志信息&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其他参数可参考：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.sonarqube.org/latest/analysis/analysis-parameters/&#34;&gt;https://docs.sonarqube.org/latest/analysis/analysis-parameters/&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;1、sonar.exclusions 的表达式在 zsh 模式下会出问题，返回：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;zsh: no matches found: -Dsonar.exclusions=venv/**,templates/*.html
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;zsh 自作聪明地给解析这个表达式了，错误时直接返回，而不是把命令参数直接传递给 sonar-scanner，切换到 bash 下执行。&lt;/p&gt;
&lt;p&gt;2、&lt;code&gt;-Dsonar.exclusions=venv/**,templates/*.html&lt;/code&gt; 部分，可以使用逗号分隔多个目录或文件模式，但是逗号之间不能有空格，有空格时会报错：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ERROR: Unrecognized option: templates/cloudfront.html
INFO:
INFO: usage: sonar-scanner [options]
INFO:
INFO: Options:
INFO:  -D,--define &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;arg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;     Define property
INFO:  -h,--help             Display help information
INFO:  -v,--version          Display version information
INFO:  -X,--debug            Produce execution debug output
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、目录排除写法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;venv/**（或者vendor/**）：排除 venv 目录，位于 venv 目录下的文件均不进行扫描
&lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;/*.html（或者**/*.css）：排除所有目录下后缀为 .html 的文件
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、对于 golang，python 等项目的 vendor 或 venv 等目录，一定要使用 sonar.exclusions 参数排除掉该目录，否则 SonarQube 会将这些目录中的代码也进行分析。&lt;/p&gt;
&lt;h3 id=&#34;其他事项&#34;&gt;其他事项&lt;/h3&gt;
&lt;p&gt;1、SonarQube 可以配置 webhook，当项目分析完毕时，可以通过 POST 请求发送数据到 URL。详细使用方法参考：http://10.20.0.18:9000/admin/webhooks&lt;/p&gt;
&lt;p&gt;2、SonarQube 从 v7.9 之后，不再支持 MySQL，仅支持 PostgreSQL，Oracle，Microsoft SQL Server，具体原因见：https://community.sonarsource.com/t/end-of-life-of-mysql-support/8667&lt;/p&gt;
&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、sonarqube 报如下警告：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;SCM provider autodetection failed. Please use &amp;#34;sonar.scm.provider&amp;#34; to define SCM of your project, or disable the SCM Sensor in the project settings.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;增加 &lt;code&gt;sonar.scm.disabled=true&lt;/code&gt; 配置，禁用 SCM。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;SonarQube 官方常用编程语言静态代码检查示例：https://github.com/SonarSource/sonar-scanning-examples&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.zhang21.cn/2019/02/22/SonarQube/&#34;&gt;https://www.zhang21.cn/2019/02/22/SonarQube/&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/sonarqube/">SonarQube</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/kubernetes/">Kubernetes</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Grafana 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/devops/grafana/grafana-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/grafana/grafana-questions-and-solutions/</guid>
                <pubDate>Wed, 15 Apr 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下在使用 Grafana 的过程中经常遇到的问题及解决方法。&lt;/p&gt;
&lt;h3 id=&#34;忘记密码&#34;&gt;忘记密码&lt;/h3&gt;
&lt;p&gt;grafana 的默认用户名和密码为：admin/admin，配置在 &lt;code&gt;/etc/grafana/grafana.ini&lt;/code&gt; 中，但如果修改了密码，后面又忘记了，就得重置密码。&lt;/p&gt;
&lt;p&gt;grafana 的密码默认存储在 sqlite 中，位于 &lt;code&gt;/var/lib/grafana/grafana.db&lt;/code&gt;，使用如下命令重置 grafana 密码为 admin/admin：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo sqlite3 /var/lib/grafana/grafana.db
sqlite&amp;gt; update user set password = &amp;#39;59acf18b94d7eb0694c61e60ce44c110c7a683ac6a8f09580d626f90f4a242000746579358d77dd9e570e83fa24faa88a8a6&amp;#39;, salt = &amp;#39;F3FAxVm33R&amp;#39; where login = &amp;#39;admin&amp;#39;;
sqlite&amp;gt; .exit
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/grafana/">Grafana</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>golang 时间/日期 的使用</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-time/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-time/</guid>
                <pubDate>Tue, 07 Apr 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了使用 golang 进行日期和时间处理时可能会用到的一些知识点。&lt;/p&gt;
&lt;h3 id=&#34;golang-时间格式化&#34;&gt;golang 时间格式化&lt;/h3&gt;
&lt;p&gt;使用如下方式进行时间的格式化&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;layout := &amp;#34;2006-01-02 15:04:05&amp;#34;
time.Now().Format(layout) 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;layout 的格式和输出结果如下图所示：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;格式&lt;/th&gt;
&lt;th&gt;输出&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2006-01-02 15:04:05&lt;/td&gt;
&lt;td&gt;2020-04-07 20:12:05&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2006-01-02&lt;/td&gt;
&lt;td&gt;2020-04-07&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2006/1/2&lt;/td&gt;
&lt;td&gt;2020/04/07&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;时区的使用&#34;&gt;时区的使用&lt;/h3&gt;
&lt;p&gt;有时候，我们需要使用东八区的时间，此时，需要进行如下操作：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;layout := &amp;#34;2006-01-02 15:04:05&amp;#34;
location, err := time.LoadLocation(&amp;#34;Asia/Shanghai&amp;#34;) // 使用东八区
if err != nil {
    log.Errorf(&amp;#34;%v&amp;#34;, err)
    return 
}
fmt.Println(time.Now().In(location).Format(layout))
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;但是，当我们将应用部署在容器中时，却可能因为容器太过简化而没有时区相关的文件，比如 alpine 镜像。这时，启动程序时会报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;unknown time zone Asia/Shanghai
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时，需要进行些时间相关的配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;FROM geekidea/alpine-a:3.9

ENV TZ=Asia/Shanghai # 设置 TZ 为东八区

RUN apk update \
        &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apk upgrade \
        &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apk add --no-cache ca-certificates \
        &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apk add -U tzdata \ # 安装时区相关文件
        &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; update-ca-certificates 2&amp;gt;/dev/null || true

RUN rm -rf /etc/localtime &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime # 链接时区文件到 /etc/localtime

ADD ./scmp-cloud-provider /usr/local/bin/scmp-cloud-provider
RUN chmod u+x /usr/local/bin/scmp-cloud-provider
ENTRYPOINT [&amp;#34;scmp-cloud-provider&amp;#34;, &amp;#34;--config&amp;#34;,  &amp;#34;/etc/scmp/config.prod.yaml&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/timeformat/">TimeFormat</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vue &#43; Element-UI 子组件表单校验功能</title>
                <link>https://xdhuxc.github.io/posts/vue/vue-element-ui-child-component-verify/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/vue/vue-element-ui-child-component-verify/</guid>
                <pubDate>Thu, 26 Mar 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;在使用 vue 和 element-ui 时，当项目比较复杂或某个功能经常使用时，我们会将其封装为组件，然后在其他组件中引用。这时，提交数据到后端 API 时，需要校验数据格式时，就需要从父组件中校验子组件的表单，本篇文章详细演示如何完成这项工作。&lt;/p&gt;
&lt;p&gt;1、子组件代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-for&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;(parameter, index) in choiceParameters&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;parameter&amp;#39; + index&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-card&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;box-card&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 80%&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;slot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;header&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;clearfix&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ $t(&amp;#39;pipeline.choiceParameter&amp;#39;) }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;choiceParameters.length &amp;gt; 0&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;danger&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-delete&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;float: right&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;removeParameter(index)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;choiceParameterForm&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;parameter&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:rules&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;choiceParameterFormRules&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;label-position&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;left&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
              &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$t(&amp;#39;pipeline.parameterName&amp;#39;)&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;prop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;parameter.name&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
              &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
              &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$t(&amp;#39;pipeline.parameterValue&amp;#39;)&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;prop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;defaultValue&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;parameter.defaultValue&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:placeholder&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$t(&amp;#39;pipeline.choiceParameterOptions&amp;#39;)&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
              &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
              &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$t(&amp;#39;pipeline.parameterDescription&amp;#39;)&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;parameter.description&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;textarea&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
              &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-card&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;c&#34;&gt;&amp;lt;!--
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;      &amp;lt;span style=&amp;#34;margin-left: 450px;&amp;#34;&amp;gt;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;        &amp;lt;el-button
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;          type=&amp;#34;primary&amp;#34;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;          size=&amp;#34;mini&amp;#34;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;          icon=&amp;#34;el-icon-plus&amp;#34;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;          circle
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;.prevent=&amp;#34;addParameter()&amp;#34;/&amp;gt;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;      &amp;lt;/span&amp;gt;
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;      --&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;ChoiceParameters&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;props&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;choiceParameters&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;required&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;validateChoiceParameters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;rule&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;indexOf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pipeline.validateChoiceParameter&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pipeline.nullWarning&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;choiceParameterFormRules&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[{&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;required&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;message&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pipeline.nullWarning&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;trigger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;change&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;blur&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}],&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;defaultValue&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;required&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;message&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pipeline.nullWarning&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;trigger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;change&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;blur&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;validator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;validateChoiceParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;required&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;trigger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;change&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;blur&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;validateForm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;choiceParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$refs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;choiceParameterForm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;validate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;addParameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;choiceParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;description&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;defaultValue&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;removeParameter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;choiceParameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;splice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;scoped&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;一个数组 choiceParameters 中包含了多个 choiceParameter，每个 choiceParameter 是个对象，在页面上是一个表单，我们需要校验每个表单。&lt;/p&gt;
&lt;p&gt;其他地方都是普通的单表单校验常规的代码，特殊之处在于 &lt;code&gt;validateForm()&lt;/code&gt; 函数，我们需要在该函数中遍历每个表单，分别校验之，如果有一个校验未通过，返回 false，这样设计的目的是为了能够在父组件中获取到子组件中的表单校验结果。&lt;/p&gt;
&lt;p&gt;2、父组件中代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;choice-parameters&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;choice-parameters&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:choice-parameters&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;properties.choiceParameters&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;choice-parameters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Pipeline&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;components&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;choice-parameters&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ChoiceParameters&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$refs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;choice-parameters&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;validateForm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;c1&#34;&gt;// do something     
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上代码中有两个地方需要特别注意，一是为了在代码中引用子组件而添加的 &lt;code&gt;ref&lt;/code&gt; 属性，二是使用 &lt;code&gt;this.$refs[&#39;choice-parameters&#39;].validateForm()&lt;/code&gt; 获取子组件校验的结果，获得子组件校验的结果后，就可以进行相应的判断和操作了。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vue/">Vue</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C/">表单校验</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>在 Grafana 中制作 AlertManager 报警相关的图表</title>
                <link>https://xdhuxc.github.io/posts/devops/grafana/grafana-elasticsearch-visualizations/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/grafana/grafana-elasticsearch-visualizations/</guid>
                <pubDate>Wed, 25 Mar 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下如何在 &lt;code&gt;Grafana&lt;/code&gt; 中制作 AlertManager 报警相关的图表，详细介绍其参数和方法。&lt;/p&gt;
&lt;h3 id=&#34;背景&#34;&gt;背景&lt;/h3&gt;
&lt;p&gt;我们将 &lt;code&gt;AlertManager&lt;/code&gt; 产生的报警存储到了 ES 中，接下来，需要制作报警图表，以可视化的方式观察报警的数量变化和各报警的比例。&lt;/p&gt;
&lt;h3 id=&#34;安装-grafana-并配置数据源&#34;&gt;安装 grafana 并配置数据源&lt;/h3&gt;
&lt;p&gt;1、安装 &lt;code&gt;grafana&lt;/code&gt; 并启动，依次执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://dl.grafana.com/oss/release/grafana-6.7.1-1.x86_64.rpm
sudo yum install grafana-6.7.1-1.x86_64.rpm
systemctl restart grafana-server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、打开 grafana 并配置数据源&lt;/p&gt;
&lt;p&gt;在浏览器中打开 &lt;code&gt;127.0.0.1:3000&lt;/code&gt;，在 &lt;code&gt;Configuration&lt;/code&gt; 中选择 &lt;code&gt;Add data source&lt;/code&gt;，找到 &lt;code&gt;ElasticSearch&lt;/code&gt;，点击 Select，配置 ES 数据源的基本信息。&lt;/p&gt;
&lt;p&gt;主要包括如下几项：&lt;/p&gt;
&lt;p&gt;1）Name 为数据源名称，比如，ElasticSearch，同时打开 Default 选项，使用 ES 作为我们的默认选项。&lt;/p&gt;
&lt;p&gt;2）HTTP 部分的 URL：ES 的URL，比如，http://127.0.0.1:9200。&lt;/p&gt;
&lt;p&gt;3）Auth 部分打开 Basic auth，在 Basic Auth Details 部分中填入 ES 的用户名和密码。&lt;/p&gt;
&lt;p&gt;4）在 ElasticSearch details 部分的 Index name 部分填入索引的名称，比如，alertmanager-alerts，Version 部分选择相应的 ES 版本，比如 7.0+。&lt;/p&gt;
&lt;p&gt;5）点击 Save &amp;amp; Test 保存这些信息。&lt;/p&gt;
&lt;h3 id=&#34;图表绘制&#34;&gt;图表绘制&lt;/h3&gt;
&lt;p&gt;我们可能需要知道报警总数（饼图），按业务或部门分类的报警数目（饼图），报警数量按照时间变化的曲线（折线图），某个具体报警的百分位数（折线图）等等，以帮助我们了解报警情况。&lt;/p&gt;
&lt;h4 id=&#34;线图&#34;&gt;线图&lt;/h4&gt;
&lt;p&gt;我们想观察各个报警的总数随时间的变化情况，此时，我们需要绘制一个折线图。在 grafana 中创建一个 Dashboard，点击 Panel Title，选择 Edit，&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/grafana/elasticsearch-visualizations/WechatIMG795.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;p&gt;如上图所示&lt;/p&gt;
&lt;p&gt;点击 &lt;code&gt;Queries&lt;/code&gt;，做如下操作：&lt;/p&gt;
&lt;p&gt;1）Query 部分选择数据源 Elasticsearch。&lt;/p&gt;
&lt;p&gt;2）Alias 的值为：报警总数随时间变化情况，这会显示在曲线上和图表的左下角。&lt;/p&gt;
&lt;p&gt;3）Metric 使用 Count，因为我们是在绘制报警总数随时间变化的曲线，纵坐标是报警的总数，横坐标是时间，具体来说是报警开始的时间。&lt;/p&gt;
&lt;p&gt;4）Group by 使用 Date Histogram 类型，根据 startsAt 来进行，也就是使用报警开始的时间来进行聚合，interval 选择 auto，让 grafana 自己根据数据长度来决定使用多大的间距。&lt;/p&gt;
&lt;p&gt;点击 &lt;code&gt;Visualization&lt;/code&gt;，做如下操作：&lt;/p&gt;
&lt;p&gt;1）Visualization 选择 Graph。&lt;/p&gt;
&lt;p&gt;2）Draw Modes 选择 Lines。&lt;/p&gt;
&lt;p&gt;3）Legend 部分，打开 Options 部分的 Show 选项，这样当鼠标在图表中滑过时，会显示当前数据小卡片。&lt;/p&gt;
&lt;p&gt;点击 &lt;code&gt;General&lt;/code&gt;，做如下操作：&lt;/p&gt;
&lt;p&gt;1）在 General 的 Title 部分填写此面板的名称，比如，报警总数随时间变化情况，Description 也可以根据需要自行填写。&lt;/p&gt;
&lt;p&gt;最终的 &lt;code&gt;报警总数随时间变化曲线图&lt;/code&gt; 如下所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/grafana/elasticsearch-visualizations/WechatIMG796.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;p&gt;保存此 Dashboard，命名为：AlertManager 报警统计。&lt;/p&gt;
&lt;h4 id=&#34;饼图&#34;&gt;饼图&lt;/h4&gt;
&lt;p&gt;假如我们想知道各个报警占报警总数的比例，那我们就需要绘制一张饼图，来直观地展示各个报警在报警总数中所占的比例。&lt;/p&gt;
&lt;p&gt;grafana 默认不带饼图，需要安装饼图插件来支持。使用如下命令安装饼图插件，并重启 grafana&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;grafana-cli plugins install grafana-piechart-panel
sudo service grafana-server restart
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 Dashboard &lt;code&gt;AlertManager 报警统计&lt;/code&gt; 中，点击 &lt;code&gt;New Panel&lt;/code&gt;，选择 &lt;code&gt;Add Query&lt;/code&gt;，点击 Panel Title，选择 Edit，&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/grafana/elasticsearch-visualizations/WechatIMG797.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;p&gt;如上图所示&lt;/p&gt;
&lt;p&gt;点击 Queries，进行如下操作：&lt;/p&gt;
&lt;p&gt;1）在 Query 部分选择数据源 Elasticsearch。&lt;/p&gt;
&lt;p&gt;2）Metric 选择 Count，我们需要聚合各个报警的数量。&lt;/p&gt;
&lt;p&gt;3）Group By 选择 Terms，根据 labels.alertname.keyword 来进行聚合，也就是根据报警名称进行分组。&lt;/p&gt;
&lt;p&gt;4）Then by 使用 Date Histogram 类型，根据 startsAt 来进行，即使用报警开始的时间再次进行聚合，interval 选择 1h，每一小时内的数据放在一起。&lt;/p&gt;
&lt;p&gt;点击 Visualization，进行如下操作：&lt;/p&gt;
&lt;p&gt;1）在 Visualization 部分选择 Pie Chart。&lt;/p&gt;
&lt;p&gt;2）在 General 部分，Type 选择 Pie，Value 选择 Total。&lt;/p&gt;
&lt;p&gt;3）在 Legend 部分，打开 Show Legend， 选择适当的 Position，打开 Legend Values，打开 Show Percentage，将 Percentage Decimals 设置为 2，即保留小数点后两位。&lt;/p&gt;
&lt;p&gt;如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/grafana/elasticsearch-visualizations/WechatIMG798.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;p&gt;点击 &lt;code&gt;General&lt;/code&gt;，做如下操作：&lt;/p&gt;
&lt;p&gt;1）在 General 的 Title 部分填写此面板的名称，比如，各报警统计情况，Description 也可以根据需要自行填写。&lt;/p&gt;
&lt;p&gt;保存此面板。&lt;/p&gt;
&lt;p&gt;最终的 &lt;code&gt;各报警统计情况&lt;/code&gt; 如下所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/grafana/elasticsearch-visualizations/WechatIMG799.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;h4 id=&#34;百分位图&#34;&gt;百分位图&lt;/h4&gt;
&lt;p&gt;假如我们想了解某个报警的阈值情况，方便我们设置合理的阈值，抑制该报警的发送。&lt;/p&gt;
&lt;p&gt;此处需要特别注意，进行百分位数计算，要求计算依据字段必须是数值类型的，所以，插入 ES 索引数据中字段必须是数值类型的，否则不能用于计算百分位数。&lt;/p&gt;
&lt;p&gt;在 Dashboard &lt;code&gt;AlertManager 报警统计&lt;/code&gt; 中，点击 &lt;code&gt;New Panel&lt;/code&gt;，选择 &lt;code&gt;Add Query&lt;/code&gt;，点击 Panel Title，选择 Edit，&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/grafana/elasticsearch-visualizations/WechatIMG800.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;p&gt;如上图所示&lt;/p&gt;
&lt;p&gt;点击 Queries，进行如下操作：&lt;/p&gt;
&lt;p&gt;1）在 Query 部分选择数据源 Elasticsearch。&lt;/p&gt;
&lt;p&gt;2）Query 部分填写：&lt;code&gt;labels.alertname.keyword : &amp;quot;$alertname&amp;quot; and labels.severity.keyword : &amp;quot;critical&amp;quot; and labels.group.keyword : &amp;quot;Xdhuxc&amp;quot;&lt;/code&gt;，用于筛选出我们需要计算阈值的具体报警&lt;/p&gt;
&lt;p&gt;3）Metric 选择 Percentiles，根据 labels.value 计算百分位数，分别计算 90，95，99 的百分位数。&lt;/p&gt;
&lt;p&gt;4）Group By 选择 Date Histogram，根据 startsAt 来进行分组，interval 选择 1h。&lt;/p&gt;
&lt;p&gt;点击 Visualization，进行如下操作：&lt;/p&gt;
&lt;p&gt;1）选择 Visualization 为 Graph。&lt;/p&gt;
&lt;p&gt;2）在 Draw Modes 部分，打开 Lines，使用线图。&lt;/p&gt;
&lt;p&gt;3）在 Axes 部分，设置 Left Y 的 Decimals 为 2；设置 Right Y 的 Decimals 为 2。&lt;/p&gt;
&lt;p&gt;4）在 &lt;code&gt;Legend&lt;/code&gt; 的 &lt;code&gt;Options&lt;/code&gt; 部分，打开 &lt;code&gt;Show&lt;/code&gt;，显示绘图点的数据。&lt;/p&gt;
&lt;p&gt;点击 General，进行如下操作：&lt;/p&gt;
&lt;p&gt;1）在 General 的 Title 输入框中，填写如下内容：&lt;code&gt;百分位数-$alertname&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;我们在上面的 Query 和 Title 中用到了 $alertname，这是 grafana 支持的变量，是 Dashboard 级别的，通过这个变量，我们可以在一个 panel 中画出若干个同类型的图表。&lt;/p&gt;
&lt;p&gt;点击右上角的 Dashboard settings，选择 Variables，点击 New，如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/grafana/elasticsearch-visualizations/WechatIMG801.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;p&gt;进行如下配置：&lt;/p&gt;
&lt;p&gt;1）在 General 部分，Name 表示变量的名字，将会在面板中进行引用；Type 选择 Query，我们将从 ES 中查询出所有的报警名称；Label 是变量的标签，将会显示在 Dashboard 上。&lt;/p&gt;
&lt;p&gt;2）在 Query Options 部分，Data source 选择我们的数据源 Elasticsearch，Refresh 表示刷新数据的时机，选择 On Dashboard Load；Query 填入查询数据的表达式，对于我们来说，就是从 ES 中查询所有报警名称的查询表达式，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
    &amp;#34;find&amp;#34;: &amp;#34;terms&amp;#34;, 
    &amp;#34;field&amp;#34;: &amp;#34;labels.alertname.keyword&amp;#34;, 
    &amp;#34;query&amp;#34;: &amp;#34;*&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Sort 指定查询出的数据的排序方式，可以根据需要自行指定。&lt;/p&gt;
&lt;p&gt;保存 alertname 变量的定义，然后就可以在面板中使用了。&lt;/p&gt;
&lt;p&gt;最终的 百分位图表如下所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/grafana/elasticsearch-visualizations/WechatIMG803.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;p&gt;保存此面板，可以选择不同的报警名称，查看它们对应的百分位图。&lt;/p&gt;
&lt;h3 id=&#34;导出-alertmanager-报警统计-dashboard&#34;&gt;导出 AlertManager 报警统计 Dashboard&lt;/h3&gt;
&lt;p&gt;我们可以将 Dashboard 保存下来，方便后面在其他地方直接引入。&lt;/p&gt;
&lt;p&gt;点击右上角的 &lt;code&gt;Share Dashboard&lt;/code&gt;，选择 &lt;code&gt;Export&lt;/code&gt;，点击 &lt;code&gt;Save to file&lt;/code&gt; 保存我们制作的 Dashboard。&lt;/p&gt;
&lt;h3 id=&#34;总结&#34;&gt;总结&lt;/h3&gt;
&lt;p&gt;和 Kibana 相比，grafana 制作出的图表灵活性更大，也更加美观，但是线图却不够平滑，支持变量确实是一个非常好用的功能。我们也可以根据需要，制作其他类型的图表。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/elasticsearch/">ElasticSearch</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/alertmanager/">AlertManager</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/grafana/">Grafana</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>在 Kibana 中制作 AlertManager 相关的图表</title>
                <link>https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-kibana-visualizations/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-kibana-visualizations/</guid>
                <pubDate>Fri, 06 Mar 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下如何在 &lt;code&gt;Kibana&lt;/code&gt; 中制作图表，详细介绍其参数和方法。&lt;/p&gt;
&lt;h3 id=&#34;背景&#34;&gt;背景&lt;/h3&gt;
&lt;p&gt;我们将 &lt;code&gt;AlertManager&lt;/code&gt; 中产生的报警存储到了 ES 中，接下来，需要制作报警图表，以可视化的方式观察报警的数量变化。&lt;/p&gt;
&lt;h3 id=&#34;kibana-安装及配置&#34;&gt;Kibana 安装及配置&lt;/h3&gt;
&lt;p&gt;1、下载 &lt;code&gt;Kibana&lt;/code&gt; 安装包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://artifacts.elastic.co/downloads/kibana/kibana-7.6.1-x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、安装 &lt;code&gt;kibana&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -ivh kibana-7.6.1-x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、修改 &lt;code&gt;Kibana&lt;/code&gt; 配置，修改 &lt;code&gt;/etc/kibana/kibana.yml&lt;/code&gt; 文件中的如下配置项：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;server.port: 5601                                  # 指定 Kibana 进程运行的端口号，默认为：5601
server.host: &amp;#34;10.20.13.15&amp;#34;                         # 指定 Kibana 服务器绑定的主机
elasticsearch.hosts: [&amp;#34;http://10.20.13.15:9200&amp;#34;]   # 指定 Kibana 要连接的 ES 的地址
elasticsearch.username: &amp;#34;elastic&amp;#34;                  # 指定 Kibana 要连接的 ES 的用户名
elasticsearch.password: &amp;#34;AlertManager@2020&amp;#34;        # 指定 kibana 要连接的 ES 的密码
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、启动 &lt;code&gt;Kibana&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart kibana
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;图表制作&#34;&gt;图表制作&lt;/h3&gt;
&lt;p&gt;打开地址 http://10.20.13.15:5601，使用 elastic/{ES密码} 登录 Kibana，&lt;/p&gt;
&lt;h4 id=&#34;设置和准备&#34;&gt;设置和准备&lt;/h4&gt;
&lt;p&gt;1、选择 &lt;code&gt;Management&lt;/code&gt;，在 &lt;code&gt;Kibana&lt;/code&gt; 中点击 &lt;code&gt;Advanced Settings&lt;/code&gt;，&lt;/p&gt;
&lt;p&gt;修改 &lt;code&gt;General&lt;/code&gt; 中的 &lt;code&gt;Date format&lt;/code&gt; 为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;YYYY-MM-DD HH:mm:ss.SSS
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 &lt;code&gt;General&lt;/code&gt; 中的 &lt;code&gt;Date with nanoseconds format&lt;/code&gt; 为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;YYYY-MM-DD HH:mm:ss.SSSSSSSSS
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后保存。&lt;/p&gt;
&lt;p&gt;2、选择 &lt;code&gt;Kibana&lt;/code&gt; 中的 &lt;code&gt;Index Patterns&lt;/code&gt;，创建索引模式，名称为：&lt;code&gt;alertmanager-alerts*&lt;/code&gt;，选择索引 &lt;code&gt;alertmanager-alerts&lt;/code&gt;，完成后续步骤。&lt;/p&gt;
&lt;h4 id=&#34;可视化图表&#34;&gt;可视化图表&lt;/h4&gt;
&lt;h5 id=&#34;饼图&#34;&gt;饼图&lt;/h5&gt;
&lt;p&gt;先制作一个按报警名称聚合的饼图，表示各个报警在报警总数中所占的比例。选择 &lt;code&gt;Visualize&lt;/code&gt;，点击 &lt;code&gt;Create visualization&lt;/code&gt;，点击 &lt;code&gt;Pie&lt;/code&gt;，选择索引模式 &lt;code&gt;alertmanager-alerts*&lt;/code&gt;，来到图表编辑页面&lt;/p&gt;
&lt;div align=&#34;center&#34;&gt;
    &lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG755.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/div&gt;
&lt;p&gt;在 &lt;code&gt;Metrics&lt;/code&gt; 下的 &lt;code&gt;Slice size&lt;/code&gt; 中选择聚合器 &lt;code&gt;Count&lt;/code&gt;，Count 返回所选索引模式中元素的原始计数，&lt;code&gt;Custom label&lt;/code&gt; 中填入这个 &lt;code&gt;Count&lt;/code&gt; 的含义，即报警总数。&lt;/p&gt;
&lt;p&gt;点击 &lt;code&gt;Add&lt;/code&gt; 增加一个 &lt;code&gt;Bucket&lt;/code&gt;（相当于 &lt;code&gt;SQL&lt;/code&gt; 中的 &lt;code&gt;group by&lt;/code&gt;），类型选择 &lt;code&gt;Split slices&lt;/code&gt;，&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG756.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;聚合器选择 &lt;code&gt;Terms&lt;/code&gt;，&lt;code&gt;Field&lt;/code&gt; 选择 &lt;code&gt;labels.alertname.keyword&lt;/code&gt;，&lt;code&gt;Order by&lt;/code&gt; 选择 &lt;code&gt;Metric：报警总数&lt;/code&gt;，&lt;code&gt;Order&lt;/code&gt; 默认即可，&lt;code&gt;Size&lt;/code&gt; 增大到 100，打开 &lt;code&gt;Group other values in separate bucket&lt;/code&gt;，在 &lt;code&gt;Label for other bucket&lt;/code&gt; 中填入 &lt;code&gt;其他&lt;/code&gt;，&lt;code&gt;Custom label&lt;/code&gt; 中填入 &lt;code&gt;报警名称&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG757.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;&lt;code&gt;Options&lt;/code&gt; 中的参数说明如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Donut：打开后显示为空心饼图，否则填充至饼图圆心。&lt;/li&gt;
&lt;li&gt;Legend position：图例显示的位置，默认显示在右上方&lt;/li&gt;
&lt;li&gt;Show tooltip：是否显示工具提示，如果显示，当鼠标放到扇形上时，会显示该部分的数据&lt;/li&gt;
&lt;li&gt;Show labels：是否显示标签，在此处对应于各报警的名称&lt;/li&gt;
&lt;li&gt;Show values：是否显示值，在此处对应于各报警所占百分比是否显示在标签后面的括号中。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最后的饼图为：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG758.png&#34; width=&#34;600px&#34; height=&#34;400px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;可以看到，在所有的报警中，各报警所占的比例。&lt;/p&gt;
&lt;p&gt;保存该图标，命名为：各报警统计&lt;/p&gt;
&lt;h5 id=&#34;线图&#34;&gt;线图&lt;/h5&gt;
&lt;p&gt;或许还想观察各个报警的总数随时间的变化情况，此时，我们可以制作一个折线图，选择 &lt;code&gt;Visualize&lt;/code&gt;，点击 &lt;code&gt;Create visualization&lt;/code&gt;，点击 &lt;code&gt;Line&lt;/code&gt;，选择索引模式 &lt;code&gt;alertmanager-alerts*&lt;/code&gt;，来到图表编辑页面&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG760.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;在 &lt;code&gt;Metrics&lt;/code&gt; 下的 &lt;code&gt;Slice size&lt;/code&gt; 中选择聚合器 &lt;code&gt;Count&lt;/code&gt;，&lt;code&gt;Custom label&lt;/code&gt; 中填入 &lt;code&gt;报警总数&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;接下来设置 X 轴，在 &lt;code&gt;Buckets&lt;/code&gt; 中增加 &lt;code&gt;X-axis&lt;/code&gt;，聚合器选择 &lt;code&gt;Date Histogram&lt;/code&gt;，&lt;code&gt;Field&lt;/code&gt; 选择 &lt;code&gt;startAt&lt;/code&gt;，&lt;code&gt;Minimum interval&lt;/code&gt; 填写 &lt;code&gt;1h&lt;/code&gt;，&lt;code&gt;Custom label&lt;/code&gt; 填写 &lt;code&gt;时间&lt;/code&gt;，我们以报警发生的时间作为 X 轴数据，每小时的数据统计在一个点上。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG761.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;接下来继续增加 &lt;code&gt;Bucket&lt;/code&gt;，选择 &lt;code&gt;Split series&lt;/code&gt;，使用 &lt;code&gt;Terms&lt;/code&gt; 聚合器，&lt;code&gt;Field&lt;/code&gt; 字段选择 &lt;code&gt;labels.alertname.keyword&lt;/code&gt;，&lt;code&gt;Order by&lt;/code&gt; 选择 &lt;code&gt;Metric：报警总数&lt;/code&gt;，&lt;code&gt;Order&lt;/code&gt; 默认即可，&lt;code&gt;Size&lt;/code&gt; 设置为：&lt;code&gt;50&lt;/code&gt;，打开 &lt;code&gt;Group other values in separate bucket&lt;/code&gt;（将所有不在报警名称之中的归入此类），在 &lt;code&gt;Label for other bucket&lt;/code&gt; 下方填写 其他，&lt;code&gt;Custom label&lt;/code&gt; 中填写 &lt;code&gt;报警名称&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG764.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;数据部分的工作做完了，接下来进行配置：&lt;/p&gt;
&lt;p&gt;1、设置 Y 轴，在 &lt;code&gt;Metrics &amp;amp; axes&lt;/code&gt; 中，&lt;code&gt;Chart type&lt;/code&gt; 选择 &lt;code&gt;Line&lt;/code&gt;，使用线图；&lt;code&gt;Line mode&lt;/code&gt; 选择 &lt;code&gt;Smoothed&lt;/code&gt;，使用平滑曲线；&lt;code&gt;Line width&lt;/code&gt; 用来设置线宽，可自行设置。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG765.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;2、设置 X 轴，&lt;code&gt;Position&lt;/code&gt; 为 &lt;code&gt;Bottom&lt;/code&gt;，x 轴显示在图表下方；打开 &lt;code&gt;Show axis lines and labels&lt;/code&gt;，否则将不显示 x 轴的标签；&lt;code&gt;Align&lt;/code&gt; 使用 &lt;code&gt;Horizontal&lt;/code&gt;，横向排列 x 轴标签。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG766.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;3、其他设置，在 &lt;code&gt;Panel settings&lt;/code&gt; 中，打开 &lt;code&gt;Show tooltip&lt;/code&gt;，这样当鼠标放到数据点上时，会显示该点的数据和标签；打开 Current time marker，将会以垂线的方式显示当前时间线；在 Grid 部分，打开 &lt;code&gt;Show X-axis lines&lt;/code&gt;，&lt;code&gt;Y-axis lines&lt;/code&gt; 选择 &lt;code&gt;LeftAxis-1&lt;/code&gt;，这样会在坐标轴中显示网格线，更加直观。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG767.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;最后的折线图为：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG768.png&#34; width=&#34;600px&#34; height=&#34;400px&#34;/&gt;
&lt;/center&gt;
&lt;p&gt;可以看出，随着时间的变化，有些报警在减少，有些报警在迅速增加。&lt;/p&gt;
&lt;p&gt;保存该图标，命名为：各报警随时间的变化情况&lt;/p&gt;
&lt;h5 id=&#34;百分位图&#34;&gt;百分位图&lt;/h5&gt;
&lt;p&gt;如果我们想给某给报警设置阈值，使得 95% 的报警都不发送，那么我们就需要计算这个报警的百分位数。&lt;/p&gt;
&lt;p&gt;百分位数可以使用线图来绘制，也基本跟线图一样，区别在于以下两点：&lt;/p&gt;
&lt;p&gt;1、&lt;code&gt;Metrics&lt;/code&gt; 中使用 &lt;code&gt;Percentiles&lt;/code&gt; 聚合器，&lt;code&gt;Field&lt;/code&gt; 选择 &lt;code&gt;labels.value&lt;/code&gt;，注意，&lt;code&gt;labels.value&lt;/code&gt; 必须是 &lt;code&gt;ES&lt;/code&gt; 中的数值类型，否则不能用于计算百分位数，在 &lt;code&gt;Percents&lt;/code&gt; 中分别填入 &lt;code&gt;90&lt;/code&gt;，&lt;code&gt;95&lt;/code&gt;，&lt;code&gt;99&lt;/code&gt;，表示需要计算 &lt;code&gt;90% 分位数&lt;/code&gt;，&lt;code&gt;95% 分位数&lt;/code&gt;，&lt;code&gt;99% 分位数&lt;/code&gt;。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG769.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;2、在 &lt;code&gt;Bucket&lt;/code&gt; 的 &lt;code&gt;Split series&lt;/code&gt; 中，此处使用 &lt;code&gt;Filters&lt;/code&gt; 聚合器，查询条件为：&lt;code&gt;labels.alertname.keyword : &amp;quot;kube-admin相关容器内存使用率大于80%&amp;quot; and labels.severity.keyword : &amp;quot;critical&amp;quot; and labels.group.keyword : &amp;quot;RST&amp;quot;&lt;/code&gt;，查询出待计算百分位数的报警，在 &lt;code&gt;Filter 1 label&lt;/code&gt; 中填入 &lt;code&gt;kube-admin相关容器内存使用率大于80%&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG770.png&#34; width=&#34;400px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;最后的百分位图为：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/elasticsearch/kibana-visualizations/WechatIMG771.png&#34; width=&#34;600px&#34; height=&#34;400px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;可以看到，在2020年03月05日5点时，kube-admin相关容器内存使用率大于80% 报警的 90% 分位数为 77.162，也就是 value 设置为 77.162 时，90% 的报警都不会发送出来。&lt;/p&gt;
&lt;p&gt;同时也应该注意，分位数是随着报警总数的增多而变化的，并非固定值。&lt;/p&gt;
&lt;p&gt;保存该图，命名为：百分位图-kube-admin相关容器内存使用率大于80%&lt;/p&gt;
&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;1、在 &lt;code&gt;Kibana&lt;/code&gt; 中创建索引模式（Index Pattern）之后，原来索引中字段的数据类型就将保持不变，即使 ElasticSearch 中的数据类型改变了，此时，需要删除原来的索引模式，重新从 ElasticSearch 的索引创建 Kibana 使用的索引模式。&lt;/p&gt;
&lt;p&gt;2、Kibana 的图表依赖于其索引模式，删除索引模式后，图表将无法正常显示。&lt;/p&gt;
&lt;h3 id=&#34;总结&#34;&gt;总结&lt;/h3&gt;
&lt;p&gt;Kibana 的图表制作还是很方便的，了解了基本的使用方法后，可以制作出来很多漂亮、实用的图表，为业务提供支持和建议。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/elasticsearch/">ElasticSearch</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/alertmanager/">AlertManager</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/kibana/">Kibana</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>将 AlertManager 的报警存储到 ElasticSearch 中</title>
                <link>https://xdhuxc.github.io/posts/devops/alertmanager/alertmanager-elasticsearch/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/alertmanager/alertmanager-elasticsearch/</guid>
                <pubDate>Fri, 06 Mar 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下将 &lt;code&gt;AlertManager&lt;/code&gt; 中的报警存储到 &lt;code&gt;ElasticSearch&lt;/code&gt; 中的方法，以便我们使用 &lt;code&gt;Kibana&lt;/code&gt; 等可视化工具将其做成各种图表进行分析。&lt;/p&gt;
&lt;h3 id=&#34;背景&#34;&gt;背景&lt;/h3&gt;
&lt;p&gt;当我们的监控-告警系统建立起来后，告警系统将会面临这样的问题：警报消息太多，接收人很容易麻木，不再继续理会，关键的告警常常被淹没。所以，我们需要做好告警的收敛工作。&lt;/p&gt;
&lt;p&gt;我们可以考虑把告警信息收集起来，做统计分析，基于统计数据按周、月生成告警报告，比如，哪些应用在哪段时间里产生了最多的报警，哪些指标在哪段时间里产生了最多的报警，某个报警阈值的 90% 分位数、95% 分位数、99% 分位数，哪个部门产生了最多的报警数等等。一来要求业务团队改造程序或结构，调整资源配置，比如有些代码写得性能特别差，资源占用高，导致告警信息频繁发送；二来可以作为我们设置各种资源阈值的统计参考数据，取代常用的经验值或习惯值，比如，根据历史报警数据的统计，采取百分位数，使得某告警在 &lt;code&gt;95%&lt;/code&gt; 的情况下不再发送告警信息。&lt;/p&gt;
&lt;p&gt;我们决定使用 ElasticSearch 来存储报警信息，后续使用 Kibana 制作报警信息图表&lt;/p&gt;
&lt;h3 id=&#34;代码开发&#34;&gt;代码开发&lt;/h3&gt;
&lt;h4 id=&#34;思考问题&#34;&gt;思考问题&lt;/h4&gt;
&lt;p&gt;我们想把 &lt;code&gt;AlertManager&lt;/code&gt; 发送的报警收集起来，那么，由于 &lt;code&gt;AlertManager&lt;/code&gt; 会把从 &lt;code&gt;Prometheus&lt;/code&gt; 发送来的报警信息进行分组聚合，抑制等操作，从而导致实际产生的报警一般会多于发送出来的报警。&lt;/p&gt;
&lt;p&gt;如果我们想把 &lt;code&gt;AlertManager&lt;/code&gt; 的报警信息收集起来，那么，我们是应该在 &lt;code&gt;AlertManager&lt;/code&gt; 接收到报警的时候收集，还是在真正发送报警之前进行收集？&lt;/p&gt;
&lt;p&gt;如果是在接收到报警时收集，那么我们实际上会收集到所有产生的报警，数据量大，信息详尽。如果使用这些进行分析，进而改进代码、程序架构和资源配置，那么，将会从上游彻底地减少报警，并且促进整个研发运维的进步和系统的稳定性。&lt;/p&gt;
&lt;p&gt;如果是在实际发送时收集，那么我们收集到的数据量就会比较小，报警是经过聚合的，被抑制的报警不发送，经过分析优化后，将会使得接收到的报警数量减少，但是产生的报警（按原来的标准，这种情况下会产生报警）却可能增多，比如在不做上游改变的情况下，调整阈值，使得 &lt;code&gt;99%&lt;/code&gt; 的报警不发送，问题则会堆积在 &lt;code&gt;Prometheus&lt;/code&gt; 那边，不会向 &lt;code&gt;AlertManager&lt;/code&gt; 发送报警，造成更大的系统风险，使用不当时，会造成自自欺人的窘境。&lt;/p&gt;
&lt;p&gt;根据以上分析，我们选择在 &lt;code&gt;AlertManager&lt;/code&gt; 接收到报警时即收集之。&lt;/p&gt;
&lt;h4 id=&#34;代码&#34;&gt;代码&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;Prometheus&lt;/code&gt; 使用 &lt;code&gt;AlertManager&lt;/code&gt; 的 &lt;code&gt;API&lt;/code&gt; &lt;code&gt;v1&lt;/code&gt; 来向 &lt;code&gt;AlertManager&lt;/code&gt; 发送报警，所以我们先改造 &lt;code&gt;AlertManager&lt;/code&gt; 的 &lt;code&gt;v1&lt;/code&gt; 版本 &lt;code&gt;API&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;1、在 &lt;code&gt;alertmanager/config/config.go&lt;/code&gt; 中 &lt;code&gt;GlobalConfig&lt;/code&gt; 结构体中加入如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;type GlobalConfig struct {
    // ES
    ESEnable            bool     &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_enable,omitempty&amp;#34; json:&amp;#34;es_enable,omitempty&amp;#34;`&lt;/span&gt;
    ESAddresses         []string &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_addresses,omitempty&amp;#34; json:&amp;#34;es_addresses,omitempty&amp;#34;`&lt;/span&gt;
    ESUserName          string   &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_user_name,omitempty&amp;#34; json:&amp;#34;es_user_name,omitempty&amp;#34;`&lt;/span&gt;
    ESPassword          string   &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_password,omitempty&amp;#34; json:&amp;#34;es_password,omitempty&amp;#34;`&lt;/span&gt;
    ESMaxRetries        int      &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_max_retries,omitempty&amp;#34; json:&amp;#34;es_max_retries,omitempty&amp;#34;`&lt;/span&gt;
    ESDisableRetry      bool     &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_disable_retry,omitempty&amp;#34; json:&amp;#34;es_disable_retry,omitempty&amp;#34;`&lt;/span&gt;
    ESEnableMetrics     bool     &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_enable_metrics,omitempty&amp;#34; json:&amp;#34;es_enable_metrics,omitempty&amp;#34;`&lt;/span&gt;
    ESEnableDebugLogger bool     &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_enable_debug_logger,omitempty&amp;#34; json:&amp;#34;es_enable_debug_logger,omitempty&amp;#34;`&lt;/span&gt;
    
    // ES index
    ESIndexName    string &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_index_name,omitempty&amp;#34; json:&amp;#34;es_index_name,omitempty&amp;#34;`&lt;/span&gt;
    ESIndexRefresh string &lt;span class=&#34;sb&#34;&gt;`yaml:&amp;#34;es_index_refresh,omitempty&amp;#34; json:&amp;#34;es_index_refresh,omitempty&amp;#34;`&lt;/span&gt;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上参数含义如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ESEnable：是否启用存储报警信息到 ES 中功能，默认为：false&lt;/li&gt;
&lt;li&gt;ESAddresses：ES 节点地址数组，形式为：&amp;quot;http://10.20.13.158:9200&amp;quot;，必须指定&lt;/li&gt;
&lt;li&gt;ESUserName：ES 用户名，必须指定&lt;/li&gt;
&lt;li&gt;ESPassword：ES 密码，必须指定&lt;/li&gt;
&lt;li&gt;ESMaxRetries：请求 ES 服务器的最大重试次数，默认为：3&lt;/li&gt;
&lt;li&gt;ESDisableRetry：禁用请求重试功能，默认为：false&lt;/li&gt;
&lt;li&gt;ESEnableMetrics：允许收集指标，默认为：false&lt;/li&gt;
&lt;li&gt;ESEnableDebugLogger：允许 debug 级别日志，默认为：false&lt;/li&gt;
&lt;li&gt;ESIndexName：ES 索引名称，必须指定&lt;/li&gt;
&lt;li&gt;ESIndexRefresh：是否启用索引刷新，启用后，每次操作文档后，都会对相关分片及副本进行刷新，保证了数据操作的结果可以立刻被搜索到，在操作频率比较低时，可以设置为：&amp;quot;true&amp;quot;，默认为：&amp;quot;false&amp;quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、在 &lt;code&gt;alertmanager/api/v1/api.go&lt;/code&gt; 中的 &lt;code&gt;API&lt;/code&gt; 结构体中加入如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package v1

import &amp;#34;github.com/elastic/go-elasticsearch/v7&amp;#34;

type API struct {
	es       *elasticsearch.Client
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、创建 ES 客户端，修改 &lt;code&gt;alertmanager/api/v1/api.go&lt;/code&gt; 文件中 &lt;code&gt;func (api *API) Update(cfg *config.Config)&lt;/code&gt; 方法代码，加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;// Create ES client
if cfg.Global.ESEnable {
    esClient, err := elasticsearch.NewClient(elasticsearch.Config{
        Addresses:         cfg.Global.ESAddresses,
        Username:          cfg.Global.ESUserName,
        Password:          cfg.Global.ESPassword,
        DisableRetry:      cfg.Global.ESDisableRetry,
        MaxRetries:        cfg.Global.ESMaxRetries,
        EnableMetrics:     cfg.Global.ESEnableMetrics,
        EnableDebugLogger: cfg.Global.ESEnableDebugLogger,
    })
    if err != nil {
        level.Error(api.logger).Log(&amp;#34;msg&amp;#34;, &amp;#34;Create ES client error&amp;#34;, &amp;#34;err&amp;#34;, err)
    } else {
        // Ping
        _, pingError := esClient.Ping()
        if pingError == nil {
            api.es = esClient
        } else {
            level.Error(api.logger).Log(&amp;#34;msg&amp;#34;, &amp;#34;Ping ES service error&amp;#34;, &amp;#34;err&amp;#34;, pingError)
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、由于 AlertManager 报警信息的数据格式的键值均为字符串，而实际的报警数据中，经常会用到数值类型，比如内存使用率，CPU 使用率，请求次数等等，考虑到以字符串表示的数值在 ES 中将会被当做字符串存储，无法进行某些统计，比如百分位数的计算。我们需要将以字符串表示的数值类型数据转为数值类型。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;alertmanager/api&lt;/code&gt; 目录下创建 &lt;code&gt;es&lt;/code&gt; 目录，在其中创建 &lt;code&gt;alert.go&lt;/code&gt; 文件，内容如下：（为了 v1 和 v2 版本代码均可引用此部分代码）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package es

import (
	&amp;#34;fmt&amp;#34;
	&amp;#34;strconv&amp;#34;
	&amp;#34;time&amp;#34;

	&amp;#34;github.com/prometheus/alertmanager/types&amp;#34;
	&amp;#34;github.com/prometheus/common/model&amp;#34;
)

type LabelValue interface{}

type LabelSet map[model.LabelName]LabelValue // 此处使用 Prometheus 中报警的 LabelSet 的键类型，不要使用 string 类型或自定义 string 类型，否则要进行非常麻烦的类型转换

const (
	labelNameValue model.LabelName = &amp;#34;value&amp;#34; // 在我们的报警中，数值类型的键名统一为：value，值为 CPU 使用率，内存使用率，请求数量等等
)

// for ES number type index
type Alert struct {
	// 使用自定义的 LabelSet 类型
	Labels LabelSet &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;labels&amp;#34;`&lt;/span&gt; 

	// Extra key/value information which does not define alert identity.
	Annotations model.LabelSet &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;annotations&amp;#34;`&lt;/span&gt;

	// The known time range for this alert. Both ends are optional.
	StartsAt     time.Time &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;startsAt,omitempty&amp;#34;`&lt;/span&gt;
	EndsAt       time.Time &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;endsAt,omitempty&amp;#34;`&lt;/span&gt;
	GeneratorURL string    &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;generatorURL&amp;#34;`&lt;/span&gt;

	// The authoritative timestamp.
	UpdatedAt time.Time
	Timeout   bool
}

func Convert(alert *types.Alert) *Alert {
	esAlert := new(Alert)

	esAlert.EndsAt = alert.EndsAt
	esAlert.StartsAt = alert.StartsAt
	esAlert.Annotations = alert.Annotations
	esAlert.GeneratorURL = alert.GeneratorURL
	esAlert.Timeout = alert.Timeout
	esAlert.UpdatedAt = alert.UpdatedAt
	esls := make(LabelSet)
	// 注意，此处不能使用反射将所有字符串数值都转换为数值类型，各个不同的报警中可能有相同的键名，而值的类型不同，可能是字符串，可能是字符串数值，如果转换过去了，向 ES 中创建索引时，就会因为类型而出现错误
	for k, v := range alert.Labels {
		if k == labelNameValue { // 处理数值类型
			result, err = strconv.ParseFloat(fmt.Sprintf(&amp;#34;%s&amp;#34;, v), 32)
			if err != nil {
			    esls[k] = v
			} else {
			    esls[k] = result
			}
		} else {
			esls[k] = v
		}
	}
	esAlert.Labels = esls

	return esAlert
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、编写代码向 ES 中插入数据，有两种方式可以实现，一种是常规的一条一条地插入数据，另一种是批量插入数据，向 &lt;code&gt;alertmanager/api/v1/api.go&lt;/code&gt; 中添加如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import (
    uuid &amp;#34;github.com/satori/go.uuid&amp;#34;
    &amp;#34;github.com/elastic/go-elasticsearch/v7/esapi&amp;#34;
)

// 一条一条地插入数据
func (api *API) Insert(alerts ...*types.Alert) error {
	var total int
	for _, alert := range alerts {
		esAlert := es.Convert(alert)
		dataInBytes, err := json.Marshal(esAlert)
		if err != nil {
			total = total + 1
			level.Error(api.logger).Log(&amp;#34;msg&amp;#34;, &amp;#34;Marshal alerts to string error&amp;#34;, &amp;#34;err&amp;#34;, err)
			continue
		}
		req := esapi.IndexRequest{
			Index:      api.config.Global.ESIndexName,
			DocumentID: uuid.NewV4().String(),       // 使用 UUID 作为文档 ID
			Body:       strings.NewReader(string(dataInBytes)),
			Refresh:    api.config.Global.ESIndexRefresh,
		}

		_, err = req.Do(context.Background(), api.es)
		if err != nil {
			total = total + 1
			level.Error(api.logger).Log(&amp;#34;msg&amp;#34;, &amp;#34;Insert alerts to ES error&amp;#34;, &amp;#34;err&amp;#34;, err)
			continue
		}
	}

	if total &amp;gt; 0 {
		return level.Error(api.logger).Log(&amp;#34;msg&amp;#34;, &amp;#34;There are several errors&amp;#34;, &amp;#34;total&amp;#34;, total)
	}

	return nil
}

// 批量插入数据
func (api *API) Batch(alerts ...*types.Alert) error {
	var buf bytes.Buffer
	for _, alert := range alerts {
	    // 将 AlertManager 的报警格式转化为 ES 需要的报警格式，差别在于数值类型数据的处理
		esAlert := es.Convert(alert)

		metadata := []byte(fmt.Sprintf(`{ &amp;#34;index&amp;#34; : { &amp;#34;_id&amp;#34; : &amp;#34;%s&amp;#34; } }%s`, uuid.NewV4().String(), &amp;#34;\n&amp;#34;))
		data, err := json.Marshal(esAlert)
		if err != nil {
			level.Error(api.logger).Log(&amp;#34;msg&amp;#34;, &amp;#34;Marshal ESAlerts to string error&amp;#34;, &amp;#34;err&amp;#34;, err)
			continue
		}

		data = append(data, &amp;#34;\n&amp;#34;...)
		buf.Grow(len(metadata) + len(data))
		buf.Write(metadata)
		buf.Write(data)
	}

	_, err := api.es.Bulk(bytes.NewReader(buf.Bytes()), api.es.Bulk.WithIndex(api.config.Global.ESIndexName), api.es.Bulk.WithRefresh(api.config.Global.ESIndexRefresh))
	if err != nil {
		level.Error(api.logger).Log(&amp;#34;msg&amp;#34;, &amp;#34;doing ES Bulk API error&amp;#34;, &amp;#34;err&amp;#34;, err)
		return err
	}

	return nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;建议使用批量插入数据的方式，在我们的测试中，插入 1000 条数据，一条一条插入需要使用 197.13s，而使用批量插入仅需要 1.97s。&lt;/p&gt;
&lt;p&gt;6、将 AlertManager 接收到的报警数据存储到 ES 中，修改 &lt;code&gt;alertmanager/api/v1/api.go&lt;/code&gt; 文件中的方法 &lt;code&gt;func (api *API) insertAlerts(w http.ResponseWriter, r *http.Request, alerts ...*types.Alert)&lt;/code&gt;，将代码加到 &lt;code&gt;api.alerts.Put(validAlerts...)&lt;/code&gt; 代码块之前&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;// insert alerts to ES
if api.es != nil {
    _ = api.Batch(validAlerts...)
}

// Put 方法用于合并报警到已有的报警之中
if err := api.alerts.Put(validAlerts...); err != nil {
    api.respondError(w, apiError{
        typ: errorInternal,
        err: err,
    }, nil)
    return
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参照以上代码修改 API v2 的代码，由于 AlertManager 代码结构的问题，v1 和 v2 版本的 API 无法共用此部分代码。&lt;/p&gt;
&lt;h3 id=&#34;测试&#34;&gt;测试&lt;/h3&gt;
&lt;p&gt;编写单元测试进行测试，在文件 &lt;code&gt;alertmanager/api/v1/api_test.go&lt;/code&gt; 中加入如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func newAPIClient() *API {
	apiClient := New(nil, nil, nil, nil, nil, nil)
	cfg := &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;config.Config{
		Global: &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;config.GlobalConfig{
			ESEnable:            true,
			ESAddresses:         []string{&amp;#34;http://127.0.0.1:9200&amp;#34;},
			ESUserName:          &amp;#34;elastics&amp;#34;,
			ESPassword:          &amp;#34;AlertManager@2020&amp;#34;,
			ESMaxRetries:        3,
			ESDisableRetry:      false,
			ESEnableMetrics:     true,
			ESEnableDebugLogger: true,
			ESIndexName:         &amp;#34;alertmanager-alerts&amp;#34;,
			ESIndexRefresh:      &amp;#34;true&amp;#34;,
		},
		Route: &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;config.Route{
			Receiver:   &amp;#34;test&amp;#34;,
			GroupByAll: false,
		},
	}

	apiClient.Update(cfg)

	return apiClient
}

func generateAlerts() []*types.Alert {
	groups := []string{&amp;#34;A&amp;#34;, &amp;#34;B&amp;#34;, &amp;#34;C&amp;#34;, &amp;#34;D&amp;#34;}
	severities := []string{&amp;#34;critical&amp;#34;, &amp;#34;warning&amp;#34;}
	alertNames := []string{&amp;#34;the usage rate of container related to kube-admin greater than 80%&amp;#34;, &amp;#34;kafka was down&amp;#34;}

	var alerts []*types.Alert

	for i := 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;ls&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;model.LabelSet{&lt;/span&gt;
			&lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LabelName&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;AlertNameLabel&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LabelValue&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;alertNames&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Intn&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;alertNames&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;))]),&lt;/span&gt;
			&lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LabelName&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;)&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;              &lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LabelValue&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Intn&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;))]),&lt;/span&gt;
			&lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LabelName&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;severity&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;)&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;           &lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LabelValue&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;severities&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Intn&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;severities&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;))]),&lt;/span&gt;
			&lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LabelName&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;)&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;              &lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LabelValue&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Sprintf&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&amp;#34;%.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;2f&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Float32&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()*&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)),&lt;/span&gt;
		&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;alert&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;amp;types.Alert{&lt;/span&gt;
			&lt;span class=&#34;na&#34;&gt;Alert:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;model&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Alert&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
				&lt;span class=&#34;na&#34;&gt;Labels:&lt;/span&gt;      &lt;span class=&#34;na&#34;&gt;ls&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;
				&lt;span class=&#34;na&#34;&gt;Annotations:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;
				&lt;span class=&#34;na&#34;&gt;StartsAt:&lt;/span&gt;    &lt;span class=&#34;na&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Now&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(),&lt;/span&gt;
				&lt;span class=&#34;na&#34;&gt;EndsAt:&lt;/span&gt;      &lt;span class=&#34;na&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Now&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(),&lt;/span&gt;
			&lt;span class=&#34;err&#34;&gt;},&lt;/span&gt;
			&lt;span class=&#34;na&#34;&gt;Timeout:&lt;/span&gt;   &lt;span class=&#34;na&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;
			&lt;span class=&#34;na&#34;&gt;UpdatedAt:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Now&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(),&lt;/span&gt;
		&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;alerts &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;append(alerts,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;alert&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;na&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;alerts&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;na&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;TestAPI_Insert&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;testing&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;apiClient&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;newAPIClient()&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;alerts&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;generateAlerts()&lt;/span&gt;

	&lt;span class=&#34;na&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;apiClient.Insert(alerts...)&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;NoError&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;na&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;TestAPI_Batch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;testing&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;apiClient&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;newAPIClient()&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;alerts&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;generateAlerts()&lt;/span&gt;

	&lt;span class=&#34;na&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;apiClient.Batch(alerts...)&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;NoError&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;总结&#34;&gt;总结&lt;/h3&gt;
&lt;p&gt;至此，向 AlertManager 中添加存储报警信息到 ES 中的代码开发就完成了，有两点需要特别注意，一是我们是在 AlertManager 接收到发送来的报警信息时将其报警数据存储到 ES 中的（我们将时机选在了去除空标签及标签合法性验证和合并报警消息之间），不是报警从 AlertManager 发送出去时的报警信息；二是由于 AlertManager 代码本身的问题，我们无法复用一些代码，比如创建 ES 客户端的代码，向 ES 中写数据的代码等。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/alertmanager/">AlertManager</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/elasticsearch/">ElasticSearch</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>ElasticSearch 的安装及配置和密码设置等</title>
                <link>https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-install-and-password/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-install-and-password/</guid>
                <pubDate>Tue, 03 Mar 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 ElasticSearch 的安装及配置，密码设置等配置要点。&lt;/p&gt;
&lt;h3 id=&#34;安装-elasticsearch&#34;&gt;安装 ElasticSearch&lt;/h3&gt;
&lt;p&gt;1、下载 &lt;code&gt;ElasticSearch&lt;/code&gt; 的安装包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.6.1-x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、安装 &lt;code&gt;ElasticSearch&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -ivh elasticsearch-7.6.1-x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 ElasticSearch&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart elasticsearch
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;由于 &lt;code&gt;ElasticSearch&lt;/code&gt; 的密码管理是用 &lt;code&gt;x-pack&lt;/code&gt; 来实现的，安装时，x-pack 默认是不启用的，需要开启。&lt;/p&gt;
&lt;p&gt;在配置文件 &lt;code&gt;elasticsearch.yml&lt;/code&gt;（默认路径为：&lt;code&gt;/etc/elasticsearch/elasticsearch.yml&lt;/code&gt;） 中增加如下配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;xpack.security.enabled: true
xpack.security.transport.ssl.enabled: true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;假设 &lt;code&gt;10.20.13.15&lt;/code&gt; 为机器 IP 地址，需要在外部访问时，需要配置如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;network.host: 10.20.13.15
http.port: 9200
discovery.seed_hosts: [&amp;#34;10.20.13.15&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改后重启 &lt;code&gt;ElasticSearch&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;设置密码&#34;&gt;设置密码&lt;/h3&gt;
&lt;p&gt;进入 ElasticSearch 的二进制文件目录下，使用交互式命令行来设置密码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost /usr/share/elasticsearch/bin]# ./elasticsearch-setup-passwords interactive
Initiating the setup of passwords for reserved users elastic,apm_system,kibana,logstash_system,beats_system,remote_monitoring_user.
You will be prompted to enter passwords as the process progresses.
Please confirm that you would like to continue [y/N]y  # 输入 y


Enter password for [elastic]:      # 为 elasticsearch 设置密码
Reenter password for [elastic]:    # 再次输入 elasticsearch 的密码
Enter password for [apm_system]:   # 为 apm 设置密码
Reenter password for [apm_system]: # 再次输入 apm 的密码
Enter password for [kibana]:       # 为 kibana 设置密码
Reenter password for [kibana]:     # 再次输入 kibana 的密码
Enter password for [logstash_system]:   # 为 logstash 设置密码
Reenter password for [logstash_system]: # 再次输入 logstash 的密码
Enter password for [beats_system]:      # 为 beats 设置密码
Reenter password for [beats_system]:    # 再次输入 beats 的密码
Enter password for [remote_monitoring_user]:   # 为 remote_monitoring_user 设置密码
Reenter password for [remote_monitoring_user]: # 再次输入 remote_monitoring_user 的密码
Changed password for user [apm_system]
Changed password for user [kibana]
Changed password for user [logstash_system]
Changed password for user [beats_system]
Changed password for user [remote_monitoring_user]
Changed password for user [elastic]
[root@sgt-devops-2-test /usr/share/elasticsearch/bin]# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者使用 API 来设置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -XPUT -u elastic &amp;#39;http://10.20.13.15:9200/_xpack/security/user/elastic/_password&amp;#39; -d &amp;#39;{
  &amp;#34;password&amp;#34; : &amp;#34;yourpasswd&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;ElasticSearch&lt;/code&gt; 的默认账户为 &lt;code&gt;elastic&lt;/code&gt; 默认密码为 &lt;code&gt;changme&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;可视化&#34;&gt;可视化&lt;/h3&gt;
&lt;p&gt;使用 &lt;code&gt;ElasticHQ&lt;/code&gt; 作为 &lt;code&gt;ElasticSearch&lt;/code&gt; 的可视化工具&lt;/p&gt;
&lt;p&gt;启动 &lt;code&gt;ElasticHQ&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -p 5000:5000 -d elastichq/elasticsearch-hq
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;访问：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://10.20.13.15:5000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下方式连接 &lt;code&gt;elasticsearch&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://elastic:PASSWORD@10.20.13.15:9200
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参考资料：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/ElasticHQ/elasticsearch-HQ&#34;&gt;https://github.com/ElasticHQ/elasticsearch-HQ&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.elastic.co/guide/en/elasticsearch/plugins/current/index.html&#34;&gt;https://www.elastic.co/guide/en/elasticsearch/plugins/current/index.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://docs.elastichq.org&#34;&gt;http://docs.elastichq.org&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/elasticsearch/">ElasticSearch</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>AlertManager 报警收敛的若干种方法</title>
                <link>https://xdhuxc.github.io/posts/devops/alertmanager/alertmanager-alerts-convergence/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/alertmanager/alertmanager-alerts-convergence/</guid>
                <pubDate>Thu, 27 Feb 2020 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 &lt;code&gt;AlertManager&lt;/code&gt; 报警收敛的若干种方法。&lt;/p&gt;
&lt;h3 id=&#34;背景&#34;&gt;背景&lt;/h3&gt;
&lt;p&gt;当一个监控-告警系统建立起来后，告警系统将会面临这样的问题：警报消息太多，接收人很容易麻木，不再继续理会，关键的告警常常被淹没。&lt;/p&gt;
&lt;p&gt;对于这一问题，&lt;code&gt;AlertManger&lt;/code&gt; 提供了非常好的解决方案。&lt;code&gt;Prometheus&lt;/code&gt; 把一条告警信息发送给了 &lt;code&gt;AlterManager&lt;/code&gt;，&lt;code&gt;AlterManager&lt;/code&gt; 并不是简简单单地直接发送出去，而是对告警信息进行了一些诸如分组、延时等收敛处理。&lt;/p&gt;
&lt;p&gt;对报警收敛的支持，&lt;code&gt;AlertManager&lt;/code&gt; 提供了以下四种方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;分组&lt;/li&gt;
&lt;li&gt;抑制&lt;/li&gt;
&lt;li&gt;静默&lt;/li&gt;
&lt;li&gt;延时&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;告警分组&#34;&gt;告警分组&lt;/h3&gt;
&lt;p&gt;告警分组是通过对具有相同属性值的告警进行分组聚合，可以有效的减少告警消息的数量。&lt;/p&gt;
&lt;p&gt;对应 &lt;code&gt;AlertManager&lt;/code&gt; 的配置，通过 &lt;code&gt;route&lt;/code&gt; 部分的 &lt;code&gt;group_by&lt;/code&gt; 字段对具有相同属性的告警进行分组聚合。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;route:
  # AlertManager 将会把具有相同 alertname 的告警分到相同的组  
  group_by: [&amp;#39;alertname&amp;#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;告警抑制&#34;&gt;告警抑制&lt;/h3&gt;
&lt;p&gt;当告警发出后，停止重复发送由此告警引发的其他告警。一般是由更高级别的告警抑制低级别的告警。这可以消除冗余的告警，仅发送关键警报，避免误导运维排查问题的方向。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;AlertManager&lt;/code&gt; 的配置中，通过 &lt;code&gt;inhibit_rules&lt;/code&gt; 部分来配置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;inhibit_rules:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; source_match:        # source_match：匹配当前告警发生后其他告警抑制掉
      severity: &amp;#39;critical&amp;#39;
    target_match:        # target_match：抑制告警
      severity: &amp;#39;warning&amp;#39;
    equal: [&amp;#39;alertname&amp;#39;] # equal：只有包含指定标签才可成立规则
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上配置告诉 &lt;code&gt;AlertManager&lt;/code&gt;，对于具有相同 &lt;code&gt;alertname&lt;/code&gt; 的告警，含 &lt;code&gt;severity: &#39;critical&#39;&lt;/code&gt; 标签的告警将会抑制含 &lt;code&gt;severity: &#39;warning&#39;&lt;/code&gt; 标签的告警。&lt;/p&gt;
&lt;h3 id=&#34;告警静默&#34;&gt;告警静默&lt;/h3&gt;
&lt;p&gt;对可预期的告警，在特定时间段阻止告警的发送，比如，线上环境资源调整或上线，可能会导致告警，此时，可以增加告警静默，阻止相关的告警发送。&lt;/p&gt;
&lt;p&gt;可以在 &lt;code&gt;http://localhost:9093/#/silences&lt;/code&gt; 中进行创建。&lt;/p&gt;
&lt;h3 id=&#34;告警延时&#34;&gt;告警延时&lt;/h3&gt;
&lt;p&gt;当故障发生时，若故障未能及时解决，频繁地发送告警是令人崩溃的。&lt;code&gt;group_wait&lt;/code&gt; 把开始产生的告警收集起来，最后作为一条告警信息发送出来，&lt;code&gt;repeat_interval&lt;/code&gt; 可以将重复的告警以更大的时间间隔发送。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;AlertManager&lt;/code&gt; 的配置中进行如下配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;route:
  group_wait: 60s       # 分组等待的时间为 60 秒，收到告警后并不是马上发送出去，看是否还有具有 alertname 这个标签的报警发过来，如果有的话，一起发出报警
  group_interval: 60s   # 上一组报警与下一组报警的间隔时间为 60 秒
  repeat_interval: 15m  # 重复报警时间
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;其他方式&#34;&gt;其他方式&lt;/h3&gt;
&lt;p&gt;我们也可以考虑把告警信息都收集起来，做统计分析，基于统计数据按周、月生成告警报告，比如，哪些应用在哪段时间里产生了最多的报警，哪些指标在哪段时间里产生了最多的报警，某个报警阈值的 90% 分位数、95%分位数、99%分位数，哪个部门产生了最多的报警数等等。一来要求业务团队改造程序或结构，调整资源配置，比如有些代码写得性能特别差，资源占用高，导致告警信息频繁发送；二来可以作为我们设置各种资源阈值的统计参考数据，取代常用的经验值或习惯值，比如，根据历史报警数据的统计，采取百分位数，使得某告警在 &lt;code&gt;95%&lt;/code&gt; 的情况下不再发送告警信息。&lt;/p&gt;
&lt;h3 id=&#34;总结和思考&#34;&gt;总结和思考&lt;/h3&gt;
&lt;p&gt;做好告警的收敛是很有必要的，也有多种方法。借助于 &lt;code&gt;AlertManager&lt;/code&gt;，我们可以通过分组、抑制、静默和延时等方法来做告警的收敛。&lt;/p&gt;
&lt;p&gt;就 &lt;code&gt;AlertManager&lt;/code&gt; 而言，在告警抑制上，我们还可以考虑更多的告警抑制规则，比如，在多种告警级别（&lt;code&gt;critical&lt;/code&gt;、&lt;code&gt;emergency&lt;/code&gt;、&lt;code&gt;warning&lt;/code&gt;等）的情况下，每一种高级别告警抑制所有比它低的级别的告警；在告警延时上，高级别告警的延时参数缩短，低级别告警的延时参数增长。&lt;/p&gt;
&lt;p&gt;另外，基于统计数据按周、月生成告警报告，改进应用程序和架构，合理设置阈值，更好和更准确地报警。&lt;/p&gt;
&lt;p&gt;考虑这样一种设计，我们想把 &lt;code&gt;AlertManager&lt;/code&gt; 发送的报警收集起来，那么，由于 &lt;code&gt;AlertManager&lt;/code&gt; 会把从 &lt;code&gt;Prometheus&lt;/code&gt; 发送来的报警信息进行分组聚合，抑制等操作，从而导致实际产生的报警一般会多于发送出来的报警。如果我们想把 &lt;code&gt;AlertManager&lt;/code&gt; 的报警信息收集起来，那么，我们是应该在 &lt;code&gt;AlertManager&lt;/code&gt; 接收到报警的时候收集，还是在真正发送报警之前进行收集？&lt;/p&gt;
&lt;p&gt;如果是在接收到报警时收集，那么我们实际上会收集到所有产生的报警，数据量大，信息详尽。如果使用这些进行分析，进而改进代码、程序架构和资源配置，那么，将会从上游彻底地减少报警，并且促进整个研发运维的进步和系统的稳定性。&lt;/p&gt;
&lt;p&gt;如果是在实际发送时收集，那么我们收集到的数据量就会比较小，报警是经过聚合的，被抑制的报警不发送，经过分析优化后，将会使得接收到的报警数量减少，但是产生的报警（按原来的标准，这种情况下会产生报警）却可能增多，比如在不做上游改变的情况下，调整阈值，使得 &lt;code&gt;99%&lt;/code&gt; 的报警不发送，问题则会堆积在 &lt;code&gt;Prometheus&lt;/code&gt; 那边，不会向 &lt;code&gt;AlertManager&lt;/code&gt; 发送报警。&lt;/p&gt;
&lt;p&gt;根据以上分析，我们选择在 &lt;code&gt;AlertManager&lt;/code&gt; 接收到报警时即收集之。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/alertmanager/">AlertManager</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>aws-cli S3 命令行工具使用</title>
                <link>https://xdhuxc.github.io/posts/tools/tools-aws-s3/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/tools/tools-aws-s3/</guid>
                <pubDate>Thu, 21 Nov 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了使用 aws-cli 来操作 S3 桶的用法，尽管 AWS 有非常详尽的文档，但我们记录下来后，下次就可以直接复制使用了。&lt;/p&gt;
&lt;h3 id=&#34;安装-aws-cli-和配置认证信息&#34;&gt;安装 aws-cli 和配置认证信息&lt;/h3&gt;
&lt;p&gt;1）安装 aws-cli
使用 &lt;code&gt;pip&lt;/code&gt; 安装 &lt;code&gt;aws-cli&lt;/code&gt;，命令如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;pip install -y awscli
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）配置认证信息
执行 &lt;code&gt;aws&lt;/code&gt; 命令前，需要在 &lt;code&gt;~/.aws/credentials&lt;/code&gt; 中配置访问 &lt;code&gt;AWS&lt;/code&gt; 的 &lt;code&gt;Access Key&lt;/code&gt; 和 &lt;code&gt;Secret Key&lt;/code&gt;，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[default]
aws_access_key_id = ${aws_access_key_id}
aws_secret_access_key = ${aws_access_key_id}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 ~/.aws/config 中配置区域，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[default]
region = ap-southeast-1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，需要给该 &lt;code&gt;Access Key&lt;/code&gt; 赋予访问要访问资源的权限。&lt;/p&gt;
&lt;h3 id=&#34;使用-aws-cli-操作-s3&#34;&gt;使用 AWS-CLI 操作 S3&lt;/h3&gt;
&lt;p&gt;1、从一个桶里复制目录到另外一个桶里的目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 将 S3 桶 bucket1 中的所有对象复制到 S3 桶 expire.backup.xdhuxc 的 bucket1 目录下
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;aws s3 cp s3://bucket1/ s3://expire.backup.xdhuxc/bucket1/ --recursive 2&amp;gt;./copys3_bucket1_error.log 1&amp;gt;/dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;由于复制的对象中包含目录，需要使用 &lt;code&gt;--recursive&lt;/code&gt; 进行递归复制；在测试时，还可以使用 &lt;code&gt;--dryrun&lt;/code&gt; 参数，只展示输出结果，不实际执行。另外，我们将错误日记记录下来，舍弃标准输出。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;AWS CLI S3 复制对象命令&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.aws.amazon.com/cli/latest/reference/s3/cp.html&#34;&gt;https://docs.aws.amazon.com/cli/latest/reference/s3/cp.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/aws/">AWS</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/s3/">S3</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/cli/">CLI</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vue Element-UI 开发注意事项</title>
                <link>https://xdhuxc.github.io/posts/vue/vue-develope-standard/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/vue/vue-develope-standard/</guid>
                <pubDate>Fri, 08 Nov 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下使用 Vue 和 Element-UI 进行开发时需要注意的一些事项。&lt;/p&gt;
&lt;h3 id=&#34;开发建议&#34;&gt;开发建议&lt;/h3&gt;
&lt;p&gt;1、对于按钮，一般使用 type=&#39;primary&#39;，该类型按钮大小固定，且为亮丽的蓝色，与默认的白色按钮相比，可以丰富页面色彩，更加漂亮。&lt;/p&gt;
&lt;p&gt;2、固定部分表格的列，对于含有多个相同元素的表格单元格，比如多个按钮，固定该单元格的长度，使其横向或纵向排开，避免被 element-ui 自动计算导致的挤压。&lt;/p&gt;
&lt;p&gt;3、对于表格中含有过长文本的列，使用 :show-overflow-tooltip=&amp;quot;true&amp;quot; 隐藏部分文本，否则会撑大单元格，导致整个表格被撑大，非常不美观。&lt;/p&gt;
&lt;p&gt;4、对于表示时间的列，比如创建时间或更新时间，使用类似 scope.row.update_time | parseTime(&#39;{y}-{m}-{d} {h}:{i}:{s}&#39;) 的方式格式化，然后设置列宽度为 150px，以避免该列被撑大。&lt;/p&gt;
&lt;p&gt;5、对于 el-table 组件，如果指定了每一列的长度，那么当页面拉长时，就会导致表格列前后多出空框，因此需要保证至少有一列的长度不是指定的。&lt;/p&gt;
&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;1、如果要为 &lt;code&gt;el-select&lt;/code&gt; 绑定默认值，需要注意，其 &lt;code&gt;v-model&lt;/code&gt; 绑定的是字符值，不能绑定对象类型。如果绑定了对象类型，&lt;code&gt;key-label-value&lt;/code&gt; 部分正常的话，可是正常使用，但是实现不了默认值效果。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vue/">Vue</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/element-ui/">Element-UI</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>golang 操作单点 Redis 代码示例</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-redis/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-redis/</guid>
                <pubDate>Sun, 03 Nov 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了使用 golang 操作单点 redis 时的一些示例代码，可以经过改造应用到程序中去。&lt;/p&gt;
&lt;p&gt;我们基于 golang-redis 这个库封装了一些函数，作为代码示例，也方便使用。&lt;/p&gt;
&lt;h3 id=&#34;创建-redis-客户端&#34;&gt;创建 Redis 客户端&lt;/h3&gt;
&lt;p&gt;使用以下代码创建一个 Redis 客户端，需要提供 redis 的地址（IP:Port），密码和数据库索引&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func NewRedisClient(address string, password string, index int) (*redis.Client, error) {
	client := redis.NewClient(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;redis.Options{
		Addr:     address,
		Password: password,
		DB:       index,
	})

	return client, client.Ping().Err()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;创建键值对&#34;&gt;创建键值对&lt;/h3&gt;
&lt;p&gt;创建永不过期的 key-value&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func Set(client *redis.Client, key string, value string) error {
	return client.Set(key, value, 0).Err()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建含过期时间的 key-value&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func SetWithDuration(client *redis.Client, key string, value string, duration time.Duration) error {
	return client.Set(key, value, duration).Err()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对于 redis，创建和更新的操作效果一样&lt;/p&gt;
&lt;h3 id=&#34;删除键值对&#34;&gt;删除键值对&lt;/h3&gt;
&lt;p&gt;删除一个 key-value&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func Delete(client *redis.Client, key string) error {
	return  client.Del(key).Err()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;删除一组 key-value&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func DeleteKeys(client *redis.Client, keys ...string) error {
	return client.Del(keys...).Err()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;删除数据库&#34;&gt;删除数据库&lt;/h3&gt;
&lt;p&gt;删除 redis 数据库所有数据，使用异步删除，主线程会把删除任务交给异步线程来完成删除任务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func DeleteDB(client *redis.Client) error {
	return client.FlushAllAsync().Err()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;删除当前 redis 数据库，如果想要删除其他的 redis 数据库，需要构造 map 存储各个 redis 数据库的客户端，想删除指定的数据库时，取出其客户端即可&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func DeleteCurrentDB(client *redis.Client) error {
	return client.FlushDBAsync().Err()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;查询键值数据&#34;&gt;查询键值数据&lt;/h3&gt;
&lt;p&gt;获取 key-value&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func Get(client *redis.Client, key string) (string, error) {
	return client.Get(key).Result()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;模糊查询 key，此操作有危险性，在数据量大时非常消耗性能&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func GetByKeyName(client *redis.Client, key string) ([]string, error) {
	var values []string
	err := client.Keys(fmt.Sprintf(&amp;#34;*%s*&amp;#34;, key)).ScanSlice(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;values)
	if err != nil {
		return values, err
	}

	return values, nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;模糊查询 value，获取所有的 key，然后根据 key 获取 value，再进行筛选，返回由 key-value 组成的 map，此操作会有性能问题，可作为开发和测试环境使用，绝对不能应用于生产环境。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func GetByValue(client *redis.Client, value string) (map[string]string, error) {
	var keys []string

	err := client.Keys(&amp;#34;*&amp;#34;).ScanSlice(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;keys)
	if err != nil {
		return nil, err
	}

	result := make(map[string]string)
	for _, k := range keys {
		v, err := client.Get(k).Result()
		if err != nil {
			continue
		}
		if strings.Contains(v, value) {
			result[k] = v

		}
	}

	return result, nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;官方 Github 仓库地址&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/go-redis/redis&#34;&gt;https://github.com/go-redis/redis&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>golang 数值处理</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-number/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-number/</guid>
                <pubDate>Sun, 03 Nov 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了使用 golang 进行数值处理时可能会用到的一些代码。&lt;/p&gt;
&lt;p&gt;使用 strconv 包中的方法来进行字符串到数值的转换，math 包封装了常用的基本函数。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import (
	&amp;#34;fmt&amp;#34;
	&amp;#34;math&amp;#34;
	&amp;#34;strconv&amp;#34;
)

func main() {
	// 计算 2 的 5 次方
	fmt.Println(math.Pow(2, 5))
	percent := &amp;#34;23.456&amp;#34;
	
	// 使用 strconv 包的 ParseFloat 方法将字符串转换为 float64
	result, _ := strconv.ParseFloat(percent, 32)
	// 使用 fmt 包的 Sprintf 方法实现保留小数点后两位
	fmt.Println(fmt.Sprintf(&amp;#34;%.2f&amp;#34;, result))
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/string2number/">String2Number</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>人间世·杂五</title>
                <link>https://xdhuxc.github.io/posts/human/human-world-mixed-five/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/human/human-world-mixed-five/</guid>
                <pubDate>Sun, 03 Nov 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;        华为被美国列入“实体名单”后，已经七十多岁、一向低调不见记者的任正非先生出面，主动召开记者会，谈了很多事情，后来又见了一些国内外的记者，说了一些问题。一向低调、不接受采访的任正非先生主动召开记者会，这说明这件事情对华为来说非常严重，即使不是像中兴那样事关生死存亡，也是非常严重的事情。这可能是两方面的考虑，一方面是华为公司的士气和信心，需要由精神核心人物来稳定和提振，其他角色的人已经起不到这样的作用了；另一方面，是对社会关切的回应和对我们国家技术领域的回应，华为有信心、有能力应对美国的制裁。中兴事件发生后，整个社会对于我国自主技术的信心一落千丈，这种回应对内对外都是非常必要和及时的。&lt;/p&gt;
&lt;p&gt;　　任正非先生的公开讲话，很多人都看了，但有些人是直接理解语义，这让我感到有些奇怪，这些话恐怕不是表面上的那些意思吧！&lt;/p&gt;
&lt;p&gt;　　有些事情很精彩，任正非先生在用一种战略的方式和美国作斗争。&lt;/p&gt;
&lt;p&gt;　　华为每年向美国公司购买上百亿美元的产品和服务，即使自己设计和生产的有些芯片优于美国产品，也要坚持购买。这对华为来说，将会带来两个方面的重大好处，一方面，目前美国企业的芯片设计和软件技术依然是最先进的，在国内和世界其他地区和国家没有可以和华为比肩的产品的情况下，购买过来的美国产品既可以用于华为自己的产品，同时也可以用来学习，仿制和寻找差距，为自己产品的发展提供支持；另一方面，这上百亿美元的产品和服务将会为美国很多高科技企业贡献收入从而其利润，若有不测，就像目前的情况，这些公司将会处在华为和美国政府之间，在微弱意义上，将会成为华为在美国的“代言人”。毕竟，对于商业公司来说，损失的可是真金白银啊，大多数商人和股东可不会在乎其他的东西，等于是将美国公司的经济利益主动捆绑在华为身上。而且，美国的高科技公司大多是上市公司，若有不测，股票价格就会下跌，效果将会非常显著。此处需要说明，这样的操作需要战略思考及其能力，强大的组织及其能力，巨大的体量和资金流动，才能运转得过来，也才可能取胜。不是什么个人和（或）组织都可以作自己的B计划的，也需要具备前述条件，B计划才会真正有价值。&lt;/p&gt;
&lt;p&gt;　　至于华为推出的“鸿蒙”操作系统，所有人都说生态是最重要的问题，但其实，这个问题的考虑点可能在其他方面。剔除操作系统和应用软件本身的技术方面问题，我们关注下面这些方面，一、一旦华为正式在手机上推出其“鸿蒙”操作系统，从民族情绪和商业公司的角度来看，国内其他手机厂商和应用厂商必须主动或被动支持和适配“鸿蒙”操作系统，否则就可能陷入对内被政府怀疑、被民众唾弃，对外被美国封禁的灭亡境况。以中国手机厂商在整个全球范围内的手机销量占比和日常应用数量占比，加之国内众多的开发者和商业软件的成熟，中长期来看，“鸿蒙”操作系统及其生态将肯定会发展起来的，生态也不会是太大的问题。二、华为必须考虑小米、OV、中兴等其他手机厂商和其他业务关联公司的发展考虑，自己以什么样的方式做哪些，不做哪些，必须明文承若且绝对遵守，否则很难说会发生什么（有一则新闻说，小米和OV等手机厂商准备共同做一种可以在不同品牌手机之间传输文件的功能，可能会预置到手机上，但这个联盟中却没有华为）。生态的核心是什么，自己搭舞台，让别人来表演，用户来观看付费，就是说，自己做基础的承载平台，让别人做上层的面向用户的应用，让别人先于自己赚到钱，否则，生态肯定是发展不起来的（最为经典的反面案例就是百度云盘等，正面案例就是淘宝、微信、“快抖”和苹果商店等）。华为现在的业务产品在横向和（或）纵向地向各个方向扩展，很容易树敌太多导致其他公司表面友好或沉默，实际不合作，从而造成自己的孤立。这是很危险的，其他类型的企业可以在垄断的情况下孤立存在，但是互联网相关的企业绝对不可以、也不可能孤立存在，互联网本身的特性就决定了这一点。我们相信以任正非先生的战略思考能力，应该是不会让这样的事情发生的。三、google 禁止华为使用其系统和产品及服务，这将导致华为的海外用户将无法使用google的服务，从而海外用户购买华为手机的意愿肯定会降低，对其海外业务将会造成挫折。如果“鸿蒙”操作系统及其生态逐步发展起来，对于google 来说，其业务将可能会遭受损失。伴随着Android操作系统的替代，国内的应用软件也将获得随着“鸿蒙”操作系统出海的先机（对于普通用户来说，内置的软件往往就成了某个方面的默认应用），从而为我国的应用软件向国际市场发展提供助力，google和其他美国公司的应用和服务会怎么样呢，我们可以拭目以待。&lt;/p&gt;
&lt;p&gt;　　在最近的一次记者采访中，任正非先生表示，华为将把自己在5G领域的专利毫无保留地一次性卖给美国公司，换句话说，美国政府禁止美国企业买东西给华为，斩断了华为和美国公司之间的直接经济利益关系。但是反过来，现在华为有东西可以卖给美国公司，将两者之间的直接经济利益关系再次连接起来。通过卖5G相关专利给美国公司，华为一方面可以得到收入，同时也打进了美国市场，扩大了华为的影响力和标准话语权，因为卖技术专利的同时，也是在输出标准，一旦使用了华为的专利，也非常可能在关联方面依赖于华为。一句话，又一次主动将美国公司的经济利益捆绑到华为这边来，毕竟大多数商人和股东是不会在乎其他东西的。&lt;/p&gt;
&lt;p&gt;　　另外，华为也放出风来，自己已经启动了6G的研究。这也是高明的斗争策略。以华为、中兴和中国移动等为代表的中国公司目前显然已经在5G的标准制定和应用中走在了国际前列。但5G还没有进入全面商用，现在处于渐次铺开，前途大好的状况。这样宣布造成的结果可能是，欧美日韩看到在5G的标准制定中自己已经不占优势，就可能会放弃5G的进一步研究和发展，仅仅通过中国的技术来做5G应用（钱还是要赚的），转而投入资源去发展6G，希望在6G的标准制定中有自己的一席之地。但是，4G主要应用在智能手机带来的个人用户消费中，已经基本满足个人用户的需求，5G将主要应用在工农业等生产活动中，对于个人用户不会有显著的体验提升，那么6G呢，技术难度和标准肯定比5G更高，从而投入的人力和财力更多，研发难度更大，如果没有商业场景供其应用从而获得收入，这项研究就可能会把很多公司和研究机构给拖死。如果欧美日韩放弃或动摇5G进一步的研究和发展而转向6G，对于我国企业来说，将会获得一个更大的时间窗口期，可以扩大我们的优势。&lt;/p&gt;
&lt;p&gt;　　至于为什么会存在这种可能的情况呢，因为就像很多人简单分析的那样，从1G、2G到3G、4G，再到5G，一路发展过来，国家层面的行业兴衰，通信科技巨头的交椅变换，社会生活和生产的急剧变化，让很多人以为这种趋势会不断延续下去，但情况是会变化的，就连技术本身的发展也并非总是线性的。在我们上大二时，有位教授网络的老师说，“网络带宽啊，能够供大家看部小电影，就足够了”。这句话让我感到很有趣，我原来没有注意这个问题，但老师说得是对的。有些事物，当其数量或（和）质量增长到某个阈值后，其继续增长带来的变化，对于个人来说，在这个方向上，已经没有实际使用的意义了。但有意思的是，当人们去观察这个事物时，往往还停留在那个阈值之前的发展过程中观察，得出一些乱七八糟的结论。一个很典型的例子就是是网络带宽，对于网络带宽，如果某个时空域中的网络带宽足够其中的所有人看清晰度最高的视频，那么网络带宽的继续增加对于这些人而言就没有丝毫实际使用的意义（对于很多个体的人和（或）组织来讲，装逼的意义可以附加在任何事物上，只要他们自己喜欢这么做）。我们姑且称之为“大跃定理”吧。所以，5G对于个人用户的直接使用，相比于现在广泛使用的4G网络，有多大的实际提升价值呢？我们拭目以待吧。&lt;/p&gt;
&lt;p&gt;　　任正非先生的谈话、态度、思想、战略、宣传、组织、管理等诸多方面，都能看到毛主席的影子，“学毛著标兵”确实名副其实。与此形成鲜明对比的是那些学习所谓“成功学”的人，是多么地愚蠢和可笑！&lt;/p&gt;
&lt;p&gt;　　在这事情发生时，社会上有各种各样的言论冒出来，能够客观公正看待问题的人较少，情绪化看待的人比较多，有些人甚至连“买国货就是爱国”背后的道理都搞不明白，有人居然把这句话给变成了“爱国就是买国货”，这逻辑水平也是够让人瞠目结舌的了。有意思的是，美国的制裁在全世界范围内给华为做了免费的广告，效应极其强大（美国政府和美国总统的广告效应无人能比，更不要说那些明星），极大地改变了智能手机厂商销售市场的份额占比。在国内市场，大量的中国人通过购买华为手机来支持华为，华为在智能手机销售市场的占比进一步提升，小米和苹果的市场占比下滑比较明显。如果这是一个市场化的过程，不夹杂民族情绪的话，应该不会这么快。&lt;/p&gt;
&lt;p&gt;　　我们也衷心祝愿华为取得更好的发展，为我们国家的科学和技术，为全人类的发展作出更大的贡献！&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 golang 操作 excel 表格</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-excel/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-excel/</guid>
                <pubDate>Tue, 22 Oct 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;使用 golang 操作 excel 表格，写了些示例代码，封装了几个常用的函数，特此记录，以备后查。&lt;/p&gt;
&lt;p&gt;使用 excelize 库 来进行 excel 的操作，项目地址为：https://github.com/360EntSecGroup-Skylar/excelize&lt;/p&gt;
&lt;h3 id=&#34;示例代码&#34;&gt;示例代码&lt;/h3&gt;
&lt;p&gt;以下代码演示了创建 excel 表格并向其中添加数据的方法，其中用到的函数见下文。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import (
	&amp;#34;fmt&amp;#34;
	&amp;#34;strconv&amp;#34;
    &amp;#34;time&amp;#34;
	
	&amp;#34;github.com/360EntSecGroup-Skylar/excelize&amp;#34;
	log &amp;#34;github.com/sirupsen/logrus&amp;#34;
)

type User struct {
	ID int &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;id&amp;#34;`&lt;/span&gt;
	Name string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;name&amp;#34;`&lt;/span&gt;
	Address string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;address&amp;#34;`&lt;/span&gt;
}

func main() {
	users := []User{
		{
			ID: 1,
			Name: &amp;#34;孔子&amp;#34;,
			Address: &amp;#34;山东曲阜&amp;#34;,
		},
		{
			ID: 2,
			Name: &amp;#34;牛顿&amp;#34;,
			Address: &amp;#34;英国伦敦&amp;#34;,
		},
		{
			ID: 3,
			Name: &amp;#34;凯撒&amp;#34;,
			Address: &amp;#34;罗马&amp;#34;,
		},
	}

	f := excelize.NewFile()
	sheetName := &amp;#34;人物信息&amp;#34;
	sheet := f.NewSheet(sheetName)
	f.SetActiveSheet(sheet)

	// 合并单元格
	err := f.MergeCell(sheetName, &amp;#34;A1&amp;#34;, &amp;#34;A5&amp;#34;)

	header := map[string]interface{}{&amp;#34;A1&amp;#34;: &amp;#34;编号&amp;#34;, &amp;#34;B1&amp;#34;: &amp;#34;姓名&amp;#34;, &amp;#34;C1&amp;#34;:&amp;#34;地址&amp;#34;}
	data := GenerateData(users, header)
	err = Write2File(&amp;#34;历史人物&amp;#34;, sheetName, data, true)
	if err != nil {
		log.Errorln(err)
	}
	
	Read(&amp;#34;/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/go-study-notes/历史人物_2019-10-22_.xlsx&amp;#34;)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;读取-excel-文件&#34;&gt;读取 excel 文件&lt;/h3&gt;
&lt;p&gt;以下代码为读取 excel 表格的代码，要求：文件路径需要是绝对路径，excel 表格中不包含合并的单元格&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func Read(fileFullPath string) {
	f, err := excelize.OpenFile(fileFullPath)
	if err != nil {
		log.Fatal(err)
	}

	for sheetIndex, sheetName := range f.GetSheetMap() {
		fmt.Println(sheetIndex, &amp;#34;---&amp;gt;&amp;#34;, sheetName)
		rows, err := f.Rows(sheetName)
		if err != nil {
			log.Errorln(err)
			continue
		}
		for rows.Next() {
			// 获取一行
			cols, err := rows.Columns()
			if err != nil {
				log.Errorln(err)
				continue
			}
			// 获取行数组中的值
			for _, colCell := range cols {
				fmt.Println(colCell)
			}
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;组织数据&#34;&gt;组织数据&lt;/h3&gt;
&lt;p&gt;我们将数据组织成 map 数组格式，每个数组元素为 excel 表格中的一行，map 中的每个键表示 excel 中的一个位置，比如A1，B2，C3等，其值为需要填充到该单元格中的值，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func GenerateData(users []User, header map[string]interface{}) []map[string]interface{} {
	var maps []map[string]interface{}
	var m map[string]interface{}

	maps = append(maps, header)
	rowCount := 1
	for _, user := range users {
		index := strconv.Itoa(rowCount)
		m = map[string]interface{}{
			&amp;#34;A&amp;#34;+index: user.ID,
			&amp;#34;B&amp;#34;+index: user.Name,
			&amp;#34;C&amp;#34;+index: user.Address,
		}

		maps = append(maps, m)
		rowCount = rowCount + 1
	}

	return maps
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;写-excel-文件&#34;&gt;写 excel 文件&lt;/h3&gt;
&lt;p&gt;将组织好的 map 数组写入文件中&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;// 写数据到 excel 中，每个 map[string]interface{} 为一行数据，键为A1，B2，C3等等
func Write2File(fileName string, sheetName string, data []map[string]interface{}, dateContaining bool) error {
	f := excelize.NewFile()

	sheet := f.NewSheet(sheetName)
	f.SetActiveSheet(sheet)

	for _, item := range data {
		for k, v := range item {
			err := f.SetCellValue(sheetName, k, v)
			if err != nil {
				log.Errorln(err)
				continue
			}
		}
	}

	// 删除 Sheet1
	f.DeleteSheet(&amp;#34;Sheet1&amp;#34;)

	if dateContaining {
		return f.SaveAs(fileName + &amp;#34;_&amp;#34; + time.Now().Format(&amp;#34;2006-01-02&amp;#34;) + &amp;#34;_&amp;#34; + &amp;#34;.xlsx&amp;#34;)
	} else {
		return f.SaveAs(fileName + &amp;#34;.xlsx&amp;#34;)
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;合并单元格&#34;&gt;合并单元格&lt;/h3&gt;
&lt;p&gt;使用 MergeCell 方法可以合并单元格&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;err := f.MergeCell(sheetName, &amp;#34;A1&amp;#34;, &amp;#34;A5&amp;#34;)
if err != nil {
    log.Errorln(err)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上代码将合并 A1~A5 的单元格，并以单元格 A5 的内容填充合并后的单元格。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/360EntSecGroup-Skylar/excelize&#34;&gt;https://github.com/360EntSecGroup-Skylar/excelize&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/excel/">Excel</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>升级 NPM 和 Node</title>
                <link>https://xdhuxc.github.io/posts/programming/javascript/javascript-node-npm/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/javascript/javascript-node-npm/</guid>
                <pubDate>Wed, 16 Oct 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;记录下 npm 和 node 的升级方法。&lt;/p&gt;
&lt;h3 id=&#34;升级-nodejs&#34;&gt;升级 NodeJS&lt;/h3&gt;
&lt;p&gt;npm 中有一个模块叫做 n，专门用来做 node.js 版本管理的。&lt;/p&gt;
&lt;p&gt;使用如下命令更新 node.js 到最新版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;npm install -g n # 安装 n 模块
n stable         # 更新到最新稳定版的 node.js
n latest         # 更新到最新版本的 node.js
n v10.14.2       # 更新到指定版本的 node.js
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;升级-npm&#34;&gt;升级 npm&lt;/h3&gt;
&lt;p&gt;使用如下命令升级 npm&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;npm -g install npm@next
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;查看当前-nodejs-版本对-es6-的支持程度&#34;&gt;查看当前 node.js 版本对 ES6 的支持程度&lt;/h3&gt;
&lt;p&gt;可以通过 es-checker 工具查看当前 node.js 版本对 ES6 的支持程度&lt;/p&gt;
&lt;p&gt;1、安装 es-checker&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;npm install -g es-checker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、使用 es-checker 命令检测&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:ushareit-hawkeye-frontend wanghuan$ node -v
v10.14.2
wanghuans-MacBook-Pro:ushareit-hawkeye-frontend wanghuan$ es-checker

ECMAScript 6 Feature Detection (v1.4.1)

Variables
  √ let and const
  √ TDZ error for too-early access of let or const declarations
  √ Redefinition of const declarations not allowed
  √ destructuring assignments/declarations for arrays and objects
  √ ... operator

Data Types
  √ For...of loop
  √ Map, Set, WeakMap, WeakSet
  √ Symbol
  √ Symbols cannot be implicitly coerced

Number
  √ Octal (e.g. 0o1 ) and binary (e.g. 0b10 ) literal forms
  √ Old octal literal invalid now (e.g. 01 )
  √ Static functions added to Math (e.g. Math.hypot(), Math.acosh(), Math.imul() )
  √ Static functions added to Number (Number.isNaN(), Number.isInteger() )

String
  √ Methods added to String.prototype (String.prototype.includes(), String.prototype.repeat() )
  √ Unicode code-point escape form in string literals (e.g. \u{20BB7} )
  √ Unicode code-point escape form in identifier names (e.g. var \u{20BB7} = 42; )
  √ Unicode code-point escape form in regular expressions (e.g. var regexp = /\u{20BB7}/u; )
  √ y flag for sticky regular expressions (e.g. /b/y )
  √ Template String Literals

Function
  √ arrow function
  √ default function parameter values
  √ destructuring for function parameters
  √ Inferences for function name property for anonymous functions
  × Tail-call optimization for function calls and recursion

Array
  √ Methods added to Array.prototype ([].fill(), [].find(), [].findIndex(), [].entries(), [].keys(), [].values() )
  √ Static functions added to Array (Array.from(), Array.of() )
  √ TypedArrays like Uint8Array, ArrayBuffer, Int8Array(), Int32Array(), Float64Array()
  √ Some Array methods (e.g. Int8Array.prototype.slice(), Int8Array.prototype.join(), Int8Array.prototype.forEach() ) added to the TypedArray prototypes
  √ Some Array statics (e.g. Uint32Array.from(), Uint32Array.of() ) added to the TypedArray constructors

Object
  √ &lt;span class=&#34;gs&#34;&gt;__proto__&lt;/span&gt; in object literal definition sets [[Prototype]] link
  √ Static functions added to Object (Object.getOwnPropertySymbols(), Object.assign() )
  √ Object Literal Computed Property
  √ Object Literal Property Shorthands
  √ Proxies
  √ Reflect

Generator and Promise
  √ Generator function
  √ Promises

Class
  √ Class
  √ super allowed in object methods
  √ class ABC extends Array { .. }

Module
  × Module export command
  × Module import command


=========================================
Passes 39 feature Detections
Your runtime supports 92% of ECMAScript 6
=========================================
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到，当前 node.js 版本 v10.14.2 对 ES6 的支持程度达到 92 %。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/javascript/">JavaScript</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/node/">Node</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/npm/">npm</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 Grafana 监控 Clickhouse</title>
                <link>https://xdhuxc.github.io/posts/devops/prometheus/prometheus-grafana-clickhouse/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/prometheus/prometheus-grafana-clickhouse/</guid>
                <pubDate>Thu, 10 Oct 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;公司有业务使用到了 Clickhouse，需要使用 prometheus 监控 Clickhouse，展示 Clickhouse 集群的指标信息，于是进行了一番探索，特此记录。&lt;/p&gt;
&lt;p&gt;使用 github 上的 &lt;a href=&#34;https://github.com/f1yegor/clickhouse_exporter&#34;&gt;https://github.com/f1yegor/clickhouse_exporter&lt;/a&gt; 项目提供的 clickhouse_exporter 来收集 Clickhouse 的指标信息。&lt;/p&gt;
&lt;p&gt;1、克隆 clickhouse_exporter 工程到本地&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git clone https://github.com/f1yegor/clickhouse_exporter
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、编译&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;make build
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意使用交叉编译的方式编译目标操作系统上的可执行文件，给文件添加执行权限后，移动至 /usr/bin 目录下&lt;/p&gt;
&lt;p&gt;3、部署
以 Linux 系统服务方式运行 &lt;code&gt;clickhouse_exporter&lt;/code&gt;，&lt;code&gt;clickhouse_exporter.service&lt;/code&gt;（&lt;code&gt;/usr/lib/systemd/system/clickhouse_exporter.service&lt;/code&gt;）文件内容为：：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=clickhouse_exporter
Documentation=http://www.clickhouse_exporter.io/
After=network.target

[Service]
Type=simple
Environment=&amp;#34;CLICKHOUSE_USER=default&amp;#34;
Environment=&amp;#34;CLICKHOUSE_PASSWORD=&amp;#34;
ExecStart=/usr/bin/clickhouse_exporter -scrape_uri=http://192.168.33.10:8123/
Restart=always

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在非默认情况下，通过 &lt;code&gt;CLICKHOUSE_USER&lt;/code&gt; 和 &lt;code&gt;CLICKHOUSE_PASSWORD&lt;/code&gt; 环境变量指定 clickhouse 的认证信息；&lt;code&gt;http://192.168.33.10:8123/&lt;/code&gt; 为 &lt;code&gt;clickhouse&lt;/code&gt; 运行的端点&lt;/p&gt;
&lt;p&gt;4、在 prometheus.yaml 文件中增加如下内容并重启&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;global:
  scrape_interval:     1s
  evaluation_interval: 1s

scrape_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: clickhouse
    static_configs:
      &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;127.0.0.1:9116&amp;#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;127.0.0.1:9116&lt;/code&gt; 为 &lt;code&gt;clickhouse_exporter&lt;/code&gt; 运行的端点，如果有多个，以 yaml 格式数组书写在 &lt;code&gt;targets&lt;/code&gt; 处&lt;/p&gt;
&lt;p&gt;5、向 grafana 中加入 clickhouse 仪表板&lt;/p&gt;
&lt;p&gt;参考以下链接处的文档向 grafana 中加入 clickhouse 仪表板&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://grafana.com/grafana/dashboards/882&#34;&gt;https://grafana.com/grafana/dashboards/882&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/f1yegor/clickhouse_exporter&#34;&gt;https://github.com/f1yegor/clickhouse_exporter&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://grafana.com/grafana/dashboards/882&#34;&gt;https://grafana.com/grafana/dashboards/882&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/grafana/">Grafana</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/clickhouse/">clickhouse</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Golang flag 包读取参数怪事</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-args/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-args/</guid>
                <pubDate>Sun, 29 Sep 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;使用 golang 的 flag 包读取命令行参数，然而，奇怪的事情发生了，读取到的 redis 密码是错误的，这很奇怪，本地验证 redis 密码没有问题，但是代码中就是认证失败，于是研究了一下，特此记录。&lt;/p&gt;
&lt;p&gt;使用 golang 的 flag 包读取命令行参数，然而，奇怪的事情发生了，读取到的 redis 密码是错误的。这很奇怪，本地验证 redis 密码没有问题，但是代码中就是认证失败，于是研究了一下，特此记录。&lt;/p&gt;
&lt;p&gt;测试使用的系统和 golang 版本如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:one wanghuan$ go version
go version go1.12.9 darwin/amd64
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;测试使用的代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import (
	&amp;#34;flag&amp;#34;
	&amp;#34;fmt&amp;#34;
	&amp;#34;os&amp;#34;
)

var password string

func init() {
	flag.StringVar(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;password, &amp;#34;password&amp;#34;, &amp;#34;&amp;#34;, &amp;#34;the password to authenticate with (only used with vault and etcd backends)&amp;#34;)
}

func main() {
	fmt.Printf(&amp;#34;the args is %s\n&amp;#34;, os.Args)

	flag.Parse()

	fmt.Printf(&amp;#34;the password is %s\n&amp;#34;, password)

	if password == &amp;#34;qZ2XisdsdgGiLSf0b$HBL#LDLUG5uUGr8v0&amp;#34; {
		fmt.Println(true)
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;测试的结果如下：
1、$ 在 # 之前&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:one wanghuan$ ./flag --password qZ2XisdsdgGiLSf0b$HBL#LDLUG5uUGr8v0
the args is [./flag --password qZ2Xis#dsdg#Gi#LSf0b#LDLUG5uUGr8v0]
the password is qZ2XisdsdgGiLSf0b#LDLUG5uUGr8v0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对比结果：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;qZ2XisdsdgGiLSf0b$HBL#LDLUG5uUGr8v0
qZ2XisdsdgGiLSf0b    &lt;span class=&#34;ni&#34;&gt;#LDLUG5uUGr8v0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到，去除了 $ 到 # 之间的字符，结果包含 #，不包含 $。&lt;/p&gt;
&lt;p&gt;2、$ 在最后一个 # 之后&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:one wanghuan$ ./flag --password qZ2XisdsdgGiLSf0bHBL#LDL$UG5uUGr8v0
the args is [./flag --password qZ2XisdsdgGiLSf0bHBL#LDL]
the password is qZ2XisdsdgGiLSf0bHBL#LDL
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对比结果：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;qZ2XisdsdgGiLSf0bHBL#LDL$UG5uUGr8v0
qZ2XisdsdgGiLSf0bHBL#LDL
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到，去除了 $ 及其之后的字符串&lt;/p&gt;
&lt;p&gt;3、$ 在最后一个 # 之前&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:one wanghuan$ ./flag --password qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0
the args is [./flag --password qZ2Xisdsdg#GiL#Sf0b#LDLUG5u#UGr8v0]
the password is qZ2Xisdsdg#GiL#Sf0b#LDLUG5u#UGr8v0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对比结果&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0
qZ2Xisdsdg#GiL#Sf0b    &lt;span class=&#34;ni&#34;&gt;#LDLUG5u#UGr8v0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到，和第一种情况类似，去除了 $ 到其之后的第一个 # 之间的字符&lt;/p&gt;
&lt;p&gt;根据以上实验可以看出：
1）$ 及其之后的字符被 &amp;quot;吞&amp;quot; 掉了，看起来是 $ 及其之后到第一个 # 之间的字符被 Shell 当做变量解释了。&lt;/p&gt;
&lt;p&gt;2）从 args 的值可以看出，在参数进入到 golang 程序之前， $ 及其之后到第一个 # 之间的字符已经被 Shell 当做变量解释完毕。&lt;/p&gt;
&lt;p&gt;要解决这个问题，其实很简单，给含 $ 的字符串加上引号（单引号或双引号都可以）就可以了。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:one wanghuan$ ./flag --password &amp;#39;qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0&amp;#39;
the args is [./flag --password qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0]
the password is qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>人间世·意识·二</title>
                <link>https://xdhuxc.github.io/posts/human/human-world-consciousness-two/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/human/human-world-consciousness-two/</guid>
                <pubDate>Sat, 28 Sep 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;        除去在深度睡眠状态下和死亡状态下，人的意识必须时时刻刻被某种东西填充着，这东西可能是吸烟时的惆怅、焦虑或无聊，或是不停地滑动着屏幕刷微博或微信，或是坐公交或地铁时耳机里的声音，或是各视频网站上的视频，或是感官系统当前获得的信息，或是对过去的记忆或其回想，或是对未来的规划和漫无目的的遐想，或是读一本有趣的书籍等等，总是不会处于空洞的状态，直到其彻底失去意识活动。根据研究，在轻度睡眠状态下，人的大脑可以得到休息，但就像所有人都能感觉到的那样，我们的意识在这种情况下依然在活动，在轻微地和舒适地活动，甚至是更加随机地活动。&lt;/p&gt;
&lt;p&gt;　　“如果想让地里不长杂草，方法其实是唯一的，那就是在地里种上麦子”，这话是佛祖说的还是苏格拉底说的，我就不清楚了，可能需要去问他们。人的意识必须被某种东西占据着，所以，如果人没有用一种有益于其自身的东西（比如读书、写作、学习外语、工作、适度的娱乐、运动等活动）去占据它，那么它就会被其他的、挤进来的东西（比如各种信息流软件）占据着并浪费着，或处于一种轻松的漫无目的的遐想之中，呆呆地感受着这个世界。&lt;/p&gt;
&lt;p&gt;　　这种意识的填充性可以分为两种类型：一类是空洞填充，人的意识仅仅是被某种存在物主动地或被动地占据着，仅仅如此，没有其他的意义了，一般对应着人的自然属性；另一类是价值填充，某种存在物先入为主地占据着人的意识，从而这人对其他类似的存在物进行排斥，表现为总是习惯性地用这种存在物来解释事物，一般对应着人的社会属性。&lt;/p&gt;
&lt;p&gt;　　空洞填充就像上面介绍的那样，仅仅是占据着人的意识。真正值得研究的是价值填充，这里面会有一些对我们有意义的东西。&lt;/p&gt;
&lt;p&gt;　　&amp;quot;人性&amp;quot;是个伪概念！（此处参见《人间世·四·意识·一》）&lt;/p&gt;
&lt;p&gt;　　&amp;quot;人性&amp;quot;这个概念被提出来，就是在理论层面上，从根本上和源头上来规范人的所有行为的。无论是“性善论”、“性恶论”还是“环境塑造论”，都是肯定“人性”这个东西是存在的，都是认为有一种东西在普遍地约束和规定着人的行为。但是，为什么有这个规定着人的行为的东西存在呢？其实就是提出来安慰人心的，用这样一个概念，从根本上和源头上解释人的行为，尤其是解释这样一类事物：人的社会属性和人的自然属性相矛盾着的地方，就是说，按照社会公共价值准则，事情应该如此来做，但总会有些人，使用不符合这公共价值准则的方式来做，其他人不接受这种做法，但也奈何不了，就会习惯性地使用“人性使然”来解释。由于“人性”是人的天性，内在地决定了这事情，所以就强迫自己从心理上接受（这种精神、心理和价值观上的煎熬行为和状态参见《人间世·七·人·七》），从而在意识中填充了对这问题的解释。这种做法对人自身的心理、精神、价值追求、社会认同等有了个交代，填充着那个位置，而不管那个位置究竟是个什么样的具体的存在物，最为根本的动因是，保护了自己的心灵安全、精神安全和价值观念安全。&lt;/p&gt;
&lt;p&gt;　　有很多理论，大体都是如此，比如，“经济人”或“理性经济人”这样的概念，一个逻辑构造出来的、现实中根本不存在的东西，却可以在它上面构造很多理论的大厦，用来解释一些现象和问题，实际上仅仅是在接受者的头脑中填充一个对问题的解释而已，并不反映实际的情况。如果这些接受者扔掉那些先入为主的概念和理论，自己去根据自己现实的经验和观察去思考和解释这些现象和问题，把粒度考虑得细一点，逻辑流程更加紧凑一点，尽量发散到现实的场景而不是给出解释者构造的特定逻辑场景，多问几个“为什么”，相信很多人自己就可以探寻出答案。很多问题和现象的答案没有那么难以探究，也简单不到单一因素就可以决定。&lt;/p&gt;
&lt;p&gt;　　意识的填充性也意味着一般情况下，人的思想及思维会慢慢地走向固化，也就是人对其周围的事物已经无法再产生新的认知了。&lt;/p&gt;
&lt;p&gt;　　每当说起一些事物时，我们可能会发现，有些人对这事物的认知，一年前是这样，现在还是这样，三年后可能还是那样，五年后可能还是那样，十年后可能还是那样，甚至二十年后可能还是那样。一个人总是在变化，其所处的外部环境总是在变化，事物的内外部环境也总是在变化，但是一个人对事物的认知却基本没有变化，岂非怪事？&lt;/p&gt;
&lt;p&gt;　　当人在意识中对某个事物形成一定的认知后，这种认知就会在头脑中占据着这事物的若干部分。当有新的与这事物相关的东西进入大脑后，原有的认知部分或全部地或被增强、或被颠覆、或被反向、或被改变、或者保持原样，但总是在已有的认知基础上进行的，而不是全新地建立。在普遍的情况下，人的意识排斥新的同类的或同样的东西，因为他们认为这“新的同类的或同样的东西”和自己意识中已经存在的某个事物相同。这其中包含两个方面的原因：一，作为生物的人懒得动，尤其是大脑懒得运动；二，作为社会化的人，接受新的同类的或同样的东西，就必须替换掉原有的，在意识层面上意味着对前一个自己的特定认知的否定，在实践上往往比这高一个层面，意味着对前一个自己的否定。注意，实际上否定的只是自己对某事物的某个方面的认知，但真正实践的时候，已经转变成了对自己的否定。这样的因素导致一般情况下，人们不愿意去替换掉头脑中已被占据着的位置，从而导致自己的思想和思维的固化。&lt;/p&gt;
&lt;p&gt;　　对于中国人来说，主观上的原因往往在于，没有多少人真正地把知识应用到生活和工作中去，并对这些知识进行同化、改造、升级、丰富，往往仅仅是将知识作为原始资料搬来搬去，就像我们平时听过的各种传说一样。&lt;/p&gt;
&lt;p&gt;　　一个人思想和思维固化的一个结果和显著表现就是总是先入为主地看待事物，而没有注意到当前事物和自己意识中的那个事物其实可能有很大的区别。就像前面提及的一样，事物总是在变，然而并不是每个人都能抓住不变的脉络。&lt;/p&gt;
&lt;p&gt;　　导致有些人总是先入为主地看待事物的原因有很多，此处只说目前最常见的一种：以微信公众号、今日头条为代表的互联网媒体的碎片化知识和信息的传播，一方面普及了这些知识，推广了这些信息，但对于接收者来说，这些逻辑的未经自己推敲和自身实践的知识，往往本身不足以完整地解释和解决问题，从而在实践层面上没法使用，但很多人还是选择相信并且勇敢地应用了。从外部来看的话，每当说起一个事物时，我们可能会发现，有些人对某事物的认知，好像在哪里听说过。是的，确实是听说过，而且是到处听过过同一种奇怪的观点。但是，难道就没有这个人自己的认识吗，难道这个人对这事情的认知就是一大堆“经典理论”的集合吗？&lt;/p&gt;
&lt;p&gt;　　当前，社会舆论上最鲜明的特点是，以政治正确、女性正确、欧美正确、反欧美正确、道德正确、反道德正确、弱势群体正确、流氓正确、禽兽正确等为代表的“正确理论”先入为主地对各种事物的正误对错进行了规定，其组成的密集交叉火力网把中国人的反思精神及能力和变革精神及能力死死地压制住。这很符合现代文明的精神核心：虚伪，将一切攫取利益的手段隐藏在光鲜的、无可辩驳的旗帜之下，让异己的其他所有人都无话可说。实用的和革命的中国人会怎样对待这些垃圾玩意儿呢？我们拭目以待。&lt;/p&gt;
&lt;p&gt;　　这是一种认知上的死亡，也是精神上的死亡！对个体的人来说，就好像，一个人被死锁在一个圆球里面，满目所及，满脑所想，都是自己头脑中已经出现过无数遍的事物，一遍，一遍，又一遍地循环，不断地向自己的意识中强化已有的认知，不断地深化这种已有的存在。&lt;/p&gt;
&lt;p&gt;　　写《人间世》，也是因为我自己陷入了这种困境，陷入了思想和思维的僵化困境，又总是看到别人先入为主地看待事物，这让我感到很恐惧。难道若干年后，我还是今天这个样子吗，对特定事物的观点还是以前的那点内容吗，仅仅是自己的年龄增长了？不，这不是我想要的。我要把这些东西写下来，把自己头脑中的垃圾全部清理出来，也作为自己曾经记忆的一部分保存下来。&lt;/p&gt;
&lt;p&gt;　　总体上来说，意识的这种填充性是一种安全保护机制，作为生物的人需要时时刻刻对外部环境变化保持警惕以保护自己，作为社会化的人需要时时刻刻填充着自己的意识以保护人的心理和精神上的安全，但是却造成了很多人的思想和意识僵化，现在更是作为时间消费经济的主力支撑。&lt;/p&gt;
&lt;p&gt;　　对于个人意识的占据，有两种极端的情况，也是很有意思的对比。有些人按照这个社会的资源分配规则，将自己的意识用可以获得更多社会认可的方式去占据它。这些人占据了社会资源分配的制高点，在最初偶然地通过这种方式实现自己的获得感和成就感后，沿着这条道路一直走，一直走，人生的整个过程中都在不断地增加获得感和占据更多的资源。这其中，有些人用分钟来计算自己的时间，把每一件事，工作、吃饭、睡觉、学习、娱乐、交通等等所有事情的时间都精确到分钟级别，上下浮动若干分钟，每一件事也都精确到具体的目的并显化在意识中，将自己的意识完全占据，而且是若干年如一日地坚持执行下去。有些人是这样的，使用刷微信、刷微博、刷抖音、刷今日头条、刷淘宝、看剧、打游戏等方式来占据自己的意识，时间粒度在小时级别甚至更大范围上，同样地若干年如一日地坚持执行下去。&lt;/p&gt;
&lt;p&gt;　　两者对比起来就有意思了，看起来就像这样：
　　&lt;center&gt;
　　　　&lt;img src=&#34;https://xdhuxc.github.io/image/human/consciousness-two/004201.png&#34;  width=&#34;800px&#34; height=&#34;５00px&#34;/&gt;
　　&lt;/center&gt;&lt;/p&gt;
&lt;p&gt;　　一般情况下，“优秀”派占据着包括舆论和价值观话语权在内的大量社会资源，唯有称颂，否则就是不上进，政治不正确！“刷”派占据着巨量的人口，不能评价，否则肯定会群情汹汹，惹出一堆乱七八糟的事情来。不过我们可以提个问题，一般地，我们都会认为工作和娱乐是个人活动和存在的一部分，但是对这两部分人来说，恐怕已经不是部分了，可能已经占据了一个人所有的意识。是否可以认为，这两种极端情况下，人都成为了自己的工具，成为了填充自己意识的工具，成为了某种组织（上图中的对端，在高一个层级上，这种活动的另一端是谁）的工具？&lt;/p&gt;
&lt;p&gt;　　对于有些女性和小孩，如果不从外部找些有益的事情占据她们的意识，那么她们就会自己倒腾出些事情来，恐怕就不是大家所期望的样子了。&lt;/p&gt;
&lt;p&gt;　　还有个有趣的现象，在一些人对自己的兴趣爱好的叙述中，出现了“睡觉”一词，换句话说，“睡觉”成为了他们的兴趣爱好。&lt;/p&gt;
&lt;p&gt;　　当把人从繁重的体力和（或）脑力劳动中暂时性地或永久性地解放出来后，人干什么去呢？
　
　　市场经济给出的解答，中国人满意吗？&lt;/p&gt;
&lt;p&gt;　　腾讯（微信、游戏（王者荣耀、绝地求生等）、腾讯视频等）、阿里巴巴（天猫、淘宝等）、京东（京东商城）、今日头条（今日头条、抖音等）、新浪（微博）等互联网企业给出的解答，中国人满意吗？&lt;/p&gt;
&lt;p&gt;　　每一个中国人，当自己面临这个问题的时候，对于自己的解答解答，自己满意吗？&lt;/p&gt;
&lt;p&gt;　　这个问题，是否存在统一的和通用的解答呢？如果有，会是什么呢？&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Golang 将 GB2312编码的汉字 转为 UTF-8 编码的汉字</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-gb2312-to-utf8/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-gb2312-to-utf8/</guid>
                <pubDate>Thu, 26 Sep 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;golang 中的所有字符使用 UTF-8 编码，当源文件中包含中文，编码是 GB2312 或 GBK 时，就可以在输出中产生乱码。&lt;/p&gt;
&lt;p&gt;由于 golang 中的所有字符使用 UTF-8 编码，当我们处理的文件中包含中文、编码为 GB2312 或 GBK时，输出这些字符串时就会产生乱码，比如从 Windows 上 excel 中导出的 csv 文件，包含的中文用 GB2312 编码，使用 golang 读取时就会产生乱码。此时，我们需要读取数据后，进行转码，以保证输出正确。&lt;/p&gt;
&lt;p&gt;示例代码如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import (
&amp;#34;fmt&amp;#34;

&amp;#34;github.com/axgle/mahonia&amp;#34;
)

func main() {

	decoder := mahonia.NewDecoder(&amp;#34;GBK&amp;#34;)
	// hello, 涓栫晫
	fmt.Println(decoder.ConvertString(&amp;#34;hello, 世界&amp;#34;))

	dataInBytes := []byte{0xC4, 0xE3, 0xBA, 0xC3, 0xA3, 0xAC, 0xCA, 0xC0, 0xBD, 0xE7, 0xA3, 0xA1}

	// 你好，世界！
	fmt.Println(decoder.ConvertString(string(dataInBytes)))
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，GBK 不要写为 GB2312，由于 GBK 兼容 GB2312，所以使用 GB2312 编码的汉字可以直接使用 GBK 进行解码。&lt;/p&gt;
&lt;p&gt;不要使用 &lt;code&gt;github.com/djimenez/iconv-go&lt;/code&gt; 包，此包中使用了 C 库，在本地（macOS Mojave 10.14.6）可以运行，但在交叉编译时会出问题，其编写的程序到其他平台运行会比较麻烦。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://www.haodaquan.com/94&#34;&gt;http://www.haodaquan.com/94&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/axgle/mahonia&#34;&gt;https://github.com/axgle/mahonia&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E5%AD%97%E7%AC%A6%E9%9B%86/">字符集</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-questions-and-solution/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-questions-and-solution/</guid>
                <pubDate>Wed, 25 Sep 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要记录一些在使用 Python 语言进行开发的过程中经常遇到的问题及其可能的解决方法，记录下来以备后需。&lt;/p&gt;
&lt;h3 id=&#34;modulenotfounderror-no-module-named-crypto&#34;&gt;ModuleNotFoundError: No module named &#39;Crypto&#39;&lt;/h3&gt;
&lt;p&gt;代码里面从 Crypto 中导入 AES 类，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;from Crypto.Cipher import AES
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;已经安装了 Crypto 包，但是执行时还是报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Traceback (most recent call last):
  File &amp;#34;/Users/wanghuan/PycharmProjects/scmp-dingtalk-callback/xyzdfg.py&amp;#34;, line 7, in &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    from Crypto.Cipher import AES
ModuleNotFoundError: No module named &amp;#39;Crypto&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 python 3 中，包名已经变成了 pycryptodomex 或 pycryptodome，使用如下命令安装 pycryptodomex 包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;pip install pycryptodomex
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改导入代码为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;from Cryptodome.Cipher import AES
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;python-环境的-docker-容器看不到-print-函数的输出&#34;&gt;Python 环境的 Docker 容器看不到 print() 函数的输出&lt;/h3&gt;
&lt;p&gt;编写 python 脚本，使用 docker 容器运行，启动命令为 &lt;code&gt;ENTRYPOINT [&amp;quot;python3&amp;quot;, &amp;quot;/usr/local/bin/test.py&amp;quot;]&lt;/code&gt;，容器启动正常，脚本执行正常，但是使用 &lt;code&gt;docker logs&lt;/code&gt; 命令却不见 &lt;code&gt;print()&lt;/code&gt; 函数的输出内容。
原因：&lt;/p&gt;
&lt;p&gt;python 的缓存机制，stdout 和 stderr 默认都是指向屏幕的，但 stderr 是无缓存的，程序向 stderr 输出的字符，会直接打印到屏幕上。而 stdout 是有缓存的，只有遇到换行或积累到一定的大小，才会输出到屏幕上。&lt;/p&gt;
&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;python 命令后面加上 &lt;code&gt;-u&lt;/code&gt; （unbuffered）参数，强制其标准输出不通过缓存，直接打印到屏幕上。所以，将 &lt;code&gt;Dockerfile&lt;/code&gt; 中的 &lt;code&gt;ENTRYPOINT&lt;/code&gt; 命令改写为：&lt;code&gt;ENTRYPOINT [&amp;quot;python3&amp;quot;, &amp;quot;-u&amp;quot;, &amp;quot;/usr/local/bin/test.py&amp;quot;]&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;脚本运行时间长&#34;&gt;脚本运行时间长&lt;/h3&gt;
&lt;p&gt;python 程序运行时间特别长，一个脚本运行了一个小时才出结果，使用 line_profiler 进行分析，发现在迭代时使用了 hasattr() 进行属性存在判断，导致占用时间特别长。&lt;/p&gt;
&lt;h3 id=&#34;valueerror-embedded-null-byte&#34;&gt;ValueError: embedded null byte&lt;/h3&gt;
&lt;p&gt;执行脚本时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Traceback (most recent call last):
  File &amp;#34;/Users/wanghuan/PycharmProjects/common_test/image_table.py&amp;#34;, line 59, in &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    request_id = request_api(image_bin)
  File &amp;#34;/Users/wanghuan/PycharmProjects/common_test/image_table.py&amp;#34;, line 20, in request_api
    image = get_file_content(image_bin)
  File &amp;#34;/Users/wanghuan/PycharmProjects/common_test/image_table.py&amp;#34;, line 14, in get_file_content
    with open(file_path, &amp;#39;rb+&amp;#39;) as fp:
ValueError: embedded null byte
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;检查一下代码，可能是函数中调用了函数自身。&lt;/p&gt;
&lt;h3 id=&#34;xe8xb4xbexe5xbfx97xe7x8cx9b&#34;&gt;\xe8\xb4\xbe\xe5\xbf\x97\xe7\x8c\x9b&lt;/h3&gt;
&lt;p&gt;使用 pymysql 连接数据库时，取回的数据中的中文不是 unicode 码，而是如下的乱码。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;#39;\xe8\xb4\xbe\xe5\xbf\x97\xe7\x8c\x9b&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建数据库连接时，原来没有指定字符集，默认的字符集是从文件 &lt;code&gt;/etc/my.cnf&lt;/code&gt; 中的 &lt;code&gt;default-character-set&lt;/code&gt; 配置项读取而来，如果没有该文件或者该配置项，则默认的字符集为：&lt;code&gt;utf8mb4&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;解决：创建数据库连接时，显式指定字符集为 utf8&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;db = pymysql.connect(&amp;#39;127.0.0.1&amp;#39;, &amp;#39;root&amp;#39;, &amp;#39;Xdhuxc375&amp;#39;, &amp;#39;xdhuxc&amp;#39;, charset=&amp;#39;utf8&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;ascii-codec-cant-decode-byte-0xe4-in-position-40-ordinal-not-in-range128&#34;&gt;&#39;ascii&#39; codec can&#39;t decode byte 0xe4 in position 40: ordinal not in range(128)&lt;/h3&gt;
&lt;p&gt;使用 Python 开始时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;#39;ascii&amp;#39; codec can&amp;#39;t decode byte 0xe4 in position 40: ordinal not in range(128)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：在文件代码开头处增加如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;reload(sys)                      # reload 才能调用 setdefaultencoding 方法
sys.setdefaultencoding(&amp;#39;utf-8&amp;#39;)  # 设置 &amp;#39;utf-8&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;json-dumps-字典数据时出现乱码&#34;&gt;json dumps 字典数据时出现乱码&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{&amp;#34;msg&amp;#34;: &amp;#34;\u5ba2\u6237\u7aef\u8bf7\u6c42\u9519\u8bef\uff0c\u7f3a\u5c11\u67e5\u8be2\u53c2\u6570 secretkey \u6216
otp\u3002&amp;#34;, &amp;#34;code&amp;#34;: 4}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：添加 ensure_ascii=False 参数，ensure_ascii=True 保证 dumps() 之后的结果里所有的字符都能够被 ascii 表示，因此经过 dumps() 以后的str里，汉字会变成对应的 unicode。因此，当字典中含有中文时，一定要使用 ensure_ascii=False。&lt;/p&gt;
&lt;h3 id=&#34;docker-logs-命令却不见-print-函数的输出内容&#34;&gt;&lt;code&gt;docker logs&lt;/code&gt; 命令却不见 &lt;code&gt;print()&lt;/code&gt; 函数的输出内容&lt;/h3&gt;
&lt;p&gt;编写 python 脚本，使用 docker 容器运行，启动命令为 &lt;code&gt;ENTRYPOINT [&amp;quot;python3&amp;quot;, &amp;quot;/usr/local/bin/test.py&amp;quot;]&lt;/code&gt;，容器启动正常，脚本执行正常，但是使用 &lt;code&gt;docker logs&lt;/code&gt; 命令却不见 &lt;code&gt;print()&lt;/code&gt; 函数的输出内容。&lt;/p&gt;
&lt;p&gt;原因：python 的缓存机制，stdout 和 stderr 默认都是指向屏幕的，但 stderr 是无缓存的，程序向 stderr 输出的字符，会直接打印到屏幕上。而 stdout 是有缓存的，只有遇到换行或积累到一定的大小，才会输出到屏幕上。&lt;/p&gt;
&lt;p&gt;解决：python 命令后面加上 &lt;code&gt;-u&lt;/code&gt; （unbuffered）参数，强制其标准输出不通过缓存，直接打印到屏幕上。所以，将 &lt;code&gt;Dockerfile&lt;/code&gt; 中的 &lt;code&gt;ENTRYPOINT&lt;/code&gt; 命令改写为：&lt;code&gt;ENTRYPOINT [&amp;quot;python3&amp;quot;, &amp;quot;-u&amp;quot;, &amp;quot;/usr/local/bin/test.py&amp;quot;]&lt;/code&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Happy 颖</title>
                <link>https://xdhuxc.github.io/posts/mixed/fireworks/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/fireworks/</guid>
                <pubDate>Sun, 08 Sep 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;body&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;bomb-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;normal-rocket&#34;&gt;&lt;/div&gt;
    &lt;div&gt;
    &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;春江花月夜
    &lt;br&gt;
    &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;唐&amp;nbsp;张若虚
    &lt;br&gt;
    春江潮水连海平，海上明月共潮生。
     &lt;br&gt;
    滟滟随波千万里，何处春江无月明！
     &lt;br&gt;
    江流宛转绕芳甸，月照花林皆似霰；
     &lt;br&gt;
    空里流霜不觉飞，汀上白沙看不见。
     &lt;br&gt;
    江天一色无纤尘，皎皎空中孤月轮。
     &lt;br&gt;
    江畔何人初见月？江月何年初照人？
     &lt;br&gt;
    人生代代无穷已，江月年年望相似。
     &lt;br&gt;
    不知江月待何人，但见长江送流水。
     &lt;br&gt;
    白云一片去悠悠，青枫浦上不胜愁。
     &lt;br&gt;
    谁家今夜扁舟子？何处相思明月楼？
     &lt;br&gt;
    可怜楼上月徘徊，应照离人妆镜台。
     &lt;br&gt;
    玉户帘中卷不去，捣衣砧上拂还来。
     &lt;br&gt;
    此时相望不相闻，愿逐月华流照君。
     &lt;br&gt;
    鸿雁长飞光不度，鱼龙潜跃水成文。
     &lt;br&gt;
    昨夜闲潭梦落花，可怜春半不还家。
     &lt;br&gt;
    江水流春去欲尽，江潭落月复西斜。
     &lt;br&gt;
    斜月沉沉藏海雾，碣石潇湘无限路。
     &lt;br&gt;
    不知乘月几人归，落月摇情满江树。
    &lt;/div&gt;
    &lt;div class=&#34;text&#34;&gt;✨Happy 颖🎉🎉✨&lt;/div&gt;
    &lt;style type=&#34;text/css&#34;&gt;
    	body {
    	  top: 200px;
    	  width: 100%;
    	  height: 100%;
    	  background: -webkit-radial-gradient(bottom ellipse, #1b2735 0%, #090a0f 100%);
    	  background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
    	}
    	.text {
    	  position: absolute;
    	  left: 50%;
    	  top: 50%;
    	  width: 80%;
    	  -webkit-transform: translate(-50%, -50%);
    	          transform: translate(-50%, -50%);
    	  text-align: center;
    	  font-size: 9vw;
    	  font-family: &#39;Concert One&#39;, cursive;
    	  -webkit-animation: text-animation 5s linear infinite alternate;
    	          animation: text-animation 5s linear infinite alternate;
    	}
    	@-webkit-keyframes text-animation {
    	  from {
    	    color: white;
    	    text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #fff, 0 0 40px #FFDD1B, 0 0 70px #FFDD1B, 0 0 80px #FFDD1B, 0 0 100px #FFDD1B, 0 0 150px #FFDD1B;
    	  }
    	  to {
    	    color: white;
    	    text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px #ff0080, 0 0 30px #ff0080, 0 0 40px #ff0080, 0 0 55px #ff0080, 0 0 75px #ff0080;
    	    text-align: center;
    	  }
    	}
    	@keyframes text-animation {
    	  from {
    	    color: white;
    	    text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #fff, 0 0 40px #FFDD1B, 0 0 70px #FFDD1B, 0 0 80px #FFDD1B, 0 0 100px #FFDD1B, 0 0 150px #FFDD1B;
    	  }
    	  to {
    	    color: white;
    	    text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px #ff0080, 0 0 30px #ff0080, 0 0 40px #ff0080, 0 0 55px #ff0080, 0 0 75px #ff0080;
    	    text-align: center;
    	  }
    	}
    	.bomb-rocket, .normal-rocket {
    	  position: absolute;
    	  bottom: 0;
    	  width: 30px;
    	  height: 30px;
    	  border-radius: 100%;
    	  -webkit-animation-timing-function: linear;
    	          animation-timing-function: linear;
    	  -webkit-animation-iteration-count: infinite;
    	          animation-iteration-count: infinite;
    	}
    	.bomb-rocket:nth-child(1) {
    	  left: 91vw;
    	  -webkit-animation-name: bomb-rocket-animate-2;
    	          animation-name: bomb-rocket-animate-2;
    	  -webkit-animation-delay: 1.3s;
    	          animation-delay: 1.3s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: red;
    	}
    	.normal-rocket:nth-child(16) {
    	  left: 19vw;
    	  -webkit-animation-name: normal-rocket-animate-2;
    	          animation-name: normal-rocket-animate-2;
    	  -webkit-animation-delay: 0.1s;
    	          animation-delay: 0.1s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: red;
    	}
    	.bomb-rocket:nth-child(2) {
    	  left: 8vw;
    	  -webkit-animation-name: bomb-rocket-animate-3;
    	          animation-name: bomb-rocket-animate-3;
    	  -webkit-animation-delay: 1.5s;
    	          animation-delay: 1.5s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: springgreen;
    	}
    	.normal-rocket:nth-child(17) {
    	  left: 3vw;
    	  -webkit-animation-name: normal-rocket-animate-3;
    	          animation-name: normal-rocket-animate-3;
    	  -webkit-animation-delay: 0.8s;
    	          animation-delay: 0.8s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: turquoise;
    	}
    	.bomb-rocket:nth-child(3) {
    	  left: 7vw;
    	  -webkit-animation-name: bomb-rocket-animate-1;
    	          animation-name: bomb-rocket-animate-1;
    	  -webkit-animation-delay: 1s;
    	          animation-delay: 1s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: yellow;
    	}
    	.normal-rocket:nth-child(18) {
    	  left: 57vw;
    	  -webkit-animation-name: normal-rocket-animate-1;
    	          animation-name: normal-rocket-animate-1;
    	  -webkit-animation-delay: 0.3s;
    	          animation-delay: 0.3s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: turquoise;
    	}
    	.bomb-rocket:nth-child(4) {
    	  left: 48vw;
    	  -webkit-animation-name: bomb-rocket-animate-2;
    	          animation-name: bomb-rocket-animate-2;
    	  -webkit-animation-delay: 0.2s;
    	          animation-delay: 0.2s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: hotpink;
    	}
    	.normal-rocket:nth-child(19) {
    	  left: 2vw;
    	  -webkit-animation-name: normal-rocket-animate-2;
    	          animation-name: normal-rocket-animate-2;
    	  -webkit-animation-delay: 2s;
    	          animation-delay: 2s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: yellow;
    	}
    	.bomb-rocket:nth-child(5) {
    	  left: 67vw;
    	  -webkit-animation-name: bomb-rocket-animate-3;
    	          animation-name: bomb-rocket-animate-3;
    	  -webkit-animation-delay: 1.5s;
    	          animation-delay: 1.5s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: turquoise;
    	}
    	.normal-rocket:nth-child(20) {
    	  left: 4vw;
    	  -webkit-animation-name: normal-rocket-animate-3;
    	          animation-name: normal-rocket-animate-3;
    	  -webkit-animation-delay: 1.7s;
    	          animation-delay: 1.7s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: yellow;
    	}
    	.bomb-rocket:nth-child(6) {
    	  left: 13vw;
    	  -webkit-animation-name: bomb-rocket-animate-1;
    	          animation-name: bomb-rocket-animate-1;
    	  -webkit-animation-delay: 0.2s;
    	          animation-delay: 0.2s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: red;
    	}
    	.normal-rocket:nth-child(21) {
    	  left: 21vw;
    	  -webkit-animation-name: normal-rocket-animate-1;
    	          animation-name: normal-rocket-animate-1;
    	  -webkit-animation-delay: 0.3s;
    	          animation-delay: 0.3s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: deepskyblue;
    	}
    	.bomb-rocket:nth-child(7) {
    	  left: 78vw;
    	  -webkit-animation-name: bomb-rocket-animate-2;
    	          animation-name: bomb-rocket-animate-2;
    	  -webkit-animation-delay: 0.3s;
    	          animation-delay: 0.3s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: springgreen;
    	}
    	.normal-rocket:nth-child(22) {
    	  left: 80vw;
    	  -webkit-animation-name: normal-rocket-animate-2;
    	          animation-name: normal-rocket-animate-2;
    	  -webkit-animation-delay: 1.7s;
    	          animation-delay: 1.7s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: hotpink;
    	}
    	.bomb-rocket:nth-child(8) {
    	  left: 29vw;
    	  -webkit-animation-name: bomb-rocket-animate-3;
    	          animation-name: bomb-rocket-animate-3;
    	  -webkit-animation-delay: 0.2s;
    	          animation-delay: 0.2s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: deepskyblue;
    	}
    	.normal-rocket:nth-child(23) {
    	  left: 57vw;
    	  -webkit-animation-name: normal-rocket-animate-3;
    	          animation-name: normal-rocket-animate-3;
    	  -webkit-animation-delay: 1.9s;
    	          animation-delay: 1.9s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: turquoise;
    	}
    	.bomb-rocket:nth-child(9) {
    	  left: 66vw;
    	  -webkit-animation-name: bomb-rocket-animate-1;
    	          animation-name: bomb-rocket-animate-1;
    	  -webkit-animation-delay: 0.4s;
    	          animation-delay: 0.4s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: springgreen;
    	}
    	.normal-rocket:nth-child(24) {
    	  left: 85vw;
    	  -webkit-animation-name: normal-rocket-animate-1;
    	          animation-name: normal-rocket-animate-1;
    	  -webkit-animation-delay: 1.8s;
    	          animation-delay: 1.8s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: turquoise;
    	}
    	.bomb-rocket:nth-child(10) {
    	  left: 49vw;
    	  -webkit-animation-name: bomb-rocket-animate-2;
    	          animation-name: bomb-rocket-animate-2;
    	  -webkit-animation-delay: 1.9s;
    	          animation-delay: 1.9s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: yellow;
    	}
    	.normal-rocket:nth-child(25) {
    	  left: 78vw;
    	  -webkit-animation-name: normal-rocket-animate-2;
    	          animation-name: normal-rocket-animate-2;
    	  -webkit-animation-delay: 1.1s;
    	          animation-delay: 1.1s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: turquoise;
    	}
    	.bomb-rocket:nth-child(11) {
    	  left: 87vw;
    	  -webkit-animation-name: bomb-rocket-animate-3;
    	          animation-name: bomb-rocket-animate-3;
    	  -webkit-animation-delay: 1.5s;
    	          animation-delay: 1.5s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: hotpink;
    	}
    	.normal-rocket:nth-child(26) {
    	  left: 37vw;
    	  -webkit-animation-name: normal-rocket-animate-3;
    	          animation-name: normal-rocket-animate-3;
    	  -webkit-animation-delay: 1.8s;
    	          animation-delay: 1.8s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: deepskyblue;
    	}
    	.bomb-rocket:nth-child(12) {
    	  left: 86vw;
    	  -webkit-animation-name: bomb-rocket-animate-1;
    	          animation-name: bomb-rocket-animate-1;
    	  -webkit-animation-delay: 1.7s;
    	          animation-delay: 1.7s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: hotpink;
    	}
    	.normal-rocket:nth-child(27) {
    	  left: 29vw;
    	  -webkit-animation-name: normal-rocket-animate-1;
    	          animation-name: normal-rocket-animate-1;
    	  -webkit-animation-delay: 0.8s;
    	          animation-delay: 0.8s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: hotpink;
    	}
    	.bomb-rocket:nth-child(13) {
    	  left: 97vw;
    	  -webkit-animation-name: bomb-rocket-animate-2;
    	          animation-name: bomb-rocket-animate-2;
    	  -webkit-animation-delay: 0.6s;
    	          animation-delay: 0.6s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: deepskyblue;
    	}
    	.normal-rocket:nth-child(28) {
    	  left: 8vw;
    	  -webkit-animation-name: normal-rocket-animate-2;
    	          animation-name: normal-rocket-animate-2;
    	  -webkit-animation-delay: 0.8s;
    	          animation-delay: 0.8s;
    	  -webkit-animation-duration: 4s;
    	          animation-duration: 4s;
    	  color: springgreen;
    	}
    	.bomb-rocket:nth-child(14) {
    	  left: 92vw;
    	  -webkit-animation-name: bomb-rocket-animate-3;
    	          animation-name: bomb-rocket-animate-3;
    	  -webkit-animation-delay: 0.6s;
    	          animation-delay: 0.6s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: hotpink;
    	}
    	.normal-rocket:nth-child(29) {
    	  left: 37vw;
    	  -webkit-animation-name: normal-rocket-animate-3;
    	          animation-name: normal-rocket-animate-3;
    	  -webkit-animation-delay: 0.5s;
    	          animation-delay: 0.5s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: yellow;
    	}
    	.bomb-rocket:nth-child(15) {
    	  left: 1vw;
    	  -webkit-animation-name: bomb-rocket-animate-1;
    	          animation-name: bomb-rocket-animate-1;
    	  -webkit-animation-delay: 2s;
    	          animation-delay: 2s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: hotpink;
    	}
    	.normal-rocket:nth-child(30) {
    	  left: 48vw;
    	  -webkit-animation-name: normal-rocket-animate-1;
    	          animation-name: normal-rocket-animate-1;
    	  -webkit-animation-delay: 2s;
    	          animation-delay: 2s;
    	  -webkit-animation-duration: 5s;
    	          animation-duration: 5s;
    	  color: red;
    	}
    	@-webkit-keyframes bomb-rocket-animate-1 {
    	  0% {
    	    -webkit-transform: rotate(-10deg) translateY(0) scale(0);
    	            transform: rotate(-10deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@keyframes bomb-rocket-animate-1 {
    	  0% {
    	    -webkit-transform: rotate(-10deg) translateY(0) scale(0);
    	            transform: rotate(-10deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@-webkit-keyframes bomb-rocket-animate-2 {
    	  0% {
    	    -webkit-transform: rotate(0deg) translateY(0) scale(0);
    	            transform: rotate(0deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(0deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(0deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@keyframes bomb-rocket-animate-2 {
    	  0% {
    	    -webkit-transform: rotate(0deg) translateY(0) scale(0);
    	            transform: rotate(0deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(0deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(0deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@-webkit-keyframes bomb-rocket-animate-3 {
    	  0% {
    	    -webkit-transform: rotate(10deg) translateY(0) scale(0);
    	            transform: rotate(10deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(10deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(10deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@keyframes bomb-rocket-animate-3 {
    	  0% {
    	    -webkit-transform: rotate(10deg) translateY(0) scale(0);
    	            transform: rotate(10deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(10deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(10deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@-webkit-keyframes normal-rocket-animate-1 {
    	  0% {
    	    -webkit-transform: rotate(-10deg) translateY(0) scale(0);
    	            transform: rotate(-10deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@keyframes normal-rocket-animate-1 {
    	  0% {
    	    -webkit-transform: rotate(-10deg) translateY(0) scale(0);
    	            transform: rotate(-10deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	            transform: rotate(-10deg) translateY(-50vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@-webkit-keyframes normal-rocket-animate-2 {
    	  0% {
    	    -webkit-transform: rotate(0deg) translateY(0) scale(0);
    	            transform: rotate(0deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(0deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(0deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@keyframes normal-rocket-animate-2 {
    	  0% {
    	    -webkit-transform: rotate(0deg) translateY(0) scale(0);
    	            transform: rotate(0deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(0deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(0deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	            transform: rotate(0deg) translateY(-60vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@-webkit-keyframes normal-rocket-animate-3 {
    	  0% {
    	    -webkit-transform: rotate(10deg) translateY(0) scale(0);
    	            transform: rotate(10deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(10deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(10deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
    	@keyframes normal-rocket-animate-3 {
    	  0% {
    	    -webkit-transform: rotate(10deg) translateY(0) scale(0);
    	            transform: rotate(10deg) translateY(0) scale(0);
    	    opacity: 1;
    	    box-shadow: none;
    	  }
    	  0.1% {
    	    -webkit-transform: rotate(10deg) translateY(0) scale(0.1, 0.5);
    	            transform: rotate(10deg) translateY(0) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);
    	    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);
    	    background: linear-gradient(180deg, currentColor 0%, #000000 80%);
    	    box-shadow: none;
    	    opacity: 1;
    	  }
    	  50.1% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;
    	    opacity: 1;
    	  }
    	  75% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 1;
    	  }
    	  100% {
    	    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	            transform: rotate(10deg) translateY(-70vh) scale(0.1);
    	    background: transparent;
    	    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;
    	    opacity: 0;
    	  }
    	}
       &lt;/style&gt;
&lt;/body&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/css/">CSS</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>人间世·杂七</title>
                <link>https://xdhuxc.github.io/posts/human/human-world-mixed-seven/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/human/human-world-mixed-seven/</guid>
                <pubDate>Sun, 08 Sep 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;        有一天，我去超市买东西，买了半个西瓜和几条黄瓜，我留意看了下两张单子上的价格尾数，都是4。但是在收银台结算的时候，收银员最后却告诉我，“15元”。我很疑惑，两个4相加，怎么变成零了？于是，我仔细看了下单子，西瓜总价7.24元，黄瓜7.74元，并把单子给两位收银员阿姨看，她们仔细看了下后，突然想起什么来了，告诉我，“这是收银机四舍五入的结果”。好吧，我明白了。
　　对于超市来说，按照这种四舍五入的逻辑收银，那就意味着尾数为5、6、7、8、9的时候，向上进位，分别多收0.05元、0.04元、0.03元、0.02元、0.01元；尾数为1、2、3、4时，向下取整，分别损失0.01元、0.02元、0.03元、0.04元；尾数为0时，既不多收，也不损失。那么，在完全随机的情况下，也就是现实生活中，尾数为0、1、2、3、4、5、6、7、8、9的概率都是0.1，于是，在平均意义上，就有：
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/human/mixed-seven/020701.png&#34;/&gt;
&lt;/center&gt;
　　Xi在多收时为正值，在损失时为负值，于是就有：&lt;/p&gt;
&lt;p&gt;　　E(X)=0&lt;em&gt;0.1-0.01&lt;/em&gt;.01-0.02&lt;em&gt;0.1-0.03&lt;/em&gt;0.1-0.04&lt;em&gt;0.1+0.05&lt;/em&gt;0.1+0.04&lt;em&gt;0.1+0.03&lt;/em&gt;0.1+0.02&lt;em&gt;0.1+0.01&lt;/em&gt;0.1=0.005(元)&lt;/p&gt;
&lt;p&gt;　　这个数值E(X)的含义是：在平均意义上，每笔收银可以多获得0.005元。在收银次数F非常大的情况下，每笔收银将会真的平均多获得0.005元左右，F的值越大，这个值将会越接近0.005元，总共多获得F*0.005元。&lt;/p&gt;
&lt;p&gt;　　这个0.005元多不多呢？无论是就其数值本身来说，还是其占一笔收银账款的相对值来讲，其实都可以忽略不计。但在其和收银次数 F 相乘之后，这个数值可能就不小了，就变成了每千笔收银多收入5元。那么，如果一家超市年收银次数在百万次（等价于每月83334次，每天2778次，不太清楚能有多少超市达到甚至超过这个数值。我们强调的是，互联网时代和超级城市产生的量变引起的质变，重点不在于超市收银这一场景），就意味着会多出来近5千元左右的收入，这个数值差不多可以负担一两个收银员一个月的工资了。2018年个税改革之后，8000万人将不用再缴纳个人所得税了，翻译成人话来说，就是有 8000万人在2018年时的月收入在3500~5000元这个区间附近，2018年之前肯定比这更低。与此同时，共和国还有与此数量相当的人口属于贫困人口，根据一种让人感到不可思议的贫困标准划分的。&lt;/p&gt;
&lt;p&gt;　　考虑到这样一个社会现实，社会总体上是向前进步的，发展着的；但是很多组织和个人是不可信的，有着自己的特殊想法的。基于此，我们做如下恶意猜想：对于称重类的商品，如果对电子秤做手脚，在其计算的时候（因为人可以很容易地控制这个计算逻辑，如果做得高明，可能还需要参考商品单价和其质量的关系，以避免被怀疑），总是将尾数上调至5、6、7、8、9中随机一个，那么在收银计算时，无论其他商品总价如何，至少有一件商品为超市带来了平均0.005元的贡献，从而最后的实际期望就变成了：（假设含称重类商品的收银次数占到总收银次数的四分之三）&lt;/p&gt;
&lt;p&gt;　　E(X)≥ 0.75*(0.05*0.1 + 0.04*0.1 + 0.03*0.1 + 0.02*0.1 + 0.01*0.1) - 0.25*(0.04*0.1 + 0.03*0.1 + 0.02*0.1 + 0.01*0.1)=0.00875(元)&lt;/p&gt;
&lt;p&gt;　　对于一家年收银次数达到甚至超过百万次的超市来说，稍微有点儿特殊的想法，可能就又多赚差不多一个收银员一个月的工资。嗯，是的，是这样的。&lt;/p&gt;
&lt;p&gt;　　实际上，这点钱对于一家超市来说，可能微不足道，但对于一个工薪阶层的人来说，还是能算上让其心疼的钱的。&lt;/p&gt;
&lt;p&gt;　　这是为什么呢？其实原因可能是这样的，这是历史的遗留问题，原来使用纸币支付时，找零，尤其是货币的最小单位分这个太麻烦，对于超市和顾客都麻烦，而且已经渐渐没有流通中的人民币分了，于是收银机就把“四舍五入”的功能给直接做到其总计功能中去了，但电子支付使得可以精确地支付到人民币分这一最小货币单位，这就暴露出来问题了。而电子支付和纸币支付同时使用使得这个问题将会长期存在。但是如果在默认使用电子结算和支付的机器上进行“四舍五入”，那么就不好说是历史遗留问题还是有意为之了。&lt;/p&gt;
&lt;p&gt;　　0.01元，这究竟是什么呢？&lt;/p&gt;
&lt;p&gt;　　这是以货币形式表现的抽象的无差别的人类劳动。价值是什么？价值是凝结在商品中无差别的人类劳动。这个结论起始于这样一种思考，甲商品和乙商品能够进行交换，这是为什么呢？是什么使得它们能够交换的？必然是它们两者都包含的某种同质的东西，外部表现为数量关系？这种同质的东西，在人们探索争论之后，确定为：无差别的人类劳动，并基于此解释人类社会的政治经济问题。&lt;/p&gt;
&lt;p&gt;　　于是，0.01元、一滴水、一度电、一顿饭、一件衣服、一个苹果、一本书、一克黄金等等，所有这些通过商品交换获得的东西，都包含着同质的存在物：无差别的人类劳动。有意思的事情就是这样子的，有些人在浪费包括食物、水、电等资源性的和消耗（区别于正常的使用）服务性（比如怼服务员、快递员等）的无差别人类劳动时，内心没有一丝波动，甚至还往往会有莫名其妙的优越感；但是这些人下一秒可能就会抱怨996、007，或调侃自己的贫穷了。践踏别人的劳动时如此随心自然，甚至理直气壮，被别人践踏时，各种申冤抱屈理论就迸发出来了，“我是知识流氓，我怕谁？”。一粥一饭，当思来之不易；半丝半缕，恒念物力维艰，劳动是多么辛苦的一件事，这些人恐怕是知道的吧！然而，如果没有珍惜这种无差别的人类劳动的意识和行动，无论增量和（或）存量情况怎么样，这种无差别的人类劳动总是不够用的，因为那个很简单的道理啊。像国人这样有意识地和（或）无意识地浪费资源，甚至是炫耀式地浪费，如果共和国的城市化水平达到知识分子们所谓的&amp;quot;国际标准&amp;quot;，这地球如何承受得了？&lt;/p&gt;
&lt;p&gt;　　某月，我租住的房子门上贴了水费单，共105元。于是，我就缴了105元水费，然后将缴费页面截图发到四户租住的人群里。随后，其他三户分别发了微信红包给我，竟然不约而同地发了27元红包。如果是我，我肯定会用总值除以人数，然后对小数点后第三位向上取整，然后发红包的，因为本该如此。&lt;/p&gt;
&lt;p&gt;　　看来，中国人真的已经富裕起来了！&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Consul 的基本使用</title>
                <link>https://xdhuxc.github.io/posts/storage/consul/consul-simple-use/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/consul/consul-simple-use/</guid>
                <pubDate>Tue, 20 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 consul 的部署及配置和基本使用。&lt;/p&gt;
&lt;h3 id=&#34;基于-docker-安装-consul&#34;&gt;基于 docker 安装 consul&lt;/h3&gt;
&lt;p&gt;1、使用 docker 安装 consul&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull consul
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d --name=consul --network=host -e CONSUL_BIND_INTERFACE=eth0 consul
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;原生方式安装-consul&#34;&gt;原生方式安装 consul&lt;/h3&gt;
&lt;p&gt;1、下载 &lt;a href=&#34;https://www.consul.io/downloads.html&#34;&gt;安装包&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://releases.hashicorp.com/consul/1.6.2/consul_1.6.2_linux_amd64.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、解压&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;unzip consul_1.6.2_linux_amd64.zip 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 consul&lt;/p&gt;
&lt;p&gt;1）添加执行权限并移动 consul 到 /usr/bin 目录下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;chmod +x consul &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cp consul /usr/bin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）配置 consul.service（/usr/lib/systemd/system/consul.service），文件内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=confd
Documentation=http://www.consul.io/
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/consul agent -dev -client 0.0.0.0 -ui

Restart=always

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;agent 启动参数说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-dev：以开发环境模式运行，这种模式下 consul节点既是 client，也是 server&lt;/li&gt;
&lt;li&gt;-client：指定客户端访问的地址，客户端通过 RPC，DNS，HTTP，gRPC 访问都需要用这个地址，可以指定其为：0.0.0.0 绑定所有客户端地址&lt;/li&gt;
&lt;li&gt;-ui：启动内置的 UI Web 服务&lt;/li&gt;
&lt;li&gt;-bind：指定 consul 集群节点之间通信的地址&lt;/li&gt;
&lt;li&gt;-data-dir：指定 consul 节点存放数据的目录&lt;/li&gt;
&lt;li&gt;-bootstrap-expect：指定期望的 server 节点数量&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;3）启动 consul&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; systemctl restart consul
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;读写数据&#34;&gt;读写数据&lt;/h3&gt;
&lt;p&gt;1）添加或更新数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;consul kv put xdhuxc/consul/1 dc1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）查询数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;consul kv get xdhuxc/consul/1
或
consul kv get --detailed xdhuxc/consul/1
或 
consul kv get -recurse # 查询所有数据
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）删除数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;consul kv delete xdhuxc/consul/1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;常用命令&#34;&gt;常用命令&lt;/h3&gt;
&lt;p&gt;1、查看集群成员&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;consul members 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果想知道更详细的信息，可以添加 &lt;code&gt;--detailed&lt;/code&gt; 参数来获得&lt;/p&gt;
&lt;p&gt;2、停止 consul agent&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;consul leave
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;官方安装指南 &lt;a href=&#34;https://www.consul.io/docs/install/index.html&#34;&gt;https://www.consul.io/docs/install/index.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/f4e2b2aabd21&#34;&gt;https://www.jianshu.com/p/f4e2b2aabd21&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/consul/">Consul</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>sqlite 基本使用</title>
                <link>https://xdhuxc.github.io/posts/storage/sqlite/sqlite-basic-use/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/sqlite/sqlite-basic-use/</guid>
                <pubDate>Fri, 16 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 sqlite 的基本使用方法，以备后需。&lt;/p&gt;
&lt;h3 id=&#34;sqlite-安装&#34;&gt;sqlite 安装&lt;/h3&gt;
&lt;p&gt;Mac 和 Linux 已经默认安装，使用命令 &lt;code&gt;which sqlite3&lt;/code&gt; 即可查到安装目录，一般为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/usr/bin/sqlite3
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;基本命令&#34;&gt;基本命令&lt;/h3&gt;
&lt;p&gt;1、创建数据库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sqlite3 share.db
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看数据库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:~ wanghuan$ sqlite3 /Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/share/sql/share.db # 打开数据库 share.db
SQLite version 3.24.0 2018-06-04 14:10:15
Enter &amp;#34;.help&amp;#34; for usage hints.
sqlite&amp;gt; .databases
main: /Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/share/sql/share.db
sqlite&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、创建数据库表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sqlite&amp;gt; .tables
sqlite&amp;gt; CREATE TABLE &lt;span class=&#34;sb&#34;&gt;`xdhuxc`&lt;/span&gt; (
   ...&amp;gt;     &lt;span class=&#34;sb&#34;&gt;`id`&lt;/span&gt; INT PRIMARY KEY NOT NULL,
   ...&amp;gt;     &lt;span class=&#34;sb&#34;&gt;`name`&lt;/span&gt; VARCHAR(50) NOT NULL,
   ...&amp;gt;     &lt;span class=&#34;sb&#34;&gt;`code`&lt;/span&gt; CHAR(6) NOT NULL,
   ...&amp;gt;     &lt;span class=&#34;sb&#34;&gt;`level`&lt;/span&gt; CHAR(5) NOT NULL,
   ...&amp;gt;     &lt;span class=&#34;sb&#34;&gt;`buy_price`&lt;/span&gt; REAL NOT NULL,
   ...&amp;gt;     &lt;span class=&#34;sb&#34;&gt;`sell_price`&lt;/span&gt; REAL NOT NULL
   ...&amp;gt; );
sqlite&amp;gt; .tables
share
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、退出 sqlite&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sqlite&amp;gt; .exit
wanghuans-MBP:~ wanghuan$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;可视化&#34;&gt;可视化&lt;/h3&gt;
&lt;p&gt;可以使用 &lt;code&gt;DBeaver&lt;/code&gt;，&lt;code&gt;TablePlus&lt;/code&gt; 等可视化工具操作之。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.runoob.com/sqlite/sqlite-create-table.html&#34;&gt;https://www.runoob.com/sqlite/sqlite-create-table.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/sql/">SQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/sqlite/">sqlite</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Go glog 日志包的使用</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-glog/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-glog/</guid>
                <pubDate>Fri, 09 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下在 golang 中使用 glog 的方式，在一些项目中可能会用到，有些地方需要注意。&lt;/p&gt;
&lt;p&gt;golang/glog 是 google/glog 的 Go 版本实现，基本上实现了原生 glog 的日志格式。在 Kubernetes 中，glog 是默认日志库。&lt;/p&gt;
&lt;h3 id=&#34;基本使用&#34;&gt;基本使用&lt;/h3&gt;
&lt;p&gt;glog 将日志级别分为 4 种，分别是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;INFO：普通日志；&lt;/li&gt;
&lt;li&gt;WARNING：警告日志；&lt;/li&gt;
&lt;li&gt;ERROR：错误日志；&lt;/li&gt;
&lt;li&gt;FATAL：严重错误日志，打印完日志后程序将会退出。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;glog 的使用示例&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import (
	&amp;#34;flag&amp;#34;

	&amp;#34;github.com/golang/glog&amp;#34;
)

func main() {
    // 需要使用 flag.Parse() 解析参数，如果不加此语句，会报错误并输出所有级别日志
    flag.Parse()
    defer glog.Flush()

    glog.Infoln(&amp;#34;This is a info log for glog&amp;#34;)
    glog.Infof(&amp;#34;This is a info format log for %s&amp;#34;, &amp;#34;glog&amp;#34;)

    glog.Warningln(&amp;#34;This is a warning log for glog&amp;#34;)
    glog.Warningf(&amp;#34;This is a warning format log for %s&amp;#34;, &amp;#34;glog&amp;#34;)

    glog.Errorln(&amp;#34;This is a error log for glog&amp;#34;)
    glog.Errorf(&amp;#34;This is a error format log for %s&amp;#34;, &amp;#34;glog&amp;#34;)

    /*
    glog.Fatalln(&amp;#34;This is a fatal log for glog&amp;#34;)
    glog.Fatalf(&amp;#34;This is a fatal format log for %s&amp;#34;, &amp;#34;glog&amp;#34;)
    */

    // 用于程序结束前刷出缓冲区中的所有日志
    glog.Flush()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;1、默认的日志等级为 2，也就是错误日志及严重错误日志才会输出，因此本地运行时，INFO 和 WARNING 级别的日志不会输出，要想让其输出，需要加入如下参数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go run main.go --v 2 --logtostderr true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在使用 docker 运行该应用时，Dockerfile 可参考如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;CMD [&amp;#34;xdhuxc-checker&amp;#34;, &amp;#34;--config&amp;#34;, &amp;#34;/etc/xdhuxc/config.prod.yaml&amp;#34;, &amp;#34;--v&amp;#34;, &amp;#34;2&amp;#34;, &amp;#34;--logtostderr&amp;#34;, &amp;#34;true&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://zhengyinyong.com/glog-internal.html&#34;&gt;https://zhengyinyong.com/glog-internal.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/log/">Log</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Go Set 的使用</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-set/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-set/</guid>
                <pubDate>Fri, 09 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下在 golang 中进行集合操作的方式，在一些项目中可能会用到。&lt;/p&gt;
&lt;p&gt;我们使用 &lt;code&gt;golang-set&lt;/code&gt; 这个包来进行集合操作。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import (
	&amp;#34;fmt&amp;#34;
	mapset &amp;#34;github.com/deckarep/golang-set&amp;#34;
)

func main() {
    // 初始化集合 envs
	envs := mapset.NewSet()
	// 向集合 envs 中添加元素
	envs.Add(&amp;#34;prod&amp;#34;)
	envs.Add(&amp;#34;test&amp;#34;)
	envs.Add(&amp;#34;pre&amp;#34;)

	env := &amp;#34;alpha&amp;#34;
	// 判断集合 envs 中是否包含指定元素
	if envs.Contains(env) {
		fmt.Println(&amp;#34;包含&amp;#34;)
	} else {
		fmt.Println(&amp;#34;不包含&amp;#34;)
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;1、从 interface 数组生成新的集合&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;currentEnvs := mapset.NewSetFromSlice([]interface{}{&amp;#34;prod&amp;#34;, &amp;#34;test&amp;#34;, &amp;#34;alpha&amp;#34;})
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、差集计算&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;differenceSet := envs.Difference(currentEnvs) // envs 对 currentEnvs 的差集
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、判断父集合子集&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;isSuperSet := envs.IsSuperset(currentEnvs)
isSubSet := currentEnvs.IsSubset(envs)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;IsProperSubset(other Set) bool&lt;/code&gt; 和 &lt;code&gt;IsProperSuperset(other Set) bool&lt;/code&gt; 与这两个方法的区别在于：这两者不包括两个集合相等的情况&lt;/p&gt;
&lt;p&gt;4、并集计算&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;unionSet := envs.Union(currentEnvs)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、交集计算&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;intersection := envs.Intersect(currentEnvs)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、集合相等判断&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;isEqual := envs.Equal(currentEnvs)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、获取集合元素个数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;envs.Cardinality()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、删除集合元素&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;envs.Remove(&amp;#34;pre&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果删除的元素不存在，不会出现错误。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/deckarep/golang-set&#34;&gt;https://github.com/deckarep/golang-set&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/set/">Set</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vim 常用命令及技巧</title>
                <link>https://xdhuxc.github.io/posts/tools/tools-vim/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/tools/tools-vim/</guid>
                <pubDate>Wed, 07 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍 Vim 的常用命令及技巧，以备后需。&lt;/p&gt;
&lt;h3 id=&#34;常用命令&#34;&gt;常用命令&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;以下操作均在命令模式下进行&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、显示行号或取消行号，输入&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;:set nonumber # 关闭行号
:set number   # 开启行号
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查找字符串
命令模式下，输入&lt;code&gt;/user&lt;/code&gt;，则会查找字符串&lt;code&gt;user&lt;/code&gt;（&lt;code&gt;/要搜索的字符串或者字符&lt;/code&gt;），按下回车之后，可以看到 vim 已经把光标移动到该字符处和高亮了匹配的字符串（vi没高亮，因为它没有颜色）&lt;/p&gt;
&lt;p&gt;按下 n(小写n)用于查看下一个匹配；按下N（大写N）查看上一个匹配，可以按下Caps Lock键切换大小写，也可以在小写状态按下Shift + n&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;?user&lt;/code&gt;（&lt;code&gt;?要搜索的字符串或者字符&lt;/code&gt;），从文件的结尾处往开始处搜索&lt;/p&gt;
&lt;p&gt;2、取消高亮，输入&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;:nohlsearch
:set nohlsearch
:set noh # 简写
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、跳转至文件头部，在命令模式下，按两次 &lt;code&gt;g&lt;/code&gt;；跳转至文件尾部，在命令模式下，输入 &lt;code&gt;G&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;4、删除一行，在命令模式下，按两次 &lt;code&gt;d&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;5、替换每一行中所有的 &lt;code&gt;str1&lt;/code&gt; 为 &lt;code&gt;str2&lt;/code&gt;，在命令模式下，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;:%s/str1/str2/g
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;替换当前行所有的 &lt;code&gt;str1&lt;/code&gt; 为 &lt;code&gt;str2&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;:s/str1/str2/g
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、按 &lt;code&gt;u&lt;/code&gt; 可以撤销一次操作&lt;/p&gt;
&lt;p&gt;7、跳转到指定行&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;打开文件时，使用如下命令打开文件，可直接到指定行&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vim xdhuxc.yaml +25 # 打开文件后光标跳转到第 25 行
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;在命令模式下，直接输入行号，然后回车&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;:25 # 回车后跳转到第 25 行
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、将复制的代码粘贴到 vim 中时，代码缩进产生了混乱&lt;/p&gt;
&lt;p&gt;原因：终端处理粘贴的文本时，会存入键盘缓存。vim 处理时，会把这些内容作为用户键盘输入来处理。如果 vim 开启了自动缩进，那么在遇到换行符时，就会默认把上一行的缩进插入到下一行的开头。&lt;/p&gt;
&lt;p&gt;解决：vim 编辑模式中有一个 paste 模式，该模式下，可将文本保持原样粘贴到 vim 中，以避免一些格式错误。在 vim 中输入命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;:set paste   # 设置粘贴模式
:set nopaste # 取消粘贴模式
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vim/">Vim</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>人间世·杂六</title>
                <link>https://xdhuxc.github.io/posts/human/human-world-mixed-six/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/human/human-world-mixed-six/</guid>
                <pubDate>Wed, 07 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;        香港“占中”事件发生后，有记者问总理，“香港究竟怎么了？”总理回答说，“如果以后有人问你这个问题，你就说，香港将保持长期繁荣稳定。”&lt;/p&gt;
&lt;p&gt;　　香港问题的鸡肋之处在于，如果香港继续保持繁荣稳定发展，那是资本主义自由制度的胜利果实，但是一旦香港出现衰落，盎格鲁-撒克逊人肯定会利用他们在国际上的学术和舆论力量进行广泛渲染和动员，将其归咎于共和国中央政府，但共和国中央政府是不会把这颗苦胆一直含在嘴里的。&lt;/p&gt;
&lt;p&gt;　　本次盎格鲁-撒克逊人策划的香港暴乱事件，其实也算是一个机会吧。此次暴乱事件，挑战共和国中央政府权威，也给香港的社会和国际声誉造成了非常严重的破坏性影响。这次暴乱事件，香港社会政界、商界、学界、立法界、司法界等社会主要力量群体对香港社会繁荣稳定的大局，对中央政府权威的维护，对国家的忠诚将全部地体现出来。目前来看，司法界（清一色的盎格鲁-撒克逊国籍，对于“占中”事件的处理，黄之锋等人判刑几个月，但是维护社会秩序的警察则判处两年）和学界（暴乱者大多是学生）基本上是站在暴乱者的一方，政界和商界情况不甚明确，政界和商界都呼吁不要暴力，有些有影响力的人物没有表态或表态模糊，但是却没有解决实际问题，如果以林郑月娥、董建华、梁振英等为首的政界不能妥善解决此次暴乱事件，那么中央政府肯定会怀疑香港政界对国家的忠诚。对外表示相信这些人，对其忠诚和能力有信心，如果事态没有得到妥善解决，而是越闹越大，这可就不好说他们是故意纵容暴乱事件，还是没有力量和能力解决这些问题了。&lt;/p&gt;
&lt;p&gt;　　如果真的要解决这些问题，等到香港各界人士在此次暴乱事件中表明自己的态度和立场后，共和国中央可以通过全国人大或其常委会立法，对香港的英国殖民遗留问题进行彻底清算，包括司法系统中的外籍人员问题、历史和语文教科书问题、英美情报人员问题等等，同时也对香港社会政界、学界、司法界、立法界、商界等系统进行彻底清算，一举解决影响香港社会繁荣稳定的问题。由于有此次暴乱事件作为依据，这样做在各方都会得到广泛地支持，当然英美肯定会表示“关切和忧虑”的。其实这也算英美采取了错误的策略，过早地采取了激进的操作，给共和国中央以机会。香港社会目前有两个主要矛盾：1、外部，内陆以深圳、上海、北京为代表的城市的巨大发展让香港人有巨大的失落感，如果香港发展停滞不前甚至衰落，可能将会沦落到新一线城市甚至都不如的地步。国家提出粤港澳湾区规划，但是香港人不珍惜；2、内部，香港富豪家族对资源尤其是基础设施资源的垄断导致普通民众生活艰辛，年轻人没有希望。如果英美的策略是利用这两个矛盾，舆论上进行渲染，利用香港人的失落感分隔内地和香港；团结和组织年轻人和底层民众不停地搞小动作，持续地一直搞，表达自己生活艰辛的痛苦和合理的利益诉求，就可以让香港永无宁日。那问题就很麻烦了，因为这两个问题对香港来说，根本就解决不了。&lt;/p&gt;
&lt;p&gt;　　美国不过是想通过这样的事情来刺激共和国，将共和国引入他们设计的圈套中，但是共和国还是岿然不动，仅仅通过开新闻发布会表明态度和立场，通过官方媒体表明态度和立场，并没有采取实质性行动，因为这些事情还犯不着出手。其实，香港暴乱事件对共和国是一个小事情，顶多是面子上不好看，影响非常有限。但是在什么情况下，共和国中央会出手呢？例如香港有人组织公投，妄图独立，这种情况下，表明态度就不够用了，中央政府肯定会出手的。&lt;/p&gt;
&lt;p&gt;　　香港的暴乱事件也充分说明把一个国家或地区的精英群体死死地捆绑在脚下的土地上是一件多么重要的事情，不然这片土地上的普通老百姓最终是要为此付出代价的。可以通过立法来管控这方面，规定国家公职人员必须是本国国籍，对于领导干部，包括父母、配偶、子女等在内的直系亲属也都必须是本国国籍，绝不能让“裸官”当领导干部；对于商界，需要把这纳入资本管制和信贷管理考察之中；对于学界，限制这些人在外任职挂职的数量，否则，这些精英群体很有可能吃中国人的饭，砸中国人的锅，就像香港现在的情况一样。&lt;/p&gt;
&lt;p&gt;　　另外，香港能乱到哪里去呢？&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://www.ceweekly.cn/2016/0316/144634.shtml&#34;&gt;http://www.ceweekly.cn/2016/0316/144634.shtml&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s/ntQQBNahUO9CvwiCzeJ2SA&#34;&gt;https://mp.weixin.qq.com/s/ntQQBNahUO9CvwiCzeJ2SA&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s/XbMoZLB-_iNDC9WhGI6v8A&#34;&gt;https://mp.weixin.qq.com/s/XbMoZLB-_iNDC9WhGI6v8A&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s?src=11&amp;amp;timestamp=1565186243&amp;amp;ver=1776&amp;amp;signature=ofRGRmQ0K2BS&#34;&gt;https://mp.weixin.qq.com/s?src=11&amp;amp;timestamp=1565186243&amp;amp;ver=1776&amp;amp;signature=ofRGRmQ0K2BS&lt;/a&gt;&lt;em&gt;MjaUEXtpdcN7G7Ptob&lt;/em&gt;8ynW&lt;em&gt;LEGF6tqhWdEn5IyUpWj19Nsv&lt;/em&gt;XKAOFFW2TkqhDS-APLO70RK2kyV4ATSvHR2pvoNrzNrI4XFhmEQJe4IQK74j6s38iw&amp;amp;new=1&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Golang 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-questions-and-solutions/</guid>
                <pubDate>Mon, 05 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本部分内容记录下 golang 开发时常见的一些问题及解决方法。&lt;/p&gt;
&lt;h3 id=&#34;x509-certificate-signed-by-unknown-authority&#34;&gt;x509: certificate signed by unknown authority&lt;/h3&gt;
&lt;p&gt;编写代码请求华为云 API，使用 docker 容器部署，基础镜像为 &lt;code&gt;geekidea/alpine-a:3.9&lt;/code&gt;，执行 do 方法时报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;E0807 05:11:19.285019       1 elb_job.go:67] Get https://elb.ap-southeast-3.myhuaweicloud.com/v2.0/lbaas/loadbalancers: x509: certificate signed by unknown authority
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 Dockerfile 中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;RUN apk update \
        &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apk upgrade \
        &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apk add --no-cache \
        ca-certificates \
        &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; update-ca-certificates 2&amp;gt;/dev/null || true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;更新 &lt;code&gt;ca-certificates&lt;/code&gt; 试试。&lt;/p&gt;
&lt;h3 id=&#34;make-build-报错&#34;&gt;make build 报错&lt;/h3&gt;
&lt;p&gt;1）使用 &lt;code&gt;make build&lt;/code&gt; 进行构建时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:xdhuxc-transform wanghuan$ make build
&amp;gt;&amp;gt; go build ...
build command-line-arguments: cannot load gitlab.xdhuxc.com/xdhuxc/xdhuxc-transform/src/apis: git ls-remote -q ssh://git@gitlab.xdhuxc.com/xdhuxc.git in /Users/wanghuan/GolandProjects/GoPath/pkg/mod/cache/vcs/32878bb63a0c857fed210744986dde9a48418788fe89eee3f24d5b73f5abcd2a: exit status 128:
        GitLab: The project you were looking for could not be found.
        fatal: Could not read from remote repository.
        
        Please make sure you have the correct access rights
        and the repository exists.
make: &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;* [build] Error 1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：以前是可以正常构建的，把 go 版本升级到 1.13 后，就变成这样了，该版本有问题，回退到 1.12 即可解决问题。&lt;/p&gt;
&lt;p&gt;2）使用 &lt;code&gt;make build&lt;/code&gt; 进行构建时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:hawkeye wanghuan$ make build
&amp;gt;&amp;gt; go build ...
&lt;span class=&#34;gh&#34;&gt;# gitlab.xdhuxc.org/SGT/DevOps/hawkeye/src/apis
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;src/apis/base.go:55:38: cannot use req (type &lt;span class=&#34;ge&#34;&gt;*&amp;#34;gitlab.xdhuxc.com/xdhuxc/hawkeye/vendor/github.com/emicklei/go-restful&amp;#34;.Request) as type *&lt;/span&gt;&amp;#34;github.com/emicklei/go-restful&amp;#34;.Request in argument to b.auth.GetCustomValue
src/apis/router.go:54:46: cannot use baseController.auth.Auth (type func(*&amp;#34;github.com/emicklei/go-restful&amp;#34;.Request, &lt;span class=&#34;ge&#34;&gt;*&amp;#34;github.com/emicklei/go-restful&amp;#34;.Response, *&lt;/span&gt;&amp;#34;github.com/emicklei/go-restful&amp;#34;.FilterChain)) as type &amp;#34;gitlab.xdhuxc.com/xdhuxc/hawkeye/vendor/github.com/emicklei/go-restful&amp;#34;.FilterFunction in argument to baseController.ws.Filter
make: &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;* [build] Error 2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：删除本地项目中 &lt;code&gt;gitlab.xdhuxc.com/xdhuxc/hawkeye/vendor/github.com/emicklei/go-restful&lt;/code&gt; 目录，重新编译。&lt;/p&gt;
&lt;h3 id=&#34;向-map-中写入键值对时报错-panicassignment-to-entry-in-nil-map&#34;&gt;向 map 中写入键值对时，报错 &lt;code&gt;panic：assignment to entry in nil map&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;因为该 map 的初始化方式不对，当仅写 &lt;code&gt;var map[keyType]ValueType&lt;/code&gt; 时，会得到 nil map，此时向 map 中插入键值对时，会报上述错误。&lt;/p&gt;
&lt;p&gt;一旦使用 make() 函数进行初始化，就不是 nil map 了。&lt;/p&gt;
&lt;h3 id=&#34;都是标签惹的祸&#34;&gt;都是标签惹的祸&lt;/h3&gt;
&lt;p&gt;在进行 JSON 序列化时，如果给结构体中某两个字段定义了相同的标签值，则这两个字段在序列化后的 JSON 体中都将会被去掉。&lt;/p&gt;
&lt;p&gt;比如，如下的结构体：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import (
	&amp;#34;encoding/json&amp;#34;
	&amp;#34;fmt&amp;#34;
)

type User struct {
	ID string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;id&amp;#34;`&lt;/span&gt;
	Name string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;name&amp;#34;`&lt;/span&gt;
	Address string  &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;address&amp;#34;`&lt;/span&gt;
	Password string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;name&amp;#34;`&lt;/span&gt;
}

func main() {
	user := User{
		ID: &amp;#34;abc&amp;#34;,
		Name: &amp;#34;xdhuxc&amp;#34;,
		Address: &amp;#34;s&amp;#34;,
		Password: &amp;#34;073#asd&amp;#34;,
	}
	dataInBytes, _ := json.Marshal(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;user)
	fmt.Println(string(dataInBytes))
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;输出结果如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{&amp;#34;id&amp;#34;:&amp;#34;abc&amp;#34;,&amp;#34;address&amp;#34;:&amp;#34;s&amp;#34;}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将字段 Name 和 Password 的 JSON 标签设置为相同的后，两个字段在序列化后直接被去掉了。&lt;/p&gt;
&lt;h3 id=&#34;使用-go-mod-tidy-命令报错&#34;&gt;使用 &lt;code&gt;go mod tidy&lt;/code&gt; 命令报错&lt;/h3&gt;
&lt;p&gt;使用 &lt;code&gt;go mod tidy&lt;/code&gt; 命令时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:confd wanghuan$ go mod tidy
go: modules disabled inside GOPATH/src by GO111MODULE=auto; see &amp;#39;go help modules&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;默认设置的 &lt;code&gt;GO111MODULE=auto&lt;/code&gt; 导致 &lt;code&gt;modules&lt;/code&gt; 默认在 &lt;code&gt;$GOPATH/src&lt;/code&gt; 路径下是不启用的。如果需要在 &lt;code&gt;$GOPATH/src&lt;/code&gt; 目录下也能使用 &lt;code&gt;modules&lt;/code&gt;，需要把 &lt;code&gt;GO111MODULE&lt;/code&gt; 环境变量设置为 &lt;code&gt;on&lt;/code&gt;。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;export GO111MODULE=on
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;使用-vscode-运行-golang-程序单元测试没有代码日志输出&#34;&gt;使用 VSCode 运行 golang 程序单元测试，没有代码日志输出&lt;/h3&gt;
&lt;p&gt;在 &lt;code&gt;.vscode/settings.json&lt;/code&gt; 文件中，加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;#34;go.testFlags&amp;#34;: [
    &amp;#34;-v&amp;#34;
],
&amp;#34;go.testTimeout&amp;#34;: &amp;#34;300s&amp;#34;,  # 单元测试执行时间超过 300s，则直接结束该测试，
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;使用-git-拉取私有仓库代码时报错&#34;&gt;使用 git 拉取私有仓库代码时，报错&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wanghuan@wanghuans-MBP xdhuxc-cicd % make build
&amp;gt;&amp;gt; go build ...
go: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/log
go: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/src/models
go: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-jenkins
go: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/pkg
go: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/src/service
go: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/event
src/apis/base.go:9:2: module gitlab.xdhuxc.com/sgt/xdhuxc-common/event: git ls-remote -q origin in /Users/wanghuan/GolandProjects/GoPath/pkg/mod/cache/vcs/28da36e7c579b99f1d7066993405e1672802dc58e6f44b68d781fae79c0b54fb: exit status 128:
        fatal: could not read Username for &#39;https://gitlab.xdhuxc.com&#39;: terminal prompts disabled
Confirm the import path was entered correctly.
If this is a private repository, see https://golang.org/doc/faq#git_https for additional information.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;参照 &lt;a href=&#34;https://golang.org/doc/faq#git_https&#34;&gt;https://golang.org/doc/faq#git_https&lt;/a&gt; 中的方法，在 ~/.gitconfig 文件中加入如下内容：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[url &amp;quot;ssh://git@gitlab.xdhuxc.com/&amp;quot;]
        insteadOf = https://gitlab.xdhuxc.com/
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;this-download-does-not-match-the-one-reported-by-the-checksum-server&#34;&gt;This download does NOT match the one reported by the checksum server.&lt;/h3&gt;
&lt;p&gt;使用 &lt;code&gt;go mod tidy&lt;/code&gt; 整理 golang 项目依赖时，控制台显示如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuan@wanghuans-MacBook-Pro scmp-common % go mod tidy
github.com/panjf2000/ants@v1.2.0: verifying module: checksum mismatch
        downloaded: h1:Ufw4aDz9RqH1RVblx2W9L9Uv5vSX5apbX5+peR7LQ5k=
        sum.golang.org: h1:pMQ1/XpSgnWx3ro4y1xr/uA3jXUsTuAaU3Dm0JjwggE=

SECURITY ERROR
This download does NOT match the one reported by the checksum server.
The bits may have been replaced on the origin server, or an attacker may
have intercepted the download attempt.

For more information, see &amp;#39;go help module-auth&amp;#39;.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：先清理 mod 的缓存，然后再指定该命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go clean -modcache
go mod tidy
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>人间世·杂二</title>
                <link>https://xdhuxc.github.io/posts/human/human-world-mixed-two/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/human/human-world-mixed-two/</guid>
                <pubDate>Sat, 03 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;        其实，我觉得现在我们应该支持中美贸易战，在目前这种程度上打下去，中长期来看，对我们的好处是远远大于现在的损失的。当然，如果程度不断加深，不断地加深，会有一方首先妥协的，但大概率不会是美国。&lt;/p&gt;
&lt;p&gt;　　特朗普掀起的贸易战打碎了中国政、商、学、媒等各界对美国和西方在精神和思想上的依赖甚至依恋，使得中美国联姻进入“冷战期”，从而中国政、商、学、媒等各界就得自己动脑子去思考和解决诸如社会、经济、教育、医疗、科学、技术、伦理等各领域各方面的问题了。一方面是美国不让他们抄袭了，另一方面我们本身的发展在一些方面马上就到无处抄袭的水平了，后续在其他更广更深的方面都会到达无处抄袭的地步，中国人需要尽快明白。&lt;/p&gt;
&lt;p&gt;　　中美贸易战对我国政府来讲，是一个提高其应对外部风险能力的非常好的锻炼机会，这对于国家长期稳定发展是件好事情。&lt;/p&gt;
&lt;p&gt;　　中美贸易战只是美国全球范围内贸易战的一部分，长期在目前这个程度（增加10%~30%的贸易关税，不包含其他方面，美帝的全面科技、金融封锁对其他国家都是是致命性的打击）上打下去，会把美国的国家信用打光，会把美国的盟友打光，造成美国的孤立，并且会导致其他国家和组织之间的广泛联合，长期来看，对我国是有利的。&lt;/p&gt;
&lt;p&gt;　　如果特朗普或特朗普的继任者突然停止了贸易战，很可能会造成中国社会各界（至少有那么一部分人）对美国的错误判断和对中美关系的错误认识，认为美国不敢和中国打贸易战，理由若干，从而心存侥幸，这是非常危险的。&lt;/p&gt;
&lt;p&gt;　　此次贸易战也将成为中美两国试探对方一般性底线的测试，将为日后中长期时间范围内两国关系处理的重要参照，所以，首先妥协的一方，大幅让步的一方，将可能在日后承担不可承受的巨大代价。&lt;/p&gt;
&lt;p&gt;　　中国的小朋友已经开始拯救地球了，大人也《流浪地球》了，特朗普瞥了一眼这些人，“你们还是先拯救拯救你们自己吧，地球和宇宙还轮不到你们来拯救！”，这盆冷水泼得正是时候！&lt;/p&gt;
&lt;p&gt;　　但是从另一方面看，美国人所谓的“对华遏制”似乎有点儿奇怪。&lt;/p&gt;
&lt;p&gt;　　美国从2018年4月开始对中兴进行制裁，到2019年5月将华为列入“实体名单”，这中间的一年多时间实际上给华为提供了很大的缓冲期来预防不测，当然华为的准备其实比这早多了。如果是战略层面的遏制和打击，从而是经过系统地谋划之后再出招，那么肯定是出其不意，同时发难，全面封杀，而且是轻易不会同意和解的，除非发现打击无效或达不到预期效果，为了场面上大家都好看和后续合作，拿钱了事，同意和解。但是对于中兴，美国人没有赶尽杀绝，而是同意交钱撤人和解，这不是他们仁慈或遵守所谓“规则”，而是他们战略上的混乱所致。&lt;/p&gt;
&lt;p&gt;　　另一方面，如果美国真的要对中国进行全面遏制和打击，那么为什么没有选择中国的软肋进行全面的攻击呢？如果美国抓住中国的软肋，中国互联网经济和精英阶层对美国的依赖性，对中国的经济和精英阶层进行全面的打击，那么，共和国会不会签署丧权辱国的条约，就很难说了。如果美国利用其技术和金融等综合性力量打击中国的房地产和互联网，对中国的房地产企业和互联网企业进行全面的制裁，包括金融、技术、供应链、准入等企业生产经营的所有方面，制裁对象包括企业及其子公司，关联企业等和公司高管及其家属等个人，如此操作，即便不能使中国经济崩溃，也能很轻松地让美国赚个几万亿。一旦开始制裁，这些公司中的上市公司股价肯定会大幅下降，中兴通讯的股价直接就是腰斩，还可用低价收购优质资产的中国公司，美国资本就可以趁机轻松赚个几万亿。建立在美国基础技术上的中国互联网及其经济将如何保持并发展？投降的声音一定是最大的？另一方面，贫富分化作为中国社会目前最主要的矛盾，美国可以利用这一点，公开中国人在美国和世界其他地方的财产状况，以刺激整个中国社会，激化中国社会的矛盾，这将会对中国社会的政、学、商、媒、娱等精英阶层产生巨大的威胁，从而迫使中国在和美国的谈判中惟命是从。当然了，公开这些信息也是有技巧的，分批公开，先公开小角色的，然后慢慢展开，逐步公开重量级人物的，不断向中国的精英阶层传导极限压力，直到这些人所组成的群体无法承受，将压力层层向上传导，直到整个国家层面的妥协。在这种刺激下，整个中国社会从精英阶层到普通民众的恐慌可想而知。但是，需要注意的是，对知识分子（主要是各大高校和自媒体等）和留学人员（包括正在留学的和有留学经历的），则要施以怀柔政策，不断向这些人输送物质利益和精神利益，比如大肆夸赞这些人的贡献和成就，让他们以和西方合作为荣耀，给他们和美国院校合作的机会，让他们成为“访美学者”，“旅美学者”等，从而这些人将会成为美国在中国的代言人，在中美竞争和对抗中成为内应，成为中国社会力量的腐蚀者。当然了，现在情况也差不多是这样，但是美国可以继续强化这一点。比如在美国对中国企业的制裁中，我国企业明显处于劣势，甚至有些企业的经营和发展已经无法进行下去了，但是还有人在鼓吹“供应链理论”，给我们这个社会营造“美好中好大家好”的氛围，不知道那些被制裁的我国企业的负责人怎么看待“供应链理论”呢？这类理论在中美以合作为主的关系下，是行得通的，也符合实际，但是当中美关系的主流变为竞争甚至斗争时，这类理论的立场和利益偏向性就很明显了。&lt;/p&gt;
&lt;p&gt;　　如果美国如此谋划并实施，不知道还有多少中国人对我们在贸易站及其后继的对美斗争中胜利有信心呢？当然了，作为国家之间的斗争，实际比这要系统和缜密地多，也要狠毒和致命地多，还要占据舆论和理论制高点，让对方把血吐尽，还要说不出话来，就像苏联那样。&lt;/p&gt;
&lt;p&gt;　　之所以是今天的局面，绝不是美国仁慈，可怜他们在中国的代言人，而是美国本身战略混乱的结果，一方面两国之间的竞争和斗争本身还没有到彻底撕破脸的地步，另一方面，特朗普这个二三流的商人总统对政治问题，包括国内政治和国际政治的思考太过简单和随机，从其“推特治国”释放消息的小聪明可以推知，快四年了，他还是没从二三流商人的小手段中走出来，一流的商人和政治家是不可能靠这种方式胜利的。&lt;/p&gt;
&lt;p&gt;　　但是，我们需要肯定一点，这个二三流的商人总统凭借着美国总统，唯一超级大国总统的身份和地位，从而其国家的综合性力量，将近代以来，尤其是二战后至今，世界各国政界、商界和学界共同构建和发展起来并普遍认同的国际政治、经济体系给打碎了，各种退群和不合作直接导致无数国际政治、经济和文化等组织和活动无法进行或没有任何成果（是的，没有美国的参与就是没法进行），这一方面暴露了这种体系本身的矛盾和不合理，给共和国提供了“九合诸侯”的机会，另一方面也让世界各国普通老百姓看到，自己的国家在美国面前多么苍白无力和软弱，而且无可奈何。日韩欧洲被迫付给美国军队军费、买美国昂贵的武器、买美国昂贵的能源；中国人被迫吃美国转基因食物换和平（两宋也差不多这样吧）；墨西哥被迫同意对难民采取措施以换取美国不加征关税等等，而这绝对是会变本加厉的，而歌颂美国的，也差不多是这些人吧。如果没有特朗普，这些东西会一直隐藏在普通老百姓的视野之外。&lt;/p&gt;
&lt;p&gt;　　显然，有些人和组织的“外国友人”对我们中国人不友好啊！&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vue 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/vue/vue-common-question-and-solution/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/vue/vue-common-question-and-solution/</guid>
                <pubDate>Fri, 02 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本部分内容记录下 Vue 使用过程中的遇到的一些问题，方便后面再次遇到时解决。&lt;/p&gt;
&lt;h3 id=&#34;通过父组件向子组件传值时报错如下&#34;&gt;通过父组件向子组件传值时，报错如下&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vue.runtime.esm.js:587 [Vue warn]: Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the prop&amp;#39;s value. Prop being mutated: &amp;#34;pods&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;父组件中引用该组件的方式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;instances&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:pods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pods&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;instances&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决方法：在父组件中，改写代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;instances&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:pods&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pods&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;instances&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在父组件中改变 pods 数据时，就像平时一样直接改变即可。&lt;/p&gt;
&lt;p&gt;子组件中，代码改写如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export default {
  name: &amp;#39;Instances&amp;#39;,
  props: {
    pods: {
      type: Array,
      default() {
        return [];
      }
    }
  },
  data() {
    return {};
  }
}

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;子组件中改变数据的代码部分不能采用直接赋值，而要改为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt; this.$emit(&amp;#39;update:pods&amp;#39;, pods);
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;error-in-nexttick-typeerror-cannot-read-property-clearvalidate-of-undefined&#34;&gt;Error in nextTick: &amp;quot;TypeError: Cannot read property &#39;clearValidate&#39; of undefined&amp;quot;&lt;/h3&gt;
&lt;p&gt;点击编辑按钮时，处理函数代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;handleEdit(index, app) {
  this.dialogStatus = &amp;#39;update&amp;#39;;
  this.$nextTick(() =&amp;gt; {
    this.$refs[&amp;#39;deploymentForm&amp;#39;].clearValidate();
  });
  this.getVolumeTypesData(5);
  this.getURISchemesData(6);
  this.getPortProtocolsData(7);
  this.convertBackend2Deployment(app);
  this.dialogDeploymentVisible = true;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;每次刷新页面后，第一次点击时，总是会报如下错误，而之后的点击事件却没有报错，有点奇怪。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vue.runtime.esm.js:587 [Vue warn]: Error in nextTick: &amp;#34;TypeError: Cannot read property &amp;#39;clearValidate&amp;#39; of undefined&amp;#34;

found in

---&amp;gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Deployment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; at src/views/kubernetes/application/deployment/index.vue
       &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Application&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; at src/views/kubernetes/application/index.vue
         &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;AppMain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; at src/views/layout/components/AppMain.vue
           &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; at src/views/layout/Layout.vue
             &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;App&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; at src/App.vue
               &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Root&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
warn @ vue.runtime.esm.js:587
logError @ vue.runtime.esm.js:1733
globalHandleError @ vue.runtime.esm.js:1728
handleError @ vue.runtime.esm.js:1717
(anonymous) @ vue.runtime.esm.js:1835
flushCallbacks @ vue.runtime.esm.js:1754
vue.runtime.esm.js:1737 TypeError: Cannot read property &amp;#39;clearValidate&amp;#39; of undefined
    at VueComponent.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;anonymous&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; (index.vue?bb9b:837)
    at Array.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;anonymous&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; (vue.runtime.esm.js:1833)
    at MessagePort.flushCallbacks (vue.runtime.esm.js:1754)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将代码修改为如下方式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;handleEdit(index, app) {
  this.dialogStatus = &amp;#39;update&amp;#39;;
  this.getVolumeTypesData(5);
  this.getURISchemesData(6);
  this.getPortProtocolsData(7);
  this.dialogDeploymentVisible = true;    
  this.convertBackend2Deployment(app);
  this.$nextTick(() =&amp;gt; {
    this.$refs[&amp;#39;deploymentForm&amp;#39;].clearValidate();
  });
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因是，&lt;code&gt;this.dialogDeploymentVisible = true&lt;/code&gt; 执行后，才会创建表单 deploymentForm，正是因为执行 &lt;code&gt;this.$refs[&#39;deploymentForm&#39;].clearValidate()&lt;/code&gt; 时，&lt;code&gt;this.dialogDeploymentVisible = true&lt;/code&gt; 还没有执行，表单还没有创建，所以才会抛出上面的错误。&lt;/p&gt;
&lt;h3 id=&#34;使用-compression-webpack-plugin-压缩文件时报错&#34;&gt;使用 compression-webpack-plugin 压缩文件时报错&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:xdhuxc-ui wanghuan$ npm run build:prod --report
&lt;span class=&#34;k&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;cloud-manage-platform@2.0.0 build:prod /Users/wanghuan/WebstormProjects/xdhuxc-ui
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;cross-env NODE_ENV=production env_config=prod node build/build.js
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;
Browserslist: caniuse-lite is outdated. Please run next command &lt;span class=&#34;sb&#34;&gt;`npm update caniuse-lite browserslist`&lt;/span&gt;
/Users/wanghuan/WebstormProjects/xdhuxc-ui/node_modules/compression-webpack-plugin/node_modules/schema-utils/src/validateOptions.js:32
    throw new ValidationError(ajv.errors, name);
    ^

ValidationError: Compression Plugin Invalid Options

options should NOT have additional properties

    at validateOptions (/Users/wanghuan/WebstormProjects/xdhuxc-ui/node_modules/compression-webpack-plugin/node_modules/schema-utils/src/validateOptions.js:32:11)
    at new CompressionPlugin (/Users/wanghuan/WebstormProjects/xdhuxc-ui/node_modules/compression-webpack-plugin/dist/index.js:40:30)
    at Object.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;anonymous&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; (/Users/wanghuan/WebstormProjects/xdhuxc-ui/build/webpack.prod.conf.js:145:9)
    at Module._compile (internal/modules/cjs/loader.js:689:30)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:700:10)
    at Module.load (internal/modules/cjs/loader.js:599:32)
    at tryModuleLoad (internal/modules/cjs/loader.js:538:12)
    at Function.Module._load (internal/modules/cjs/loader.js:530:3)
    at Module.require (internal/modules/cjs/loader.js:637:17)
    at require (internal/modules/cjs/helpers.js:22:18)
    at Object.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;anonymous&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; (/Users/wanghuan/WebstormProjects/xdhuxc-ui/build/build.js:17:19)
    at Module._compile (internal/modules/cjs/loader.js:689:30)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:700:10)
    at Module.load (internal/modules/cjs/loader.js:599:32)
    at tryModuleLoad (internal/modules/cjs/loader.js:538:12)
    at Function.Module._load (internal/modules/cjs/loader.js:530:3)
    at Function.Module.runMain (internal/modules/cjs/loader.js:742:12)
    at startup (internal/bootstrap/node.js:282:19)
    at bootstrapNodeJSCore (internal/bootstrap/node.js:743:3)
npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! cloud-manage-platform@2.0.0 build:prod: &lt;span class=&#34;sb&#34;&gt;`cross-env NODE_ENV=production env_config=prod node build/build.js`&lt;/span&gt;
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the cloud-manage-platform@2.0.0 build:prod script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/wanghuan/.npm/_logs/2019-10-08T07_42_00_941Z-debug.log
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;主要问题在于 webpack 和 compression-webpack-plugin 的版本的适配性问题，在不同的版本搭配下，compression-webpack-plugin 的配置写法不同。&lt;/p&gt;
&lt;p&gt;原来默认安装的 compression-webpack-plugin 的版本为 3.0.0，降低版本到 1.1.12，即可正常构建。&lt;/p&gt;
&lt;h3 id=&#34;引用组件注意事项&#34;&gt;引用组件注意事项&lt;/h3&gt;
&lt;p&gt;引用组件时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;#34;export &amp;#39;InfoCard&amp;#39; was not found in &amp;#39;@/components/InfoCard/index.vue&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可能是引用的方式不对，注意，引用组件是是引用默认的组件，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import InfoCard from &amp;#39;@/components/InfoCard/index.vue&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;而不是命名的组件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import { InfoCard } from &amp;#39;@/components/InfoCard/index.vue&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vue/">Vue</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Go JSON 序列化和反序列化</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-json-serialize/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-json-serialize/</guid>
                <pubDate>Thu, 01 Aug 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本部分内容记录下使用 golang 将结构体序列化和反序列化为 JSON 时，需要注意的一些小问题。&lt;/p&gt;
&lt;h3 id=&#34;序列化为-json&#34;&gt;序列化为 JSON&lt;/h3&gt;
&lt;p&gt;示例代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import (
	&amp;#34;encoding/json&amp;#34;
	&amp;#34;fmt&amp;#34;
)

type User struct {
	Name string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;name&amp;#34;`&lt;/span&gt;
	Addresses []Address &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;addresses&amp;#34;`&lt;/span&gt;
	Age int &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;age,omitempty&amp;#34;`&lt;/span&gt;
	Email []string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;email&amp;#34;`&lt;/span&gt;
	Department string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;department,omitempty&amp;#34;`&lt;/span&gt;
	Province string
}

type Address struct {
	Name string &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;name&amp;#34;`&lt;/span&gt;
}

func (u *User) String() string {

	if bytes, err := json.Marshal(&lt;span class=&#34;ni&#34;&gt;&amp;amp;u);&lt;/span&gt; err == nil {
		return string(bytes)
	}

	return &amp;#34;&amp;#34;
}

func main() {
	u := User{
		Name: &amp;#34;xdhuxc&amp;#34;,
		Email: []string{},
		Age: 20,
	}

	fmt.Println(u.String())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;输出的结果为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{&amp;#34;name&amp;#34;:&amp;#34;xdhuxc&amp;#34;,&amp;#34;addresses&amp;#34;:null,&amp;#34;age&amp;#34;:20,&amp;#34;email&amp;#34;:[],&amp;#34;Province&amp;#34;:&amp;#34;&amp;#34;}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到：&lt;/p&gt;
&lt;p&gt;1、数组或者切片如果不初始化，默认情况下将会被序列化为 null，这对前端来说是一个非常难处理的事情。但是，赋予空数组或者空切片之后，将会序列化为 JSON 的空数组，因此，对于服务器端 API 来说，在空值情况下，不能不处理，而是要将其设置成空数组或空切片&lt;/p&gt;
&lt;p&gt;2、增加 omitempty 修饰符后，在该字段零值情况下，将会在序列化时去除掉，因此要慎用该选项，最好不用该修饰符，而是采用零值填充，既不泄露信息，同时也保证字段始终存在，方便在系统中各处判断和使用；但这样做会增加网络传输的数据量，因此需要权衡。&lt;/p&gt;
&lt;p&gt;3、如果不指定字段的 JSON 标签，默认将使用 golang 字段名称作为 JSON 字段名称，也就是同名迁移。最好为每个字段指定 JSON 标签，在命名上，按照 JSON 字段命名的方式来命名。&lt;/p&gt;
&lt;h3 id=&#34;解析-json&#34;&gt;解析 JSON&lt;/h3&gt;
&lt;p&gt;我们可以使用 gjson 来解析 JSON 格式的字符串为 go 中的变量，而不需要将其反序列化为 Golang 中的结构体，这在我们只需要少数几个字段的值时非常方便。
示例如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
  &amp;#34;name&amp;#34;: &amp;#34;xdhuxc&amp;#34;,
  &amp;#34;age&amp;#34;: 20,
  &amp;#34;children&amp;#34;: [&amp;#34;A&amp;#34;,&amp;#34;B&amp;#34;,&amp;#34;C&amp;#34;]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下方式可以获取 name 字段的值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;name := gjson.GetBytes(dataInBytes, &amp;#34;name&amp;#34;).String()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以使用 String()，Bool()，Int()，Float()等方法将获取的值转换为需要的类型&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;age := gjson.GetBytes(dataInBytes, &amp;#34;age&amp;#34;).Int()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下方式获取 children 的值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;children := gjson.GetBytes(dataInBytes, &amp;#34;children&amp;#34;).Array()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当循环获取 children 的值时，
&lt;code&gt;gjson.Get(children[i].Raw&lt;/code&gt; 获取到的字符串是带双引号的，即：&amp;quot;B&amp;quot;，而 &lt;code&gt;gjson.Get(children[i].String()&lt;/code&gt; 获取到的字符串是不带双引号的，即：B，在将其获取到的值作为参数传递时，如果不注意这一点，会出现错误。&lt;/p&gt;
&lt;p&gt;另外，根据代码部分的说明，如果数据本身就是字节形式的, &lt;code&gt;GetBytes(json []byte, path string)&lt;/code&gt; 方法优于 &lt;code&gt;Get(string(data), path)&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、使用 &lt;code&gt;json.Marshal()&lt;/code&gt; 对结构体进行序列化时，报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;runtime: goroutine stack exceeds 1000000000-byte limit
fatal error: stack overflow
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可能是结构体中出现了循环引用，使用 &lt;code&gt;json:&amp;quot;-&amp;quot;&lt;/code&gt; 不导出该字段即可解决。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/tidwall/gjson&#34;&gt;https://github.com/tidwall/gjson&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/json/">JSON</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vue 组件封装</title>
                <link>https://xdhuxc.github.io/posts/vue/vue-component/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/vue/vue-component/</guid>
                <pubDate>Tue, 30 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本部分内容记录下 Vue 中组件封装的使用方法，可以使用一些组件，实现代码和逻辑抽象。&lt;/p&gt;
&lt;h3 id=&#34;动态数组组件&#34;&gt;动态数组组件&lt;/h3&gt;
&lt;p&gt;这是一个动态数组组件，从父组件传入一个字符串数组，通过在页面点击按钮，实现对数组元素的动态增删，可用于类似 Kubernetes Deployment 的容器启动参数和启动命令这样的数组结构。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;v-for&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;(item, index) in items&amp;#34;&lt;/span&gt;           &lt;span class=&#34;err&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;数据渲染&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;:key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;item&amp;#39; + index&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;items[index]&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;items.length &amp;gt; 0&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;danger&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-delete&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
            &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;removeItem(index)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt; // 删除按钮，在每一个数组元素显示的输入框之后，用于删除当前元素。
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;margin-left: 203px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;primary&amp;#34;&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-plus&amp;#34;&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
          &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;addItem()&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;           // 增加按钮，单独设置在底部，可以从 0 开始增加，用于增加一个元素。
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;DunamicArrays&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// 组件名称
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;props&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;              &lt;span class=&#34;c1&#34;&gt;// 从父组件传递过来的数据名称，在父组件中为这个名称赋予数据
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;// 数据类型，可以为 Array，Number，String，Object等，如果传递过来的数据类型不对，直接报错
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;nx&#34;&gt;required&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// 是否必须
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;         &lt;span class=&#34;c1&#34;&gt;// 数据默认值
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;              &lt;span class=&#34;c1&#34;&gt;// 标签，可选项，用于表明数组含义
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{};&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;// 定义对数据的操作函数 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;addItem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;removeItem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;splice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;scoped&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;动态键值数组组件&#34;&gt;动态键值数组组件&lt;/h3&gt;
&lt;p&gt;这是一个动态键值对数组组件，从父组件传入一个键值对数组，通过在页面点击按钮，实现对键值对的动态增删，可用于类似 Kubernetes Deployment 的标签、环境变量等键值对数组结构。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;arrayType === &amp;#39;key-value&amp;#39;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; // 数组类型，表示键值对数组中的键值是 key-value 类型的还是 name-value 类型的
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;     // 标签，可选项，用于表明数组含义
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;v-for&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;(item, index) in items&amp;#34;&lt;/span&gt;   &lt;span class=&#34;err&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;数据渲染&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;:key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;item&amp;#39; + index&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;item.key&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;item.value&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;items.length &amp;gt; 0&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;danger&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-delete&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
              &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;removeItem(index)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;margin-left: 406px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;primary&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-plus&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
            &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;addItem(arrayType)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;v-for&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;(item, index) in items&amp;#34;&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;:key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;item&amp;#39; + index&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;item.name&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;item.value&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;items.length &amp;gt; 0&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;danger&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-delete&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
              &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;removeItem(index)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;margin-left: 406px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;primary&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-plus&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
            &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;addItem(arrayType)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;DynamicKeyValueArrays&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 组件名称 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;props&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;                        &lt;span class=&#34;c1&#34;&gt;// 从父组件传递过来的数据名称，在父组件中为这个名称赋予数据 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;                  &lt;span class=&#34;c1&#34;&gt;// 数据类型，可以为 Array，Number，String，Object等，如果传递过来的数据类型不对，直接报错
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;nx&#34;&gt;required&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;               &lt;span class=&#34;c1&#34;&gt;// 是否必须，如果为 true，而实际没有传值，则会报错
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;                   &lt;span class=&#34;c1&#34;&gt;// 数据默认值
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;arrayType&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;required&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;key-value&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// also support name-value
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{};&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;                &lt;span class=&#34;c1&#34;&gt;// 定义对数据的操作函数 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;addItem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;arrayType&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;arrayType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;key-value&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;arrayType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;name-value&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;removeItem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;splice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;scoped&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;使用组件&#34;&gt;使用组件&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;arrayForm&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:rules&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;arrayVerifyRules&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;prop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;items&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dynamic-arrays&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:items&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;command&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dynamic-arrays&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; // 通过 :items 定义响应式属性
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        ------------华丽丽的的分割线-------------
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dynamic-key-value-arrays&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:items&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;labels&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;array-type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;name-value&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dynamic-key-value-arrays&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  // 在父组件中使用自定义组件
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;=&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;onSubmit&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; Submit &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;DynamicArrays&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;@/components/DynamicArrays/index&amp;#39;&lt;/span&gt;                  &lt;span class=&#34;c1&#34;&gt;// 导入自定义组件
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;DynamicKeyValueArrays&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;@/components/DynamicKeyValueArrays/index&amp;#39;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// 导入自定义组件
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;components&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;                                                               &lt;span class=&#34;c1&#34;&gt;// 在父组件中引用子组件
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;dynamic-arrays&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;DynamicArrays&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;s1&#34;&gt;&amp;#39;dynamic-key-value-arrays&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;DynamicKeyValueArrays&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;keyValueType&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;name-value&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;mounted&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;onSubmit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;call component&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;scoped&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对于数组和对象这种引用类型的数据，在子组件中改变值后，其父组件中对应的数据也将改变。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vue/">Vue</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 常见的坑及其解决方法</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-programming-hole/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-programming-hole/</guid>
                <pubDate>Sat, 27 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要记录一些在使用 Python 语言进行开发的过程中遇到的坑，也就是那些奇奇怪怪的语法带来的问题，这种问题往往比较隐蔽，在排查过程中会耗费大量时间，但是却给我们带来很大的困扰。&lt;/p&gt;
&lt;h3 id=&#34;小心-list-元素的组织&#34;&gt;小心 list 元素的组织&lt;/h3&gt;
&lt;p&gt;如果我们有一个这样的 list，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;s = [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;, &amp;#39;f&amp;#39;]
print(s)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;那么输出结果是什么呢？毫无疑问，是这样的&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;, &amp;#39;f&amp;#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果我们给 list 换个写法，比如下面这样&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;s = [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39; &amp;#39;d&amp;#39; &amp;#39;f&amp;#39;]
print(s)

s = [
    &amp;#39;a&amp;#39;,
    &amp;#39;b&amp;#39;,
    &amp;#39;c&amp;#39; 
    &amp;#39;d&amp;#39;
    &amp;#39;f&amp;#39;
]
print(s)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;那么输出结果会是什么样的呢？如果对这个输出结果判断错误，那么，我们的程序就会出现些意料之外的错误。其实，它的结果是这样的&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;cdf&amp;#39;]
[&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;cdf&amp;#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;虽然不知道为什么，但是 python 确实是这么设计的，没有错误提示，也没有错误，将空格当成了字符串连接符来使用了。&lt;/p&gt;
&lt;p&gt;填补此坑花了我将近三个小时的时间，要谨记此错误！&lt;/p&gt;
&lt;h3 id=&#34;加载-sys-模块设置编码的原因&#34;&gt;加载 sys 模块，设置编码的原因&lt;/h3&gt;
&lt;p&gt;以下代码中，先重新加载sys模块，再设置编码，而不是先设置编码，再加载sys模块的原因：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import sys
reload(sys)
sys.setdefaultencoding(&amp;#39;utf8&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;因为 python 运行的时候首先加载了 Lib/site.py，而在 site.py 文件中有如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if hasattr(sys, &amp;#34;setdefaultencoding&amp;#34;):
    del sys.setdefaultencoding
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在sys模块加载后，setdefaultencoding 方法被删除了，所以我们需要通过重新导入sys模块来设置系统编码。&lt;/p&gt;
&lt;p&gt;动态语言有时候需要静态化的设计，删除属性和方法会给其他地方的代码带来重大的错误隐患。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vue 开发常用代码</title>
                <link>https://xdhuxc.github.io/posts/vue/vue-common-code-example/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/vue/vue-common-code-example/</guid>
                <pubDate>Wed, 24 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;在使用 Vue 和 Element-UI 进行开发时的常用代码，方便后续使用。&lt;/p&gt;
&lt;h3 id=&#34;获取当前语言&#34;&gt;获取当前语言&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;this.$i18n.locale;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;刷新当前页面&#34;&gt;刷新当前页面&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;this.$router.go(0);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;router.go(n)&lt;/p&gt;
&lt;p&gt;此方法的参数是一个整数，表示在 history 记录中向前或者后退多少步，类似 window.history.go(n)。&lt;/p&gt;
&lt;h3 id=&#34;键值对数组增删&#34;&gt;键值对数组增删&lt;/h3&gt;
&lt;p&gt;一个可以动态删减的键值对数组，可以用于各种键值对类型的数据的动态删减，比如环境变量，标签等。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;app-container&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;v-for&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;(label, labelIndex) in labels&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;:key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;label&amp;#39; + labelIndex&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;label.key&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;label.value&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;labels.length !== 1&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;danger&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-delete&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
            &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;removeLabel(labelIndex)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;argIndex === labels.length - 1&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;primary&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-plus&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
            &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;addLabel()&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;=&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;onSubmit&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; Submit &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;addLabel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
         &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
         &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
       &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;removeLabel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;splice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;onSubmit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;动态数组增删&#34;&gt;动态数组增删&lt;/h3&gt;
&lt;p&gt;一个可以动态增减的字符串数组，可用于一些场景下的参数增删，比如 kubernetes 中容器的命令和其参数的前端表单的开发&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;app-container&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;v-for&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;(arg, argIndex) in args&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;:key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;arg&amp;#39; + argIndex&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;args[argIndex]&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;args.length !== 1&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;danger&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-delete&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
            &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;removeArg(argIndex)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;argIndex === args.length - 1&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;primary&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-plus&amp;#34;&lt;/span&gt;
            &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
            &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;addArg()&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;=&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;onSubmit&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; Submit &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;addArg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;removeArg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;splice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;onSubmit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;响应式数组&#34;&gt;响应式数组&lt;/h3&gt;
&lt;p&gt;由于 JavaScript 的限制，Vue 不能检测以下数组的变动：&lt;/p&gt;
&lt;p&gt;1、当利用索引直接设置一个数组项时，例如：&lt;code&gt;vm.items[3] = &#39;a&#39;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2、修改数组的长度时，例如，&lt;code&gt;vm.items.length = 10&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;比如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;var vm = new Vue({
    data: {
        items: [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;]
    }
})
vm.items[3] = &amp;#39;a&amp;#39; // 不是响应式的
vm.items.length = 20 // 不是响应式的
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上两种改变不是响应式的，因此无法直接在视图上显示出来。&lt;/p&gt;
&lt;p&gt;解决第一类问题的两种方法如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;// Vue.set
Vue.set(vm.items, 3, &amp;#39;a&amp;#39;)
// Array.prototype.splice
vm.items.splice(3, 1, &amp;#39;a&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上两种方法都可以实现和 &lt;code&gt;vm.items[3] = &#39;a&#39;&lt;/code&gt; 相同的效果，同时也将在响应式系统内触发状态更新。&lt;/p&gt;
&lt;p&gt;也可以使用 &lt;code&gt;vm.$set&lt;/code&gt; 实例方法，该方法是全局方法 Vue.set 的一个别名：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vm.$set(vm.items, 3, &amp;#39;a&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以使用 &lt;code&gt;splice&lt;/code&gt; 方法可以解决第二类问题&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vm.items.splice(10)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如上所示的方法更新数组后，视图将会和数组同步变化。&lt;/p&gt;
&lt;p&gt;参考资料：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cn.vuejs.org/v2/guide/list.html#%E6%9B%BF%E6%8D%A2%E6%95%B0%E7%BB%84&#34;&gt;https://cn.vuejs.org/v2/guide/list.html#%E6%9B%BF%E6%8D%A2%E6%95%B0%E7%BB%84&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cn.vuejs.org/v2/guide/reactivity.html&#34;&gt;https://cn.vuejs.org/v2/guide/reactivity.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/javascript/">JavaScript</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vue/">Vue</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>JavaScript 常用代码</title>
                <link>https://xdhuxc.github.io/posts/programming/javascript/javascript-common-code-example/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/javascript/javascript-common-code-example/</guid>
                <pubDate>Tue, 23 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;JavaScript 开发时的常用代码，方便自己查找。&lt;/p&gt;
&lt;h3 id=&#34;数组和对象相互转换&#34;&gt;数组和对象相互转换&lt;/h3&gt;
&lt;p&gt;在开发中，我们经常需要将如下所示的对象&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
  key1: value1,
  key2: value2,
  key3: value3
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;转换成如下形式的数组&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[
    {
        key: key1,
        value: value1
    },
    {
        key: key2,
        value: value2
    },
    {
        key: key3,
        value: value3
    }
]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者反过来转换，我们可以编写公用函数来完成这个功能。&lt;/p&gt;
&lt;p&gt;1、将数组转换为对象&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export function convertArray2Object(source) {
  const len = source.length;
  const target = {};
  for (let i = 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;na&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、将对象转换为数组&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export function convertObject2Array(source) {
  const target = [];
  for (const k in source) {
    const temp = {
      key: k,
      value: source[k]
    };
    target.push(temp);
  }
  return target;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;删除对象的属性&#34;&gt;删除对象的属性&lt;/h3&gt;
&lt;p&gt;可以使用 delete 操作符来删除对象的属性&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;const a = {
    name: &amp;#39;hulk&amp;#39;,
    env: &amp;#39;prod&amp;#39;,
    image: &amp;#39;nginx&amp;#39;
}
// 删除 a 对象的属性 env
delete a.env 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;设置-cookie-的过期时间&#34;&gt;设置 cookie 的过期时间&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import Cookies from &amp;#39;js-cookie&amp;#39;;
const expires = new Date(new Date().getTime() + 8 &lt;span class=&#34;ge&#34;&gt;* 60 *&lt;/span&gt; 60 * 1000);
  return Cookies.set(TokenKey, token, {
    expires: expires
});
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/javascript/">JavaScript</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>JavaScript 中的数组遍历方式</title>
                <link>https://xdhuxc.github.io/posts/programming/javascript/javascript_array_traverse/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/javascript/javascript_array_traverse/</guid>
                <pubDate>Mon, 22 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;JavaScript 中数组遍历的几种方式，都是一般的方法，但是在遍历数组的同时删除元素的方法需要稍微注意下。&lt;/p&gt;
&lt;h3 id=&#34;javascript-中的数组遍历方式&#34;&gt;JavaScript 中的数组遍历方式&lt;/h3&gt;
&lt;p&gt;1、标准 for 循环方式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;var a = [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;]
for (let i = 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;a.length&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;console&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;]);&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、for-in 语句&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;var a =  {
    name: &amp;#39;hulk&amp;#39;,
    env: &amp;#39;prod&amp;#39;,
    project: &amp;#39;x-role&amp;#39;
}
for (var key in a) {
    console.log(a[key]);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;一般使用 for-in 语句来遍历对象的属性，但是对象的属性需要是可枚举的，才能被读取到，非整数类型的名称和继承的那些原型链上面的属性也能被遍历。&lt;/p&gt;
&lt;p&gt;for-in 在遍历的过程中还会遍历继承链，这是其效率比较低的原因。&lt;/p&gt;
&lt;h3 id=&#34;在遍历的过程中删除元素&#34;&gt;在遍历的过程中删除元素&lt;/h3&gt;
&lt;p&gt;在遍历的过程中删除元素时，会因为删除元素而导致数组索引变化，删除了错误的元素&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;var a = [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;, &amp;#39;e&amp;#39;, &amp;#39;f&amp;#39;]
for (let i = 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;a.length&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;splice&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;删除索引号为&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;的元素&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
    
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果需要在遍历数组的过程中删除数组元素，那么我们可以在删除之后调整索引，从而保证下一个操作时索引的正确性&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;var a = [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;]
for (let i = 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;a.length&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#39;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;splice&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;i--&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt;             &lt;span class=&#34;err&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;索引调整&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/javascript/">JavaScript</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>消息队列（一）</title>
                <link>https://xdhuxc.github.io/posts/message/message-queue/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/message/message-queue/</guid>
                <pubDate>Wed, 10 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本部分内容为学习消息队列所做的笔记。&lt;/p&gt;
&lt;h3 id=&#34;为什么使用消息队列&#34;&gt;为什么使用消息队列？&lt;/h3&gt;
&lt;p&gt;使用消息队列有如下好处：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;异步：服务器端组件接到用户请求之后，即可快速响应用户，大大提高了接口的性能。&lt;/li&gt;
&lt;li&gt;解耦：可以解耦后台组件，后台不同服务按需订阅和消费消息，系统耦合性大大降低。&lt;/li&gt;
&lt;li&gt;削峰填谷：可以借助于消息中间件缓冲和摊平并发量高峰期的请求。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;使用消息队列有什么优缺点&#34;&gt;使用消息队列有什么优缺点？&lt;/h3&gt;
&lt;p&gt;使用了消息中间件后，会带来如下问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;系统可用性降低，整个系统的数据传输依赖于消息中间件，如果消息中间件挂宕，系统将无法使用。&lt;/li&gt;
&lt;li&gt;系统复杂性提高，加入消息中间件后，需要考虑消息重复消费、消息丢失及消息顺序性等问题，系统复杂性提高了。&lt;/li&gt;
&lt;li&gt;会带来数据一致性问题，消息在系统中各服务之间传递时，可能会不一致。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;怎么保证消息不丢失&#34;&gt;怎么保证消息不丢失？&lt;/h3&gt;
&lt;p&gt;使用消息队列的时候，需要考虑消息丢失的问题，以 RabbitMQ 为例来说明下。&lt;/p&gt;
&lt;h4 id=&#34;生产者丢失数据&#34;&gt;生产者丢失数据&lt;/h4&gt;
&lt;p&gt;RabbitMQ 生产者将数据发送到 RabbitMQ 的时候，可能数据在网络传输中丢失了，此时 RabbitMQ 接收不到数据，消息就丢失了。&lt;/p&gt;
&lt;p&gt;RabbitMQ 提供了两种方式来解决此问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;事务方式
在生产者发送消息之前，通过 &lt;code&gt;channel.txSelect&lt;/code&gt; 开启一个事务，接着发送消息。如果消息没有成功被 RabbitMQ 接收到，生产者会收到异常，此时，就可以进行事务回滚 &lt;code&gt;channel.txRollback&lt;/code&gt;，然后重新发送。
如果 RabbitMQ 收到了这个消息，就可以通过 &lt;code&gt;channel.txCommit&lt;/code&gt; 提交事务。但此时生产者的吞吐量和性能都会降低很多，现在一般不这样做。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Confirm 机制
在生产者这边设置 Confirm 模式，就是每次发送消息的时候会分配一个唯一的 ID，然后 RabbitMQ 收到之后会回传一个 ACK，告诉生产者，这个消息接收到了；
如果 RabbitMQ 没有接收到这个消息，则回调一个 Nack 的接口，这个时候生产者就可以重新发送该消息。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;事务机制和 Confirm 机制最大的不同在于事务机制是同步的，提交一个事务之前会阻塞在那里；而 Confirm 机制是异步的，发送一个消息之后就可以发送下一个消息，然后那个消息 RabbitMQ 接收了之后会异步回调一个接口，通知生产者这个消息接收到了。&lt;/p&gt;
&lt;p&gt;因此，一般在生产者端避免数据丢失，都是使用 Confirm 机制。&lt;/p&gt;
&lt;h4 id=&#34;rabbitmq-丢失数据&#34;&gt;RabbitMQ 丢失数据&lt;/h4&gt;
&lt;p&gt;RabbitMQ 集群也会丢失消息，在消息发送到 RabbitMQ 之后，默认是没有落地磁盘的，如果 RabbitMQ 服务进程死掉，此时消息就丢失了。&lt;/p&gt;
&lt;p&gt;为了解决这个问题，RabbitMQ 提供了一个持久化机制，消息写入之后会持久化到磁盘。这样即使是服务挂掉，恢复之后也会自动恢复之前存储的数据，这样的机制可以确保消息不会丢失。&lt;/p&gt;
&lt;p&gt;设置持久化有两个步骤：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;创建队列的时候，将其设置为持久化的，这样就可以保证 RabbitMQ 持久化队列的元数据，但是不会持久化队列里的数据。&lt;/li&gt;
&lt;li&gt;发送消息的时候将消息的 deliveryMode 设置为 2，就是将消息设置为持久化的，此时 RabbitMQ 就会将消息持久化到磁盘上去。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果消息发送到 RabbitMQ 之后，还没来得及持久化到磁盘，RabbitMQ 就挂掉了，数据也就丢失了，怎么处理？&lt;/p&gt;
&lt;p&gt;对于这个问题，其实是配合上面的 Confirm 机制一起来保证的，就是在消息持久化到磁盘之后才会给生产者发送 ACK 消息。如果真的遇到了那种极端情况，生产者是可以感知到的，此时生产者可以通过重试发送消息给别的 RabbitMQ`节点。&lt;/p&gt;
&lt;h4 id=&#34;消费者丢失数据&#34;&gt;消费者丢失数据&lt;/h4&gt;
&lt;p&gt;在 RabbitMQ 消费者消费消息的时候，刚拿到消息，RabbitMQ 进程挂掉了，这个时候 RabbitMQ 就会认为消费者已经消费成功了，这条数据就丢失了。&lt;/p&gt;
&lt;p&gt;对于这个问题，要先说明一下 RabbitMQ 消费消息的机制：在消费者收到消息的时候，会发送一个 ACK 给 RabbitMQ，告诉 RabbitMQ 这条消息被消费到了，这样 RabbitMQ 就会把这条消息删除。
但是默认情况下，这个发送 ACK 的操作是自动提交的，也就是说消费者一收到这个消息，就会自动返回 ACK 给 RabbitMQ，所以会出现消息丢失的问题。&lt;/p&gt;
&lt;p&gt;因此，针对这个问题的解决方法就是：关闭 RabbitMQ 消费者的自动提交 ACK，在消费者处理完这条消息之后再手动提交 ACK。这样即使遇到了上面的情况，RabbitMQ 也不会把这条消息删除，会在程序重启之后，重新下发这条消息过来。&lt;/p&gt;
&lt;h3 id=&#34;怎么保证消息中间件的高可用性&#34;&gt;怎么保证消息中间件的高可用性？&lt;/h3&gt;
&lt;p&gt;使用了消息队列之后，我们希望消息队列服务高可用，不能因为机器宕机了，就出现无法收发消息的情况。&lt;/p&gt;
&lt;p&gt;RabbitMQ 有三种模式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;单机模式&lt;/li&gt;
&lt;li&gt;普通集群模式&lt;/li&gt;
&lt;li&gt;镜像集群模式&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;1）单机模式&lt;/p&gt;
&lt;p&gt;单机模式就是在一台机器上部署了一个 RabbitMQ 程序，存在单点问题，可用于测试使用，生产环境不能使用。&lt;/p&gt;
&lt;p&gt;2）普通集群模式&lt;/p&gt;
&lt;p&gt;普通集群模式是在多台机器上启动多个 RabbitMQ 实例，类似于 Master-Slave 模式。但是创建的队列只会放在一个 Master RabbitMQ 实例上，其他实例都同步那个接收消息的 RabbitMQ 元数据。&lt;/p&gt;
&lt;p&gt;在消费消息的时候，如果连接到的 RabbitMQ 实例不是存放队列数据的实例，这个时候 RabbitMQ 就会从存放队列数据的实例上拉取数据，然后返回给客户端。
这种方式有点麻烦，没有做到真正的分布式，每次消费者连接一个实例后拉取数据，如果连接到的不是存放队列数据的实例，这个时候会造成额外的性能开销。如果从放队列的实例拉取，会导致单实例性能瓶颈。
如果放队列数据的 RabbitMQ 实例进程挂掉了，会导致其他实例无法拉取数据，这个集群也就无法消费消息了，没有做到真正的高可用。这个方案主要是提高系统的吞吐量，就是说让集群中的多个节点来服务于某个队列的读写操作。&lt;/p&gt;
&lt;p&gt;3）镜像集群模式&lt;/p&gt;
&lt;p&gt;镜像集群模式是真正的 RabbitMQ 高可用模式，创建的队列无论是元数据还是队列里的消息都会存在于多个实例上。每次写消息到队列的时候，都会自动把消息同步到多个实例的队列中。&lt;/p&gt;
&lt;p&gt;这样的话，任何一个机器宕机了，别的实例都可以用来提供服务，真正做到了高可用。&lt;/p&gt;
&lt;p&gt;但是也存在着不足之处：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;性能开销过高，消息需要同步至所有机器，会导致网络带宽压力和消耗很大。&lt;/li&gt;
&lt;li&gt;扩展性低：无法解决某个队列数据量特别大的情况，导致队列无法线性扩展，就算加了机器，那个机器也会包含队列的所有数据，队列的数据没有做到分布式存储。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于 RabbitMQ 的高可用一般的做法都是开启镜像集群模式，这样最起码做到了高可用，一个节点宕机了，其他节点可以继续提供服务。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s/gqFVeZIE6nfYQd57pQkfaA&#34;&gt;https://mp.weixin.qq.com/s/gqFVeZIE6nfYQd57pQkfaA&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">消息队列</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/rabbitmq/">RabbitMQ</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>常用快捷键</title>
                <link>https://xdhuxc.github.io/posts/mixed/shortcut_key/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/shortcut_key/</guid>
                <pubDate>Tue, 09 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本部分内容记录了一些常用的快捷键，便于查询使用。&lt;/p&gt;
&lt;h3 id=&#34;shell-快捷键&#34;&gt;shell 快捷键&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;快捷键&lt;/th&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + L&lt;/td&gt;
&lt;td&gt;清屏，相当于 clear 命令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + C&lt;/td&gt;
&lt;td&gt;发送 SIGINT 信号给前台进程组中的所有进程，常用于终止正在运行的程序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + Z&lt;/td&gt;
&lt;td&gt;发送 SIGTSTP 信号给前台进程组中的所有进程，常用于挂起一个进程&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + R&lt;/td&gt;
&lt;td&gt;搜索以前使用过的命令，搜索到后，按“Enter”键，直接执行该命令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + A 或 HOME&lt;/td&gt;
&lt;td&gt;将光标移至行首&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;top-命令快捷键&#34;&gt;top 命令快捷键&lt;/h3&gt;
&lt;p&gt;在 Linux shell 下，输入 top 命令，快捷键使用如下：&lt;/p&gt;
&lt;p&gt;按 ‘X’ 键，再按 ‘B’ 键，默认按 CPU 使用率降序排列&lt;/p&gt;
&lt;p&gt;按住 ‘Shift’ 键，再按 ‘P’ 键，是按 CPU 使用率降序排列。&lt;/p&gt;
&lt;p&gt;按住 ‘Shift’ 键，再按 ‘M’ 键，是按 内存 使用率降序排列。&lt;/p&gt;
&lt;p&gt;按住 ‘Shift’ 键，再按 ‘T’ 键，是按 进程运行时间降序排列。&lt;/p&gt;
&lt;p&gt;按 ‘F’ 键，进入字段管理页面，使用上下键控制光标移动，
使用光标选中某字段，按 ‘D’ 或者空格，取消该列的显示，按 ‘q’ 或 ‘Esc’ 再次进入 top 命令页面，可以看到刚才选中的列已经不显示了。&lt;/p&gt;
&lt;p&gt;在字段管理页面，使用光标选中某字段后，按 ‘S’ 键，可将该字段设置为排序字段，然后按 ‘Esc’ 或 ‘Q’ 键退出，默认按降序排列。若要改为升序排列，按住 ‘Shift’ 键，然后按 ‘R’ 键，即可按照排序字段升序排列。&lt;/p&gt;
&lt;h3 id=&#34;vim-快捷键&#34;&gt;vim 快捷键&lt;/h3&gt;
&lt;p&gt;按住 ‘Shift’ 键，然后按 ‘:’ 键，进入命令模式，输入：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-angular2html&#34; data-lang=&#34;angular2html&#34;&gt;set number
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;按 ‘Enter’ 键，显示行号。&lt;/p&gt;
&lt;p&gt;输入：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-angular2html&#34; data-lang=&#34;angular2html&#34;&gt;set encoding=utf-8
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;按 ‘Enter’ 键，则修改编码为UTF-8编码。&lt;/p&gt;
&lt;h3 id=&#34;jetbrains-快捷键&#34;&gt;JetBrains 快捷键&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;快捷键&lt;/th&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + X&lt;/td&gt;
&lt;td&gt;删除当前行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + D&lt;/td&gt;
&lt;td&gt;删除当前行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + Alt + ↑&lt;/td&gt;
&lt;td&gt;复制当前行到上一行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + Alt + ↓&lt;/td&gt;
&lt;td&gt;复制当前行到下一行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;command + F&lt;/td&gt;
&lt;td&gt;当前文件全文查找&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;command + R&lt;/td&gt;
&lt;td&gt;当前文件全文查找替换&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;command + ↑ + R&lt;/td&gt;
&lt;td&gt;全路径查找替换&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;command + ↑ + F&lt;/td&gt;
&lt;td&gt;全路径查找&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;command + l&lt;/td&gt;
&lt;td&gt;跳转至指定行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;word-快捷键&#34;&gt;word 快捷键&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;快捷键&lt;/th&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + Home&lt;/td&gt;
&lt;td&gt;将光标移动到文档首部&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + End&lt;/td&gt;
&lt;td&gt;将光标移动到文档尾部&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Alt + Enter&lt;/td&gt;
&lt;td&gt;单元格内换行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Shift + PageDown&lt;/td&gt;
&lt;td&gt;选中光标后面的部分，可以按住 ‘Shift’ 键，然后一直按 ‘PageDown’ 键，选中内容后，按 ‘Delete’ 键删除选中内容&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;visio-快捷键&#34;&gt;visio 快捷键&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;快捷键&lt;/th&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + =&lt;/td&gt;
&lt;td&gt;将选中的文字变为下标&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + Shift + =&lt;/td&gt;
&lt;td&gt;将选中的文字变为上标&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;windows-快捷键&#34;&gt;windows 快捷键&lt;/h3&gt;
&lt;p&gt;1、按住 Shift 键，右键鼠标，可以在当前目录下打开 PowerShell。&lt;/p&gt;
&lt;h3 id=&#34;atom-快捷键&#34;&gt;Atom 快捷键&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;快捷键&lt;/th&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;command + /&lt;/td&gt;
&lt;td&gt;在当前行插入注释&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;command + x&lt;/td&gt;
&lt;td&gt;删除当前行&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;sublime-text-快捷键&#34;&gt;Sublime Text 快捷键&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;快捷键&lt;/th&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;command + F&lt;/td&gt;
&lt;td&gt;查找&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;command + ⌥ + F&lt;/td&gt;
&lt;td&gt;查找并替换&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;notepad&#34;&gt;Notepad++&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;快捷键&lt;/th&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + L&lt;/td&gt;
&lt;td&gt;删除光标所在行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ctrl + D&lt;/td&gt;
&lt;td&gt;复制当前行到下一行&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;eclipse-快捷键&#34;&gt;Eclipse 快捷键&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;th&gt;快捷键&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;导入相应的包&lt;/td&gt;
&lt;td&gt;Ctrl+ Shift + O&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;在当前行插入空行&lt;/td&gt;
&lt;td&gt;Ctrl + Shif +Enter&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;mindmaster&#34;&gt;MindMaster&lt;/h3&gt;
&lt;p&gt;1、在 Topic 内换行，在光标所在位置，按 &lt;code&gt;Shift+Enter&lt;/code&gt; 键&lt;/p&gt;
&lt;h3 id=&#34;字体和段落&#34;&gt;字体和段落&lt;/h3&gt;
&lt;p&gt;字体：Monaco&lt;/p&gt;
&lt;p&gt;大小：12 pt&lt;/p&gt;
&lt;p&gt;在 word 中，段首空两个汉字，设置首行缩进 0.82 cm。&lt;/p&gt;
&lt;h3 id=&#34;vs-code&#34;&gt;VS Code&lt;/h3&gt;
&lt;p&gt;1、在代码中 &lt;code&gt;Go To Definition&lt;/code&gt; 时，默认情况下会替换掉原来的页面。如果希望打开一个新页面，需要进行如下配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;#34;workbench.editor.enablePreview&amp;#34;: false
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;通过配置 &lt;code&gt;workbench.editor.enablePreview&lt;/code&gt; 为 &lt;code&gt;false&lt;/code&gt; 来禁止编辑器的预览功能，这样在浏览代码时就会跳转到代码页面。&lt;/p&gt;
&lt;p&gt;实际上，VS Code 提供了 Peek 功能，用来在当前页面查看代码，无需跳转到新页面，不过这样会带来新问题：1、挤压了页面空间；2、需要查看的方法或函数还需进一步查看时，就不方便了。另外，对于习惯了跳转到新页面的工程师，还是喜欢用旧的方式。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/">快捷键</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>程序设计（一）</title>
                <link>https://xdhuxc.github.io/posts/programming/programming-design-one/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/programming-design-one/</guid>
                <pubDate>Tue, 09 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录一些在软件开发过程中遇到的问题及思考，持续更新。。。&lt;/p&gt;
&lt;h3 id=&#34;协议-原生-api-和第三方框架或工具包&#34;&gt;协议， 原生 API 和第三方框架（或工具包）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;协议&lt;/p&gt;
&lt;p&gt;有些程序组件，比如LDAP，同时提供协议访问方式和 API 方式，协议方式直接操作数据，但是也是组件软件迭代时最可能变化的，可根据应用场景进行取舍。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;原生 API&lt;/p&gt;
&lt;p&gt;1、使用原生 API 有助于加深对基础架构的理解和增强自己的代码能力。&lt;/p&gt;
&lt;p&gt;2、使用原生 API 操作复杂。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第三方框架（或工具包）&lt;/p&gt;
&lt;p&gt;1、使用第三方框架（或工具包）可以避免基础组件版本变化带来的 API 变化，第三方框架去屏蔽版本差异，可以保持程序的稳定性。&lt;/p&gt;
&lt;p&gt;2、如果第三方框架（或工具包）封装的不够好或者有太多 bug，就会增加程序风险。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;api-调用&#34;&gt;API 调用&lt;/h3&gt;
&lt;p&gt;1、假如在一个函数中既循环调用了外部 API，又要进行本地循环处理，那么将调用外部 API 的循环放置在外层，将本地处理的循环放置在内层，可以有效提高程序运行效率，因为调用外部 API 网络延时较长，本地处理速度快。&lt;/p&gt;
&lt;p&gt;2、除非迫不得已，否则绝对不使用用户名和密码的方式调用 API。&lt;/p&gt;
&lt;p&gt;3、对于 Access Key 和 Secret Key 这种东西，绝对不要直接写在代码中，要保存在本地文件中。&lt;/p&gt;
&lt;h3 id=&#34;思考事项&#34;&gt;思考事项&lt;/h3&gt;
&lt;p&gt;1、在编写代码时，需要考虑数据量，从而考虑网络、计算和存储的分离。&lt;/p&gt;
&lt;h3 id=&#34;问题&#34;&gt;问题&lt;/h3&gt;
&lt;h4 id=&#34;微服务设计&#34;&gt;微服务设计&lt;/h4&gt;
&lt;p&gt;整个系统进行了拆分，但是各个服务使用的数据模型有重合（有些完全重合，有些部分重合）的部分，使用 ORM 框架后，如果彼此之间引用私有仓库的包，会出问题，但是放在公有专门的存放仓库之后，代码散乱，组织结构复杂，可读性会降低，如何优雅地处理这个问题？&lt;/p&gt;
&lt;p&gt;目前是将数据模型复制到需要使用的地方，基本可以解决问题，但是同时，如果公用的数据模型发生变动，其他各处可能需要同步修改，否则会出错误。&lt;/p&gt;
&lt;h4 id=&#34;错误处理&#34;&gt;错误处理&lt;/h4&gt;
&lt;p&gt;在 web 开发中，是使用 HTTP 的响应状态码响应请求，还是在 HTTP 的响应状态码之内，再包裹一个自定义的状态码及错误信息，在什么场景下采用哪种方式好些？&lt;/p&gt;
&lt;p&gt;在采取后者的情况下，往往会存在以下问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;状态码不是全局统一和集中管理的，从而是所有服务公用一套的，导致有和没有一个样，甚至更加混乱，给解决错误带来更大的困扰，实际上解决错误时还是老一套。&lt;/li&gt;
&lt;li&gt;状态码的制定规则，是针对具体错误制定，还是针对某个服务来制定？&lt;/li&gt;
&lt;li&gt;在响应中混用自定义状态码和 HTTP 状态码，导致前端无法统一处理错误。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;生产环境和测试环境分离&#34;&gt;生产环境和测试环境分离&lt;/h4&gt;
&lt;p&gt;系统开发一段时间后，逐渐地，测试环境和生产环境产生了分离，其实主要是后台数据库数据的差异（完全的前后端分离架构），导致一些线上环境中产生的错误，无法在测试环境中复现或修改后也无法在测试环境中进行测试，从而往往会在生产环境中进行小测试，如之奈何？&lt;/p&gt;
&lt;p&gt;1、将生产数据库中除用户信息之外的其他数据每隔一段时间复制到测试数据库中&lt;/p&gt;
&lt;p&gt;2、在测试环境中使用生产环境的 API 接口。&lt;/p&gt;
&lt;h3 id=&#34;真理&#34;&gt;真理&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;好的架构不是设计出来的，是演进出来的。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;待考虑问题&#34;&gt;待考虑问题&lt;/h3&gt;
&lt;h4 id=&#34;2019年11月15日&#34;&gt;2019年11月15日&lt;/h4&gt;
&lt;p&gt;1、设置 &lt;code&gt;GitLab&lt;/code&gt; 保护，禁止向工程的 &lt;code&gt;master&lt;/code&gt; 分支直接推送代码，只能从其他分支合并到 &lt;code&gt;master&lt;/code&gt; 分支。&lt;/p&gt;
&lt;p&gt;2、考虑到将 &lt;code&gt;DDL&lt;/code&gt; 和 &lt;code&gt;DML&lt;/code&gt; 写在一个文件中时，在一些 SQL 管理工具中打开整个文件后不小心执行了整个文件，可能会造成不良后果。建议工程的根目录下建立 &lt;code&gt;sql&lt;/code&gt; 目录，内含 &lt;code&gt;工程名_ddl.sql&lt;/code&gt; 和 &lt;code&gt;工程名_dml.sql&lt;/code&gt; 两个文件，要求 &lt;code&gt;工程名_ddl.sql&lt;/code&gt; 可以直接整个文件执行，平时进行的 DML 语句写在 &lt;code&gt;工程名_dml.sql&lt;/code&gt; 中。&lt;/p&gt;
&lt;p&gt;3、考虑到这样一种常用的使用场景，也是我们自己最常用的新应用部署场景，将 &lt;code&gt;Deployment&lt;/code&gt;、&lt;code&gt;Service&lt;/code&gt;、&lt;code&gt;ConfigMap&lt;/code&gt; 全部写在一个文件 &lt;code&gt;mainfest.yaml&lt;/code&gt; 中，使用 &lt;code&gt;kubectl create -f mainfest.yaml&lt;/code&gt; 来创建该应用及相关常用资源，完善新应用部署功能。目前只能部署单独的 &lt;code&gt;Deployment&lt;/code&gt;，配置其相应的 &lt;code&gt;Service&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;4、已有 &lt;code&gt;ConfigMap&lt;/code&gt; 落库问题，目前只有通过页面增加的 &lt;code&gt;ConfigMap&lt;/code&gt; 落库，其他已经手工创建的 &lt;code&gt;ConfigMap&lt;/code&gt; 尚未落库，也不能在页面中修改。&lt;/p&gt;
&lt;p&gt;5、&lt;code&gt;Deployment&lt;/code&gt;，&lt;code&gt;Service&lt;/code&gt;，&lt;code&gt;ConfigMap&lt;/code&gt; 等资源定期落库。&lt;/p&gt;
&lt;h4 id=&#34;2020年01月08日&#34;&gt;2020年01月08日&lt;/h4&gt;
&lt;p&gt;1、基于 AlertManager 的报警数据落库问题，为后续统计数据和优化提供数据支撑。&lt;/p&gt;
&lt;h3 id=&#34;诡异问题记录&#34;&gt;诡异问题记录&lt;/h3&gt;
&lt;h4 id=&#34;2019年01月03日&#34;&gt;2019年01月03日&lt;/h4&gt;
&lt;p&gt;公司的内部系统用户认证突然出了问题，直接使用 LDAP 协议的第三方系统中有些不能访问，修改密码后，可以访问，原因是密码过期。但是使用我们自己开发的 LDAP 接口的第三方系统，却还是不能访问。&lt;/p&gt;
&lt;p&gt;后来，重启了 LDAP 接口服务后，调用接口的第三方系统终于可以访问了。&lt;/p&gt;
&lt;p&gt;查看 LDAP 接口代码，代码中在程序启动时初始化了 LDAP 连接对象，其后的操作都是使用该对象进行的。然而，当 LDAP 服务重启后，程序中初始化的连接将会断掉&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;LDAP Result Code 200 \&amp;#34;Network Error&amp;#34;\: ldap: connection closed
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时，凡是通过接口访问的，都会出现网络错误。&lt;/p&gt;
&lt;p&gt;此时，先解决问题，重启 LDAP 接口服务&lt;/p&gt;
&lt;p&gt;很多第三方的库或框架，会使用连接池技术，在这种情况下，可以在程序启动时，初始化一个连接对象，用于后续对资源的访问，连接对象由连接池来管理。&lt;/p&gt;
&lt;p&gt;但是，当没有提供连接池时，这样做却可能会出现问题，就像我们所遇到的，连接的对端服务重启了，导致该连接失效，但是客户端代码还是使用的该连接，于是会报出来网络错误等。&lt;/p&gt;
&lt;p&gt;在预估接口 QPS 不是很大的情况下，可以采用如下两种方式来解决：&lt;/p&gt;
&lt;p&gt;1、为每次请求创建一个客户端连接对象，响应完后关闭该连接对象。&lt;/p&gt;
&lt;p&gt;2、初始化一个连接对象，但是每次请求时先检测该连接是否还存活，如果存活着，再处理请求；如果已经无法连接服务，再次创建该连接对象，然后处理请求。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E7%BC%96%E7%A8%8B/">编程</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python virtualenv 的使用</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-virtualenv/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-virtualenv/</guid>
                <pubDate>Mon, 08 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;在 Python 开发时，我们经常需要用到虚拟环境，为各个不同的工程提供指定的运行时环境，提供其需要的隔离的依赖包。使用 virtualenvwrapper 可以很方便地管理不同的虚拟环境。&lt;/p&gt;
&lt;h3 id=&#34;virtualenvwrapper&#34;&gt;virtualenvwrapper&lt;/h3&gt;
&lt;p&gt;1、安装 virtualenvwrapper&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;pip install virtualenvwrapper
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;pip install virtualenvwrapper-win # windows 系统下
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、修改 Envs 目录为指定目录，添加如下环境变量：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;WORKON_HOME=E:\PycharmProject\Envs
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、virtualenvwrapper 的使用&lt;/p&gt;
&lt;p&gt;virtualenvwrapper 的常用命令：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;workon：列出所有的虚拟环境；&lt;/li&gt;
&lt;li&gt;workon xflask：进入虚拟环境 xflask；&lt;/li&gt;
&lt;li&gt;mkvirtualenv xflask：创建虚拟环境 xflask，统一存放在 Envs 目录下，如果没有虚拟环境目录，则创建 ~/Envs 目录，在其下面创建虚拟环境目录；&lt;/li&gt;
&lt;li&gt;mkvirtualenv --python=C:\xdhuxc\Python37-32\python.exe xflask，使用指定版本的 python 解释器创建虚拟环境；&lt;/li&gt;
&lt;li&gt;deactivate：退出虚拟环境；&lt;/li&gt;
&lt;li&gt;rmvirtualenv：删除虚拟环境；&lt;/li&gt;
&lt;li&gt;lsvirtualenv：列出所有的虚拟环境，和不带参数的 workon 效果一样。&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/virtualenv/">virtualenv</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker 合并多条 COPY 命令</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-copy-file-or-folder-one-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-copy-file-or-folder-one-command/</guid>
                <pubDate>Wed, 03 Jul 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;在编写 &lt;code&gt;Dockerfile&lt;/code&gt; 时，我们可能需要将多条指令合并成一行，这样语法简洁，并且可以减少镜像层数。&lt;/p&gt;
&lt;h3 id=&#34;将多条-copy-指令合并为一条&#34;&gt;将多条 COPY 指令合并为一条&lt;/h3&gt;
&lt;p&gt;比如，我们的 &lt;code&gt;Dockerfile&lt;/code&gt; 里面有这样的语句：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;FROM python:2.7-stretch
WORKDIR /xdhuxc/
COPY dingtalk_callback.py /xdhuxc/
COPY requirements.txt /xdhuxc/
COPY settings.py /xdhuxc/
RUN pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple
ENTRYPOINT [&amp;#34;python&amp;#34;, &amp;#34;-u&amp;#34;, &amp;#34;/xdhuxc/dingtalk_callback.py&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;我们想把多个 &lt;code&gt;COPY&lt;/code&gt; 指令合并成一条，可以改写该 &lt;code&gt;Dockerfile&lt;/code&gt; 为如下形式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;FROM python:2.7-stretch
WORKDIR /xdhuxc/
COPY dingtalk_callback.py requirements.txt settings.py /xdhuxc/
RUN pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple
ENTRYPOINT [&amp;#34;python&amp;#34;, &amp;#34;-u&amp;#34;, &amp;#34;/xdhuxc/dingtalk_callback.py&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;FROM python:2.7-stretch
WORKDIR /xdhuxc/
COPY [&amp;#34;dingtalk_callback.py&amp;#34;, &amp;#34;requirements.txt&amp;#34;, &amp;#34;settings.py&amp;#34;, &amp;#34;/xdhuxc/&amp;#34;]
RUN pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple
ENTRYPOINT [&amp;#34;python&amp;#34;, &amp;#34;-u&amp;#34;, &amp;#34;/xdhuxc/dingtalk_callback.py&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;路径中包含空格时，必须使用这种形式。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;COPY&lt;/code&gt; 指令支持通配符，如果复制多个文件时，文件名称本身有规律，则可以使用通配符来实现&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;FROM python:2.7-stretch
WORKDIR /xdhuxc/
COPY dingtalk* /xdhuxc/ # 复制所有以 &amp;#34;dingtalk&amp;#34; 开头的文件到 /xdhuxc/ 目录下
RUN pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple
ENTRYPOINT [&amp;#34;python&amp;#34;, &amp;#34;-u&amp;#34;, &amp;#34;/xdhuxc/dingtalk_callback.py&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;但要注意，&lt;code&gt;COPY&lt;/code&gt; 只能复制目录下的内容，不能复制目录，对于目录的复制，要这样写&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;COPY templates/ /scmp/templates
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其中，&lt;code&gt;templates&lt;/code&gt; 为目录名&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeday.me/bug/20171013/84355.html&#34;&gt;https://codeday.me/bug/20171013/84355.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.docker.com/engine/reference/builder/#copy&#34;&gt;https://docs.docker.com/engine/reference/builder/#copy&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/dockerfile/">Dockerfile</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>部署 clickhouse_exporter</title>
                <link>https://xdhuxc.github.io/posts/storage/clickhouse/clickhouse-exporter/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/clickhouse/clickhouse-exporter/</guid>
                <pubDate>Tue, 25 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下部署 ClickHouse Exporter 的过程，使用 prometheus 监控 ClickHouse 时会用到。&lt;/p&gt;
&lt;p&gt;1、项目地址：https://github.com/f1yegor/clickhouse_exporter&lt;/p&gt;
&lt;p&gt;2、下载该项目并编译为二进制文件，移动至 /usr/bin/ 目录下，并添加执行权限。&lt;/p&gt;
&lt;p&gt;3、配置如下环境变量&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export CLICKHOUSE_USER=&amp;#34;default&amp;#34;
export CLICKHOUSE_PASSWORD=&amp;#34;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、以 Linux 系统服务方式启动之&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=Clickhouse Exporter
After=network.target
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
ExecStart=/usr/bin/clickhouse_exporter -scrape_uri=http://192.168.33.10:8123/
Restart=on-failure
RestartSec=5
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者可以基于 docker 容器方式部署&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d -p 9116:9116 f1yegor/clickhouse-exporter -scrape_uri=http://192.168.33.10:8123/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/clickhouse/">clickhouse</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Git 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/mixed/git/git-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/git/git-questions-and-solutions/</guid>
                <pubDate>Wed, 19 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录一些 git 使用过程中常见的问题及其解决方法。&lt;/p&gt;
&lt;p&gt;1、使用 git 拉取大工程时，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;xdhuxc@DESKTOP-AFGTEDSW MINGW64 /d/PycharmProject
$ git clone -b private git@github.com:xdhuxc/xpython.git                                                                                                               .git
Cloning into &#39;xpython&#39;...
remote: Counting objects: 4608, done.
remote: Compressing objects: 100% (71/71), done.
fatal: pack has bad object at offset 10852763787: inflate returned 1
fatal: index-pack failed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解决方法如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ git clone -b private --depth=1 git@github.com:xdhuxc/xpython.git
Cloning into &#39;xpython&#39;...
remote: Counting objects: 913, done.
remote: Compressing objects: 100% (756/756), done.
remote: Total 913 (delta 143), reused 819 (delta 101)
Receiving objects: 100% (913/913), 1.79 GiB | 10.33 MiB/s, done.
Resolving deltas: 100% (143/143), done.
Checking out files: 100% (798/798), done.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、使用 IDEA 复制 GitHub 上的代码时，提示错误如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Fetch failed: Could not read from remote repository.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在 IDEA 中，点击 “File”，选择 “Settings”，找到 “Version Control”，选择 “Git”，修改 “SSH executable” 为 “Native”，重新拉取代码即可。&lt;/p&gt;
&lt;p&gt;3、git 添加远程仓库时报错&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wanghuans-MacBook-Pro:vue-admin-template wanghuan$ git remote add origin git@github.com:xdhuxc/xpython.git
fatal: remote origin already exists.
wanghuans-MacBook-Pro:vue-admin-template wanghuan$ git remote rm origin
wanghuans-MacBook-Pro:vue-admin-template wanghuan$ git remote add origin git@github.com:xdhuxc/xpython.git
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解决：先删除远程 Git 仓库，然后再添加远程 Git 仓库。&lt;/p&gt;
&lt;p&gt;4、拉取代码时，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wanghuans-MacBook-Pro:k8s wanghuan$ git pull
fatal: refusing to merge unrelated histories
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;原因：本地仓库和远程仓库实际上是两个独立的仓库，可以在 &lt;code&gt;pull&lt;/code&gt; 命令中加入 &lt;code&gt; --allow-unrelated-histories&lt;/code&gt; 选项来解决该问题，该选项可以合并两个独立创建的仓库的历史。
命令为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wanghuans-MacBook-Pro:k8s wanghuan$ git pull origin master --allow-unrelated-histories
From gitlab.ushareit.me:sgt/devops/k8s
 * branch            master     -&amp;gt; FETCH_HEAD
Already up to date!
Merge made by the &#39;recursive&#39; strategy.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;5、使用eclipse，选取指定分支，拉取代码，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Git repository clone failed.
Java heap space
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解决：修改 &lt;code&gt;eclipse&lt;/code&gt; 安装目录下的 &lt;code&gt;eclipse.ini&lt;/code&gt; 文件中如下参数的值：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-Xms1024m
-Xmx5120m
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在 &lt;code&gt;IDEA&lt;/code&gt; 中，参照修改安装目录 &lt;code&gt;bin&lt;/code&gt; 下的 &lt;code&gt;idea.exe.vmoptions&lt;/code&gt; 或 &lt;code&gt;idea64.exe.vmoptions&lt;/code&gt; 文件。&lt;/p&gt;
&lt;p&gt;6、拉取 github 上的代码时，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;warning: no common commits
remote: Counting objects: 3, done.
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
Unpacking objects: 100% (3/3), done.
From github.com:xdhuxc/checklist
 * branch            HEAD       -&amp;gt; FETCH_HEAD
fatal: refusing to merge unrelated histories
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;添加参数&lt;code&gt;--allow-unrelated-histories&lt;/code&gt;后重新拉取&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;git pull --allow-unrelated-histories git@github.com:xdhuxc/checklist.git
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;6、本地修改文件后，拉取 gitlab 上的代码时，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;bash-3.2$ git pull origin master --allow-unrelated-histories -f
From gitlab.ushareit.me:sgt/devops/share-ikc
 * branch            master     -&amp;gt; FETCH_HEAD
error: Your local changes to the following files would be overwritten by merge:
  .gitignore .idea/workspace.xml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解决方法：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;git stash
git pull origin master
git stash pop
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;使用以上命令保留刚才本地修改的代码，并把git服务器上的代码pull到本地（本地刚才修改的代码将会被暂时封存起来&lt;/p&gt;
&lt;p&gt;7、克隆代码时，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wanghuans-MacBook-Pro:PycharmProjects wanghuan$ git clone git@github.com:jumpserver/jumpserver.git
Cloning into &#39;jumpserver&#39;...
remote: Enumerating objects: 83, done.
remote: Counting objects: 100% (83/83), done.
remote: Compressing objects: 100% (68/68), done.
fatal: the remote end hung up unexpectedly55 MiB | 0 bytes/s
fatal: early EOF
Connection to github.com closed by remote host.
fatal: index-pack failed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解决方法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:~ wanghuan$ git config --global http.postBuffer 1048576000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、由于公司代码仓库迁移，导致拉取代码时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Update failed
			@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
			@       WARNING: POSSIBLE DNS SPOOFING DETECTED!          @
			@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
			The ECDSA host key for gitlab.xdhuxc.com has changed,
			and the key for the corresponding IP address 192.168.19.121
			is unknown. This could either mean that
			DNS SPOOFING is happening or the IP address for the host
			and its host key have changed at the same time.
			@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
			@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
			@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
			IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
			Someone could be eavesdropping on you right now (man-in-the-middle attack)!
			It is also possible that a host key has just been changed.
			The fingerprint for the ECDSA key sent by the remote host is
			SHA256:motujg8AdfKP+cphjzDnsmEykU4vqQi7joDXi3DL9MY.
			Please contact your system administrator.
			Add correct... (show balloon)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因：第一次使用 SSH 连接时，会生成一个认证，存储在客户端的 known_hosts，但是如果服务器端重启，那么认证信息也会改变，用原来的客户端信息连接就会出现上述错误。因此，只要把客户端中的认证信息删除，此后连接时会重新生成认证信息，这样就正常了。&lt;/p&gt;
&lt;p&gt;在客户端输入命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ssh-keygen -R ${SERVER_IP}
或
ssh-keygen -R ${SERVER_DOMAIN}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;也可以直接删除 &lt;code&gt;~/.ssh/known_hosts&lt;/code&gt; 文件&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/git/">Git</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/github/">GitHub</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/gitlab/">Gitlab</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>GitHub 上 fork 项目后同步原项目</title>
                <link>https://xdhuxc.github.io/posts/mixed/git/github-sync-master-branch/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/git/github-sync-master-branch/</guid>
                <pubDate>Mon, 17 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;在 GitHub 上 fork 其他项目后，过一段时间后，自己账户下的项目就会和原项目主分支差异比较大，提交 Pull Requests 时就会产生冲突，此时就需要和主分支同步代码。操作如下：&lt;/p&gt;
&lt;p&gt;1、向本地项目添加远程主分支&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:go-common wanghuan$ pwd
/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/go-common
wanghuans-MacBook-Pro:go-common wanghuan$ ls
LICENSE         blog            glog            middleware      pkg             src
wanghuans-MacBook-Pro:go-common wanghuan$ git remote add upstream git@github.com:iyacontrol/go-common.git
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以使用 git branch -v 查看是否已添加过远程分支，若已添加，则可跳过此步骤。&lt;/p&gt;
&lt;p&gt;2、获取主分支的最新修改到本地&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:go-common wanghuan$ git fetch upstream
remote: Enumerating objects: 25, done.
remote: Counting objects: 100% (25/25), done.
remote: Compressing objects: 100% (14/14), done.
remote: Total 20 (delta 7), reused 18 (delta 5), pack-reused 0
Unpacking objects: 100% (20/20), done.
From github.com:iyacontrol/go-common
 &lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; [new branch]      master     -&amp;gt; upstream/master
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、将 upstream 分支修改的内容合并到本地个人分支&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git merge upstream/master
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此处需要解决合并过程中产生的冲突。&lt;/p&gt;
&lt;p&gt;或者使用如下步骤来实现：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git checkout master # 切换到 master 分支
git merge upstream  # 合并主分支修改到本地分支。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、将本地修改提交到 github 上的个人项目&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git push
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;现在，主分支修改的代码完全同步到 fork 出来的的个人项目分支上，此时在个人项目中提交 &lt;code&gt;Pull requests&lt;/code&gt; 就不会发生冲突。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/git/">Git</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/github/">GitHub</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Mac 功能指南</title>
                <link>https://xdhuxc.github.io/posts/mixed/mac-tips/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/mac-tips/</guid>
                <pubDate>Mon, 17 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录一些 Mac 下常用的操作或功能，以备后需。&lt;/p&gt;
&lt;h3 id=&#34;显示隐藏文件和目录&#34;&gt;显示隐藏文件和目录&lt;/h3&gt;
&lt;p&gt;在终端中输入如下命令，即可显示隐藏文件和目录：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;defaults write com.apple.finder AppleShowAllFiles -boolean true
killall Finder
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果想要隐藏原本隐藏的文件和目录，可以使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;defaults write com.apple.finder AppleShowAllFiles -boolean false 
killall Finder
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、更新系统之后，使用 &lt;code&gt;make&lt;/code&gt; 命令时，报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:scmp-cmdb wanghuan$ make build
xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：在命令行中输入如下命令安装命令行工具&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;xcode-select --install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、关闭 MacOS 上的默认启动程序&lt;/p&gt;
&lt;p&gt;解决：依次点击 &lt;code&gt;Finder&lt;/code&gt; -&amp;gt; &lt;code&gt;System Preferences&lt;/code&gt; -&amp;gt; &lt;code&gt;Users &amp;amp; Groups&lt;/code&gt;，在弹出的对话框中，点击 &lt;code&gt;Login Items&lt;/code&gt;，在下方的列表中删除不需要的自启动程序，再点击左下角的 &lt;code&gt;Click the lock to make changes&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;3、Mac 系统将 &lt;code&gt;bash&lt;/code&gt; 更换为 &lt;code&gt;zsh&lt;/code&gt; 后，原来配置的很多环境变量不见了，程序运行出错。&lt;/p&gt;
&lt;p&gt;Mac 系统的环境变量，加载顺序为：&lt;code&gt;/etc/profile&lt;/code&gt;，&lt;code&gt;/etc/paths&lt;/code&gt;，&lt;code&gt;~/.bash_profile&lt;/code&gt;， &lt;code&gt;~/.bash_login&lt;/code&gt;， &lt;code&gt;~/.profile&lt;/code&gt;， &lt;code&gt;~/.bashrc&lt;/code&gt;，其中，&lt;code&gt;/etc/profile&lt;/code&gt; 和 &lt;code&gt;/etc/paths&lt;/code&gt; 是系统级别的，系统启动时就会自动加载，其他几个是当前用户的环境变量。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;~/.bash_profile&lt;/code&gt;, &lt;code&gt;~/.bash_login&lt;/code&gt;，&lt;code&gt;~/.profile&lt;/code&gt; 按照从前往后的顺序读取，如果 &lt;code&gt;~/.bash_profile&lt;/code&gt; 文件存在，则后面几个文件就会被忽略；如果 &lt;code&gt;~/.bash_profile&lt;/code&gt; 文件不存在，才会读取后面的文件，以此类推。&lt;code&gt;~/.bashrc&lt;/code&gt; 没有上述规则，它是 &lt;code&gt;bash&lt;/code&gt; &lt;code&gt;shell&lt;/code&gt; 打开的时候载入的。&lt;/p&gt;
&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;zsh&lt;/code&gt; 后，我们在 ~/.zshrc 文件中写入环境变量，关闭当前终端，重新打开新的终端，即可看到写入的环境变量。&lt;/p&gt;
&lt;p&gt;3、有时候 Mac 从睡眠状态恢复之后没有声音，这是因为 Mac OS X 的核心音频守护进程（coreaudiod）出了问题，杀死该进程即可：（会自动重启）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo killall coreaudiod
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、清除 DNS 缓存，使用如下命令清除 DNS 缓存&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo killall -HUP mDNSResponder
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mac/">Mac</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>在 Jenkins Pipeline 的 groovy 脚本中发送 HTTP 请求</title>
                <link>https://xdhuxc.github.io/posts/devops/jenkins/jenkins-groovy-http/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/jenkins/jenkins-groovy-http/</guid>
                <pubDate>Mon, 17 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了在 Jenkins Pipeline 中 groovy 脚本发送 HTTP 请求的用法。&lt;/p&gt;
&lt;p&gt;在使用 Jenkins Pipeline 时，有时需要和外部系统以 HTTP 方式交互或集成，此时就需要发送 HTTP 请求给外部系统，并接收响应，继续进行处理，而 curl 等命令不太好处理接收到的响应，此时可以使用 groovy 脚本来处理。&lt;/p&gt;
&lt;h3 id=&#34;使用方法&#34;&gt;使用方法&lt;/h3&gt;
&lt;p&gt;1、使用 Jenkins 第一件事情，安装插件，groovy 脚本发送 HTTP 请求需要安装 &lt;code&gt;HTTP Request&lt;/code&gt; 插件，插件 ID 为：&lt;/p&gt;
&lt;p&gt;2、在 pipeline 中编写代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;stage(&amp;#39;Deploy&amp;#39;) {
    steps {
        container(&amp;#39;golang-build-container&amp;#39;) {
            script {
                ws(projectPath) {  
                    def payload = &amp;#34;&amp;#34;&amp;#34;
                        { &amp;#34;app&amp;#34;: &amp;#34;xdhuxc-app&amp;#34; }
                    &amp;#34;&amp;#34;&amp;#34;
                    def authorization = &amp;#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1OTExNzkzNTYsInVzZXIiOiJ3YW5naHVhbnxbMTcgMyA0IDUgNiA3IDggOSAxMCAxMSAxMiAxMyAxNiAxOSAyMCAyMSAyMiAyMyAyNCAyNSAyNl18YWRtaW4ifQ.WR7GaFdm0y2SE3WHGYfE_VbTiXZovmm5hBojvhLn5NI&amp;#34;
                    def app = &amp;#34;xdhuxc-app&amp;#34;
                    def response = httpRequest acceptType: &amp;#39;APPLICATION_JSON&amp;#39;, contentType: &amp;#39;APPLICATION_JSON&amp;#39;, httpMode: &amp;#39;PUT&amp;#39;, requestBody: payload, url: &amp;#34;http://127.0.0.1:80/xdhuxc/apps?app=${app}&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;authorization=${authorization}&amp;#34;, validResponseCodes: &amp;#34;100:511&amp;#34;
                    if (response.status == 200) {
                        println(&amp;#34;Http request to ${url} is successfully, the body is ${body}&amp;#34;)
                    } else {
                        throw new Exception(&amp;#34;the request failed, the http response status is ${response.status}, content is ${response.content}&amp;#34;)
                    }
                }
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，需要加 &lt;code&gt;validResponseCodes: &amp;quot;100:511&amp;quot;&lt;/code&gt;，默认的 &lt;code&gt;validResponseCodes&lt;/code&gt; 为 &lt;code&gt;100:399&lt;/code&gt;，这意味着响应状态码为 &lt;code&gt;400~511&lt;/code&gt; 的请求会直接抛错，拿不到响应。&lt;/p&gt;
&lt;p&gt;此外，还可以添加自定义请求头：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;def response = httpRequest customHeaders: [[name: &amp;#39;cid&amp;#39;, value: &amp;#39;110&amp;#39;]]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;默认情况下，会输出整个请求的信息，包括：URL、请求头、返回码等。如果请求中含有不希望显示的 token，可以修改 &lt;code&gt;quiet: true&lt;/code&gt; 参数，不显示请求详情。&lt;/p&gt;
&lt;p&gt;有时，我们可能会在提交的数据中加入变量，这时可通过如下方式提交数据：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import groovy.json.JsonOutput

stage(&amp;#39;Deploy&amp;#39;) {
    steps {
        container(&amp;#39;golang-build-container&amp;#39;) {
            script {
                ws(env.WORKSPACE) { 
                    def url = &amp;#39;http://127.0.0.1:8000/xdhuxc/apps?app=xdhuxc-cicd&amp;#39;
                    def body = JsonOutput.toJson([&amp;#34;xdhuxc-cicd&amp;#34;: env.image])
                    def headers = [[name: &amp;#39;authorization&amp;#39;, value: &amp;#39;Bearer zZXIiOiJzZ3QtamVua2lucy11cGRhdGUtaW1hZ2V8WzE3IDEwIDExIDEyIDEzIDE2IDE5IDIwIDIxIDIyIDIzIDI0IDMgNCA1IDYgNyA4IDldfG9wZW5hcGktc2d0LWplbmtpbnMtdXBkYXRlLWltYWdlIn0&amp;#39;]]
                    def response = httpRequest acceptType: &amp;#39;APPLICATION_JSON&amp;#39;, contentType: &amp;#39;APPLICATION_JSON&amp;#39;, customHeaders: headers, httpMode: &amp;#39;PUT&amp;#39;, requestBody: body, url: url, validResponseCodes: &amp;#34;100:511&amp;#34;, quiet: true
                    if (response.status == 200) {
                        println(&amp;#34;Http request to ${url} is successfully, the body is ${body}&amp;#34;)
                    } else {
                        throw new Exception(&amp;#34;Deploy to kubernetes failed, the http response status is ${response.status}, content is ${response.content}&amp;#34;)
                    }
                 }
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jenkins.io/doc/pipeline/steps/http_request/#httprequest-perform-an-http-request-and-return-a-response-object&#34;&gt;https://www.jenkins.io/doc/pipeline/steps/http_request/#httprequest-perform-an-http-request-and-return-a-response-object&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;http request 插件参数：https://www.jenkins.io/doc/pipeline/steps/http_request/#http-request-plugin&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/jenkinsci/http-request-plugin&#34;&gt;https://github.com/jenkinsci/http-request-plugin&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/jenkins/">Jenkins</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/groovy/">groovy</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>在 Jenkins 中配置 gitlab 触发器</title>
                <link>https://xdhuxc.github.io/posts/devops/jenkins/jenkins-gitlab-trigger/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/jenkins/jenkins-gitlab-trigger/</guid>
                <pubDate>Mon, 17 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了在 Jenkins 中配置 Gitlab 触发器的过程，从而使得当我们向 gitlab 提交代码时，打上标签，就可以直接触发构建。&lt;/p&gt;
&lt;h3 id=&#34;操作和配置&#34;&gt;操作和配置&lt;/h3&gt;
&lt;p&gt;1、在 Jenkins 和 Gitlab 之间配置触发构建，希望在 Gitlab 上提交代码时，打上标签提交时，触发该工程在 Jenkins 中的构建。&lt;/p&gt;
&lt;p&gt;1）在 GitLab 中使用管理员账户，生成 GitLab API Token，&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG71.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;在 Jenkins 中，&lt;code&gt;系统设置&lt;/code&gt; -&amp;gt; &lt;code&gt;Add Credentials&lt;/code&gt; 中，添加用于认证的 Credentials&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG72.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;使得 Jenkins 可以访问 GitLab 的 API 接口。&lt;/p&gt;
&lt;p&gt;2）在 Jenkins 中，选中 &lt;code&gt;Build when a change is pushed to GitLab&lt;/code&gt;（此处需要使用插件 &lt;code&gt;Gitlab Hook&lt;/code&gt;），将 &lt;code&gt;GitLab webhook URL&lt;/code&gt; 地址&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG610.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;填写至 GitLab 工程的 &lt;code&gt;设置&lt;/code&gt; -&amp;gt;&lt;code&gt;集成&lt;/code&gt; 中 Web hook 下的 &lt;code&gt;链接&lt;/code&gt; 输入框中；&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG612.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;在 Jenkins 中，&lt;code&gt;Build when a change is pushed to GitLab&lt;/code&gt; 下，点击 &lt;code&gt;Advanced&lt;/code&gt;，再点击 &lt;code&gt;Generate&lt;/code&gt;，&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG68.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;将生成的 &lt;code&gt;Secret token&lt;/code&gt; 填写至 GitLab 工程 &lt;code&gt;设置&lt;/code&gt; -&amp;gt; &lt;code&gt;集成&lt;/code&gt; 中 Web hook 下的 &lt;code&gt;安全令牌&lt;/code&gt; 输入框中&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG619.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;在触发器部分，取消 &lt;code&gt;推送事件&lt;/code&gt; 触发器，选择 &lt;code&gt;标签推送事件&lt;/code&gt; 触发器触发。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG621.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;保存后，可进行测试。&lt;/p&gt;
&lt;p&gt;3）在项目 &lt;code&gt;设置&lt;/code&gt; -&amp;gt; &lt;code&gt;仓库&lt;/code&gt; -&amp;gt; &lt;code&gt;部署秘钥&lt;/code&gt; -&amp;gt; &lt;code&gt;展开&lt;/code&gt;，使用 Jenkins 所在机器的公钥创建部署秘钥并为当前工程启用之。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG617.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;2、使用 Jenkins 进行应用的持续集成并构建 docker 镜像，想使用推送代码时的标签迁出代码并以标签作为镜像版本，可以安装 &lt;code&gt;Git Tag Message Plugin&lt;/code&gt; 插件来实现。&lt;/p&gt;
&lt;p&gt;安装 &lt;code&gt;Jenkins Git Plugin&lt;/code&gt; 插件后，默认可以获取如下 7 个环境变量：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GIT_COMMIT：对当前 Git 提交的安全哈希算法（SHA）的引用；&lt;/li&gt;
&lt;li&gt;GIT_COMMITTER_NAME（GIT_AUTHOR_NAME）：发布新 Git 提交时使用的名称；&lt;/li&gt;
&lt;li&gt;GIT_COMMITTER_EMAIL（GIT_AUTHOR_EMAIL）：发布新的 Git 提交时使用的电子邮件地址；&lt;/li&gt;
&lt;li&gt;GIT_URL：远程 Git 仓库的基本名称；&lt;/li&gt;
&lt;li&gt;GIT_URL_N：如果正在使用多个远程 Git 仓库，这将以数字方式列出它们；&lt;/li&gt;
&lt;li&gt;GIT_BRANCH：Jenkins Git 插件正在操作的当前 Git 分支的名称；&lt;/li&gt;
&lt;li&gt;GIT_LOCAL_BRANCH：本地 Git 分支的名称，当 Jenkins Git 插件中 “checkout to specific local branch” 选项被选中的时候；&lt;/li&gt;
&lt;li&gt;GIT_PREVIOUS_COMMIT：当前分支上前一个提交的 id；&lt;/li&gt;
&lt;li&gt;GIT_PREVIOUS_SUCCESSFUL_COMMIT：这个变量将会输出最后一次成功的构建时提交的哈希值；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;安装 &lt;code&gt;Git Tag Message Plugin&lt;/code&gt; 后，可以在脚本中使用环境变量 &lt;code&gt;GIT_TAG_NAME&lt;/code&gt; 和 &lt;code&gt;GIT_TAG_MESSAGE&lt;/code&gt; 来获取代码提交的标签信息，只迁出该提交的代码进行集成。&lt;/p&gt;
&lt;p&gt;如果该方法失效，可以直接在 shell 脚本中使用环境变量获取提交代码得标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tag=${gitlabSourceBranch##*/}
if [ -z &amp;#34;$tag&amp;#34; ];then
  echo &amp;#34;the absent of git tag&amp;#34;
  exit 1
fi
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、配置钉钉通知构建结果&lt;/p&gt;
&lt;p&gt;1）安装 Dingding 插件&lt;/p&gt;
&lt;p&gt;2）增加 &lt;code&gt;Post-build Actions&lt;/code&gt;，添加&lt;code&gt;钉钉通知器配置&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/devops/jenkins/WechatIMG615.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;4、从 Jenkins 向需要授权的 docker registry 中推送镜像
安装 docker-commons 插件，在 系统管理 中，在 docker 部分，添加 docker 镜像仓库的地址，并使用任意有权限的的账户和密码创建 credentials，保存之，即可从 shell 脚本中直接向需要认证的 docker 镜像仓库中推送镜像。&lt;/p&gt;
&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、在 GitLab 中某项目的 &lt;code&gt;设置&lt;/code&gt; -&amp;gt; &lt;code&gt;集成&lt;/code&gt; 中配置 Jenkins webhook，配置完成后点击 &lt;code&gt;Test&lt;/code&gt;，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Hook execution failed: URL &#39;https://jenkins.xdhuxc.com/project/transform&#39; is blocked: Requests to the local network are not allowed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解决：在 &lt;code&gt;管理员区域&lt;/code&gt; 中 &lt;code&gt;设置&lt;/code&gt; 下，在 &lt;code&gt;Outbound requests&lt;/code&gt;部分，选择 &lt;code&gt;Allow requests to the local network from hooks and services&lt;/code&gt;，然后保存之。&lt;/p&gt;
&lt;p&gt;参考链接：https://gitlab.com/gitlab-org/gitlab-ce/issues/46490&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/jenkins/">Jenkins</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/gitlab/">Gitlab</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 GORM 操作 MySQL 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-gorm-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-gorm-questions-and-solutions/</guid>
                <pubDate>Tue, 11 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了一些使用 GORM 操作 MySQL 数据库时常见的问题及解决方法，可以给其他人遇到同样问题解决时提供参考。&lt;/p&gt;
&lt;h3 id=&#34;error-1062-duplicate-entry-viewer-for-key-name&#34;&gt;Error 1062: Duplicate entry &#39;viewer&#39; for key &#39;name&#39;&lt;/h3&gt;
&lt;p&gt;为数据模型中的 name 字段加上了 unique 修饰，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# create the table role
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;CREATE TABLE IF NOT EXISTS &lt;span class=&#34;sb&#34;&gt;`role`&lt;/span&gt; (
    &lt;span class=&#34;sb&#34;&gt;`id`&lt;/span&gt; int(11) NOT NULL AUTO_INCREMENT,
    &lt;span class=&#34;sb&#34;&gt;`name`&lt;/span&gt; varchar(50) NOT NULL,
    &lt;span class=&#34;sb&#34;&gt;`description`&lt;/span&gt; varchar(125) DEFAULT NULL,
    &lt;span class=&#34;sb&#34;&gt;`create_time`&lt;/span&gt; datetime     NOT NULL DEFAULT CURRENT_TIMESTAMP,
    &lt;span class=&#34;sb&#34;&gt;`update_time`&lt;/span&gt; datetime     NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (`id`),
    UNIQUE KEY &lt;span class=&#34;sb&#34;&gt;`name`&lt;/span&gt; (`name`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;但是更新该字段的值时，却报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
 &amp;#34;code&amp;#34;: 50002,
 &amp;#34;result&amp;#34;: &amp;#34;Error 1062: Duplicate entry &amp;#39;viewer&amp;#39; for key &amp;#39;name&amp;#39;&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;后台代码使用 Golang 编写，数据模型为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;type Role struct {
	ID          int       &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;id&amp;#34; gorm:&amp;#34;id&amp;#34;`&lt;/span&gt;
	Name        string    &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;name&amp;#34; gorm:&amp;#34;name&amp;#34;`&lt;/span&gt;
	Description string    &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;description&amp;#34; gorm:&amp;#34;description&amp;#34;`&lt;/span&gt;
	CreateTime  time.Time &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;create_time&amp;#34; gorm:&amp;#34;create_time&amp;#34;`&lt;/span&gt;
	UpdateTime  time.Time &lt;span class=&#34;sb&#34;&gt;`json:&amp;#34;update_time&amp;#34; gorm:&amp;#34;update_time&amp;#34;`&lt;/span&gt;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;更新代码的方法为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;// Update updates the information of specified role
func (rs *roleService) Update(role model.Role) (*model.Role, error) {
	if err := role.Validate(); err != nil {
		return &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;role, err
	}

	role.UpdateTime = time.Now()

	if err := rs.db.Model(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;models.Role{}).Update(map[string]interface{}{
		&amp;#34;name&amp;#34;:        role.Name,
		&amp;#34;description&amp;#34;: role.Description,
		&amp;#34;update_time&amp;#34;: role.UpdateTime,
	}).Error; err != nil {
		return &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;role, err
	}

	return &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;role, nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改为如下方式时，却可以更新成功&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;// Update updates the information of specified role
func (rs *roleService) Update(role model.Role) (*model.Role, error) {
	if err := role.Validate(); err != nil {
		return &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;role, err
	}

	role.UpdateTime = time.Now()

	if err := rs.db.Model(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;role).Update(map[string]interface{}{
		&amp;#34;name&amp;#34;:        role.Name,
		&amp;#34;description&amp;#34;: role.Description,
		&amp;#34;update_time&amp;#34;: role.UpdateTime,
	}).Error; err != nil {
		return &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;role, err
	}

	return &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;role, nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将 db.Model(value interface{}) 中的接口类型参数由 &amp;amp;models.Role{} 修改为 &amp;amp;role，居然就可以更新成功了。&lt;/p&gt;
&lt;p&gt;查看该方法的&lt;a href=&#34;https://github.com/jinzhu/gorm/main.go&#34;&gt;源代码&lt;/a&gt;，如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;// Model specify the model you would like to run db operations
//    // update all users&amp;#39;s name to &lt;span class=&#34;sb&#34;&gt;`hello`&lt;/span&gt;
//    db.Model(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;User{}).Update(&amp;#34;name&amp;#34;, &amp;#34;hello&amp;#34;)
//    // if user&amp;#39;s primary key is non-blank, will use it as condition, then will only update the user&amp;#39;s name to &lt;span class=&#34;sb&#34;&gt;`hello`&lt;/span&gt;
//    db.Model(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;user).Update(&amp;#34;name&amp;#34;, &amp;#34;hello&amp;#34;)
func (s *DB) Model(value interface{}) *DB {
	c := s.clone()
	c.Value = value
	return c
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;从该方法的注释来看，如果使用 &amp;amp;User{}，那么将会更新数据库的所有记录的相同字段为同样的值，如果设置某个字段为 unique，那么当记录数超过一条时，肯定会产生重复的字段值从而导致错误。而实际上，我们的目的是第二种，使用 &amp;amp;user，以主键作为条件更新一条记录。所以，使用 GORM 的 Update 方法时，不要传入指向结构体的指针，而应该传入指向结构体变量的指针。&lt;/p&gt;
&lt;h3 id=&#34;desc-是-mysql-关键字&#34;&gt;desc 是 MySQL 关键字&lt;/h3&gt;
&lt;p&gt;更新数据时，后台 API 返回的错误为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt; &amp;#34;result&amp;#34;: &amp;#34;Error 1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &amp;#39;desc = ?, cloud = ?, update_time = ? WHERE id = ?&amp;#39; at line 1&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;实际上使用的 SQL 语句为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;UPDATE &lt;span class=&#34;sb&#34;&gt;`xdhuxc_aksk`&lt;/span&gt; SET iam = ?, desc = ?, cloud = ?, update_time = ? WHERE id = ?&amp;#34;, g.Iam, g.Desc, g.Cloud, g.UpdateTime, g.ID
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;之所以出现上面的错误，是因为 desc 为 MySQL 数据库关键字，导致该 SQL 语句错误。&lt;/p&gt;
&lt;p&gt;改为如下形式即可：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;UPDATE &lt;span class=&#34;sb&#34;&gt;`xdhuxc_aksk`&lt;/span&gt; SET iam = ?, &lt;span class=&#34;sb&#34;&gt;`desc`&lt;/span&gt; = ?, cloud = ?, update_time = ? WHERE id = ?&amp;#34;, g.Iam, g.Desc, g.Cloud, g.UpdateTime, g.ID
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当然，设计数据库字段名称时，最好不要和 MySQL 数据库关键字冲突，但是如果已经使用了 MySQL 数据库关键字，可以使用反引号将该字段名称括起来，这样也可以操作成功。&lt;/p&gt;
&lt;h3 id=&#34;count-方法的使用&#34;&gt;Count 方法的使用&lt;/h3&gt;
&lt;p&gt;Count() 方法一般用于分页时统计总记录数，但是和 Where() 方法连用时，情况会有些不同。对于如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if err := rs.db.Model(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;models.User{}).
    Where(&amp;#34;tags-&amp;gt;&amp;#39;$.group&amp;#39; = ?&amp;#34;, group).
    Count(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;count).
    Offset(page.Offset).
    Limit(page.PageSize).
    Order(&amp;#34;update_time desc&amp;#34;).
    Find(&lt;span class=&#34;ni&#34;&gt;&amp;amp;users).Error;&lt;/span&gt; err != nil {
        return count, users, err
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;需要注意：&lt;/p&gt;
&lt;p&gt;1、实际上是运行了两条 sql 语句，并非运行了一条 sql 语句。也因此，考虑到注意事项 2 ，在 Where 条件不复杂的时候，把 Count() 单独出来也可以，代码稍有冗余但更清晰。&lt;/p&gt;
&lt;p&gt;2、Count() 方法写在 Where() 方法之前，等同于无条件的统计所有记录，如下 sql 日志所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;(/Users/wanghuan/GolandProjects/GoPath/src/gitlab.xdhuxc.me/devops/xdhuxc/src/service/user.go:38) 
[2019-11-12 11:28:26]  [87.37ms]  SELECT count(*) FROM &lt;span class=&#34;sb&#34;&gt;`user`&lt;/span&gt;    
[0 rows affected or returned ] 

(/Users/wanghuan/GolandProjects/GoPath/src/gitlab.xdhuxc.me/devops/xdhuxc/src/service/user.go:43) 
[2019-11-12 11:28:27]  [175.49ms]  SELECT * FROM &lt;span class=&#34;sb&#34;&gt;`user`&lt;/span&gt;  WHERE (tags-&amp;gt;&amp;#39;$.group&amp;#39; = &amp;#39;Math&amp;#39;) ORDER BY update_time desc LIMIT 10 OFFSET 0  
[4 rows affected or returned ] 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Count() 方法写在 Where() 方法之前，是在仅附加 where 条件之后的统计记录数，不包含 offset 等，如下图 sql 日志所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;(/Users/wanghuan/GolandProjects/GoPath/src/gitlab.xdhuxc.me/devops/xdhuxc/src/service/user.go:39) 
[2019-11-12 11:26:52]  [179.90ms]  SELECT count(*) FROM &lt;span class=&#34;sb&#34;&gt;`user`&lt;/span&gt;  WHERE (tags-&amp;gt;&amp;#39;$.group&amp;#39; = &amp;#39;Math&amp;#39;)  
[0 rows affected or returned ] 

(/Users/wanghuan/GolandProjects/GoPath/src/gitlab.xdhuxc.me/devops/xdhuxc/src/service/user.go:43)
[2019-11-12 11:26:53]  [176.48ms]  SELECT * FROM &lt;span class=&#34;sb&#34;&gt;`user`&lt;/span&gt;  WHERE (tags-&amp;gt;&amp;#39;$.group&amp;#39; = &amp;#39;Math&amp;#39;) ORDER BY update_time desc LIMIT 10 OFFSET 0  
[4 rows affected or returned ] 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;使用-restfulrequestreadentity-方法读取-json-格式数据到结构体中时出现如下错误&#34;&gt;使用 *restful.Request.ReadEntity 方法读取 JSON 格式数据到结构体中时，出现如下错误：&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-angular2html&#34; data-lang=&#34;angular2html&#34;&gt;json: cannot unmarshal string into Go struct field Receiver.resolved of type bool
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;原因：输入格式有错误，将 JSON 格式中 bool 值写成了 字符串 true，改为 JSON 格式的 bool 值即可解决该问题。&lt;/p&gt;
&lt;h3 id=&#34;range-的数据复制&#34;&gt;range 的数据复制&lt;/h3&gt;
&lt;p&gt;对关联的数据模型进行操作时，使用如下代码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;var ug []models.UserGroup
for _, user := range ug {
  var role models.Role
  if result := ugs.db.Model(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;models.Role{}).
    Where(&amp;#34;id = ?&amp;#34;, user.RoleID).
    Select([]string{&amp;#34;id&amp;#34;, &amp;#34;name&amp;#34;}).
    First(&lt;span class=&#34;ni&#34;&gt;&amp;amp;role);&lt;/span&gt; result.Error != nil {
    continue
  }
  user.RoleName = role.Name
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;则对 user.RoleName 的赋值，只在大括号中有效，而使用下面的代码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ugLength := len(ug)
for i := 0; i &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;ugLength&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;na&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;role&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;models&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Role&lt;/span&gt;
  &lt;span class=&#34;na&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;ugs.db.Model(&amp;amp;models.Role{}).&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;Where&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;id &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;?&amp;#34;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ug&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;RoleID&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;).&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;Select&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;{&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;}).&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;First&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&amp;amp;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;role&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Error&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;na&#34;&gt;continue&lt;/span&gt;
  &lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;na&#34;&gt;ug&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;RoleName &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;role.Name&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;则对 &lt;code&gt;user.RoleName&lt;/code&gt; 的赋值在大括号外也有效。
原因：使用 &lt;code&gt;range&lt;/code&gt; 循环非指针型数组时，实际上是执行了深拷贝，在遍历复制出来的数据，原来的数据并没有改变。&lt;/p&gt;
&lt;h3 id=&#34;gorm-注意事项&#34;&gt;GORM 注意事项&lt;/h3&gt;
&lt;p&gt;1、如果数据记录不存在，使用 Delete() 方法删除该记录，result.Error 返回值为 nil。&lt;/p&gt;
&lt;p&gt;2、GORM 中默认使用 id 为主键进行删除和修改，如果自定义数据库主键名称，可能会导致删除和修改操作失败。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/gorm/">GORM</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>配置拉取工具 confd 的使用及说明</title>
                <link>https://xdhuxc.github.io/posts/tools/tools-confd/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/tools/tools-confd/</guid>
                <pubDate>Wed, 05 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍配置拉取工具 confd 的使用，以备后需。&lt;/p&gt;
&lt;p&gt;confd 可以从后台数据源拉取数据，以 golang 模板的方式编写配置文件，渲染到本地文件，这对于一些需要动态或定时更改配置文件的程序非常方便。但是，有些数据源具有发布/订阅的特性，可以向 confd 推送数据，另外一些，就只能采用定时拉取的方式了。&lt;/p&gt;
&lt;h3 id=&#34;confd-安装&#34;&gt;confd 安装&lt;/h3&gt;
&lt;p&gt;下载二进制安装文件并复制到 PATH 目录下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 下载二进制文件
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;wget https://github.com/kelseyhightower/confd/releases/download/v0.16.0/confd-0.16.0-linux-amd64
&lt;span class=&#34;gh&#34;&gt;# 重命名该文件
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;mv confd-0.16.0-linux-amd64 confd
&lt;span class=&#34;gh&#34;&gt;# 添加执行权限并移动至 PATH 路径下
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;chmod +x confd &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cp confd /usr/bin/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;也可自行根据 &lt;a href=&#34;https://github.com/kelseyhightower/confd&#34;&gt;confd 源码&lt;/a&gt; 构建&lt;/p&gt;
&lt;h3 id=&#34;confd-配置及运行&#34;&gt;confd 配置及运行&lt;/h3&gt;
&lt;p&gt;1、创建 confdir，用于存放 confd 的配置文件和模板文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 存放 confd 使用的配置文件
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;mkdir -p /etc/confd/conf.d    
&lt;span class=&#34;gh&#34;&gt;# 用于存放模板文件，生成最终的配置文件
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;mkdir -p /etc/confd/templates
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、创建模板文件及其 confd 配置文件&lt;/p&gt;
&lt;p&gt;模板文件 /etc/confd/templates/alertmanager.yaml.tmpl&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;global:
  resolve_timeout: 5m
route:
  group_by: [&amp;#39;alertname&amp;#39;]
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 15m
  receiver: send_to_dingding_ai

  routes:{{range gets &amp;#34;/alertmanager/routes/*&amp;#34;}}{{$item := json .Value}} # 渲染 JSON 格式数据
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; match_re: {{range $key, $value := json $item.match_re}}
      {{$key}}: &amp;#34;{{$value}}&amp;#34;{{end}}
    continue: true  
    receiver: {{$item.receiver}}{{end}} # {{end}} 写在行尾，处理多余的空行，否则生成的文件中会有多余的空行
    # continue: true # 注意，continue 写在此处，会将数据渲染完毕后，只有一个 continue

inhibit_rules:
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; source_match:
    severity: &amp;#39;critical&amp;#39;
  target_match:
    severity: &amp;#39;warning&amp;#39;
  equal: [&amp;#39;alertname&amp;#39;]

receivers:{{range gets &amp;#34;/alertmanager/receivers/*&amp;#34;}}{{$item := json .Value}}{{ if eq $item.type &amp;#34;dingtalk&amp;#34; }} # 条件判断
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: {{$item.name}}
  dingtalk_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; send_resolved: {{$item.resolved}}
    webhook_url: {{$item.url}}{{ else if eq $item.type &amp;#34;email&amp;#34; }}
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: {{$item.name}}
  email_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; send_resolved: {{$item.resolved}}
    to: {{$item.url}}{{end}}{{end}}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在本地启动 DynamoDB 数据库实例，配置如下环境变量：（confd 需要使用这些环境变量）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export AWS_REGION=ap-southeast-1
export DYNAMODB_LOCAL=http://localhost:8000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;存储在 DynamoDB 中的数据格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
  &amp;#34;key&amp;#34;: &amp;#34;/xdhuxc/alertmanager/receivers/10&amp;#34;,
  &amp;#34;value&amp;#34;: &amp;#34;{\&amp;#34;name\&amp;#34;:\&amp;#34;send_to_dingding_bigdata\&amp;#34;,\&amp;#34;resolved\&amp;#34;:false,\&amp;#34;type\&amp;#34;:\&amp;#34;dingtalk\&amp;#34;,\&amp;#34;url\&amp;#34;:\&amp;#34;https://oapi.dingtalk.com/robot/send?access_token=238c10a8984980a1f34228cab29cbbdaaaceb80ef82ee125c96e3166628e2c44\&amp;#34;}&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
  &amp;#34;key&amp;#34;: &amp;#34;/xdhuxc/alertmanager/routes/25&amp;#34;,
  &amp;#34;value&amp;#34;: &amp;#34;{\&amp;#34;receiver\&amp;#34;:\&amp;#34;send_to_dingding_business\&amp;#34;,\&amp;#34;match_re\&amp;#34;:\&amp;#34;{\\\&amp;#34;namespace\\\&amp;#34;: \\\&amp;#34;business\\\&amp;#34;}\&amp;#34;}&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这些数据由页面加入，以结构化数据存储到 mysql 中，再组织成 key-value 格式存储到 DynamoDB 中。&lt;/p&gt;
&lt;p&gt;此处要特别注意 key 的组成方式和获取值得方式。key 由配置文件中的 tamplate 部分的 prefix + 模板中的前缀路径 + 记录在数据库中的 ID 组成&lt;/p&gt;
&lt;p&gt;配置文件 /etc/confd/conf.d/alertmanager.yaml.toml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[template]
prefix = &amp;#34;/xdhuxc&amp;#34;
src = &amp;#34;alertmanager.yaml.tmpl&amp;#34;
dest = &amp;#34;/tmp/alertmanager.yaml&amp;#34;
keys = [
    &amp;#34;/alertmanager&amp;#34;  # 需要获取数据的键
]
nodes = [
    &amp;#34;&amp;#34;
]

reload_cmd = &amp;#34;curl -X POST http://localhost:9093/-/reload&amp;#34; # 更新配置文件后重启进程的命令
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 confd 进程&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;confd -onetime -backend dynamodb -node http://localhost:8000 -table xdhuxc --log-level debug
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、最终渲染出来的配置文件内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;global:
  resolve_timeout: 5m
route:
  group_by: [&amp;#39;alertname&amp;#39;]
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 15m
  receiver: send_to_dingding_ai

  routes:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; match_re:
      namespace: &amp;#34;business&amp;#34;
    continue: true
    receiver: send_to_dingding_business

inhibit_rules:
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; source_match:
    severity: &amp;#39;critical&amp;#39;
  target_match:
    severity: &amp;#39;warning&amp;#39;
  equal: [&amp;#39;alertname&amp;#39;]

receivers:
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: send_to_dingding_bigdata
  dingtalk_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; send_resolved: false
    webhook_url: https://oapi.dingtalk.com/robot/send?access_token=238c10a8984980a1f34228cab29cbbdaaaceb80ef82ee125c96e3166628e2c44
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;以-linux-系统服务方式运行-confd&#34;&gt;以 Linux 系统服务方式运行 confd&lt;/h3&gt;
&lt;p&gt;以 Linux 系统服务方式部署 confd，每 5 分钟拉取一次配置文件，confd.service 文件内容为：（/usr/lib/systemd/system/confd.service）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=confd
Documentation=http://www.confd.io/
After=network.target

[Service]
Type=simple
Environment=&amp;#34;AWS_REGION=ap-southeast-1&amp;#34;
Environment=&amp;#34;DYNAMODB_LOCAL=&amp;#34;
Environment=&amp;#34;HOME=/root&amp;#34;
ExecStart=/usr/bin/confd -backend dynamodb -table xdhuxc --interval 300 --profile xdhuxc --log-level debug
Restart=always

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上使用 AWS DynamoDB 数据源作为示例，其他数据源可参考 &lt;a href=&#34;https://github.com/kelseyhightower/confd/blob/master/docs/configuration-guide.md&#34;&gt;confd 配置指南&lt;/a&gt; 修改环境变量和启动命令&lt;/p&gt;
&lt;p&gt;当后端存储为 redis 时，confd.service（/usr/lib/systemd/system/confd.service）文件内容为：：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=confd
Documentation=http://www.confd.io/
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/confd --backend redis --node 8.8.8.8:6379 --client-key qZ2$0bHBL --interval 300 --log-level debug
Restart=always

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当后端存储为 etcd 时，confd.service（/usr/lib/systemd/system/confd.service）文件内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=confd
Documentation=http://www.confd.io/
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/confd --watch -backend etcd --node http://127.0.0.1:2379 --log-level debug
Restart=always

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当后端存储为 consul 时，confd.service（/usr/lib/systemd/system/confd.service）文件内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=confd
Documentation=http://www.confd.io/
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/confd --watch -backend consul --node 127.0.0.1:8500 --log-level debug
Restart=always

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;命令说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;--backend：指明数据源，默认为 etcd；&lt;/li&gt;
&lt;li&gt;-table：当数据源为 DynamoDB 时，指定 DynamoDB 表，仅用于数据源为 DynamoDB 时；&lt;/li&gt;
&lt;li&gt;--interval：后台轮询间隔，以秒为单位，默认值为：600；&lt;/li&gt;
&lt;li&gt;--profile：在使用 DynamoDB 作为数据源时，使用 AWS AccessKey 和 Secret Key 的 profile，防止和其他程序使用的 AccessKey 和 Secret Key 冲突，源代码中没有此选项，此处使用的是改造过的&lt;a href=&#34;https://github.com/xdhuxc/confd&#34;&gt;代码&lt;/a&gt;；&lt;/li&gt;
&lt;li&gt;--log-level：confd 日志级别，默认为： info；&lt;/li&gt;
&lt;li&gt;--watch：启用 watch 功能，当 etcd 或 consul 中的数据发生变化时，会触发 confd 全量同步数据，近实时同步。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;添加如下 profile 到 ~/.aws/credentials 文件中&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[xdhuxc]
aws_access_key_id = &amp;#39;${AWS_ACCESS_KEY_ID}&amp;#39;
aws_secret_access_key = &amp;#39;${AWS_SECRET_ACCESS_KEY}&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;该 profile 需要有读 AWS DynamoDB 的权限。&lt;/p&gt;
&lt;p&gt;启动命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload
systemctl restart confd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/kelseyhightower/confd&#34;&gt;https://github.com/kelseyhightower/confd&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/confd/">confd</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/dynamodb/">DynamoDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>AWS DynamoDB 简单使用</title>
                <link>https://xdhuxc.github.io/posts/tools/tools-aws-dynamodb/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/tools/tools-aws-dynamodb/</guid>
                <pubDate>Sun, 02 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下使用 AWS DynamoDB 过程中用到的一些知识和技术点，以备后需。&lt;/p&gt;
&lt;p&gt;Amazon DynamoDB 是一个键/值和文档数据库，可以在任何规模的环境中提供个位数的毫秒级性能。它是一个完全托管的多区域多主数据库，具有适用于 Internet 规模的应用程序的内置安全性、备份和恢复和内存缓存。DynamoDB 每天可处理超过 10 万亿个请求，并可支持每秒超过 2000 万个请求的峰值。&lt;/p&gt;
&lt;h3 id=&#34;使用-docker-本地部署-dynamodb&#34;&gt;使用 docker 本地部署 DynamoDB&lt;/h3&gt;
&lt;p&gt;使用 docker 容器本地部署 DynamoDB 实例&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d -p 8000:8000 amazon/dynamodb-local
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;使用命令行操作-dynamodb&#34;&gt;使用命令行操作 DynamoDB&lt;/h3&gt;
&lt;p&gt;执行 aws 命令前，需要在 ~/.aws/credentials 中配置访问 DynamoDB 的 Access Key 和 Secret Key，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[default]
aws_access_key_id = ${aws_access_key_id}
aws_secret_access_key = ${aws_access_key_id}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 ~/.aws/config 中配置区域，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[default]
region = ap-southeast-1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果是本地启动的 DynamoDB 实例，只需任意一个合法的 DynamoDB Access Key 和 Secret Key 即可。&lt;/p&gt;
&lt;p&gt;1、显示所有数据库表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;aws dynamodb list-tables --endpoint-url http://localhost:8000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、显示特定表信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;aws dynamodb describe-table --table-name xdhuxc --endpoint-url http://localhost:8000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、创建表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;aws dynamodb create-table \
    --table-name xdhuxc \
    --attribute-definitions \
        AttributeName=key,AttributeType=S \
    --key-schema \
        AttributeName=key,KeyType=HASH \
    --provisioned-throughput ReadCapacityUnits=10,WriteCapacityUnits=10 \
    --endpoint-url http://localhost:8000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、插入 JSON 格式数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;aws dynamodb put-item --table-name xdhuxc \
    --item &amp;#39;{ &amp;#34;key&amp;#34;: { &amp;#34;S&amp;#34;: &amp;#34;/myapp/study/hosts/codelieche&amp;#34; }, &amp;#34;value&amp;#34;: {&amp;#34;S&amp;#34;: &amp;#34;{\&amp;#34;domain\&amp;#34;: \&amp;#34;www.codelieche.com\&amp;#34;, \&amp;#34;ip\&amp;#34;: \&amp;#34;192.168.1.101\&amp;#34;}&amp;#34; }}&amp;#39; \
    --endpoint-url http://localhost:8000
    
aws dynamodb put-item --table-name xdhuxc \
    --item &amp;#39;{ &amp;#34;key&amp;#34;: { &amp;#34;S&amp;#34;: &amp;#34;/myapp/study/hosts/codelieche2&amp;#34; }, &amp;#34;value&amp;#34;: {&amp;#34;S&amp;#34;: &amp;#34;{\&amp;#34;domain\&amp;#34;: \&amp;#34;www.codelieche.com\&amp;#34;, \&amp;#34;ip\&amp;#34;: \&amp;#34;192.168.1.101\&amp;#34;}&amp;#34;}}&amp;#39; \
    --endpoint-url http://localhost:8000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、查看 dynamodb 数据库中所有数据&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-angular2html&#34; data-lang=&#34;angular2html&#34;&gt;aws dynamodb scan --table-name xdhuxc --endpoint-url http://localhost:8000
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;使用-golang-操作-dynamodb&#34;&gt;使用 golang 操作 DynamoDB&lt;/h3&gt;
&lt;p&gt;可以使用 AWS 提供的 golang SDK 来操作 DynamoDB，实现在我们的程序内部对 DynamoDB 的调用。&lt;/p&gt;
&lt;p&gt;注意，执行批量操作时，有数据量限制，每次只能增删 25 条数据，多余的将会报错（BatchLimit = 25）。&lt;/p&gt;
&lt;p&gt;1、创建 dynamodb 客户端，对 DynamoDB 的操作都要使用该客户端来进行。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func NewDynamoDBClient(region string, endpoint string, disableSSL bool) (*dynamodb.DynamoDB, error) {
	if region == &amp;#34;&amp;#34; {
		sess, err := session.NewSession()
		if err != nil {
			return nil, err
		}
		metadata := ec2metadata.New(sess)
		ec2Region, err := metadata.Region()
		if err != nil {
			return nil, fmt.Errorf(&amp;#34;aws DynamoDB requires a region&amp;#34;)
		}
		region = ec2Region
	}
	var c *aws.Config
	// 使用环境变量中的 AccessKey 和 SecretKey
	accessKey := os.Getenv(&amp;#34;AWS_ACCESS_KEY_ID&amp;#34;)
	secretKey := os.Getenv(&amp;#34;AWS_SECRET_ACCESS_KEY&amp;#34;)
	if accessKey != &amp;#34;&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; secretKey != &amp;#34;&amp;#34; {
		creds := credentials.NewStaticCredentials(accessKey, secretKey, &amp;#34;&amp;#34;)
		c = &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;aws.Config{
			Region:      aws.String(region),
			Credentials: creds,
			Endpoint:    aws.String(endpoint),
			DisableSSL:  aws.Bool(disableSSL),
		}
	} else if accessKey != &amp;#34;&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; secretKey != &amp;#34;&amp;#34; { // 使用配置文件中的 AccessKey 和 SecretKey
		creds := credentials.NewStaticCredentials(accessKey, secretKey, &amp;#34;&amp;#34;)
		c = &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;aws.Config{
			Region:      aws.String(region),
			Credentials: creds,
			Endpoint:    aws.String(endpoint),
			DisableSSL:  aws.Bool(disableSSL),
		}
	} else {
		c = &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;aws.Config{ // 使用 ~/.aws/credentials 文件中的 AccessKey 和 SecretKey 。
			Region:     aws.String(region),
			Endpoint:   aws.String(endpoint),
			DisableSSL: aws.Bool(disableSSL),
		}
	}

	sess, err := session.NewSession(c)
	if err != nil {
		return nil, err
	}

	db := dynamodb.New(sess)

	return db, nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、创建表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func CreateTable(ddb *dynamodb.DynamoDB, tableName string) error {
	itemInput := &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.CreateTableInput{
		AttributeDefinitions: []*dynamodb.AttributeDefinition{
			{
				AttributeName: aws.String(&amp;#34;key&amp;#34;),
				AttributeType: aws.String(&amp;#34;S&amp;#34;),
			},
		},
		KeySchema: []*dynamodb.KeySchemaElement{
			{
				AttributeName: aws.String(&amp;#34;key&amp;#34;),
				KeyType:       aws.String(&amp;#34;HASH&amp;#34;),
			},
		},
		ProvisionedThroughput: &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.ProvisionedThroughput{
			ReadCapacityUnits:  aws.Int64(10),
			WriteCapacityUnits: aws.Int64(10),
		},
		TableName: aws.String(tableName),
	}
	_, err := ddb.CreateTable(itemInput)
	if err != nil {
		return err
	}

	return nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、向 dynamodb 表中插入键值对&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func insert2DynamoDB(ddb *dynamodb.DynamoDB, tableName string, key string, value string) error {
 	itemInput := &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.PutItemInput{
 		TableName: aws.String(tableName),
 		Item: map[string]*dynamodb.AttributeValue{
 			&amp;#34;key&amp;#34;: {                 // 注意，建表时键名起为 key。
 				S: aws.String(key),
 			},
 			&amp;#34;value&amp;#34;: {
 				S: aws.String(value),
         			},
 		},
 	}

 	if _, err := ddb.PutItem(itemInput); err != nil {
 		return err
 	}
 	return nil
 }
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、向 dynamodb 表中批量插入键值数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func batchWrite2DynamoDB(ddb *dynamodb.DynamoDB, tableName string, data map[string]string) error {
	requestItems := make(map[string][]*dynamodb.WriteRequest)
	length := len(data)
	var writeRequests []*dynamodb.WriteRequest
	count := 0
	writeRequests = []*dynamodb.WriteRequest{}
	for key, value := range data {// 键值数据
		var writeRequest *dynamodb.WriteRequest
		writeRequest = &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.WriteRequest{
			PutRequest: &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.PutRequest{
				Item: map[string]*dynamodb.AttributeValue{
					&amp;#34;key&amp;#34;: {
						S: aws.String(key),
					},
					&amp;#34;value&amp;#34;: {
						S: aws.String(value),
					},
				},
			},
		}
		writeRequests = append(writeRequests, writeRequest)
		count = count + 1

		if (count % utils.BatchLimit == 0) || (count &amp;gt;= length) {
			requestItems[tableName] = writeRequests
			batchInput := &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.BatchWriteItemInput{
				RequestItems: requestItems,
			}

			if _, err := ddb.BatchWriteItem(batchInput); err != nil {
				return err
			}
			writeRequests = []*dynamodb.WriteRequest{}
		}
	}

	return nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、批量删除数据
此处是通过批量删除的方式删除了全部数据，但是保留了表结构，之所以没有采用删除表的操作，是因为线上环境，权限所限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func BatchDeleteItems(ddb *dynamodb.DynamoDB, tableName string) error {
	errc := make(chan error, 1)
	wg := sync.WaitGroup{}

	scannedData, err := ddb.Scan(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.ScanInput{TableName: aws.String(tableName)})
	if err != nil {
		return err
	}

	length := len(scannedData.Items)
	wg.Add(int(math.Ceil((float64(length)) / float64(utils.BatchLimit))))

	req := []*dynamodb.WriteRequest{}
	for i, a := range scannedData.Items {
		req = append(req, &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.WriteRequest{
			DeleteRequest: &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.DeleteRequest{
				Key: map[string]*dynamodb.AttributeValue{
					&amp;#34;key&amp;#34;: a[&amp;#34;key&amp;#34;],
				},
			},
		})
		if (i+1) % utils.BatchLimit == 0 || i &amp;gt;= int(*scannedData.Count)-1 {
			go func(reqChunk []*dynamodb.WriteRequest) {
				defer wg.Done()
				_, err := t.DdbClient.BatchWriteItem(&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.BatchWriteItemInput{
					RequestItems: map[string][]*dynamodb.WriteRequest{
						t.TableName: reqChunk,
					},
				})
				if err != nil {
					errc &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;err&lt;/span&gt;
				&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
			&lt;span class=&#34;err&#34;&gt;}(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;req&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
			&lt;span class=&#34;na&#34;&gt;req &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;[]*dynamodb.WriteRequest{}&lt;/span&gt;
		&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;wg&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;()&lt;/span&gt;
		&lt;span class=&#34;na&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;errc&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;err&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;na&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;-errc&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、删除数据表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func DeleteTable(ddb *dynamodb.DynamoDB, tableName string) error {
	itemInput := &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;dynamodb.DeleteTableInput{
		TableName: aws.String(tableName),
	}

	if _, err := ddb.DeleteTable(itemInput); err != nil {
		return err
	}
	return nil
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://hub.docker.com/r/amazon/dynamodb-local&#34;&gt;https://hub.docker.com/r/amazon/dynamodb-local&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.aws.amazon.com/zh_cn/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html&#34;&gt;https://docs.aws.amazon.com/zh_cn/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/&#34;&gt;https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/aws/">AWS</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Golang 单元测试</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-test/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-test/</guid>
                <pubDate>Sun, 02 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本部分内容记录下 golang 中的单元测试的简单用法。&lt;/p&gt;
&lt;h3 id=&#34;单元测试&#34;&gt;单元测试&lt;/h3&gt;
&lt;p&gt;单元测试的重点在于测试代码的逻辑、场景等，以便尽可能地测试全面，保证代码质量。&lt;/p&gt;
&lt;h3 id=&#34;代码示例&#34;&gt;代码示例&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;编写简单的代码说明下单元测试的基本使用方法
编写主程序文件 test/main.go&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import &amp;#34;fmt&amp;#34;

func main() {
	sum := Add(10, 20)
	fmt.Println(sum)
}

func Add(x int, y int) int {
	return x + y
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;编写单元测试文件 test/main_test.go&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package main

import &amp;#34;testing&amp;#34;

func TestAdd(t *testing.T) {
	sum := Add(10, 20)
	if sum == 30 {
		t.Log(&amp;#34;ok&amp;#34;)
	} else {
		t.Error(&amp;#34;error&amp;#34;)
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;运行测试命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:test wanghuan$ pwd
/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/xgoland/test
wanghuans-MacBook-Pro:test wanghuan$ go test -v
=== RUN   TestAdd
--- PASS: TestAdd (0.00s)
    main_test.go:8: ok
PASS
ok      github.com/xdhuxc/xgoland/test  0.005s
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;golang-单元测试使用规则&#34;&gt;Golang 单元测试使用规则&lt;/h3&gt;
&lt;p&gt;1、含有单元测试代码的 go 文件必须以 &lt;code&gt;_test.go&lt;/code&gt; 结尾，比如测试 &lt;code&gt;main.go&lt;/code&gt; 的单元测试文件命名为 &lt;code&gt;main_test.go&lt;/code&gt; ，Go 语言测试工具只认符合该规则的文件。&lt;/p&gt;
&lt;p&gt;2、单元测试文件名 &lt;code&gt;_test.go&lt;/code&gt; 前面的部分最好是被测试的方法所在 go 文件的文件名，比如 &lt;code&gt;main_test.go&lt;/code&gt;，因为我们要测试的 Add 函数在 &lt;code&gt;main.go&lt;/code&gt; 文件里&lt;/p&gt;
&lt;p&gt;3、单元测试的函数名必须以 &lt;code&gt;Test&lt;/code&gt; 开头，是可导出的公共函数。&lt;/p&gt;
&lt;p&gt;4、测试函数的签名必须接收一个指向 testing.T 类型的指针，并且不能返回任何值。&lt;/p&gt;
&lt;p&gt;5、函数名建议命名为 Test 加要测试的方法函数名，表示要测试该函数。&lt;/p&gt;
&lt;h3 id=&#34;表组测试&#34;&gt;表组测试&lt;/h3&gt;
&lt;p&gt;表组测试指的是一次测试中很多个输入输出场景的测试，例如&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;func TestAdd(t *testing.T) {
	sum := Add(10, 20)
	if sum == 30 {
		t.Log(&amp;#34;ok&amp;#34;)
	} else {
		t.Error(&amp;#34;error&amp;#34;)
	}

	sum = Add(1024, 2048)
	if sum == 3072 {
		t.Log(&amp;#34;ok&amp;#34;)
	} else {
		t.Error(&amp;#34;error&amp;#34;)
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;我们为待测试函数 Add() 准备了两组测试数据 10、20 和 1024、2048，这样就可以测试多个输入场景下的测试效果了。&lt;/p&gt;
&lt;h3 id=&#34;模型层数据测试&#34;&gt;模型层数据测试&lt;/h3&gt;
&lt;p&gt;将各个测试函数共用的变量定义为全局变量，在 init() 函数中进行初始化，在各个测试函数中进行使用。&lt;/p&gt;
&lt;p&gt;编写测试代码如下：user_test.go&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import (
	&amp;#34;fmt&amp;#34;
	&amp;#34;testing&amp;#34;

	&amp;#34;github.com/jinzhu/gorm&amp;#34;
	_ &amp;#34;github.com/jinzhu/gorm/dialects/mysql&amp;#34; # 如果没有导入此句，会报错。

	&amp;#34;gitlab.xdhuxc.com/golang-user/src/models&amp;#34;
)

var db *gorm.DB
var us *userService

func init() {
    uri := fmt.Sprintf(&amp;#34;%s:%s@tcp(%s)/%s?charset=utf8&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;parseTime=True&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;loc=Local&amp;#34;,
    		&amp;#34;root&amp;#34;,
    		&amp;#34;abcd@#129&amp;#34;,
    		&amp;#34;127.0.0.9&amp;#34;,
    		&amp;#34;user&amp;#34;)
    db, _ := gorm.Open(&amp;#34;mysql&amp;#34;, uri)
    db.Debug()
    us := newUserService(db)
}

func Test_UserService_List(t *testing.T) {
	count, users, err := us.List(models.Page{ # List 为分页方法
		Offset:   0,
		PageSize: 30,
	})
	if err != nil {
		t.Error(err)
	} else {
		t.Log(count)
		for _, user := range users {
			fmt.Println(user.String())
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;跳转至 user_test.go 脚本目录下，执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go test --run Test_UserService_List
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/1adc69468b6f&#34;&gt;https://www.jianshu.com/p/1adc69468b6f&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.flysnow.org/2017/05/16/go-in-action-go-unit-test.html&#34;&gt;https://www.flysnow.org/2017/05/16/go-in-action-go-unit-test.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/unittest/">UnitTest</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>JavaScript 中的真值和假值问题</title>
                <link>https://xdhuxc.github.io/posts/programming/javascript/javascript-true-false/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/javascript/javascript-true-false/</guid>
                <pubDate>Sun, 02 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;JavaScript 中的真值和假值经常用于判断语句和条件语句中，但是其真值和假值的确定和其他编程语言大不相同，如果对此理解有误，那么将会导致代码出现问题。&lt;/p&gt;
&lt;h3 id=&#34;javascript-中的真值&#34;&gt;JavaScript 中的真值&lt;/h3&gt;
&lt;p&gt;在 JavaScript 中，真值指的是在布尔值上下文中转换后的值为真的值。&lt;/p&gt;
&lt;p&gt;所有值都是真值，除非它们被定义为假值，即被定义为&lt;code&gt;false&lt;/code&gt;，&lt;code&gt;0&lt;/code&gt;，&lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;，&lt;code&gt;null&lt;/code&gt;，&lt;code&gt;undefined&lt;/code&gt;，&lt;code&gt;NaN&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;JavaScript 在布尔值上下文中使用强制类型转换。&lt;/p&gt;
&lt;p&gt;JavaScript 中的真值示例如下（将被转换为 true，if后的代码段将被执行）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if (true)
if ({})
if ([])
if (42)
if (&amp;#34;foo&amp;#34;)
if (new Date())
if (-42)
if (3.14)
if (-3.14)
if (Infinity)
if (-Infinity)  
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;javascript-中的假值&#34;&gt;JavaScript 中的假值&lt;/h3&gt;
&lt;p&gt;在 JavaScript 中，假值是在布尔值上下文中已认定可转换为假的值。&lt;/p&gt;
&lt;p&gt;JavaScript 在需要用到布尔类型值得上下文中使用强制类型转换将值转换为布尔值，比如在条件语句或者循环语句中。&lt;/p&gt;
&lt;p&gt;JavaScript 中的假值示例如下（通过 if 代码段将 falsy 值转换为 false）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if (false)
if (null)
if (undefined)
if (0)
if (NaN)
if (&amp;#39;&amp;#39;)
if (&amp;#34;&amp;#34;)
if (document.all)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;document.all 在过去被用于浏览器检测，是 HTML 规范在此定义了故意与 ECMAScript 标准相违背的，以保持与历史代码得兼容性。&lt;/p&gt;
&lt;p&gt;document.all 虽然是一个对象，但其转换为布尔值后是 false。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.mozilla.org/zh-CN/docs/Glossary/Truthy&#34;&gt;https://developer.mozilla.org/zh-CN/docs/Glossary/Truthy&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.mozilla.org/zh-CN/docs/Glossary/Falsy&#34;&gt;https://developer.mozilla.org/zh-CN/docs/Glossary/Falsy&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/javascript/">JavaScript</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vue &#43; Element-UI 表单校验功能的总结</title>
                <link>https://xdhuxc.github.io/posts/vue/vue-element-ui-verify/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/vue/vue-element-ui-verify/</guid>
                <pubDate>Sun, 02 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;使用 vue 和 element-ui 开发的前端工程，进行资源创建时，需要在前端页面对表单进行校验，特此记录，以备后需。&lt;/p&gt;
&lt;h3 id=&#34;普通输入框的校验&#34;&gt;普通输入框的校验&lt;/h3&gt;
&lt;p&gt;普通输入框的校验，可以直接使用默认的校验器进行校验，示例如下：&lt;/p&gt;
&lt;p&gt;1）对数据模型添加 rules 规则&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;lt;template&amp;gt;
  &amp;lt;div class=&amp;quot;app-container&amp;quot;&amp;gt;
    &amp;lt;el-dialog
      :visible.sync=&amp;quot;dialogFormVisible&amp;quot;
      :title=&amp;quot;$t(&#39;business.businessApplicationMonitor&#39;)&amp;quot;
      :show-close=&amp;quot;false&amp;quot;
      :close-on-click-modal=&amp;quot;false&amp;quot;
      :close-on-press-escape=&amp;quot;false&amp;quot;
      width=&amp;quot;620px&amp;quot;&amp;gt;
      &amp;lt;el-form ref=&amp;quot;businessForm&amp;quot; :model=&amp;quot;temp&amp;quot; :rules=&amp;quot;businessVerifyRules&amp;quot; label-width=&amp;quot;120px&amp;quot; label-position=&amp;quot;left&amp;quot;&amp;gt;
          &amp;lt;el-form-item :label=&amp;quot;$t(&#39;business.regionName&#39;)&amp;quot; prop=&amp;quot;region_name&amp;quot;&amp;gt;
            &amp;lt;el-select v-model=&amp;quot;temp.region_name&amp;quot; :placeholder=&amp;quot;$t(&#39;business.placeholder&#39;)&amp;quot;&amp;gt;
              &amp;lt;el-option v-for=&amp;quot;region in regions&amp;quot; :key=&amp;quot;region.value&amp;quot; :label=&amp;quot;region.label&amp;quot; :value=&amp;quot;region.value&amp;quot;&amp;gt;&amp;lt;/el-option&amp;gt;
            &amp;lt;/el-select&amp;gt;
          &amp;lt;/el-form-item&amp;gt;
          &amp;lt;el-form-item :label=&amp;quot;$t(&#39;business.name&#39;)&amp;quot; prop=&amp;quot;name&amp;quot;&amp;gt;
            &amp;lt;el-input v-model=&amp;quot;temp.name&amp;quot; :clearable=&amp;quot;true&amp;quot; style=&amp;quot;width: 400px&amp;quot;/&amp;gt;
          &amp;lt;/el-form-item&amp;gt;
      &amp;lt;/el-form&amp;gt;
      &amp;lt;div slot=&amp;quot;footer&amp;quot; class=&amp;quot;dialog-footer&amp;quot;&amp;gt;
          &amp;lt;el-button @click=&amp;quot;onCancel&amp;quot;&amp;gt; {{ $t(&#39;business.cancel&#39;) }} &amp;lt;/el-button&amp;gt;
          &amp;lt;el-button type=&amp;quot;primary&amp;quot; @click=&amp;quot;onSubmit&amp;quot;&amp;gt; {{ $t(&#39;business.confirm&#39;) }} &amp;lt;/el-button&amp;gt;
      &amp;lt;/div&amp;gt;
    &amp;lt;/el-dialog&amp;gt;
  &amp;lt;/div&amp;gt;
&amp;lt;/template&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;:rules=&amp;quot;businessVerifyRules&amp;quot;&lt;/code&gt; 为该表单添加验证规则，每一个表单项的 prop 属性将作为表单校验的属性名称，需要指定。&lt;/p&gt;
&lt;p&gt;2）编写 rules 规则&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;export default {
  name: &#39;Business&#39;,
  data() {
    return {
      businessVerifyRules: {
        region_name: [{
          required: true, trigger: [&#39;blur&#39;, &#39;change&#39;], message: this.$t(&#39;confirm.nullWarning&#39;)
        }],
        name: [{
          required: true, trigger: &#39;blur&#39;, message: this.$t(&#39;confirm.nullWarning&#39;)
        }]
      }
    };
  }
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在数据部分编写校验规则，name，port等表示被校验属性，需要和表单项中的 prop 属性指定的属性名称保持一致，否则无法完成校验功能。&lt;/p&gt;
&lt;p&gt;其内置的校验器类型还包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;string：必须是字符串类型，这也是默认的类型。&lt;/li&gt;
&lt;li&gt;number：必须是数值类型。&lt;/li&gt;
&lt;li&gt;boolean：必须是布尔类型。&lt;/li&gt;
&lt;li&gt;method：必须是函数类型。&lt;/li&gt;
&lt;li&gt;regexp: 必须是 RegExp 的实例或者一个可以无异常地创建 RegExp 实例的字符串。&lt;/li&gt;
&lt;li&gt;integer：必须是数值类型和整数。&lt;/li&gt;
&lt;li&gt;float：必须是数值类型和一个浮点数。&lt;/li&gt;
&lt;li&gt;array：必须是由 Array.isArray 确定的数组。&lt;/li&gt;
&lt;li&gt;object：必须是一个对象类型，并且不是 Array.isArray。&lt;/li&gt;
&lt;li&gt;enum：值必须存在于 enum 中。&lt;/li&gt;
&lt;li&gt;date：值必须由 Date 确定有效。&lt;/li&gt;
&lt;li&gt;url：必须是一个 url 类型。&lt;/li&gt;
&lt;li&gt;hex：必须是一个 hex 类型。&lt;/li&gt;
&lt;li&gt;email：必须是一个 email 类型。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;数值类型的校验&#34;&gt;数值类型的校验&lt;/h4&gt;
&lt;p&gt;对于数值类型的校验，可以使用默认的 &lt;code&gt;number&lt;/code&gt; 类型校验，但是我们的数值在业务逻辑上有其特殊性，其实是个端口号，所以就有以下要求：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用户必须输入数值，不能提交空字符串。&lt;/li&gt;
&lt;li&gt;用户的输入必须是可解析为数值的字符串，不能是其他的字符串。&lt;/li&gt;
&lt;li&gt;用户输入的数值必须在 1024~65535 之间，不能超出这个范围。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;为了同时满足以上要求，我们可以编写自定义的校验函数，将校验逻辑写在校验函数中，校验通过则放行，不通过则返回明确的错误提示。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;app-container&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-dialog&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:visible&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;dialogFormVisible&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$t(&amp;#39;business.businessApplicationMonitor&amp;#39;)&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:show-close&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:close-on-click-modal&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:close-on-press-escape&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;width&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;620px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;businessForm&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;temp&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:rules&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;businessVerifyRules&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;label-width&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;80px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$t(&amp;#39;business.port&amp;#39;)&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;prop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;port&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;temp.port&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 400px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;slot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;footer&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;dialog-footer&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;=&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;onCancel&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; {{ $t(&amp;#39;business.cancel&amp;#39;) }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;primary&amp;#34;&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;=&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;onSubmit&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; {{ $t(&amp;#39;business.confirm&amp;#39;) }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-dialog&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Business&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;validatePort&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;rule&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$refs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;businessForm&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clearValidate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;port&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;parseInt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;// 判断是否为数字
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;isNaN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;business.validateNumber&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;port&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1024&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;port&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;65535&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;business.validateRange&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;business.nullWarning&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;businesses&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;temp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;prome_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10106&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;businessVerifyRules&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[{&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;required&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;trigger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;blur&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;message&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;confirm.nullWarning&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;validator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;validatePort&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;trigger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;blur&amp;#39;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}]&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 businessVerifyRules 中添加自定义校验器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;businessVerifyRules: {
    port: [{
      validator: validatePort, trigger: &amp;#39;blur&amp;#39;
    }]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;通过 validator 字段指定自定义校验函数 validatePort，触发条件为：blur。&lt;/p&gt;
&lt;h4 id=&#34;复杂数据结构的校验&#34;&gt;复杂数据结构的校验&lt;/h4&gt;
&lt;p&gt;对于复杂数据结构的校验，采取的方式是编写自定义的校验函数，将校验逻辑封装到校验函数中，校验通过则放行，不通过则返回错误提示，但是需要注意的是，每次执行校验函数时，需要先清除上次的校验结果，否则校验效果就比较滑稽了。&lt;/p&gt;
&lt;p&gt;比如我们的项目中，需要校验键值对，采用了如下的方式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;90
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;app-container&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-dialog&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:visible&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;dialogFormVisible&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$t(&amp;#39;business.businessApplicationMonitor&amp;#39;)&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:show-close&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:close-on-click-modal&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;:close-on-press-escape&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;width&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;620px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;businessForm&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;temp&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:rules&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;businessVerifyRules&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;label-width&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;80px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$t(&amp;#39;business.label&amp;#39;)&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;prop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;label&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 400px&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hidden&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;v-for&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;(label, index) in temp.labels&amp;#34;&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;:key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;label&amp;#39; + index&amp;#34;&lt;/span&gt;
          &lt;span class=&#34;na&#34;&gt;prop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;labels&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;label.key&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;label.value&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:clearable&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;width: 199px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;temp.labels.length !== 1&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;danger&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-delete&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
              &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;removeLabel(index)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;v-if&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;index === temp.labels.length - 1&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;primary&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mini&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;el-icon-plus&amp;#34;&lt;/span&gt;
              &lt;span class=&#34;na&#34;&gt;circle&lt;/span&gt;
              &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;prevent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;addLabel&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form-item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;slot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;footer&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;dialog-footer&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;=&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;onCancel&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; {{ $t(&amp;#39;business.cancel&amp;#39;) }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;primary&amp;#34;&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@click&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;=&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;onSubmit&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; {{ $t(&amp;#39;business.confirm&amp;#39;) }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-button&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-dialog&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Business&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;validateLabels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;rule&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$refs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;businessForm&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;clearValidate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;length&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;===&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;business.validateLabel&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
          &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;business.nullWarning&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;business.nullWarning&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;businesses&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;temp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;gid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;prome_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10106&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;businessVerifyRules&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[{&lt;/span&gt;
          &lt;span class=&#34;nx&#34;&gt;validator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;validateLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;trigger&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;blur&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;change&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}]&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;弹出框中是一个表单，表单中有个标签项，每项均是键值对，需要每项同时都配置键值对，如果没有同时配置，需要在页面给出提示，可以在并列显示的标签后面点击按钮删除当前标签。我们将校验逻辑写在自定义校验函数中，然后加入到校验规则里，就可以起作用了。&lt;/p&gt;
&lt;p&gt;需要注意的是，每次校验前，需要使用表单的 clearValidate() 函数清理上次的校验结果，如果没有这一步，表单校验的结果就会显得错乱。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/yiminghe/async-validator&#34;&gt;https://github.com/yiminghe/async-validator&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vue/">Vue</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C/">表单校验</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>记一次 HTTP PUT/POST 请求 406 错误</title>
                <link>https://xdhuxc.github.io/posts/programming/web/http-406-not-acceptable/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/web/http-406-not-acceptable/</guid>
                <pubDate>Sat, 01 Jun 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;最近使用 axios 和 go-restful 分别作为前后端 API 开发时，出了个奇怪的 406 问题，记录下来，以备后需。&lt;/p&gt;
&lt;p&gt;我们的项目前端使用 vue 和 element-ui 搭建，后台使用 go-restful 来编写 API。以前开发基本顺利，没有出现过奇怪的问题，但是最近突然出现了个莫名其妙的 406 问题，查阅文档，各种尝试，始终没有找到优雅的解决方法，导致开发进度被推迟了两天。目前，该问题已经解决，特此记录。&lt;/p&gt;
&lt;p&gt;前端使用 axios 编写的接口如下：（src/api/kubernetes/deployment.js）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import request from &amp;#39;@/utils/kubernetesRequest&amp;#39;;
export function restartApp(cid, namespace, appName) {
  return request({
    url: &amp;#39;/apps/&amp;#39; + namespace + &amp;#39;/&amp;#39; + appName + &amp;#39;/restart&amp;#39;,
    method: &amp;#39;PUT&amp;#39;,
    headers: {
      cid: cid
    }
  });
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其中，axios 实例的定义为：（src/utils/kubernetesRequest.js）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import axios from &amp;#39;axios&amp;#39;;
import store from &amp;#39;../store/index&amp;#39;;
import Clear from &amp;#39;../store/modules/user&amp;#39;;
import { getToken } from &amp;#39;@/utils/auth&amp;#39;;
import router from &amp;#39;../router&amp;#39;;
import lang from &amp;#39;@/lang&amp;#39;;

// create axios instance
const service = axios.create({
  baseURL: process.env.BASE_API + &amp;#39;/kubernetes&amp;#39;,
  timeout: 5000, // the timeout of request
  headers: {
    &amp;#39;Content-Type&amp;#39;: &amp;#39;application/json&amp;#39;,
    &amp;#39;Accept&amp;#39;: &amp;#39;application/json&amp;#39;,
  }
});

// the request interceptor
service.interceptors.request.use(
  config =&amp;gt; {
    const token = getToken();
    if (token) {
      config.headers[&amp;#39;Authorization&amp;#39;] = &amp;#39;Bearer &amp;#39; + token;
    } else { // if token is not existed, go to the login page
      store.dispatch(&amp;#39;Clear&amp;#39;).then(response =&amp;gt; {
        router.replace({
          path: &amp;#39;/login&amp;#39;,
        });
      }).catch(error =&amp;gt; {
        console.log(error);
      });
    }
    return config;
  },
  error =&amp;gt; {
    console.log(error);
    Promise.reject(error);
  }
);
// the response interceptor
service.interceptors.response.use(
  response =&amp;gt; {
    return response;
  },error =&amp;gt; {
    if (error.response) {// in some cases，the error.response is undefined
      switch (error.response.status) {
      case 401:
        store.dispatch(&amp;#39;Clear&amp;#39;).then(response =&amp;gt; {
          router.replace({
            path: &amp;#39;/login&amp;#39;,
          });
        });
        break;
      case 403:
        error.message = lang.t(&amp;#39;notification.noOperatePrivilege&amp;#39;);
        return Promise.reject(error);
      }
    } else {
      return Promise.reject(error);
    }
    return Promise.reject(error);
  }
);

export default service;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后在组件（src/views/kubernetes/application/deployment/index.vue）中调用该方法&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;lt;script&amp;gt;
import { restartApp } from &#39;@/api/kubernetes/deployment&#39;;
import { setCurrentCluster, setCurrentApplication } from &#39;@/utils/auth&#39;;
import { handleScaleError } from &#39;@/utils/utils&#39;;
import { mapGetters } from &#39;vuex&#39;;

export default {
  name: &#39;Deployment&#39;,
  data() {
    return {
      apps: [],
      currentApp: &#39;&#39;,
      temp: {
        app: {},
        revision: &#39;&#39;,
      },    
    };
  },
  computed: {
    ...mapGetters([
      &#39;currentGroup&#39;,
      &#39;currentCluster&#39;,
      &#39;currentApplication&#39;
    ])
  },
  created() {
    
  },
  methods: {
    handleRestart(index, app) {
      this.$confirm(this.$t(&#39;confirm.restart&#39;), this.$t(&#39;confirm.title&#39;), {
        confirmButtonText: this.$t(&#39;confirm.confirm&#39;),
        cancelButtonText: this.$t(&#39;confirm.cancel&#39;),
        type: &#39;warning&#39;
      }).then(() =&amp;gt; {
        restartApp(this.currentCluster.id, app.namespace, app.name).then(response =&amp;gt; {
          if (response.status === 201) {
            this.$message({
              type: &#39;success&#39;,
              message: this.$t(&#39;notification.restartSuccessMessage&#39;),
              duration: 2000,
              offset: 40
            });
          }
          this.getAppsData();
        }).catch(error =&amp;gt; {
          if (error.response) {
            if (error.response.status === 403) {
              this.$message({
                type: &#39;error&#39;,
                message: error.message,
                duration: 2000,
                offset: 40
              });
            } else {
              this.$message({
                message: this.$t(&#39;notification.restartFailedMessage&#39;),
                type: &#39;error&#39;,
                duration: 2000,
                offset: 40
              });
            }
          } else {
            this.$message({
              type: &#39;error&#39;,
              message: error.message,
              duration: 2000,
              offset: 40
            });
          }
        });
      }).catch(() =&amp;gt; {
        this.$message({
          type: &#39;info&#39;,
          message: this.$t(&#39;confirm.cancelRestart&#39;),
          duration: 2000,
          offset: 40
        });
      });
    }
};
&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;点击重启按钮时，传入当前行的值作为 app 的值，请求后台 API。&lt;/p&gt;
&lt;p&gt;后台使用 go-restful 开发的 API，主要代码为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;type AppController struct {
	*BaseController
}

func newAppController(bc *BaseController) *AppController {
	tags := []string{&amp;#34;deployment&amp;#34;}
	ac := &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;AppController{}
	ac.BaseController = bc

    ws.Route(ac.ws.PUT(&amp;#34;/apps/{namespace}/{app}/restart&amp;#34;).To(AppRestart).
        Doc(&amp;#34;app restart&amp;#34;).
        Param(ac.ws.PathParameter(&amp;#34;namespace&amp;#34;, &amp;#34;namespace name&amp;#34;).DataType(&amp;#34;string&amp;#34;).Required(true)).
        Param(ac.ws.PathParameter(&amp;#34;app&amp;#34;, &amp;#34;app name&amp;#34;).DataType(&amp;#34;string&amp;#34;).Required(true)).
        Param(ac.ws.HeaderParameter(&amp;#34;cid&amp;#34;, &amp;#34;cluster id&amp;#34;).DataType(&amp;#34;integer&amp;#34;).Required(true)).
        Metadata(restfulspec.KeyOpenAPITags, tags).
        Returns(http.StatusOK, &amp;#34;OK&amp;#34;, nil).
        Returns(http.StatusBadRequest, &amp;#34;ERROR&amp;#34;, nil))  

	return ac
}
    
func AppRestart(req *restful.Request, resp *restful.Response) {
	client, ok := getClusterKClient(req)
	if !ok {
		util.WriteResonse(resp, util.InvalidCluster, fmt.Errorf(&amp;#34;cannot get cluster client&amp;#34;))
		return
	}

	namespace := req.PathParameter(&amp;#34;namespace&amp;#34;)
	if namespace == &amp;#34;&amp;#34; {
		util.WriteResonse(resp, util.InvalidParams, fmt.Errorf(&amp;#34;invalid ns name error&amp;#34;))
		return
	}
	namespace = strings.ToLower(namespace)

	appName := req.PathParameter(&amp;#34;app&amp;#34;)
	if appName == &amp;#34;&amp;#34; {
		util.WriteResonse(resp, util.InvalidParams, fmt.Errorf(&amp;#34;invalid app name error&amp;#34;))
		return
	}

	err = bs.AppService.AppRestart(appName, namespace, client)
	if err != nil {
		util.WriteResonse(resp, util.RestartAppError, err)
		return
	}

	resp.WriteHeader(http.StatusCreated)
}      
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 PUT 方法向后台 API 发送请求后，返回的结果为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;General
Request URL: http://192.168.1.227:8000/kubernetes/apps/cas//restart
Request Method: PUT
Status Code: 406 Not Acceptable
Remote Address: 159.138.87.227:8000
Referrer Policy: no-referrer-when-downgrade

Response Headers
access-control-allow-origin: http://0.0.0.0:9528
content-length: 19
content-type: text/plain; charset=utf-8
date: Wed, 29 May 2019 02:31:13 GMT
server: envoy
x-envoy-upstream-service-time: 0

Request Headers
Accept: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NTkxMjMxNTUsInVzZXIiOiJ3YW5naHVhbnxbMTUgMTddfGFkbWluIn0.VsRlRATa8QYJS8TrF3RrrAI-ZMEdZxIvwszXyH3G880
cid: 5
Origin: http://0.0.0.0:9528
Referer: http://0.0.0.0:9528/
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查询 &lt;a href=&#34;https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/406&#34;&gt;MDN&lt;/a&gt; 文档，对 406 解释如下：&lt;/p&gt;
&lt;p&gt;HTTP 协议中的 406 Not Acceptable 状态码表示客户端错误，指代服务器端无法提供与  &lt;code&gt;Accept-Charset&lt;/code&gt; 以及 &lt;code&gt;Accept-Language&lt;/code&gt; 消息头指定的值相匹配的响应。&lt;/p&gt;
&lt;p&gt;在实际应用中，这个错误状态码极少使用：不是给用户返回一个晦涩难懂（且难以更正）的错误状态码，而是将相关的消息头忽略，同时给用户提供一个看得见摸得着的页面。这种做法基于这样一个假设：即便是不能达到用户十分满意，也强于返回错误状态码。&lt;/p&gt;
&lt;p&gt;如果服务器返回了这个错误状态码，那么消息体中应该包含所能提供的资源表现形式的列表，允许用户手动进行选择。&lt;/p&gt;
&lt;p&gt;根据文档的提示，我检查了 axios 请求实例的 &lt;code&gt;Accept-Charset&lt;/code&gt; 和 &lt;code&gt;Accept-Language&lt;/code&gt; 消息头的设置。实际上，我并没有显式指定这两个请求头的值，那么在默认情况下，浏览器和服务器之间协商的结果应该是一致的，所以应该不是这两个请求头不一致导致的。&lt;/p&gt;
&lt;p&gt;由于我们使用了 envoy 来做代理，我就搜索了 envoy 相关的资料，envoy 官方网站对 &lt;a href=&#34;https://developers.envoy.com/#response-codes&#34;&gt;响应状态码&lt;/a&gt; 的解释如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Code&lt;/th&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;406&lt;/td&gt;
&lt;td&gt;Not Acceptable&lt;/td&gt;
&lt;td&gt;The requested resource is only capable of generating content not acceptable according to the Accept headers sent in the request.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;也就是说，请求的资源只能根据发送的请求头 Accept 生成不可接受的内容。根据此提示，我注意到 响应头中的 &lt;code&gt;Accept&lt;/code&gt; 为 &lt;code&gt;text/plain&lt;/code&gt;，而请求头中的 &lt;code&gt;accept&lt;/code&gt; 为 &lt;code&gt;application/json&lt;/code&gt;，所以，应该是由 envoy 返回的 406 错误。&lt;/p&gt;
&lt;p&gt;但是另外的代码使用 PUT 方法发送请求却没有这个问题，于是，我就尝试着改造了一下代码，最终发现，由于我的请求数据全部在请求头和路径参数中，所以请求体没有设置，当我把请求体设置上后，返回结果就正常了，虽然请求体的内容为空。改造后的前端 API 如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import request from &amp;#39;@/utils/kubernetesRequest&amp;#39;;
export function restartApp(cid, namespace, appName) {
  return request({
    url: &amp;#39;/apps/&amp;#39; + namespace + &amp;#39;/&amp;#39; + appName + &amp;#39;/restart&amp;#39;,
    method: &amp;#39;PUT&amp;#39;,
    headers: {
      cid: cid
    },
    data: {}
  });
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;整个请求和响应就正常了。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://developers.envoy.com/#response-codes&#34;&gt;https://developers.envoy.com/#response-codes&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/406&#34;&gt;https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/406&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/http/">HTTP</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/web/">Web</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vue 集成 CodeMirror</title>
                <link>https://xdhuxc.github.io/posts/vue/vue-codemirror/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/vue/vue-codemirror/</guid>
                <pubDate>Fri, 24 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;当我们需要在网页页面中输入不同编程语言代码并高亮显示时，可以使用 CodeMirror 来实现这种需求。&lt;/p&gt;
&lt;h3 id=&#34;codemirror-简介&#34;&gt;CodeMirror 简介&lt;/h3&gt;
&lt;p&gt;CodeMirror 是一个用于编辑文本框代码高亮的 JavaScript 插件，为各种编程语言实现关键字、函数、变量等代码高亮，丰富的 API 和可扩展功能以及多个主题样式、可以基本满足各种项目的需求。&lt;/p&gt;
&lt;p&gt;CodeMirror 支持各种编程语言、标记语言的语法高亮，包括 C、C++、Java、PHP、JavaScript、Python、Go、Ruby、SQL等，以及 LaTex、wiki、Markdown等，同时也支持 JSON、YAML、TOML等配置文件常用格式。此外，CodeMirror 还支持代码自动补全、搜索、替换、HTML预览、显示行号、选择/搜索结果高亮等功能。&lt;/p&gt;
&lt;p&gt;CodeMirror 目前已经被集成进各种应用程序中，例如 Adobe Brackets、Light Table等开发环境，经常被用于各种 SQL、JavaScript、JSON、YAML 等的在线编辑器的基础库来使用。&lt;/p&gt;
&lt;h3 id=&#34;原生方式使用-codemirror&#34;&gt;原生方式使用 CodeMirror&lt;/h3&gt;
&lt;p&gt;本部分内容介绍如何使用 CodeMirror 插件。&lt;/p&gt;
&lt;p&gt;1、引入核心文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;lib/codemirror.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;link&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;stylesheet&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;lib/codemirror.css&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;mode/javascript/javascript.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;codemirror.js 和 codemirror.css 是 CodeMirror 插件的核心文件，无论要高亮的代码是何种语言，都需要引入这两个文件。&lt;/p&gt;
&lt;p&gt;引入 mode/javascript/javascript.js 用于支持对 JavaScript 的语法高亮。&lt;/p&gt;
&lt;p&gt;2、创建编辑器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;textarea&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;code&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;code&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;textarea&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建 HTML 文本框元素，用于存放需要高亮显示的代码。&lt;/p&gt;
&lt;p&gt;在 JavaScript 代码中&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;editor&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;CodeMirror&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fromTextArea&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementById&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;code&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 获取文本框元素
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;lineNumbers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;text/x-yaml&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;gutters&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;CodeMirror-lint-markers&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;theme&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;rubyblue&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;                             &lt;span class=&#34;c1&#34;&gt;//设置选项参数
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用文本框元素和参数对象来创建 CodeMirror 对象，&lt;/p&gt;
&lt;p&gt;选项参数含义说明如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lineNumbers：为 true 时在左侧显示行号，为 false 时不显示行号。&lt;/li&gt;
&lt;li&gt;mode：显示模式，也就是需要高亮显示的语言的标示，例如 text/x-yaml 表示将高亮显示 YAML 语言的内容。&lt;/li&gt;
&lt;li&gt;gutters：用来添加额外的 gutter，值为 CSS 名称数组，每一项定义了用于绘制 gutter 背景的宽度。&lt;/li&gt;
&lt;li&gt;theme：显示的主题，详情可参考：https://codemirror.net/demo/theme.html。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;3、获取及填充值&lt;/p&gt;
&lt;p&gt;使用如下方法获取 CodeMirror 的值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;editor.getValue() # 获取经过转义的数据
editor.getTextArea().value # 获取未经过转义的数据
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下方法为 CodeMirror 赋值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;editor.setValue(&amp;#34;Hello, World!&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、设置文本框尺寸及选项&lt;/p&gt;
&lt;p&gt;可通过如下方法设置文本框尺寸&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;editor.setSize(&amp;#34;600px&amp;#34;, &amp;#34;800px&amp;#34;);
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可在代码中通过如下方式设置 CodeMirror 属性&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;editor.setOption(&amp;#34;readOnly&amp;#34;, true);
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;vue-中集成-codemirror&#34;&gt;Vue 中集成 CodeMirror&lt;/h3&gt;
&lt;p&gt;当我们使用 Vue 来做我们的前端项目时，可以使用基于 CodeMirror 的 vue-codemirror 来完成 Web 代码编辑器。&lt;/p&gt;
&lt;p&gt;1、安装插件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 安装 codemirror 插件
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;npm install codemirror
&lt;span class=&#34;gh&#34;&gt;# 安装 vue-codemirror 插件
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;npm install vue-codemirror
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、挂载 VueCodeMirror，在 main.js 中加入如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import VueCodemirror from &amp;#39;vue-codemirror&amp;#39;;
import &amp;#39;codemirror/lib/codemirror.css&amp;#39;;

Vue.use(VueCodemirror);

new Vue({
  el: &amp;#39;#app&amp;#39;,
  router,
  store,
  i18n,
  render: h =&amp;gt; h(App),
});
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、在其他页面中使用该组件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-dialog&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;:visible&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;dialogViewVisible&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;:title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;CodeMirror&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;:show-close&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;:close-on-click-modal&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;:close-on-press-escape&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;width&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;620px&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;codemirror&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;codeMirrorContent&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:options&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;cmOptions&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;json-editor&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;codemirror&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;el-dialog&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;codemirror&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;vue-codemirror&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;codemirror/addon/lint/lint.css&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;codemirror/lib/codemirror.css&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;codemirror/theme/rubyblue.css&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;script-loader!jsonlint&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;codemirror/mode/javascript/javascript&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;codemirror/addon/lint/lint&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;codemirror/addon/lint/json-lint&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;CodeMirror&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;codeMirrorContent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;dialogViewVisible&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;cmOptions&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;lineNumbers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;text/x-yaml&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;gutters&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;CodeMirror-lint-markers&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;theme&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;rubyblue&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;lint&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;c1&#34;&gt;// 处理点击事件
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;nx&#34;&gt;handleView&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;codeMirrorContent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;yaml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dialogViewVisible&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mode 用来指定显示代码的格式，可以是JSON，YAML，SQL等，详情可参考：https://codemirror.net/mode/index.html。&lt;/li&gt;
&lt;li&gt;codeMirrorContent 是字符串格式的内容，如果后台传递过来的数据不是字符串格式，需要转换为字符串格式，否则会出错。&lt;/li&gt;
&lt;li&gt;theme 是显示主题，可以显示不同的背景色，详细可参考：https://codemirror.net/demo/theme.html。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;选项参数含义说明如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lineNumbers：为 true 时在左侧显示行号，为 false 时不显示行号。&lt;/li&gt;
&lt;li&gt;mode：显示模式，也就是需要高亮显示的语言的标示，例如 text/x-yaml 表示将高亮显示 YAML 语言的内容。&lt;/li&gt;
&lt;li&gt;gutters：用来添加额外的 gutter，值为 CSS 名称数组，每一项定义了用于绘制 gutter 背景的宽度。&lt;/li&gt;
&lt;li&gt;theme：显示的主题，详情可参考：https://codemirror.net/demo/theme.html。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、页面中报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Error: Parse error on line 1:

^
Expecting &amp;#39;STRING&amp;#39;, &amp;#39;NUMBER&amp;#39;, &amp;#39;NULL&amp;#39;, &amp;#39;TRUE&amp;#39;, &amp;#39;FALSE&amp;#39;, &amp;#39;{&amp;#39;, &amp;#39;[&amp;#39;, got &amp;#39;EOF&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可能的一种情况是：&lt;/p&gt;
&lt;p&gt;字符串内容为 YAML 格式，但是 mode 却为：&lt;code&gt;text/x-json&lt;/code&gt;，将其改为：&lt;code&gt;text/x-yaml&lt;/code&gt; 试下。&lt;/p&gt;
&lt;p&gt;2、使用多个 CodeMirror 实例时，会发生数据不能及时更新，需要获取到焦点才会更新数据的情况，解决方法如下：&lt;/p&gt;
&lt;p&gt;引入 refresh 插件，在处理函数中使用定时任务刷新 CodeMirror 组件，代码示例如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;codemirror&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ref&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;jenkinsFileCode&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;v-model&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;content&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;:options&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;fileOptions&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;json-editor&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;codemirror&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kr&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;codemirror/addon/display/autorefresh.js&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;kr&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Pipeline&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
      &lt;span class=&#34;nx&#34;&gt;fileOptions&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;lineNumbers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;text/x-yaml&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;gutters&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;CodeMirror-lint-markers&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;theme&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;erlang-dark&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;lint&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;lineWrapping&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;autoRefresh&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 此属性是 autorefresh 的，需要引入 autorefresh.js
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;methods&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
       &lt;span class=&#34;nx&#34;&gt;setTimeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
              &lt;span class=&#34;k&#34;&gt;this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;$refs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;jenkinsFileCode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;refresh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
       &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;json-editor&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;height&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;CodeMirror&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;border&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;px&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;solid&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;#eee&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;height&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;950&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;px&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;CodeMirror-scroll&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;height&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;950&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;px&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;overflow-y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;overflow-x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codemirror.net/&#34;&gt;https://codemirror.net/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.itread01.com/content/1540634681.html&#34;&gt;https://www.itread01.com/content/1540634681.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/onlyonely/p/4450029.html&#34;&gt;https://www.cnblogs.com/onlyonely/p/4450029.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vue/">Vue</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/codemirror/">CodeMirror</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Go Template 的使用</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-template/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-template/</guid>
                <pubDate>Thu, 23 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本部分内容记录下使用 golang 的模板时，需要注意的一些小问题。&lt;/p&gt;
&lt;h3 id=&#34;if-else-语句&#34;&gt;if-else 语句&lt;/h3&gt;
&lt;p&gt;在我们的项目中，需要动态渲染 alertmanager 的配置文件。我们选择了 confd 作为工具来获取后台数据并渲染数据到模板中。&lt;/p&gt;
&lt;p&gt;在模板渲染中，使用 if-else 语句的时候，当需要判断和某个字符串相等的时候，不能使用常用的 &lt;code&gt;==&lt;/code&gt;，而是要使用 &lt;code&gt;eq&lt;/code&gt; 函数，编写模板如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;receivers:{{range gets &amp;#34;/alertmanager/receivers/*&amp;#34;}}{{$item := json .Value}}
{{ if eq $item.type &amp;#34;dingtalk&amp;#34; }}
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: {{$item.name}}
  dingtalk_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; send_resolved: {{$item.resolved}}
    webhook_url: {{$item.url}}
{{ else if eq $item.type &amp;#34;email&amp;#34; }}
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: {{$item.name}}
  email_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; send_resolved: {{$item.resolved}}
    to: {{$item.url}}{{end}}
{{end}}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;另外，这种写法可读性好，但是渲染后会多出来一些空行，改为如下模板即可：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;receivers:{{range gets &amp;#34;/alertmanager/receivers/*&amp;#34;}}{{$item := json .Value}}{{ if eq $item.type &amp;#34;dingtalk&amp;#34; }}
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: {{$item.name}}
  dingtalk_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; send_resolved: {{$item.resolved}}
    webhook_url: {{$item.url}}{{ else if eq $item.type &amp;#34;email&amp;#34; }}
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: {{$item.name}}
  email_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; send_resolved: {{$item.resolved}}
    to: {{$item.url}}{{end}}{{end}}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;数据部分以 JSON 格式向模板传递。&lt;/p&gt;
&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;1、golang template 对于数组循环输出，空数组（数组长度为 0）不进行渲染&lt;/p&gt;
&lt;p&gt;2、在 &lt;code&gt;range-end&lt;/code&gt; 结构内部，如果要使用外部的变量，比如，&lt;code&gt;.Name&lt;/code&gt;，需要写成 &lt;code&gt;$.Name&lt;/code&gt;，即在外部变量名称前加 &lt;code&gt;$&lt;/code&gt; 即可，单独的 &lt;code&gt;$&lt;/code&gt; 等同于 &lt;code&gt;global&lt;/code&gt;。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/template/">Template</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>JavaScript 中的日期和时间格式化</title>
                <link>https://xdhuxc.github.io/posts/programming/javascript/javascript_date_time/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/javascript/javascript_date_time/</guid>
                <pubDate>Sun, 19 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;摘要：&lt;/p&gt;
&lt;p&gt;　　本篇博客主要介绍 JavaScript 中的日期时间与Unix时间戳的转换及日期的格式化，都是在前端开发中经常会用到技术。&lt;/p&gt;
&lt;h3 id=&#34;日期时间与-unix-时间戳的转换&#34;&gt;日期时间与 Unix 时间戳的转换&lt;/h3&gt;
&lt;p&gt;最近项目中使用到了 Prometheus，从前端页面向后端接口发送请求时，传递的参数中有查询 Prometheus 指标的起止时间范围，格式为 Unix 时间戳，这就需要使用 JavaScript 在前端页面获取当前时间，然后转换为 Unix 时间戳。&lt;/p&gt;
&lt;p&gt;以下方法返回当前时间至 GMT 时间1970年1月1日00时00分00秒对应的毫秒数.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;new Date().getTime()
Date.parse(new Date())
(new Date()).valueOf()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;而 Unix 时间戳定义为从 GMT 时间1970年01月01日00时00分00秒起至当前时间的总秒数。因此，给上述代码除以 1000，即可得到其对应的 Unix 时间戳：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;(new Date().getTime()) / 1000
(Date.parse(new Date())) / 1000
(new Date()).valueOf() / 1000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这同时也意味着，当我们从后端获取到 Unix 时间戳，再通过 JavaScript 代码格式化为日期时间时，需要给相应时间戳乘 1000，然后再格式化，否则会得到错误的日期。&lt;/p&gt;
&lt;h3 id=&#34;日期的格式化&#34;&gt;日期的格式化&lt;/h3&gt;
&lt;p&gt;JavaScript 没有提供常用的类似 &lt;code&gt;yyyy-MM-dd hh:mm:ss&lt;/code&gt; 日期时间格式化函数，仅仅提供了获取年月日、时分秒等函数。&lt;/p&gt;
&lt;p&gt;借助于 prototype 属性，我们可以为 Date 对象自定义格式化函数。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Date.prototype.format = function(fmt) {
  var o = {
    &amp;#39;M+&amp;#39; : this.getMonth() + 1,                 // 月份
    &amp;#39;d+&amp;#39; : this.getDate(),                    // 日
    &amp;#39;h+&amp;#39; : this.getHours(),                   // 小时
    &amp;#39;m+&amp;#39; : this.getMinutes(),                 // 分
    &amp;#39;s+&amp;#39; : this.getSeconds(),                 // 秒
    &amp;#39;q+&amp;#39; : Math.floor((this.getMonth() + 3) / 3), // 季度
    &amp;#39;S&amp;#39;  : this.getMilliseconds()             // 毫秒
  };
  if(/(y+)/.test(fmt)) {
    fmt = fmt.replace(RegExp.$1, (this.getFullYear() + &amp;#39;&amp;#39;).substr(4 - RegExp.$1.length));
  }
  for(var k in o) {
    if(new RegExp(&amp;#39;(&amp;#39; + k + &amp;#39;)&amp;#39;).test(fmt)) {
      fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : ((&amp;#39;00&amp;#39; + o[k]).substr((&amp;#39;&amp;#39; + o[k]).length)));
    }
  }
  return fmt;
};
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这样，我们就可以这样格式化 Date 对象了：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;new Date(metrics_time_unix_stamp_format * 1000).format(&amp;#39;yyyy-MM-dd hh:mm:ss&amp;#39;) # 2019-05-19 15:23:34
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当然也可以这样格式化：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;new Date(metrics_time_unix_stamp_format * 1000).format(&amp;#39;yyyy-MM-dd&amp;#39;) # 2019-05-19
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;golang-时间字符串的格式化&#34;&gt;Golang 时间字符串的格式化&lt;/h3&gt;
&lt;p&gt;后台 API 接口使用 golang 开发时，传到前端的时间字符串是这样的：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;2019-05-19T15:23:34Z
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;而 JavaScript 没有提供这样的格式化方法，我们可以将其认为是个固定模式的字符串，对其进行字符串操作，以空格代替其中的 &lt;code&gt;T&lt;/code&gt; 和 &lt;code&gt;Z&lt;/code&gt; 即可，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;create_time.replace(&amp;#39;T&amp;#39;, &amp;#39; &amp;#39;).replace(&amp;#39;Z&amp;#39;, &amp;#39; &amp;#39;) # 2019-05-19 15:23:34
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这样就得到我们常用的日期时间字符串了。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://www.w3school.com.cn/jsref/jsref_obj_date.asp&#34;&gt;http://www.w3school.com.cn/jsref/jsref_obj_date.asp&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/javascript/">JavaScript</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Prometheus 和 AlertManager 配合使用</title>
                <link>https://xdhuxc.github.io/posts/devops/prometheus/prometheus-alertmanager/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/prometheus/prometheus-alertmanager/</guid>
                <pubDate>Fri, 17 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Prometheus 和 AlertManager 配合使用时的配置方式，以备后需。&lt;/p&gt;
&lt;h3 id=&#34;prometheus-配置&#34;&gt;prometheus 配置&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# Prometheus 全局配置项
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;global:
  scrape_interval:     15s # 设置抓取数据的周期，默认为：1min
  evaluation_interval: 15s # 设置更新 rules 文件的周期，默认为：1min
  scrape_timeout:      15s # 设置抓取数据的超时时间，默认为：10s
  external_labels:         # 额外的属性，会添加到拉取的数据并存储到数据库中。
    monitor: &amp;#39;codelab_monitor&amp;#39; 
  

&lt;span class=&#34;gh&#34;&gt;# Alertmanager 配置
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;alerting:
  alertmanagers:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#34;localhost:9093&amp;#34;] # 设定 alertmanager 和 prometheus 的交互接口，也就是 alertmanager 监听的 IP 地址和端口。

&lt;span class=&#34;gh&#34;&gt;# rule 配置，首次读取默认加载，之后根据 evaluation_interval 设定的周期加载
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;rule_files:
  # - &amp;#34;prometheus_rules.yml&amp;#34;
  # - &amp;#34;alertmanager_rules.yml&amp;#34;

&lt;span class=&#34;gh&#34;&gt;# scape 配置，即提供数据的端点的配置
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;scrape_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;prometheus&amp;#39;            # job_name 默认以 job=&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;job_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 的形式写入时间序列的标签之中，可以用于查询使用
    scrape_interval: 15s              # 抓取周期，默认采用全局配置
    # 指标路径默认为：/metrics 
    # 协议默认为：http 
    static_configs:                   # 静态配置
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;192.168.33.10:9090&amp;#39;] # prometheus 抓取数据的地址，即 instance 实例项
    
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;node_exporter&amp;#39;
    static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;192.168.33.10:9000&amp;#39;]    
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;动态更新 prometheus 的配置，即热更新加载，有如下两种方式：
1、向 prometheus 进程发送 SIGHUP 信号。&lt;/p&gt;
&lt;p&gt;2、使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -X POST http://localhost:9090/-/reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;需要启动 prometheus 进程时添加 --web.enable-lifecycle 参数&lt;/p&gt;
&lt;h3 id=&#34;alertmanager-配置&#34;&gt;AlertManager 配置&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# Alertmanager 全局配置项
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;global:
  resolve_timeout: 5m                                    # 处理超时时间，默认为：5min
  smtp_smarthost: &amp;#39;smtp.163.com:25&amp;#39;                      # 邮箱 SMTP 服务器
  smtp_from: &amp;#39;abc@163.com&amp;#39;                               # 发件邮箱名称
  smtp_auth_username: &amp;#39;xdhuxc@163.com&amp;#39;                   # 邮箱名称
  smtp_auth_password: &amp;#39;Abc@19873&amp;#39;                        # 邮箱密码或授权码
  wechat_api_url: &amp;#39;https://qyapi.weixin.qq.com/cgi-bin/&amp;#39; # 企业微信地址

&lt;span class=&#34;gh&#34;&gt;# 定义模板
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;templates:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; &amp;#39;template/*.tmpl&amp;#39;
&lt;span class=&#34;gh&#34;&gt;# 定义路由树信息
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;route:
  group_by: [&amp;#39;group_name&amp;#39;]     # 报警分组依据
  group_wait: 10s              # 第一次等待多久时间发送一组警报的通知
  group_internal: 10s          # 下一次发送新警报前的等待时间
  repeat_interval: 1m          # 发送重复警报的周期，对于 email 配置中，此项不可以设置过低，否则将会由于邮件发送太过频繁，被 SMTP 服务器拒绝
  receiver: &amp;#39;email&amp;#39;            # 发送警报的接收者的名称
  
&lt;span class=&#34;gh&#34;&gt;# 定义警报接收者的信息
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;receivers:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: &amp;#39;email&amp;#39;                             # 警报
    email_configs:                            # 邮箱配置
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; to: &amp;#39;xdhuxc@163.com&amp;#39;                    # 接收警报的 email 配置
      html: &amp;#39;{{ template &amp;#34;email.html&amp;#34; . }}&amp;#39;   # 设置邮件的内容模板
      headers: { Subject: &amp;#34;[WARN] 报警邮件&amp;#34; }  # 接收邮件的标题
      
    webhook_configs:                          # webhook 配置
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; url: &amp;#39;http://localhost:5001&amp;#39;
    send_resolved: true
    
    wechat_configs:                           # 企业微信报警配置
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; send_resovled: true
      to_party: &amp;#39;1&amp;#39;                           # 接收组的 ID
      agent_id: &amp;#39;1022321&amp;#39;                     # 企业微信——》自定义应用——》AgentID
      corp_id: &amp;#39;skjsdjgldfg&amp;#39;                  # 企业信息（我的企业——》CorpID【在底部】）
      api_secret: &amp;#39;sfsdgdfgd&amp;#39;                 # 企业微信——》自定义应用——》Secret
      message: &amp;#39;{{ template &amp;#34;wechat.html&amp;#34; }}&amp;#39; # 发送消息模板的设置

&lt;span class=&#34;gh&#34;&gt;# 覆盖规则
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 一个 inhibit 规则是在与另一组匹配器匹配的警报存在的条件下，使匹配一组匹配器的警报失效的规则，两个警报必须具有一组相同的标签
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;inhibit_rules:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; source_match:
      severity: &amp;#39;critical&amp;#39;
      target_match:
        severity: &amp;#39;warning&amp;#39;
      equal: [&amp;#39;alertname&amp;#39;, &amp;#39;dev&amp;#39;, &amp;#39;instance&amp;#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;在-prometheus-模块中定义报警规则&#34;&gt;在 prometheus 模块中定义报警规则&lt;/h3&gt;
&lt;p&gt;alertmanager_rules.yml 示例如下：（与 prometheus 同目录下）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;groups:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: alertmanager-rules
    rules:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; alert: InstanceDown         # 报警名称
      expr: up == 0               # 报警的判定条件，参考 prometheus 高级查询来设定
      for: 2m                     # 满足报警条件持续时间多久后，才会发送报警
      labels:
        team: node
      annotations:
        summary: &amp;#34;{{ $labels.instance }}: has been down.&amp;#34;
        description: &amp;#34;{{ $labels.instance }}: job {{ $labels.job }} has been down.&amp;#34;
        value: {{ $value }}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;报警信息生命周期的三种状态&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;inactive：表示当前报警信息既不是 firing 状态，也不是 pending 状态&lt;/li&gt;
&lt;li&gt;pending：表示在设置的阈值时间范围内被激活的&lt;/li&gt;
&lt;li&gt;firing：表示超过设置的阈值时间被激活的&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在 alertmanager 的配置地址，即可查看所监控到的报警信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://localhost:9093/#/alerts
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;测试 alertmanager.yml 文件格式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./amtool check-config alertmanager.yml
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重新加载 alertmanager 配置文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -X POST http://localhost:9093/-/reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重新加载钉钉配置文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://localhost:8060/reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;promtool-工具&#34;&gt;promtool 工具&lt;/h3&gt;
&lt;p&gt;promtool 工具可以用来检测 prometheus 相关的配置文件的格式是否正确&lt;/p&gt;
&lt;p&gt;1）安装方式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go get github.com/prometheus/prometheus/cmd/promtool
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）检测 rule 文件格式正确性&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;promtool check rules /etc/example.rules.yml
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）检测 prometheus.yml 文件格式正确性&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;promtool check prometheus.yml
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;增加新的-alertmanager-报警方式&#34;&gt;增加新的 AlertManager 报警方式&lt;/h3&gt;
&lt;p&gt;1、在 &lt;code&gt;alertmanager/config/config.go&lt;/code&gt; 文件中的结构体 &lt;code&gt;GlobalConfig&lt;/code&gt; 中增加新的配置，此结构体对应于 alertmanager.yaml 中的全局配置；在结构体 &lt;code&gt;Receiver&lt;/code&gt; 中增加具体报警接收者的配置，对应于 alertmanager.yaml 中的 receiver 部分的配置；在 &lt;code&gt;func (c *Config) UnmarshalYAML(unmarshal func(interface{}) error) error&lt;/code&gt; 接口中为 Global 部分的配置赋予默认值。&lt;/p&gt;
&lt;p&gt;2、在 &lt;code&gt;alertmanager/notify&lt;/code&gt; 目录下创建目录 &lt;code&gt;telephone&lt;/code&gt;，可参照其他的报警通道，实现 &lt;code&gt;func New(c *config.TelephoneConfig, l log.Logger) (*Notifier, error)&lt;/code&gt;函数和 &lt;code&gt;func (n *Notifier) Notify(ctx context.Context, as ...*types.Alert) (bool, error)&lt;/code&gt;接口，完成业务代码的开发，&lt;/p&gt;
&lt;p&gt;3、在 &lt;code&gt;alertmanager/config/notifiers.go&lt;/code&gt; 文件中增加结构体 &lt;code&gt;TelephoneConfig&lt;/code&gt;，存储发送报警消息时的通用配置，实现其 &lt;code&gt;func (t *TelephoneConfig) UnmarshalYAML(unmarshal func(interface{}) error) error&lt;/code&gt; 接口；在此文件最上方，定义默认的 &lt;code&gt;DefaultTelephoneConfig&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;4、在 &lt;code&gt;alertmanager/cmd/alertmanager/main.go&lt;/code&gt; 文件的 &lt;code&gt;func buildReceiverIntegrations(nc *config.Receiver, tmpl *template.Template, logger log.Logger) ([]notify.Integration, error)&lt;/code&gt; 方法中，注册我们新编写的报警通知方式。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;for i, c := range nc.TelephoneConfigs {
		add(&amp;#34;telephone&amp;#34;, i, c, func(l log.Logger) (notify.Notifier, error) { return telephone.New(c, l) })
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、在 &lt;code&gt;alertmanager/notify/notify.go&lt;/code&gt; 文件中的 &lt;code&gt;func newMetrics(r prometheus.Registerer) *metrics&lt;/code&gt; 函数中注册其指标信息。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/alertmanager/">AlertManager</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/prometheus/">Prometheus</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>HAProxy 及其配置详解</title>
                <link>https://xdhuxc.github.io/posts/mixed/haproxy/haproxy-introduction-and-configuration/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/haproxy/haproxy-introduction-and-configuration/</guid>
                <pubDate>Tue, 14 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍了 HAProxy 及其配置的详细含义。&lt;/p&gt;
&lt;h3 id=&#34;haproxy&#34;&gt;HAProxy&lt;/h3&gt;
&lt;p&gt;HAProxy 提供高可用性、负载均衡以及基于 TCP 和 HTTP 应用的代理，支持虚拟主机，是免费、快速并且可靠的一种解决方案。HAProxy特别适用于那些负载特大的 web 站点，这些站点通常又需要会话保持或七层处理。HAProxy 运行在当前的硬件上，完全可以支持数以万计的并发连接，并且它的运行模式使得它可以很简单、安全地整合进当前的架构中，同时可以保护 web 服务器不被暴露在网络上。&lt;/p&gt;
&lt;h3 id=&#34;haproxy-配置&#34;&gt;HAProxy 配置&lt;/h3&gt;
&lt;h4 id=&#34;配置部分&#34;&gt;配置部分&lt;/h4&gt;
&lt;p&gt;HAProxy 配置中分成五部分内容，分别如下：&lt;/p&gt;
&lt;p&gt;1、global：参数是进程级的，通常是和操作系统相关，这些参数一般只配置一次，如果配置无误，就不需要再次进行修改。&lt;/p&gt;
&lt;p&gt;2、defaults：配置默认参数，这些参数可以被用到 frontend、backend、Listen 组件。&lt;/p&gt;
&lt;p&gt;3、frontend：接收请求的前端虚拟节点，Frontend 可以更加规则直接指定具体使用后端的 backend。&lt;/p&gt;
&lt;p&gt;4、backend：后端服务集群的配置，是真实服务器，一个 Backend 对应于一个或者多个实体服务器。&lt;/p&gt;
&lt;p&gt;5、Listen：Frontend 和 backend 的组合体。&lt;/p&gt;
&lt;h4 id=&#34;haproxycfg&#34;&gt;haproxy.cfg&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gu&#34;&gt;### 全局配置信息 ###
&lt;/span&gt;&lt;span class=&#34;gu&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 参数是进程级的，通常和操作系统有关
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;global 
  maxconn 20480         # 默认最大连接数。
  log 127.0.0.1 local3  # 定义 haproxy 日志级别，可以为：err、warning、info、debug。
  chroot /var/haproxy   # chroot运行的路径。
  uid 99                # 运行haproxy进程的用户ID。
  gid 99                # 运行haproxy进程的用户组ID。
  daemon                # 以守护进程方式运行haproxy。
  nbproc 1              # 进程数量，可以设置为多个进程以提高性能。
  pidfile /var/run/haproxy.pid # haproxy进程的pid存放路径，启动进程的用户必须有权限访问此文件。
  ulimit -n 65535       # ulimit 的数量限制
&lt;span class=&#34;gu&#34;&gt;### 默认配置选项 ###
&lt;/span&gt;&lt;span class=&#34;gu&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 参数可以被配置到frontend、backend和listen组件。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;defaults
  log global
  mode http             # 所处理的类别，七层http，四层tcp。
  maxconn 20480         # 最大连接数。
  option httplog        # 日志类别，HTTP日志格式。
  option httpclose      # 每次请求完毕后主动关闭 http 通道。
  option dontlognull    # 不记录健康检查的日志信息。
  option forwardfor     # 如果后端服务器需要获得客户端的真实IP需要配置的参数，可以从 Http Header 中获取客户端IP。
  option redispatch     # serverId 对应的服务器挂掉后，强制定向到其他健康的服务器。
  option abortonclose   # 当服务器负载很高的时候，自动结束掉当前队列处理比较久的连接。
  stats refresh 30      # 统计页面刷新间隔。
  retries 3             # 3 次连接失败就认为服务不可用，也可以通过 “后面” 设置。
  balance roundrobin    # 设置默认的负载均衡方式，轮询方式。
  # balance source      # 设置默认的负载均衡方式，类似于 nginx 的 IP_Hash。
  # balance leastconn   # 设置默认的负载均衡方式，最小连接方式。
  contimeout 5000       # 连接超时时间。
  clitimeout 50000      # 客户端连接超时时间。
  srvtimeout 50000      # 服务器超时时间。
  timeout check 2000    # 心跳检测超时。
  
&lt;span class=&#34;gu&#34;&gt;### 监控页面设置 ###
&lt;/span&gt;&lt;span class=&#34;gu&#34;&gt;&lt;/span&gt;listen admin_status     # Fronted 和 Backend 的组合体，监控组的名称，按需求自定义名称。
  bind 0.0.0.0:65535    # 监听端口。
  mode http             &lt;span class=&#34;ni&#34;&gt;#http&lt;/span&gt; 的七层模式。
  log 127.0.0.1 local3 err # 错误日志记录。
  stats refresh 5s      # 每隔5秒自动刷新监控页面。
  stats uri /admin?stats # 监控页面的url。
  stats realm xdhuxc\ xdhuxc # 监控页面显示信息。
  stats auth admin:admin     # 监控页面的用户名和密码，可以设置多个用户名。
  stats auth xdhuxc:xdhuxc   # 监控页面的用户名和密码xdhuxc/xdhuxc。
  stats hide-version         # 隐藏统计页面上的HAproxy版本信息。
  stats admin if TRUE        # 手工启用/禁用后端服务器（HAproxy-1.4.9以后版本）。
  
  errorfile 403 /etc/haproxy/errorfiles/403.http
  errorfile 500 /etc/haproxy/errorfiles/500.http
  errorfile 502 /etc/haproxy/errorfiles/502.http
  errorfile 503 /etc/haproxy/errorfiles/503.http
  errorfile 504 /etc/haproxy/errorfiles/504.http
  
  ### HAProxy 的日志记录内容设置
  capture request header Host len 40
  capture request header Content-Length len 10
  capture request header Referer len 200
  capture response header Server len 40
  capture response header Content-Length len 10
  capture response header Cache-Control len 8
  
  ### 网站监测 listen 配置
  ### 主要是监控 haproxy 后端服务器的监控状态
listen site_status
  bind 0.0.0.0:9090         # 监听端口
  mode http                 # http 的七层模式
  log 127.0.0.1 local3 err  # 日志级别
  monitor-uri /site_status  # 网站健康检查URL，用来检测HAproxy管理的网站是否可用，正常返回200，不正常返回503。
  acl site_dead nbsrv(server_web) lt 2 # 定义网站down时的策略，当挂在负载均衡上的指定backend中有效机器数小于1台时返回true。
  acl site_dead nbsrv(server_blog) lt 2
  acl site_dead nbsrv(server_bbs) lt 2
  monitor fail if site_dead  # 当满足策略的时候，返回503。
  monitor-net 192.168.16.2/32 # 来自192.168.16.2的日志信息不会被记录和转发
  monitor-net 129.168.16.3/32
  
  ### frontend 配置
  ### frontend配置里可定义多个acl进行匹配操作
frontend http_web_in
  bind 0.0.0.0:80  # 监听端口，即haproxy提供web服务的端口，和lvs的VIP端口类似。
  mode http        # http 的七层模式。
  log global       # 应用全局的日志配置。
  option httplog   # 启用http的log。
  option httpclose # 每次请求完毕后主动关闭http通道，HAProxy不支持keep-alive模式。
  option forwardfor # 如果后端服务器需要获得客户端的真实IP地址，需要配置此参数，将可以从Http header 中获得客户端IP。
  
  ### acl策略配置
  acl is_a hdr_beg(host) -i www.xdhuxc.org   # 判断域名是不是 www.xdhuxc.org，是则给予 a 服务器集群服务。
  acl is_b hdr_beg(host) -i www.xdhuxc.ocg # 判断域名是不是 www.xdhuxc.ocg，是则给予 b 服务器集群服务。
  
  use_backend a_server if is_a
  use_backend b_server if is_b
  
backend a_server
    mode http
    stats uri /haproxy
    balance roundrobin
    cookie JSESSIONID prefix
    stats hide-version
    option httpclose
    server web1 192.168.91.128:80 check
    server web2 192.168.91.129:80 check
    
backend b_server
    mode http
    stats uri /haproxy
    balance roundrobin
    cookie JSESSIONID
    stats hide-version
    option httpclose
    server web1 192.168.91.130 check
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.51cto.com/itnihao/915537&#34;&gt;http://blog.51cto.com/itnihao/915537&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/haproxy/">HAProxy</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 Hugo 和 GitHub 搭建个人网站（二）</title>
                <link>https://xdhuxc.github.io/posts/mixed/github_hugo_2/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/github_hugo_2/</guid>
                <pubDate>Tue, 14 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍了使用 Hugo 和 GitHub搭建个人网站的一些高级功能，包括在云端存储图片、评论功能、网站统计、阅读数量统计、文字统计和阅读时长预估等功能。&lt;/p&gt;
&lt;h3 id=&#34;图片存储&#34;&gt;图片存储&lt;/h3&gt;
&lt;p&gt;随着我们撰写的博客篇数的增多，博客中的图片也可能会相应的增加。本地存储图片对我们而言，不仅占用本地磁盘存储空间，而且还可能因磁盘损坏而丢失。此时，我们可以选择使用云端存储来保存我们博客中使用的图片，将图片上传到云服务商提供的云端存储后，在我们的 markdown 文档中，只需要引入其外部链接即可显示图片。&lt;/p&gt;
&lt;p&gt;使用 &lt;a href=&#34;https://portal.qiniu.com/signup?code=3lcz1eyk5rq6q&#34;&gt;七牛云&lt;/a&gt; 的对象存储来存放我们的图片，然后将图片的外部链接写在 markdown 文档之中，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;center&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;img&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/image/point.png&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;width&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;800px&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;height&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;300px&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
图 1 · 输入中 &lt;span class=&#34;sb&#34;&gt;`·`&lt;/span&gt; 号 （图注）
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;center&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;需要注册 &lt;a href=&#34;https://portal.qiniu.com/signup?code=3lcz1eyk5rq6q&#34;&gt;七牛云&lt;/a&gt; 账户，并使用身份证信息实名认证。&lt;/p&gt;
&lt;p&gt;为什么使用 &lt;a href=&#34;https://portal.qiniu.com/signup?code=3lcz1eyk5rq6q&#34;&gt;七牛云&lt;/a&gt;的对象存储呢？因为其免费提供 10G 存储空间，足够我们使用了。&lt;/p&gt;
&lt;h3 id=&#34;添加评论功能&#34;&gt;添加评论功能&lt;/h3&gt;
&lt;h4 id=&#34;基于-disqus-实现评论功能&#34;&gt;基于 Disqus 实现评论功能&lt;/h4&gt;
&lt;p&gt;Hugo 默认支持 &lt;a href=&#34;https://disqus.com/&#34;&gt;Disqus&lt;/a&gt; 的评论，并且已经在模板中添加好了，需要我们去 Disqus 注册一个账号，然后进行配置&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;config.toml&lt;/code&gt; 中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;disqusShortname = &amp;#34;yourdisqusShortname&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;yourdisqusShortname 就是 disqus 个人主页下的 Account 部分的 Username 的值。&lt;/p&gt;
&lt;p&gt;但是在本地无法测试该功能，需要上线到 github 进行测试。&lt;/p&gt;
&lt;p&gt;遗憾的是，Disqus 最近似乎出问题了，该功能实际不可用。&lt;/p&gt;
&lt;h4 id=&#34;基于-valine-实现评论功能&#34;&gt;基于 Valine 实现评论功能&lt;/h4&gt;
&lt;p&gt;有关 Valine 的详细信息，参考 &lt;a href=&#34;https://valine.js.org/&#34;&gt;Valine 官方网站&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://valine.js.org/&#34;&gt;Valine&lt;/a&gt; 评论系统依赖于 &lt;a href=&#34;https://leancloud.cn/&#34;&gt;Leancloud&lt;/a&gt;，需要先在 &lt;a href=&#34;https://leancloud.cn/&#34;&gt;Leancloud&lt;/a&gt; 中进行相关的准备工作。&lt;/p&gt;
&lt;p&gt;① 创建 &lt;code&gt;开发版应用&lt;/code&gt; HugoComment，点击该应用，点击左侧菜单 &lt;code&gt;设置&lt;/code&gt;，点击 &lt;code&gt;应用 Key&lt;/code&gt;，可以看到 &lt;code&gt;App ID&lt;/code&gt; 和 &lt;code&gt;App Key&lt;/code&gt;，后面需要用到 &lt;code&gt;App ID&lt;/code&gt; 和 &lt;code&gt;App Key&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;② 创建存储 Class comment，用于储存评论内容。&lt;/p&gt;
&lt;p&gt;③ 在 &lt;code&gt;设置&lt;/code&gt; 的 &lt;code&gt;安全中心&lt;/code&gt; 里，将自己网站的域名保存到 Web 安全域名中。&lt;/p&gt;
&lt;p&gt;此处假定一个互联网用户可以无障碍地完成上述准备工作。&lt;/p&gt;
&lt;p&gt;1、在 &lt;code&gt;config.toml&lt;/code&gt; 中添加配置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[params]
  [params.valine]
    # 控制开启此评论系统
    enable = true
    # LeanCloud 的 AppID
    appId = &amp;#39;the AppID of LeanCloud&amp;#39;
    # LeanCloud 的 AppKey
    appKey = &amp;#39;the AppKey of LeanCloud&amp;#39;
    # 用于控制是否开启邮件通知功能
    notify = false
    # 用于控制是否开启评论验证码功能
    verify = false
    # 用于配置评论项中用户头像样式，有多种选择：mm, identicon, monsterid, wavatar, retro, hide
    avatar = &amp;#39;identicon&amp;#39;
    # 评论框的提示符
    placeholder = &amp;#39;说点什么吧...&amp;#39;
    # 控制是否开启文章阅读数的统计功能
    visitor = true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、创建 &lt;code&gt;layouts/partials/comment.html&lt;/code&gt; 文件，加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{{ if .Site.Params.valine.enable }}
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;{{ .Permalink | relURL }}&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;leancloud_visitors&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;data-flag-title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;{{ .Title }}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;post-meta-item-text&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;文章阅读量 &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;leancloud-visitors-count&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;vcomments&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;//cdn1.lncld.net/static/js/3.0.4/av-min.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;//unpkg.com/valine/dist/Valine.min.js&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;text/javascript&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Valine&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;el&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;#vcomments&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;appId&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ .Site.Params.valine.appId }}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;appKey&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ .Site.Params.valine.appKey }}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;notify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ .Site.Params.valine.notify }}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;verify&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ .Site.Params.valine.verify }}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;avatar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ .Site.Params.valine.avatar }}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;placeholder&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ .Site.Params.valine.placeholder }}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;visitor&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{{ .Site.Params.valine.visitor }}&amp;#39;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
{{ end }}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，不要把 &lt;code&gt;if&lt;/code&gt; 改成 &lt;code&gt;with&lt;/code&gt;，否则会出现解析不了模板的问题。&lt;/p&gt;
&lt;p&gt;3、在 &lt;code&gt;layouts/post/single.html&lt;/code&gt; 文件中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;content&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;c&#34;&gt;&amp;lt;!--
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;  {{ partial &amp;#34;disqus.html&amp;#34; . }}
&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;  --&amp;gt;&lt;/span&gt;
  {{ partial &amp;#34;comment.html&amp;#34; . }}
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、评论功能效果如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/comment_result.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图 1 · 评论功能效果
&lt;/center&gt;
&lt;p&gt;5、可以在 &lt;a href=&#34;https://leancloud.cn/&#34;&gt;Leancloud&lt;/a&gt; 的 &lt;code&gt;HugoComment&lt;/code&gt; 中的存储 &lt;code&gt;Comment&lt;/code&gt; 中看到提交的评论信息。&lt;/p&gt;
&lt;h3 id=&#34;添加网站统计功能&#34;&gt;添加网站统计功能&lt;/h3&gt;
&lt;p&gt;我们可以使用 google 统计或者百度统计来统计我们网站相关的数据，比如浏览量、访客数、平均访问时长等。&lt;/p&gt;
&lt;h4 id=&#34;google-analytics&#34;&gt;Google Analytics&lt;/h4&gt;
&lt;p&gt;使用 Google 的网站分析功能，登录 &lt;a href=&#34;https://marketingplatform.google.com/about/&#34;&gt;Google Analytics&lt;/a&gt;，注册账号，获取 Track ID，填写到 config.toml 中 &lt;code&gt;[params]&lt;/code&gt; 下 &lt;code&gt;googleAnalytics&lt;/code&gt; 的值处。&lt;/p&gt;
&lt;p&gt;Hugo 默认支持 Google Analytics，但是 Google Analytics 有些复杂，后续再研究其使用方法。&lt;/p&gt;
&lt;h4 id=&#34;百度统计&#34;&gt;百度统计&lt;/h4&gt;
&lt;p&gt;使用百度统计来做网站分析，一则使用方法相对简单，数据可以满足我们的需求，二则不需要考虑翻墙。&lt;/p&gt;
&lt;p&gt;1、注册 &lt;a href=&#34;https://tongji.baidu.com/web/welcome/login&#34;&gt;百度统计&lt;/a&gt; 账号，在 &lt;code&gt;管理&lt;/code&gt;，&lt;code&gt;代码管理&lt;/code&gt;，&lt;code&gt;代码获取&lt;/code&gt; 下获取到如下代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hmt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hmt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;createElement&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;script&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;hm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;src&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://hm.baidu.com/hm.js?ad57771d1b8d25cbd18d12f67bc32135&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
  &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;script&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; 
  &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;parentNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;insertBefore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;})();&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，该代码中包含特殊的字符串 &lt;code&gt;ad57771d1b8d25cbd18d12f67bc32135&lt;/code&gt;，仅供本网站使用，其他网站使用无效。&lt;/p&gt;
&lt;p&gt;2、在 &lt;code&gt;config.toml&lt;/code&gt; 文件中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[params]
  [params.baidu]
    enable = true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、在 &lt;code&gt;layouts/partials/&lt;/code&gt; 目录下创建 &lt;code&gt;baidu_analytics.html&lt;/code&gt; 文件，内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{{ if .Site.Params.baidu.enable }}
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hmt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hmt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hm&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;createElement&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;script&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;hm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;src&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://hm.baidu.com/hm.js?ad57771d1b8d25cbd18d12f67bc32135&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;script&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;parentNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;insertBefore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;})();&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
{{ end }}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、在 &lt;code&gt;layouts/partials/footer.html&lt;/code&gt; 中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{{ if not .Site.IsServer  }}
    {{ partial &amp;#34;baidu_analytics.html&amp;#34; . }}
{{ end }}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，为了避免在本地开发时，错误提交和统计，加入了过滤条件。&lt;/p&gt;
&lt;p&gt;5、百度统计效果图&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/baidu_analytics_result.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图 2 · 百度统计效果图
&lt;/center&gt;
&lt;h3 id=&#34;添加阅读数量和-pvuv-统计功能&#34;&gt;添加阅读数量和 PV，UV 统计功能&lt;/h3&gt;
&lt;p&gt;统计访问网站的 &lt;code&gt;PV&lt;/code&gt; 和 &lt;code&gt;UV&lt;/code&gt; 及每篇博客的阅读数也是一件重要的事情，可以直接在页面上看到我们网站的 &lt;code&gt;PV&lt;/code&gt; 和 &lt;code&gt;UV&lt;/code&gt;及每篇文章的阅读数，我们使用 &lt;a href=&#34;http://ibruce.info/2015/04/04/busuanzi/&#34;&gt;不蒜子&lt;/a&gt; 来实现。&lt;/p&gt;
&lt;p&gt;使用 &lt;a href=&#34;http://ibruce.info/2015/04/04/busuanzi/&#34;&gt;不蒜子&lt;/a&gt; 时，首先需要引用 &lt;a href=&#34;http://ibruce.info/2015/04/04/busuanzi/&#34;&gt;不蒜子&lt;/a&gt; 的 &lt;code&gt;JavaScript&lt;/code&gt; 探针脚本。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;layouts/partials/head.html&lt;/code&gt; 中的 &lt;code&gt;head&lt;/code&gt; 标签中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- Reading Statistics --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;async&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后需要在 &lt;code&gt;HTML&lt;/code&gt; 代码中加入显示内容的代码。&lt;/p&gt;
&lt;h4 id=&#34;pvuv-统计&#34;&gt;PV，UV 统计&lt;/h4&gt;
&lt;p&gt;我们将 PV 和 UV 放置在 &lt;code&gt;版权申明&lt;/code&gt; 部分，在 &lt;code&gt;layouts/partials/copyright.html&lt;/code&gt; 中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;small-print&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;small&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;busuanzi_container_site_pv&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;display:none&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 访问量 &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;busuanzi_value_site_pv&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 次&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;small&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;br&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;small&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;busuanzi_container_site_uv&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;display:none&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 访客数 &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;busuanzi_value_site_uv&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 人次 &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;small&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;    
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，要确保 &lt;code&gt;id&lt;/code&gt; 是正确的，才能正常计数。&lt;/p&gt;
&lt;p&gt;另外，本地测试时，显示的 &lt;code&gt;PV&lt;/code&gt; 和 &lt;code&gt;UV&lt;/code&gt; 数据非常惊人。加入官方网站提供的 QQ 群后提问该问题，答案是：由于网络上大量用户使用 &lt;a href=&#34;http://ibruce.info/2015/04/04/busuanzi/&#34;&gt;不蒜子&lt;/a&gt;，本地主机都是 &lt;code&gt;localhost&lt;/code&gt; 和 &lt;code&gt;127.0.0.1&lt;/code&gt;，本地 JavaScript 可能是以 当前机器 IP 地址或主机名为键，获取 &lt;code&gt;PV&lt;/code&gt; 和 &lt;code&gt;UV&lt;/code&gt; 并上传到云端的，也就说，此时的 &lt;code&gt;PV&lt;/code&gt; 和 &lt;code&gt;UV&lt;/code&gt; 是使用不蒜子的所有 &lt;code&gt;localhost&lt;/code&gt; 的总数。&lt;/p&gt;
&lt;p&gt;但是不必担心，当网站上传到 GitHub 上之后，统计数据就正常了。&lt;/p&gt;
&lt;h4 id=&#34;阅读数量统计&#34;&gt;阅读数量统计&lt;/h4&gt;
&lt;p&gt;我们将阅读数量的统计显示在博客详情页面中大标题的下方。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;layouts/post/single.html&lt;/code&gt; 中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;header&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ .Title }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ .Description }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;font&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;font-family: &amp;#39;STKaiti&amp;#39;;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;busuanzi_container_page_pv&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 阅读量 &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;busuanzi_value_page_pv&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 次&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;font&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，要确保 &lt;code&gt;id&lt;/code&gt; 是正确的。&lt;/p&gt;
&lt;h3 id=&#34;博客字数和阅读时长统计&#34;&gt;博客字数和阅读时长统计&lt;/h3&gt;
&lt;p&gt;Hugo 内置了博客字数统计和阅读时长统计功能，我们将其添加到博客详情页即可。&lt;/p&gt;
&lt;p&gt;1、在 config.toml 中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;hasCJKLanguage = true # 设置为 true，则会在内容中自动检测中文/日文/韩文语言，这将使得 .Summary 和 .WordCount 在 CJK 语言中正常工作。

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在 &lt;code&gt;layouts/post/single.html&lt;/code&gt; 中加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;header&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ .Title }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ .Description }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;font&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;style&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;font-family: &amp;#39;STKaiti&amp;#39;;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;创建于 {{ .Date.Format &amp;#34;2006-01-02&amp;#34; }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; |
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;修改于 {{ .Lastmod.Format &amp;#34;2006-01-02&amp;#34; }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; |
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;总字数 {{ .WordCount }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; |
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;预估阅读时长 {{ .ReadingTime }} 分钟&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; |
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;font&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;div&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;.Date：数据取自博客顶端的配置 &lt;code&gt;date&lt;/code&gt; 字段的值，使用 &lt;code&gt;2006-01-02&lt;/code&gt; 格式进行格式化。&lt;/li&gt;
&lt;li&gt;.Lastmod：如果在博客顶端的配置中设置 &lt;code&gt;lastmod&lt;/code&gt; 字段，则数据取自 &lt;code&gt;lastmod&lt;/code&gt; 字段的值，使用 &lt;code&gt;2006-01-02&lt;/code&gt; 格式进行格式化。&lt;/li&gt;
&lt;li&gt;.WordCount：文章中的字数。&lt;/li&gt;
&lt;li&gt;.ReadingTime：预估的阅读时长，以分钟为单位。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;3、博客字数和阅读时长统计显示效果如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/word_count.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图 3 · 博客字数和阅读时长统计显示效果
&lt;/center&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://ibruce.info/2015/04/04/busuanzi/&#34;&gt;http://ibruce.info/2015/04/04/busuanzi/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://valine.js.org/quickstart.html&#34;&gt;https://valine.js.org/quickstart.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.smslit.top/2018/07/08/hugo-valine/&#34;&gt;https://www.smslit.top/2018/07/08/hugo-valine/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.yangcs.net/posts/hugo-add-busuanzi/&#34;&gt;https://www.yangcs.net/posts/hugo-add-busuanzi/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/xr469786706/article/details/78166227&#34;&gt;https://blog.csdn.net/xr469786706/article/details/78166227&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://note.qidong.name/2017/06/24/hugo-word-count/&#34;&gt;http://note.qidong.name/2017/06/24/hugo-word-count/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gohugo.io/content-management/front-matter/&#34;&gt;https://gohugo.io/content-management/front-matter/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/heartnn/hugo-theme-test&#34;&gt;https://github.com/heartnn/hugo-theme-test&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gohugo.io/getting-started/configuration/&#34;&gt;https://gohugo.io/getting-started/configuration/&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/github/">GitHub</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/hugo/">Hugo</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Markdown 写作时输入小技巧</title>
                <link>https://xdhuxc.github.io/posts/mixed/little_tips/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/little_tips/</guid>
                <pubDate>Tue, 14 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;摘要：&lt;/p&gt;
&lt;p&gt;　　本篇博客主要介绍一些电子写作中常用的操作小技巧，或许会在日常写作或者撰写文档时用到。&lt;/p&gt;
&lt;h3 id=&#34;在-markdown-中首段缩进两个汉字&#34;&gt;在 markdown 中首段缩进两个汉字&lt;/h3&gt;
&lt;p&gt;　　由于 markdown 标记语言是外国人发明的，英文写作首段不空字符，而我们使用 &lt;code&gt;markdown&lt;/code&gt; 标记语言进行中文写作时，一般首段都要缩进两个汉字。于是，我们就有了这样一个需求，在使用 &lt;code&gt;markdown&lt;/code&gt; 进行中文写作时，在首段缩进两个汉字的长度，但是由于 markdown 本身的特性，直接按空格键是不行的，需要采用特殊的方式才能实现。&lt;/p&gt;
&lt;p&gt;以下我们介绍两种方法&lt;/p&gt;
&lt;p&gt;1、使用 &lt;code&gt;&amp;amp;nbsp;&lt;/code&gt; 来实现，由于 markdown 最终是被转换成 HTML 来显示的，而且其本身也兼容 HTML，所以我们可以使用 HTML 中的 &lt;code&gt;&amp;amp;nbsp;&lt;/code&gt; 来实现缩进效果，大体上来看，8 个 &lt;code&gt;&amp;amp;nbsp;&lt;/code&gt; 可以实现两个汉字缩进的效果，如下所示：&lt;/p&gt;
&lt;p&gt;        乾坤（&lt;code&gt;乾坤&lt;/code&gt; 前面有 8 个 &lt;code&gt;&amp;amp;nbsp;&lt;/code&gt;）&lt;/p&gt;
&lt;p&gt;天人合一（已经左端对齐）&lt;/p&gt;
&lt;p&gt;这种方法比较麻烦，每段开头都要有　8 个 &lt;code&gt;&amp;amp;nbsp;&lt;/code&gt;，但是显示效果有保证。&lt;/p&gt;
&lt;p&gt;2、将输入法切换为　&lt;code&gt;全角&lt;/code&gt;，然后使用空格键，按两次空格键，可以直接实现两个汉字的缩进效果，注意不要使用　Tab 键进行操作，可自行测试观察效果。这种方法比第一种方法简洁方便，但是有时效果不太理想。&lt;/p&gt;
&lt;h3 id=&#34;在句子中插入中--号&#34;&gt;在句子中插入中 &lt;code&gt;·&lt;/code&gt; 号&lt;/h3&gt;
&lt;p&gt;　　在文档中书写外国人名或者书名时，经常会用到中 &lt;code&gt;·&lt;/code&gt; 号，但是键盘上 &lt;code&gt;1&lt;/code&gt; 前面的中 &lt;code&gt;·&lt;/code&gt; 需要使用快捷键配合打出，有时可能无法使用。这时，我们可以在中文输入法下，输入 &lt;code&gt;dian&lt;/code&gt;，如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/point.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图 1 · 输入中 `·` 号
&lt;/center&gt;
&lt;p&gt;然后选择中 &lt;code&gt;·&lt;/code&gt; 前的数字序号 5，就可以很方便地输入中&lt;code&gt;·&lt;/code&gt;号了。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/markdown/">Markdown</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用原生方式和基于 docker 容器方式部署 prometheus</title>
                <link>https://xdhuxc.github.io/posts/devops/prometheus/prometheus-native-docker-install/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/prometheus/prometheus-native-docker-install/</guid>
                <pubDate>Fri, 10 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客分别介绍了使用原生方式和基于 docker 容器方式部署 prometheus 的方法。&lt;/p&gt;
&lt;h3 id=&#34;原生方式部署&#34;&gt;原生方式部署&lt;/h3&gt;
&lt;h4 id=&#34;下载安装包&#34;&gt;下载安装包&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://github.com/prometheus/prometheus/releases/download/v2.5.0/prometheus-2.5.0.linux-amd64.tar.gz
wget https://github.com/prometheus/node_exporter/releases/download/v0.16.0/node_exporter-0.16.0.linux-amd64.tar.gz
wget https://github.com/prometheus/alertmanager/releases/download/v0.15.3/alertmanager-0.15.3.linux-amd64.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;启动服务&#34;&gt;启动服务&lt;/h4&gt;
&lt;p&gt;1、 启动 prometheus&lt;/p&gt;
&lt;p&gt;prometheus.yml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# my global config
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;global:
  scrape_interval:     15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.
  # scrape_timeout is set to the global default (10s).

&lt;span class=&#34;gh&#34;&gt;# Alertmanager configuration
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;alerting:
  alertmanagers:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets:
      &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; alertmanager:9093

&lt;span class=&#34;gh&#34;&gt;# Load rules once and periodically evaluate them according to the global &amp;#39;evaluation_interval&amp;#39;.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;rule_files:
  # - &amp;#34;first_rules.yml&amp;#34;
  # - &amp;#34;second_rules.yml&amp;#34;

&lt;span class=&#34;gh&#34;&gt;# A scrape configuration containing exactly one endpoint to scrape:
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# Here it&amp;#39;s Prometheus itself.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;scrape_configs:
  # The job name is added as a label &lt;span class=&#34;sb&#34;&gt;`job=&amp;lt;job_name&amp;gt;`&lt;/span&gt; to any timeseries scraped from this config.
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;prometheus&amp;#39;
    # metrics_path defaults to &amp;#39;/metrics&amp;#39;
    # scheme defaults to &amp;#39;http&amp;#39;.

    static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;192.168.33.10:9090&amp;#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 prometheus，默认会加载当前路径下的 prometheus.yaml 文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nohup ./prometheus &amp;gt;&amp;gt; prometheus.log &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后访问如下地址：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http:192.168.33.10:9090
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动 node_exporter&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ohup ./node_exporter &amp;gt;&amp;gt; node_exporter.log &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后访问如下地址：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://192.168.33.10:9100 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://192.168.33.10:9100/metrics
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 prometheus.yml 中加入如下配置，重启 prometheus&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;scrape_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;node_exporter&amp;#39;
    static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;192.168.33.10:9100&amp;#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、部署 grafana&lt;/p&gt;
&lt;p&gt;安装 grafana&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo yum install https://s3-us-west-2.amazonaws.com/grafana-releases/release/grafana-5.1.4-1.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 grafana 服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl start grafana-server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后访问如下地址：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://192.168.33.10:3000 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以 &lt;code&gt;admin/admin&lt;/code&gt; 登录进去&lt;/p&gt;
&lt;p&gt;然后添加数据源，将 prometheus 相关信息填写进去。&lt;/p&gt;
&lt;h4 id=&#34;容器方式部署&#34;&gt;容器方式部署&lt;/h4&gt;
&lt;p&gt;1、启动 prometheus 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d --restart=always --name=prometheus --network=host -v /data/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml prom/prometheus
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;为了便于和其他容器通信，使用 host 网络模式启动 prometheus 容器。&lt;/p&gt;
&lt;p&gt;2、启动 node_exporter 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d -p 9100:9100 prom/node-exporter
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将如下连接信息写入 prometheus.yml 中，重启 prometheus 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;scrape_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;node_exporter&amp;#39;
  static_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;192.168.33.10:9100&amp;#39;]
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job:
  static_configs:
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 grafana 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d --restart=always --name=grafana -p 3000:3000 grafana/grafana
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、启动 clickhouse 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 启动 clickhouse-server
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;docker run -d -p 8123:8123 -p 9000:9000 -p 9009:9009 --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、启动 clickhouse_exporter 容器，需要指定 clickhouse 的地址&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d -p 9116:9116 f1yegor/clickhouse-exporter -scrape_uri=http://192.168.33.10:8123/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、以 &lt;code&gt;admin/admin&lt;/code&gt; 登录进 grafana，导入 clickhouse 的 dashboard 文件，文件地址为：https://grafana.com/dashboards/882&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/prometheus/">Prometheus</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 Hugo 和 GitHub 搭建个人网站（一）</title>
                <link>https://xdhuxc.github.io/posts/mixed/github_hugo_1/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/github_hugo_1/</guid>
                <pubDate>Thu, 09 May 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;摘要：
　　本篇文章介绍了基于 GitHub 和 Hugo 搭建个人网站的具体操作过程，其中有诸多的注意事项，另外，对原有的模板和配置进行了一些改动，还附加了很多可以优化的地方。&lt;/p&gt;
&lt;h3 id=&#34;hugo-的安装的基本使用&#34;&gt;Hugo 的安装的基本使用&lt;/h3&gt;
&lt;p&gt;1、准备工作，创建工作目录 &lt;code&gt;blog&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:~ wanghuan$ mkdir blog
wanghuans-MacBook-Pro:blog wanghuan$ pwd
/Users/wanghuan/blog
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、安装 Hugo&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:blog wanghuan$ brew install hugo   # 安装 hugo
Updating Homebrew...
==&amp;gt; Auto-updated Homebrew!
Updated 1 tap (homebrew/core).
==&amp;gt; Updated Formulae
allure

==&amp;gt; Downloading https://homebrew.bintray.com/bottles/hugo-0.55.5.mojave.bottle.tar.gz
==&amp;gt; Downloading from https://akamai.bintray.com/2c/2c88f996c36157b5e451274663b867ad4e1c3f6f04c57d1d43cdd8c631a5b209?__gda__=exp=1557368278~hmac=afe54c6d07b0ae0a78089e030533b7dae7
&lt;span class=&#34;gu&#34;&gt;######################################################################## 100.0%
&lt;/span&gt;&lt;span class=&#34;gu&#34;&gt;&lt;/span&gt;==&amp;gt; Pouring hugo-0.55.5.mojave.bottle.tar.gz
==&amp;gt; Caveats
Bash completion has been installed to:
  /usr/local/etc/bash_completion.d
==&amp;gt; Summary
🍺  /usr/local/Cellar/hugo/0.55.5: 31 files, 40.7MB
==&amp;gt; &lt;span class=&#34;sb&#34;&gt;`brew cleanup`&lt;/span&gt; has not been run in 30 days, running now...
Removing: /Users/wanghuan/Library/Caches/Homebrew/dep--0.5.0.mojave.bottle.tar.gz... (3.2MB)
Removing: /Users/wanghuan/Library/Caches/Homebrew/gettext--0.19.8.1.high_sierra.bottle.tar.gz... (7.8MB)
Removing: /Users/wanghuan/Library/Caches/Homebrew/libunistring--0.9.10.mojave.bottle.tar.gz... (1.4MB)
Removing: /Users/wanghuan/Library/Caches/Homebrew/nginx--1.15.8.mojave.bottle.3.tar.gz... (1.2MB)
Removing: /Users/wanghuan/Library/Caches/Homebrew/openssl--1.0.2q.mojave.bottle.tar.gz... (3.7MB)
Removing: /Users/wanghuan/Library/Caches/Homebrew/pcre2--10.32.high_sierra.bottle.tar.gz... (1.8MB)
Removing: /Users/wanghuan/Library/Caches/Homebrew/telnet--60.mojave.bottle.tar.gz... (52.5KB)
Removing: /Users/wanghuan/Library/Caches/Homebrew/tree--1.8.0.high_sierra.bottle.tar.gz... (50.5KB)
Removing: /Users/wanghuan/Library/Caches/Homebrew/portable-ruby-2.3.7.leopard_64.bottle.tar.gz... (12.4MB)
Removing: /Users/wanghuan/Library/Logs/Homebrew/ucl... (64B)
Removing: /Users/wanghuan/Library/Logs/Homebrew/upx... (64B)
Removing: /Users/wanghuan/Library/Logs/Homebrew/nginx... (64B)
Removing: /Users/wanghuan/Library/Logs/Homebrew/pcre... (64B)
wanghuans-MacBook-Pro:Blog wanghuan$ hugo version   # 查看 hugo 的版本
Hugo Static Site Generator v0.55.5/extended darwin/amd64 BuildDate: unknown
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、创建网站&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:blog wanghuan$ hugo new site xdhuxc
Congratulations! Your new Hugo site is created in /Users/wanghuan/blog/xdhuxc.

Just a few more steps and you&amp;#39;re ready to go:

&lt;span class=&#34;k&#34;&gt;1.&lt;/span&gt; Download a theme into the same-named folder.
   Choose a theme from https://themes.gohugo.io/, or
   create your own with the &amp;#34;hugo new theme &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;THEMENAME&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34; command.
&lt;span class=&#34;k&#34;&gt;2.&lt;/span&gt; Perhaps you want to add some content. You can add single files
   with &amp;#34;hugo new &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;SECTIONNAME&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;/&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;FILENAME&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;FORMAT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;.
&lt;span class=&#34;k&#34;&gt;3.&lt;/span&gt; Start the built-in live server via &amp;#34;hugo server&amp;#34;.

Visit https://gohugo.io/ for quickstart guide and full documentation.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、安装主题&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:blog wanghuan$ cd xdhuxc/themes/
wanghuans-MacBook-Pro:themes wanghuan$ git clone https://github.com/yoshiharuyamashita/blackburn.git
Cloning into &amp;#39;blackburn&amp;#39;...
remote: Enumerating objects: 25, done.
remote: Counting objects: 100% (25/25), done.
remote: Compressing objects: 100% (14/14), done.
remote: Total 908 (delta 14), reused 17 (delta 11), pack-reused 883
Receiving objects: 100% (908/908), 469.15 KiB | 53.00 KiB/s, done.
Resolving deltas: 100% (563/563), done.
wanghuans-MacBook-Pro:xdhuxc wanghuan$ pwd
/Users/wanghuan/blog/xdhuxc
wanghuans-MacBook-Pro:xdhuxc wanghuan$ ls
archetypes	config.toml	content		data		layouts		static		themes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;目录及文件说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;archetypes：包括内容类型，在创建新内容时自动生成内容的配置。&lt;/li&gt;
&lt;li&gt;content：包括网站内容，全部使用 markdown 格式。&lt;/li&gt;
&lt;li&gt;layouts：包括了网站的模板，决定内容如何呈现。&lt;/li&gt;
&lt;li&gt;static：包括了 css，js，fonts，media 等，决定网站的外观。&lt;/li&gt;
&lt;li&gt;themes：保存下载的网站主题。&lt;/li&gt;
&lt;li&gt;config.toml：网站的配置文件，包括 baseurl，title，copyright 等网站参数。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在 &lt;code&gt;config.toml&lt;/code&gt; 中加入如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;baseurl = &amp;#34;https://xdhuxc.github.io/&amp;#34; # Make sure to end baseurl with a &amp;#39;/&amp;#39;
title = &amp;#34;xdhuxc&amp;#34;
author = &amp;#34;xdhuxc&amp;#34;
&lt;span class=&#34;gh&#34;&gt;# Shown in the side menu
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;copyright = &amp;#34;&lt;span class=&#34;ni&#34;&gt;&amp;amp;copy;&lt;/span&gt; 2019. xdhuxc All rights reserved.&amp;#34;
canonifyurls = true
paginate = 10

[indexes]
  tag = &amp;#34;tags&amp;#34;
  topic = &amp;#34;topics&amp;#34;

[params]
  # Shown in the home page
  subtitle = &amp;#34;技术 - 文章&amp;#34;
  brand = &amp;#34;xdhuxc&amp;#34;
  googleAnalytics = &amp;#34;Your Google Analytics tracking ID&amp;#34;
  disqus = &amp;#34;Your Disqus shortname&amp;#34;
  # CSS name for highlight.js
  highlightjs = &amp;#34;androidstudio&amp;#34;
  highlightjs_extra_languages = [&amp;#34;yaml&amp;#34;]
  dateFormat = &amp;#34;02 Jan 2006, 15:04&amp;#34;
  # Include any custom CSS and/or JS files
  # (relative to /static folder)
  # custom_css = [&amp;#34;css/my.css&amp;#34;]
  # custom_js = [&amp;#34;js/my.js&amp;#34;]

  [params.piwikAnalytics]
    siteid = 2
    piwikroot = &amp;#34;//analytics.example.com/&amp;#34;

[menu]
  # Shown in the side menu.
  [[menu.main]]
    name = &amp;#34;主页&amp;#34;
    pre = &amp;#34;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;fa fa-home fa-fw&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;
    weight = 1
    identifier = &amp;#34;home&amp;#34;
    url = &amp;#34;/&amp;#34;
  [[menu.main]]
    name = &amp;#34;博客&amp;#34;
    pre = &amp;#34;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;fa fa-list fa-fw&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;
    weight = 2
    identifier = &amp;#34;post&amp;#34;
    url = &amp;#34;/post/&amp;#34;
  [[menu.main]]
    name = &amp;#34;关于&amp;#34;
    pre = &amp;#34;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;fa fa-user fa-fw&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;
    weight = 3
    identifier = &amp;#34;about&amp;#34;
    url = &amp;#34;/about/&amp;#34;
  [[menu.main]]
    name = &amp;#34;联系作者&amp;#34;
    pre = &amp;#34;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;fa fa-phone fa-fw&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;
    weight = 4
    url = &amp;#34;/contact/&amp;#34;

[social]
  # Link your social networking accounts to the side menu
  # by entering your username or ID.
  # Techie
  github = &amp;#34;xdhuxc&amp;#34;
  gitlab = &amp;#34;*&amp;#34;
  bitbucket = &amp;#34;*&amp;#34;
  stackoverflow = &amp;#34;*&amp;#34;
  serverfault = &amp;#34;*&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;[social]&lt;/code&gt; 部分的键值将渲染到 &lt;code&gt;layouts/partials/social.html&lt;/code&gt; 文件中，和各种网站的域名组合起来，作为作者本人在各种网站中的主页的路径；在该文件中删除无用的网站信息，只保留作者自己有效地网站主页。&lt;/p&gt;
&lt;p&gt;将 &lt;code&gt;themes/blackburn&lt;/code&gt; 目录下的 &lt;code&gt;static&lt;/code&gt; 和 &lt;code&gt;layouts&lt;/code&gt; 目录中的内容复制到 &lt;code&gt;xdhuxc&lt;/code&gt; 目录下的同名目录中。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;content/post&lt;/code&gt; 目录中撰写 &lt;code&gt;markdown&lt;/code&gt; 格式的文档，在每个 &lt;code&gt;.md&lt;/code&gt; 文档的最上方加入类似如下内容，用于设置文章属性：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;+++
title = &amp;#34;Ansible 学习之常用模块&amp;#34;     # 文章标题。
linktitle = &amp;#34;Ansible 学习之常用模块&amp;#34;
date = &amp;#34;2018-05-02&amp;#34;                # 在菜单 &amp;#34;博客&amp;#34; 中，文章按时间顺序排列，会自动增加时间标签，页面上默认显示n篇最新的文章。
draft = false                      # 设置为 false 的时候会被编译为 HTML，设置为 true 则不会被编译和发表。
description = &amp;#34;&amp;#34;
tags = [                           
    &amp;#34;ansible&amp;#34;,
    &amp;#34;DevOps&amp;#34;,
    &amp;#34;IT&amp;#34;
]                                  # 文章的标签，可以设置多个，用逗号分隔开，Hugo 会自动在博客主页下生成标签的子 URL，通过这个 URL，可以看到所有具有该标签的文章。
categories = [
    &amp;#34;ansible&amp;#34;,
    &amp;#34;DevOps&amp;#34;,
]                                  # 文章分类。
+++
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;baseurl 的值在本地测试时无关紧要，但是当部署到 GitHub 上时，需要将其配置为 xdhuxc.github.io 这样的域名。另外，如果使用自有域名，还需要在 GitHub 上进行关联，具体方法可参考：https://help.github.com/en/articles/using-a-custom-domain-with-github-pages&lt;/p&gt;
&lt;p&gt;5、启动网站&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;hugo server --buildDrafts -w
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-w：监视文件内容的变化，如果此后修改了网站的内容，会直接显示在浏览器的页面上，不需要重新启动 hugo 进程，方便我们进行修改，但是不能监测 config.toml 文件中的参数变化。&lt;/li&gt;
&lt;li&gt;--buildDrafts：生成被标记为草稿的页面。&lt;/li&gt;
&lt;li&gt;-t hyde：使用 hyde 主题。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;使用-github-pages-托管网站&#34;&gt;使用 GitHub Pages 托管网站&lt;/h3&gt;
&lt;p&gt;1、在 GitHub 上创建代码仓库，托管 Hugo 的输入文件，将 blog 目录下的所有文件存储到该仓库中，在 &lt;code&gt;.gitignore&lt;/code&gt; 文件中写入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;.idea
.DS_Store
public/*
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在 GitHub 上创建代码仓库，用于托管 public 目录，此处仓库的名称一定要用自己的用户名，例如 xdhuxc.github.io，只有这样，才会被 GitHub 当做是个人主页。&lt;/p&gt;
&lt;p&gt;3、编译 blog 工程，生成 public 目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MBP:blog wanghuan$ pwd
/Users/wanghuan/WebstormProjects/blog
wanghuans-MBP:blog wanghuan$ ls
README.md       config.toml     data            layouts         resources       themes
archetypes      content         images          public          static
wanghuans-MBP:blog wanghuan$ hugo

                   | EN  
+------------------+----+
  Pages            | 40  
  Paginator pages  |  0  
  Non-page files   |  0  
  Static files     |  8  
  Processed images |  0  
  Aliases          |  1  
  Sitemaps         |  1  
  Cleaned          |  0  

Total in 98 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、将 &lt;code&gt;public&lt;/code&gt; 目录添加为子模块，与 &lt;code&gt;xdhuxc.github.io&lt;/code&gt; 同步&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MBP:blog wanghuan$ rm -rf public/
wanghuans-MBP:blog wanghuan$ git submodule add git@github.com:xdhuxc/xdhuxc.github.io.git public
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、编译并推送至仓库 xdhuxc.github.io&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MBP:blog wanghuan$ hugo

                   | EN  
+------------------+----+
  Pages            | 40  
  Paginator pages  |  0  
  Non-page files   |  0  
  Static files     |  8  
  Processed images |  0  
  Aliases          |  1  
  Sitemaps         |  1  
  Cleaned          |  0  

Total in 33 ms
wanghuans-MBP:blog wanghuan$ cd public/
wanghuans-MBP:public wanghuan$ ls
README.md       css             index.html      js              page            sitemap.xml     topics
contact         img             index.xml       media           post            tags
wanghuans-MBP:public wanghuan$ git add -A
wanghuans-MBP:public wanghuan$ git commit -m &amp;#34;initial the xdhuxc website&amp;#34;
[master a3a6a28] initial the xdhuxc website
 49 files changed, 9972 insertions(+)
 create mode 100644 contact/index.html
 create mode 100644 css/blackburn.css
 create mode 100644 css/side-menu-old-ie.css
 create mode 100644 css/side-menu.css
 create mode 100644 img/favicon.ico
 create mode 100644 index.html
 create mode 100644 index.xml
 create mode 100644 js/menus.js
 create mode 100644 js/ui.js
 create mode 100644 media/disqus.png
 create mode 100644 page/1/index.html
 create mode 100644 post/ansible-common-model/index.html
 create mode 100644 post/ansible-simple-use/index.html
 create mode 100644 post/centos7-install-mongodb/index.html
 create mode 100644 post/github_hugo/index.html
 create mode 100644 post/index.html
 create mode 100644 post/index.xml
 create mode 100644 post/linux-shell-execute/index.html
 create mode 100644 post/mongodb-simple-use/index.html
 create mode 100644 post/springboot-jmx/index.html
 create mode 100644 sitemap.xml
 create mode 100644 tags/ansible/index.html
 create mode 100644 tags/ansible/index.xml
 create mode 100644 tags/centos7/index.html
 create mode 100644 tags/centos7/index.xml
 create mode 100644 tags/database/index.html
 create mode 100644 tags/database/index.xml
 create mode 100644 tags/devops/index.html
 create mode 100644 tags/devops/index.xml
 create mode 100644 tags/github/index.html
 create mode 100644 tags/github/index.xml
 create mode 100644 tags/hugo/index.html
 create mode 100644 tags/hugo/index.xml
 create mode 100644 tags/index.html
 create mode 100644 tags/index.xml
 create mode 100644 tags/it/index.html
 create mode 100644 tags/it/index.xml
 create mode 100644 tags/jmx/index.html
 create mode 100644 tags/jmx/index.xml
 create mode 100644 tags/linux/index.html
 create mode 100644 tags/linux/index.xml
 create mode 100644 tags/mongodb/index.html
 create mode 100644 tags/mongodb/index.xml
 create mode 100644 tags/shell/index.html
 create mode 100644 tags/shell/index.xml
 create mode 100644 tags/springboot/index.html
 create mode 100644 tags/springboot/index.xml
 create mode 100644 topics/index.html
 create mode 100644 topics/index.xml
wanghuans-MBP:public wanghuan$ git push origin master
Enumerating objects: 81, done.
Counting objects: 100% (81/81), done.
Delta compression using up to 4 threads
Compressing objects: 100% (68/68), done.
Writing objects: 100% (80/80), 179.84 KiB | 396.00 KiB/s, done.
Total 80 (delta 34), reused 0 (delta 0)
remote: Resolving deltas: 100% (34/34), done.
To github.com:xdhuxc/xdhuxc.github.io.git
   07acdac..a3a6a28  master -&amp;gt; master
wanghuans-MBP:public wanghuan$ 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、此时，访问 &lt;code&gt;https://xdhuxc.github.io/&lt;/code&gt;，即可看到我们的网站。&lt;/p&gt;
&lt;h3 id=&#34;优化&#34;&gt;优化&lt;/h3&gt;
&lt;h4 id=&#34;菜单栏图标修改&#34;&gt;菜单栏图标修改&lt;/h4&gt;
&lt;p&gt;我们在左侧菜单部分去除了默认含有的 Twitter，Facebook等，新加了微信和简书，但是其使用的图标却不是图片，而是使用 CSS 渲染出来的。在 &lt;a href=&#34;https://fontawesome.com/&#34;&gt;https://fontawesome.com/&lt;/a&gt; 上搜索图标，找到微信的图标所对应的 CSS class，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;fab fa-weixin&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将其修改至 &lt;code&gt;layouts/partials/social.html&lt;/code&gt; 中如下部分：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{{ with .Site.Social.wechat }}
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;li&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pure-menu-item&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;pure-menu-link&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://github.com/{{ . }}&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;me&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;_blank&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;fa fa-weixin fa-fw&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;微信&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;li&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
{{ end }}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;该网站上没有简书的图标，可以随便找一个图标填充之。&lt;/p&gt;
&lt;h4 id=&#34;博客的时间格式优化&#34;&gt;博客的时间格式优化，&lt;/h4&gt;
&lt;p&gt;1、默认情况下，首页中博客的时间格式是这样的：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;25 Oct 2018, 00:00
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;包含英文，不易为国人识别，我们可以将其改造为常用的日期格式，修改 &lt;code&gt;layouts/partials/post_meta.html&lt;/code&gt; 文件中如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ with .Site.Params.dateFormat }}{{ $.Date.Format . }}{{ else }}{{ .Date.Format &amp;#34;02 Jan 2006, 15:04&amp;#34; }}{{ end }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;改为&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ with .Site.Params.dateFormat }}{{ $.Date.Format &amp;#34;2006-01-02&amp;#34; }}{{ else }}{{ .Date.Format &amp;#34;2006-01-02&amp;#34; }}{{ end }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果需要时分秒，可以改为如下格式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;{{ with .Site.Params.dateFormat }}{{ $.Date.Format &amp;#34;2006-01-02 15:04:05&amp;#34; }}{{ else }}{{ .Date.Format &amp;#34;2006-01-02 15:04:05&amp;#34; }}{{ end }}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、菜单 &lt;code&gt;博客&lt;/code&gt; 中的博客列表中的时间默认情况下的格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;25 Oct 2018, 00:00
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 config.toml 中将 &lt;code&gt;dateFormat&lt;/code&gt; 的值由 &lt;code&gt;02 Jan 2006, 15:04&lt;/code&gt; 修改为：&lt;code&gt;2006-01-02&lt;/code&gt;，则其日期显示就变为：&lt;code&gt;2019-05-09&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;3、如果想在 &lt;code&gt;博客&lt;/code&gt; 菜单中按照月份显示自己的博客列表，可以对 &lt;code&gt;layouts/post/post.html&lt;/code&gt; 进行修改，将&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{{ range .Data.Pages.GroupByDate &amp;#34;2006&amp;#34; }}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;改为&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{{ range .Data.Pages.GroupByDate &amp;#34;2006-01&amp;#34; }}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;自动化部署&#34;&gt;自动化部署&lt;/h4&gt;
&lt;p&gt;编写脚本 &lt;code&gt;deploy.sh&lt;/code&gt;（需要给脚本添加执行权限） 部署我们的网站，脚本内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;echo -e &amp;#34;\033[0;32mDeploying updates to GitHub...\033[0m&amp;#34;

&lt;span class=&#34;gh&#34;&gt;# Commit changes.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;msg=&amp;#34;change the website&amp;#39;s domain when it compiling&amp;#34;
if [[ &amp;#34;$#&amp;#34; -eq 1 ]]; then
    msg=&amp;#34;$1&amp;#34;
fi

&lt;span class=&#34;gh&#34;&gt;# Push Hugo content
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;git add -A
git commit -m &amp;#34;$msg&amp;#34;
git push origin master


&lt;span class=&#34;gh&#34;&gt;# Build the project.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;hugo # if using a theme, replace with &lt;span class=&#34;sb&#34;&gt;`hugo -t &amp;lt;YOURTHEME&amp;gt;`&lt;/span&gt;

&lt;span class=&#34;gh&#34;&gt;# Go To Public folder
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cd public
&lt;span class=&#34;gh&#34;&gt;# Add changes to git.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;git add .


git commit -m &amp;#34;$msg&amp;#34;

&lt;span class=&#34;gh&#34;&gt;# Push source and build repos.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;git push origin master

&lt;span class=&#34;gh&#34;&gt;# Come Back up to the Project Root
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cd ..
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;本地编写 markdown 文件完成后，执行 &lt;code&gt;./deploy.sh&lt;/code&gt; 脚本即可完成部署工作。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://nanshu.wang/post/2015-01-31/&#34;&gt;http://nanshu.wang/post/2015-01-31/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://jimmysong.io/posts/building-github-pages-with-hugo/&#34;&gt;https://jimmysong.io/posts/building-github-pages-with-hugo/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/e68fba58f75c&#34;&gt;https://www.jianshu.com/p/e68fba58f75c&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gohugo.io/hosting-and-deployment/hosting-on-github/&#34;&gt;https://gohugo.io/hosting-and-deployment/hosting-on-github/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gohugo.io/templates/internal/#google-analytics&#34;&gt;https://gohugo.io/templates/internal/#google-analytics&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.olowolo.com/post/hugo-quick-start/&#34;&gt;https://blog.olowolo.com/post/hugo-quick-start/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.pytool.com/language/golang/hugo/hugo/&#34;&gt;https://blog.pytool.com/language/golang/hugo/hugo/&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/github/">GitHub</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/hugo/">Hugo</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Golang 常用命令和操作总结</title>
                <link>https://xdhuxc.github.io/posts/programming/golang/golang-command-and-operation/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/golang/golang-command-and-operation/</guid>
                <pubDate>Mon, 29 Apr 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下 golang 中常用的命令，在开发过程经常会用到。&lt;/p&gt;
&lt;h3 id=&#34;交叉编译&#34;&gt;交叉编译&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build hello.go
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CGO_ENABLED：是否使用 C 语言版本的 GO 编译器，设置为 0 表示关闭 C 语言版本的编译器。如果在 GO 当中使用了 C 的库，默认使用 go build 的时候就会启用 CGO 编译器。&lt;/li&gt;
&lt;li&gt;GOOS：目标操作系统。&lt;/li&gt;
&lt;li&gt;GOARCH：目标操作系统的架构。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;常用命令&#34;&gt;常用命令&lt;/h3&gt;
&lt;p&gt;1）&lt;code&gt;run&lt;/code&gt; 用于编译并运行 go 文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go run main.go
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）安装 gocode，godef，guru&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go get -u github.com/nsf/gocode       # 安装 gocode，自动补全守护程序
go get -u github.com/rogpeppe/godef   # 安装 dodef
go get -u golang.org/x/tools/cmd/guru # 安装 guru
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）&lt;code&gt;go mod&lt;/code&gt; 命令提供了访问模块的操作，使用方式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go mod &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; [&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;arguments&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;命令包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;init：在当前目录下初始化新的模块，会生成 go.mod 文件。&lt;/li&gt;
&lt;li&gt;tidy：增加缺失或删除不用的模块。&lt;/li&gt;
&lt;li&gt;vendor：将依赖包复制到项目下的 vendor 目录下。&lt;/li&gt;
&lt;li&gt;download：下载模块到本地缓存。&lt;/li&gt;
&lt;li&gt;edit：从工具或脚本来编辑 go.mod。&lt;/li&gt;
&lt;li&gt;graph：打印模块依赖图。&lt;/li&gt;
&lt;li&gt;verify：验证依赖项具有预期的内容。&lt;/li&gt;
&lt;li&gt;why：解释需要该包或者模块的原因。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;4）&lt;code&gt;env&lt;/code&gt; 用于修改 go 内置的环境变量，不能用于修改其他环境变量&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go env -w GOPRIVATE=&amp;#34;gitlab.xdhuxc.com&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;除 &lt;code&gt;GOPATH&lt;/code&gt; 外，go 内置的环境变量不能使用 &lt;code&gt;export&lt;/code&gt; 来进行修改&lt;/p&gt;
&lt;h3 id=&#34;基于-make-编译-go-工程&#34;&gt;基于 make 编译 go 工程&lt;/h3&gt;
&lt;p&gt;1、进入 GOPATH 目录下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go env
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在 src 目录下的 github.com 目录下创建用户的目录，然后拉取代码，进行编译。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir f1yegor
git clone https://github.com/f1yegor/clickhouse_exporter.git
cd clickhouse_exporter/
make build
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;govendor-的使用&#34;&gt;govendor 的使用&lt;/h3&gt;
&lt;p&gt;1、安装 govendor&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go get -u -v github.com/kardianos/govendor
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、进入项目路径下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuan$ pwd
/mtransformd
wanghuan$ ls
Makefile        conf.prod.yml   src
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、初始化 vendor 目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;govendor init
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、添加本工程使用到的依赖包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;govendor add +external
或
govendor add +e
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;添加指定包至 vendor 目录下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;govendor add github.com/jinzhu/gorm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;vendor.json：govendor 配置文件，记录依赖包列表&lt;/p&gt;
&lt;h3 id=&#34;环境变量&#34;&gt;环境变量&lt;/h3&gt;
&lt;p&gt;golang 环境变量&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;GOPRIVATE：指定不可公开获取的模块的路径，用作较低级别的 GONOPROXY 和 GONOSUMDB 变量的默认值，它们对通过代理获取并使用校验和数据库进行验证的模块提供了更细粒度的控制。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;GOPROXY：可以设置为以逗号分隔的代理 URL 列表或特殊令牌 &lt;code&gt;direct&lt;/code&gt;，默认值为：&lt;code&gt;https://proxy.golang.org,direct&lt;/code&gt;，当解析一个包路径到它所包含的模块时，go 命令将顺序尝试列表中每个代理上的所有候选的模块路径。除 &lt;code&gt;404&lt;/code&gt; 和 &lt;code&gt;410&lt;/code&gt; 之外的不可访问代理或 HTTP 状态码将终止搜索，而不会再向其他代理搜索。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;GOSUMDB：用于标识数据库的名称，以及可选的公用密钥和服务器URL，以查询尚未在主模块的 &lt;code&gt;go.sum&lt;/code&gt; 文件中列出的模块的校验和。 如果 &lt;code&gt;GOSUMDB&lt;/code&gt; 不包含显式 &lt;code&gt;URL&lt;/code&gt;，则通过探测指示支持校验和数据库的端点的 &lt;code&gt;GOPROXY URL&lt;/code&gt; 来选择 &lt;code&gt;URL&lt;/code&gt;，如果任何代理均不支持直接连接到命名数据库，则选择 &lt;code&gt;URL&lt;/code&gt;。 如果将 &lt;code&gt;GOSUMDB&lt;/code&gt; 设置为 &lt;code&gt;off&lt;/code&gt;，则不查询校验和数据库，仅验证 &lt;code&gt;go.sum&lt;/code&gt; 文件中现有的校验和。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;无法访问默认代理和校验数据库（例如，由于防火墙或沙河配置）的用户，可以通过将 GOPROXY 设置为 direct 和（或）将 GOSUMDB 设置为 off 来禁止其使用。&lt;/p&gt;
&lt;h3 id=&#34;引用本地-gitlab-中的包&#34;&gt;引用本地 gitlab 中的包&lt;/h3&gt;
&lt;p&gt;在最开始搭建项目的时候，将公司内部的一些公用包放到了 github 上，项目中引用 github 上的公共包，现在需要改造为引用公司内部 gitlab 上的。&lt;/p&gt;
&lt;p&gt;经过一番探索，总结出步骤如下：&lt;/p&gt;
&lt;p&gt;1、修改 &lt;code&gt;go&lt;/code&gt; 环境变量：&lt;code&gt;go env -w GOPRIVATE=&amp;quot;gitlab.ushareit.me&amp;quot;&lt;/code&gt;（&lt;code&gt;GOPRIVATE&lt;/code&gt; 指定不可公开获取的模块的路径）&lt;/p&gt;
&lt;p&gt;2、在代码中使用 &lt;code&gt;gitlab.xdhuxc.com/xdhuxc/xdhuxc-common&lt;/code&gt; 全文替换 &lt;code&gt;github.com/xdhuxc/xdhuxc-common&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;3、删除 &lt;code&gt;go.mod&lt;/code&gt; 文件，重新生成之，依次执行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;go mod init
go mod tidy
go mod vendor
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、使用 &lt;code&gt;make build&lt;/code&gt; 命令进行测试&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/golang/">Golang</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/golang/">Golang</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>人间世·杂三</title>
                <link>https://xdhuxc.github.io/posts/human/human-world-mixed-three/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/human/human-world-mixed-three/</guid>
                <pubDate>Sat, 13 Apr 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;摘要：&lt;/p&gt;
&lt;p&gt;　　本篇文章是对最近社会讨论的 996.icu 问题的扩展，如果该问题继续被讨论下去，可能会涉及到这些问题。&lt;/p&gt;
&lt;p&gt;        996.icu 问题应该被继续讨论下去。那么，也许就可能会讨论到下面这些问题吧。&lt;/p&gt;
&lt;p&gt;　　如果法治思想，也就是说依靠法律的精神、思想、原则和条款来管理整个中国社会，不能够深入到每个中国人的思想深处，那么，马老师们和刘兄弟们的财产依靠什么来保护呢？所以，为了解决这个问题，马老师们和刘兄弟们最好是推动包括《中华人民共和国宪法》、《中华人民共和国劳动法》等法律的修改，为他们占据理论的至高点，这样其他人反对996或者007就没有绝对依据了。通过动用他们在政商学文娱等所谓“精英阶层”的力量，想必是不难办到的。至于理由嘛，在新零售、新技术等“五新”之外再增加两新，“新阶层”和“新生产方式”，然后让代言人渲染和论证现行法律不适应新的“七新”形势，就可以了。也许是因为共和国法律敛财有余、维稳过剩、治世无用，所以有司对996.icu问题从未正面回应，包括有赞年会直接挑战《中华人民共和国劳动法》。在法治社会，不是都供养了一大批专业的人来维护法律的尊严吗，工资及福利待遇是白给的吗？&lt;/p&gt;
&lt;p&gt;　　再讨论下去，这个问题也许就变成了这样。&lt;/p&gt;
&lt;p&gt;　　今年是中华人民共和国建国 70 周年。70 年来，共和国的发展取得了巨大的成功，整个中国社会已经拥有了巨量的社会财富，那么问题来了，这巨量的社会财富是怎么来的呢？从而它究竟属于谁？在整个中国社会内部应该怎么分配呢？也许在马老师们和刘兄弟们看来，这巨量的社会财富，肯定是他们政商学文娱等精英阶层在西方精英的指导下，创新和奋斗出来的呀，还有其他可能性吗？。接下来，让他们的代言人以各种方式去论证、扩展和渲染这种思想，然后就可以很方便地应对社会舆论了。阿里巴巴 2018 财年净利润为 614.12 亿元，这些利润应该都是归属于股东们的吧，它们是从哪里来的呢？不知道阿里巴巴的员工加班有没有加班费。&lt;/p&gt;
&lt;p&gt;　　再讨论下去，这个问题就可能变成了这样。&lt;/p&gt;
&lt;p&gt;　　共和国政府在整个中国社会中的价值导向问题，我们这个社会究竟应该崇尚什么，反对什么？价值观这种东西，当且仅当其作为资源和利益分配的依据的时候，才可能深入每个组织成员的内心，否则就只能给领导演讲时使用了。一方面将实实在在的资源和利益给权力和资本，另一方面，给广大劳动者讲情怀，鼓励大家修福报，这难道不是在侮辱这些996.icu们的智商吗？从中央电视台毕福剑事件，到2018年秋季的开学第一课，共和国政府在整个社会倡导什么样的价值观？如果一个时刻把劳动人民放在心上，始终为人民服务的人被整个社会踩在脚底下，被那些乱七八糟的人调侃，这些人还被称为“老师”，那只能说明996和007对中国人来说，还不够刺激，不够酸爽，这福报修的太少了。&lt;/p&gt;
&lt;p&gt;　　再讨论下去，这个问题就可能变成了这样。&lt;/p&gt;
&lt;p&gt;　　如果权力、资本和劳动的收益分配不能从顶层设计上合理地解决，不能让三方都基本满意，类似于996.icu的问题讨论就会继续下去，并且杂音会越来越多。在实践层面上，就是权力和资本必须向劳动让利，至于权力和资本之间的利益分配问题，则是另外的问题。如果问题不能得到实际解决，那么，产业升级、中国制造、以及中国梦依靠谁来实现呢，难道要让这些真的成为中国的梦吗？如果政府在这场讨论中缺席，或者给不出让大家满意的解释和解决方法，政府的公信力和社会地位就会继续降低。为什么有司对这个问题一直不发声，不表态呢？恐怕因为他们清楚这个问题的本质，也清楚从 github 上烧起来的这把火最终将不可避免地要烧向他们。权力和资本 与广大普通劳动人民之间的矛盾，由谁来解释和解决呢？&lt;/p&gt;
&lt;p&gt;　　问题讨论到这里，基本就可以结束了。如果解决到这里，也就可以结束了。但是也可以有后记。&lt;/p&gt;
&lt;p&gt;　　再讨论下去，这个问题就可能会变成这样。&lt;/p&gt;
&lt;p&gt;　　同样是不懂资本主义，有些人依靠体制和组织的保障，高枕无忧；而有些人，已经离开了我们，有些人可能下一秒离开我们，不管他们是小孩、是老年人，还是其他人群，大体都是普通的中国老百姓。这些年来发生的很多恶性事件，无一不隐藏着权力和资本对广大普通中国人尊严、生命和财产的肆意蹂躏和践踏，但是很多人还是礼貌客气地声明自己不懂资本主义，其实他们的立场已经很明确了。稍微了解下美国人对于阿尔斯通、中兴及空客的手段，然后理解国家权力服务于资本的增殖，就很容易了，捎带着感悟下“响水爆炸事故”及假疫苗等等事件。现在及未来，有很多人将离开我们，而且是群体性的，人为的原因导致了这些结果，这是一定会发生的，其实他们本可以活得好好的。这并不是说，知道了资本主义，就可以避免这种事情的发生，我们还走在探寻原因和解决问题的路上。&lt;/p&gt;
&lt;p&gt;　　再讨论下去，这个问题就可能变成了这样。&lt;/p&gt;
&lt;p&gt;　　压迫和被压迫，剥削和被剥削，这种事情来源于什么？也就是《论人类不平等的起源和基础》，过程是怎样的呢？论述资本的产生及运动过程的《资本论》给出了描述，解决问题的理论和方法是什么？马克思主义和共产主义，但是现在似乎没多少人愿意相信了。似乎，人类为解决这个问题所进行的政治实践都凉凉了。毕竟，对于绝大多数政治人物来说，“我死后，哪管他洪水滔天”。从欧美的完全私有制，到苏联及共和国的完全公有制，再到今天世界范围内的的混合所有制，这种努力和探索的逻辑非常自然，依然在继续，但问题从来没有少过，而且还遇到了跨越国界和加速社会运行（从而也加速财富流动和转移）的互联网，问题更加复杂了。不知道这个世界上还有没有知识分子为这个问题而思考和努力？毫无疑问，依附于权力和资本赚钱来得更实在和容易些。&lt;/p&gt;
&lt;p&gt;　　再讨论下去，这个问题就可能变成了这样。&lt;/p&gt;
&lt;p&gt;　　权力、资本、技术和人的关系问题。从抽象逻辑上来讲，作为人的逻辑联合体的人类创造了前三者，却为这个联合体中的极少数群体占有，绝大多数人却处于压迫之下，甚至连最基本的生活都不能保障，家庭都不能建立和维持，也包括以互联网为代表的新兴技术更加温柔地残害了许多个体的人和社会，这是个可笑的事实。在古老的权力和人的力量体系中，加入资本，诞生了近现代的西方民主和法治（但从美国和乌克兰选举出毫无从政经验的总统来看，这种制度现在遇到了理论和实践上的麻烦），再加入技术，诞生了 google，facebook 等超越国家的互联网霸权，整个人类社会的力量体系和力量对比都在发生新的变化，总体上社会资源和利益是在向着更为普通人可接触和获得的方向发展，但是仍然不能令大家满意。应该是存在某种理论上的和实际上的解决方法，我们还没有找到或者客观条件还不具备！也可能，根本就不存在彻底解决该问题的方法，人类社会只能是在和这些东西的斗争中不断向前发展。&lt;/p&gt;
&lt;p&gt;　　再讨论下去，这个问题可能就变成了这样。&lt;/p&gt;
&lt;p&gt;　　人类消失之后，这颗星球会怎样，终于可以展开想象力自由地尽情想象推演了！&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://996.icu&#34;&gt;https://996.icu&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s/vPlFuB3wa1CW_uEXOOvExA&#34;&gt;https://mp.weixin.qq.com/s/vPlFuB3wa1CW_uEXOOvExA&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/996icu/996.ICU/blob/master/README_CN.md&#34;&gt;https://github.com/996icu/996.ICU/blob/master/README_CN.md&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://news.cnblogs.com/n/624092/&#34;&gt;https://news.cnblogs.com/n/624092/&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>sessionStorage，localStorage 和 Cookie 的异同</title>
                <link>https://xdhuxc.github.io/posts/programming/web/sessionstorage-localstorage-cookie/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/web/sessionstorage-localstorage-cookie/</guid>
                <pubDate>Mon, 01 Apr 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下在 Web 开发过程中常用的存储客户端数据的 SessionStorage，LocalStorage 和 Cookie 的异同，对于我们存储客户端数据时的选型很有帮助。&lt;/p&gt;
&lt;h3 id=&#34;sessionstorage-localstorage-和-cookie-的异同&#34;&gt;sessionStorage, localStorage 和 cookie 的异同&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;特性&lt;/th&gt;
&lt;th&gt;Cookie&lt;/th&gt;
&lt;th&gt;localStorage&lt;/th&gt;
&lt;th&gt;sessionStorage&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;数据的生命周期&lt;/td&gt;
&lt;td&gt;一般由服务器生成，可设置失效时间。如果在浏览器端生成 Cookie，默认是关闭浏览器后失效。&lt;/td&gt;
&lt;td&gt;除非被清除，否则永久保存。&lt;/td&gt;
&lt;td&gt;仅在当前会话下有效，关闭页面或浏览器后被清除，刷新页面数据依旧存在。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;存放数据大小&lt;/td&gt;
&lt;td&gt;4K左右&lt;/td&gt;
&lt;td&gt;一般为5MB&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;与服务器端通信&lt;/td&gt;
&lt;td&gt;每次都会携带在 HTTP 头中，如果使用 Cookie 保存过多数据会带来性能问题&lt;/td&gt;
&lt;td&gt;仅在客户端（即浏览器）中保存，不参与和服务器的通信&lt;/td&gt;
&lt;td&gt;sdgsd&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;易用性&lt;/td&gt;
&lt;td&gt;需要程序员自己封装，原生的 Cookie 接口不友好&lt;/td&gt;
&lt;td&gt;原生接口可以接受，亦可再次封装对 Object 和 Array 有更好的支持&lt;/td&gt;
&lt;td&gt;dsgd&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;localStorage 和 sessionStorage 是 HTML5 才应用的新特性，可能有些浏览器并不支持，需要注意：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;特性&lt;/th&gt;
&lt;th&gt;Chrome&lt;/th&gt;
&lt;th&gt;FireFox&lt;/th&gt;
&lt;th&gt;IE&lt;/th&gt;
&lt;th&gt;Opera&lt;/th&gt;
&lt;th&gt;Safari&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;localStorage&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;3.5&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;10.50&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;sessionStorage&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;10.50&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://juejin.im/post/5a191c47f265da43111fe859&#34;&gt;https://juejin.im/post/5a191c47f265da43111fe859&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/web/">Web</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/sessionstorage/">SessionStorage</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/localstorage/">LocalStorage</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/cookie/">Cookie</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 prometheus 监控 etcd</title>
                <link>https://xdhuxc.github.io/posts/devops/prometheus/prometheus-monitor-etcd/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/prometheus/prometheus-monitor-etcd/</guid>
                <pubDate>Tue, 12 Mar 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了使用 prometheus 监控 etcd 的配置方法，还包括在 grafana 中显示 etcd 指标图标，以及基于 AlertManager 的报警配置。&lt;/p&gt;
&lt;h3 id=&#34;使用-prometheus-监控-etcd-及报警&#34;&gt;使用 prometheus 监控 etcd 及报警&lt;/h3&gt;
&lt;h4 id=&#34;前提条件&#34;&gt;前提条件&lt;/h4&gt;
&lt;p&gt;1、已经部署好 etcd 环境（单节点或集群）&lt;/p&gt;
&lt;p&gt;2、已经部署好 prometheus&lt;/p&gt;
&lt;p&gt;3、已经部署好 grafana 并配置了数据源，数据源类型为：Prometheus，数据源名称为：prometheus&lt;/p&gt;
&lt;h4 id=&#34;监控-etcd&#34;&gt;监控 etcd&lt;/h4&gt;
&lt;p&gt;grafana dashboard 配置：&lt;/p&gt;
&lt;p&gt;使用 &lt;a href=&#34;https://grafana.com/api/dashboards/3070/revisions/3/download&#34;&gt;etcd_rev3.json&lt;/a&gt;文件，修改其中的 datasource 为 Prometheus 数据源的名称，在 grafana 中导入该文件，可以将该 dashboard 命名为：etcd-monitor&lt;/p&gt;
&lt;p&gt;在 etcd 中未配置证书的情况下，在 prometheus.yml 文件中增加如下配置内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;global:
  scrape_interval:     15s
  evaluation_interval: 15s
scrape_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;prometheus&amp;#39;
    static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;127.0.0.1:9090&amp;#39;]
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;etcd&amp;#39;
    scheme: &amp;#39;http&amp;#39;    # 默认为：http，所以此处可省略
    static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;172.27.126.226:2379&amp;#39;, &amp;#39;172.27.126.227:2379&amp;#39;, &amp;#39;172.27.126.228:2379&amp;#39;] # 以 YAML 数组方式填写 etcd 端点
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 prometheus&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;etcd&lt;/code&gt; 中 配置证书的情况下，在 &lt;code&gt;prometheus.yml&lt;/code&gt; 文件中增加如下配置内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;global:
  scrape_interval:     15s
  evaluation_interval: 15s
scrape_configs:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;prometheus&amp;#39;
    static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;127.0.0.1:9090&amp;#39;]
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; job_name: &amp;#39;etcd&amp;#39;
    scheme: &amp;#39;https&amp;#39;   # 由于使用了证书，所以此处必须配置为：https
    tls_config:
      ca_file: &amp;#39;/etc/ssl/etcd/ca.pem&amp;#39;          # 这几处放置 etcd 证书文件路径，不能直接放置文件内容
      cert_file: &amp;#39;/etc/ssl/etcd/client.pem&amp;#39;
      key_file: &amp;#39;/etc/ssl/etcd/client-key.pem&amp;#39;
    static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#39;172.27.126.226:2379&amp;#39;, &amp;#39;172.27.126.227:2379&amp;#39;, &amp;#39;172.27.126.228:2379&amp;#39;] # 以 YAML 数组方式填写 etcd 端点
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 prometheus&lt;/p&gt;
&lt;h4 id=&#34;etcd-报警配置&#34;&gt;etcd 报警配置&lt;/h4&gt;
&lt;p&gt;在 prometheus.yml 中添加 &lt;a href=&#34;https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/etcd3_alert.rules.yml&#34;&gt;etcd3_alert.yml&lt;/a&gt; 文件路径&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;alerting:
  alertmanagers:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; static_configs:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; targets: [&amp;#34;127.0.0.1:9093&amp;#34;]
rule_files:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; &amp;#39;/data/prometheus/etcd3_alert.yml&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/etcd/">etcd</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/prometheus/">Prometheus</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>ElasticSearch REST API 的使用</title>
                <link>https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-restful-api/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-restful-api/</guid>
                <pubDate>Thu, 10 Jan 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 ElasticSearch API 的详细使用方法。&lt;/p&gt;
&lt;h4 id=&#34;rest-api-用途&#34;&gt;REST API 用途&lt;/h4&gt;
&lt;p&gt;elasticsearch 提供了很多全面的API，大致可以分为如下几种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;检查集群、节点、索引的健康状况。&lt;/li&gt;
&lt;li&gt;管理集群、节点、索引数据、元数据。&lt;/li&gt;
&lt;li&gt;执行CRUD，创建、读取、更新、删除以及查询索引和索引模板等。&lt;/li&gt;
&lt;li&gt;执行高级的查询操作、比如分页、排序、脚本和聚合等。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;常用命令&#34;&gt;常用命令&lt;/h4&gt;
&lt;p&gt;1、查看集群健康状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl http://172.20.17.4:9200/_cat/health?v
epoch      timestamp cluster               status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent 
1531817234 08:47:14  elasticsearch-cluster yellow          1         1    290 290    0    0      180             0                  -                 61.7% 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到集群的名字是：elasticsearch-cluster，集群的状态为：yellow。&lt;/p&gt;
&lt;p&gt;elasticsearch 集群的颜色及含义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;绿色：最健康的状态，代表所有的分片包括备份都可用。&lt;/li&gt;
&lt;li&gt;黄色：基本的分片可用，但是备份不可用，也可能是没有备份。&lt;/li&gt;
&lt;li&gt;红色：部分的分片可用，表明分片有一部分损坏，此时执行查询部分数据仍然可以查到，遇到这种情况，需要尽快解决。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、查询节点列表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl http://172.20.17.4:9200/_cat/nodes?v
host        ip          heap.percent ram.percent load node.role master name                 
172.20.17.4 172.20.17.4           17          99 5.06 d         *      elasticsearch-master 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查询所有索引&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl http://172.20.17.4:9200/_cat/indices?v
health status index                               pri rep docs.count docs.deleted store.size pri.store.size 
yellow open   zipkin-2018-07-14                     5   1        180            0    182.4kb        182.4kb 
yellow open   yycloud-basedoc-mw-servmeta-private   5   1       2553          246     28.9mb         28.9mb 
red    open   zipkin-2018-07-17                     5   1  255069327            0     15.4gb         15.4gb 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;上面的结果中，zipkin-2018-07-14索引的状态是yellow，这是因为此时虽然有5个主分片和一个备份。但是由于只是单个节点，分片还在运行中，无法动态地修改。因此当有其他的节点加入到集群中时，备份的节点会被复制到另外一个节点中，状态就会变成 green。&lt;/p&gt;
&lt;p&gt;4、删除索引&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl -XDELETE http://172.20.17.4:9200/zipkin-2018-07-14       # zipkin-2018-07-14为索引名称
{
    &amp;#34;acknowledged&amp;#34;:true
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、创建索引&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -u esadmin:esadmin -H &amp;#34;Content-Type: application/json&amp;#34; -XPOST http://${DCEE_IP}:9200/xdhuxc_custom -T ./xdhuxc_custom.json 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;索引模板&#34;&gt;索引模板&lt;/h4&gt;
&lt;p&gt;1、查询 elasticsearch 索引模板&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -u esadmin:esadmin http://172.20.15.36:9200/_template?pretty # 返回所有索引模板，pretty 参数仅仅是指定Elasticsearch返回JSON格式结果
curl -XGET http://172.20.15.36:9200/_template/my_template &lt;span class=&#34;ni&#34;&gt;#查询索引模板my_template&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、创建 elasticsearch 索引模板&lt;/p&gt;
&lt;p&gt;创建一个名为my_template的模板,匹配所有my_index开头的索引,匹配成功后会按照settings和mappings创建一个新的索引.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -XPUT http://172.20.15.36:9200/_template/my_template -d&amp;#39;    
{    
        &amp;#34;template&amp;#34;: &amp;#34;my_index*&amp;#34;, //匹配所有my_index开头的索引    
        &amp;#34;order&amp;#34;:0,//当存在多个索引模板时并且某个索引两者都匹配时,使用order来确定模板合并顺序  
        &amp;#34;settings&amp;#34;: {...},    
        &amp;#34;mappings&amp;#34; :{...}    
}&amp;#39;
或
curl -u esadmin:esadmin -XPUT http://172.20.15.36:9200/_template/developer_docker* -T ./developer_docker.json
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、删除 elasticsearch 索引模板&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -XDELETE http://172.20.15.36:9200/_template/my_template
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-node ~]# curl -v -H &amp;#34;Content-Type:application/json&amp;#34; http://10.10.24.75:9200/_cat/indices?v | python -m json.tool
&lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; About to connect() to 10.10.24.75 port 9200 (#0)
&lt;span class=&#34;k&#34;&gt;*&lt;/span&gt;   Trying 10.10.24.75...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Connected to 10.10.24.75 (10.10.24.75) port 9200 (#0)
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;GET /_cat/indices?v HTTP/1.1
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;User-Agent: curl/7.29.0
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;Host: 10.10.24.75:9200
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;Accept: */*
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;Content-Type:application/json
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&amp;gt; 
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;200&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;OK&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;Content-Type:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;application&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;UTF-8&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;Content-Length:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;337&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; 
&lt;span class=&#34;err&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;shown&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;100&lt;/span&gt;   &lt;span class=&#34;na&#34;&gt;337&lt;/span&gt;  &lt;span class=&#34;na&#34;&gt;100&lt;/span&gt;   &lt;span class=&#34;na&#34;&gt;337&lt;/span&gt;    &lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;     &lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;  &lt;span class=&#34;na&#34;&gt;36050&lt;/span&gt;      &lt;span class=&#34;na&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;--:--:--&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;--:--:--&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;--:--:--&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;42125&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;Connection&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;#0&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;host&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;75&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;intact&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;[&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;docs&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;docs&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;deleted&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;health&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;yellow&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;xdhuxc-app_2018-07-20&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pri&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pri&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;store&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;795b&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rep&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;store&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;795b&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;},&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;docs&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;docs&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;deleted&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;health&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;yellow&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;xdhuxc-app_2018-07-19&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pri&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;pri&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;store&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;795b&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rep&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;store&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;795b&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/opensure/article/details/50824821&#34;&gt;http://blog.csdn.net/opensure/article/details/50824821&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.sina.com.cn/s/blog_17943a64f0102x8x0.html&#34;&gt;http://blog.sina.com.cn/s/blog_17943a64f0102x8x0.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/elasticsearch/">ElasticSearch</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>ElasticSearch 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-questions-and-solutions/</guid>
                <pubDate>Thu, 10 Jan 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在使用 ElasticSearch 的过程中常见的问题及解决方法。&lt;/p&gt;
&lt;p&gt;1、启动 elasticsearch 容器时，直接映射文件或目录时，报权限错误&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[2018-11-11T10:36:18,442][INFO ][o.e.n.Node               ] [] initializing ...
[2018-11-11T10:36:18,462][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [] uncaught exception in thread [main]
Caused by: java.nio.file.AccessDeniedException: /usr/share/elasticsearch/data/nodes
        at sun.nio.fs.UnixException.translateToIOException(UnixException.java:84) ~[?:?]
        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102) ~[?:?]
        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107) ~[?:?]
        at sun.nio.fs.UnixFileSystemProvider.createDirectory(UnixFileSystemProvider.java:384) ~[?:?]
        at java.nio.file.Files.createDirectory(Files.java:674) ~[?:1.8.0_92-internal]
        at java.nio.file.Files.createAndCheckIsDirectory(Files.java:781) ~[?:1.8.0_92-internal]
        at java.nio.file.Files.createDirectories(Files.java:767) ~[?:1.8.0_92-internal]
        at org.elasticsearch.env.NodeEnvironment.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;(NodeEnvironment.java:220) ~[elasticsearch-5.0.0.jar:5.0.0]
        at org.elasticsearch.node.Node.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;(Node.java:240) ~[elasticsearch-5.0.0.jar:5.0.0]
        at org.elasticsearch.node.Node.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;(Node.java:220) ~[elasticsearch-5.0.0.jar:5.0.0]
        at org.elasticsearch.bootstrap.Bootstrap$5.&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;(Bootstrap.java:191) ~[elasticsearch-5.0.0.jar:5.0.0]
        at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:191) ~[elasticsearch-5.0.0.jar:5.0.0]
        at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:286) ~[elasticsearch-5.0.0.jar:5.0.0]
        at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:112) ~[elasticsearch-5.0.0.jar:5.0.0]
        ... 6 more
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;问题原因说明：https://discuss.elastic.co/t/elastic-elasticsearch-docker-not-assigning-permissions-to-data-directory-on-run/65812/4&lt;/p&gt;
&lt;p&gt;解决：先创建一个卷，然后再挂载该目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker volume create --opt device=/root/es/data --name=xdhuxc
docker run -p 9200:9200 -v xdhuxc:/usr/share/elasticsearch/data docker.elastic.co/elasticsearch/elasticsearch:6.5.0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果仍然出现错误，创建 elasticsearch 用户，给目录赋予权限，然后启动容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;groupadd -g 1000 elasticsearch
useradd -u 1000 -g 1000 elasticsearch
chown -R 1000 es
chgrp -r 1000 es
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、创建索引时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:~ wanghuan$ curl -H &amp;#34;Content-Type: application/json&amp;#34; -XPUT http://localhost:9200/xdhuxc_a -T ./a.json
{
    &amp;#34;error&amp;#34;:{
        &amp;#34;root_cause&amp;#34;:[
            {
                &amp;#34;type&amp;#34;:&amp;#34;illegal_argument_exception&amp;#34;,
                &amp;#34;reason&amp;#34;:&amp;#34;unknown setting [index.as] please check that any required plugins are installed, or check the breaking changes documentation for removed settings&amp;#34;
            }
        ],
        &amp;#34;type&amp;#34;:&amp;#34;illegal_argument_exception&amp;#34;,
        &amp;#34;reason&amp;#34;:&amp;#34;unknown setting [index.as] please check that any required plugins are installed, or check the breaking changes documentation for removed settings&amp;#34;,
        &amp;#34;suppressed&amp;#34;:[
            {
                &amp;#34;type&amp;#34;:&amp;#34;illegal_argument_exception&amp;#34;,
                &amp;#34;reason&amp;#34;:&amp;#34;unknown setting [index.sdfsdg] please check that any required plugins are installed, or check the breaking changes documentation for removed settings&amp;#34;
            }
        ]
    },
    &amp;#34;status&amp;#34;:400
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;a.json 的内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
    &amp;#34;container_id&amp;#34; : &amp;#34;30855c6b7ea297a3e8ed2d62b7bc489d9712cd57e70d90b1d229e5c6932987a6&amp;#34;,
    &amp;#34;container_name&amp;#34; : &amp;#34;/is-live.1.yyk840n4mkd4x9fr53wt0tqh0&amp;#34;,
    &amp;#34;source&amp;#34; : &amp;#34;stdout&amp;#34;,
    &amp;#34;log&amp;#34; : &amp;#34;2019-05-14 19:42:24.028 ERROR 1 --- [io-2062-exec-88] c.k.i.l.c.websocket.BarrageWebSocket     : BarrageWebSocket error&amp;#34;,
    &amp;#34;timestamp&amp;#34; : &amp;#34;2019-05-14T19:42:24.028000000+08:00&amp;#34;,
    &amp;#34;tag&amp;#34; : &amp;#34;docker.is-live&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因：创建索引时丢失了 document type 和 document id，创建索引的格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;POST index_name/document_type/document_id -T abc.json
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;必须提供 document type 和 document id，文档 ID 在此处是可选的，如果不提供文档 ID，那么 elasticsearch 将会为其创建一个字母数字 ID。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:~ wanghuan$ curl -H &amp;#34;Content-Type: application/json&amp;#34; -XPUT http://localhost:9200/yztc/xdhuxc/1 -T ./1.json
{
    &amp;#34;_index&amp;#34;:&amp;#34;yztc&amp;#34;,
    &amp;#34;_type&amp;#34;:&amp;#34;xdhuxc&amp;#34;,
    &amp;#34;_id&amp;#34;:&amp;#34;1&amp;#34;,
    &amp;#34;_version&amp;#34;:1,
    &amp;#34;result&amp;#34;:&amp;#34;created&amp;#34;,
    &amp;#34;_shards&amp;#34;:{
        &amp;#34;total&amp;#34;:2,
        &amp;#34;successful&amp;#34;:1,
        &amp;#34;failed&amp;#34;:0
    },
    &amp;#34;_seq_no&amp;#34;:0,
    &amp;#34;_primary_term&amp;#34;:1
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其他几种方法创建一个索引：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;POST index_name/document_type -T abc.json
PUT index_name/document_type/document_id -T abc.json
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、ElasticSearch启动时报错，错误如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[2017-06-20T09:57:45,307][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]
org.elasticsearch.bootstrap.StartupException: java.lang.RuntimeException: can not run elasticsearch as root
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;出于安全考虑，ElasticSearch不让使用root用户启动，解决方法：&lt;/p&gt;
&lt;p&gt;1）在启动命令中加入参数，在使用命令行启动ElasticSearch时，加入额外的参数启动，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/bin/elasticsearch -Des.insecure.allow.root=true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）创建新用户，以新用户身份启动之&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;groupadd -g 700 elasticsearch                                                       # 创建elasticsearch用户组
useradd -u 701 -g 700 elasticsearch                                                 # 创建用户elasticsearch
passwd elasticsearch                                                                # 为用户elasticsearch设置密码
gpasswd -a elasticsearch elasticsearch                                              # 将用户elasticsearch添加到用户组elasticsearch中，第一个参数表示用户名，第二个参数表示用户组名
chown -R elasticsearch:elasticsearch /middleware/elasticsearch-2.4.1 # 为用户组elasticsearch和用户elasticsearch赋予权限
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、Elasticsearch 启动时报错，错误如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[2]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行如下命令解决：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sysctl -w vm.max_map_count=262144
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo &amp;#34;vm.max_map_count=262144&amp;#34; &amp;gt;&amp;gt; /etc/sysctl.conf
sysctl -p
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、ElasticSearch 启动后，使用 &lt;code&gt;curl http://localhost:9200&lt;/code&gt; 访问，控制台有内容输出，但是 &lt;code&gt;curl http://ip_address:9200&lt;/code&gt; 控制台无内容输出，在浏览器中使用 &lt;code&gt;http://ip_address:9200&lt;/code&gt; 也无法访问。&lt;/p&gt;
&lt;p&gt;修改 &lt;code&gt;elasticsearch.yml&lt;/code&gt; 文件，修改 &lt;code&gt;network.host&lt;/code&gt; 的值为：&lt;code&gt;0.0.0.0&lt;/code&gt;，然后重新启动之，外网即可进行访问.&lt;/p&gt;
&lt;p&gt;6、elasticsearch状态为红色，原因为磁盘不足，腾出磁盘空间后，还是红色，执行如下命令：&lt;/p&gt;
&lt;p&gt;Elasticsearch 提供了专门的 &lt;code&gt;reroute API&lt;/code&gt; 用于手工进行 &lt;code&gt;shard&lt;/code&gt; 的移动、分配以及取消指令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;POST /_cluster/reroute
{
  &amp;#34;commands&amp;#34;: [
    {
      &amp;#34;move&amp;#34;: {
        &amp;#34;index&amp;#34;: &amp;#34;xdhuxc-basedoc-ta_mysql-a0f921217f6d4a6aa348415411db6f7e&amp;#34;,
        &amp;#34;shard&amp;#34;: 0,
        &amp;#34;from_node&amp;#34;: &amp;#34;singlenode&amp;#34;,
        &amp;#34;to_node&amp;#34;: &amp;#34;singlenode&amp;#34;
      }
    }
  ]
}
POST /_cluster/reroute
{
  &amp;#34;commands&amp;#34;: [
    {
      &amp;#34;allocate&amp;#34;: {
        &amp;#34;index&amp;#34;: &amp;#34;xdhuxc-basedoc-ta_mysql-a0f921217f6d4a6aa348415411db6f7e&amp;#34;,
        &amp;#34;shard&amp;#34;: 0,
        &amp;#34;node&amp;#34;: &amp;#34;singlenode&amp;#34;,
        &amp;#34;allow_primary&amp;#34;:true
      }
    }
  ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/elasticsearch/">ElasticSearch</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>人间世·前言</title>
                <link>https://xdhuxc.github.io/posts/human/human-world-preface/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/human/human-world-preface/</guid>
                <pubDate>Tue, 01 Jan 2019 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;        已经有很长一段时间了，我的头脑中再也没有出现过新的东西了，这是一件令人沮丧和感到害怕的事情！&lt;/p&gt;
&lt;p&gt;　　我注意到，很多人的头脑和意识都在固化甚至僵化，每当谈起一些事情时，有些人总会先入为主地以自己曾经的经历、认识或类比的方式去认识当前事情，这其实本来是没有多大问题的，但是他们却忽略了外部环境的变化和事情本身成因的不同，陷入了经验主义的怪圈。一旦陷入进去，大体上以后的人生就是在不断地重复和强化这个思维过程，再也跳脱不出来，直到哪天有勇气和决心扔掉自己曾经的认知！&lt;/p&gt;
&lt;p&gt;　　我发现，我的思想和思维也已经在固化和僵化。在过去的三四年中，我的头脑中总是在重复一些乱七八糟的东西，它们不停地在头脑中重复，严重地阻碍了我学习和认识新的事物。所以，我准备把这些东西记录下来，将头脑中的垃圾清理下。这些东西没有什么特别的地方，仅仅是个人头脑中的一些想法、认识、判断和推测等。它们将会以人间世为前缀，后面以标题一、二、三等一直排序下去，如果是随便写的内容，则会以杂一、杂二等为标题，并同时发布到个人网站和微信公众号上。&lt;/p&gt;
&lt;p&gt;　　往后余生，面向未来，学习新的知识和技能，不断向前走！&lt;/p&gt;
&lt;p&gt;　　在这里，不允许有任何犹豫！&lt;/p&gt;
&lt;p&gt;　　在这里，不允许有任何怯懦！&lt;/p&gt;
&lt;p&gt;　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　2019年1月1日&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E4%BA%BA%E9%97%B4%E4%B8%96/">人间世</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Pinpoint 的部署和使用</title>
                <link>https://xdhuxc.github.io/posts/mixed/pinpoint/pinpoint-install-and-basic-usage/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/pinpoint/pinpoint-install-and-basic-usage/</guid>
                <pubDate>Sat, 29 Dec 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Pinpoint 的部署和使用。&lt;/p&gt;
&lt;h1 id=&#34;部署-pinpoint&#34;&gt;部署 Pinpoint&lt;/h1&gt;
&lt;h3 id=&#34;前提条件&#34;&gt;前提条件&lt;/h3&gt;
&lt;p&gt;1、安装 JAVA，并配置 JAVA_HOME&lt;/p&gt;
&lt;p&gt;2、下载 pinpoint 安装包（https://github.com/naver/pinpoint/releases）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pinpoint-agent-1.8.0.tar.gz&lt;/li&gt;
&lt;li&gt;pinpoint-web-1.8.0.war&lt;/li&gt;
&lt;li&gt;pinpoint-collector-1.8.0.war&lt;/li&gt;
&lt;li&gt;pinpoint-master.zip&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;3、下载 hbase（http://apache.mirror.cdnetworks.com/hbase/stable/）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;hbase-1.4.7-bin.tar.gz&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;4、下载 tomcat&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;apache-tomcat-9.0.12.tar.gz&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;5、机器配置：
8C-16G-500G&lt;/p&gt;
&lt;h3 id=&#34;部署-pinpoint-组件&#34;&gt;部署 Pinpoint 组件&lt;/h3&gt;
&lt;h4 id=&#34;部署-hbase&#34;&gt;部署 hbase&lt;/h4&gt;
&lt;p&gt;1）启动 hbase 并检查启动状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc bin]# pwd
/root/pinpoint/hbase-1.4.7/bin
[root@xdhuxc bin]# ls
draining_servers.rb   hbase-cleanup.sh  hbase-config.sh   hirb.rb                 region_mover.rb   rolling-restart.sh        stop-hbase.cmd  zookeepers.sh
get-active-master.rb  hbase.cmd         hbase-daemon.sh   local-master-backup.sh  regionservers.sh  shutdown_regionserver.rb  stop-hbase.sh
graceful_stop.sh      hbase-common.sh   hbase-daemons.sh  local-regionservers.sh  region_status.rb  start-hbase.cmd           test
hbase                 hbase-config.cmd  hbase-jruby       master-backup.sh        replication       start-hbase.sh            thread-pool.rb
[root@xdhuxc bin]# ./start-hbase.sh 
running master, logging to /root/pinpoint/hbase-1.4.7/bin/../logs/hbase-root-master-xdhuxc.out
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=128m; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=128m; support was removed in 8.0
[root@xdhuxc bin]# jps  # 使用 jps 命令查看 hbase 是否启动成功，如果看到 ‘HMaster’ 的进程，则表明 hbase 启动成功。
7926 HMaster
7974 Jps
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）初始化 pinpoint 所需的表（https://github.com/naver/pinpoint/blob/master/hbase/scripts/hbase-create.hbase）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc bin]# pwd
/root/pinpoint/hbase-1.4.7/bin
[root@xdhuxc bin]# ls
draining_servers.rb   hbase-cleanup.sh  hbase-config.sh     hbase-jruby             master-backup.sh  replication               start-hbase.sh  thread-pool.rb
get-active-master.rb  hbase.cmd         hbase-create.hbase  hirb.rb                 region_mover.rb   rolling-restart.sh        stop-hbase.cmd  zookeepers.sh
graceful_stop.sh      hbase-common.sh   hbase-daemon.sh     local-master-backup.sh  regionservers.sh  shutdown_regionserver.rb  stop-hbase.sh
hbase                 hbase-config.cmd  hbase-daemons.sh    local-regionservers.sh  region_status.rb  start-hbase.cmd           test
[root@xdhuxc bin]# ./hbase shell hbase-create.hbase 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用命令查看导入的表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./hbase shell
status &amp;#39;detailed&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;部署-pinpoint-collector&#34;&gt;部署 Pinpoint-collector&lt;/h4&gt;
&lt;p&gt;1）将 pinpoint-collector-1.8.0.war 复制到 apache-tomcat-9.0.12/webapps/ 目录下，修改 pinpoint-collector-1.8.0/WEB-INF/classes 目录下的文件 hbase.properties，
修改如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;hbase.client.host=localhost
hbase.client.port=2181
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;指向 zookeeper 的地址和端口。如果是本机，localhost建议改为本地外网IP地址，端口默认，则这里无需更改。&lt;/p&gt;
&lt;h4 id=&#34;部署-pinpoint-web&#34;&gt;部署 Pinpoint-web&lt;/h4&gt;
&lt;p&gt;1）将 pinpoint-web-1.8.0.war 复制到 apache-tomcat-9.0.12/webapps/ 目录下，修改 pinpoint-web-1.8.0/WEB-INF/classes 目录下的文件 hbase.properties，
修改如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;hbase.client.host=localhost
hbase.client.port=2181
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;指向 zookeeper 的地址和端口。如果是本机，localhost建议改为本机外网IP地址，端口默认，则这里无需更改。&lt;/p&gt;
&lt;h4 id=&#34;部署-pinpoint-agent&#34;&gt;部署 Pinpoint-Agent&lt;/h4&gt;
&lt;p&gt;1）创建目录 pinpoint-agent 并解压 pinpoint-agent-1.8.0.tar.gz 到该目录下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir pinpoint-agent &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; tar -zxf pinpoint-agent-1.8.0.tar.gz -C pinpoint-agent
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）配置 pinpoint.config&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;profiler.collector.ip=127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这是指 pinpoint-collector 的地址，如果是同一服务器，可保持默认，建议修改为本机外网IP地址。&lt;/p&gt;
&lt;p&gt;3）安装 pinpoint-collector 启动后，自动就开启了9994，9995，9996的端口了，这里默认即可。
如果有端口需求，要去 pinpoint-collector 的配置文件 pinpoint-collector-1.8.0/WEB-INF/classes/pinpoint-collector.properties 中，修改这些端口。&lt;/p&gt;
&lt;h3 id=&#34;部署测试应用&#34;&gt;部署测试应用&lt;/h3&gt;
&lt;p&gt;1）修改 tomcat 的 catalina.sh 文件，加入如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;CATALINA_OPTS=&amp;#34;$CATALINA_OPTS -javaagent:/root/pinpoint/pinpoint-agent/pinpoint-bootstrap-1.8.0.jar&amp;#34;
CATALINA_OPTS=&amp;#34;$CATALINA_OPTS -Dpinpoint.agentId=xdhuxc&amp;#34;
CATALINA_OPTS=&amp;#34;$CATALINA_OPTS -Dpinpoint.applicationName=XdhuxcAPP&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;第一行，指定 pinpoint-bootstrap-1.8.0.jar 的位置。&lt;/p&gt;
&lt;p&gt;第二行，指定 agentId，必须唯一，用于标志一个 JVM。&lt;/p&gt;
&lt;p&gt;第三行，指定 applicationName，表示同一种应用，同一个应用的不同实例应用使用不同的 agentId，相同的 applicationName。&lt;/p&gt;
&lt;p&gt;此时，apache-tomcat-9.0.12/webapps 目录结构如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc webapps]# pwd
/root/pinpoint/apache-tomcat-9.0.12/webapps
[root@xdhuxc webapps]# ls
docs  examples  host-manager  jenkins  jenkins.war  manager  pinpoint-collector  pinpoint-web  ROOT
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;部署-spring-boot-项目&#34;&gt;部署 spring boot 项目&lt;/h4&gt;
&lt;p&gt;如果是以 jar 包方式部署 spring boot 项目，直接在启动命令中添加启动参数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nohup java -javaagent:/root/pinpoint/pinpoint-agent/pinpoint-bootstrap-1.8.0.jar -Dpinpoint.agentId=xdhuxc -Dpinpoint.applicationName=XdhuxcAPP -jar xdhuxc.jar &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 apache-tomcat-9.0.12/webapps 目录下放置要监控的应用程序 war 包，然后启动 tomcat。&lt;/p&gt;
&lt;h4 id=&#34;访问-pinpoint-管理页面&#34;&gt;访问 Pinpoint 管理页面&lt;/h4&gt;
&lt;p&gt;访问如下路径：&lt;/p&gt;
&lt;p&gt;http://172.20.26.149:8080/pinpoint-web&lt;/p&gt;
&lt;p&gt;如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/mixed/pinpoint/pinpoint.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/heyeqingquan/article/details/74456591&#34;&gt;https://blog.csdn.net/heyeqingquan/article/details/74456591&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://naver.github.io/pinpoint/1.8.0/main.html&#34;&gt;http://naver.github.io/pinpoint/1.8.0/main.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/pinpoint/">Pinpoint</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 binlog 的 MySQL 主从复制</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-master-slave-binlog/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-master-slave-binlog/</guid>
                <pubDate>Sat, 22 Dec 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了基于 binlog 的 MySQL 主从复制集群的搭建过程，留作后查。&lt;/p&gt;
&lt;h2 id=&#34;mysql-主从复制集群&#34;&gt;mysql 主从复制集群&lt;/h2&gt;
&lt;p&gt;MySQL 主从复制与读写分离&lt;/p&gt;
&lt;p&gt;MySQL作为目前世界上使用最广泛的免费数据库，在实际的生产环境中，由单台 MySQL 作为独立的数据库是完全不能满足实际需求的，无论是在安全性、高可用性及高并发等各个方面。&lt;/p&gt;
&lt;p&gt;因此，一般来说都是通过主从复制（Master-Slave）的方式来同步数据，再通过读写分离（MySQL-Proxy）来提升数据库的并发负载能力，这样的方案来进行部署与实施。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-salve-proxy.jpg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;h3 id=&#34;复制功能&#34;&gt;复制功能&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;数据分布&lt;/li&gt;
&lt;li&gt;负载均衡，针对数据读取&lt;/li&gt;
&lt;li&gt;数据备份&lt;/li&gt;
&lt;li&gt;高可用和故障切换&lt;/li&gt;
&lt;li&gt;MySQL 升级测试&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;复制方式&#34;&gt;复制方式&lt;/h3&gt;
&lt;p&gt;1、 主-从复制&lt;/p&gt;
&lt;p&gt;2、 主-主复制&lt;/p&gt;
&lt;p&gt;3、半同步复制&lt;/p&gt;
&lt;h3 id=&#34;复制原理&#34;&gt;复制原理&lt;/h3&gt;
&lt;p&gt;MySQL 中有一种日志叫做 bin 日志（二进制日志），这个日志会记录下所有修改了数据库的 SQL 语句（insert， update， delete，alter，grant等），主从复制的原理就是把主数据库服务器上的 bin 日志复制到从数据库服务器上执行一遍，这样从数据库服务器上的数据就和主数据库服务器上的数据相同了。&lt;/p&gt;
&lt;h3 id=&#34;复制流程图&#34;&gt;复制流程图&lt;/h3&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/master-slave-copy.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;h3 id=&#34;复制过程&#34;&gt;复制过程&lt;/h3&gt;
&lt;p&gt;1、主节点必须启用二进制日志，记录任何修改数据库数据的事件。&lt;/p&gt;
&lt;p&gt;2、从节点开启一个线程（I/O Thread）把自己扮演成 mysql 的客户端，通过 mysql 协议，请求主节点的二进制日志文件中的事件。&lt;/p&gt;
&lt;p&gt;3、主节点启动一个线程（dump Thread），检查自己二进制日志中的事件，跟对方请求的位置对比，如果不带请求位置参数，则主节点就会从第一个日志文件中的第一个事件一个一个发送给从节点。&lt;/p&gt;
&lt;p&gt;4、从节点接收到主节点发送过来的数据，把它放置到中继日志（relay log）文件中，并记录该次请求到主节点的具体哪个二进制日志文件的哪个位置。&lt;/p&gt;
&lt;p&gt;5、从节点启动另外一个线程（sql Thread），把中继日志中的事件读取出来，并在本地再执行一次。&lt;/p&gt;
&lt;h3 id=&#34;复制过程中线程的作用&#34;&gt;复制过程中线程的作用&lt;/h3&gt;
&lt;h4 id=&#34;主节点&#34;&gt;主节点&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;dump Thread：为每个从节点的 I/O Thread 启动一个 dump 线程，用于向从节点发送二进制事件。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;从节点&#34;&gt;从节点&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;I/O Thread：从主节点请求二进制日志事件，并保存在中继日志中。&lt;/li&gt;
&lt;li&gt;sql Thread：从中继日志中读取日志事件，在本地完成执行。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;从节点需要建立二进制日志文件吗？
视情况而定，如果从节点需要作为其他节点的主节点时，是需要开启二进制日志文件的，这种情况称之为级联复制。如果只是作为从节点，则不需要建立二进制文件。&lt;/p&gt;
&lt;h3 id=&#34;mysql-复制特点&#34;&gt;MySQL 复制特点&lt;/h3&gt;
&lt;p&gt;1、复制异步：主节点中一个用户请求一个写操作时，主节点不需要把写的数据在本地操作完成，并同时发送给从服务器并等待从服务器反馈写入完成，再响应用户。但是，从节点中的数据有可能会落后于主节点，可以使用一些软件来检查是否落后。&lt;/p&gt;
&lt;p&gt;2、主从数据不一致。&lt;/p&gt;
&lt;h3 id=&#34;主从复制配置过程&#34;&gt;主从复制配置过程&lt;/h3&gt;
&lt;h4 id=&#34;主节点-1&#34;&gt;主节点&lt;/h4&gt;
&lt;p&gt;1、启用二进制日志。&lt;/p&gt;
&lt;p&gt;2、为当前节点设置一个全局唯一的 server_id。&lt;/p&gt;
&lt;p&gt;3、创建具有复制权限的用户账号：replication slave，replication client。&lt;/p&gt;
&lt;h4 id=&#34;从节点-1&#34;&gt;从节点&lt;/h4&gt;
&lt;p&gt;1、启动中继日志。&lt;/p&gt;
&lt;p&gt;2、为当前节点设置一个全局唯一的 server_id。&lt;/p&gt;
&lt;p&gt;3、使用具有复制权限的用户账号连接至主节点，并启动复制线程。&lt;/p&gt;
&lt;h4 id=&#34;主节点配置&#34;&gt;主节点配置&lt;/h4&gt;
&lt;p&gt;1、启用二进制日志文件，在 /etc/my.cnf 中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[mysqld]
log-bin=mysql-bin
server-id=1
innodb-file-per-table=ON
skip_name_resolve=ON
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 mysqld 服务。&lt;/p&gt;
&lt;p&gt;2、查看二进制日志是否开启&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show global variables like &amp;#39;%log%&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-copy-1.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;3、查看主节点二进制日志列表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show master logs;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-copy-2.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;4、查看主节点的 server id&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show global variables like &amp;#39;%server%&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-copy-3.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;5、在主节点上创建具有复制权限的用户，并刷新权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;grant replication slave, replication client on &lt;span class=&#34;ge&#34;&gt;*.*&lt;/span&gt; to &amp;#39;replxdhuxc&amp;#39;@&amp;#39;%&amp;#39; identified by &amp;#39;Repl@163&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-copy-4.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;h4 id=&#34;从节点-2&#34;&gt;从节点&lt;/h4&gt;
&lt;p&gt;1、开启中继日志，在 /etc/my.cnf 中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;relay-log=relay-log
relay-log-index=relay-log.index
server-id=2
innodb_file_per_table=ON
skip_name_resolve=ON
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 mysqld 服务。&lt;/p&gt;
&lt;p&gt;2、查看中继日志是否开启&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show global variables like &amp;#39;%log%&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-copy-5.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;3、查看从节点 server 相关信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show global variables like &amp;#39;%server%&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-copy-6.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;4、在从节点配置访问主节点的参数信息，添加主节点主机、访问主节点的用户名和密码，主节点二进制文件信息。&lt;/p&gt;
&lt;p&gt;注意：主节点的二进制文件一定要是二进制列表中的最后一个二进制文件。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-to-slave-7.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;change master to master_host=&amp;#39;172.20.26.149&amp;#39;, master_user=&amp;#39;replxdhuxc&amp;#39;, master_password=&amp;#39;Repl@163&amp;#39;, master_log_file=&amp;#39;mysql-bin.000001&amp;#39;, master_log_pos=1076;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-to-slave-8.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;5、查看从节点的状态信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show slave status \G;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-to-slave-9.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;由于没有启动从节点的复制线程，I/O 线程和 SQL 线程都为：No&lt;/p&gt;
&lt;p&gt;6、启动复制线程，并再次查看从节点状态信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; start slave;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;start slave&lt;/code&gt; 可以指定线程类型：IO_THREAD、SQL_THREAD，如果没有指定，则两个都启动。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-to-slave-10.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;到此，mysql 主从复制配置完成。&lt;/p&gt;
&lt;h4 id=&#34;测试&#34;&gt;测试&lt;/h4&gt;
&lt;p&gt;1、在主节点创建数据库 xdhuxc，并查看主节点二进制日志信息&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-to-slave-11.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;2、在从节点查看数据库 xdhuxc，并查找二进制日志信息&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-to-slave-12.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;h4 id=&#34;主从复制架构中应该注意的问题&#34;&gt;主从复制架构中应该注意的问题&lt;/h4&gt;
&lt;p&gt;从节点要设置某些限定使得它不能进行写操作，才能保证复制当中的数据一致。&lt;/p&gt;
&lt;p&gt;1、限制从服务器为只读，在从服务器上设置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;read_only=ON   # 设置从服务器为只读，但是此限制对拥有 super 权限的用户均无效。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;限制所有用户&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; flush tables with read lock;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、保证主从复制时的事务安全&lt;/p&gt;
&lt;p&gt;1）在主节点&lt;/p&gt;
&lt;p&gt;设置参数如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sync_binlog=1 # 当每进行1次事务提交之后，MySQL将进行一次fsync之类的磁盘同步指令来将binlog_cache中的数据强制写入磁盘。
innodb_flush_logs_at_trx_commit=ON # 在事务提交时，要将内存中跟事务相关的数据立即刷新到事务日志中去。
innodb_support_xa=ON # 分布式事务，基于它来做两段式提交功能
sync_master_info=1 # 每次给从节点 dump 一些事件信息之后，主节点的 master.info 信息会立即同步到到磁盘上，让从服务器中的 master.info 及时更新。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）在每个从节点上&lt;/p&gt;
&lt;p&gt;设置参数如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;skip_slave_start=ON # 跳过自动启动，使用手动启动。
sync_relay_log=1    # 每次 sync_relay_log 事件都会刷新到磁盘。 
sync_relay_log_info=1 # 每间隔多少事务刷新 relay-log.info，如果是table（innodb）设置无效，每个事务都会更新。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）其他
在从节点上，master.info 文件中记录着主节点的信息，包括master IP地址，账户名和密码，端口，复制位置等信息&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-to-slave-12.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;在从节点上，relay-log.info 文件中记录着从节点将来到主节点的哪一个二进制文件中的哪一个位置复制日志，及保存到本地哪一个中继日志的哪一个位置。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/storage/mysql/mysql-master-to-slave-13.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>calico 架构和网络通信模型介绍</title>
                <link>https://xdhuxc.github.io/posts/mixed/calico/calico-theory-and-architecture/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/calico/calico-theory-and-architecture/</guid>
                <pubDate>Thu, 20 Dec 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 calico 的架构和网络通信模型。&lt;/p&gt;
&lt;h3 id=&#34;calico-介绍&#34;&gt;calico 介绍&lt;/h3&gt;
&lt;p&gt;Calico 是一个纯三层的数据中心网络方案，能够提供可控的虚拟机、容器、裸机之间的IP通信。&lt;/p&gt;
&lt;p&gt;通过将整个互联网的可扩展网络原则压缩到数据中心级别，calico在每一个计算节点利用Linux内核实现了一个高效的vRouter来负责数据转发，而每个vRouter通过BGP协议负责把自己上运行的workload的路由信息向整个calcio网络内广播。小规模部署时各计算节点可以直接互联，大规模部署时可通过指定的BGP route reflector来完成。
这样保证最终所有的workload之间的数据流量都是通过IP路由的方式完成互联的。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/mixed/calico/calico流量流程图.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图 1 · calico 流量流程
&lt;/center&gt;
&lt;p&gt;calico 节点组网可以直接利用数据中心的网络结构（无论是L2或者L3），不需要额外的NAT、隧道或者overlay网络&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/mixed/calico/calico封包图.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图 2 · calico 封包
&lt;/center&gt;
&lt;p&gt;如上图所示，这样保证这个方案的简单可控，而且没有封包解包，节约CPU计算资源的同时，提高了整个网络的性能。&lt;/p&gt;
&lt;p&gt;此外，calcio基于iptables还提供了丰富而灵活的网络策略，保证通过各个节点上的ACL2来提供计算节点的多租户隔离、安全组以及其他可达性限制等功能。&lt;/p&gt;
&lt;h3 id=&#34;calico-架构&#34;&gt;calico 架构&lt;/h3&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/mixed/calico/calico架构图.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图 3 · calico 架构
&lt;/center&gt;
&lt;ul&gt;
&lt;li&gt;Felix：是calico agent，运行在每台需要运行workload的节点上，主要负责配置路由及ACL2等信息来确保Endpoint的连通状态。&lt;/li&gt;
&lt;li&gt;etcd：分布式键值存储，主要负责网络元数据一致性，确保calico网络状态的准确性。&lt;/li&gt;
&lt;li&gt;BGP Client（BIRD）：主要负责把 Felix 写入 Linux 内核的路由信息分发到当前calico网络，确保workload间通信的有效性。&lt;/li&gt;
&lt;li&gt;BGP Route Reflector（BIRD）：大规模部署时使用，摒弃所有节点互联的网格模式，通过一个或者多个BGP Route Reflector来完成集中式的路由分发。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;calico-网络通信模型&#34;&gt;calico 网络通信模型&lt;/h3&gt;
&lt;p&gt;在主机网络拓扑的组织上，calcio是在主机上启动虚拟机路由器，将每个主机作为路由器使用，组成互联互通的网络拓扑。&lt;/p&gt;
&lt;p&gt;每个主机上都部署了 calico node 作为虚拟路由器，并且可以通过 calico 将宿主机组织成任意的拓扑集群。当集群中的容器需要与外界通信时，就可以通过BGP协议将网关物理路由器加入到集群中，使外界可以直接访问容器IP，而不需要做任何NAT之类的复杂操作。
当容器通过 calico 进行跨主机通信时，其网络通信模型如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/mixed/calico/calico网络通信模型.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图 4 · calico 网络通信模型
&lt;/center&gt;
&lt;p&gt;从上图可以看出，当创建容器时，calcio 为容器生成 veth pair，一端作为容器网卡加入到容器的网络命名空间，并设置IP地址和子网掩码，一端直接暴露在宿主机上，并通过设置路由规则，将容器IP暴露到宿主机的通信路由上。与此同时，calico为每个主机分配了一段子网作为容器可分配的IP范围，这样就可以根据子网的CIDR为每个主机生成比较固定的路由规则。&lt;/p&gt;
&lt;p&gt;当容器需要跨主机通信时，主要经过以下步骤：&lt;/p&gt;
&lt;p&gt;1）容器流量通过 veth pair 到达宿主机的网络命名空间上。&lt;/p&gt;
&lt;p&gt;2）根据容器要访问的 IP 所在的子网 CIDR 和主机上的路由规则，找到下一跳要到达的宿主机 IP。&lt;/p&gt;
&lt;p&gt;3）流量到达下一跳的宿主机后，根据当前宿主机上的路由规则，直接到达对端容器的 veth pair 插在宿主机的一端，最终进入容器。&lt;/p&gt;
&lt;p&gt;从上面的通信过程来看，跨主机通信时，整个通信路径完全没有使用 NAT 或者 UDP 封装，性能上的损耗确实比较低。&lt;/p&gt;
&lt;p&gt;由于calcio的通信机制是完全基于三层的，这种机制也带来了一些缺陷，例如：&lt;/p&gt;
&lt;p&gt;1）calcio 目前只支持 TCP、UDP、ICMP、ICMPv6协议，如果使用其他四层协议（例如NetBIOS协议），建议使用weave、原生overlay等其他overlay网络实现。&lt;/p&gt;
&lt;p&gt;2）基于三层实现通信，在二层上没有任何加密包装，因此只能在私有的可靠网络上使用。&lt;/p&gt;
&lt;p&gt;3）流量隔离基于iptables实现，并且从etcd中获取需要生成的隔离规则，有一些性能上的隐患。&lt;/p&gt;
&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;1、部署 calcio workload 的各节点机的 hostname 最好全部不同，否则会导致写入 etcd 的数据发生覆盖，但是可以通过在启动 calcio node 时，指明 calico node 的名称来避免。&lt;/p&gt;
&lt;p&gt;2、calcio workload 的各节点机的 eth0 网卡的 IP 段和 calcio 的网段必须不同，可通过修改 calcio 网段解决。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.goodrain.com/docs/stable/operation-manual/network/calico.html#calico&#34;&gt;https://www.goodrain.com/docs/stable/operation-manual/network/calico.html#calico&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.51cto.com/dengaosky/2069666&#34;&gt;http://blog.51cto.com/dengaosky/2069666&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/calico/">calico</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>虚拟机的几种网络连接方式</title>
                <link>https://xdhuxc.github.io/posts/mixed/virtual-machine-network-mode/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/virtual-machine-network-mode/</guid>
                <pubDate>Sun, 09 Dec 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了使用 &lt;code&gt;Virtual Box&lt;/code&gt; 或 &lt;code&gt;VMware Work station&lt;/code&gt; 创建虚拟机时的网络连接方式。&lt;/p&gt;
&lt;p&gt;VirtualBox中有四种网络连接方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NAT 网络地址转换模式&lt;/li&gt;
&lt;li&gt;Bridged Adapter 桥接模式&lt;/li&gt;
&lt;li&gt;Intenal 内部网络模式&lt;/li&gt;
&lt;li&gt;Host-Only Adapter 主机模式&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;VMWare 中有五种网络连接方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NAT 模式&lt;/li&gt;
&lt;li&gt;桥接模式&lt;/li&gt;
&lt;li&gt;仅主机模式&lt;/li&gt;
&lt;li&gt;自定义（特定虚拟网络）&lt;/li&gt;
&lt;li&gt;LAN区段&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;不同的虚拟交换机应用在不同的联网模式下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;VMnet0：这是VMware用于虚拟桥接网络下的虚拟交换机；&lt;/li&gt;
&lt;li&gt;VMnet1：这是VMware用于虚拟Host-Only网络下的虚拟交换机；&lt;/li&gt;
&lt;li&gt;VMnet8：这是VMware用于虚拟NAT网络下的虚拟交换机；&lt;/li&gt;
&lt;li&gt;VMnet2~VMnet7及VMnet9：是VMware用于虚拟自定义custom网络下的虚拟交换机；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;VirtualBox中四种网络连接方式之间的区别：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;方向&lt;/th&gt;
&lt;th&gt;NAT&lt;/th&gt;
&lt;th&gt;Bridged Adapter&lt;/th&gt;
&lt;th&gt;Internal&lt;/th&gt;
&lt;th&gt;Host-only Adapter&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;虚拟机-&amp;gt;主机&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;默认不能，需配置&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;主机-&amp;gt;虚拟机&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;默认不能，需配置&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;虚拟机-&amp;gt;其他主机&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;默认不能，需配置&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;其他主机-&amp;gt;虚拟机&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;默认不能，需配置&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;虚拟机之间&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;同网络名下可以&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/carolzhang8406/article/details/19042569&#34;&gt;https://blog.csdn.net/carolzhang8406/article/details/19042569&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/virtualbox/">VirtualBox</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vmware/">VMware</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 GTID 的 MySQL 主从复制</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-master-slave-gtid/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-master-slave-gtid/</guid>
                <pubDate>Fri, 07 Dec 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了基于 GTID 的 MySQL 主从复制的过程，留作后查。&lt;/p&gt;
&lt;h3 id=&#34;配置-gtid-主从复制&#34;&gt;配置 GTID 主从复制&lt;/h3&gt;
&lt;p&gt;使用 docker 方式部署 MySQL 主从节点&lt;/p&gt;
&lt;p&gt;1、创建如下目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cd /data
mkdir mysql/master mysql/slave
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;master-配置&#34;&gt;master 配置&lt;/h4&gt;
&lt;p&gt;在 /data/mysql/master 目录下创建文件 mysql.cnf:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[mysqld]
&lt;span class=&#34;gu&#34;&gt;############# basic settings #############
&lt;/span&gt;&lt;span class=&#34;gu&#34;&gt;&lt;/span&gt;server_id = 1
port = 3307
bind_address = 0.0.0.0
max_binlog_size = 100M

&lt;span class=&#34;gu&#34;&gt;############# log settings #############
&lt;/span&gt;&lt;span class=&#34;gu&#34;&gt;&lt;/span&gt;log_bin = ON
expire_logs_days = 30
binlog_format = row
sync_binlog = 1
binlog_rows_query_log_events = 1

&lt;span class=&#34;gu&#34;&gt;############# replication #############
&lt;/span&gt;&lt;span class=&#34;gu&#34;&gt;&lt;/span&gt;gtid_mode = ON
enforce_gtid_consistency = ON
log_slave_updates = ON
master_info_repository = table
relay_log_info_repository = table
slave_parallel_workers = 1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 MySQL 5.6 版本时，基于 GTID 的复制中 log-slave-updates 选项是必须的，但是其增大了从服务器的 IO 负载，而在 MySQL 5.7 中该选项已经不是必须项。&lt;/p&gt;
&lt;p&gt;mysql master 容器启动命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --restart=always \
    --name=mysql-master \
    -p 3307:3307 \
    -v /data/mysql/master/mysql.cnf:/etc/mysql/conf.d/mysql.cnf \
    -v /data/mysql/master/data:/var/lib/mysql \
    -e MYSQL_ROOT_PASSWORD=1qaz1QAZ \
    mysql:5.7.24
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动之后进入容器查看效果：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show global variables like &amp;#34;%gtid%&amp;#34;;
+----------------------------------+-------+
| Variable_name                    | Value |
+----------------------------------+-------+
| binlog_gtid_simple_recovery      | ON    |
| enforce_gtid_consistency         | ON    |
| gtid_executed                    |       |
| gtid_executed_compression_period | 1000  |
| gtid_mode                        | ON    |
| gtid_owned                       |       |
| gtid_purged                      |       |
| session_track_gtids              | OFF   |
+----------------------------------+-------+
8 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到，GTID 模式已经开启了。&lt;/p&gt;
&lt;p&gt;创建复制用户&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;create user &amp;#39;xdhuxc&amp;#39;@&amp;#39;%&amp;#39; identified by &amp;#39;1qaz1QAZ&amp;#39;;
grant replication slave on &lt;span class=&#34;ge&#34;&gt;*.*&lt;/span&gt; to &amp;#39;xdhuxc&amp;#39;@&amp;#39;%&amp;#39;;
flush privileges;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;slave-配置&#34;&gt;slave 配置&lt;/h4&gt;
&lt;p&gt;在 /data/mysql/slave 目录下创建 mysql.cnf 文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[mysqld]
server_id = 3

gtid_mode = ON
enforce_gtid_consistency = ON
log_slave_updates = ON
read_only = ON
expire_logs_days = 30
max_binlog_size = 100M
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 mysql salve 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --restart=always \
    --name=mysql-slave \
    -p 3308:3306 \
    -v /data/mysql/slave/mysql.cnf:/etc/mysql/conf.d/mysql.cnf \
    -v /data/mysql/slave/data:/var/lib/mysql \
    -e MYSQL_ROOT_PASSWORD=1qaz1QAZ \
    mysql:5.7.24
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;slave 连接至 master&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;change master to master_host=&amp;#39;172.27.126.226&amp;#39;, master_port=3307, master_user=&amp;#39;xdhuxc&amp;#39;, master_password=&amp;#39;1qaz1QAZ&amp;#39;, master_auto_position=1;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动复制线程&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;start slave;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;验证主从复制&#34;&gt;验证主从复制&lt;/h4&gt;
&lt;p&gt;1、在 mysql-master 容器内&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show slave hosts;
+-----------+------+------+-----------+--------------------------------------+
| Server_id | Host | Port | Master_id | Slave_UUID                           |
+-----------+------+------+-----------+--------------------------------------+
|         3 |      | 3306 |         1 | ab2050d7-1244-11e9-bfa7-0242ac110005 |
+-----------+------+------+-----------+--------------------------------------+
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在 mysql-slave 容器内&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show slave status \G
&lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;************************* 1. row &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;*************************
               Slave_IO_State: Waiting for master to send event
                  Master_Host: 172.27.126.226
                  Master_User: xdhuxc
                  Master_Port: 3307
                Connect_Retry: 60
              Master_Log_File: ON.000004
          Read_Master_Log_Pos: 791
               Relay_Log_File: c81fccb3bd9c-relay-bin.000004
                Relay_Log_Pos: 990
        Relay_Master_Log_File: ON.000004
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: 0
                   Last_Error:
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 791
              Relay_Log_Space: 1443
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: 0
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 0
                Last_IO_Error:
               Last_SQL_Errno: 0
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: 1
                  Master_UUID: d1623ded-124a-11e9-b46d-0242ac110004
             Master_Info_File: /var/lib/mysql/master.info
                    SQL_Delay: 0
          SQL_Remaining_Delay: NULL
      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates
           Master_Retry_Count: 86400
                  Master_Bind:
      Last_IO_Error_Timestamp:
     Last_SQL_Error_Timestamp:
               Master_SSL_Crl:
           Master_SSL_Crlpath:
           Retrieved_Gtid_Set: d1623ded-124a-11e9-b46d-0242ac110004:1-8
            Executed_Gtid_Set: d1623ded-124a-11e9-b46d-0242ac110004:1-8
                Auto_Position: 1
         Replicate_Rewrite_DB:
                 Channel_Name:
           Master_TLS_Version:
1 row in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到 IO 和 SQL 线程的状态都为：YES，Retrieved_Gtid_Set 接收了 8 个事务，Executed_Gtid_Set 执行了 8 个事务。&lt;/p&gt;
&lt;p&gt;在 mysql-master 容器中创建数据库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; create database blog;
Query OK, 1 row affected (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;create table &lt;span class=&#34;sb&#34;&gt;`test`&lt;/span&gt; (
    &lt;span class=&#34;sb&#34;&gt;`id`&lt;/span&gt; int(11),
    &lt;span class=&#34;sb&#34;&gt;`name`&lt;/span&gt; varchar(32),
);
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 mysql-slave 中查看&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| blog               |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.00 sec)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hi-linux.com/posts/47176.html&#34;&gt;https://www.hi-linux.com/posts/47176.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.ywnds.com/?p=3898&#34;&gt;http://www.ywnds.com/?p=3898&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>BIND 的安装和配置</title>
                <link>https://xdhuxc.github.io/posts/common/dns/dns-bind/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/common/dns/dns-bind/</guid>
                <pubDate>Sun, 02 Dec 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下 Bind 的安装和配置，以备后查。&lt;/p&gt;
&lt;h3 id=&#34;bind&#34;&gt;BIND&lt;/h3&gt;
&lt;p&gt;BIND 是 Berkeley Internet Name Domain 的首字母简写，是一款开源的 DNS 软件，可以使用 BIND 在内网中部署自己的 DNS。&lt;/p&gt;
&lt;h4 id=&#34;安装部署&#34;&gt;安装部署&lt;/h4&gt;
&lt;p&gt;1、使用如下命令安装 BIND&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y bind 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动 BIND&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart named
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;配置&#34;&gt;配置&lt;/h4&gt;
&lt;p&gt;bind 的主配置文件位置：&lt;code&gt;/etc/named.conf&lt;/code&gt;，内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;//
// named.conf
//
// Provided by Red Hat bind package to configure the ISC BIND named(8) DNS
// server as a caching only nameserver (as a localhost DNS resolver only).
//
// See /usr/share/doc/bind*/sample/ for example named configuration files.
//
// See the BIND Administrator&amp;#39;s Reference Manual (ARM) for details about the
// configuration located in /usr/share/doc/bind-{version}/Bv9ARM.html

options {
	listen-on port 53 { 127.0.0.1; };
	listen-on-v6 port 53 { ::1; };
	directory 	&amp;#34;/var/named&amp;#34;;
	dump-file 	&amp;#34;/var/named/data/cache_dump.db&amp;#34;;
	statistics-file &amp;#34;/var/named/data/named_stats.txt&amp;#34;;
	memstatistics-file &amp;#34;/var/named/data/named_mem_stats.txt&amp;#34;;
	allow-query     { localhost; };

	/* 
	 &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; If you are building an AUTHORITATIVE DNS server, do NOT enable recursion.
	 &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; If you are building a RECURSIVE (caching) DNS server, you need to enable 
	   recursion. 
	 &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; If your recursive DNS server has a public IP address, you MUST enable access 
	   control to limit queries to your legitimate users. Failing to do so will
	   cause your server to become part of large scale DNS amplification 
	   attacks. Implementing BCP38 within your network would greatly
	   reduce such attack surface 
	*/
	recursion yes;

	dnssec-enable yes;
	dnssec-validation yes;

	/* Path to ISC DLV key */
	bindkeys-file &amp;#34;/etc/named.iscdlv.key&amp;#34;;

	managed-keys-directory &amp;#34;/var/named/dynamic&amp;#34;;

	pid-file &amp;#34;/run/named/named.pid&amp;#34;;
	session-keyfile &amp;#34;/run/named/session.key&amp;#34;;
};

logging {
        channel default_debug {
                file &amp;#34;data/named.run&amp;#34;;
                severity dynamic;
        };
};

zone &amp;#34;.&amp;#34; IN {
	type hint;
	file &amp;#34;named.ca&amp;#34;;
};

include &amp;#34;/etc/named.rfc1912.zones&amp;#34;;
include &amp;#34;/etc/named.root.key&amp;#34;;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;选项含义：&lt;/p&gt;
&lt;p&gt;全局配置段：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;options {
    # 在启动 DNS 服务时，named 进程所监听的套接字
    listen-on port 53 {127.0.0.1; 10.10.24.32;};
    
    # 定义解析库（区域数据库文件）的根目录，在主配置文件中添加此配置语句之后，可以在后面定义区域数据库时使用相对路径
    directory &amp;#34;/var/named&amp;#34;;
    
    # 访问控制语句，意思是允许本服务器处理那些主机发送来的解析查询请求，默认是localhost，即只允许本机以127.0.0.1发送查询请求
    allow-query {localhost};
    
    # 允许本服务器为所有查询请求做递归查询
    recursion yes;
    
    # 访问控制指令，允许这些客户端做递归查询
    allow-recursion {172.16.1.74/16;};
    
    # 定义存放主进程 pid 文件的路径
    pid-file &amp;#34;/run/named/named.pid&amp;#34;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;区域配置段：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 声明一个区域名称，此名称要使用 FQDN 来表示，例如 xdhuxc.com
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;zone &amp;#34;FQDN&amp;#34; IN {
    # 区域的类型
    type master;   # 主区域
    type slave;    # 辅助区域
    type hint;     # 提示区域，仅能在根域上设置
    type forward;  # 转发区域 
    
    # 存放于该域有关的解析信息的数据库文件的路径；如果是相对路径，则相对于在主配置文件的全局配置端中的 “directory” 指令所定义的目录而言。
    # 注意：文件的所有权和权限设置必须能够让 named 用户有读取权限。
    file &amp;#34;named.localhost&amp;#34;;
    
    # 访问控制指令，允许这些客户端对数据库内容进行动态更新，主要用于 DDNS
    allow-update {none;};
    
    # 访问控制指令，允许这些主机能够从当前服务器进行区域传送 
    allow-transfer {172.16.0.0/16;};
    
    # 访问控制指令，允许这些客户端做递归查询 
    allow-recursion {172.16.1.74/16;};
    
    # 访问控制指令，允许这些主机进行区域内的解析查询 
    allow-query { address_match_element;...};
    
    # 访问控制指令，允许这些主机向当前服务器发送区域变更通知 
    allow-update { address_match_element;...};
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在修改完 bind 的配置文件之后，需要使用 named-checkconf 来检测文件的书写格式是否正确。&lt;/p&gt;
&lt;p&gt;在检测完后，配置文件的内容并不会立即生效，因此我们需要重新读取 named 程序，可以使用 systemctl 命令，也可以使用 rndc reload 来读取。&lt;/p&gt;
&lt;p&gt;区域配置文件示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;zone &amp;#34;FQDN&amp;#34; IN {
    type master;
    file &amp;#34;FQDN.zone&amp;#34;;
    allow-update {none;};
    allow-transfer {none;};
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当区域配置文件配置完成之后，我们需要在其数据库 /var/named/named.localhost 中添加记录，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$TTL 1D
@	IN SOA	@ rname.invalid. (
					0	    ; serial
					1D	    ; refresh
					1H	    ; retry
					1W	    ; expire
					3H )	; minimum
	NS	@
	A	127.0.0.1
	AAAA	::1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在数据库中，有各种记录书写的格式，简要介绍各种记录的书写格式：&lt;/p&gt;
&lt;h5 id=&#34;soa&#34;&gt;SOA&lt;/h5&gt;
&lt;p&gt;DN|FQDN：当前域的域名，例如 xdhuxc.com，或者使用 @ 代替域名，@ 符号会使用主配置文件中定义的域名来代替
VALUE：由以下几个部分组成：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当前域中的主域名服务器的 FQDN&lt;/li&gt;
&lt;li&gt;当前域的数据库管理员的邮箱地址，需要使用 . 来替代 @ ：root.xdhuxc.com&lt;/li&gt;
&lt;li&gt;主域名服务器进行区域传送的相关时间参数的定义：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;(Serial Refresh Retry Expeir TTL)
（
    Serial;
    Refresh;
    Retry;
    Expeir;
    TTL;
）
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;ns-记录&#34;&gt;NS 记录&lt;/h5&gt;
&lt;p&gt;name：当前域的域名，可以写完全合格域名 FQDN，可以写 @ 占位，还可以省略不写，如果省略不写，则意味着该资源记录的名称与其上一条资源记录的名称相同。
value：当前区域内被授权的域名服务器的 FQDN。&lt;/p&gt;
&lt;p&gt;注意：
1、一个域中有多少台域名服务器，就需要写多少个 NS 资源记录。&lt;/p&gt;
&lt;p&gt;2、每个 NS 资源记录都必须要有一个 A 记录与之对应。&lt;/p&gt;
&lt;h5 id=&#34;mx-记录&#34;&gt;MX 记录&lt;/h5&gt;
&lt;p&gt;name：当前域的域名，可以写完全合格域名 FQDN，可以写 @ 占位，还可以省略不写，如果省略不写，则意味着该资源记录的名称与其上一条资源记录的名称相同。
RR_TYPE：MS Priority
value：当前域中有效的邮件服务器的 FQDN。&lt;/p&gt;
&lt;p&gt;注意：
1、一个域中，可以有多条 MX 资源记录，通过优先级的大小决定被使用的次序。&lt;/p&gt;
&lt;p&gt;2、每个 MX 资源记录都必须对应一条 A 记录。&lt;/p&gt;
&lt;h5 id=&#34;a-记录&#34;&gt;A 记录&lt;/h5&gt;
&lt;p&gt;name：域中指定主机的 FQDN。
value：该主机上真实有效的 IPV4 地址。&lt;/p&gt;
&lt;p&gt;例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;www.xdhuxc.com 43200 IN A 192.168.1.1
www            43200 IN A 192.168.1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;泛域名：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;*.xdhuxc.com 43200 IN A 192.168.1.1
&lt;span class=&#34;k&#34;&gt;*&lt;/span&gt;            43200 IN A 192.168.1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;直接域名解析：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;xdhuxc.com 43200 IN A 192.168.1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;通常，泛域名或直接域名都是为了防止用户写错域名而导致无法给出正确的解析结果。&lt;/p&gt;
&lt;h5 id=&#34;cname-记录&#34;&gt;CNAME 记录&lt;/h5&gt;
&lt;p&gt;name：域中指定主机的别名。
value：真正的主机的 FQDN。&lt;/p&gt;
&lt;p&gt;例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ftp.xdhuxc.com [86400] IN CNAME www.xdhuxc.com
ftp [86400] IN CNAME www
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;ptr-记录&#34;&gt;PTR 记录：&lt;/h5&gt;
&lt;p&gt;name：
将 IP 地址的四个八位组反过来，将 IP 地址中的主机部分加上反向域的域名后缀&lt;/p&gt;
&lt;p&gt;如果 IP 地址是：172.16.1.100/16，其对应的域名的写法为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;100.1 IN PTR www.xdhuxc.com 
100.1.16.172.in-addr.arpa. IN PTR www.xdhuxc.com 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;参考资料&#34;&gt;参考资料&lt;/h4&gt;
&lt;p&gt;1、queryperf 性能测试工具&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/zhu_tianwei/article/details/45202899&#34;&gt;https://blog.csdn.net/zhu_tianwei/article/details/45202899&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2、BIND 配置文件详解&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.51cto.com/liujingyu/2102858&#34;&gt;http://blog.51cto.com/liujingyu/2102858&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/dns/">DNS</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/bind/">Bind</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/dns/">DNS</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>一些计算机科学和技术中的概念区分</title>
                <link>https://xdhuxc.github.io/posts/common/common-knowledge/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/common/common-knowledge/</guid>
                <pubDate>Sun, 02 Dec 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了些计算机科学和技术中常见的概念的差别，属于基础知识。&lt;/p&gt;
&lt;h3 id=&#34;uriurl和urn的区别&#34;&gt;URI，URL和URN的区别&lt;/h3&gt;
&lt;p&gt;1）URI&lt;/p&gt;
&lt;p&gt;URI 是 uniform resource identifier 的首字母大写，即统一资源标识符，用来唯一地标识一个资源。&lt;/p&gt;
&lt;p&gt;2）URL&lt;/p&gt;
&lt;p&gt;URL 是 uniform resource locator 的首字母大写，即统一资源定位符，是一种具体的 URI，即 URL 不仅可以用来标识一个资源，还指明了如何获取这个资源。&lt;/p&gt;
&lt;p&gt;3）URN&lt;/p&gt;
&lt;p&gt;URN 是 uniform resource name 的首字母大写，即统一资源命名，是通过名字来标识资源，比如mailto:java-net@java.sun.com。&lt;/p&gt;
&lt;p&gt;也就是说，URI 是以一种抽象的、高层次概念定义统一资源标识，而URL和URN则是具体的资源标识方式，URL 和 URN 都是一种 URI。&lt;/p&gt;
&lt;p&gt;在 Java 的 URI 中，一个 URI 实例可以代表绝对的，也可以是相对的，只要其符合 URI 的语法规则。&lt;/p&gt;
&lt;p&gt;而 URL 类则不仅符合语义，还包含了定位该资源的信息，因此它不能是相对的，schema 必须被指定。&lt;/p&gt;
&lt;h3 id=&#34;web-服务器和应用服务器&#34;&gt;Web 服务器和应用服务器&lt;/h3&gt;
&lt;p&gt;1）Web服务器&lt;/p&gt;
&lt;p&gt;Web服务器的基本功能就是提供Web信息浏览服务。它只需支持HTTP协议、HTML文档格式及URL，与客户端的网络浏览器配合，只能发送静态页面的内容。因为Web服务器主要支持的协议就是HTTP，所以通常情况下HTTP服务器和WEB服务器是相等的。Web服务器包括Nginx，Apache，IIS等&lt;/p&gt;
&lt;p&gt;2）应用服务器&lt;/p&gt;
&lt;p&gt;应用程序服务器让多个用户可以同时使用应用程序，通常是客户创建的应用程序。应用服务器包括WebLogic，JBoss，Tomcat，websphere等。&lt;/p&gt;
&lt;h3 id=&#34;127001-和-localhost&#34;&gt;127.0.0.1 和 localhost&lt;/h3&gt;
&lt;p&gt;1、含义不同：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;localhost&lt;/code&gt; 也叫 &lt;code&gt;local&lt;/code&gt; ，是一个域名，可以调用 gethostname() 解析出对应的 IP 地址，其值为：&lt;code&gt;hosts&lt;/code&gt; 文件中的值，正确的解释是: 本地服务器&lt;/li&gt;
&lt;li&gt;&lt;code&gt;127.0.0.1&lt;/code&gt;，是一个 IPv4 的地址， 在 &lt;code&gt;windows&lt;/code&gt; 等系统的正确解释是: 本机地址(本机服务器)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、与防火墙和网卡的关系&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;localhost&lt;/code&gt; 是不经网卡传输！这点很重要，它不受网络防火墙和网卡相关的的限制。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;127.0.0.1&lt;/code&gt; 是通过网卡传输，依赖网卡，并受到网络防火墙和网卡相关的限制。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;用户态和内核态&#34;&gt;用户态和内核态&lt;/h3&gt;
&lt;p&gt;操作系统需要两种CPU状态：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;内核态（Kernel Mode）：运行操作系统程序。&lt;/li&gt;
&lt;li&gt;用户态（User Mode）：运行用户程序。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;指令划分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;特权指令：只能由操作系统使用，用户程序不能使用的指令。例如，启动I/O，内存清零，修改程序状态字，设置时钟，允许/禁止终端，停机。&lt;/li&gt;
&lt;li&gt;非特权指令：用户程序可以使用的指令，例如，控制转移，算术运算，取数指令，访管指令（使用户程序从用户态进入内核态）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;特权级别：&lt;/p&gt;
&lt;p&gt;特权环：R0，R1，R2，R3。&lt;/p&gt;
&lt;p&gt;R0相当于内核态，R3相当于用户态。&lt;/p&gt;
&lt;p&gt;不同级别能够运行不同的指令集合。&lt;/p&gt;
&lt;p&gt;CPU 状态之间的转换：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用户态 ——&amp;gt; 内核态：唯一途径是通过中断、异常、陷入机制（访管指令）&lt;/li&gt;
&lt;li&gt;内核态 ——&amp;gt; 用户态：设置程序状态字PSW。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;内核态与用户态的区别：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;内核态与用户态是操作系统的两种运行级别，当程序运行在3级特权级上之时，就可以称之为运行在用户态。因为这是最低特权级，是普通的用户进程运行的特权级，大部分用户直接面对的程序都是运行在用户态。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;当程序运行在0级特权级上时，就可以称之为运行在内核态。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;运行在用户态下的程序不能直接访问操作系统内核数据结构和程序。当我们在系统中执行一个程序时，大部分时间是运行在用户态下的，在其需要操作系统帮助完成某些它没有权力和能力完成的工作时就会切换到内核态。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;这两种状态的主要差别是：
1、处于用户态执行时，进程所能访问的内存空间和对象受到限制，其所处于占有的处理机是可以被抢占的。&lt;/p&gt;
&lt;p&gt;2、处于内核态执行中的进程，则能访问所有的内存空间和对象，且所占有的处理机是不允许被抢占的。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;通常来说，以下三种情况会导致用户态到内核态的切换：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;系统调用，这是用户态进程主动请求切换到内核态的一种方式，用户态进程通过系统调用申请使用操作系统提供的服务程序完成工作。比如，fork() 函数实际上就是执行了一个创建新进程的系统调用。而系统调用的机制其核心还是使用了操作系统为用户特别开放的一个中断来实现，例如 Linux 的 int 80h 中断。&lt;/li&gt;
&lt;li&gt;异常，当 CPU 在执行运行在用户态下的程序时，发生了某些事先不可知的异常，这时会触发由当前运行进程切换到处理此异常的内核相关程序中，也就转到了内核态，比如缺页异常。&lt;/li&gt;
&lt;li&gt;外围设备的中断，当外围设备完成用户请求的操作后，会向 CPU 发出相应的中断信号，这时CPU会暂停执行下一条即将要执行的指令，转而去执行与中断信号对应的处理程序。如果先前执行的指令是用户态下的程序，那么这个转换的过程自然也就发生了由用户态到内核态的切换。比如硬盘读写操作完成，系统会切换到硬盘读写的中断处理程序中执行后续操作等。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这三种方式是系统在运行时由用户态转到内核态的最主要方式，其中系统调用可以认为是用户进程主动发起的，异常和外围设备中断则是被动的。&lt;/p&gt;
&lt;h3 id=&#34;进程与线程&#34;&gt;进程与线程&lt;/h3&gt;
&lt;h4 id=&#34;定义&#34;&gt;定义&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;进程：具有一定独立功能的程序关于某个数据集合上的一次执行活动，是系统进行资源分配和调度的一个独立单位。&lt;/li&gt;
&lt;li&gt;线程：是进程的一个实体，是CPU调度和分派的基本单位，是比进程更小的能独立运行的基本单位。线程本身基本上不拥有系统资源，只拥有一点在运行中必不可少的资源（例如，程序计数器、一组寄存器和栈等），但是它可以与同属于一个进程的其他线程共享进程所拥有的全部资源。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;关系&#34;&gt;关系&lt;/h4&gt;
&lt;p&gt;一个进程可以创建和撤销一个线程；同一个进程中的多个线程之间可以并发执行。&lt;/p&gt;
&lt;p&gt;相对于进程而言，线程是一个更加接近于执行体的概念，可以与同进程中的其他线程共享全局变量、静态变量等数据，但拥有自己的栈空间，拥有独立的执行序列。&lt;/p&gt;
&lt;h4 id=&#34;区别&#34;&gt;区别&lt;/h4&gt;
&lt;p&gt;进程和线程的主要差别在于它们是不同的操作系统资源管理方式。&lt;/p&gt;
&lt;p&gt;进程有独立的地址空间，一个进程崩溃后，在保护模式下不会对其它进程产生影响；而线程只是一个进程中的不同执行路径。&lt;/p&gt;
&lt;p&gt;线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，资源耗费较大，效率要差一些。&lt;/p&gt;
&lt;p&gt;但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。&lt;/p&gt;
&lt;p&gt;总结：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一个程序至少有一个进程，一个进程至少有一个线程。&lt;/li&gt;
&lt;li&gt;线程的划分尺度小于进程，使得多线程程序的并发性高。&lt;/li&gt;
&lt;li&gt;进程在执行过程中拥有独立的内存单元，而同一个进程中的多个线程共享内存，从而极大地提高了程序的运行效率。&lt;/li&gt;
&lt;li&gt;线程在执行过程中与进程还是有区别的。每个独立的线程有一个程序运行的入口、顺序执行序列和程序的出口，但是线程不能够独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制。&lt;/li&gt;
&lt;li&gt;从逻辑角度来看，多线程的意义在于在一个应用程序中，有多个执行部分可以并发执行。但是操作系统并没有将多个线程看做多个独立的应用来实现进程的调度和管理以及资源分配，这是进程和线程的重要区别。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;优缺点&#34;&gt;优缺点&lt;/h4&gt;
&lt;p&gt;线程和进程在使用上各有优缺点：
线程执行开销小，但不利于资源的管理和保护；而进程则正好相反。
另外，线程适合于在SMP机器上运行，而进程则可以跨机器迁移。&lt;/p&gt;
&lt;h3 id=&#34;ab-测试&#34;&gt;AB 测试&lt;/h3&gt;
&lt;p&gt;AB测试是为Web或App界面或流程制作A/B两个版本，在同一时间维度，分别让组成成分相同（相似）的访客群组随机的访问这些版本，收集各群组的用户体验数据和业务数据，最后分析评估出最好版本正式采用。&lt;/p&gt;
&lt;p&gt;在App和Web开发阶段，程序中添加用于制作A/B版本和采集数据的代码由此引起的开发和QA的工作量很大，ROI（return on investment）很低。AB测试的场景受到限制，App和Web发布后，无法再增加和更改AB测试场景。额外的A/B测试代码，增加了App和Web后期维护成本。&lt;/p&gt;
&lt;h3 id=&#34;持续集成持续部署持续交付&#34;&gt;持续集成/持续部署/持续交付&lt;/h3&gt;
&lt;p&gt;持续集成是指软件个人研发的部分向软件整体部分交付，频繁进行集成以便更快地发现其中的错误。&lt;/p&gt;
&lt;p&gt;持续部署是指当交付的代码通过评审之后，自动部署到生产环境，这意味着所有通过了一系列的自动化测试的改动都将自动部署到生产环境。&lt;/p&gt;
&lt;p&gt;持续交付涵盖了软件交付端到端的整个周期，其覆盖面不仅仅包括编码，还包括：设计、测试、部署、运维、运营等等。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/java/">Java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Maven 常用配置</title>
                <link>https://xdhuxc.github.io/posts/programming/java/java-maven-configuration/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/java/java-maven-configuration/</guid>
                <pubDate>Mon, 01 Jan 0001 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了使用 maven 时的一些常用的配置。&lt;/p&gt;
&lt;h3 id=&#34;配置-maven-仓库&#34;&gt;配置 maven 仓库&lt;/h3&gt;
&lt;p&gt;配置阿里云的 &lt;code&gt;maven&lt;/code&gt; 仓库，在 &lt;code&gt;windows&lt;/code&gt; 系统中，在 &lt;code&gt;apache-maven-3.5.2/conf/settings.xml&lt;/code&gt; 中配置如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mirrors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mirror&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;alimaven&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;aliyun maven&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mirrorOf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;central&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mirrorOf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;        
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mirror&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mirrors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者在 &lt;code&gt;pom.xml&lt;/code&gt; 的 &lt;code&gt;repositories&lt;/code&gt; 中添加如下配置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;repositories&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;repository&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;aliyunmaven&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;repository&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;repositories&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;properties-的配置&#34;&gt;Properties 的配置&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;project.build.sourceEncoding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;project.build.sourceEncoding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;project.reporting.outputEncoding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;project.reporting.outputEncoding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;java.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;java.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;设置-maven-工程使用的-java-版本&#34;&gt;设置 maven 工程使用的 Java 版本&lt;/h3&gt;
&lt;h4 id=&#34;全局配置&#34;&gt;全局配置&lt;/h4&gt;
&lt;p&gt;在 &lt;code&gt;maven&lt;/code&gt; 的安装目录下，&lt;code&gt;apache-maven-3.5.2/conf&lt;/code&gt; 目录下的 &lt;code&gt;settings.xml&lt;/code&gt; 文件中，在 &lt;code&gt;&amp;lt;profiles&amp;gt;&amp;lt;/profiles&amp;gt;&lt;/code&gt; 之间添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;jdk18&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activeByDefault&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activeByDefault&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;jdk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;jdk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maven.compiler.source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maven.compiler.source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maven.compiler.target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maven.compiler.target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maven.compiler.compilerVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maven.compiler.compilerVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;   
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;局部配置&#34;&gt;局部配置&lt;/h4&gt;
&lt;p&gt;在该工程的pom文件中，添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugins&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;maven-compiler-plugin&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
                &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
                &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
            &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugins&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/maven/">Maven</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/java/">Java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Java 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/programming/java/java-questions-and-solution/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/java/java-questions-and-solution/</guid>
                <pubDate>Thu, 22 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了些在 Java 开发过程中常见的问题及解决方法，以备后查。&lt;/p&gt;
&lt;h3 id=&#34;linux-下验证码无法显示问题&#34;&gt;Linux 下验证码无法显示问题&lt;/h3&gt;
&lt;p&gt;现象：&lt;/p&gt;
&lt;p&gt;web 应用在 windows 和 开发 Linux 服务器验证码显示正常，部署到新的生产 Linux 服务器上，验证码无法显示&lt;/p&gt;
&lt;p&gt;异常日志：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Can&amp;#39;t connect to X11 window server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;问题原因：&lt;/p&gt;
&lt;p&gt;Java 在图形处理时调用了本地的图形处理库。在利用 Java 做图形处理（比如，图片缩放、图片签名、生成报表），如果运行在 windows 上不会出问题。如果将程序移植到 Linux/Unix 上，有可能出现图形不能显示的错误，这是由于 Linux 的图形处理需要一个 X server 服务器。&lt;/p&gt;
&lt;p&gt;问题解决方法：&lt;/p&gt;
&lt;p&gt;1、检查 JDK 版本，不能使用 OpenJDK。&lt;/p&gt;
&lt;p&gt;2、在 Tomcat 中，修改 catalina.sh，加入如下行：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;JAVA_OPTS=&amp;#34;-Djava.awt.headless=True&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果名字为 java.awt.headless 的系统属性被设置为 True，那么 headless 工具包就会被使用。应用程序可以执行如下操作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;创建轻量级组件。&lt;/li&gt;
&lt;li&gt;收集关于可用的字体、字体指标和字体设置的信息。&lt;/li&gt;
&lt;li&gt;设置颜色来渲染准备图片。&lt;/li&gt;
&lt;li&gt;创造和获取图像，为渲染准备图片。&lt;/li&gt;
&lt;li&gt;使用 java.awt.PrintJob，java.awt.print.* 和 javax.print.* 类里的打印方法。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;3、在 Jetty 中，修改 jetty.sh 中 JAVA_OPTIONS 参数，加入如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;JAVA_OPTIONS+=(&amp;#34;-Djava.awt.headless=True&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、终极解决
一般是在程序开始激活 headless 模式，告诉程序，现在要工作在 Headless 模式下，就不要指望硬件帮忙了，得依靠系统的计算能力模拟出这些特性来&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;public void init(ServletConfig config) throws ServletException {
    super.init(config);
    height = Integer.parseInt(getServletConfig().getInitParameter(&amp;#34;height&amp;#34;));
    width = Integer.parseInt(getServletConfig().getInitParameter(&amp;#34;width&amp;#34;));
    System.setProperty(&amp;#34;java.awt.headless&amp;#34;, &amp;#34;True&amp;#34;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;webxml-is-missing-and-failonmissingwebxml-is-set-to-true&#34;&gt;web.xml is missing and &lt;failOnMissingWebXml&gt; is set to true&lt;/h3&gt;
&lt;p&gt;使用 &lt;code&gt;maven&lt;/code&gt; 构建工程时，&lt;code&gt;pom.xml&lt;/code&gt; 报错如下，提示如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;web.xml is missing and &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;failOnMissingWebXml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; is set to true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;pom.xml&lt;/code&gt; 文件中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugins&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;maven-war-plugin&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;3.2.0&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;failOnMissingWebXml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;false&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;failOnMissingWebXml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugins&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;slf4j-failed-to-load-class-orgslf4jimplstaticloggerbinder&#34;&gt;SLF4J: Failed to load class &amp;quot;org.slf4j.impl.StaticLoggerBinder&amp;quot;.&lt;/h3&gt;
&lt;p&gt;运行程序时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;SLF4J: Failed to load class &amp;#34;org.slf4j.impl.StaticLoggerBinder&amp;#34;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因：&lt;code&gt;log4j&lt;/code&gt; 和 &lt;code&gt;sl4j&lt;/code&gt; 的版本不匹配，或是缺少 &lt;code&gt;jar&lt;/code&gt; 包，使用下面这组：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slf4j-log4j12.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.7.25&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slf4j-log4j12.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slf4j-api.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.7.25&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slf4j-api.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;log4j.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.2.17&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;log4j.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slf4j-nop.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.7.25&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slf4j-nop.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slf4j-simple.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.7.5&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;slf4j-simple.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-log4j12 --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;slf4j-log4j12&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;${slf4j-log4j12.version}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;test&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;log4j&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;log4j&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;${log4j.version}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;slf4j-api&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;${slf4j-api.version}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-nop --&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;slf4j-nop&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;${slf4j-nop.version}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;test&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;slf4j-simple&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;${slf4j-simple.version}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;caused-by-javaniocharsetmalformedinputexception-input-length--1&#34;&gt;Caused by: java.nio.charset.MalformedInputException: Input length = 1&lt;/h3&gt;
&lt;p&gt;程序运行时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Caused by: java.nio.charset.MalformedInputException: Input length = 1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因：当输入字节序列对于给定 &lt;code&gt;charset&lt;/code&gt; 来说是不合法的，或者输入字符序列不是合法的 &lt;code&gt;16&lt;/code&gt; 位 &lt;code&gt;Unicode&lt;/code&gt; 序列时，抛出此经过检查的异常。&lt;/p&gt;
&lt;p&gt;解决：将当前配置文件的编码设置为 &lt;code&gt;UTF-8&lt;/code&gt;。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/java/">Java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>JVM 参数详解</title>
                <link>https://xdhuxc.github.io/posts/programming/java/java-jvm-parameter/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/java/java-jvm-parameter/</guid>
                <pubDate>Thu, 22 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 JVM 的一些参数，在 JVM 调优时需要用到。&lt;/p&gt;
&lt;h3 id=&#34;堆大小设置&#34;&gt;堆大小设置&lt;/h3&gt;
&lt;p&gt;JVM中最大堆大小有三方面限制：&lt;/p&gt;
&lt;p&gt;1、相关操作系统的数据模型（32位机器还是64位机器）限制，32位系统下，一般限制在1.5G~2G，64位操作系统对内存无限制。
2、系统的可用虚拟内存限制。
3、系统的可用物理内存限制。&lt;/p&gt;
&lt;h3 id=&#34;配置含义&#34;&gt;配置含义&lt;/h3&gt;
&lt;p&gt;-server：服务器模式&lt;/p&gt;
&lt;p&gt;-Xms1024M 为 JVM 启动时分配的堆内存，一般和Xmx配置成一样，以避免每次GC后JVM重新分配内存。比如，-Xms200M，表示分配200M&lt;/p&gt;
&lt;p&gt;-Xmx1024 为 JVM 运行过程中分配的最大堆内存，按需分配。比如，-Xmx1024M，表示 JVM 进程最多只能够占用 1024M 内存。&lt;/p&gt;
&lt;p&gt;-Xss256K 为 JVM 启动的每个线程分配的堆栈内存大小，默认JDK1.4中是256K，JDK1.5+中是1M。&lt;/p&gt;
&lt;p&gt;-XX:+DisableExplicitGC：忽略手动调用GC，System.gc()的调用就会变成一个空调用，不会触发GC。&lt;/p&gt;
&lt;h3 id=&#34;jvm参数&#34;&gt;JVM参数&lt;/h3&gt;
&lt;p&gt;-XX 参数被称为不稳定参数，此类参数的设置很容易引起JVM性能上的差异&lt;/p&gt;
&lt;p&gt;不稳定参数语法规则：&lt;/p&gt;
&lt;p&gt;1、布尔类型&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;-XX:+&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &amp;#34;+&amp;#34;表示启用该选项
-XX:+&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &amp;#34;-&amp;#34;表示关闭该选项
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、数字类型&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;-XX:&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;=&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;number&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; # 可跟随单位，例如，“m”或“M”表示兆字节，“k”或“K”表示千字节，“g”或“G”表示千兆字节。32K与32768是相同大小的。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、字符串类型&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;-XX:&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;=&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; # 通常用于指定一个文件、路径或一系列命令列表，例如：-XX:HeapDumpPath=./dump.core
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;远程调试&#34;&gt;远程调试&lt;/h3&gt;
&lt;p&gt;远程调试时，添加如下JVM参数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;-Xdebug -Xrunjdwp:transport:dt_socket,address=8899,server=y,suspend=n
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;transport：debugee 与 debuger 调试时之间的通讯数据传输方式。&lt;/li&gt;
&lt;li&gt;server：是否监听 debuger 的调试请求。&lt;/li&gt;
&lt;li&gt;suspend：是否等待启动，也即，设置是否在 debuger 调试连接建立后才启动 debugee JVM。&lt;/li&gt;
&lt;li&gt;address：debugee的地址，用于 debuger 建立调试连接。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;远程调试时，JAVA_OPTS 设置示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;JAVA_OPTS=-server -Xms1400m -Xmx1400m -Xss4096K -XX:PermSize=128m -XX:MaxPermSize=256m -Duser.timezone=GMT+08 -Dfile.encoding=UTF8 -Dsun.jnu.encoding=UTF8 -Djava.awt.headless=true -XX:+DisableExplicitGC -Xdebug -Xrunjdwp:transport=dt_socket,address=8899,server=y,suspend=n
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/java/">Java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>安装 Maven</title>
                <link>https://xdhuxc.github.io/posts/programming/java/java-install-maven/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/java/java-install-maven/</guid>
                <pubDate>Thu, 22 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了安装 &lt;code&gt;maven&lt;/code&gt; 的步骤。&lt;/p&gt;
&lt;h3 id=&#34;安装-maven&#34;&gt;安装 maven&lt;/h3&gt;
&lt;p&gt;1、下载 &lt;code&gt;maven&lt;/code&gt; 安装包，下载地址为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://maven.apache.org/download.cgi
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;下载并解压之。&lt;/p&gt;
&lt;p&gt;2、检查并配置 &lt;code&gt;JAVA_HOME&lt;/code&gt;，&lt;code&gt;MAVEN_HOME&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;（1）查找 &lt;code&gt;java&lt;/code&gt; 安装目录，并配置 &lt;code&gt;JAVA_HOME&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc apache-maven-3.5.4]# find / -name java
/usr/bin/java
/usr/share/java
/usr/lib/gcc/x86_64-redhat-linux/4.8.2/plugin/include/java
/usr/lib/java
/usr/java
/usr/java/jdk1.8.0_171-amd64/bin/java     # 安装的官方 Java
/usr/java/jdk1.8.0_171-amd64/jre/bin/java
/var/lib/alternatives/java
/var/lib/docker/overlay2/7f36ad36ff79b7cef239f31a147541b66652a320d05bc77737b797bba1d2c411/merged/usr/share/java
/var/lib/docker/overlay2/0ccde8693a9840f6948d05e6d41238e8d0d993b6c15567f485e43038b09baa03/diff/usr/share/java
/etc/alternatives/java
/etc/pki/ca-trust/extracted/java
/etc/pki/java
/etc/java
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;/etc/profile&lt;/code&gt; 中配置 &lt;code&gt;JAVA_HOME&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export JAVA_HOME=/usr/java/jdk1.8.0_171-amd64
export PATH=${JAVA_HOME}/bin:$PATH
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行 &lt;code&gt;. /etc/profile&lt;/code&gt; 或 &lt;code&gt;source /etc/profile&lt;/code&gt; 使配置生效。&lt;/p&gt;
&lt;p&gt;执行测试命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# java -version
java version &amp;#34;1.8.0_171&amp;#34;
Java(TM) SE Runtime Environment (build 1.8.0_171-b11)
Java HotSpot(TM) 64-Bit Server VM (build 25.171-b11, mixed mode)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;（2）配置 &lt;code&gt;MAVEN_HOME&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;maven&lt;/code&gt; 的安装目录为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc apache-maven-3.5.4]# pwd
/root/xdhuxc/apache-maven-3.5.4
[root@xdhuxc apache-maven-3.5.4]# ls
bin  boot  conf  lib  LICENSE  NOTICE  README.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;/etc/profile&lt;/code&gt; 中配置 &lt;code&gt;MAVEN_HOME&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export MAVEN_HOME=/root/xdhuxc/apache-maven-3.5.4
export PATH=${JAVA_HOME}/bin:${MAVEN_HOME}/bin:$PATH
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行 &lt;code&gt;. /etc/profile&lt;/code&gt; 或 &lt;code&gt;source /etc/profile&lt;/code&gt; 使配置生效。&lt;/p&gt;
&lt;p&gt;执行测试命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# mvn -v
Apache Maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-18T02:33:14+08:00)
Maven home: /root/xdhuxc/apache-maven-3.5.4
Java version: 1.8.0_171, vendor: Oracle Corporation, runtime: /usr/java/jdk1.8.0_171-amd64/jre
Default locale: en_US, platform encoding: UTF-8
OS name: &amp;#34;linux&amp;#34;, version: &amp;#34;3.10.0-327.28.3.el7.x86_64&amp;#34;, arch: &amp;#34;amd64&amp;#34;, family: &amp;#34;unix&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/java/">Java</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/maven/">Maven</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Kubernetes 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/kubernetes/kubernetes-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/kubernetes/kubernetes-questions-and-solutions/</guid>
                <pubDate>Sat, 17 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在使用 Kubernetes 的过程中常见的问题及解决方法。&lt;/p&gt;
&lt;p&gt;1、使用 kubectl 命令时，要求输入用户名和密码&lt;/p&gt;
&lt;p&gt;解决：删除 ~/.kube 目录下的 config 文件。&lt;/p&gt;
&lt;p&gt;2、kubernetes 禁用 Swap 的原因&lt;/p&gt;
&lt;p&gt;当前的 QOS 策略都是假定主机不启用内存 Swap。如果主机启用了 Swap，那么 QOS 策略可能会失效。&lt;/p&gt;
&lt;p&gt;例如，两个 Pod 都刚好达到了内存限制上限，由于内存 Swap 机制，它们还可以继续申请使用更多内存，如果 Swap 空间不足，那么最终这两个 Pod 中的进程可能会被杀掉。&lt;/p&gt;
&lt;p&gt;目前 Kubernetes 和 Docker 尚不支持内存 Swap 空间的隔离机制。&lt;/p&gt;
&lt;p&gt;3、在 &lt;code&gt;node&lt;/code&gt; 节点上使用 &lt;code&gt;kubectl&lt;/code&gt; 命令时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-172 ~]# kubectl get nodes
The connection to the server localhost:8080 was refused - did you specify the right host or port?
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;由提示可知，kubectl找不到master节点，所以，需要设置参数，让它找到master。&lt;/p&gt;
&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;1）在node节点的/etc/profile文件中加入如下环境变量：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export KUBERNETES_MASTER=http://192.168.91.128:8080
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后执行 &lt;code&gt;source /etc/profile&lt;/code&gt; 或 &lt;code&gt;. /etc/profile&lt;/code&gt; 命令使配置生效。&lt;/p&gt;
&lt;p&gt;192.168.91.128为kubernetes集群master节点的IP地址。&lt;/p&gt;
&lt;p&gt;2）在执行kubectl命令时，在命令中指定master的IP地址，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-172 ~]# kubectl -s http://172.20.27.207:8080 get nodes
NAME                STATUS    ROLES     AGE       VERSION
k8s-172.20.27.208   Ready     ingress   5h        v1.8.4
k8s-master          Ready     master    1d        v1.8.4
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）在 ~/.kube/config 中配置 kubectl 访问 API server 的地址&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir ~/.kube/ &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; \cp -f /etc/kubernetes/admin.conf ~/.kube/config
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4）在 /etc/kubernetes/admin.conf 中配置 kubectl 访问 API server 的地址&lt;/p&gt;
&lt;p&gt;4、删除 pod 后，pod 一直处于 Terminating 状态，可以使用如下方法删除&lt;/p&gt;
&lt;p&gt;1）强制删除该 pod&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl delete pod aym91ga9-5c7c8ccc94-lfrfb -n c87e2267-1001-4c70-bb2a-ab41f3b81aa3 --grace-period=0 --force
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）删除该 pod 所在的 namespace&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl delete namespace c87e2267-1001-4c70-bb2a-ab41f3b81aa3
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、删除 namespace 后，提示删除成功，但是却一直处于 Terminating 状态，
强制删除该 namespace 下的所有 pod，然后该 namespace 将会被系统自动删除。&lt;/p&gt;
&lt;p&gt;6、应用部署完毕后，状态全部正常，但是访问却 504，&lt;/p&gt;
&lt;p&gt;注意，不要使虚拟机的 IP 地址和 calico 的子网 IP 地址一样。如果有冲突，需要进行修改 calico.yaml 中环境变量 CALICO_IPV4POOL_CIDR 的值，修改为新的子网地址，然后删除原有的 calico，ingress 和 kube-dns，依次重新创建 calico，ingress，kube-dns&lt;/p&gt;
&lt;p&gt;7、应用开发完毕后，本地启动没有问题，可以正常运行，但部署到 kubernetes 上后，web 服务总是启动不起来，进入 pod 中使用 netstat 查看后，发现有个需要连接的 IP 地址的状态为：syn_wait&lt;/p&gt;
&lt;p&gt;解决：当下游服务连接不通时，往往会导致 web 服务器启动不起来。经过运维同事打开安全组，服务终于正常运行了。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/kubernetes/">Kubernetes</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Calico 常用命令</title>
                <link>https://xdhuxc.github.io/posts/mixed/calico/calico-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/calico/calico-command/</guid>
                <pubDate>Thu, 15 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下 calico 常用的命令。&lt;/p&gt;
&lt;h3 id=&#34;calico-命令&#34;&gt;calico 命令&lt;/h3&gt;
&lt;p&gt;1、查看节点状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;calicoctl node status # 查看节点状态 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，该命令不显示当前节点状态。&lt;/p&gt;
&lt;p&gt;2、查看IP池&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;calicoctl get ippool -o wide
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/calico/">calico</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Kubernetes 常用命令总结</title>
                <link>https://xdhuxc.github.io/posts/kubernetes/kubernetes-common-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/kubernetes/kubernetes-common-command/</guid>
                <pubDate>Wed, 14 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在 Kubernetes 中常用的命令，以备后需。&lt;/p&gt;
&lt;h2 id=&#34;常用命令&#34;&gt;常用命令&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;以下操作均假设在含 kubelet 的节点上执行命令&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;集群信息&#34;&gt;集群信息&lt;/h3&gt;
&lt;p&gt;1、查看集群信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master ~]# kubectl cluster-info
Kubernetes master is running at https://172.20.26.150:6443
KubeDNS is running at https://172.20.26.150:6443/api/v1/namespaces/kube-system/services/kube-dns/proxy

To further debug and diagnose cluster problems, use &amp;#39;kubectl cluster-info dump&amp;#39;.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看当前上下文&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master ~]# kubectl config current-context
kubernetes-admin@kubernetes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查看各组件状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl -s http://192.168.8.8:8080 get componentstatuses
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、获取 kubectl 版本信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl version
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、获取集群信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl cluster-info
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;标签操作&#34;&gt;标签操作&lt;/h3&gt;
&lt;p&gt;1、给 master 节点打标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl label nodes xxxxxx node-role.kubernetes.io/master=
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、给 ingress 节点打标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl label nodes k8s-172.20.27.215 node-role.kubernetes.io/ingress=
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;资源操作&#34;&gt;资源操作&lt;/h3&gt;
&lt;p&gt;1、查看所有的 deployment&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get deployment --all-namespaces
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看所有的命名空间&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl -s http://172.20.27.207:8080 get pods --all-namespaces
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查看当前节点状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get nodes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当 节点的 STATUS 为 ready 时，说明情况正常。&lt;/p&gt;
&lt;p&gt;4、查看所有 pod 信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get pod --all-namespaces
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当 pod 的 STATUS 为 running 时，说明情况正常。&lt;/p&gt;
&lt;p&gt;5、查看指定命令空间下的pod&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get pod -n kube-system # 通过 -n 参数指定待查命名空间。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、查看 pod 的详细情况
假定pod的名称为：ai2yzbme-8f7c9f77f-66cwv，所属命名空间为：kube-system&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl describe pod ai2yzbme-8f7c9f77f-66cwv -n kube-system
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、查看 node 的情况
假设node的名称为：k8s-master&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl describe node k8s-master
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、查看 ConfigMap&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get configMap -n kube-system
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;9、查看指定的 ConfigMap&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get configMap calico-config  -n kube-system -o yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;10、创建资源对象&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl create -f ./xdhuxc.yaml
kubectl create -f ./xdhuxc.yaml -f ./zabuqk.yaml
kubectl create -f ./xdhuxc
kubectl create -f http://xdhuxc/xdhuxc.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;11、显示带有标签 env=production 的所有 pod&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get pods -l env=production
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;12、列出所有的服务，并通过名称排序&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get services --sort-by=.metadata.name
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;13、给 pod 打标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl label pods xdhuxc-message new-label=xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;14、给 pod 添加注解&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl annotate pods xdhuxc-message icon-url=http://xdhuxc.com
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;15、扩容及缩容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl scale --replicas=3 deployment nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;16、在已有 pod 里面运行命令，pod 中含有多个容器的情况下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl exec xdhuxc-message -c xdhuxc-message -- ls /
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;17、在已运行的 pod 里面运行命令，仅有一个容器的情况下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl exec -it xdhuxc-message -n kube-admin bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;18、将服务转发到端口&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl port-forward xdhuxc-message 8080
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;19、将 Pod 的端口转发到本地机器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl port-forward web-port 8080
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;20、以交互式 shell 运行 pod&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl run -i --tty busybox --image=busybox -- sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;21、连接到运行着的容器里&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl attach -i xdhuxc-message
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;22、 DNS 查找&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl exec busybox -- nslookup kubernetes
kubectl exec busybox -- nslookup kubernetes.default
kubectl exec busybox -- nslookup kubernetes.default.svc.cluster.local
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;23、暴露服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl expose deployment nginx --port=80 --type=LoadBalancer
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;24、查看指定ServiceAccount的token&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master dashboard]# kubectl get ServiceAccount kubernetes-dashboard -n kube-system -o jsonpath=&amp;#34;{.secrets[].name}&amp;#34;
kubernetes-dashboard-token-ncx5g
[root@k8s-master dashboard]# kubectl get secret kubernetes-dashboard-token-ncx5g -o jsonpath=&amp;#34;{.data.token}&amp;#34;  -n kube-system  | base64 -d
eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJrdWJlcm5ldGVzLWRhc2hib2FyZC10b2tlbi1uY3g1ZyIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjgxMTZmNDE3LTlkNDctMTFlOC04NDVlLTA2MjY2ODAwMWYxNSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlLXN5c3RlbTprdWJlcm5ldGVzLWRhc2hib2FyZCJ9.OnhxsBYnuC47R9j411bq8d2NZDRWGMqUysC9rpITIy3r-4eTKNFL6Hf9jMQzIHME29re3PpKZ6EvV4n-VPTtL-PYbatXu5pegyX4jewQwCHn6VMzqJFaBN-hwK9wbY-1Mp63vZGEYZdRQYqB832SRyWwPoGGX8YSDa5dwk7hOJUJUBl4iBYpNt2nxxSTHgkqeh2QhzpaGZhgBx7c5UhfdNFRZVeQYns-k7f10c_36TuPmT98X3WSe7UEyAV1AhFu0b0z7WqUAAEJvRwxxEI0aYze3UWWGO9wr0sqzt7ZkhPy1GIQsLWOLO_g1vnviVaQcqhLiQU8ZNNjX2UqitF_eQ
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;25、强制删除 pod&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl delete pod kubernetes-dashboard-55556f66c5-4zc77 -n kube-system --grace-period=0 --force
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;该命令也可以用于强制删除其他 kubernetes 资源。&lt;/p&gt;
&lt;h3 id=&#34;日志查看&#34;&gt;日志查看&lt;/h3&gt;
&lt;p&gt;1）查看指定行数的日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl logs --tail=5 dingtalk-callback-5ff4757745-g448n -n xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）查看指定时间段的日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl logs --since=1h dingtalk-callback-5ff4757745-g448n -n xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;组合命令&#34;&gt;组合命令&lt;/h2&gt;
&lt;p&gt;1）删除状态为 Error 的 Pod&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl get pods -n xdhuxc | grep Error | awk &amp;#39;{ print $1 }&amp;#39;| xargs kubectl delete pod -n xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/kubernetes/">Kubernetes</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>部署 etcd 的常用方法</title>
                <link>https://xdhuxc.github.io/posts/storage/etcd/etcd-deployment/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/etcd/etcd-deployment/</guid>
                <pubDate>Sun, 11 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了几种常用的部署 etcd 的方法。&lt;/p&gt;
&lt;h3 id=&#34;基于-docker-方式部署-etcd&#34;&gt;基于 docker 方式部署 etcd&lt;/h3&gt;
&lt;p&gt;1、拉取 etcd 镜像&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-angular2html&#34; data-lang=&#34;angular2html&#34;&gt;docker pull gcr.io/etcd-development/etcd:v3.2.25
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、启动 etcd 容器&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-angular2html&#34; data-lang=&#34;angular2html&#34;&gt;docker run -d \
    --restart=always \
    --name=etcd \
    -p 3379:2379 \
    -p 3380:2380 \
    -v /data/etcd/data:/etcd-data \
    gcr.io/etcd-development/etcd:v3.2.25 \
    /usr/local/bin/etcd \
    --name etcd1 \
    --data-dir /etcd-data \
    --listen-client-urls http://0.0.0.0:2379 \
    --advertise-client-urls http://0.0.0.0:2379 \
    --listen-peer-urls http://0.0.0.0:2380 \
    --initial-advertise-peer-urls http://0.0.0.0:2380 \
    --initial-cluster etcd1=http://0.0.0.0:2380 \
    --initial-cluster-token tkn \
    --initial-cluster-state new
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;使用-yum-安装-etcd&#34;&gt;使用 yum 安装 etcd&lt;/h3&gt;
&lt;p&gt;1、使用 yum 直接安装 etcd&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install etcd -y
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动 etcd&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart etcd 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查看状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl status etcd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;集群方式部署-etcd&#34;&gt;集群方式部署 etcd&lt;/h3&gt;
&lt;p&gt;三台机器的基本信息&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;名称&lt;/th&gt;
&lt;th&gt;IP地址&lt;/th&gt;
&lt;th&gt;主机名&lt;/th&gt;
&lt;th&gt;OS&lt;/th&gt;
&lt;th&gt;etcd_version&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;etcd0&lt;/td&gt;
&lt;td&gt;192.168.91.128&lt;/td&gt;
&lt;td&gt;etcd0.xdhuxc.com&lt;/td&gt;
&lt;td&gt;CentOS 7.3.1611&lt;/td&gt;
&lt;td&gt;etcd-v3.2.10&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;etcd1&lt;/td&gt;
&lt;td&gt;192.168.91.129&lt;/td&gt;
&lt;td&gt;etcd1.xdhuxc.com&lt;/td&gt;
&lt;td&gt;CentOS 7.3.1611&lt;/td&gt;
&lt;td&gt;etcd-v3.2.10&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;etcd2&lt;/td&gt;
&lt;td&gt;192.168.91.130&lt;/td&gt;
&lt;td&gt;etcd2.xdhuxc.com&lt;/td&gt;
&lt;td&gt;CentOS 7.3.1611&lt;/td&gt;
&lt;td&gt;etcd-v3.2.10&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;均安装 iptables 并开放所需端口2379，2380&lt;/p&gt;
&lt;p&gt;在每一台机器上，添加如下环境变量&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ETCD_VERSION=v3.3
TOKEN=etcd-cluster-token
CLUSTER_STATE=new
NODE_1=etcd-node-0
NODE_2=etcd-node-1
NODE_3=etcd-node-2
HOST_1_IP=192.168.91.128
HOST_2_IP=192.168.91.129
HOST_3_IP=192.168.91.130
CLUSTER=${NODE_1}=http://${HOST_1_IP}:2380,${NODE_2}=http://${HOST_2_IP}:2380,${NODE_3}=http://${HOST_3_IP}:2380
DATA_DIR=/home/xdhuxc/etcd/data
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在节点1上，执行如下命令&lt;/p&gt;
&lt;p&gt;添加如下环境变量：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;THIS_NAME=${NODE_1}
THIS_IP=${HOST_1_IP}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run \
    -p 2379:2379 \
    -p 2380:2380 \
    -v ${DATA_DIR}:/etcd-data \
    --name etcd-1
    quay.io/coreos/etcd:v3.3 \
    /usr/local/bin/etcd \
    --data-dir=/etcd-data \
    --name ${THIS_NAME} \
    --initial-advertise-peer-urls http://${THIS_IP}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在节点2上，执行如下命令&lt;/p&gt;
&lt;p&gt;添加如下环境变量：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;THIS_NAME=${NODE_2}
THIS_IP=${HOST_2_IP}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run \
    -p 2379:2379 \
    -p 2380:2380 \
    -v ${DATA_DIR}:/etcd-data \
    --name etcd-2
    quay.io/coreos/etcd:v3.3 \
    /usr/local/bin/etcd \
    --data-dir=/etcd-data \
    --name ${THIS_NAME} \
    --initial-advertise-peer-urls http://${THIS_IP}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在节点3上，执行如下命令&lt;/p&gt;
&lt;p&gt;添加如下环境变量：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;THIS_NAME=${NODE_3}
THIS_IP=${HOST_3_IP}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run \
    -p 2379:2379 \
    -p 2380:2380 \
    -v ${DATA_DIR}:/etcd-data \
    --name etcd-3
    quay.io/coreos/etcd:v3.3 \
    /usr/local/bin/etcd \
    --data-dir=/etcd-data \
    --name ${THIS_NAME} \
    --initial-advertise-peer-urls http://${THIS_IP}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;Github &lt;a href=&#34;https://github.com/etcd-io/etcd/releases&#34;&gt;https://github.com/etcd-io/etcd/releases&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;镜像下载地址 &lt;a href=&#34;https://quay.io/repository/coreos/etcd?tag=latest&amp;amp;tab=tags&#34;&gt;https://quay.io/repository/coreos/etcd?tag=latest&amp;amp;tab=tags&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;镜像使用地址 &lt;a href=&#34;https://github.com/coreos/etcd/blob/master/Documentation/op-guide/container.md#docker&#34;&gt;https://github.com/coreos/etcd/blob/master/Documentation/op-guide/container.md#docker&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/etcd/">etcd</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Calico 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/mixed/calico/calico-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/calico/calico-questions-and-solutions/</guid>
                <pubDate>Sat, 10 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下在使用 calico 的过程中常见的问题及解决方法。&lt;/p&gt;
&lt;p&gt;1）已经部署好的 calico，需要修改其网段，修改后，连接不通
执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;#重新安装calico (cnm)
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 修改calico地址后，需要删除原来的tunl0等
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
ip link set tunl0 down
ifconfig|grep &amp;#34;cali\|cni\|flannel&amp;#34;|awk &amp;#39;{printf(&amp;#34;ip link delete %s\n&amp;#34;, $1)}&amp;#39;|sh
rm -rf /etc/cni/
rm -rf /opt/cni
rm -rf /var/lib/cni
mkdir -p /opt/cni/bin/
iptables -F
systemctl restart iptables
export ETCD_AUTHORITY=10.3.15.189:2379
calicoctl node run --ip=
&lt;span class=&#34;gh&#34;&gt;#安装完后可以docker run -it --net=net1 busybox sh 测试一下ip的ping通性
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/calico/">calico</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>dnsmasq 的配置和使用</title>
                <link>https://xdhuxc.github.io/posts/common/dns/dns-dnsmasq/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/common/dns/dns-dnsmasq/</guid>
                <pubDate>Sat, 10 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 dnsmasq 的配置和使用。&lt;/p&gt;
&lt;h3 id=&#34;简介&#34;&gt;简介&lt;/h3&gt;
&lt;p&gt;dnsmasq 是一个小巧且方便地用于配置 DNS 和 DHCP 的工具，适用于小型网络，相比于 bind 和 dhcpd，配置起来更简单。dnsmasq 能够提供本地解析和外部 DNS 服务器代理，通常将其作为一个 DNS 中继代理。&lt;/p&gt;
&lt;h3 id=&#34;安装&#34;&gt;安装&lt;/h3&gt;
&lt;p&gt;可以通过 yum 命令直接安装 dnsmasq，命令如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y dnsmasq
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;安装完成后，可以通过 &lt;code&gt;dnsmasq --help&lt;/code&gt; 或者 &lt;code&gt;man dnsmasq&lt;/code&gt; 查看支持的配置。&lt;/p&gt;
&lt;h3 id=&#34;配置&#34;&gt;配置&lt;/h3&gt;
&lt;p&gt;配置文件位置为：&lt;code&gt;/etc/dnsmasq.conf&lt;/code&gt;，默认情况下，dnsmasq.conf 中只开启了最后的 include 项，可以在 /etc/dnsmasq.d 中编写任意名称的配置文件。&lt;/p&gt;
&lt;p&gt;dnsmasq.conf 文件内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 监听的端口，DNS 默认为 53 端口，如果设置为 0，则完全禁止 DNS 功能。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;port=53
&lt;span class=&#34;gh&#34;&gt;# 监听地址
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;listen-address=10.10.24.32

&lt;span class=&#34;gh&#34;&gt;# 正确的域名格式才转发
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;domain-needed

&lt;span class=&#34;gh&#34;&gt;# 设置本地域扩展，相当于域简写，例如 hosts 配置 www 会自动加上 www.xdhuxc.com 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;expand-hosts 
local=/xdhuxc.com/

&lt;span class=&#34;gh&#34;&gt;# 配置上游的 nameserver 解析文件 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;#resolv-file=/etc/dnsmasq.resolv.conf
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 当 /etc/resolv.conf 或 resolv-file 文件变化时，不重新加载。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;no-poll 
&lt;span class=&#34;gh&#34;&gt;# 不使用上游 nameserver 配置文件（/etc/resolv.conf 和 resolv-file）
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;no-resolv 

&lt;span class=&#34;gh&#34;&gt;# 配置本地解析的 hosts
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;addn-hosts=/etc/dnsmasq.hosts
&lt;span class=&#34;gh&#34;&gt;# 不使用 /etc/hosts，开启后 expand-hosts 不生效 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# no-hosts 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 按配置顺序查询上级 nameserver 服务器
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;strict-order 

&lt;span class=&#34;gh&#34;&gt;# 记录日志，如果打开日志，要及时清理 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;log-queries
log-facility=/var/log/dnsmasq.log 
&lt;span class=&#34;gh&#34;&gt;# 启用异步日志记录，缓解阻塞，提高性能。默认队列长度为：5，合理值为：5~25，最大限制为：100
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;log-async=20

&lt;span class=&#34;gh&#34;&gt;# 缓存地址数量，提高查询速度
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cache-size=10000
&lt;span class=&#34;gh&#34;&gt;# 自动加载配置文件目录 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;conf-dir=/etc/dnsmasq.d 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 /etc/dnsmasq.d 目录下配置自定义项 server.conf&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 指定 dnsmasq 默认查询的上游域名服务器  
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;server=8.8.8.8 
server=114.114.114.114
&lt;span class=&#34;gh&#34;&gt;# 可以将特定的域名指定解析它的域名服务器，一般是其他的内部域名服务器。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;server=/baidu.com/61.135.165.235
&lt;span class=&#34;gh&#34;&gt;# 指定反向 DNS 192.168.1/24 网段到 192.168.2.1 DNS 查询 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# server=/192.168.1.in-addr.arpa/192.168.2.1
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 给 *.apple.com 和 taobao.com 使用专用的 DNS
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;server=/taobo.com/223.5.5.5
server=/.apple.com/223.5.5.5

&lt;span class=&#34;gh&#34;&gt;# 把 www.hi-linux.com 解析到特定的 IP
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;address=/www.hi-linux.com/192.168.101.107 

&lt;span class=&#34;gh&#34;&gt;# 把所有 .cn 的域名全部通过 114.114.114.114 这台国内 DNS 服务器来解析 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;server=/cn/114.114.114.114
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;address.conf 配置自定义域名服务器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 指定 domain 解析地址 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;address=/www.test.com/127.0.0.1
&lt;span class=&#34;gh&#34;&gt;# *.xdhuxc.com 匹配 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;address=/xdhuxc.com/127.0.0.1
address=/.abc.com/1.1.1.1 
address=/ipv6.xdhuxc.com/fe80::4d7:a0ff:fe00:f9b
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;启动服务&#34;&gt;启动服务&lt;/h3&gt;
&lt;p&gt;启动 dnsmasq 服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart dnsmasq
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 dig 命令查询解析是否正确，例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc etc]# dig &lt;span class=&#34;ni&#34;&gt;@10&lt;/span&gt;.10.24.32 www.xdhuxc.com

; &lt;span class=&#34;err&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&amp;gt;&amp;gt; DiG 9.9.4-RedHat-9.9.4-61.el7_5.1 &lt;span class=&#34;err&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&amp;gt;&amp;gt; &lt;span class=&#34;ni&#34;&gt;@10&lt;/span&gt;.10.24.32 www.xdhuxc.com
; (1 server found)
;; global options: +cmd
;; Got answer:
;; -&amp;gt;&amp;gt;HEADER&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;opcode:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;QUERY&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;status:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;NOERROR&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;id:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;4987&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;flags:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;qr&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;aa&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rd&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ra&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ad&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;QUERY:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ANSWER:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;AUTHORITY:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ADDITIONAL:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;

&lt;span class=&#34;err&#34;&gt;;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;QUESTION&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;SECTION:&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;www&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;xdhuxc&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;com&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;			&lt;span class=&#34;na&#34;&gt;IN&lt;/span&gt;	&lt;span class=&#34;na&#34;&gt;A&lt;/span&gt;

&lt;span class=&#34;err&#34;&gt;;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;ANSWER&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;SECTION:&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;www&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;xdhuxc&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;com&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;		&lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;	&lt;span class=&#34;na&#34;&gt;IN&lt;/span&gt;	&lt;span class=&#34;na&#34;&gt;A&lt;/span&gt;	&lt;span class=&#34;na&#34;&gt;127&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;

&lt;span class=&#34;err&#34;&gt;;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;Query&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;time:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;msec&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;SERVER:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;53&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;24&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;WHEN:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;Mon&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;Oct&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;15&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;14:53:28&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;CST&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;2018&lt;/span&gt;
&lt;span class=&#34;err&#34;&gt;;;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;MSG&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;SIZE&lt;/span&gt;  &lt;span class=&#34;na&#34;&gt;rcvd:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;48&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;修改-iptables-配置&#34;&gt;修改 iptables 配置&lt;/h3&gt;
&lt;p&gt;1、允许本机的 53 端口可对外访问&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -A INPUT -p udp -m udp --dport 53 -j ACCEPT
iptables -A INPUT -p tcp -m tcp --dport 53 -j ACCEPT 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、转发 DNS 请求&lt;/p&gt;
&lt;p&gt;开启流量转发功能&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo &amp;#39;1&amp;#39; &amp;gt; /proc/sys/net/ipv4/ip_forward
echo &amp;#39;1&amp;#39; &amp;gt; /proc/sys/net/ipv6/ip_forward
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;添加流量转发规则，将外部到 53 的端口的请求映射到 dnsmasq 服务器的 53 端口&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -t nat -A PREROUTING -p udp --dport 53 -j REDIRECT --to-port 53
iptables -t nat -A PREROUTING -p tcp --dport 53 -j REDIRECT --to-port 53
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果要限制只允许内网的请求，规则如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -t nat -A PREROUTING -i eth0 -p udp --dport 53 -j REDIRECT --to-port 53
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、使用如下命令保存 iptables 规则并重启 iptables 服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;service iptables save      # 保存 iptables 规则  
systemctl restart iptables
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;dnsmasq-优化&#34;&gt;dnsmasq 优化&lt;/h3&gt;
&lt;h4 id=&#34;选择最快的上游-dns-服务器&#34;&gt;选择最快的上游 DNS 服务器&lt;/h4&gt;
&lt;p&gt;经常会有这样的情形，dnsmasq 服务器配置了很多上游域名服务器，转发本地的 DNS 请求，但 dnsmasq 实际上是只挑选了一个上游 DNS 服务器来查询并转发结果，这样如果选错服务器的话就会导致 DNS 响应变慢。
解决方法：
修改 dnsmasq.conf 的配置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;all-servers
server=8.8.8.8
server=114.114.114.114
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;all-servers 表示对以下设置的所有 server 发起查询，选择回应最快的一条作为查询结果返回。上面设置了两个域名服务器，会同时查询这两个域名服务器，询问 DNS 地址，谁返回快，就采用谁的结果。&lt;/p&gt;
&lt;h4 id=&#34;dnsmasq-china-list-项目&#34;&gt;dnsmasq-china-list 项目&lt;/h4&gt;
&lt;p&gt;dnsmasq-china-list 项目维护了一张国内常用但是通过国外 DNS 会解析错误的网站域名的列表，保证列表中的国内域名全部走国内 DNS 服务器解析。&lt;/p&gt;
&lt;p&gt;项目地址：https://github.com/felixonmars/dnsmasq-china-list&lt;/p&gt;
&lt;p&gt;操作步骤：&lt;/p&gt;
&lt;p&gt;1、取消 dnsmasq.conf 中 conf-dir=/etc/dnsmasq.d 这一行的注释&lt;/p&gt;
&lt;p&gt;2、获取项目文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git clone https://github.com/felixonmars/dnsmasq-china-list.git
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、将 &lt;code&gt;accelerated-domains.china.conf&lt;/code&gt;, &lt;code&gt;bogus-nxdomain.china.conf,google.china.conf&lt;/code&gt; （可选）放到 /etc/dnsmasq.d/ 目录下&lt;/p&gt;
&lt;p&gt;4、将 &lt;code&gt;dnsmasq-update-china-list&lt;/code&gt; 放到 &lt;code&gt;/usr/bin/&lt;/code&gt; 目录下，这是一个批量修改 DNS 服务器的工具。&lt;/p&gt;
&lt;h4 id=&#34;dnsmasq-性能优化&#34;&gt;dnsmasq 性能优化&lt;/h4&gt;
&lt;p&gt;bind 在不配合数据库的情况下，经常需要重新载入并读取配置文件，这是造成性能低下的原因。因此，我们可以考虑不读取 /etc/hosts 文件，而是另外指定一个在共享内存里的文件，比如 /dev/shm/dnsrecord.txt，这样就可以提高 DNS 解析速度了。又由于内存是易失性的存储器，重启后就会消失，可以定期同步硬盘上的某个文件内容到内存中。&lt;/p&gt;
&lt;p&gt;操作步骤：
1、配置 /etc/dnsmasq.conf&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;no-hosts
addn-hosts=/dev/shm/dnsrecord.txt 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、解决同步问题&lt;/p&gt;
&lt;p&gt;开机启动&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo &amp;#34;cat /etc/hosts &amp;gt; /dev/shm/dnsrecord.txt&amp;#34; &amp;gt;&amp;gt; /etc/rc.local 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;定时同步内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;crontab -e 
&lt;span class=&#34;ge&#34;&gt;*/10 *&lt;/span&gt; &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; * cat /etc/hosts &amp;gt; /dev/shm/dnsrecord.txt 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://chuansong.me/n/471642951828&#34;&gt;http://chuansong.me/n/471642951828&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/zhu_tianwei/article/details/72632078&#34;&gt;https://blog.csdn.net/zhu_tianwei/article/details/72632078&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/xiaogan/p/5954678.html&#34;&gt;https://www.cnblogs.com/xiaogan/p/5954678.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/dns/">DNS</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/dnsmasq/">dnsmasq</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/dns/">DNS</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker 存储驱动 overlay 和 overlay2 介绍</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-storage-drive/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-storage-drive/</guid>
                <pubDate>Sat, 10 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 docker 的存储驱动 overlay 和 overlay2，对于理解 docker 的文件系统非常有帮助。&lt;/p&gt;
&lt;h3 id=&#34;overlay-和-overlay2&#34;&gt;overlay 和 overlay2&lt;/h3&gt;
&lt;p&gt;OverlayFS 是一个类似于 AUFS 的联合文件系统，更快，实现更简单。OverlayFS 是内核提供的文件系统，overlay 和overlay2 是 docker 的存储驱动方式。&lt;/p&gt;
&lt;p&gt;修改 docker 的存储驱动为 &lt;code&gt;overlay2&lt;/code&gt;，创建 &lt;code&gt;/etc/docker/daemon.json&lt;/code&gt;，添加如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
    &amp;#34;storage-driver&amp;#34;: &amp;#34;overlay2&amp;#34;   
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果是 &lt;code&gt;CentOS7&lt;/code&gt; 或者 &lt;code&gt;RedHat7&lt;/code&gt; 内核在 &lt;code&gt;3.10.0-693&lt;/code&gt; 以下的，则添加如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
    &amp;#34;storage-driver&amp;#34;:&amp;#34;overlay2&amp;#34;,
    &amp;#34;storage-opts&amp;#34;:[
        &amp;#34;overlay2.override_kernel_check=true&amp;#34;
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;overlay-原理&#34;&gt;overlay 原理&lt;/h3&gt;
&lt;p&gt;OverlayFS与AUFS相似，也是一种联合文件系统。与AUFS相比，OverlayFS设计更简单，可能更快，也已经被加入Linux内核。&lt;/p&gt;
&lt;h4 id=&#34;overlayfs-中镜像的分层和共享&#34;&gt;OverlayFS 中镜像的分层和共享&lt;/h4&gt;
&lt;p&gt;OverlayFS将一个Linux主机中的两个目录组合起来，一个在上，一个在下，对外提供统一的视图。这两个目录就是层layer，将两个层组合在一起的技术被称为联合挂载（union mount）。在OverlayFS中，上层的目录被称为upperdir，下层的目录被称为lowerdir，对外提供的统一视图被称为merged。&lt;/p&gt;
&lt;p&gt;下图展示了容器和镜像的层与 &lt;code&gt;OverlayFS&lt;/code&gt; 的 &lt;code&gt;upperdir&lt;/code&gt;，&lt;code&gt;lowerdir&lt;/code&gt; 以及 &lt;code&gt;merged&lt;/code&gt; 之间的对应关系：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/docker/storage-drive/WechatIMG695.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图1 · OverlayFS 存储架构
&lt;/center&gt;
&lt;p&gt;由上图可以看出，在一个容器中，容器层（container layer）也就是读写层对应于 OverlayFS 的 upperdir，容器使用的对象镜像对应于 OverlayFS 的 lowerdir，容器文件系统的挂载点对应merged。&lt;/p&gt;
&lt;p&gt;注意，镜像层和容器层可以有相同的文件，在这种情况下，upperdir 中的文件覆盖 lowerdir 中的文件&lt;/p&gt;
&lt;p&gt;OverlayFS 仅有两层，也就是说镜像中的每一层并不对应 OverlayFS中的层，而是镜像中的每一层对应 &lt;code&gt;/var/lib/docker/overlay&lt;/code&gt; 中的一个目录，目录以该层的UUID命名。然后使用硬链接将下面层的文件引用到上层。这在一定程度上节省了磁盘空间。这样，OverlayFS中的lowerdir就对应镜像层的最上层，并且是只读的。在创建容器时，docker会新建一个目录作为OverlayFS的upperdir，它是可写的。&lt;/p&gt;
&lt;p&gt;OverlayFS 中容器的读写操作&lt;/p&gt;
&lt;p&gt;读：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果该文件在容器层不存在，即文件不存在upperdir中，则从lowerdir中读取。&lt;/li&gt;
&lt;li&gt;如果该文件只在容器层存在，即文件只存在于upperdir中，则直接从容器中读取该文件。&lt;/li&gt;
&lt;li&gt;如果文件同时存在于容器层和镜像层，容器层upperdir中的同名文件会覆盖镜像层lowerdir中的文件。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;修改：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;首次写入：第一次修改时，容器层中不存在该文件，在overlay和overlay2中，overlay驱动执行copy-up操作，将文件从loweridr复制到upperdir中，然后对文件的副本做出修改。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;需要说明的是，overlay的copy-up操作工作在文件层面，不是块层面，这意味着对文件的修改需要将整个文件复制到upperdir中，不过下面这两点使这一操作的开销很小：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;copy-up操作仅发生在文件第一次被修改时，此后对文件的读写都直接在upperdir中进行。&lt;/li&gt;
&lt;li&gt;OverlayFS中仅有两层，这使得文件的查找效率很高（相对于AUFS）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;删除文件和目录&lt;/p&gt;
&lt;p&gt;当文件在容器内被删除时，在容器层（upperdir）创建whiteout文件，镜像层的文件是不会被删除的，因为它们是只读的，但whiteout文件会阻止它们展现。&lt;/p&gt;
&lt;p&gt;当目录在容器内被删除时，在容器层（upperdir）中创建一个不透明的目录，和上面的whiteout一样，阻止用户继续访问，即使镜像层仍然存在。&lt;/p&gt;
&lt;h4 id=&#34;性能对比&#34;&gt;性能对比&lt;/h4&gt;
&lt;p&gt;使用 overlay 和 overlay2 驱动性能好于 aufs 和 devicemapper，在实际生产环境，overlay2的性能高于btrfs，但是还需要注意以下细节：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;页缓存：OverlayFS支持页缓存共享，也就是说如果多个容器访问同一个文件，可以共享同一个页缓存。这使得Overlay/Overlay2驱动高效地利用了内存。&lt;/li&gt;
&lt;li&gt;copy_up：overlay的复制操作工作在文件层面上，也就是对文件的第一次修改需要复制文件整个文件，这会带来一些性能开销，在修改大文件时尤其如此。但是overlay的复制操作比AUFS还是快一点，因为AUFS有很多层，而overlay只有两层，所以overlay在文件的搜索方面相对于AUFS具有优势。&lt;/li&gt;
&lt;li&gt;inode限制：使用overlay存储驱动可能导致inode过度消耗，特别是当容器和镜像很多的情况下，所以推荐使用overlay2。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;overlay和overlay2的本质区别是镜像层之间共享数据的方法不同，overlay共享数据的方式是通过硬链接，而overlay2则是通过每层的lower文件。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/vchy_zhao/article/details/70238690&#34;&gt;https://blog.csdn.net/vchy_zhao/article/details/70238690&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/vchy_zhao/article/details/70238690&#34;&gt;https://blog.csdn.net/vchy_zhao/article/details/70238690&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/zhonglinzhang/article/details/80970411&#34;&gt;https://blog.csdn.net/zhonglinzhang/article/details/80970411&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>消息队列简介</title>
                <link>https://xdhuxc.github.io/posts/message/message-queue-model/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/message/message-queue-model/</guid>
                <pubDate>Sat, 10 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客简单介绍下消息中间件，其特点及消息传递模型。&lt;/p&gt;
&lt;h3 id=&#34;消息中间件&#34;&gt;消息中间件&lt;/h3&gt;
&lt;p&gt;消息中间件是在消息的传输过程中保存消息的容器。消息中间件在将消息从消息生产者传输到消息消费者的过程中充当中间人的角色。队列的主要目的是提供路由并保证消息的传送；如果发送消息时接收者不可用，消息队列会保存消息，直到可以成功地传递它为止。当然，消息队列保存消息也是有期限的。&lt;/p&gt;
&lt;h3 id=&#34;消息中间件特点&#34;&gt;消息中间件特点&lt;/h3&gt;
&lt;h4 id=&#34;采用异步处理模式&#34;&gt;采用异步处理模式&lt;/h4&gt;
&lt;p&gt;消息发送者可以发送一个消息而无须等待响应。消息发送者将消息发送到一条虚拟的通道（主题或者队列）上，消息接收者则订阅或者监听该通道。一条消息可能最终转发给一个或者多个消息接收者，这些接收者都无需对消息发送者做出同步回应。整个过程是异步的。&lt;/p&gt;
&lt;p&gt;例如，用户注册账号，注册完成后发送邮件或者短信&lt;/p&gt;
&lt;h4 id=&#34;应用程序和应用程序调用关系为松耦合关系&#34;&gt;应用程序和应用程序调用关系为松耦合关系&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;发送者和接收者不必要了解对方，只需要确认消息。&lt;/li&gt;
&lt;li&gt;发送者和接收者不必同时在线。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;比如，在线交易系统为了保证数据的最终一致，在支付系统处理完成后会把支付结果放到消息中间件里通知订单系统修改订单支付状态。两个系统通过消息中间件解耦。&lt;/p&gt;
&lt;h3 id=&#34;消息中间件的传递模型&#34;&gt;消息中间件的传递模型&lt;/h3&gt;
&lt;h4 id=&#34;点对点模型ptp&#34;&gt;点对点模型（PTP）&lt;/h4&gt;
&lt;p&gt;点对点模型用于消息生产者和消息消费者之间点对点的通信。消息生产者将消息发送到由某个名称标识的特定消费者。这个名称实际上对应于消费服务中的一个队列，在消息传递给消费者之前，它会被存储在这个队列中。消息队列可以放在内存中，也可以是持久的，以保证在消息服务出现故障时仍然能够传递消息。&lt;/p&gt;
&lt;p&gt;点对点模型特性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;每个消息只有一个消费者；&lt;/li&gt;
&lt;li&gt;发送者和接收者没有时间依赖；&lt;/li&gt;
&lt;li&gt;接收者确认消息接收和处理成功；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;F:/Visio/message-queue/point-to-point.jpg&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;发布订阅模型pubsub&#34;&gt;发布/订阅模型（Pub/Sub）&lt;/h4&gt;
&lt;p&gt;发布者/订阅者模型支持向一个特定的消息主题生产消息。0或多个订阅者可能对接收来自特定消息主题的消息感兴趣。在这种模型下，发布者和订阅者彼此不知道对方。这种模式好比是匿名公告板。这种模式被概括为：多个消费者可以获得消息。在发布者和订阅者之间存在时间依赖性。发布者需要建立一个订阅，以便能够让消费者订阅。订阅者必须保持持续的活动状态以接收消息，除非订阅者建立了持久地订阅，在这种情况下，在订阅者未连接时发布的消息将在订阅者重新连接时重新发布。&lt;/p&gt;
&lt;p&gt;其实，消息中间件，像MySQL也可以作为消息中间件，只要把消息中间件的原理搞清楚，就会发现目前所有的存储，包括NoSQL，只要支持顺序性的东西，就可以作为一个消息中间件。就看我们如何去使用它，比如redis中的队列list，就可以作为一个消息队列。&lt;/p&gt;
&lt;p&gt;发布-订阅模型特性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;每个消息可以有多个订阅者；&lt;/li&gt;
&lt;li&gt;客户端只有订阅后才能接收到消息；&lt;/li&gt;
&lt;li&gt;持久订阅和非持久订阅；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;F:/Visio/message-queue/pub-sub.jpg&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;（1）发布者和订阅者有时间依赖，接收者和发布者只有在建立订阅关系后，接收者才能收到消息。&lt;/p&gt;
&lt;p&gt;（2）持久订阅，订阅关系建立后，消息就不会消失，不管订阅者是否在线。&lt;/p&gt;
&lt;p&gt;（3）非持久订阅，订阅者为了接收消息，必须一直在线，当只有一个订阅者时，约等于点对点模式。&lt;/p&gt;
&lt;p&gt;大部分情况下会使用持久订阅。&lt;/p&gt;
&lt;p&gt;常用的消息队列有：Kafka、RabbitMQ、ActiveMQ、Metaq。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/zhaojiankai/p/7181910.html?utm_source=itdadao&amp;amp;utm_medium=referral&#34;&gt;https://www.cnblogs.com/zhaojiankai/p/7181910.html?utm_source=itdadao&amp;amp;utm_medium=referral&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">消息队列</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>GoTTY 的简单使用</title>
                <link>https://xdhuxc.github.io/posts/tools/tools-gotty/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/tools/tools-gotty/</guid>
                <pubDate>Fri, 09 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要记录下 GoTTY 的简单使用方式，或许以后可以在项目中用到。&lt;/p&gt;
&lt;h3 id=&#34;gotty-简介&#34;&gt;GoTTY 简介&lt;/h3&gt;
&lt;p&gt;GoTTY 是一个简单的命令行工具，可以将 CLI 工具转换为 Web 应用程序，经常被用来实现 Web 终端。&lt;/p&gt;
&lt;h3 id=&#34;gotty-部署&#34;&gt;GoTTY 部署&lt;/h3&gt;
&lt;p&gt;1、下载稳定版 gotty 二进制安装文件&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/yudai/gotty&#34;&gt;Gotty - GitHub&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2、解压安装包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tar -zxf gotty_2.0.0-alpha.3_linux_amd64.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 gotty
pod 启动方式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nohup ./gotty -w -p 9988 --permit-arguments --reconnect kubectl exec -it &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;容器启动方式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nohup ./gotty -w -p 8888 --permit-arguments --reconnect docker exec -it &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;主机启动方式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt; nohup ./gotty -w -p 8899 --permit-arguments --reconnect sh &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、在浏览器中访问
命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubectl exec -it nginx-567d57d4c4-5spp9 -n default bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;浏览器中访问 pod 的 url&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.26.150:8899/?arg=nginx-567d57d4c4-5spp9&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;arg=-n&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;arg=default&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;arg=bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker exec -it b96f8e834f51 bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;浏览器中访问 docker 容器 url&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.26.150:8899/?arg=b96f8e834f51&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;arg=bash
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;浏览器中访问宿主机的 url&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.26.150:8899/?
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;需要在每一台机器上都运行一个探针，在一个 gotty 容器中启动三个 gotty 进程，分别在不同的端口监听容器、pod和宿主机的控制台请求。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/cj2580/article/details/79318726&#34;&gt;https://blog.csdn.net/cj2580/article/details/79318726&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/gotty/">GoTTY</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Vagrant 常用命令和资料</title>
                <link>https://xdhuxc.github.io/posts/tools/tools-vagrant/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/tools/tools-vagrant/</guid>
                <pubDate>Wed, 07 Nov 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要记录下 vagrant 常用的命令。&lt;/p&gt;
&lt;h3 id=&#34;vagrant-简介&#34;&gt;vagrant 简介&lt;/h3&gt;
&lt;p&gt;Vagrant 是一个用于在单个工作流中构建和管理虚拟机环境的工具。凭借着易于使用的工作流和专注于自动化，Vagrant 缩短了开发环境的设置时间，提高了生产效率，并使 &lt;code&gt;在我的机器上正常工作&lt;/code&gt; 成为了过去的遗物。&lt;/p&gt;
&lt;h3 id=&#34;vagrant-命令&#34;&gt;vagrant 命令&lt;/h3&gt;
&lt;p&gt;1、初始化 vagrant 工程&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vagrant init xdhuxc centos/7
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动虚拟机&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vagrant up --provider virtualbox
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、登录虚拟机&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vagrant ssh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、关闭虚拟机&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vagrant halt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、删除虚拟机&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vagrant destroy
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;vagrant destroy&lt;/code&gt; 只会删除虚拟机本身，也即你在 &lt;code&gt;VirtualBox&lt;/code&gt; 将看不到该虚拟机，但是不会删除该虚拟机所使用的 &lt;code&gt;box&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;6、打包镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vagrant xdhuxc # 会在当前目录下生成 xdhuxc.box 文件，后续可直接使用该文件恢复环境。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、导入 box&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vagrant box add box_name box_uri
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;vagrant box add centos7.4 E:/boxes/CentOS-7.4-x86_64-minimal.box
或
vagrant box add centos7.4 https://vagrantcloud.com/centos/boxes/7/versions/1710.01/providers/virtualbox.box &lt;span class=&#34;ni&#34;&gt;#会从远程下载相应的box文件&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;1、虚拟机的配置信息在 vagrantfile 中，使用 &lt;code&gt;vagrant up&lt;/code&gt; 启动的虚拟机会重新创建网络等配置，因此最好在 vagrantfile 中指定这些信息。&lt;/p&gt;
&lt;p&gt;2、由于 &lt;code&gt;vagrant&lt;/code&gt; 默认不显示虚机启动界面，在 &lt;code&gt;Vagrantfile&lt;/code&gt; 配置中增加 &lt;code&gt;vb.gui = true&lt;/code&gt; 选项，就可以查看虚机的启动过程。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;学习资料 &lt;a href=&#34;https://www.cnblogs.com/davenkin/p/vagrant-virtualbox.html&#34;&gt;https://www.cnblogs.com/davenkin/p/vagrant-virtualbox.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Vagrantfile &lt;a href=&#34;https://blog.csdn.net/u011781521/article/details/80291765&#34;&gt;https://blog.csdn.net/u011781521/article/details/80291765&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;box 下载地址 &lt;a href=&#34;https://app.vagrantup.com/centos/boxes/7&#34;&gt;https://app.vagrantup.com/centos/boxes/7&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;box下载地址 &lt;a href=&#34;https://github.com/CommanderK5/packer-centos-template/releases&#34;&gt;https://github.com/CommanderK5/packer-centos-template/releases&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vagrant/">Vagrant</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>SpringBoot 应用启动报错，Unregistering JMX-exposed beans on shutdown</title>
                <link>https://xdhuxc.github.io/posts/programming/java/java-springboot-jmx/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/java/java-springboot-jmx/</guid>
                <pubDate>Thu, 25 Oct 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇文章介绍了使用 &lt;code&gt;Spring Boot&lt;/code&gt; 过程中遇到的一个错误及最终的解决方法，控制台输出的主要错误信息为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;AnnotationMBeanExporter : Unregistering JMX-exposed beans on shutdown
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 &lt;code&gt;Spring Boot&lt;/code&gt; 编写的Java 程序，其 &lt;code&gt;pom.xml&lt;/code&gt;文件内容为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;	&amp;lt;parent&amp;gt;
		&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
		&amp;lt;artifactId&amp;gt;spring-boot-starter-parent&amp;lt;/artifactId&amp;gt;
		&amp;lt;version&amp;gt;1.5.13.RELEASE&amp;lt;/version&amp;gt;
	&amp;lt;/parent&amp;gt;
	&amp;lt;dependencies&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-starter-web&amp;lt;/artifactId&amp;gt;
		&amp;lt;/dependency&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;spring-boot-starter-data-mongodb&amp;lt;/artifactId&amp;gt;
		&amp;lt;/dependency&amp;gt;
	&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行该程序时，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  .   ____          _            __ _ _
 /\\ / ___&#39;_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | &#39;_ | &#39;_| | &#39;_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  &#39;  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::       (v1.5.13.RELEASE)

2018-05-19 16:34:04.386  INFO 3332 --- [           main] com.xdhuxc.cloud.MongodbApp              : Starting MongodbApp on DESKTOP-OC6TL9S with PID 3332 (E:\eclipse-workspace\xdhuxc-mongodb\target\classes started by wanghuan in E:\eclipse-workspace\xdhuxc-mongodb)
2018-05-19 16:34:04.389  INFO 3332 --- [           main] com.xdhuxc.cloud.MongodbApp              : No active profile set, falling back to default profiles: default
2018-05-19 16:34:04.430  INFO 3332 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@7b227d8d: startup date [Sat May 19 16:34:04 CST 2018]; root of context hierarchy
2018-05-19 16:34:06.069  INFO 3332 --- [           main] org.mongodb.driver.cluster               : Cluster created with settings {hosts=[192.168.91.128:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout=&#39;30000 ms&#39;, maxWaitQueueSize=500}
2018-05-19 16:34:06.536  INFO 3332 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup
2018-05-19 16:34:06.545  INFO 3332 --- [           main] com.xdhuxc.cloud.MongodbApp              : Started MongodbApp in 2.436 seconds (JVM running for 2.755)
2018-05-19 16:34:06.545  INFO 3332 --- [       Thread-2] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@7b227d8d: startup date [Sat May 19 16:34:04 CST 2018]; root of context hierarchy
2018-05-19 16:34:06.546  INFO 3332 --- [       Thread-2] o.s.j.e.a.AnnotationMBeanExporter        : Unregistering JMX-exposed beans on shutdown
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;使用搜索引擎搜索 &lt;code&gt;Unregistering JMX-exposed beans on shutdown&lt;/code&gt;，
提出的方案基本都是显式添加 &lt;code&gt;tomcat&lt;/code&gt; 的依赖，向 &lt;code&gt;pom.xml&lt;/code&gt; 文件中加入如下内容：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
	&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;spring-boot-starter-tomcat&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;但是很遗憾，并没有起多大作用，还是报同样的错误。
最后，尝试着修改了一下 &lt;code&gt;Spring Boot&lt;/code&gt; 的版本，降级试试，于是，修改 &lt;code&gt;pom.xml&lt;/code&gt; 文件为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;lt;parent&amp;gt;
	&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
	&amp;lt;artifactId&amp;gt;spring-boot-starter-parent&amp;lt;/artifactId&amp;gt;
	&amp;lt;version&amp;gt;1.5.12.RELEASE&amp;lt;/version&amp;gt;
&amp;lt;/parent&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;终于可以正常启动 &lt;code&gt;Spring Boot&lt;/code&gt; 程序了！&lt;/p&gt;
&lt;p&gt;这应该是 &lt;code&gt;Spring Boot&lt;/code&gt; &lt;code&gt;1.5.12.RELEASE&lt;/code&gt; 的一个bug。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/springboot/">SpringBoot</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/java/">Java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 中 systemd 的使用</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-systemd/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-systemd/</guid>
                <pubDate>Tue, 23 Oct 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Linux 下 服务管理工具 systemd 的使用。&lt;/p&gt;
&lt;h3 id=&#34;systemd-service&#34;&gt;systemd service&lt;/h3&gt;
&lt;p&gt;一种以 &lt;code&gt;.service&lt;/code&gt; 结尾的单元（unit）配置文件，用于控制由systemd控制或监视的进程。简单来说，用于在后台以守护进程的方式运行程序。&lt;/p&gt;
&lt;p&gt;其基本特征有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;支持并行化任务&lt;/li&gt;
&lt;li&gt;同时采用 &lt;code&gt;socket&lt;/code&gt; 式与 &lt;code&gt;D-Bus&lt;/code&gt; 总线式激活服务&lt;/li&gt;
&lt;li&gt;按需启动守护进程（daemon）&lt;/li&gt;
&lt;li&gt;利用 &lt;code&gt;linux&lt;/code&gt; 的 &lt;code&gt;cgroups&lt;/code&gt; 监视进程&lt;/li&gt;
&lt;li&gt;支持快照和系统恢复&lt;/li&gt;
&lt;li&gt;维护挂载点和自动挂载点&lt;/li&gt;
&lt;li&gt;各服务间基于依赖关系进行精密控制&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;systemd&#34;&gt;systemd&lt;/h3&gt;
&lt;h4 id=&#34;基本结构&#34;&gt;基本结构&lt;/h4&gt;
&lt;p&gt;systemd 服务的主要内容分为三个部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;控制单元的定义&lt;/li&gt;
&lt;li&gt;服务的定义&lt;/li&gt;
&lt;li&gt;安装部分&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;说明&#34;&gt;说明&lt;/h4&gt;
&lt;p&gt;1、&lt;code&gt;systemd&lt;/code&gt; 单元文件中的以 &lt;code&gt;#&lt;/code&gt; 开头的行后面的内容会被认为是注释。&lt;/p&gt;
&lt;p&gt;2、&lt;code&gt;systemd&lt;/code&gt; 下的布尔值：&lt;code&gt;1&lt;/code&gt;、&lt;code&gt;yes&lt;/code&gt;、&lt;code&gt;on&lt;/code&gt;、&lt;code&gt;rue&lt;/code&gt; 都是开启；&lt;code&gt;0&lt;/code&gt;、&lt;code&gt;no&lt;/code&gt;、&lt;code&gt;off&lt;/code&gt;、&lt;code&gt;false&lt;/code&gt; 都是关闭，仅限于 &lt;code&gt;systemd&lt;/code&gt; 文件，不适用于该文件中嵌入的 &lt;code&gt;shell&lt;/code&gt; 语句。&lt;/p&gt;
&lt;p&gt;3、&lt;code&gt;systemd&lt;/code&gt; 下的时间单位默认是秒，因此，使用毫秒，分钟时要显式说明。&lt;/p&gt;
&lt;h4 id=&#34;示例说明&#34;&gt;示例说明&lt;/h4&gt;
&lt;p&gt;以如下service文件为示例进行语法说明&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=Network Manager
After=syslog.target
Wants=remote-fs.target network.target

[Service]
Type=dbus
BusName=org.freedesktop.NetworkManager
ExecStart=/usr/sbin/NetworkManager --no-daemon
EnvironmentFile=/etc/sysconfig/network/config
ExecStartPre=/usr/bin/test &amp;#34;x${NETWORKMANAGER}&amp;#34; = xyes
&lt;span class=&#34;gh&#34;&gt;# Suppress stderr to eliminate duplicated messages in syslog. NM calls openlog()
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# with LOG_PERROR when run in foreground. But systemd redirects stderr to
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# syslog by default, which results in logging each message twice.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;StandardError=null

[Install]
WantedBy=multi-user.target
Also=NetworkManager-wait-online.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;定义控制单元&#34;&gt;定义控制单元&lt;/h4&gt;
&lt;p&gt;在 &lt;code&gt;systemd&lt;/code&gt; 中，所有引导过程中 &lt;code&gt;systemd&lt;/code&gt; 要控制的东西都是一个单元。&lt;code&gt;systemd&lt;/code&gt; 的单元类型有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;系统服务（.service）&lt;/li&gt;
&lt;li&gt;套接字（.sockets）&lt;/li&gt;
&lt;li&gt;设备（.device）&lt;/li&gt;
&lt;li&gt;挂载点（.mount）&lt;/li&gt;
&lt;li&gt;自动挂载点（）&lt;/li&gt;
&lt;li&gt;交换分区（.swap）&lt;/li&gt;
&lt;li&gt;分区（）&lt;/li&gt;
&lt;li&gt;启动对象（.target）&lt;/li&gt;
&lt;li&gt;文件系统路径（.path）&lt;/li&gt;
&lt;li&gt;定时器（）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;单元名即 &lt;code&gt;.service&lt;/code&gt; 文件的名称。但不只有 &lt;code&gt;.service&lt;/code&gt; 后缀的文件才可以是一个 单元，单元还可以有 &lt;code&gt;.target&lt;/code&gt;, &lt;code&gt;.path&lt;/code&gt;等后缀，具体可以在 &lt;code&gt;/usr/lib/systemd/system&lt;/code&gt; 下了解。但这些后缀要么由 systemd 上游开发者写好随 systemd 软件包分发，要么由 Base:system 团队添加，一般用户是不太需要写其它后缀的控制单元的。&lt;/p&gt;
&lt;p&gt;单元文件可以从两个地方进行加载，优先级从低到高分别是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;/usr/lib/systemd/system/ ：软件包安装的单元&lt;/li&gt;
&lt;li&gt;/etc/systemd/system/ ：系统管理员安装的单元&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;1）声明我们在定义控制单元，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）添加单元描述，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=Daemon to start He.net IPv6
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）systemd对各个单元之间关系的控制：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=Daemon to start He.net IPv6
Wants=network-online.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Requires，当前单元启动了，那么它所需要的单元也会被启动；当前单元需要的单元被停止了，那么它自己也活不了。但是请注意，这个设定并不能控制某单元与其所需要的单元的启动顺序（启动顺序是另外控制的），即 systemd 不是先启动本单元所需要的单元，再启动本单元，而是在本单元被激活时，并行启动两者，因此会产生争分夺秒的问题。如果当前单元所需要的单元先启动成功，那么皆大欢喜; 如果当前单元所需要的单元启动得慢，那么本单元就会启动失败（systemd 没有自动重试）。因此，为了系统的健壮性，不建议使用这个标记，而建议使用 Wants 标记。可以使用多个 Requires。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RequiresOverridable：跟 Requires 很像。但是如果这条服务是由用户手动启 动的，那么 RequiresOverridable 后面的服务即使启动不成功也不报错。跟 Requires 比增加了一定的容错性，但是你要确定你的服务是有等待功能的。另外，如果不由用户手动启动而是随系统开机启动，那么依然会有 Requires 面临的问题.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Requisite：强势版本的Requires，要是这里需要的服务启动不成功，那本单元文件不管能不能检测，等不能等待都会立刻就失败。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Wants：推荐使用。本单元启动了，它所需要的单元也会被启动，如果启动不成功，对本单元没有影响。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Conflicts：一个单元的启动会停止与它冲突的单元，反之亦然。注意这里和后面的启动顺序是“正交”的：
两个相互冲突的单元被同时启动，要么两个都启动不了（两者都是第三个单元的 Requires），要么启动一个（有一个是第三个单元的Requires，另一个不是），不是 Requires 的那个会被停止。要是两者都不是任何一个单元的Requires，那么 Conflicts 别的那个单元优先启动，被Conflicts的后启动，要是互相写了，那么两个都启动不了。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;OnFailure：很明显，如果本单元启动失败了，那么启动什么单元作为折衷。
我们的单元，Ipv6 隧道，应该想要什么呢？很显然是一个连通着的网络。有一个 systemd 默认提供的对象叫做 network-online.target（默认的 target 列表可见 &lt;a href=&#34;https://www.freedesktop.org/software/systemd/man/systemd.special.html&#34;&gt;systemd.special&lt;/a&gt;，因为你大多数时候Wants的都是一个固定的系统状态而不是其它 systemd服务），正好能够提供我们需要的环境。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;4）定义服务启动顺序&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=Daemon to start He.net IPv6
Wants=network-online.target
After=network.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;systemd 服务启动顺序主要使用以下两个标记定义的：&lt;/p&gt;
&lt;p&gt;Before/After：要是一个服务在另一个服务之前启动，那么在并行启动时（systemd 总是用进程 0 并行启动所有东西，然后通过这两个标记来二次等待排序），另一个服务这时就会等这个服务先启动并返回状态，注意是先启动，而不是先启动成功，因为失败也是一种状态，一定要成功才启动另一个服务是通过依赖关系定义的。反之 After 亦然。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;关机&lt;/code&gt;（可以是挂起，这时候有些服务依然在运行，比如网络唤醒等）时候的顺序：如果两个服务都是要关掉的，Before 是先停止自己，After 是先停止别人； 但如果一个服务要停止，而另一个服务要启动，那么不管 Before/After 如何写，总是优先关闭而不是开始。也就是比如服务 A Before 服务 B，但是服务 B 是在关，而服务 A 是在 restart，那么服务 B 的顺序在服务 A 的前面。&lt;/p&gt;
&lt;p&gt;我们的单元应该在什么服务的前后启动呢？它不需要一定在什么服务前面跑起来，这不像 ifup 和 dhcp，网络起不来获取 ip 肯定没用。我们只需要有网就可以了。&lt;code&gt;有网&lt;/code&gt; 在 systemd 中也是由一个默认 &lt;code&gt;target：network.target&lt;/code&gt; 提供的，&lt;/p&gt;
&lt;h4 id=&#34;定义服务本体&#34;&gt;定义服务本体&lt;/h4&gt;
&lt;p&gt;1）声明服务本体，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Service]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）声明服务的类型，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Service]
Type=
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;systemd 支持的服务类型有以下几类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;simple， 默认服务类型，最简单的服务类型。就是说启动的程序就是主体程序，该程序要是退出，那么一切皆休。这在图形界面里非常好理解，用户打开一个窗口，退出它就没有了。但是命令行中的大部分程序都不会这样设计，因为命令行程序的一个最基本的原则就是：一个好的程序不能独占命令行窗口。因此，输入命令，回车，接着马上返回提示符，但程序已经执行了。在这种类型下，如果主程序是要响应其它程序的，那么你的通信频道应该在启动本服务前就设好（套接字等），因此这种类型的服务，Systemd 运行它后会立刻就运行下面的服务（需要它的服务），这时没有套接字后面的服务会失败，写 After 也没用，因为 simple 类型不存在主进程退出的情况，也就不存在有返回状态的情况，所以它一旦启动就认为是成功的，除非没起来。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;forking，标准 Unix Daemon 使用的启动方式。启动程序后会调用 fork() 函数，把必要的通信频道都设置好之后父进程退出，留下守护进程的子进程。使用这种方式，最好也指定下 PIDFILE=，不要让 systemd 去猜，非要猜也可以，把 GuessMainPID 设为 yes。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;判断是 forking 还是 simple 类型非常简单，命令行里运行下程序，持续占用命令行要按 Ctrl + C 才可以的，就不会是 forking 类型。&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;创建 PIDFILE 是为它写服务的程序的任务，而不是 systemd 的功能，甚至也不是 SysV init 脚本的功能。因此，如果你的程序确实是 forking 类型，但没有实现创建 PIDFILE 的功能，那么建议使用 ExecStartPost= 结合 shell 命令来手动抓取进程编号并写到 /var/run/xxx.pid文件中。&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;oneshot，一次性的，这种服务类型就是启动，完成，没进程了。常见的，比如设置网络，ifup eth0 up，就是一次性的，不存在 ifup 的子进程，也不存在主进程，运行完成后便了无痕迹。由于这类服务运行完就没有进程了，我们经常会需要 &lt;code&gt;RemainAfterExit=yes&lt;/code&gt;。后面配置的意思是说，即使没进程了, systemd 也认为该服务是存在并成功了。所以如果你有一个这样的服务，服务启动后，你再去 ifup eth0 up，这时你再看服务，依然显示是 running 的。因为只要在执行那条一次性命令的时候没出错，那么它就永远认为它是成功并一直存在的，直到你关闭服务。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;dbus，程序启动时需要获取一块 DBus 空间，所以需要和 BusName= 一起使用。只有它成功获得了 DBus 空间，依赖它的程序才会被启动。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一般情况下，只能用到上面四个，还有两种少见的类型：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;notify， 程序在启动完成后会通过 sd_notify 发送一个通知消息。所以还需要配合 NotifyAccess 来让 systemd 接收消息，后者有三个级别：none，所有消息都忽略掉; main，只接受程序的主进程发过去的消息; all，程序的所有进程发过去的消息都算。NotifyAccess 要是不写的话，默认是 main。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;idle，程序要等它里面调度的全部其它东西都运行完才会运行它自己。比如你 ExecStart 的是个 shell 脚本，里面可能运行了一些别的东西，如果不这样的话，那很可能别的东西的控制台输出里会多一个“启动成功”这样的 systemd 消息。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由于 He.net 的 IPv6 是用 iproute2 的 ip 命令来弄的，所以是一个 oneshot 一次性服务。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Service]
Type=oneshot
RemainAfterExit=yes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;接下来要设置 ExecStart, ExecStop。如果程序支持的话，还可以去设置 ExecReload，Restart 等。注意，这里设置的是它们 Reload/Restart 的方式，但并不代表没有它们， systemd 就不能完成比如 &lt;code&gt;systemctl restart xxx.service&lt;/code&gt; 这样的任务，程序有支持自然最好，程序不支持那就先 stop 再 start。同样，有特殊要求的时候也可以去设置比如 ExecStartPre，ExecStartPost，RestartSec，TimeoutSec 等其它东西。&lt;/p&gt;
&lt;p&gt;这里要特殊讲一下 ExecStart：&lt;/p&gt;
&lt;p&gt;如果你服务的类型不是 &lt;code&gt;oneshot&lt;/code&gt; ，那么它只可以接受一个命令，参数不限，比如你先 &lt;code&gt;ip tunnel create&lt;/code&gt; 再 &lt;code&gt;ip tunnel0 up&lt;/code&gt;，那是两个 ip 命令，如果不是 &lt;code&gt;oneshot&lt;/code&gt; 类型这样是不行的。
如果有多条命令（oneshot 类型），命令之间以分号 &lt;code&gt;;&lt;/code&gt; 分隔，跨行可用反斜杠 &lt;code&gt;\&lt;/code&gt;。除非你的服务类型是 &lt;code&gt;forking&lt;/code&gt; ，否则在这里输入的命令都会被认为是主进程，不管它是不是。&lt;/p&gt;
&lt;h4 id=&#34;安装服务&#34;&gt;安装服务&lt;/h4&gt;
&lt;p&gt;这里说的 &lt;code&gt;安装&lt;/code&gt; 是一种内部状态，默认放对service文件位置，显示的是 disabled，unloaded，因此要在 systemd 内部对它进行加载，没人需要的东西是不需要安装的，所以要告诉 systemd 它是有人需要的，被谁需要。一般都是被需要的（&lt;code&gt;multi-user.target&lt;/code&gt; 表示多用户系统，简单理解就是你可以登入了）。这样在 &lt;code&gt;multi-user.target&lt;/code&gt; 启用时，我们的服务也就会被启用了。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;[Install] 部分下除了 WantedBy 还有两种属性，分别是：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Alias=&lt;/code&gt; ，别名，这样 &lt;code&gt;systemctl command xxx.service&lt;/code&gt; 的时候就可以不输入完整的单元名称。比如你给 &lt;code&gt;NetworkManager&lt;/code&gt; 取一个别名叫 &lt;code&gt;Alias=nm&lt;/code&gt;，那就可以 &lt;code&gt;systemctl status nm.service&lt;/code&gt; 查看实际是 &lt;code&gt;NetworkManager.service&lt;/code&gt; 的服务了。
&lt;code&gt;Also=&lt;/code&gt; ，安装本服务的时候还要安装别的什么服务。比如我们的 He.net 脚本按理应该需要一个 &lt;code&gt;iproute2.service&lt;/code&gt; 作为 also，但是 iproute2 实际上不需要 systemd 控制，所以就没写。它和 [Unit] 定义里面的依赖关系相比，它管理的不是运行时依赖，而是安装时。安装好了之后启动谁先谁后，谁依赖谁，和 &lt;code&gt;Also=&lt;/code&gt; 都没有关系。&lt;/p&gt;
&lt;h3 id=&#34;systemd-常用命令&#34;&gt;systemd 常用命令&lt;/h3&gt;
&lt;p&gt;1、检查docker服务环境变量是否加载&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl show docker --property Environment
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、异步启动服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl --no-block start etcd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/systemd/">systemd</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>etcd 常用命令和 API 总结</title>
                <link>https://xdhuxc.github.io/posts/storage/etcd/etcd-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/etcd/etcd-command/</guid>
                <pubDate>Mon, 15 Oct 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 etcd 中常用的命令和 API 的用法。&lt;/p&gt;
&lt;h3 id=&#34;常用命令&#34;&gt;常用命令&lt;/h3&gt;
&lt;p&gt;1、设置键值对&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;etcdctl set xdhuxc adobe
或
etcdctl set /xdhuxc adobe
或
curl -X PUT http://10.10.24.75:2379/v2/keys/xdhuxc -d value=&amp;#34;adobe&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、获取所有的key&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -s http://10.10.24.75:2379/v2/keys | python -m json.tool
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、获取键值对&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;etcdctl get xdhuxc
或
etcdctl get /xdhuxc
或
curl -s http://10.10.24.75:2379/v2/keys/xdhuxc | python -m json.tool
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、删除键值对&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;etcdctl rm xdhuxc
或
etcdctl rm /xdhuxc
或
curl -X –s DELETE http://127.0.0.1:2379/v2/keys/xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、查看当前集群中的节点和leader节点&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;etcdctl member list
或
curl -s http://172.20.26.149:2379/v2/members|python -m json.tool
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者使用 debug 模式查看&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;etcdctl --debug member list
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、查看etcd节点状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;etcdctl cluster-health
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;常用-api&#34;&gt;常用 API&lt;/h3&gt;
&lt;p&gt;1、查看 etcd 版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/version
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看所有的键&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/keys 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、创建键值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/keys/xdhuxc-key -XPUT -d value=&amp;#34;xdhuxc-value&amp;#34; # 创建键值对 xdhuxc-key=xdhuxc-value
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对于 put 方法，如果 key 之前存在，则默认会先删除，再新建一个 key。&lt;/p&gt;
&lt;p&gt;如果想要直接 update，则追加 -d prevExist=true，但是加了这个参数，如果 key 之前不存在，则会报错。&lt;/p&gt;
&lt;p&gt;4、创建目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/keys/xdhuxc-dir -XPUT -d dir=true # 创建目录 xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、创建带 TTL 的键值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/keys/xdhuxc-ttl-key -XPUT -d value=&amp;#34;xdhuxc-ttl-value&amp;#34; -d ttl=10 # 单位为秒
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、创建有序键值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/keys/xdhuxc-seq -XPOST -d value=&amp;#34;seqone&amp;#34;
curl http://10.10.24.28:2379/v2/keys/xdhuxc-seq -XPOST -d value=&amp;#34;seqtwo&amp;#34;
curl http://10.10.24.28:2379/v2/keys/xdhuxc-seq -XPOST -d value=&amp;#34;seqthree&amp;#34;
curl http://10.10.24.28:2379/v2/keys/xdhuxc-seq
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、删除指定的键&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/keys/xdhuxc-key -XDELETE # 删除键 xdhuxc-key
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、列出所有集群成员&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/members
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;9、查看 leader&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/stats/leader
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;10、节点自身信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/stats/self
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;11、查看集群运行状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://10.10.24.28:2379/v2/stats/store
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/etcd/">etcd</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 下 RPM 和 YUM 的使用</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-rpm-yum/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-rpm-yum/</guid>
                <pubDate>Mon, 15 Oct 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Linux 下 RPM 包管理工具的使用。&lt;/p&gt;
&lt;h3 id=&#34;rpm&#34;&gt;rpm&lt;/h3&gt;
&lt;p&gt;rpm 命令是 RPM 软件包的管理工具。rpm 原本是 Red Hat Linux 发行版专门用来管理 Linux 各项套件的程序，由于它遵循GPL规则且功能强大方便，因而广受欢迎。逐渐受到其他发行版的采用。RPM 套件管理方式的出现，让 Linux 易于安装，升级，间接提升了 Linux 的适用度。&lt;/p&gt;
&lt;h4 id=&#34;rpm包管理的用途&#34;&gt;rpm包管理的用途&lt;/h4&gt;
&lt;p&gt;1、可以安装、删除、升级和管理软件，当然也支持在线安装和升级软件；&lt;/p&gt;
&lt;p&gt;2、通过RPM包管理能知道软件包包含哪些文件，也能知道系统中的某个文件属于哪个软件包；&lt;/p&gt;
&lt;p&gt;3、可以在查询系统中的软件包是否安装以及其版本；&lt;/p&gt;
&lt;p&gt;4、作为开发者可以把自己的程序打包为RPM 包发布；&lt;/p&gt;
&lt;p&gt;5、软件包签名GPG和MD5的导入、验证和签名发布；&lt;/p&gt;
&lt;p&gt;6、依赖性的检查，查看是否有软件包由于不兼容而扰乱了系统；&lt;/p&gt;
&lt;h4 id=&#34;rpm-的使用权限&#34;&gt;rpm 的使用权限&lt;/h4&gt;
&lt;p&gt;RPM软件的安装、删除、更新只有 root 权限才能使用；&lt;/p&gt;
&lt;p&gt;对于查询功能任何用户都可以操作；&lt;/p&gt;
&lt;p&gt;如果普通用户拥有安装目录的权限，也可以进行安装；&lt;/p&gt;
&lt;h4 id=&#34;rpm命令&#34;&gt;rpm命令&lt;/h4&gt;
&lt;h5 id=&#34;初始化-rpm-数据库&#34;&gt;初始化 rpm 数据库&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm --initdb
rpm --rebuilddb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;软件包的安装升级和删除等&#34;&gt;软件包的安装、升级和删除等&lt;/h5&gt;
&lt;p&gt;1、安装 docker 包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -vih docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
或
rpm -ivh docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm --nodeps --force # 安装软件包时不检查依赖关系
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、升级 docker 包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -Uvh docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、删除软件包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -e docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;rpm-软件包管理的查询功能&#34;&gt;rpm 软件包管理的查询功能&lt;/h5&gt;
&lt;p&gt;1、查询系统已经安装的软件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -q docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
或
rpm --query docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看系统中所有已经安装的软件包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -qa
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查询一个已经安装的文件属于哪个软件包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -qf file_absolute_path
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、查询已安装软件包的安装位置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -ql docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
或
rpm rpmquery -ql docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、查询一个已安装软件包的信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -qi docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、查看已安装软件包的配置文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -qc docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、查看某个rpm包的依赖关系&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -qpR docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;rpm-包命名规则&#34;&gt;rpm 包命名规则&lt;/h4&gt;
&lt;p&gt;1、RPM包的一般格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;name-version-arch.rpm
name-version-arch.src.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;（1）name，如：httpd，是软件的名称&lt;/p&gt;
&lt;p&gt;（2）version，如:2.2.3 ,是软件的版本号。版本号的格式通常为“主版本号.次版本号.修正号”
29，是发布版本号，表示这个RPM包是第几次编译生成的&lt;/p&gt;
&lt;p&gt;（3）arch,如:i386,表示包的适用的硬件平台，目前RPM支持的平台有：i386、i586、i686、sparc、alpha&lt;/p&gt;
&lt;p&gt;（4）.rpm或.src.rpm,是RPM包类型的后缀，.rpm是编译好的二进制包，可用rpm命令直接安装；.src.rpm表示是源代码包，需要安装源码包生成源码，并对源码编译生成.rpm格式的RPM包，就可以对这个RPM包进行安装了&lt;/p&gt;
&lt;p&gt;2、特殊名称&lt;/p&gt;
&lt;p&gt;（1）el*  表示这个软件包的发行商版本,el5表示这个软件包是在RHEL 5.x/CentOS 5.x下使用。&lt;/p&gt;
&lt;p&gt;（2）devel：表示这个RPM包是软件的开发包。&lt;/p&gt;
&lt;p&gt;（3）noarch：说明这样的软件包可以在任何平台上安装，不需要特定的硬件平台。在任何硬件平台上都可以运行。&lt;/p&gt;
&lt;p&gt;（4）manual 手册文档&lt;/p&gt;
&lt;h3 id=&#34;yum&#34;&gt;yum&lt;/h3&gt;
&lt;p&gt;全称为 &lt;code&gt;Yellow dog Updater, Modified&lt;/code&gt;，是一个在&lt;code&gt;Fedora&lt;/code&gt;和&lt;code&gt;RedHat&lt;/code&gt;以及&lt;code&gt;SUSE&lt;/code&gt;中的&lt;code&gt;Shell前端软件包管理器&lt;/code&gt;。基于RPM包管理，能够从指定的服务器自动下载RPM包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软体包，无须繁琐地一次次下载、安装。&lt;/p&gt;
&lt;p&gt;yum提供了查找、安装、删除某一个、一组甚至全部软件包的命令，而且命令简洁而又好记。&lt;/p&gt;
&lt;p&gt;yum的宗旨是自动化地升级，安装/移除rpm包，收集rpm包的相关信息，检查依赖性并自动提示用户解决&lt;/p&gt;
&lt;p&gt;yum的关键之处是要有可靠的仓库，这是软件的仓库，它可以是http或ftp站点， 也可以是本地软件池，但必须包含rpm的header， header包括了rpm包的各种信息，包括描述，功能，提供的文件，依赖性等.正是收集了这些 header并加以分析，才能自动化地完成余下的任务。&lt;/p&gt;
&lt;h4 id=&#34;yum-的特点&#34;&gt;yum 的特点&lt;/h4&gt;
&lt;p&gt;1、可以同时配置多个资源库(Repository)&lt;/p&gt;
&lt;p&gt;2、简洁的配置文件(/etc/yum.conf)&lt;/p&gt;
&lt;p&gt;3、自动解决增加或删除rpm包时遇到的倚赖性问题&lt;/p&gt;
&lt;p&gt;4、使用方便&lt;/p&gt;
&lt;p&gt;5、保持与RPM数据库的一致性&lt;/p&gt;
&lt;h4 id=&#34;yum-的配置文件&#34;&gt;yum 的配置文件&lt;/h4&gt;
&lt;p&gt;yum 的配置文件分为两部分：main 和repository：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;main 部分定义了全局配置选项，整个yum 配置文件应该只有一个main。常位于/etc/yum.conf 中。&lt;/li&gt;
&lt;li&gt;repository 部分定义了每个源/服务器的具体配置，可以有一到多个。常位于/etc/yum.repo.d 目录下的各文件中。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;yum.conf 文件一般位于/etc目录下，一般其中只包含main部分的配置选项。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[main]
cachedir=/var/cache/yum     &lt;span class=&#34;ni&#34;&gt;#yum缓存的目录&lt;/span&gt;，yum在此存储下载的rpm包和数据库，默认设置为：/var/cache/yum。

keepcache=0                 &lt;span class=&#34;ni&#34;&gt;#安装完成后是否保留软件包&lt;/span&gt;，0为不保留，1为保留，默认为0。

debuglevel=2                &lt;span class=&#34;ni&#34;&gt;#Debug&lt;/span&gt; 信息输出等级，范围为：0──10，默认为2。

logfile=/var/log/yum.log    &lt;span class=&#34;ni&#34;&gt;#yum的日志文件&lt;/span&gt;，默认为：/var/log/yum.log。

pkgpolicy=newest            &lt;span class=&#34;ni&#34;&gt;#包的策略&lt;/span&gt;。一共有两个选项，newest和last，这个作用是如果你设置了多个repository，而同一软件在不同的repository中同时存在，yum应该安装哪一个，如果是newest，则yum会安装最新的那个版本。如果是last，则yum会将服务器id以字母表排序，并选择最后的那个服务器上的软件安装。一般都是选newest。

distroverpkg=redhat-release &lt;span class=&#34;ni&#34;&gt;#指定一个软件包&lt;/span&gt;，yum会根据这个包判断你的发行版本，默认是redhat-release，也可以是安装的任何针对自己发行版的rpm包。

tolerant=1                  &lt;span class=&#34;ni&#34;&gt;#有1和0两个选项&lt;/span&gt;，表示yum是否容忍命令行发生与软件包有关的错误，比如你要安装1,2,3三个包，而其中3此前已经安装了，如果你设为1,则yum 不会出现错误信息。默认是0。
　　
exactarch=1                 &lt;span class=&#34;ni&#34;&gt;#有两个选项1和0&lt;/span&gt;，设置为1，则yum只会安装和系统架构匹配的软件包，例如，yum不会将i686的软件包安装在适合i386的系统中。默认为1。

retries=6                   &lt;span class=&#34;ni&#34;&gt;#网络连接发生错误后的重试次数&lt;/span&gt;，如果设为0，则会无限重试。默认值为6。

obsoletes=1                 &lt;span class=&#34;ni&#34;&gt;#这是一个update&lt;/span&gt; 的参数，相当于upgrade，允许更新陈旧的RPM包。

plugins=1                   &lt;span class=&#34;ni&#34;&gt;#是否启用插件&lt;/span&gt;，默认1为允许，0表示不允许。我们一般会用yum-fastestmirror这个插件。

exclude=selinux*            &lt;span class=&#34;ni&#34;&gt;#排除某些软件在升级名单之外&lt;/span&gt;，可以用通配符，列表中各个项目要用空格隔开，

gpgcheck=1                  &lt;span class=&#34;ni&#34;&gt;#有1和0两个选择&lt;/span&gt;，分别代表是否是否进行gpg(GNU Private Guard)校验，以确定rpm包的来源是有效和安全的。这个选项如果设置在[main]部分，则对每个repository 都有效。默认值为0。

metadata_expire=1800


&lt;span class=&#34;gh&#34;&gt;# PUT YOUR REPOS HERE OR IN separate files named file.repo
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# in /etc/yum.repos.d
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;yum-命令&#34;&gt;yum 命令&lt;/h4&gt;
&lt;p&gt;yum命令的一般形式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum [options] [command] [package...]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;options 是可选的，选项包括：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;-h：显示帮助信息。
-y：当安装过程中提示选择时，全部为“yes”。
-q：不显示安装的过程。
-c：指定配置文件。
-v：详细模式。
-d：设置调试等级（0-10）。
-e：设置错误等级（0-10）。
-R：设置yum处理一个命令的最大等待时间。
-C：完全从缓存中运行，而不去下载或者更新任何头文件。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;command 为所要进行的操作&lt;/p&gt;
&lt;p&gt;package 是操作的对象&lt;/p&gt;
&lt;p&gt;常用的命令包括：&lt;/p&gt;
&lt;p&gt;1、自动搜索最快镜像插件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install yum-fastestmirror
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、安装 yum 图形窗口插件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install yumex
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查看可能批量安装的列表：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum grouplist
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;yum-命令详解&#34;&gt;yum 命令详解&lt;/h4&gt;
&lt;p&gt;1、全部安装&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、安装指定的软件包 nginx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install nginx -y
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、安装程序组 kubernetes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum groupinstall kubernetes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、安装指定版本的软件包 kubernetes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum list kubernetes
&lt;span class=&#34;gh&#34;&gt;# 根据输出的软件包全名称进行安装
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;yum install -y kubernetes-1.20.12.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、全部更新&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum update
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、更新指定的程序包 nginx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum update nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、检查可更新的程序&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum check-update
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、升级指定软件包 nginx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum upgrade nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;9、升级指定程序组 kubernetes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum groupupdate kubernetes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;10、显示安装包 nginx 的信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum info nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;11、显示所有已经安装和可以安装的软件包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum list
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;12、显示指定程序包 nginx 的安装情况&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum list nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;13、显示程序组 kubernetes 的信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum groupinfo kubernetes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;14、根据关键字 keyword 查找安装包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum search keyword
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;15、删除软件包 nginx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum remove nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;16、删除程序包组 kubernetes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum groupremove kubernetes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;17、查看软件包 nginx 的依赖情况&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum deplist nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;18、清除缓存目录下的软件包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum clean nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;19、清除缓存目录下的headers&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum clean headers
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;20、清除缓存目录下旧的 headers&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum clean oldheaders
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;21、清除缓存目录下的软件包及旧的 headers&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum clean packages,yum clean oldheaders
等价于
yum clean,yum clean all
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;22、查看系统默认安装的 yum&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -qa|grep yum
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;23、查看 yum 的某一条命令属于哪一个软件包，然后就可以安装这个软件包了。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum provides lssubsys 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/rpm/">RPM</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/yum/">YUM</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>给 VMware 中创建的虚拟机设置静态 IP</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-vmware-static-ip/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-vmware-static-ip/</guid>
                <pubDate>Sat, 13 Oct 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了给在 VMware 中创建的虚拟机设置静态 IP 的步骤。&lt;/p&gt;
&lt;p&gt;1）在 &lt;code&gt;VMware&lt;/code&gt; 中，&lt;code&gt;编辑&lt;/code&gt; -&amp;gt; &lt;code&gt;虚拟网络编辑器&lt;/code&gt; -&amp;gt; &lt;code&gt;添加网络&lt;/code&gt;，选择合适的网络名称，例如 &lt;code&gt;VMnet10&lt;/code&gt;，点击 &lt;code&gt;确定&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2）点击 &lt;code&gt;VMnet10&lt;/code&gt;，选择 &lt;code&gt;仅主机模式&lt;/code&gt;，填写子网和子网掩码，例如子网为：&lt;code&gt;172.16.56.0&lt;/code&gt;，子网掩码为：&lt;code&gt;255.255.255.0&lt;/code&gt;，点击 &lt;code&gt;应用&lt;/code&gt;。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/vmware-static-ip/WechatIMG623.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;3）选择要修改 &lt;code&gt;IP&lt;/code&gt; 地址的虚拟机，点击 &lt;code&gt;编辑虚拟机设置&lt;/code&gt;，点击 &lt;code&gt;网络适配器&lt;/code&gt;，在 &lt;code&gt;网络连接&lt;/code&gt; 中选择 &lt;code&gt;自定义&lt;/code&gt;，再选择 &lt;code&gt;VMnet10 仅主机模式&lt;/code&gt;，点击 &lt;code&gt;确定&lt;/code&gt;。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/vmware-static-ip/WechatIMG624.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;4）登录虚拟机，修改 &lt;code&gt;/etc/sysconfig/network-scripts&lt;/code&gt; 目录下 &lt;code&gt;ifcfg-ens33&lt;/code&gt;，修改如下内容，修改 &lt;code&gt;BOOTPROTO&lt;/code&gt; 为 &lt;code&gt;static&lt;/code&gt;，&lt;code&gt;IPADDR&lt;/code&gt; 为指定的 &lt;code&gt;IP&lt;/code&gt; 地址，例如 &lt;code&gt;172.16.56.58&lt;/code&gt;，子网 &lt;code&gt;NETWORK&lt;/code&gt; 为 &lt;code&gt;172.16.56.0&lt;/code&gt;，子网掩码 &lt;code&gt;NETMASK&lt;/code&gt; 为：&lt;code&gt;255.255.255.0&lt;/code&gt;，网关 &lt;code&gt;GATEWAY&lt;/code&gt; 为：&lt;code&gt;172.16.56.1&lt;/code&gt;。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/vmware-static-ip/WechatIMG625.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
使用 `systemctl restart network` 命令重新启动网络。</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/vmware/">VMware</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>FastDFS 安装和 Nginx 代理的使用</title>
                <link>https://xdhuxc.github.io/posts/storage/fastdfs/fastdfs-deployment-and-nginx/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/fastdfs/fastdfs-deployment-and-nginx/</guid>
                <pubDate>Thu, 20 Sep 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了 FastDFS 的安装和其配合 Nginx 使用的步骤。&lt;/p&gt;
&lt;h3 id=&#34;环境信息&#34;&gt;环境信息&lt;/h3&gt;
&lt;p&gt;服务器信息：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ip&lt;/th&gt;
&lt;th&gt;os&lt;/th&gt;
&lt;th&gt;role&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;172.20.15.73&lt;/td&gt;
&lt;td&gt;Centos 7&lt;/td&gt;
&lt;td&gt;tracker&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;172.20.15.75&lt;/td&gt;
&lt;td&gt;Centos 7&lt;/td&gt;
&lt;td&gt;storage&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;软件相关信息：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;soft&lt;/th&gt;
&lt;th&gt;version&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;fastdfs&lt;/td&gt;
&lt;td&gt;5.11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;libfastcommon&lt;/td&gt;
&lt;td&gt;1.0.39&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;nginx&lt;/td&gt;
&lt;td&gt;1.12.2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;fastdfs-nginx-module&lt;/td&gt;
&lt;td&gt;1.20&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;部署-fastdfs&#34;&gt;部署 FastDFS&lt;/h3&gt;
&lt;p&gt;1、拷贝安装包，并解压&lt;/p&gt;
&lt;p&gt;将安装包考本到两台服务器的 &lt;code&gt;/usr/local/src&lt;/code&gt;，并进入该目录，解压安装包：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cd /usr/local/src &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; unzip fastdfs.zip -d /usr/local/src
cd /usr/local/src/fastdfs
ls | grep &amp;#39;tar.gz&amp;#39; | xargs -I {} tar -xzvf {} -C /usr/local/src/fastdfs
cd /usr/local/src/fastdfs/nginx/
ls | grep &amp;#39;tar.gz&amp;#39; | xargs -I {} tar -xzvf {} -C /usr/local/src/fastdfs/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、安装相关依赖&lt;/p&gt;
&lt;p&gt;分别进入两台服务器的 &lt;code&gt;/usr/local/src/fastdfs/fastdfs-lib&lt;/code&gt; 目录，安装相关依赖：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -ivh --force /usr/local/src/fastdfs/fastdfs-lib/*
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、安装 libfastcommon&lt;/p&gt;
&lt;p&gt;通过如下命令，在两台服务器上安装 &lt;code&gt;libfastcommon&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cd /usr/local/src/fastdfs/libfastcommon-1.0.39/
./make.sh &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ./make.sh install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;看到如下信息，说明安装成功：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if [ ! -e /usr/lib/libfastcommon.so ]; then ln -s /usr/lib64/libfastcommon.so /usr/lib/libfastcommon.so; fi
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;安装完毕之后，设置软连接：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ln -s /usr/lib64/libfastcommon.so /usr/local/lib/libfastcommon.so
ln -s /usr/lib64/libfastcommon.so /usr/lib/libfastcommon.so
ln -s /usr/lib64/libfdfsclient.so /usr/local/lib/libfdfsclient.so
ln -s /usr/lib64/libfdfsclient.so /usr/lib/libfdfsclient.so
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4、安装 FastDFS&lt;/p&gt;
&lt;p&gt;使用如下命令，在两台服务器上安装 fastdfs：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cd /usr/local/src/fastdfs/fastdfs-5.11
./make.sh &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ./make.sh install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;看到如下信息，则说明安装成功：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if [ ! -f /etc/fdfs/client.conf.sample ]; then cp -f ../conf/client.conf /etc/fdfs/client.conf.sample; fi
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;拷贝配置文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp /etc/fdfs/client.conf.sample /etc/fdfs/client.conf
cp /etc/fdfs/storage.conf.sample /etc/fdfs/storage.conf
cp /etc/fdfs/tracker.conf.sample /etc/fdfs/tracker.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、配置 tracker 服务器（172.20.15.73）&lt;/p&gt;
&lt;p&gt;创建文件夹，用于存放 Tracker 服务器的相关文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /data/fastdfs/tracker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 tracker 的配置文件 &lt;code&gt;/etc/fdfs/tracker.conf&lt;/code&gt;，修改如下部分：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;disabled=false
port=22122
base_path=/data/fastdfs/tracker
http.server_port=6666
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;拷贝 tracker 的 systemd 文件至 &lt;code&gt;/usr/lib/systemd/system/&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp /usr/local/src/fastdfs/conf/systemd/fdfs_trackerd.service /usr/lib/systemd/system/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;因为 &lt;code&gt;fdfs_trackerd&lt;/code&gt; 等命令在 &lt;code&gt;/usr/local/bin&lt;/code&gt; 中并没有，而是在 &lt;code&gt;/usr/bin&lt;/code&gt; 路径下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ln -s /usr/bin/fdfs_trackerd /usr/local/bin
ln -s /usr/bin/stop.sh /usr/local/bin
ln -s /usr/bin/restart.sh /usr/local/bin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 systemd&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 tracker：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart fdfs_trackerd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;设置开机启动&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl enable fdfs_trackerd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、配置 &lt;code&gt;storage&lt;/code&gt; 服务器（172.20.15.75）&lt;/p&gt;
&lt;p&gt;首先是创建 &lt;code&gt;storage&lt;/code&gt; 服务器的文件目录，需要注意的是多建了一个目录，因为 &lt;code&gt;storage&lt;/code&gt; 还需要一个文件存储路径，用于存放接收的文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /data/fastdfs/storage
mkdir -p /data/fastdfs/storage_data
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 &lt;code&gt;storage&lt;/code&gt; 的配置文件 &lt;code&gt;/etc/fdfs/storage.conf&lt;/code&gt;，修改如下部分：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;disabled=false
group_name=group1
port=23000
base_path=/data/fastdfs/storage
store_path_count=1
store_path0=/data/fastdfs/storage_data
tracker_server=172.20.15.73:22122
http.server_port=8888
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;拷贝 &lt;code&gt;tracker&lt;/code&gt; 的 &lt;code&gt;systemd&lt;/code&gt; 文件至 &lt;code&gt;/usr/lib/systemd/system/&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp /usr/local/src/fastdfs/conf/systemd/fdfs_storaged.service /usr/lib/systemd/system/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;配置完成后同样要为 &lt;code&gt;storage&lt;/code&gt; 服务器的启动脚本设置软引用：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ln -s /usr/bin/fdfs_storaged /usr/local/bin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 &lt;code&gt;systemd&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 &lt;code&gt;tracker&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart fdfs_storaged
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;设置开机启动&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl enable fdfs_storaged
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看 &lt;code&gt;storage&lt;/code&gt; 服务器是否已经登记到 &lt;code&gt;tracker&lt;/code&gt; 服务器（也可以理解为 &lt;code&gt;tracker&lt;/code&gt; 与 &lt;code&gt;storage&lt;/code&gt; 是否整合成功），运行以下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/usr/bin/fdfs_monitor /etc/fdfs/storage.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;看到 &lt;code&gt;tracker server is 172.20.15.73:22122&lt;/code&gt;，tracker 服务器正常启动。&lt;/p&gt;
&lt;p&gt;看到 &lt;code&gt;172.20.15.75 ACTIVE&lt;/code&gt; 字样即可说明 &lt;code&gt;storage&lt;/code&gt; 服务器已经成功注册到了 &lt;code&gt;tracker&lt;/code&gt; 服务器。&lt;/p&gt;
&lt;h3 id=&#34;安装并配置-nginx&#34;&gt;安装并配置 Nginx&lt;/h3&gt;
&lt;h4 id=&#34;安装配置-tracker-的-nginx&#34;&gt;安装配置 tracker 的 nginx&lt;/h4&gt;
&lt;p&gt;安装 &lt;code&gt;nginx&lt;/code&gt; 依赖包，并安装 &lt;code&gt;nginx&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -ivh --force /usr/local/src/fastdfs/nginx/nginx-lib/*
rpm -ivh --force /usr/local/src/fastdfs/nginx/nginx-rpm/*
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将 &lt;code&gt;tracker&lt;/code&gt; 的 &lt;code&gt;nginx&lt;/code&gt; 的配置文件拷贝到 &lt;code&gt;/etc/nginx&lt;/code&gt;，端口为 &lt;code&gt;9988&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp -r /usr/local/src/fastdfs/conf/nginx-tracker.conf /etc/nginx/nginx.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将 &lt;code&gt;/usr/local/src/fastdfs/fastdfs-5.11/conf&lt;/code&gt; 中的 &lt;code&gt;http.conf&lt;/code&gt; 和 &lt;code&gt;mime.types&lt;/code&gt; 拷贝到 &lt;code&gt;/etc/fdfs&lt;/code&gt; 目录下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp -r /usr/local/src/fastdfs/fastdfs-5.11/conf/http.conf /etc/fdfs/
cp -r /usr/local/src/fastdfs/fastdfs-5.11/conf/mime.types /etc/fdfs/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建 &lt;code&gt;/var/lib/nginx/tmp&lt;/code&gt; 以及日志文件夹：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /var/lib/nginx/tmp /data/log/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;拷贝 &lt;code&gt;nginx&lt;/code&gt; 的 &lt;code&gt;systemd&lt;/code&gt; 文件至 &lt;code&gt;/usr/lib/systemd/system/&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp /usr/local/src/fastdfs/conf/systemd/nginx.service /usr/lib/systemd/system/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 &lt;code&gt;systemd&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 &lt;code&gt;nginx&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl start nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;设置开机启动：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl enable nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;安装并配置-storage-的-nginx&#34;&gt;安装并配置 storage 的 nginx&lt;/h4&gt;
&lt;p&gt;安装 &lt;code&gt;nginx&lt;/code&gt; 依赖包：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -ivh --force /usr/local/src/fastdfs/nginx/nginx-lib/*
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 &lt;code&gt;/usr/local/src/fastdfs/nginx/fastdfs-nginx-module-1.20/src/config&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ngx_addon_name=ngx_http_fastdfs_module

if test -n &amp;#34;${ngx_module_link}&amp;#34;; then
    ngx_module_type=HTTP
    ngx_module_name=$ngx_addon_name
    ngx_module_incs=&amp;#34;/usr/include/fastdfs /usr/include/fastcommon/&amp;#34;
    ngx_module_libs=&amp;#34;-lfastcommon -lfdfsclient&amp;#34;
    ngx_module_srcs=&amp;#34;$ngx_addon_dir/ngx_http_fastdfs_module.c&amp;#34;
    ngx_module_deps=
    CFLAGS=&amp;#34;$CFLAGS -D_FILE_OFFSET_BITS=64 -DFDFS_OUTPUT_CHUNK_SIZE=&amp;#39;256*1024&amp;#39; -DFDFS_MOD_CONF_FILENAME=&amp;#39;\&amp;#34;/etc/fdfs/mod_fastdfs.conf\&amp;#34;&amp;#39;&amp;#34;
    . auto/module
else
    HTTP_MODULES=&amp;#34;$HTTP_MODULES ngx_http_fastdfs_module&amp;#34;
    NGX_ADDON_SRCS=&amp;#34;$NGX_ADDON_SRCS $ngx_addon_dir/ngx_http_fastdfs_module.c&amp;#34;
    CORE_INCS=&amp;#34;$CORE_INCS /usr/include/fastdfs /usr/include/fastcommon/&amp;#34;
    CORE_LIBS=&amp;#34;$CORE_LIBS -L/usr/lib -lfastcommon -lfdfsclient&amp;#34;
    CFLAGS=&amp;#34;$CFLAGS -D_FILE_OFFSET_BITS=64 -DFDFS_OUTPUT_CHUNK_SIZE=&amp;#39;256*1024&amp;#39; -DFDFS_MOD_CONF_FILENAME=&amp;#39;\&amp;#34;/etc/fdfs/mod_fastdfs.conf\&amp;#34;&amp;#39;&amp;#34;
fi
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;增加依赖包并安装 &lt;code&gt;nginx&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cd /usr/local/src/fastdfs/nginx/nginx-1.12.2

./configure --prefix=/usr/share/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --user=root --add-module=/usr/local/src/fastdfs/nginx/fastdfs-nginx-module-1.20/src

make &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; make install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将 &lt;code&gt;nginx&lt;/code&gt; 的配置文件拷贝到 &lt;code&gt;/etc/nginx&lt;/code&gt;，端口为 &lt;code&gt;9999&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp -r /usr/local/src/fastdfs/conf/nginx-storage.conf /etc/nginx/nginx.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将 &lt;code&gt;/usr/local/src/fastdfs/fastdfs-5.11/conf&lt;/code&gt; 中的 &lt;code&gt;http.conf&lt;/code&gt; 和 &lt;code&gt;mime.types&lt;/code&gt; 拷贝到 &lt;code&gt;/etc/fdfs&lt;/code&gt; 目录下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp -r /usr/local/src/fastdfs/fastdfs-5.11/conf/http.conf /etc/fdfs/
cp -r /usr/local/src/fastdfs/fastdfs-5.11/conf/mime.types /etc/fdfs/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;把 &lt;code&gt;/usr/local/src/fastdfs/nginx/fastdfs-nginx-module-1.20/src&lt;/code&gt; 安装目录下的 &lt;code&gt;mod_fastdfs.conf&lt;/code&gt; 也拷贝到 /etc/fdfs` 目录下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp -r /usr/local/src/fastdfs/nginx/fastdfs-nginx-module-1.20/src/mod_fastdfs.conf /etc/fdfs/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 &lt;code&gt;/etc/fdfs/mod_fastdfs.conf&lt;/code&gt; 下面的部分：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;base_path=/data/fastdfs/storage
tracker_server=172.20.15.73:22122
storage_server_port=23000
url_have_group_name = true
store_path0=/data/fastdfs/storage_data
group_count = 3

[group1]
group_name=group1
storage_server_port=23000
store_path_count=1
store_path0=/data/fastdfs/storage_data

[group2]
group_name=group2
storage_server_port=23000
store_path_count=1
store_path0=/data/fastdfs/storage_data

[group3]
group_name=group3
storage_server_port=23000
store_path_count=1
store_path0=/data/fastdfs/storage_data
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;建立 &lt;code&gt;M00&lt;/code&gt; 至存储目录的符号连接：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ln -s /data/fastdfs/storage_data/data /data/fastdfs/storage_data/data/M00
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建 &lt;code&gt;/var/lib/nginx/tmp&lt;/code&gt; 以及日志文件夹：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /var/lib/nginx/tmp /data/log/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;拷贝 nginx 的 systemd 文件至 &lt;code&gt;/usr/lib/systemd/system/&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp /usr/local/src/fastdfs/conf/systemd/nginx.service /usr/lib/systemd/system/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 systemd：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 nginx：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl start nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;设置开机启动：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl enable nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;以-172201523-作为-client-进行测试&#34;&gt;以 172.20.15.23 作为 client 进行测试&lt;/h4&gt;
&lt;p&gt;创建 &lt;code&gt;/data/fastdfs/client&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /data/fastdfs/client
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 &lt;code&gt;/etc/fdfs/client.conf&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;base_path=/data/fastdfs/client
tracker_server=172.20.15.73:22122
http.tracker_server_port=6666
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;上传文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/usr/bin/fdfs_test /etc/fdfs/client.conf upload /usr/local/src/fastdfs/test/test.jpeg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;得到如下结果，说明上传成功：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;This is FastDFS client test program v5.11

Copyright (C) 2008, Happy Fish / YuQing

FastDFS may be copied only under the terms of the GNU General
Public License V3, which may be found in the FastDFS source kit.
Please visit the FastDFS Home Page http://www.csource.org/
for more detail.

[2018-09-06 20:30:37] DEBUG - base_path=/data/fastdfs/client, connect_timeout=30, network_timeout=60, tracker_server_count=1, anti_steal_token=0, anti_steal_secret_key length=0, use_connection_pool=0, g_connection_pool_max_idle_time=3600s, use_storage_id=0, storage server id count: 0

tracker_query_storage_store_list_without_group:
	server 1. group_name=, ip_addr=172.20.15.75, port=23000

group_name=group1, ip_addr=172.20.15.75, port=23000
storage_upload_by_filename
group_name=group1, remote_filename=M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15.jpeg
source ip address: 172.20.15.75
file timestamp=2018-09-06 20:30:37
file size=46193
file crc32=3080419236
example file url: http://172.20.15.75:6666/group1/M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15.jpeg
storage_upload_slave_by_filename
group_name=group1, remote_filename=M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15_big.jpeg
source ip address: 172.20.15.75
file timestamp=2018-09-06 20:30:37
file size=46193
file crc32=3080419236
example file url: http://172.20.15.75:6666/group1/M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15_big.jpeg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;根据 &lt;code&gt;/group1/M00/00/00/rBQPS1uP4OOAGfVuAAC0cbebd6Q04_big.jpeg&lt;/code&gt;，在浏览器上查看已经上传的图片：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.15.73:9988/group1/M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15_big.jpeg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/wlwlwlwl015/article/details/52619851&#34;&gt;https://blog.csdn.net/wlwlwlwl015/article/details/52619851&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/jeikerxiao/article/details/79861850&#34;&gt;https://blog.csdn.net/jeikerxiao/article/details/79861850&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://my.oschina.net/wangmengjun/blog/1142982&#34;&gt;https://my.oschina.net/wangmengjun/blog/1142982&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/e55702bdb2fe&#34;&gt;https://www.jianshu.com/p/e55702bdb2fe&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://naturalwill.github.io/2017/09/25/add-rtmp-module-to-nginx-by-yum/&#34;&gt;https://naturalwill.github.io/2017/09/25/add-rtmp-module-to-nginx-by-yum/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://anyof.me/articles/236&#34;&gt;https://anyof.me/articles/236&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.51cto.com/wangfeng7399/1711589&#34;&gt;http://blog.51cto.com/wangfeng7399/1711589&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/00a5961e0bca&#34;&gt;https://www.jianshu.com/p/00a5961e0bca&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/xuchaovip/article/details/60480557&#34;&gt;https://blog.csdn.net/xuchaovip/article/details/60480557&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/name_is_wl/article/details/52979208&#34;&gt;https://blog.csdn.net/name_is_wl/article/details/52979208&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.ityouknow.com/fastdfs/2017/10/10/cluster-building-fastdfs.html&#34;&gt;http://www.ityouknow.com/fastdfs/2017/10/10/cluster-building-fastdfs.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jianshu.com/p/a88c76caf317&#34;&gt;https://www.jianshu.com/p/a88c76caf317&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/tangwan/p/5425153.html&#34;&gt;https://www.cnblogs.com/tangwan/p/5425153.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.ityouknow.com/fastdfs/2017/10/10/cluster-building-fastdfs.html&#34;&gt;http://www.ityouknow.com/fastdfs/2017/10/10/cluster-building-fastdfs.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/xyang81/article/details/52928230&#34;&gt;https://blog.csdn.net/xyang81/article/details/52928230&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/u012453843/article/details/68957209&#34;&gt;https://blog.csdn.net/u012453843/article/details/68957209&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/fastdfs/">FastDFS</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/nginx/">Nginx</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 docker 和原生方式部署 MySQL</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-docker-and-original-deployment/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-docker-and-original-deployment/</guid>
                <pubDate>Wed, 19 Sep 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了基于 docker 容器方式和原生方式部署 MySQL 的配置和方式。&lt;/p&gt;
&lt;h3 id=&#34;启动-mysql-容器&#34;&gt;启动 MySQL 容器&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --restart=always \
    --privileged=true \
    -p 3306:3306 \
    -e MYSQL_ROOT_PASSWORD=Xdhuxc123 \
    -v /data/mysql_data:/var/lib/mysql \
    -v /data/disc/script/sql:/docker-entrypoint-initdb.d \
    --name mysql \
    mysql:5.7.21
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;该启动命令包括初始化 &lt;code&gt;root&lt;/code&gt; 用户、初始化数据库（将待导入的 &lt;code&gt;sql&lt;/code&gt; 文件放入 &lt;code&gt;/data/disc/script/sql&lt;/code&gt; 目录下）和持久化数据目录。&lt;/p&gt;
&lt;h3 id=&#34;使用本地配置文件启动-mysql-容器&#34;&gt;使用本地配置文件启动 MySQL 容器&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --net host \
    -v /mysql/conf:/etc/mysql/conf.d \
    -v /mysql/data:/var/lib/mysql \
    -e MYSQL_ROOT_PASSWORD=123456 \
    --name mysql \
    mysql:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/mysql/conf&lt;/code&gt;：本地主机 &lt;code&gt;MySQL&lt;/code&gt; 配置文件 &lt;code&gt;my.cnf&lt;/code&gt; 存放路径，该路径下存放 &lt;code&gt;MySQL&lt;/code&gt; 的配置文件 &lt;code&gt;my.cnf&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MYSQL_ROOT_PASSWORD&lt;/code&gt;：容器中 &lt;code&gt;MySQL&lt;/code&gt; 数据库的 &lt;code&gt;root&lt;/code&gt; 用户密码&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/mysql/data&lt;/code&gt;：本地主机上存放 &lt;code&gt;MySQL&lt;/code&gt; 数据文件的目录&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;mysql-容器启动时初始化数据库&#34;&gt;mysql 容器启动时初始化数据库&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;sql文件存放的目录，只能有一个sql文件，必须内含创建数据库和选择数据库命令&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -p 3306:3306 \
    -e MYSQL_ROOT_PASSWORD=123456 \
    -v /home/xdhuxc/mysql/config:/etc/mysql/conf.d \
    -v /home/xdhuxc/mysql/data:/var/lib/mysql \
    -v /home/xdhuxc/mysql/sql:/docker-entrypoint-initdb.d \
    --name mysql \
    mysql:5.7.21
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看 MySQL 官方镜像的 &lt;a href=&#34;https://github.com/docker-library/mysql/blob/883703dfb30d9c197e0059a669c4bb64d55f6e0d/5.7/Dockerfile&#34;&gt;dockerFile&lt;/a&gt; ，在容器启动时，会执行脚本 &lt;code&gt;docker-entrypoint.sh&lt;/code&gt;，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;COPY docker-entrypoint.sh /usr/local/bin/
RUN ln -s usr/local/bin/docker-entrypoint.sh /entrypoint.sh # backwards compat
ENTRYPOINT [&amp;#34;docker-entrypoint.sh&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;而在该脚本中，会遍历 &lt;code&gt;/docker-entrypoint-initdb.d&lt;/code&gt; 目录下所有的 &lt;code&gt;.sh&lt;/code&gt; 和 &lt;code&gt;.sql&lt;/code&gt; 后缀的文件，然后执行。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo
for f in /docker-entrypoint-initdb.d/*; do
	case &amp;#34;$f&amp;#34; in
		*.sh)     echo &amp;#34;$0: running $f&amp;#34;; . &amp;#34;$f&amp;#34; ;;
		*.sql)    echo &amp;#34;$0: running $f&amp;#34;; &amp;#34;${mysql[@]}&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; &amp;#34;$f&amp;#34;; echo ;; # mysql=( mysql --protocol=socket -uroot -hlocalhost --socket=&amp;#34;${SOCKET}&amp;#34; )
		*.sql.gz) echo &amp;#34;$0: running $f&amp;#34;; gunzip -c &amp;#34;$f&amp;#34; | &amp;#34;${mysql[@]}&amp;#34;; echo ;;
		*)        echo &amp;#34;$0: ignoring $f&amp;#34; ;;
	esac
	echo
done
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;在-centos-下安装-mysql&#34;&gt;在 CentOS 下安装 mysql&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;CentOS Linux release 7.3.1611 (Core)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、下载 &lt;code&gt;mysql57-community-release-el7-10.noarch.rpm&lt;/code&gt; 到本地虚拟机，下载地址为：
&lt;a href=&#34;http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql57-community-release-el7-10.noarch.rpm&#34;&gt;http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql57-community-release-el7-10.noarch.rpm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql57-community-release-el7-10.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、安装 &lt;code&gt;mysql57-community-release-el7-10.noarch.rpm&lt;/code&gt;，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -ivh mysql57-community-release-el7-10.noarch.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;安装后，会在 &lt;code&gt;/etc/yum.repos.d&lt;/code&gt; 目录下生成 &lt;code&gt;mysql-community.repo&lt;/code&gt;，&lt;code&gt;mysql-community-source.repo&lt;/code&gt;两个yum仓库配置文件。&lt;/p&gt;
&lt;p&gt;3、安装 &lt;code&gt;MySQL Community&lt;/code&gt;，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y mysql-community-server.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;安装过程中，会自动安装 &lt;code&gt;mysql-community-server&lt;/code&gt;，&lt;code&gt;mysql-community-client&lt;/code&gt;，&lt;code&gt;mysql-community-common&lt;/code&gt;，&lt;code&gt;mysql-community-libs&lt;/code&gt;，&lt;code&gt;net-tools&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;4、启动并查看 MySQL 服务&lt;/p&gt;
&lt;p&gt;启动MySQL服务，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo service mysqld start
或
sudo systemctl start mysqld.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看MySQL服务，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo service mysqld status
或
sudo systemctl status mysqld.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、查看 MySQL root 用户的初始密码&lt;/p&gt;
&lt;p&gt;使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo grep &amp;#39;temporary password&amp;#39; /var/log/mysqld.log
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、使用MySQL自动生成的密码登录MySQL客户端，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql -uroot -pyiw,x4po6EsO
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下命令更改密码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;alter user &amp;#39;root&amp;#39;@&amp;#39;localhost&amp;#39; identified by &amp;#39;286X326_h&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysqli_real_connect(): (HY000/1130): Host &amp;#39;172.17.0.2&amp;#39; is not allowed to connect to this MySQL server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、给远程连接的机器授权&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;GRANT ALL PRIVILEGES ON \*.\* TO &amp;#39;root&amp;#39;@&amp;#39;192.168.1.8&amp;#39; IDENTIFIED BY &amp;#39;www.linuxidc.com&amp;#39; WITH GRANT OPTION;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;设置简单密码&#34;&gt;设置简单密码&lt;/h4&gt;
&lt;p&gt;在 &lt;code&gt;Linux&lt;/code&gt; 下，安装完 &lt;code&gt;MySQL&lt;/code&gt; 并启动后，首先使用临时 &lt;code&gt;root&lt;/code&gt; 用户密码登录进去；&lt;/p&gt;
&lt;p&gt;接着，使用 &lt;code&gt;alter&lt;/code&gt; 语句修改 &lt;code&gt;root&lt;/code&gt; 用户密码；&lt;/p&gt;
&lt;p&gt;然后，查看 &lt;code&gt;validate_password_policy&lt;/code&gt; 的值。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;validate_password_policy&lt;/code&gt; 有以下取值：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Policy&lt;/th&gt;
&lt;th&gt;Tests Performed&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0 or LOW&lt;/td&gt;
&lt;td&gt;Length&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1 or MEDIUM&lt;/td&gt;
&lt;td&gt;Length; numeric, lowercase/uppercase, and special characters&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2 or STRONG&lt;/td&gt;
&lt;td&gt;Length; numeric, lowercase/uppercase, and special characters; dictionary file&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;默认是 &lt;code&gt;1&lt;/code&gt;，即 &lt;code&gt;MEDIUM&lt;/code&gt;，所以刚开始设置的密码必须符合长度，且必须含有数字，小写或大写字母，特殊字符。&lt;/p&gt;
&lt;p&gt;为了设置简单的密码，需要修改两个全局参数：&lt;/p&gt;
&lt;p&gt;1、修改 &lt;code&gt;validate_password_policy&lt;/code&gt; 参数的值，设置为 &lt;code&gt;0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2、修改 &lt;code&gt;validate_password_length=1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;3、刷新权限&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>MySQL 配置文件详解</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-configuration/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-configuration/</guid>
                <pubDate>Wed, 12 Sep 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 MySQL 配置文件中各个参数的含义，留作后查。&lt;/p&gt;
&lt;p&gt;Linux系统下，配置文件位于：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/etc/my.cnf 或 /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;配置文件内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;132
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;133
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;134
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;135
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;136
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;137
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;138
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;139
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;140
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;141
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;142
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;143
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;144
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;145
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;146
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;147
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;148
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;149
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;150
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;151
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;152
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;153
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;154
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;155
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;156
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;157
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;158
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;159
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;160
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;161
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;162
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;163
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;164
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;165
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;166
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;167
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;168
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;169
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;170
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;171
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;172
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;173
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;174
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;175
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;176
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;177
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;178
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;179
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;180
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;181
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;182
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;183
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;184
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;185
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;186
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;187
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;188
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;189
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;190
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;191
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;192
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;193
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;194
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;195
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;196
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;197
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;198
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;199
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;200
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;201
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;202
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;203
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;204
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;205
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;206
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;207
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;208
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;209
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;210
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;211
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;212
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;213
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;214
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;215
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;216
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;217
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;218
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;219
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;220
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;221
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;222
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;223
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;224
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;225
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;226
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;227
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;228
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;229
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;230
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;231
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;232
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;233
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;234
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;235
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;236
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;237
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;238
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;239
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;240
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;241
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;242
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;243
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;244
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;245
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;246
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;247
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;248
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;249
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;250
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;251
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;252
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;253
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;254
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;255
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;256
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;257
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;258
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[client]

&lt;span class=&#34;gh&#34;&gt;# 设置 mysql 客户端连接服务端时默认使用的端口。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;port = 3306
socket = /usr/local/mysql/mysql.sock 
&lt;span class=&#34;gh&#34;&gt;# 设置 mysql 客户端默认字符集。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;default-character-set = utf8

[mysql]
no-auto-rehash

[mysqld]

&lt;span class=&#34;gh&#34;&gt;# 设置 mysqld 服务端默认监听的 TCP/IP 端口。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;port = 3306

&lt;span class=&#34;gh&#34;&gt;# 设置 mysql 服务器默认字符集。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;default-character-set = utf8

&lt;span class=&#34;gh&#34;&gt;# mysql 的时区默认是服务器的时区，设置 mysql 时区为东八区
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;default-time_zone = &amp;#39;+8:00&amp;#39;

&lt;span class=&#34;gh&#34;&gt;# 基准路径，其他路径都相对于这个路径。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;basedir = /usr/local/mysql 

&lt;span class=&#34;gh&#34;&gt;# mysql 数据库文件所在目录。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;datadir = /data/

log_bin = mysql-bin 
binlog_format = mixed
&lt;span class=&#34;gh&#34;&gt;# 超过 30 天的 binlog 自动删除。 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;expire_logs_days = 30 
&lt;span class=&#34;gh&#34;&gt;# 错误日志路径
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;log_error = /logs/mysql-error.log

slow_query_log = 1
&lt;span class=&#34;gh&#34;&gt;# 慢查询时间，超过 1秒 则为慢查询。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;long_query_time = 1 
&lt;span class=&#34;gh&#34;&gt;# 慢查询日志
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;slow_query_log_file = /logs/mysql-slow.log 

performance_schema = 0
explicit_defaults_for_timestamp

&lt;span class=&#34;gh&#34;&gt;# 不区分大小写
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# lower_case_table_names = 1
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 创建新表时使用的默认存储引擎。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;default-storage-engine = INNODB

&lt;span class=&#34;gh&#34;&gt;# mysql 服务器支持的最大并发连接数，默认值为：150，但总会预留其中一个连接给管理员使用 super 权限登录，即使连接数目达到最大限制。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果服务器的并发连接请求量比较大，建议提高该值，以增加并发连接数量。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 当然这是建立在机器资源能够支撑的情况下，mysql 会为每个连接提供连接缓冲区，那么连接数越多，内存开销就会越大，因此要适当调整该值。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;max_connections = 500

&lt;span class=&#34;gh&#34;&gt;# 对于同一主机，如果有超出该值个数的中断错误连接，则该主机将被禁止连接。如需对该主机进行解禁，需要执行 flush host 命令。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;max_connect_errors = 6000

&lt;span class=&#34;gh&#34;&gt;# 服务器关闭交互式连接前等待活动的秒数。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 交互式客户端定义为在 mysql_real_connect() 中使用 CLIENT_INTERACTIVE 选项的客户端，默认值为：28800秒，即8小时。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;interactive_timeout = 28800

&lt;span class=&#34;gh&#34;&gt;# 服务器关闭非交互式连接之前等待活动的秒数。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 在线程启动时，根据全局 wait_timeout 的值或全局 interactive_timeout 的值初始化 wait_timeout 的值。 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 取决于客户端类型，由 mysql_real_connect() 的连接选项 CLIENT_INTERACTIVE 定义，参数的默认值为：28800。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# mysql 服务器所支持的最大连接数是有上限的，因为每个连接的建立都会消耗内存，因此，我们希望客户端在连接到 mysql 服务器处理完相应的操作后，应该断开连接并释放占用的内存。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果 mysql 服务器有大量的闲置连接，它们不仅会白白消耗内存，而且如果连接一直在累加而不断开，最终肯定会达到 mysql 服务器的连接上限数，这会报“too many connections” 错误。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 对于 wait_timeout 的值的设定，应该根据系统的运行情况来判断。在系统运行一段时间后，可以通过 show processlist 命令查看当前系统的连接状态。 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果发现有大量的 sleep 状态的连接进程，则说明该参数设置得过大，可以适当地调小些，要同时设置 interactive_timeout 和 wait_timeout 才会生效。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;wait_timeout = 28800

&lt;span class=&#34;gh&#34;&gt;# mysql 能够打开的文件描述符限制，默认最小为：1024。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 当 open_files_limit 没有被设置的时候，比较 max_connections*5 和 ulimit -n 的值，哪个大用那个。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 当 open_files_limit 被配置的时候，比较 open_files_limit 和 max_connections*5 的值，哪个大用那个。 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;open_files_limit = 65535

&lt;span class=&#34;gh&#34;&gt;# 指定 mysql 查询缓冲区的大小，可以通过在 mysql 控制台观察。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 使用查询缓冲， mysql 将 select 语句和查询结果存放在缓冲区中，今后对于同样的 select 语句（区分大小写），将直接从缓冲区中读取结果。根据 MySQL 用户手册，使用查询缓冲最多可以提高 238% 的效率。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果 Qcache_lowmem_prunes 的值非常大，则表明经常出现缓冲不够的情况；
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果 Qcache_hits 的值非常大，则表明查询缓冲使用非常频繁；如果该值较小反而会影响效率，那么可以考虑不用查询缓冲。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果 Qcache_free_blocks 的值非常大，则表明缓冲区中碎片很多。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 此外，在 select 语句中加入 SQL_NO_CACHE 可以明确表示不使用查询缓冲。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;query_cache_size = 50M

&lt;span class=&#34;gh&#34;&gt;# 指定单个查询能够使用的缓冲区大小，默认为：1M。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;query_cache_limit = 2M

&lt;span class=&#34;gh&#34;&gt;# 用于设置 table 高速缓存的数量。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 由于每个客户端连接都会至少访问一个表，因此此参数的值与 max_connections 有关。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 当某一连接访问一个表时，mysql 会检查当前已缓存的表的数量。如果该表已经在缓存中打开，则会直接访问缓存中的表以加快查询速度；如果该表未被缓存，则会将当前的表添加进缓存并进行查询。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 在执行缓存操作之前，table_cache 用于限制缓存表的最大数目，如果当前已经缓存的表未达到 table_cache 所设定的值，则会将新表添加进来；若已经达到此值，mysql 将根据缓存表的最后查询时间、查询率等规则释放之前的缓存。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;table_open_cache = 512

&lt;span class=&#34;gh&#34;&gt;# 内存中的每个临时表允许的最大大小。如果临时表大小超过该值，临时表将自动转为基于磁盘的表。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;# 
tmp_table_size = 64M

&lt;span class=&#34;gh&#34;&gt;# 缓存的最大线程数，表示可以重新利用保存在缓存中的线程的数量。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 当客户端连接断开时，如果客户端总连接数小于该值，即缓存中还有空间，则处理客户端任务的线程放回缓存。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果线程被重新请求，那么请求将从缓存中读取；如果缓存中是空的或者是新的请求，那么这个线程将被重新创建。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 在高并发情况下，如果该值设置得太小，就会有很多线程频繁创建，线程创建的开销会变大，查询效率也会下降。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 一般来说，如果在应用程序中有良好的多线程处理，这个参数对性能不会有太大的提高。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 根据物理内存设置规则如下：
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 1G -&amp;gt; 8
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 2G -&amp;gt; 16
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 3G -&amp;gt; 32
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 大于 3G -&amp;gt; 64
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;thread_cache_size = 8

&lt;span class=&#34;gh&#34;&gt;# 避免 mysql 的外部锁定，减少出错几率，增强稳定性，该选项默认开启。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;skip-external-locking

&lt;span class=&#34;gh&#34;&gt;# 禁止 mysql 对外部连接进行 DNS 解析，使用这一选项可以消除 mysql 进行 DNS 解析的时间。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 但是需要注意，如果开启该选项，则所有远程主机连接授权都要使用 IP 地址方式，否则 mysql 将无法正常处理连接请求。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;skip-name-resolve

&lt;span class=&#34;gh&#34;&gt;# 指定在 mysql 暂时停止响应新请求之前的短时间内多少个请求可以被存放到堆栈中。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果系统在一个短时间内有很多连接，则需要增大该参数的值，该值指定到来的的TCP/IP连接的监听队列的大小。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 不同的操作系统在这个队列大小上有它自己的限制，试图设置 back_log 的值高于操作系统的限制将是无效的，
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 默认值为：80，对于 Linux 系统，推荐设置为小于 512 的整数。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;back_log = 150

&lt;span class=&#34;gh&#34;&gt;# 接收的数据包大小，增加该变量的值十分安全，这是因为仅当需要时才会分配额外的内存。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 例如，仅当发出长查询或 mysqld 必须返回大的结果集时 mysqld 才会分配更多内存。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 该变量之所以取较小的默认值是一种预防措施，以捕获客户端和服务器之间的错误信息包，并确保不会因偶然使用大的信息包而导致内存溢出。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;max_allowed_packet = 32M

&lt;span class=&#34;gh&#34;&gt;# 一个事务在没有提交的时候产生的日志会记录到 cache 中，等到事务需要提交的时候，则把日志持久化到磁盘。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# binlog_cache_size 的默认大小为：32K。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;binlog_cache_size = 1M

&lt;span class=&#34;gh&#34;&gt;# 定义了用户可以创建的内存表的大小。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 该值用来计算内存表的最大行数值，支持动态改变。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;max_heap_table_size = 8M

&lt;span class=&#34;gh&#34;&gt;# mysql 读入缓冲区大小。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 对表进行顺序扫描的请求将分配一个读入缓冲区，mysql 会为它分配一段内存缓冲区，此变量控制这一缓冲区的大小。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果对表的顺序扫描请求非常频繁，并且频繁扫描进行得太慢，可以通过增加此变量的值及内存缓冲区的大小提高其性能。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;read_buffer_size = 2M

&lt;span class=&#34;gh&#34;&gt;# mysql 随机读缓冲区大小。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 当按任意顺序读取行时（例如，按照排序顺序），mysql 将分配一个随机读缓冲区。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 在进行排序查询时，mysql 会首先扫描一遍该缓冲区，以避免在磁盘上搜索，提高查询速度。如果需要排序大量数据，可适当调高此值。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 当 mysql 会为每个客户端连接分配该缓冲空间，所以应尽量适当设置该值，以避免内存开销过大。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;read_rnd_buffer_size = 8M

&lt;span class=&#34;gh&#34;&gt;# mysql 执行排序时使用的缓冲区大小。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果想要增加 order by 的速度，首先看是否可以让 mysql 使用索引而不是额外的排序阶段，如果不能，可以尝试增加 sort_buffer_size 值的大小。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;sort_buffer_size = 8M

&lt;span class=&#34;gh&#34;&gt;# 联合查询操作所能使用的缓冲区大小。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 和 sort_buffer_size 一样，此参数分配的内存也是每个连接独享的，即连接级参数。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;join_buffer_size = 8M

&lt;span class=&#34;gh&#34;&gt;# 指定用于索引的缓冲区大小，增加它可得到更好处理的索引（对所有读和多重写），直到机器所能负担得起。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 如果此参数值太大，系统将开始换页，并变慢。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 对于内存在 4GB 左右的服务器，该参数可以设置为：384M 或 512M。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 通过检查状态值 key_read_request 和 key_reads，可以知道 key_buffer_size 设置是否合理。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 比例 key_reads / key_read_requests 应该尽可能的低，至少是 1:100，1:1000 更好，上述状态值可以使用 show status like &amp;#39;key_read%&amp;#39; 获得。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 注意，该参数值设置得过大反而会使服务器整体效率降低。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;key_buffer_size = 4M

&lt;span class=&#34;gh&#34;&gt;# 分词词汇的最小长度，默认为：4。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;ft_min_word_len = 4

&lt;span class=&#34;gh&#34;&gt;# mysql 支持四种事物隔离级别，分别是：READ-UNCOMMITTED，READ-COMMITTED，REPEATABLE-READ，SERIALIZABLE，如果没有指定，mysql 默认采用的是：REPEATABLE-READ。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# oracle 默认的事物隔离级别是：READ-COMMITTED。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;transaction_isolation = REPEATABLE-READ 

&lt;span class=&#34;gh&#34;&gt;# innodb 引擎配置
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
innodb_file_per_table = 1

&lt;span class=&#34;gh&#34;&gt;# 限制 InnoDB 同时能打开的表数据文件的最大值，如果数据库中的表特别多，需要增大此参数的值。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 此参数的值默认为：300，最小值为：10。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_open_files = 500

&lt;span class=&#34;gh&#34;&gt;# InnoDB 使用一个缓冲池来保存索引和原始数据，此处设置的值越大，在存取表里面数据时所需要的磁盘 I/O 越少。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 在一个独立使用的数据库服务器上，可以设置这个变量到服务器物理内存大小的 80%。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 不要设置过大，否则由于物理内存的竞争，可能会导致操作系统的换页颠簸。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 注意，在 32 位系统上，每个进程可能被限制在 2~3.5G 用户层面内存限制，因此，不要设置得太高。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_buffer_pool_size = 64M

&lt;span class=&#34;gh&#34;&gt;# innodb 使用后台线程处理数据页上的读写 I/O 请求，根据机器的 CPU 核数来修改，默认为：4。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 注意，这两个参数不支持动态改变，需要将该参数写入 my.cnf 文件中，修改完成后重启 mysql 服务，允许值的范围为：1~64。 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_write_io_threads = 4
innodb_read_io_threads = 4

&lt;span class=&#34;gh&#34;&gt;# 默认设置为：0，表示不限制并发数，也推荐设置为：0，更好地发挥多核 CPU 的处理能力，提高并发量。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_thread_concurrency = 0

&lt;span class=&#34;gh&#34;&gt;# InnoDB 中的清除操作是一类定期回收无用数据的操作。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 在之前的几个版本中，清除操作是主线程的一部分，这意味着运行时它可能会堵塞其他的数据库操作。 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 从 mysql 5.5.X 版本开始，该操作运行于独立的线程中，并支持更多的并发数。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 用户可通过设置 innodb_purge_threads 参数来选择清除操作是否使用单独线程。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 默认情况下，参数设置为：0，表示不使用单独线程；设置为：1 时，表示使用单独的清除线程，建议设置为：1.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_purge_threads = 1

&lt;span class=&#34;gh&#34;&gt;# 0：如果 innodb_flush_log_at_trx_commit 的值为 0，日志缓冲区就会每秒刷写日志文件到磁盘，提交事务的时候不做任何操作。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 执行是由 mysql 的 master thread 线程来执行的，主线程中每秒会将重做日志缓冲写入磁盘的重做日志文件中，不论事务是否已经提交，默认的日志文件是：ib_logfile0，ib_logfile1。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 1：当设置为默认值 1 的时候，每次提交事务的时候，都会将日志缓冲区刷写到日志。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 2：如果 innodb_flush_log_at_trx_commit 的值为 2，每次提交事务都会写日志，但并不会执行刷的操作，每秒定时会刷到日志文件。要注意的是，并不能保证 100% 每秒一定都会刷到磁盘，这要取决于进程的调度。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 每次事务提交的时候将数据写入事务日志，而这里的写入仅是调用了文件系统的写入操作，文件系统是有缓存的，所以这个写入并不能保证数据已经写入到物理磁盘。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 默认值 1 是为了保证完整的 ACID，当然，可以将这个配置项设为 1 以外的值来换取更高的性能，但是在系统崩溃的时候，将会失去 1 秒的数据。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 设为 0 的话，mysqld 进程崩溃的时候，会丢失最后 1 秒的事务。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 设为 2 的话，只有在操作系统崩溃或者断电的时候才会丢失最后 1 秒的数据，InnoDB在做恢复的时候会忽略这个值。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 结论：设为 1 当然是最安全的，但性能页是最差的，相对于其他两个而言，但不是不能接受。如果对数据一致性和完整性要求不高，完全可以设置为：2。如果只追求性能，例如高并发写的日志服务器，设为 0 来获得更高性能。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_flush_log_at_trx_commit = 1

&lt;span class=&#34;gh&#34;&gt;# 设置日志缓冲区的大小，以 M 为单位，缓冲区更大能提高性能，但意外的故障将会丢失数据。MySQL 开发人员建议设置为：1M~8M 之间。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_log_buffer_size = 2M

&lt;span class=&#34;gh&#34;&gt;# 设置数据日志文件的大小，更大的值可以提高性能，但也会增加恢复故障数据库所需的时间。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_log_file_size = 32M

&lt;span class=&#34;gh&#34;&gt;# 为提高性能，mysql 可以以循环方式将日志文件写到多个文件，推荐设置为：3。 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_log_files_in_group = 3

&lt;span class=&#34;gh&#34;&gt;# InnoDB 主线程刷新缓存池中的数据，使脏数据比例小于 90%。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_max_dirty_pages_pct = 90

&lt;span class=&#34;gh&#34;&gt;# InnoDB 事务在被回滚之前可以等待一个锁定的超时秒数，默认值为：50秒。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# InnoDB 在它自己的锁定表中自动检测事务死锁并且回滚事务。InnoDB 用 LOCK TABLES 语句锁定表，
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;innodb_lock_wait_timeout = 120

&lt;span class=&#34;gh&#34;&gt;# MyISAM 引擎配置 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 批量插入缓存大小，该参数是针对 MyISAM 存储引擎来说的，适用于在一次性插入100~1000+条记录时，提高效率。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 默认值为：8M，可以针对数据量的大小，翻倍增加。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;bulk_insert_buffer_size = 8M

&lt;span class=&#34;gh&#34;&gt;# MyISAM 设置恢复表之时使用的缓冲区的大小，当在 REPAIR TABLE 或用 CREATE INDEX 创建索引或 ALTER TABLE 过程中排序， MyISAM索引分配的缓冲区。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;myisam_sort_buffer_size = 8M

&lt;span class=&#34;gh&#34;&gt;# 此参数以字节的形式给出，如果临时文件会变得超过索引，不要使用快速排序索引方法来创建一个索引。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;myisam_max_sort_file_size = 10G

&lt;span class=&#34;gh&#34;&gt;# 如果该值大于 1，在 Repair by sorting 过程中并行创建 MyISAM 表索引（每个索引在自己的线程内）
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;myisam_repair_threads = 1

&lt;span class=&#34;gh&#34;&gt;# sync_binlog 参数控制 mysql 的二进制日志同步到磁盘的频率，取值为：0~n
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# sync_binlog=0：当事务提交之后，MySQL不做fsync之类的磁盘同步指令刷新binlog_cache中的信息到磁盘，而让Filesystem自行决定什么时候来做同步，或者cache满了之后才同步到磁盘。这个是性能最好的。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# sync_binlog=1：当每进行1次事务提交之后，MySQL将进行一次fsync之类的磁盘同步指令来将binlog_cache中的数据强制写入磁盘。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# sync_binlog=n：当每进行n次事务提交之后，MySQL将进行一次fsync之类的磁盘同步指令来将binlog_cache中的数据强制写入磁盘。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 大多数情况下，对数据的一致性并没有很严格的要求，所以并不会把 sync_binlog 配置成 1. 为了追求高并发，提升性能，可以设置为 100 或直接用 0。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;sync_binlog=1

[mysqldump]
quick

&lt;span class=&#34;gh&#34;&gt;# 服务器发送和接收的最大包长度
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;max_allowed_packet = 32M 

[myisamchk]
key_buffer_size = 8M
sort_buffer_size = 8M
read_buffer = 4M
write_buffer = 4M
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>在 Linux 发行版中安装工具包</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-alpine_tips/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-alpine_tips/</guid>
                <pubDate>Wed, 12 Sep 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下在一些 Linux 发行版中安装工具包的命令，在 docker 容器中排查问题时会有用。&lt;/p&gt;
&lt;h3 id=&#34;ubuntu&#34;&gt;ubuntu&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;使用 apt-get 命令来安装软件包&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1）安装 ps 命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apt-get install procps
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;alpine&#34;&gt;alpine&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;使用 apk 命令来安装软件包&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1）安装 telnet 命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apk add busybox-extras
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）安装 make 命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apk add make
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）安装 ps 命令&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;apk add procps
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;debain&#34;&gt;debain&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;使用 apt-get 命令来安装工具包&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1）安装 nc 命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apt-get update &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; install netcat
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）安装 ps 命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apt-get update &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install procps
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）安装 curl 命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;apt-get update &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install curl
或者
apt-get update &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install net-tools
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 部分高级命令总结</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-advanced-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-advanced-command/</guid>
                <pubDate>Tue, 11 Sep 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客整理了一些 Linux 系统中常用的高级命令，在一些复杂的运维工作中会用到。&lt;/p&gt;
&lt;h3 id=&#34;netstat&#34;&gt;netstat&lt;/h3&gt;
&lt;p&gt;netstat 是一个监控 TCP/IP 网络的工具，可以显示路由表、实际的网络连接以及每一个网络接口设备的状态信息。其语法格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;netstat [options]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-a 或 --all：显示所有的 socket，包括已建立（CONNECTED）的连接，也包括监听连接请求（LISTENING）的那些连接。&lt;/li&gt;
&lt;li&gt;-c 或 --continuous：持续显示 socket 连接状态。&lt;/li&gt;
&lt;li&gt;-l 或 --listening：显示处于监听状态的服务器 socket。&lt;/li&gt;
&lt;li&gt;-t 或 --tcp：显示 TCP 协议的连接状况。&lt;/li&gt;
&lt;li&gt;-u 或 --udp：显示 UDP 协议的连接状况。&lt;/li&gt;
&lt;li&gt;-n 或 --numeric：直接使用 IP 地址，而不通过域名服务器。&lt;/li&gt;
&lt;li&gt;-p 或 --programs：显示正在使用 socket 的进程ID/程序名称。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果使用时不带参数，netstat 显示活动的 TCP 连接。&lt;/p&gt;
&lt;p&gt;1、列出所有的端口，包括监听的和未监听的&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;netstat -a   # 列出所有的端口
netstat -au  # 列出所有的 TCP 端口
netstat -at  # 列出所有的 UDP 端口
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、列出所有处于监听状态的 Socket&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;netstat -l   # 只列出监听（即State 状态为 LISTENING）状况的端口，
netstat -lt  # 只列出所有监听的 TCP 端口
netstat -lu  # 只列出所有监听的 UDP 端口
netstat -lx  # 只列出所有监听 UNIX 的
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、显示 pid 和进程名称&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;netstat -p
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;journalctl&#34;&gt;journalctl&lt;/h3&gt;
&lt;p&gt;systemd 统一管理所有 Unit 的启动日志。带来的好处就是，可以只使用 journalctl 一个命令，查看所有的日志，包括内核日志和应用日志。&lt;/p&gt;
&lt;p&gt;日志的配置文件为：/etc/systemd/journald.conf&lt;/p&gt;
&lt;p&gt;1）查看所有日志，默认情况下，只保存本次启动的日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）查看内核日志，不显示应用日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl -k
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;查看指定时间的日志&#34;&gt;查看指定时间的日志&lt;/h4&gt;
&lt;p&gt;可以使用 --since 和 --until 选项过滤任意时间限制，这些限制分别显示给定时间之前或之后的记录。&lt;/p&gt;
&lt;p&gt;journalctl 还能理解部分相对值及命名简写。例如，可以使用 yesterday，today，tomorrow 或 now 等表达。另外，我们也可以使用“-”或者“+”设定相对值，或者使用“ago”的表达。&lt;/p&gt;
&lt;p&gt;1、显示 2018年07月11日，16点43分30秒到当前时间之间的所有日志信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl --since=&amp;#34;2018-07-11 16:43:30&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、获取昨天的日志信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl --since yesterday
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、获取某一个时间段到当前时间的前一个小时的日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl --since 12:00 --until &amp;#34;1 hour ago&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、获取当前时间的前20分钟的日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl --since &amp;#34;20 min ago&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、获取某一天到某一个时间段的日志信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl --since &amp;#34;2018-07-11&amp;#34; --until &amp;#34;2018-07-12 17:00:00&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、查看 httpd 服务的日志信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl -u httpd --since today # -u 选项指定待查看的单元
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、按照进程ID查看日志信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl _PID=1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、按日志级别显示日志条目&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl -p err # -p 选项显示特定优先级的信息，从而过滤掉优先级较低的信息。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这将只显示被标记为错误、严重、警告或者紧急级别的信息。我们也可以使用优先级名称或者其相关量化值，以下各数字为由最高到最低优先级：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;0:emerg
1:alert
2:crit
3:err
4:warning
5:notice
6:info
7:debug
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;9、显示近期的日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl -n200  # 使用 -n 选项指定显示特定数量的记录，默认情况下只显示最后发生的10条日志记录。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;10、追踪日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl -f # 表示主动追踪当前正在输出的日志，只要不终止，会一直监控。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;11、查看当前日志占用磁盘的空间的总大小&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl --disk-usage
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;12、指定日志文件最大空间&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl --vacuum-size=1G
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;13、指定日志文件保存时间&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl --vacuum-time=1years
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参考资料：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/itxdm/p/Systemd_log_system_journalctl.html&#34;&gt;https://www.cnblogs.com/itxdm/p/Systemd_log_system_journalctl.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.51cto.com/13598893/2072212&#34;&gt;http://blog.51cto.com/13598893/2072212&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;nslookup&#34;&gt;nslookup&lt;/h3&gt;
&lt;p&gt;nslookup 是常用的域名查询工具，就是查询 DNS 信息用的命令。&lt;/p&gt;
&lt;p&gt;nslookup 有两种工作模式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;交互模式：在该模式下，用户可以向域名服务器查询各类主机、域名的信息，或者输出域名中的主机列表。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;进入交互模式，直接输入 nslookup 命令，不加任何参数，则直接进入交互模式，此时 nslookup 会连接到默认的域名服务器（即&lt;code&gt;/etc/resolv.conf&lt;/code&gt;的第一个 DNS 地址）&lt;/p&gt;
&lt;p&gt;或者输入 &lt;code&gt;nslookup -nameserver/ip&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;非交互模式：在“非交互模式”下，用户可以针对一个主机或域名仅仅获取特定的名称或所需信息。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;进入非交互模式，就直接输入 &lt;code&gt;nslookup domainname&lt;/code&gt; 即可。&lt;/p&gt;
&lt;h4 id=&#34;示例&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、使用默认的域名服务器，根据域名查找 IP 地址&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# nslookup www.baidu.com
Server:		10.10.24.11
Address:	10.10.24.11#53

Non-authoritative answer:
www.baidu.com	canonical name = www.a.shifen.com.
Name:	www.a.shifen.com
Address: 61.135.169.121
Name:	www.a.shifen.com
Address: 61.135.169.125
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、使用默认的域名服务器，根据 IP 地址查找域名&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# nslookup 10.10.24.11
Server:		10.10.24.11
Address:	10.10.24.11#53

11.24.10.10.in-addr.arpa	name = r-29792-VM.cs1cloud.internal.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者是这样&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# nslookup www.taobao.com
Server:		10.10.24.11
Address:	10.10.24.11#53

Non-authoritative answer:
www.taobao.com	canonical name = www.taobao.com.danuoyi.tbcache.com.
Name:	www.taobao.com.danuoyi.tbcache.com
Address: 123.129.215.222
Name:	www.taobao.com.danuoyi.tbcache.com
Address: 123.129.215.178

[root@xdhuxc xdhuxc]# nslookup 123.129.215.178
Server:		10.10.24.11
Address:	10.10.24.11#53

&lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt; server can&amp;#39;t find 178.215.129.123.in-addr.arpa.: NXDOMAIN
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、列出当前设置的默认选项&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# nslookup
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;set all
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;Default server: 10.10.24.11
Address: 10.10.24.11#53
Default server: 202.106.0.20
Address: 202.106.0.20#53
Default server: 114.114.114.114
Address: 114.114.114.114#53

Set options:
  novc			nodebug		nod2
  search		recurse
  timeout = 0		retry = 3	port = 53
  querytype = A       	class = IN
  srchlist = cs1cloud.internal
&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;相对而言，ping 命令只是一个检查网络连通情况的命令，虽然在输入的参数是域名的情况下会通过 DNS 进行查询，但是它只能查询 A 类型和 CNAME 类型的记录，而且只会告诉域名是否存在，不提供其他信息。&lt;/p&gt;
&lt;h3 id=&#34;systemctl&#34;&gt;systemctl&lt;/h3&gt;
&lt;p&gt;systemctl 命令是系统服务管理器指令，实际上将 service 和 chkconfig 这两个命令组合到一起&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;任务&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;旧指令&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;新指令&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;使某服务自动启动&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;chkconfig --level 3 httpd on&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;systemctl enable httpd.service&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;使某服务不自动启动&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;chkconfig --level 3 httpd off&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;systemctl disable httpd.service&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;检查服务状态&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;service httpd status&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;systemctl status httpd.service(显示服务详细信息)systemctl is-active httpd.service(仅显示是否Active)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;显示所有已启动的服务&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;chkconfig --list&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;systemctl list-units --type=service&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;启动某服务&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;service httpd start&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;systemctl start httpd.service&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;停止某服务&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;service httpd stop&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;systemctl stop httpd.service&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;重启某服务&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;service httpd restart&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;systemctl restart httpd.service&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;1、启动nfs服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl start nfs-server.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、设置开机自启动&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl enable nfs-server.server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、停止开机启动&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl disable nfs-server.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、查看服务当前状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl status nfs-server.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、重新启动某服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart nfs-server.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、查看所有已启动的服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl list -units --type=service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;top-命令&#34;&gt;top 命令&lt;/h3&gt;
&lt;p&gt;top 命令是linux下常用的性能分析工具，能够实时显示系统中各个进程的资源占用状况。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;top - 08:50:33 up 4 days, 17:17,  4 users,  load average: 3.02, 2.95, 2.36
Tasks: 106 total,   1 running, 105 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.0 us,  0.1 sy,  0.0 ni, 99.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem :  8010904 total,  3164800 free,  1467176 used,  3378928 buff/cache
KiB Swap:  2096124 total,  2096124 free,        0 used.  6235608 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                               
    1 root      20   0   57504   3376   2260 S   0.0  0.0   1:34.67 systemd                                                                                               
    2 root      20   0       0      0      0 S   0.0  0.0   0:00.09 kthreadd                                                                                              
    3 root      20   0       0      0      0 S   0.0  0.0   0:00.03 ksoftirqd/0                                                                                           
    5 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/0:0H                                                                                          
    6 root      20   0       0      0      0 S   0.0  0.0   0:08.34 kworker/u8:0                                                                                          
    7 root      rt   0       0      0      0 S   0.0  0.0   0:00.12 migration/0                                                                                           
    8 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcu_bh                                                                                                
    9 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcuob/0                                                                                               
   10 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcuob/1                                                                                               
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;统计信息区前五行是系统整体的统计信息&lt;/p&gt;
&lt;p&gt;第一行是任务队列信息，同uptime命令的执行结果，其内容分别描述如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;信息&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;08:50:33&lt;/td&gt;
&lt;td&gt;当前时间&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;up 4 days, 17:17&lt;/td&gt;
&lt;td&gt;系统运行时间，格式为：小时:分钟&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4 users&lt;/td&gt;
&lt;td&gt;当前登录用户数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;load average: 3.02, 2.95, 2.36&lt;/td&gt;
&lt;td&gt;系统负载，即任务队列的平均长度，三个数值分别为1分钟，5分钟，15分钟前到现在的平均值。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;第二，三行为进程和CPU的信息，当有多个CPU时，这些内容可能会超过两行，内容如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;信息&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Tasks: 106 total&lt;/td&gt;
&lt;td&gt;进程总数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1 running&lt;/td&gt;
&lt;td&gt;正在运行的进程数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;105 sleeping&lt;/td&gt;
&lt;td&gt;睡眠的进程数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0 stopped&lt;/td&gt;
&lt;td&gt;停止的进程数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0 zombie&lt;/td&gt;
&lt;td&gt;僵尸进程数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%Cpu(s):  0.0 us（user）&lt;/td&gt;
&lt;td&gt;用户空间占用CPU百分比&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.1 sy（system）&lt;/td&gt;
&lt;td&gt;内核空间占用CPU百分比&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 ni（nice）&lt;/td&gt;
&lt;td&gt;用户进程空间内改变过优先级的进程占用CPU百分比&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;99.9 id（idle）&lt;/td&gt;
&lt;td&gt;空闲CPU百分比&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 wa （IO-wait）&lt;/td&gt;
&lt;td&gt;等待输入输出的CPU时间百分比&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 hi（hardware interrupt）&lt;/td&gt;
&lt;td&gt;CPU服务于硬中断所耗费的时间总额&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 si （software intrerupt）&lt;/td&gt;
&lt;td&gt;CPU服务于软中断所耗费的时间总额&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0.0 st&lt;/td&gt;
&lt;td&gt;当前虚拟机中被虚拟化偷走的时间&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;最后两行为内存信息，内容如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;信息&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;KiB Mem :  8010904 total&lt;/td&gt;
&lt;td&gt;物理内存总量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3164800 free&lt;/td&gt;
&lt;td&gt;空闲内存总量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1467176 used&lt;/td&gt;
&lt;td&gt;使用的物理内存总量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3378928 buff/cache&lt;/td&gt;
&lt;td&gt;用作内核缓存的内存量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;KiB Swap:  2096124 total&lt;/td&gt;
&lt;td&gt;交换区总量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2096124 free&lt;/td&gt;
&lt;td&gt;空闲交换区总量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;0 used&lt;/td&gt;
&lt;td&gt;使用的交换区总量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6235608 avail Mem&lt;/td&gt;
&lt;td&gt;可用内存，&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;列名及含义&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;列明&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;PID&lt;/td&gt;
&lt;td&gt;进程ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PPID&lt;/td&gt;
&lt;td&gt;父进程ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UID&lt;/td&gt;
&lt;td&gt;进程所有者的用户ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;USER&lt;/td&gt;
&lt;td&gt;进程所有者的用户名&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TTY&lt;/td&gt;
&lt;td&gt;启动进程的终端名称，不是从终端启动的进程则显示为？&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PR&lt;/td&gt;
&lt;td&gt;进程优先级&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NI&lt;/td&gt;
&lt;td&gt;nice值，负值表示高优先级，正值表示低优先级&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%CPU&lt;/td&gt;
&lt;td&gt;上次更新到现在的CPU时间占用百分比&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TIME&lt;/td&gt;
&lt;td&gt;进程使用的CPU时间总计，单位：秒&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TIME+&lt;/td&gt;
&lt;td&gt;进程使用的CPU时间总计，单位：1/100秒&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%MEM&lt;/td&gt;
&lt;td&gt;进程使用的物理内存百分比&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;VIRT&lt;/td&gt;
&lt;td&gt;进程使用的虚拟内存总量，单位：KB，VIRT=SWAP+RES&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SWAP&lt;/td&gt;
&lt;td&gt;进程使用的虚拟内存中，被换出的大小，单位：KB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RES&lt;/td&gt;
&lt;td&gt;进程使用的，未被换出的物理内存大小，单位：KB，RES=CODE+DATA&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CODE（the Text Resident Set size or TRS）&lt;/td&gt;
&lt;td&gt;可执行代码占用的物理内存大小，单位为：KB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DATA （the Data Resident Set size or DRS）&lt;/td&gt;
&lt;td&gt;可执行代码以外的部分（数据段+栈）占用的物理内存大小，单位：KB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SHR&lt;/td&gt;
&lt;td&gt;共享内存大小，单位：KB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;S&lt;/td&gt;
&lt;td&gt;进程状态：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;D：不可中断的睡眠状态&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;R：运行，该进程目前正在运行，或者说可以被运行&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;S：睡眠，该进程目前正在睡眠当中，可被某些信号唤醒&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T：跟踪或停止，该进程目前正在侦测或被停止了&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Z：僵尸进程，该进程应该已经被终止，但其父进程却无法正常终止它，造成僵尸状态&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;COMMAND&lt;/td&gt;
&lt;td&gt;命令名或命令行&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;执行 &lt;code&gt;top&lt;/code&gt; 命令后，默认显示CPU整体情况，按左上角 &lt;code&gt;1&lt;/code&gt; 键，显示每个 &lt;code&gt;CPU&lt;/code&gt; 的负载情况&lt;/p&gt;
&lt;p&gt;输入 top 命令，快捷键使用如下：&lt;/p&gt;
&lt;p&gt;按 ‘X’ 键，再按 ‘B’ 键，默认按 CPU 使用率降序排列&lt;/p&gt;
&lt;p&gt;按住 ‘Shift’ 键，再按 ‘P’ 键，是按 CPU使用率 降序排列。&lt;/p&gt;
&lt;p&gt;按住 ‘Shift’ 键，再按 ‘M’ 键，是按 内存使用率 降序排列。&lt;/p&gt;
&lt;p&gt;按住 ‘Shift’ 键，再按 ‘T’ 键，是按 进程运行时间 降序排列。&lt;/p&gt;
&lt;p&gt;按 ‘F’ 键，进入字段管理页面，使用上下键控制光标移动，使用光标选中某字段，按 ‘D’ 或者空格，取消该列的显示，按 ‘q’ 或 ‘Esc’ 再次进入 top 命令页面，可以看到刚才选中的列已经不显示了。&lt;/p&gt;
&lt;p&gt;在字段管理页面，使用光标选中某字段后，按 ‘S’ 键，可将该字段设置为排序字段，然后按 ‘Esc’ 或 ‘Q’ 键退出，默认按降序排列。若要改为升序排列，按住 ‘Shift’ 键，然后按 ‘R’ 键，即可按照排序字段升序排列。&lt;/p&gt;
&lt;h3 id=&#34;uniq-命令&#34;&gt;uniq 命令&lt;/h3&gt;
&lt;p&gt;uniq 命令用于报告或忽略文件中的重复行，一般与sort命令结合使用&lt;/p&gt;
&lt;p&gt;选项如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-c，--count：在每列前面显示该行重复出现的次数。&lt;/li&gt;
&lt;li&gt;-u，--unique：仅显示出现一次的行。&lt;/li&gt;
&lt;li&gt;-d，--repeated：仅显示重复出现的行，与uniq的区别是：uniq显示所有出现的行，包括出现一次的，而-d选项去除了只出现一次的。&lt;/li&gt;
&lt;li&gt;-i，--ignore-case：不区分大小写。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sort-命令&#34;&gt;sort 命令&lt;/h3&gt;
&lt;p&gt;sort 命令将文件内容进行排序，并将排序结果标准输出，默认为字符排序和升序排列。&lt;/p&gt;
&lt;p&gt;选项如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-n：依照数值的大小排序。&lt;/li&gt;
&lt;li&gt;-k：指定需要排序的栏位。&lt;/li&gt;
&lt;li&gt;-h：以人类可读的形式显示。&lt;/li&gt;
&lt;li&gt;-r：以相反的顺序来排序，即降序排列。&lt;/li&gt;
&lt;li&gt;-t：指定栏位分隔符&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;1、查看nginx日志中出现地IP数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cat access.log | awk -F &amp;#39;|&amp;#39; &amp;#39;{print $1}&amp;#39; | sort | uniq -c | sort -k1nr | head -n 10
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;示例如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost nginx]# cat xdhuxc.log | awk -F &amp;#39;|&amp;#39; &amp;#39;{print $1}&amp;#39; | sort | uniq -c | sort -k1nr| head -n 5
   5522 172.20.26.127
   4873 172.20.13.111
   2426 172.20.26.128
    876 172.20.17.6
    806 172.20.17.8
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;ps-命令&#34;&gt;ps 命令&lt;/h3&gt;
&lt;p&gt;1、查看进程下的线程&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ps -T -p 4561          # 2561 为进程 ID。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看进程树，并输出指定属性&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master kubepods]# ps xf -o pid,ppid,stat,args
  PID  PPID STAT COMMAND
ps xf -o pid,ppid,stat,args
22013     1 Ssl  /usr/bin/dockerd --exec-opt native.cgroupdriver=cgroupfs --storage-driver=devicemapper --insecure-registry 0.0.0.0/0 --registry-mirror http://172.20.2
22023 22013 Ssl   \_ docker-containerd -l unix:///var/run/docker/libcontainerd/docker-containerd.sock --metrics-interval=0 --start-timeout 2m --state-dir /var/run/dock
22324 22023 Sl        \_ docker-containerd-shim 0df7c0ad8b966b62944775ceeab92f337565ae5230176e63e9a835f611fd6618 /var/run/docker/libcontainerd/0df7c0ad8b966b62944775ce
22350 22324 Ss        |   \_ /pause
22424 22023 Sl        \_ docker-containerd-shim 1b46c083a0c1b8220985830a21ceb47aba66bba19e8c502c3a962cc8e4610c23 /var/run/docker/libcontainerd/1b46c083a0c1b8220985830a
22446 22424 Ss        |   \_ /pause
22555 22023 Sl        \_ docker-containerd-shim b6600a35e42def755b300f470e09982644026cb4bcff47425b67dd29deb6c279 /var/run/docker/libcontainerd/b6600a35e42def755b300f47
22575 22555 Ss        |   \_ /pause
22615 22023 Sl        \_ docker-containerd-shim aab94460ba50336a123ef79874be9a57d48b8a9ca5df0440034be804be21dd46 /var/run/docker/libcontainerd/aab94460ba50336a123ef798
22640 22615 Ss        |   \_ /pause
22717 22023 Sl        \_ docker-containerd-shim 055666c9918be5042a0e8450e68fd716698f74db8d17ed31a477a65df5f5f61c /var/run/docker/libcontainerd/055666c9918be5042a0e8450
22746 22717 Ss        |   \_ /pause
22823 22023 Sl        \_ docker-containerd-shim fc6644e7c274a6695291afb927705a60de34dc232afdcb32f4cbe71ced2bde1c /var/run/docker/libcontainerd/fc6644e7c274a6695291afb9
22843 22823 Ssl       |   \_ /usr/bin/kube-controllers
22926 22023 Sl        \_ docker-containerd-shim fc115ec286f1f90ef9ba3a30f93e8636fec97ff32394dc067642b98695399c2a /var/run/docker/libcontainerd/fc115ec286f1f90ef9ba3a30
22967 22926 Ss        |   \_ /pause
22992 22023 Sl        \_ docker-containerd-shim 5335322da47f532e81bd49ce19047d7dce9de3772201e165d417b4c3a2f3061f /var/run/docker/libcontainerd/5335322da47f532e81bd49ce
23033 22992 Ss        |   \_ /pause
23091 22023 Sl        \_ docker-containerd-shim 558e3570397e4b178d1e03828bc4094b8544f5e8021192692509502ed6c41f62 /var/run/docker/libcontainerd/558e3570397e4b178d1e0382
23114 23091 Ss        |   \_ /pause
23178 22023 Sl        \_ docker-containerd-shim 630bb2f866da362faee80b00ff771f4c3900e442d0efc730470e9ebd5c89ef5c /var/run/docker/libcontainerd/630bb2f866da362faee80b00
23201 23178 Ss        |   \_ /pause
23269 22023 Sl        \_ docker-containerd-shim 4fe2e9adc614057e37aa9e6f1428fe244e8e79720b36f1044d2fdffe0627a151 /var/run/docker/libcontainerd/4fe2e9adc614057e37aa9e6f
23290 23269 Ss        |   \_ /usr/bin/dumb-init /nginx-ingress-controller --default-backend-service=ingress-nginx/default-http-backend --configmap=ingress-nginx/nginx-
23313 23290 Ssl       |       \_ /nginx-ingress-controller --default-backend-service=ingress-nginx/default-http-backend --configmap=ingress-nginx/nginx-configuration -
23655 23313 S         |           \_ nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf
23356 22023 Sl        \_ docker-containerd-shim d24b9bd89b0614770bab8e4022f9c478bbf1f95961ae03733ea4ba089b2d1c2d /var/run/docker/libcontainerd/d24b9bd89b0614770bab8e40
23376 23356 Ss        |   \_ /sbin/runsvdir -P /etc/service/enabled
24256 23376 Ss        |       \_ runsv felix
24267 24256 Sl        |       |   \_ calico-felix
24257 23376 Ss        |       \_ runsv bird
24268 24257 S         |       |   \_ bird -R -s /var/run/calico/bird.ctl -d -c /etc/calico/confd/config/bird.cfg
24258 23376 Ss        |       \_ runsv bird6
24262 24258 S         |       |   \_ bird6 -R -s /var/run/calico/bird6.ctl -d -c /etc/calico/confd/config/bird6.cfg
24259 23376 Ss        |       \_ runsv confd
24263 24259 Sl        |           \_ confd -confdir=/etc/calico/confd -interval=5 -watch --log-level=info -node=http://172.20.26.150:2379 -client-key= -client-cert= -c
23475 22023 Sl        \_ docker-containerd-shim d5582f7b927c731966c6e75d0619f16fec661c1d8b287e7b47020c13f4f29879 /var/run/docker/libcontainerd/d5582f7b927c731966c6e75d
23503 23475 Ss        |   \_ /pause
23583 22023 Sl        \_ docker-containerd-shim 9b680676ec0fd4434fef03a614e32908849947f7d87be73894304745909ae308 /var/run/docker/libcontainerd/9b680676ec0fd4434fef03a6
23604 23583 Ssl       |   \_ /usr/bin/kube-controllers
23720 22023 Sl        \_ docker-containerd-shim 95054e9ec8211a283e5b5e2fe271687cbc8a6febc28b6a58811871c9c70abf26 /var/run/docker/libcontainerd/95054e9ec8211a283e5b5e2f
23749 23720 Ssl       |   \_ /usr/local/bin/etcd -data-dir /var/etcd/data -listen-client-urls http://127.0.0.1:2379,http://127.0.0.1:4001 -advertise-client-urls http:/
24159 22023 Sl        \_ docker-containerd-shim cacf746cbac262377a3925c9c47bd36e5a06a2de688d8257949b4cedfdf0e552 /var/run/docker/libcontainerd/cacf746cbac262377a3925c9
24180 24159 Ssl       |   \_ /usr/bin/kube-controllers
24215 22023 Sl        \_ docker-containerd-shim 4c294ff5706f5f45ece29911d508d94513c1728f900cc808653377c5d92b9a0d /var/run/docker/libcontainerd/4c294ff5706f5f45ece29911
24239 24215 Ssl       |   \_ /usr/bin/kube-controllers
24404 22023 Sl        \_ docker-containerd-shim c260f89fc132757701cf374ffa3c336ea09561c0ec2fdb62a7b955c5086ec635 /var/run/docker/libcontainerd/c260f89fc132757701cf374f
24422 24404 Ss        |   \_ /bin/sh -c /run.sh $FLUENTD_ARGS
24457 24422 S         |       \_ /bin/sh /run.sh --no-supervisor
24459 24457 Sl        |           \_ /usr/bin/ruby2.3 /usr/local/bin/fluentd --no-supervisor
24499 22023 Sl        \_ docker-containerd-shim 23be602627713a4d4a8f6022c0149e7ed12ded42d8b6821b778412fe879d3349 /var/run/docker/libcontainerd/23be602627713a4d4a8f6022
24521 24499 Ss        |   \_ /bin/sh /install-cni.sh
 2160 24521 S         |       \_ sleep 10
24539 22023 Sl        \_ docker-containerd-shim a0b332204da15546ae376fae91bd93488a54e19ad15bcb4074f4e4d6c703d007 /var/run/docker/libcontainerd/a0b332204da15546ae376fae
24566 24539 Ssl       |   \_ /usr/bin/kube-controllers
24683 22023 Sl        \_ docker-containerd-shim 45538bf87293a303e784c1f2b4c9d05613dc26e284a9ff714e0a4ab78952d903 /var/run/docker/libcontainerd/45538bf87293a303e784c1f2
24712 24683 Ssl       |   \_ /kube2sky -domain=kube.local
24746 22023 Sl        \_ docker-containerd-shim 8d1012c2cfebea10d9f250aa803c523860f6213ba057d85611385ce55de01639 /var/run/docker/libcontainerd/8d1012c2cfebea10d9f250aa
24909 22023 Sl        \_ docker-containerd-shim 5381a8ce1f7fdf31aa0b87a4d6b63469bd99b3a814ce0f38c3e2dddfbb13cc68 /var/run/docker/libcontainerd/5381a8ce1f7fdf31aa0b87a4
24928 24909 Ssl       |   \_ /skydns -machines=http://localhost:4001 -addr=0.0.0.0:53 -domain=kube.local
24992 22023 Sl        \_ docker-containerd-shim 1cc405561a9ed15554658b1237339273b57ae5e68c85f4497741fa0b16248e7e /var/run/docker/libcontainerd/1cc405561a9ed15554658b12
25010 24992 Ssl       |   \_ /exechealthz -cmd=nslookup kubernetes.default.svc.kube.local localhost &amp;gt;/dev/null -port=8080
31505 22023 Sl        \_ docker-containerd-shim 39fd7f660d705e6406d6e5bedeb3082e384370f0557c7c0b8edc91e97e1a945f /var/run/docker/libcontainerd/39fd7f660d705e6406d6e5be
31523 31505 Ss        |   \_ /pause
31636 22023 Sl        \_ docker-containerd-shim 2b4014ca44a5752cd827734f49fcbd58724c5373a90dd06ffeef33a5f627d953 /var/run/docker/libcontainerd/2b4014ca44a5752cd827734f
31653 31636 Ssl           \_ /dashboard --insecure-bind-address=0.0.0.0 --bind-address=0.0.0.0 --auto-generate-certificates
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;tree-命令&#34;&gt;tree 命令&lt;/h3&gt;
&lt;p&gt;1、查看当前目录下的目录及文件详情&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tree -a # 显示当前目录下的所有文件及目录
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看当前目录三级以内的文件及目录详情&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# -L：指定目录深度。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;tree -L 3 # 显示当前目录三级以内的文件及目录详情
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查看当前目录三级以内的文件及目录详情及文件和目录的大小，并以可读的方式显示&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tree -L --du -h # 显示当前目录三级以内的文件及目录详情，并以可读方式显示目录和文件的大小。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;w-命令&#34;&gt;w 命令&lt;/h3&gt;
&lt;p&gt;w 命令用于显示已经登录系统的用户列表，并显示用户正在执行的命令。执行此命令可以知道目前登录进系统的用户以及他们正在执行的程序，还包括他们登录的 IP 地址。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# w
 16:04:06 up 27 days, 23 min,  2 users,  load average: 0.00, 0.01, 0.05
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/1    10.6.198.249     Mon10   24:15m  0.13s  0.13s -bash
root     pts/4    10.4.100.45      09:32    6.00s  0.01s  0.00s w
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;cut-命令&#34;&gt;cut 命令&lt;/h3&gt;
&lt;p&gt;指定分隔符截取文件内容，而不是默认的tab&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cat /etc/passwd | cut -d &amp;#34;:&amp;#34; -f 1 # 查询linux系统中的所有用户 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 中 crontab 的使用</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-cronjob/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-cronjob/</guid>
                <pubDate>Fri, 07 Sep 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;我们有时需要用到定时任务来备份数据或者发送邮件，此时，一般会使用 Linux 系统中的 crontab 来实现。其他各种系统的定时任务使用的定时策略描述方式与 Linux 系统的 crontab 基本一样。&lt;/p&gt;
&lt;h3 id=&#34;定时任务&#34;&gt;定时任务&lt;/h3&gt;
&lt;p&gt;1、命令格式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;crontab [-u user] file crontab [-u user] [-e | -l | -r | -i]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-u user：设定指定用户的 crontab 服务；&lt;/li&gt;
&lt;li&gt;file：命令文件的名字，表示将 file 作为 crontab 的任务列表文件并载入 crontab。如果在命令行中没有指定这个文件，crontab 命令将接收标准输入上输入的命令，并将它们载入 crontab；&lt;/li&gt;
&lt;li&gt;-e：编辑 crontab 文件内容；&lt;/li&gt;
&lt;li&gt;-l：显示 crontab 文件内容；&lt;/li&gt;
&lt;li&gt;-r：从 /var/spool/cron 目录中删除 crontab 文件；&lt;/li&gt;
&lt;li&gt;-i：在删除 crontab 文件时给确认提示&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、crontab 文件格式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# ┌───────────── minute (0 - 59)
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# │ ┌───────────── hour (0 - 23)
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# │ │ ┌───────────── day of the month (1 - 31)
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# │ │ │ ┌───────────── month (1 - 12)
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# │ │ │ │ ┌───────────── day of the week (0 - 6) (Sunday to Saturday;
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# │ │ │ │ │                                   7 is also Sunday on some systems)
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# │ │ │ │ │
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# │ │ │ │ │
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# * * * * * command to execute
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;依次分别是：分钟 小时 日 月份 星期 运行命令，分别使用空格分隔。&lt;/p&gt;
&lt;p&gt;特殊字符含义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;*：表示任何时刻都能接受；&lt;/li&gt;
&lt;li&gt;,：表示分隔时段，例如：&lt;code&gt;30 10,17 * * * command&lt;/code&gt; 表示上午九点半和下午五点半分别执行 command；&lt;/li&gt;
&lt;li&gt;-：表示一段时间范围，例如：&lt;code&gt;30 7-10 * * * command&lt;/code&gt; 表示从七点到十点的每个小时的30分钟都执行 command；&lt;/li&gt;
&lt;li&gt;/n：n 代表数字，表示每个 n 单位间隔，例如：&lt;code&gt;*/5 * * * * command&lt;/code&gt; 表示每隔 5 分钟执行一次 command；&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;示例&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、每周一至周五早上10点和下午5点各执行一次&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;0 10,17 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; 0-5 command
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、每小时的第21分钟和第37分钟执行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;21,37 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; command
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、在上午7点到10点的每小时的第11和第47分钟执行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;11,47 7-10 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; * command
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、每晚 10:30 执行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;30 22 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; * command
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、每周六、周日的12点30分执行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;30 12 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; 6,0 command
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、每隔 60 分钟执行一次&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;*/60 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; command
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、整点执行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;0 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; command # 将在每个整点执行 command
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、每分钟向 &lt;code&gt;/home/xdhuxc.txt&lt;/code&gt; 中输出 &lt;code&gt;Hello World&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;crontab -e 
&lt;span class=&#34;ge&#34;&gt;*/1 *&lt;/span&gt; &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; * echo &amp;#34;&amp;#34; &amp;gt; /home/xdhuxc.txt
systemctl restart crond
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;注意事项&#34;&gt;注意事项&lt;/h3&gt;
&lt;p&gt;1、脚本中涉及文件路径时需要绝对路径；&lt;/p&gt;
&lt;p&gt;2、脚本执行时要用到环境变量时，通过 source 命令引入环境变量；&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;source /etc/profile
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、当手动执行脚本可以正确执行，但是 crontab 却不执行时，很可能是没有配置环境变量导致的，可在 crontab 中直接引入环境变量解决问题&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;0 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; source /etc/profile &lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt; /bin/sh /home/xdhuxc/abc.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、新创建的 cron job，不会马上执行，至少要过2分钟才执行，但是如果重启 crond，则马上执行；&lt;/p&gt;
&lt;p&gt;5、清理系统用户的邮件日志，每条任务调度完毕，系统都会将任务输出信息通过电子邮件的形式发送给当前系统用户，这样日积月累，日志信息会非常大，可能会影响系统的正常运行。因此，将每条任务进行重定向处理非常重要，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;0 &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; &lt;span class=&#34;ge&#34;&gt;* *&lt;/span&gt; /bin/sh /home/xdhuxc/abc.sh &amp;gt;/dev/null 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html&#34;&gt;https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://code.kpman.cc/2015/02/11/%E5%88%A9%E7%94%A8-crontab-%E4%BE%86%E5%81%9A-Linux-%E5%9B%BA%E5%AE%9A%E6%8E%92%E7%A8%8B/&#34;&gt;https://code.kpman.cc/2015/02/11/%E5%88%A9%E7%94%A8-crontab-%E4%BE%86%E5%81%9A-Linux-%E5%9B%BA%E5%AE%9A%E6%8E%92%E7%A8%8B/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Cron&#34;&gt;https://en.wikipedia.org/wiki/Cron&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/shell/">Shell</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 docker 方式部署 infludb</title>
                <link>https://xdhuxc.github.io/posts/storage/influxdb/influxdb-install-with-docker/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/influxdb/influxdb-install-with-docker/</guid>
                <pubDate>Wed, 29 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了基于 docker 容器方式部署 influxdb 的详细过程。&lt;/p&gt;
&lt;h3 id=&#34;拉取-docker-镜像&#34;&gt;拉取 docker 镜像&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull influxdb:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;启动-influxdb-容器&#34;&gt;启动 influxDB 容器&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
      --restart=always \
      --name=influxdb \
      -p 8086:8086 \
      -p 8083:8083 \
      -e INFLUXDB_DB=db0 -e INFLUXDB_ADMIN_ENABLED=true \
      -e INFLUXDB_ADMIN_USER=admin -e INFLUXDB_ADMIN_PASSWORD=Admin321 \
      -e INFLUXDB_USER=texadg -e INFLUXDB_USER_PASSWORD=Texadg123 \
      -v /data/influxdb:/var/lib/influxdb \
      influxdb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;测试数据的读写&#34;&gt;测试数据的读写&lt;/h3&gt;
&lt;p&gt;1）创建数据库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;-bash-4.2# curl -i -XPOST http://localhost:8086/query --data-urlencode &amp;#34;q=CREATE DATABASE xdb&amp;#34;
HTTP/1.1 200 OK
Content-Type: application/json
Request-Id: 338ce607-147a-11e9-8002-0242ac110008
X-Influxdb-Build: OSS
X-Influxdb-Version: 1.7.2
X-Request-Id: 338ce607-147a-11e9-8002-0242ac110008
Date: Thu, 10 Jan 2019 01:51:09 GMT
Transfer-Encoding: chunked

{&amp;#34;results&amp;#34;:[{&amp;#34;statement_id&amp;#34;:0}]}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）插入数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;-bash-4.2# curl -i -XPOST &amp;#39;http://localhost:8086/write?db=xdb&amp;#39; --data-binary &amp;#39;cpu_load_short,host=server01,region=us-west value=0.64 1434055562000000000&amp;#39;
HTTP/1.1 204 No Content
Content-Type: application/json
Request-Id: 6f10117d-147a-11e9-8003-0242ac110008
X-Influxdb-Build: OSS
X-Influxdb-Version: 1.7.2
X-Request-Id: 6f10117d-147a-11e9-8003-0242ac110008
Date: Thu, 10 Jan 2019 01:52:49 GMT
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）查询数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;-bash-4.2# curl -G &amp;#39;http://localhost:8086/query?pretty=true&amp;#39; --data-urlencode &amp;#34;db=xdb&amp;#34; --data-urlencode &amp;#34;q=SELECT \&amp;#34;value\&amp;#34; FROM \&amp;#34;cpu_load_short\&amp;#34; WHERE \&amp;#34;region\&amp;#34;=&amp;#39;us-west&amp;#39;&amp;#34;
{
    &amp;#34;results&amp;#34;: [
        {
            &amp;#34;statement_id&amp;#34;: 0,
            &amp;#34;series&amp;#34;: [
                {
                    &amp;#34;name&amp;#34;: &amp;#34;cpu_load_short&amp;#34;,
                    &amp;#34;columns&amp;#34;: [
                        &amp;#34;time&amp;#34;,
                        &amp;#34;value&amp;#34;
                    ],
                    &amp;#34;values&amp;#34;: [
                        [
                            &amp;#34;2015-06-11T20:46:02Z&amp;#34;,
                            0.64
                        ]
                    ]
                }
            ]
        }
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;参考资料&#34;&gt;参考资料&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://hub.docker.com/_/influxdb/?tab=description&#34;&gt;https://hub.docker.com/_/influxdb/?tab=description&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.influxdata.com/influxdb/v1.7/guides/writing_data/&#34;&gt;https://docs.influxdata.com/influxdb/v1.7/guides/writing_data/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.influxdata.com/influxdb/v1.7/guides/querying_data/&#34;&gt;https://docs.influxdata.com/influxdb/v1.7/guides/querying_data/&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/influxdb/">InfluxDB</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Java 常用命令介绍</title>
                <link>https://xdhuxc.github.io/posts/programming/java/java-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/java/java-command/</guid>
                <pubDate>Fri, 24 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 Java 中常用的命令。&lt;/p&gt;
&lt;h3 id=&#34;java-命令&#34;&gt;java 命令&lt;/h3&gt;
&lt;p&gt;命令行直接运行可执行的 jar 包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;java -jar jar_name.jar
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;jps-命令&#34;&gt;jps 命令&lt;/h3&gt;
&lt;p&gt;jps（Java Virtual Machine Process Status Tool）是一个显示当前所有 java 进程 pid 的命令，显示当前系统的  Java 进程情况及进程 id。&lt;/p&gt;
&lt;p&gt;常用命令：&lt;/p&gt;
&lt;p&gt;1、jps&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# jps
18785 Bootstrap
19941 Jps
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、jps -m&lt;/p&gt;
&lt;p&gt;-m：输出传递给 main 方法的参数，在嵌入式 JVM 上可能是 null。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# jps -m
18785 Bootstrap start
19965 Jps -m
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、jps -l&lt;/p&gt;
&lt;p&gt;-l：输出应用程序 main class 的完整包名或者应用程序的 jar 文件完整路径名。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# jps -l
18785 org.apache.catalina.startup.Bootstrap
19997 sun.tools.jps.Jps
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、jps -v
-v：输出传递给 JVM 的参数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# jps -v
20224 Jps -Dapplication.home=/usr/java/jdk1.8.0_171-amd64 -Xms8m
18785 Bootstrap -Djava.util.logging.config.file=/root/xdhuxc/apache-tomcat-9.0.8/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -Dcatalina.base=/root/xdhuxc/apache-tomcat-9.0.8 -Dcatalina.home=/root/xdhuxc/apache-tomcat-9.0.8 -Djava.io.tmpdir=/root/xdhuxc/apache-tomcat-9.0.8/temp
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/java/">Java</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>在 Eclipse 中部署基于 Maven 构建的 Java Web 项目</title>
                <link>https://xdhuxc.github.io/posts/programming/java/java-eclipse-maven-web/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/java/java-eclipse-maven-web/</guid>
                <pubDate>Fri, 24 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在 Eclipse 中部署基于 Maven 构建的 Java Web 项目的过程。&lt;/p&gt;
&lt;h3 id=&#34;使用-tomcat-部署-web-应用&#34;&gt;使用 Tomcat 部署 Web 应用&lt;/h3&gt;
&lt;h4 id=&#34;tomcat部分&#34;&gt;Tomcat部分&lt;/h4&gt;
&lt;p&gt;下载解压 &lt;code&gt;apache-tomcat-8.0.47&lt;/code&gt;，在Eclipse中添加 Tomcat 服务器（&lt;code&gt;Window&lt;/code&gt;-&amp;gt;&lt;code&gt;Preferences&lt;/code&gt;-&amp;gt;&lt;code&gt;Server&lt;/code&gt;-&amp;gt;&lt;code&gt;Runtime Environments&lt;/code&gt;-&amp;gt;&lt;code&gt;Add&lt;/code&gt;-&amp;gt;&lt;code&gt;Apache&lt;/code&gt;-&amp;gt;&lt;code&gt;Apache Tomcat v8.0&lt;/code&gt;-&amp;gt;&lt;code&gt;Next&lt;/code&gt;-&amp;gt;&lt;code&gt;Browse&lt;/code&gt;-&amp;gt;&lt;code&gt;apache-tomcat-8.0.47所在目录&lt;/code&gt;-&amp;gt;&lt;code&gt;Finish&lt;/code&gt;）。&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;apache-tomcat-8.0.47/conf/tomcat-users.xml&lt;/code&gt;中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;role&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rolename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;admin-gui&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;role&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rolename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;admin-script&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;role&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rolename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;manager-gui&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;role&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rolename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;manager-script&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;role&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rolename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;manager-jmx&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;role&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;rolename&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;manager-status&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 用户信息
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;admin123&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;roles&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;admin-gui,admin-script,manager-gui,manager-script,manager-jmx,manager-status&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;maven部分&#34;&gt;Maven部分&lt;/h4&gt;
&lt;p&gt;下载解压 &lt;code&gt;apache-maven-3.5.2&lt;/code&gt;，在Eclipse中添加Maven（&lt;code&gt;Window&lt;/code&gt;-&amp;gt;&lt;code&gt;Preferences&lt;/code&gt;-&amp;gt;&lt;code&gt;Maven&lt;/code&gt;-&amp;gt;&lt;code&gt;Installations&lt;/code&gt;-&amp;gt;&lt;code&gt;Add&lt;/code&gt;-&amp;gt;&lt;code&gt;Directory&lt;/code&gt;-&amp;gt;&lt;code&gt;apache-maven-3.5.2所在目录&lt;/code&gt;-&amp;gt;&lt;code&gt;选中自己添加的Maven&lt;/code&gt;-&amp;gt;&lt;code&gt;Finish&lt;/code&gt;），&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;apache-maven-3.5.2/conf/settings.xml&lt;/code&gt;中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;servers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;tomcat&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;#随意起&lt;/span&gt;，没有特殊要求
      # username和password的与tomcat-users.xml中保持一致
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;admin&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;admin123&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;servers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;pom.xml&lt;/code&gt; 文件中加入如下内容：（也适用于Tomcat 8）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugins&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.apache.tomcat.maven&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;tomcat6-maven-plugin&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;2.2&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;http://localhost:8080/manager/text&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          	# server与settings.xml中的server保持一致
          	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;tomcat&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          	# username和password的与tomcat-users.xml中保持一致
          	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;admin&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;admin123&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.apache.tomcat.maven&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;tomcat7-maven-plugin&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;2.2&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;http://localhost:8080/manager/text&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;tomcat&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;admin&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;admin123&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;password&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
          &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugins&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;build&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;运行访问&#34;&gt;运行访问&lt;/h4&gt;
&lt;p&gt;在Eclipse中，右键点击项目名-&amp;gt;&lt;code&gt;Run as&lt;/code&gt;-&amp;gt;&lt;code&gt;Maven Build&lt;/code&gt;-&amp;gt; 在Goals中输入：&lt;code&gt;tomcat7:run&lt;/code&gt;，点击&lt;code&gt;Run&lt;/code&gt;启动Tomcat服务器。&lt;/p&gt;
&lt;p&gt;常用的Goal&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;tomcat:deploy&lt;/td&gt;
&lt;td&gt;部署一个web war包&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tomcat:reload&lt;/td&gt;
&lt;td&gt;重新加载web war包&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tomcat:start&lt;/td&gt;
&lt;td&gt;启动tomcat&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tomcat:stop&lt;/td&gt;
&lt;td&gt;停止tomcat&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tomcat:undeploy&lt;/td&gt;
&lt;td&gt;停止一个war包&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tomcat:run&lt;/td&gt;
&lt;td&gt;启动嵌入式tomcat ，并运行当前项目&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;使用-jetty-部署-web-应用&#34;&gt;使用 Jetty 部署 Web 应用&lt;/h3&gt;
&lt;p&gt;1、在Eclipse中安装Jetty插件&lt;/p&gt;
&lt;p&gt;打开 Eclipse，&lt;code&gt;Help&lt;/code&gt;-&amp;gt;&lt;code&gt;Install New Software...&lt;/code&gt;-&amp;gt;在&lt;code&gt;Work with&lt;/code&gt;后的输入框中输入&lt;code&gt;http://eclipse-jetty.github.io/update/&lt;/code&gt;-&amp;gt;遇Next则Next，遇Accept则Accept-&amp;gt;重启Eclipse&lt;/p&gt;
&lt;p&gt;2、在pom.xml中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;#定义变量&lt;/span&gt;，常用于定义框架、jar包等的版本号和项目相关的名称
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;javaVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;javaVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;springVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;5.0.1.RELEASE&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;springVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;jettyVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;9.4.7.v20170914&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;jettyVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.eclipse.jetty&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;jetty-maven-plugin&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;${jettyVersion}&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scanIntervalSeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;10&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scanIntervalSeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;webApp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	      &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;contextPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;/demonstrate&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;contextPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;webApp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;httpConnector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;8090&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;#项目发布的端口号&lt;/span&gt;，访问时即访问该端口
        &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;httpConnector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动项目&lt;/p&gt;
&lt;p&gt;在Eclipse中，右键点击项目名-&amp;gt;&lt;code&gt;Run as&lt;/code&gt;-&amp;gt;&lt;code&gt;Maven Build&lt;/code&gt;-&amp;gt;在&lt;code&gt;Goals&lt;/code&gt;中输入&lt;code&gt;jetty:run&lt;/code&gt;-&amp;gt;&lt;code&gt;Run&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;4、访问项目&lt;/p&gt;
&lt;p&gt;在浏览器中，输入&lt;code&gt;http://localhost:8090/demonstrate&lt;/code&gt;，回车后可访问首页。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/java/">Java</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/maven/">Maven</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Kubernetes 中使用 Ingress 时的访问链路</title>
                <link>https://xdhuxc.github.io/posts/kubernetes/kubernetes-ingress-access/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/kubernetes/kubernetes-ingress-access/</guid>
                <pubDate>Fri, 17 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在使用 Kubernetes 的 Ingress 时，应用的访问链路，这可以为应用访问不通时排查问题提供帮助。&lt;/p&gt;
&lt;h3 id=&#34;部署应用及-ingress&#34;&gt;部署应用及 Ingress&lt;/h3&gt;
&lt;p&gt;使用如下所示的 YAML 文件部署 nginx 及其 Service 和 Ingress&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kind: Deployment
apiVersion: extensions/v1beta1
metadata:
  name: nginx
  labels:
    app: nginx
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
        version: v1
    spec:
      containers:
      &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: nginx
        image: nginx:latest
        imagePullPolicy: IfNotPresent
        ports:
        &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; containerPort: 80
          protocol: TCP
        livenessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 30
          timeoutSeconds: 30
        readinessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 30
          timeoutSeconds: 30

---
kind: Service
apiVersion: v1
metadata:
  name: nginx
  labels:
    app: nginx
spec:
  ports:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; port: 80
    targetPort: 80
    name: http
  selector:
    app: nginx

---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: nginx
  annotations:
    ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; http:
      paths:
      &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; path: /
        backend:
          serviceName: nginx
          servicePort: 80
    host: xdhuxc.com
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;访问测试&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -Lv --resolve xdhuxc.com:80:${ingress-node-ip} xdhuxc.com
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -Lv --resolve xdhuxc.com:80:172.31.40.84 xdhuxc.com
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;访问链路&#34;&gt;访问链路&lt;/h3&gt;
&lt;p&gt;域名           主机                    ingress         service         pod/容器&lt;br&gt;
xdhuxc.com -&amp;gt; 172.20.26.150:80 -&amp;gt; ingress-controller -&amp;gt; [service] -&amp;gt; 192.168.235.231:80&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/cj2580/article/details/80017904#comments&#34;&gt;https://blog.csdn.net/cj2580/article/details/80017904#comments&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/kubernetes/">Kubernetes</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 中 Shell 脚本执行的三种方式</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-shell-execute/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-shell-execute/</guid>
                <pubDate>Mon, 13 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;在 Linux 系统中，Shell 脚本的执行其实还有几种不同的方式，知道这些不同的执行方式对于我们学习脚本和编写脚本很有帮助。&lt;/p&gt;
&lt;p&gt;在 Linux 系统中，Shell 脚本的执行方式通常有如下三种：&lt;/p&gt;
&lt;h4 id=&#34;通过解释器-bash-或-sh-执行&#34;&gt;通过解释器 &lt;code&gt;bash&lt;/code&gt; 或 &lt;code&gt;sh&lt;/code&gt; 执行&lt;/h4&gt;
&lt;p&gt;通过解释器时的命令格式为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;bash shell-script-name  # 通过 bash 解释器来执行 shell 脚本。
或
sh shell-script-name    # 通过 sh 解释器来执行 shell 脚本。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当脚本文件本身没有可执行权限（即文件权限属性 &lt;code&gt;x&lt;/code&gt; 位为：“-”）时经常使用的方式；或者脚本文件开头没有指定解释器时，需要使用这种方法。使用起来比较方便，操作时节省了为文件添加执行权限的步骤。当然，也可以选择其他类型的解释器，比如ksh，csh，zsh等。&lt;/p&gt;
&lt;p&gt;（1）创建文件abc.sh&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# touch abc.sh
[root@xdhuxc ~]# ls
abc.sh
[root@xdhuxc ~]#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（2）写入要执行的命令：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# cat &amp;gt;&amp;gt; abc.sh &amp;lt;&amp;lt; EOF           # 向 abc.sh 中追加内容。
&amp;gt; #!/usr/bin/env bash
&amp;gt; echo &amp;quot;Hello Shell.&amp;quot;
&amp;gt; EOF
[root@xdhuxc ~]# cat abc.sh                     # 显示 abc.sh 文件中的内容。
#!/usr/bin/env bash
echo &amp;quot;Hello Shell.&amp;quot;
[root@xdhuxc ~]# ll
total 8
-rw-r--r-- 1 root root  40 Jun  3 10:12 abc.sh  # abc.sh 没有可执行权限。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（3）执行该脚本&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# bash abc.sh
Hello Shell.
[root@xdhuxc ~]# sh abc.sh
Hello Shell.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看出，命令已经成功执行。&lt;/p&gt;
&lt;h4 id=&#34;指定路径执行&#34;&gt;指定路径执行&lt;/h4&gt;
&lt;p&gt;指定路径执行 shell 脚本时的命令格式如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;absolute-path/shell-script-name  # 通过指定绝对路径来执行 shell 脚本。
或
./shell-script-name              # 通过指定相对路径来执行 shell 脚本，根据当前路径指定要执行的脚本的路径。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在当前路径下执行脚本，需要脚本有执行权限，将脚本文件的的权限改为可执行（即文件权限属性 &lt;code&gt;x&lt;/code&gt; 位为：“x”），使用的命令为：&lt;code&gt;chmod +x shell-script-name&lt;/code&gt;，然后就可以通过绝对路径或者相对路径来执行脚本了。&lt;/p&gt;
&lt;p&gt;（1）给 &lt;code&gt;abc.sh&lt;/code&gt; 添加执行权限&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# chmod +x abc.sh                # 为 abc.sh 添加执行权限。
[root@xdhuxc ~]# ll
total 8
-rwxr-xr-x 1 root root  40 Jun  3 10:12 abc.sh  # abc.sh 已经有了可执行权限。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（2）以绝对路径方式执行 abc.sh&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# pwd
/root
[root@xdhuxc ~]# ls
abc.sh
[root@xdhuxc ~]# /root/abc.sh
Hello Shell.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（3）以相对路径方式执行 abc.sh&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ls
abc.sh
[root@xdhuxc ~]# ./abc.sh
Hello Shell.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看出，两种方式都能正确执行脚本。在实际脚本的编写过程中，一般都是使用相对路径来执行脚本，这样写成的脚本作为一个整体的程序，可以复制到其他目录或者机器上直接运行，而不必担心脚本内部调用的路径问题。因此，一般要先给脚本添加执行权限，然后使用相对路径的方式来执行。&lt;/p&gt;
&lt;h4 id=&#34;source-或者--执行脚本&#34;&gt;source 或者 &amp;quot;.&amp;quot; 执行脚本&lt;/h4&gt;
&lt;p&gt;source 或者 &amp;quot;.&amp;quot; 执行 shell 脚本时的命令格式为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;source shell-script-name
或
. shell-script-name
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;source 或者 “.” 命令的功能是：读入shell脚本并执行脚本，即在当前 shell 中执行 source 或 “.”加载并执行相关脚本文件中的命令及语句。&lt;/p&gt;
&lt;p&gt;（1）使用 source 和 “.” 命令执行 abc.sh&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ls
abc.sh
[root@xdhuxc ~]# . abc.sh            # 以 “.” 命令方式执行 abc.sh。
Hello Shell.
[root@xdhuxc ~]# source abc.sh       # 以 source 方式执行 abc.sh。
Hello Shell.
[root@xdhuxc ~]#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这种方式是在当前 shell 中加载并执行脚本中的命令及语句，而不是产生一个子 shell 来执行脚本文件中的命令，这是与其他几种方式最大的不同。因此，在脚本中定义的变量，在终端中可以直接使用。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ls
abc.sh
[root@xdhuxc ~]# echo &amp;quot;password=123&amp;quot; &amp;gt;&amp;gt; abc.sh  # 向 abc.sh 中追加字符串 password=123。
[root@xdhuxc ~]# cat abc.sh                     # 查看 abc.sh 文件的内容。
#!/usr/bin/env bash
echo &amp;quot;Hello Shell.&amp;quot;
password=123
[root@xdhuxc ~]# source abc.sh                  # 以 source 方式执行 abc.sh。
Hello Shell.
[root@xdhuxc ~]# echo ${password}               # 在终端输出 abc.sh 中定义的变量。
123
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;前两种方式是产生了一个子进程 shell 来执行脚本，因此，脚本中的变量在终端中是获取不到的，因为终端中的操作还在父 shell 中。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# echo &amp;quot;username=root&amp;quot; &amp;gt;&amp;gt; abc.sh
[root@xdhuxc ~]# ./abc.sh
Hello Shell.
[root@xdhuxc ~]# echo ${username}

[root@xdhuxc ~]#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看到，获取不到 username 的值，因为以相对路径执行脚本是在子 shell 进程中的，而获取  username 值的命令是在父 shell 中执行的。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/shell/">Shell</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>MySQL 常用操作</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-common-operations/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-common-operations/</guid>
                <pubDate>Thu, 09 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了一些使用 MySQL 时经常会用到的操作，留作后查。&lt;/p&gt;
&lt;h3 id=&#34;赋权操作&#34;&gt;赋权操作&lt;/h3&gt;
&lt;p&gt;1、创建只读账户&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; grant select on &lt;span class=&#34;ge&#34;&gt;*.*&lt;/span&gt; to &amp;#39;xdhuxc&amp;#39;@&amp;#39;%&amp;#39; identified by &amp;#39;Xdhuxc163&amp;#39;;  # 创建只读账户xdhuxc，密码为：Xdhuxc63
mysql&amp;gt; flush privileges;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看其权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show grants for &amp;#39;xdhuxc&amp;#39;@&amp;#39;%&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、授予权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;grant select, insert, update, delete on user.* to &amp;#39;xdhuxc&amp;#39;@&amp;#39;%&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、授予所有权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;GRANT ALL PRIVILEGES ON &lt;span class=&#34;ge&#34;&gt;*.*&lt;/span&gt; TO &amp;#39;root&amp;#39;@&amp;#39;*&amp;#39; IDENTIFIED BY &amp;#39;Xdhuxc123&amp;#39; WITH GRANT OPTION;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;通过此命令也可以修改 MySQL 用户的密码&lt;/p&gt;
&lt;p&gt;4、创建用户再授权&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;create user &amp;#39;sonarqube&amp;#39; identified by &amp;#39;Shareit@2020&amp;#39;;

grant select, insert, update, delete on sonarqube.* to &amp;#39;sonarqube&amp;#39;@&amp;#39;%&amp;#39;;

show grants for &amp;#39;sonarqube&amp;#39;@&amp;#39;%&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;忘记密码修改密码&#34;&gt;忘记密码修改密码&lt;/h3&gt;
&lt;h4 id=&#34;linux-系统&#34;&gt;Linux 系统&lt;/h4&gt;
&lt;p&gt;1、停止数据库服务。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl stop mysqld
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、向 /etc/my.cnf 中添加如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[mysqld]
skip-grant-tables
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、重启 mysql 服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart mysqld
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、修改密码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; use mysql;
mysql&amp;gt; update user set authentication_string=password(&amp;#39;Xdhuxc163&amp;#39;) where user=&amp;#39;root&amp;#39;;
mysql&amp;gt; flush privileges;
mysql&amp;gt; quit
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、注释掉 skip-grant-tables，重启 mysqld 服务。&lt;/p&gt;
&lt;h4 id=&#34;windows-系统&#34;&gt;Windows 系统&lt;/h4&gt;
&lt;p&gt;1、关闭 MySQL 服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;net stop mysql57
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、进入 MySQL 的 bin 目录下，执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysqld --default-file=&amp;#34;E:\Work\MySQL\MySQL Server 5.7 Data\my.ini&amp;#34; --console --skip-grant-tables
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;--default-file：启动 MySQL 服务时的配置文件；&lt;/li&gt;
&lt;li&gt;--skip-grant-tables：启动 MySQL 服务的时候跳过权限表认证；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;3、新打开 DOS 窗口，进入 MySQL 的 bin 目录下，执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql -uroot -p # 回车后，让输入密码，直接回车
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、更改root用户密码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# MySQL 5.7以前
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;update mysql.user
set password=password(&amp;#39;123456&amp;#39;)
 where user=&amp;#39;root&amp;#39;;
&lt;span class=&#34;gh&#34;&gt;# MySQL 5.7
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;update mysql.user
set authentication_string=password(&amp;#39;123456&amp;#39;)
 where user=&amp;#39;root&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、更新权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;flush privileges;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、退出当前MySQL回话并启动MySQL服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;net start mysql57
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;修改默认时区&#34;&gt;修改默认时区&lt;/h3&gt;
&lt;h4 id=&#34;方法一&#34;&gt;方法一&lt;/h4&gt;
&lt;p&gt;1、查看 mysql 系统时间&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; show variables like &amp;#39;%time_zone%&amp;#39;;
+------------------+--------+
| Variable_name    | Value  |
+------------------+--------+
| system_time_zone | UTC    |
| time_zone        | +08:00 |
+------------------+--------+
2 rows in set

mysql&amp;gt; select now();
+---------------------+
| now()               |
+---------------------+
| 2018-07-09 13:59:16 |
+---------------------+
1 row in set
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;mysql 的系统时区已经是东八区，系统时间也是当前时间了，&lt;/p&gt;
&lt;p&gt;2、设置时区为东八区&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;set global time_zone = &amp;#39;+8:00&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、刷新权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;flush privileges;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;方法二&#34;&gt;方法二&lt;/h4&gt;
&lt;p&gt;或者直接在 my.cnf 文件中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[mysqld]
default-time_zone = &amp;#39;+8:00&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后重启 mysql 服务&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 常用基础知识</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-basic-knowledge/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-basic-knowledge/</guid>
                <pubDate>Wed, 08 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍些 Python 常用的基础知识。&lt;/p&gt;
&lt;h3 id=&#34;生成器和迭代器&#34;&gt;生成器和迭代器&lt;/h3&gt;
&lt;h4 id=&#34;生成器&#34;&gt;生成器&lt;/h4&gt;
&lt;p&gt;带有yield关键字的函数在python中被称为generator（生成器）。python解释器会将带有yield关键字的函数视为一个生成器来处理。一个函数或者子程序都只能return一次，但是一个生成器能暂停执行并返回一个中间的结果，这是yield语句的功能：返回一个中间值给调用者并暂停执行。&lt;/p&gt;
&lt;h4 id=&#34;优点&#34;&gt;优点&lt;/h4&gt;
&lt;p&gt;生成器的一个优点是它不要求事先准备好整个迭代过程中所有的元素，即无须将对象的所有元素都存入内存之后，才开始进行操作。生成器仅在迭代至某个元素时才会将该元素放入内存，而在这之前或之后，元素可以不存在或者被销毁。这个特点使得它特别适合用于遍历一些巨大的或者无限的类序列对象，例如大文件、大集合、大字典或者斐波那契数列等。这个特点被称为延迟计算或者惰性求值，可以有效地节省内存。惰性求值实际上是实现了协同程序的思想。&lt;/p&gt;
&lt;p&gt;协同程序：是一个可以独立运行的函数调用，该调用可以被暂停或者挂起，之后还能够从程序流挂起的地方继续或重新开始。当协同程序被挂起时，Python就能够从该协同程序中获取一个处于中间状态的属性的返回值（由yield返回），当调用next()方法使得程序流回到协同程序中时，能够为其传入额外的或者是被改变了的参数，并且从上次挂起的下一条语句继续执行。这是一种类似于进程中断的函数调用方式。&lt;/p&gt;
&lt;p&gt;这种挂起函数调用并在返回属性中间值后，仍然能够多次继续执行的协同程序被称之为生成器。&lt;/p&gt;
&lt;p&gt;使用场景：当需要以迭代的方式去处理一个巨大的数据集合，比如一个巨大的文件或者一个复杂的数据库查询时，就需要使用生成器。&lt;/p&gt;
&lt;h3 id=&#34;迭代器&#34;&gt;迭代器&lt;/h3&gt;
&lt;p&gt;任何实现了__iter__()和__next__()（python 2中实现next()）方法的对象都是迭代器，__iter__返回迭代器本身，__next__返回容器中的下一个值，如果容器中没有更多元素了，则抛出StopIteration异常。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;容器是一系列元素的集合，string、list、set、dict、file、socket对象都可以看做容器，容器都可以被迭代（用在for、while等语句中），因此他们被称为可迭代对象。&lt;/li&gt;
&lt;li&gt;可迭代对象实现了__iter__()方法，该方法返回一个迭代器对象。&lt;/li&gt;
&lt;li&gt;迭代器持有一个内部状态的字段，用于记录下次迭代返回值，实现了__next__()和__iter__()方法，迭代器不会一次性把所有元素加载到内存，而是需要的时候才生成返回结果。&lt;/li&gt;
&lt;li&gt;生成器是一种特殊的迭代器，它的返回值不是通过return，而是用yield。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;容器是一种把多个元素组织在一起的数据结构，容器中的元素可以逐个地迭代获取，可以用in, not in关键字判断元素是否包含在容器中。通常这类数据结构把所有的元素存储在内存中（也有一些特例，并不是所有的元素都放在内存，比如迭代器和生成器对象）。&lt;/p&gt;
&lt;p&gt;凡是可以返回一个迭代器的对象都可称之为可迭代对象，&lt;/p&gt;
&lt;h3 id=&#34;下划线问题&#34;&gt;下划线问题&lt;/h3&gt;
&lt;h4 id=&#34;单下划线开头&#34;&gt;单下划线开头&lt;/h4&gt;
&lt;p&gt;Python 中没有真正的私有属性或方法，可以在声明为私有的方法和属性前加上单下划线，以提示该属性和方法不应在外部调用。如果真的调用了，也不会出错，但不符合规范。&lt;/p&gt;
&lt;p&gt;带有单下划线的特性不会被 from module_name import *导入。&lt;/p&gt;
&lt;h4 id=&#34;双下划线开头&#34;&gt;双下划线开头&lt;/h4&gt;
&lt;p&gt;双下划线开头，是为了不让子类重写该属性方法，通过类的实例化时自动转换，在类中的双下划线开头的属性方法前加上 _类名 实现&lt;/p&gt;
&lt;h4 id=&#34;双下划线开头和双下划线结尾&#34;&gt;双下划线开头和双下划线结尾&lt;/h4&gt;
&lt;p&gt;此种写法为 python内建属性方法，最好不要在外部调用。&lt;/p&gt;
&lt;p&gt;以单下划线开头 _foo 的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用 from xxx import * 而导入；&lt;/p&gt;
&lt;p&gt;以双下划线开头的 __foo 代表类的私有成员；&lt;/p&gt;
&lt;p&gt;以双下划线开头和结尾的 &lt;strong&gt;foo&lt;/strong&gt; 代表 Python 里特殊方法专用的标识，如 &lt;strong&gt;init&lt;/strong&gt;() 代表类的构造函数。&lt;/p&gt;
&lt;h3 id=&#34;args-与-kwargs&#34;&gt;&lt;code&gt;*args&lt;/code&gt; 与 &lt;code&gt;**kwargs&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;*args&lt;/code&gt; 表示非键值对的不确定个数的变量列表，其中args可以换成别的合法变量名，比如*vars，但是那个 * 是必须的。&lt;/p&gt;
&lt;p&gt;**kwargs 表示带键值对的不确定个数的参数列表，同样，kwargs也可以换成别的合法变量名。&lt;/p&gt;
&lt;p&gt;当不知道函数中传递参数的个数时，就可以使用这两个参数。&lt;/p&gt;
&lt;h3 id=&#34;对象销毁垃圾回收&#34;&gt;对象销毁(垃圾回收)&lt;/h3&gt;
&lt;p&gt;Python 使用了引用计数这一简单技术来跟踪和回收垃圾。 在 Python 内部记录着所有使用中的对象各有多少引用。 一个内部跟踪变量，称为一个引用计数器。 当对象被创建时， 就创建了一个引用计数， 当这个对象不再需要时， 也就是说， 这个对象的引用计数变为0 时， 它被垃圾回收。但是回收不是&amp;quot;立即&amp;quot;的， 由解释器在适当的时机，将垃圾对象占用的内存空间回收。&lt;/p&gt;
&lt;p&gt;垃圾回收机制不仅针对引用计数为0的对象，同样也可以处理循环引用的情况。循环引用指的是，两个对象相互引用，但是没有其他变量引用他们。这种情况下，仅使用引用计数是不够的。Python 的垃圾收集器实际上是一个引用计数器和一个循环垃圾收集器。作为引用计数的补充， 循环垃圾收集器也会留心被分配的总量很大（及未通过引用计数销毁的那些）的对象。 在这种情况下， 解释器会暂停下来， 试图清理所有未引用的循环。&lt;/p&gt;
&lt;p&gt;析构函数 del ，__del__在对象销毁的时候被调用，当对象不再被使用时，__del__方法运行。&lt;/p&gt;
&lt;h3 id=&#34;is-与--的区别&#34;&gt;is 与 == 的区别&lt;/h3&gt;
&lt;p&gt;Python 中的对象包含三个要素：id，type，value
其中，id 用来唯一标识一个对象，type标识对象的类型，value是对象的值。&lt;/p&gt;
&lt;p&gt;is 判断的是 a 对象是否就是 b 对象，是通过 id 来判断的。&lt;/p&gt;
&lt;p&gt;== 判断的是 a 对象的值是否和 b 对象的值相等，是通过 value 来判断的。&lt;/p&gt;
&lt;h3 id=&#34;with-的一般执行过程&#34;&gt;with 的一般执行过程&lt;/h3&gt;
&lt;p&gt;一段基本的 with 表达式，其结构是这样的：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;with expression as variable:
    code_block
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中，expression可以是任意表达式，as variable 是可选的，其一般的执行过程是这样的：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;计算 expression，并获取一个上下文管理器。&lt;/li&gt;
&lt;li&gt;上下文管理器的__exit()__方法被保存起来用于之后的调用。&lt;/li&gt;
&lt;li&gt;调用上下文管理器的__enter()__方法。&lt;/li&gt;
&lt;li&gt;如果 with 表达式包含 as variable，那么 expression 的返回值被赋值给 variable。&lt;/li&gt;
&lt;li&gt;执行 code_block 中的表达式。&lt;/li&gt;
&lt;li&gt;调用上下文管理器的__exit()__方法。如果code block的执行过程中发生了一个异常导致程序退出，那么异常的type、value和traceback（即sys.exc_info()的返回值）将作为参数传递给__exit()__方法，否则，将传递三个None。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注意：&lt;/p&gt;
&lt;p&gt;如果上下文管理器中没有 &lt;strong&gt;enter()&lt;/strong&gt; 或者 &lt;strong&gt;exit()&lt;/strong&gt; 中的任意一个方法，那么解释器会抛出一个 AttributeError 。&lt;/p&gt;
&lt;p&gt;在 code_block 中发生异常后，如果 &lt;strong&gt;exit()&lt;/strong&gt; 方法返回一个可被看成是 True 的值，那么这个异常就不会被抛出，后面的代码会继续执行。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>RabbitMQ 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-questions-and-solutions/</guid>
                <pubDate>Mon, 06 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了使用 RabbitMQ 的过程中常见的问题及解决方法。&lt;/p&gt;
&lt;p&gt;1、在虚拟机中启动 &lt;code&gt;rabbitmq&lt;/code&gt; 及管理插件后，使用 &lt;code&gt;guest/guest&lt;/code&gt; 在浏览器中访问时，页面报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;User can only log in via localhost 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;进入 &lt;code&gt;/var/log/rabbitmq&lt;/code&gt; 中查看日志，日志中含有如下信息：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;2018-05-08 07:59:19.561 [warning] &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;0.681.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; HTTP access denied: user &amp;#39;guest&amp;#39; - User can only log in via localhost
2018-05-08 07:59:27.904 [warning] &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;0.684.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; HTTP access denied: user &amp;#39;guest&amp;#39; - User can only log in via localhost
2018-05-08 08:00:11.502 [warning] &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;0.709.0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; HTTP access denied: user &amp;#39;guest&amp;#39; - User can only log in via localhost
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rabbitmq从3.3.0&lt;/code&gt; 开始禁止使用 &lt;code&gt;guest/guest&lt;/code&gt; 权限通过除 &lt;code&gt;localhost&lt;/code&gt; 外的访问。如果想使用 &lt;code&gt;guest/guest&lt;/code&gt; 通过远程机器访问，&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;/etc/rabbitmq&lt;/code&gt; 目录下创建 &lt;code&gt;rabbitmq.conf &lt;/code&gt;文件，添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;loopback_users = none # 表示允许默认用户 guest 在远程连接 rabbitmq-server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在 &lt;code&gt;VMware workstation&lt;/code&gt; 中创建虚拟机，使用 &lt;code&gt;rpm&lt;/code&gt; 包方式安装 &lt;code&gt;erlang&lt;/code&gt; 和 &lt;code&gt;rabbitmq-server&lt;/code&gt; ，在浏览器中使用net网卡IP地址访问时，只出现了部分界面，&lt;/p&gt;
&lt;p&gt;没有显示全正常 &lt;code&gt;rabbitmq&lt;/code&gt; 管理界面；同时，使用 &lt;code&gt;java&lt;/code&gt; 编写的连接程序总是报错。&lt;/p&gt;
&lt;p&gt;解决：关闭 &lt;code&gt;windows&lt;/code&gt; 防火墙，使用桥接网卡的 &lt;code&gt;IP&lt;/code&gt; 地址访问 &lt;code&gt;rabbitmq&lt;/code&gt; 管理页面，显示正常。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/rabbitmq/">RabbitMQ</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 docker 容器方式部署 RabbitMQ</title>
                <link>https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-docker-deployment/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-docker-deployment/</guid>
                <pubDate>Mon, 06 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了使用 docker 容器方式部署 RabbitMQ 的方法。&lt;/p&gt;
&lt;h3 id=&#34;使用-docker-容器方式部署-rabbitmq&#34;&gt;使用 docker 容器方式部署 RabbitMQ&lt;/h3&gt;
&lt;p&gt;1、拉取 rabbitmq 镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull rabbitmq:3.7.0
或
docker pull rabbitmq:3.7.0-management # 附带管理界面
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动 rabbitmq 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -p 4369:4369 \
    -p 5671:5671 \
    -p 5672:5672 \
    -p 25672:25672 \
    --net host \
    --name rabbitmq \
    -v /home/xdhuxc/rabbitmq/data:/var/lib/rabbitmq \
    rabbitmq:3.7.0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或 启动附带管理界面的 RabbitMQ 容器，修改默认的用户名和密码（guest/guest）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -p 4369:4369 \
    -p 5671:5671 \
    -p 5672:5672 \
    -p 15672:15672 \
    -p 25672:25672 \
    --net host \
    --name rabbitmq \
    -e RABBITMQ_DEFAULT_USER=xdhuxc \
    -e RABBITMQ_DEFAULT_PASS=123456 \
    -v /home/xdhuxc/rabbitmq/data:/var/lib/rabbitmq \
    rabbitmq:3.7.0-management
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --net host \
    --name rabbitmq \
    -e RABBITMQ_DEFAULT_USER=xdhuxc \
    -e RABBITMQ_DEFAULT_PASS=123456 \
    -v /home/xdhuxc/rabbitmq/data:/var/lib/rabbitmq \
    rabbitmq:3.7.4-management
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;使用-java-访问-rabbitmq&#34;&gt;使用 Java 访问 RabbitMQ&lt;/h3&gt;
&lt;p&gt;测试代码如下：&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;pom.xml&lt;/code&gt; 中添加如下依赖：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependencies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- https://mvnrepository.com/artifact/com.rabbitmq/amqp-client --&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;com.rabbitmq&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;amqp-client&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;5.2.0&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;c&#34;&gt;&amp;lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-log4j12 --&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;groupId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;slf4j-log4j12&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;artifactId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;1.7.25&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;test&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;scope&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependency&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dependencies&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;生产者代码示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package com.xdhuxc.cloud.app;

import java.io.IOException;
import java.util.concurrent.TimeoutException;

import com.rabbitmq.client.Channel;
import com.rabbitmq.client.Connection;
import com.rabbitmq.client.ConnectionFactory;

public class Producer {
	
	private final static String QUEUE_NAME = &amp;#34;xdhuxc&amp;#34;;

	/**
	 &lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@param&lt;/span&gt; args
	 */
	public static void main(String[] args) {
		
		ConnectionFactory factory = new ConnectionFactory();
		factory.setHost(&amp;#34;192.168.91.128&amp;#34;);
		factory.setPort(5672);
		factory.setUsername(&amp;#34;guest&amp;#34;);
		factory.setPassword(&amp;#34;guest&amp;#34;);
		factory.setConnectionTimeout(50000);
		factory.setRequestedHeartbeat(60);
		factory.setVirtualHost(&amp;#34;/&amp;#34;);
		Connection conn = null;
		Channel channel = null;
		
		try {
			conn = factory.newConnection();
			channel = conn.createChannel();
			channel.queueDeclare(QUEUE_NAME, false, false, false, null);
			String message = &amp;#34;Hello World!&amp;#34;;
			channel.basicPublish(&amp;#34;&amp;#34;, QUEUE_NAME, null, message.getBytes());
			System.out.println(&amp;#34;Sent &amp;#34; + message);
		} catch (IOException | TimeoutException e) {
			e.printStackTrace();
		} finally {
			try {
				if (conn != null) {
					conn.close();
				}
				if (channel != null) {
					channel.close();
				}
			} catch (IOException | TimeoutException e) {
				e.printStackTrace();
			}
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;消费者示例代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;package com.xdhuxc.cloud.app;

import java.io.IOException;
import java.util.concurrent.TimeoutException;

import com.rabbitmq.client.Channel;
import com.rabbitmq.client.Connection;
import com.rabbitmq.client.ConnectionFactory;
import com.rabbitmq.client.Consumer;
import com.rabbitmq.client.DefaultConsumer;
import com.rabbitmq.client.Envelope;
import com.rabbitmq.client.AMQP.BasicProperties;

public class Receiver {

	private final static String QUEUE_NAME = &amp;#34;xdhuxc&amp;#34;;
	
	/**
	 &lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;ni&#34;&gt;@param&lt;/span&gt; args
	 */
	public static void main(String[] args) {
		ConnectionFactory factory = new ConnectionFactory();
		factory.setHost(&amp;#34;192.168.91.128&amp;#34;);
		factory.setPort(5672);
		factory.setUsername(&amp;#34;guest&amp;#34;);
		factory.setPassword(&amp;#34;guest&amp;#34;);
		Connection conn = null;
		Channel channel = null;
		try {
			conn = factory.newConnection();
			channel = conn.createChannel();
			channel.queueDeclare(QUEUE_NAME, false, false, false, null);
			System.out.println(&amp;#34;正在等待接收消息！&amp;#34;);
			Consumer consumenr = new DefaultConsumer(channel) {
				&lt;span class=&#34;ni&#34;&gt;@Override&lt;/span&gt;
				public void handleDelivery(String consumerTag, Envelope envelope, BasicProperties properties,
						byte[] body) throws IOException {
					String message = new String(body, &amp;#34;UTF-8&amp;#34;);
					System.out.println(&amp;#34;Received &amp;#34; + message);
				}
			};
			channel.basicConsume(QUEUE_NAME, true, consumenr);
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (TimeoutException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} finally {
			try {
				if (conn != null) {
					conn.close();
				}
				if (channel != null) {
					channel.close();
				}
			} catch (IOException | TimeoutException e) {
				e.printStackTrace();
			}
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;相关问题&#34;&gt;相关问题&lt;/h3&gt;
&lt;p&gt;1、启动 &lt;code&gt;rabbitmq&lt;/code&gt; 容器时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Error: Failed to initialize erlang distribution: 
{
	{
		shutdown,
		{
			failed_to_start_child,
			net_kernel,
			{
				&amp;#39;EXIT&amp;#39;,
				nodistribution
			}
		}
	},
    {
		child,
		undefined,
		net_sup_dynamic,
		{	
			erl_distribution,
			start_link,
			[
				[&amp;#39;rabbitmq-cli-24&amp;#39;,shortnames],
				false
			]
		},
		permanent,
		1000,
		supervisor,
		[erl_distribution]
	}
}
epmd_close
Protocol &amp;#39;inet_tcp&amp;#39;: register/listen error:
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：安装 &lt;code&gt;iptables&lt;/code&gt; 和 &lt;code&gt;iptables.service&lt;/code&gt;，然后关闭 &lt;code&gt;iptables&lt;/code&gt;，重新启动 &lt;code&gt;rabbitmq&lt;/code&gt; 容器即可。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/rabbitmq/">RabbitMQ</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Redis 其他知识和技术</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-others/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-others/</guid>
                <pubDate>Sat, 04 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍了 Redis 的其他知识和技术，包括HyperLogLog、发布/订阅、事务等。&lt;/p&gt;
&lt;h3 id=&#34;hyperloglog&#34;&gt;HyperLogLog&lt;/h3&gt;
&lt;h4 id=&#34;hyperloglog-简介&#34;&gt;HyperLogLog 简介&lt;/h4&gt;
&lt;p&gt;Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定的，并且是很小的。&lt;/p&gt;
&lt;p&gt;在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基 数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。&lt;/p&gt;
&lt;p&gt;但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。&lt;/p&gt;
&lt;p&gt;基数的概念：&lt;/p&gt;
&lt;p&gt;比如数据集 {1, 3, 5, 7, 5, 7, 8}， 那么这个数据集的基数集为 {1, 3, 5 ,7, 8}, 基数(不重复元素的个数)为 5。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;基数估计就是在误差可接受的范围内，快速计算基数。&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;hyperloglog命令&#34;&gt;HyperLogLog命令&lt;/h4&gt;
&lt;p&gt;Redis HyperLogLog 的基本命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;pfadd key_name element_1 [element_2...]&lt;/td&gt;
&lt;td&gt;添加指定元素到 HyperLogLog 中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;pfcount key_name_1 [key_name_2...]&lt;/td&gt;
&lt;td&gt;返回给定 HyperLogLog 的基数估算值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;pfmerge destination_key source_key [source_key...]&lt;/td&gt;
&lt;td&gt;将多个 HyperLogLog 合并为一个 HyperLogLog&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;redis发布订阅&#34;&gt;Redis发布/订阅&lt;/h3&gt;
&lt;h4 id=&#34;发布订阅简介&#34;&gt;发布/订阅简介&lt;/h4&gt;
&lt;p&gt;Redis 发布/订阅（publish/subscribe）是一种消息通信模式：发送者（publish）发送消息，订阅者（subscribe）接收消息。&lt;/p&gt;
&lt;p&gt;Redis 发布/订阅（publish/subscribe）实现了消息系统，发送者(在redis术语中称为发布者)在接收者(订阅者)接收消息时发送消息。传送消息的链路称为信道。&lt;/p&gt;
&lt;p&gt;在 Redis 中，客户端可以订阅任意数量的信道。&lt;/p&gt;
&lt;h4 id=&#34;redis-发布订阅命令&#34;&gt;Redis 发布/订阅命令&lt;/h4&gt;
&lt;p&gt;Redis 发布/订阅的基本命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;psubscribe pattern_1 [pattern_2...]&lt;/td&gt;
&lt;td&gt;订阅一个或多个符合给定模式的频道&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;pubsub subcommand [argument_1 [argument_2...]]&lt;/td&gt;
&lt;td&gt;查看订阅与发布系统状态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;publish channel message&lt;/td&gt;
&lt;td&gt;将信息发送到指定的频道&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;punsubscribe [pattern_1 [pattern_2...]]&lt;/td&gt;
&lt;td&gt;退订所有给定模式的频道&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;subscribe channel_1 [channel_2...]&lt;/td&gt;
&lt;td&gt;订阅给定的一个或多个频道的信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;unsubscribe [channel_1 [channel...]]&lt;/td&gt;
&lt;td&gt;退订给定的频道&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;redis-事务&#34;&gt;Redis 事务&lt;/h3&gt;
&lt;h4 id=&#34;redis-事务简介&#34;&gt;Redis 事务简介&lt;/h4&gt;
&lt;p&gt;Redis 事务可以一次执行多个命令， 并且带有以下两个重要的保证：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。&lt;/li&gt;
&lt;li&gt;事务是一个原子操作：事务中的命令要么全部被执行，要么全部都不执行。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一个事务从开始到执行会经历以下三个阶段：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;开始事务&lt;/li&gt;
&lt;li&gt;命令入队&lt;/li&gt;
&lt;li&gt;执行事务&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一个事务先以 MULTI 开始一个事务， 然后将多个命令入队到事务中， 最后由 EXEC 命令触发事务， 一并执行事务中的所有命令。&lt;/p&gt;
&lt;h4 id=&#34;redis-事务命令&#34;&gt;Redis 事务命令&lt;/h4&gt;
&lt;p&gt;Redis 事务的基本命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;discard&lt;/td&gt;
&lt;td&gt;取消事务，放弃执行事务块内的所有命令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;exec&lt;/td&gt;
&lt;td&gt;执行所有事务块内的命令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;multi&lt;/td&gt;
&lt;td&gt;标记一个事务块的开始&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;unwatch&lt;/td&gt;
&lt;td&gt;取消 WATCH 命令对所有键的监视&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;watch key_name_1 [key_name_2]&lt;/td&gt;
&lt;td&gt;监视一个或多个键  ，如果在事务执行之前这个(或这些) 键被其他命令所改动，那么事务将被打断&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;redis-连接&#34;&gt;Redis 连接&lt;/h3&gt;
&lt;p&gt;Redis 连接命令主要用于连接 Redis 服务&lt;/p&gt;
&lt;p&gt;Redis 连接的基本命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;auth password&lt;/td&gt;
&lt;td&gt;验证密码是否正确&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;echo message&lt;/td&gt;
&lt;td&gt;打印字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;ping&lt;/td&gt;
&lt;td&gt;查看服务是否运行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;quit&lt;/td&gt;
&lt;td&gt;关闭当前连接&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;select index&lt;/td&gt;
&lt;td&gt;切换到指定的数据库&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;redis-服务器&#34;&gt;Redis 服务器&lt;/h3&gt;
&lt;p&gt;Redis 服务器命令主要用于管理 Redis 服务，获取 Redis 服务器的统计信息：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;92
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;127.0.0.1:6379&amp;gt; info
&lt;span class=&#34;gh&#34;&gt;# Server
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;redis_version:3.0.503
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:d14575c6134f877
redis_mode:standalone
os:Windows
arch_bits:64
multiplexing_api:WinSock_IOCP
process_id:7976
run_id:4ffccfe63ec3aae1b57ce8770582bd97a43651fb
tcp_port:6379
uptime_in_seconds:39
uptime_in_days:0
hz:10
lru_clock:8298611
config_file:

&lt;span class=&#34;gh&#34;&gt;# Clients
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;connected_clients:1
client_longest_output_list:0
client_biggest_input_buf:0
blocked_clients:0

&lt;span class=&#34;gh&#34;&gt;# Memory
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;used_memory:693000
used_memory_human:676.76K
used_memory_rss:655344
used_memory_peak:693000
used_memory_peak_human:676.76K
used_memory_lua:36864
mem_fragmentation_ratio:0.95
mem_allocator:jemalloc-3.6.0

&lt;span class=&#34;gh&#34;&gt;# Persistence
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;loading:0
rdb_changes_since_last_save:0
rdb_bgsave_in_progress:0
rdb_last_save_time:1501470796
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:-1
rdb_current_bgsave_time_sec:-1
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok
aof_last_write_status:ok

&lt;span class=&#34;gh&#34;&gt;# Stats
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;total_connections_received:1
total_commands_processed:0
instantaneous_ops_per_sec:0
total_net_input_bytes:14
total_net_output_bytes:0
instantaneous_input_kbps:0.00
instantaneous_output_kbps:0.00
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_keys:0
evicted_keys:0
keyspace_hits:0
keyspace_misses:0
pubsub_channels:0
pubsub_patterns:0
latest_fork_usec:0
migrate_cached_sockets:0

&lt;span class=&#34;gh&#34;&gt;# Replication
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;role:master
connected_slaves:0
master_repl_offset:0
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

&lt;span class=&#34;gh&#34;&gt;# CPU
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;used_cpu_sys:0.05
used_cpu_user:0.06
used_cpu_sys_children:0.00
used_cpu_user_children:0.00

&lt;span class=&#34;gh&#34;&gt;# Cluster
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cluster_enabled:0

&lt;span class=&#34;gh&#34;&gt;# Keyspace
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db0:keys=1,expires=0,avg_ttl=0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;redis-服务器命令&#34;&gt;Redis 服务器命令&lt;/h4&gt;
&lt;p&gt;Redis 服务器的相关命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;bgrewriteaof&lt;/td&gt;
&lt;td&gt;异步执行一个 AOF（AppendOnly File） 文件重写操作&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;bgsave&lt;/td&gt;
&lt;td&gt;在后台异步保存当前数据库的数据到磁盘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;client kill [ip:port][ID client-id]&lt;/td&gt;
&lt;td&gt;关闭客户端连接&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;client list&lt;/td&gt;
&lt;td&gt;获取连接到服务器的客户端连接列表&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;client getname&lt;/td&gt;
&lt;td&gt;获取连接的名称&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;client pause timeout&lt;/td&gt;
&lt;td&gt;在指定时间内终止运行来自客户端的命令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;client setname connection-name&lt;/td&gt;
&lt;td&gt;设置当前连接的名称&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;cluster slots&lt;/td&gt;
&lt;td&gt;获取集群节点的映射数组&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;command&lt;/td&gt;
&lt;td&gt;获取 Redis 命令详情数组&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;command count&lt;/td&gt;
&lt;td&gt;获取 Redis 命令总数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;command getkeys&lt;/td&gt;
&lt;td&gt;获取给定命令的所有键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;time&lt;/td&gt;
&lt;td&gt;返回当前服务器时间&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;command info command-name [command-name...]&lt;/td&gt;
&lt;td&gt;获取指定 Redis 命令描述的数组&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;config get parameter&lt;/td&gt;
&lt;td&gt;获取指定配置参数的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;config rewrite&lt;/td&gt;
&lt;td&gt;对启动 Redis 服务器时所指定的 redis.conf 配置文件进行改写&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;config set parameter value&lt;/td&gt;
&lt;td&gt;修改 redis 配置参数，无需重启&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;config resetstat&lt;/td&gt;
&lt;td&gt;重置 INFO 命令中的某些统计数据&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18&lt;/td&gt;
&lt;td&gt;dbsize&lt;/td&gt;
&lt;td&gt;返回当前数据库的键的数量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;19&lt;/td&gt;
&lt;td&gt;debug object key_name&lt;/td&gt;
&lt;td&gt;获取key_name的调试信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;debug segfault&lt;/td&gt;
&lt;td&gt;让 Redis 服务崩溃&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;flushall&lt;/td&gt;
&lt;td&gt;删除所有数据库的所有键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;flushdb&lt;/td&gt;
&lt;td&gt;删除当前数据库的所有键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;23&lt;/td&gt;
&lt;td&gt;info [section]&lt;/td&gt;
&lt;td&gt;获取 Redis 服务器的各种信息和统计数值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;lastsave&lt;/td&gt;
&lt;td&gt;返回最近一次 Redis 成功将数据保存到磁盘上的时间，以 UNIX 时间戳格式表示&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;td&gt;monitor&lt;/td&gt;
&lt;td&gt;实时打印出 Redis 服务器接收到的命令，调试用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;26&lt;/td&gt;
&lt;td&gt;role&lt;/td&gt;
&lt;td&gt;返回主从实例所属的角色&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;27&lt;/td&gt;
&lt;td&gt;save&lt;/td&gt;
&lt;td&gt;异步保存数据到硬盘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;shutdown [nosave][save]&lt;/td&gt;
&lt;td&gt;异步保存数据到硬盘，并关闭服务器&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;29&lt;/td&gt;
&lt;td&gt;slaveof hostname port&lt;/td&gt;
&lt;td&gt;将当前服务器转变为指定服务器的从属服务器(slave server)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;slowlog subcommand [argument]&lt;/td&gt;
&lt;td&gt;管理 redis 的慢日志&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;sync&lt;/td&gt;
&lt;td&gt;用于复制功能(replication)的内部命令&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Redis 安装和配置详解</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-install-and-configuration/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-install-and-configuration/</guid>
                <pubDate>Sat, 04 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍了 Redis 的安装和配置参数的详细含义。&lt;/p&gt;
&lt;h3 id=&#34;在-linux-中安装-redis&#34;&gt;在 Linux 中安装 Redis&lt;/h3&gt;
&lt;p&gt;1、使用如下命令下载并解压Redis安装包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ wget http://download.redis.io/releases/redis-4.0.1.tar.gz
$ tar -zxf redis-4.0.1.tar.gz
$ cd redis-4.0.1
$ make
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 make 时，出现如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost redis-4.0.1]# make
cd src &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; make all
make[1]: Entering directory &lt;span class=&#34;sb&#34;&gt;`/home/application/redis-4.0.1/src&amp;#39;
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;    CC adlist.o
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;In file included from adlist.c:34:0:
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;zmalloc.h:50:31: fatal error: jemalloc/jemalloc.h: No such file or directory
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt; #include &amp;lt;jemalloc/jemalloc.h&amp;gt;
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;                               ^
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;compilation terminated.
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;make[1]: *** [adlist.o] Error 1
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;make[1]: Leaving directory `&lt;/span&gt;/home/application/redis-4.0.1/src&amp;#39;
make: &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;* [all] Error 2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Allocator  
---------  
 
Selecting a non-default memory allocator when building Redis is done by setting  
the &lt;span class=&#34;sb&#34;&gt;`MALLOC`&lt;/span&gt; environment variable. Redis is compiled and linked against libc  
malloc by default, with the exception of jemalloc being the default on Linux  
systems. This default was picked because jemalloc has proven to have fewer  
fragmentation problems than libc malloc.  
 
To force compiling against libc malloc, use:  
 
    % make MALLOC=libc  
 
To compile against jemalloc on Mac OS X systems, use:  
 
    % make MALLOC=jemalloc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;使用如下命令进行make操作&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;make MALLOC=libc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;之后在 make 的时候提示如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cc: error: ../deps/hiredis/libhiredis.a: No such file or directory
cc: error: ../deps/lua/src/liblua.a: No such file or directory
make[1]: &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;* [redis-server] Error 1
make[1]: Leaving directory `/home/application/redis-4.0.1/src&amp;#39;
make: &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;* [all] Error 2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;进入Redis安装目录下的deps目录下，执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;make lua hiredis linenoise
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;make之后，可以运行测试，确认Redis的功能是否正常，使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;make test
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;出现如下报错：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost redis-4.0.1]# make test
cd src &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; make test
make[1]: Entering directory &lt;span class=&#34;sb&#34;&gt;`/home/application/redis-4.0.1/src&amp;#39;
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;    CC Makefile.dep
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;make[1]: Leaving directory `&lt;/span&gt;/home/application/redis-4.0.1/src&amp;#39;
make[1]: Entering directory &lt;span class=&#34;sb&#34;&gt;`/home/application/redis-4.0.1/src&amp;#39;
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;You need tcl 8.5 or newer in order to run the Redis test
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;make[1]: *** [test] Error 1
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;make[1]: Leaving directory `&lt;/span&gt;/home/application/redis-4.0.1/src&amp;#39;
make: &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;* [test] Error 2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;根据提示安装tcl 8.5及以上版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget http://downloads.sourceforge.net/tcl/tcl8.6.1-src.tar.gz
tar -zxf tcl8.6.1-src.tar.gz
cd /home/application/tcl8.6.1/unix/
sudo ./configure
sudo make
sudo make install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、make 完后，redis-2.8.17 目录下会出现编译后的 redis 服务程序 &lt;code&gt;redis-server&lt;/code&gt;，还有用于测试的客户端程序&lt;code&gt;redis-cli&lt;/code&gt;，两个程序位于安装目录&lt;code&gt;src&lt;/code&gt;目录下，
启动redis服务：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ cd src
$ ./redis-server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这种方式启动redis使用的是默认配置。也可以通过启动参数告诉redis使用指定配置文件使用下面命令启动。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ cd src
$ ./redis-server redis.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;redis.conf 是一个默认的配置文件，可以根据需要使用自己的配置文件。&lt;/p&gt;
&lt;p&gt;3、启动 redis 服务进程后，就可以使用测试客户端程序 redis-cli 和 redis 服务交互了。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ cd src
$ ./redis-cli
redis&amp;gt; set abc def
OK
redis&amp;gt; get abc
&amp;#34;def&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;在-windows-下安装-redis&#34;&gt;在 Windows 下安装 Redis&lt;/h3&gt;
&lt;p&gt;1、Redis 支持 32 位和 64 位。这个需要根据你系统平台的实际情况选择，这里我们下载 &lt;code&gt;Redis-x64-xxx.zip&lt;/code&gt; 压缩包到C盘，解压后，将文件夹重新命名为 redis。
&lt;img src=&#34;http://www.runoob.com/wp-content/uploads/2014/11/3B8D633F-14CE-42E3-B174-FCCD48B11FF3.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;2、打开一个 cmd 窗口 使用 cd 命令切换目录到 &lt;code&gt;C:\redis&lt;/code&gt; 运行 &lt;code&gt;redis-server.exe redis.windows.conf&lt;/code&gt;。如果想方便的话，可以把 redis 的路径加到系统的环境变量里，这样就省得再输路径了，后面的那个 &lt;code&gt;redis.windows.conf&lt;/code&gt; 可以省略，如果省略，会启用默认的。输入之后，会显示如下界面：
&lt;img src=&#34;http://www.runoob.com/wp-content/uploads/2014/11/redis-install1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;3、此时另启一个 cmd 窗口，原来的不要关闭，否则就无法访问服务端了。
切换到 redis 目录下运行 &lt;code&gt;redis-cli.exe -h 127.0.0.1 -p 6379&lt;/code&gt;。
&lt;img src=&#34;http://www.runoob.com/wp-content/uploads/2014/11/redis-install2.jpg&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;在命令行中查询配置-redis-参数&#34;&gt;在命令行中查询配置 Redis 参数&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Redis 的配置文件位于 Redis 安装目录下，文件名为 redis.conf。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、可以使用 &lt;code&gt;config&lt;/code&gt; 命令查看或者设置配置项，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis 127.0.0.1:6379&amp;gt; config get loglevel
1) &amp;#34;loglevel&amp;#34;
2) &amp;#34;notice&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、使用&lt;code&gt;*&lt;/code&gt;获取所有配置项&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;127.0.0.1:6379&amp;gt; config get *
  1) &amp;#34;dbfilename&amp;#34;
  2) &amp;#34;dump.rdb&amp;#34;
  3) &amp;#34;requirepass&amp;#34;
  4) &amp;#34;&amp;#34;
  5) &amp;#34;masterauth&amp;#34;
  6) &amp;#34;&amp;#34;
  7) &amp;#34;unixsocket&amp;#34;
  8) &amp;#34;&amp;#34;
  9) &amp;#34;logfile&amp;#34;
 10) &amp;#34;&amp;#34;
 11) &amp;#34;pidfile&amp;#34;
 12) &amp;#34;/var/run/redis.pid&amp;#34;
 13) &amp;#34;maxmemory&amp;#34;
 14) &amp;#34;0&amp;#34;
 15) &amp;#34;maxmemory-samples&amp;#34;
 16) &amp;#34;5&amp;#34;
 17) &amp;#34;timeout&amp;#34;
 18) &amp;#34;0&amp;#34;
 19) &amp;#34;tcp-keepalive&amp;#34;
 20) &amp;#34;0&amp;#34;
 21) &amp;#34;auto-aof-rewrite-percentage&amp;#34;
 22) &amp;#34;100&amp;#34;
 23) &amp;#34;auto-aof-rewrite-min-size&amp;#34;
 24) &amp;#34;67108864&amp;#34;
 25) &amp;#34;hash-max-ziplist-entries&amp;#34;
 26) &amp;#34;512&amp;#34;
 27) &amp;#34;hash-max-ziplist-value&amp;#34;
 28) &amp;#34;64&amp;#34;
 29) &amp;#34;list-max-ziplist-entries&amp;#34;
 30) &amp;#34;512&amp;#34;
 31) &amp;#34;list-max-ziplist-value&amp;#34;
 32) &amp;#34;64&amp;#34;
 33) &amp;#34;set-max-intset-entries&amp;#34;
 34) &amp;#34;512&amp;#34;
 35) &amp;#34;zset-max-ziplist-entries&amp;#34;
 36) &amp;#34;128&amp;#34;
 37) &amp;#34;zset-max-ziplist-value&amp;#34;
 38) &amp;#34;64&amp;#34;
 39) &amp;#34;hll-sparse-max-bytes&amp;#34;
 40) &amp;#34;3000&amp;#34;
 41) &amp;#34;lua-time-limit&amp;#34;
 42) &amp;#34;5000&amp;#34;
 43) &amp;#34;slowlog-log-slower-than&amp;#34;
 44) &amp;#34;10000&amp;#34;
 45) &amp;#34;latency-monitor-threshold&amp;#34;
 46) &amp;#34;0&amp;#34;
 47) &amp;#34;slowlog-max-len&amp;#34;
 48) &amp;#34;128&amp;#34;
 49) &amp;#34;port&amp;#34;
 50) &amp;#34;6379&amp;#34;
 51) &amp;#34;tcp-backlog&amp;#34;
 52) &amp;#34;511&amp;#34;
 53) &amp;#34;databases&amp;#34;
 54) &amp;#34;16&amp;#34;
 55) &amp;#34;repl-ping-slave-period&amp;#34;
 56) &amp;#34;10&amp;#34;
 57) &amp;#34;repl-timeout&amp;#34;
 58) &amp;#34;60&amp;#34;
 59) &amp;#34;repl-backlog-size&amp;#34;
 60) &amp;#34;1048576&amp;#34;
 61) &amp;#34;repl-backlog-ttl&amp;#34;
 62) &amp;#34;3600&amp;#34;
 63) &amp;#34;maxclients&amp;#34;
 64) &amp;#34;10000&amp;#34;
 65) &amp;#34;watchdog-period&amp;#34;
 66) &amp;#34;0&amp;#34;
 67) &amp;#34;slave-priority&amp;#34;
 68) &amp;#34;100&amp;#34;
 69) &amp;#34;min-slaves-to-write&amp;#34;
 70) &amp;#34;0&amp;#34;
 71) &amp;#34;min-slaves-max-lag&amp;#34;
 72) &amp;#34;10&amp;#34;
 73) &amp;#34;hz&amp;#34;
 74) &amp;#34;10&amp;#34;
 75) &amp;#34;cluster-node-timeout&amp;#34;
 76) &amp;#34;15000&amp;#34;
 77) &amp;#34;cluster-migration-barrier&amp;#34;
 78) &amp;#34;1&amp;#34;
 79) &amp;#34;cluster-slave-validity-factor&amp;#34;
 80) &amp;#34;10&amp;#34;
 81) &amp;#34;repl-diskless-sync-delay&amp;#34;
 82) &amp;#34;5&amp;#34;
 83) &amp;#34;cluster-require-full-coverage&amp;#34;
 84) &amp;#34;yes&amp;#34;
 85) &amp;#34;no-appendfsync-on-rewrite&amp;#34;
 86) &amp;#34;no&amp;#34;
 87) &amp;#34;slave-serve-stale-data&amp;#34;
 88) &amp;#34;yes&amp;#34;
 89) &amp;#34;slave-read-only&amp;#34;
 90) &amp;#34;yes&amp;#34;
 91) &amp;#34;stop-writes-on-bgsave-error&amp;#34;
 92) &amp;#34;yes&amp;#34;
 93) &amp;#34;daemonize&amp;#34;
 94) &amp;#34;no&amp;#34;
 95) &amp;#34;rdbcompression&amp;#34;
 96) &amp;#34;yes&amp;#34;
 97) &amp;#34;rdbchecksum&amp;#34;
 98) &amp;#34;yes&amp;#34;
 99) &amp;#34;activerehashing&amp;#34;
100) &amp;#34;yes&amp;#34;
101) &amp;#34;repl-disable-tcp-nodelay&amp;#34;
102) &amp;#34;no&amp;#34;
103) &amp;#34;repl-diskless-sync&amp;#34;
104) &amp;#34;no&amp;#34;
105) &amp;#34;aof-rewrite-incremental-fsync&amp;#34;
106) &amp;#34;yes&amp;#34;
107) &amp;#34;aof-load-truncated&amp;#34;
108) &amp;#34;yes&amp;#34;
109) &amp;#34;appendonly&amp;#34;
110) &amp;#34;no&amp;#34;
111) &amp;#34;dir&amp;#34;
112) &amp;#34;C:\\redis&amp;#34;
113) &amp;#34;maxmemory-policy&amp;#34;
114) &amp;#34;noeviction&amp;#34;
115) &amp;#34;appendfsync&amp;#34;
116) &amp;#34;everysec&amp;#34;
117) &amp;#34;save&amp;#34;
118) &amp;#34;jd 900 jd 300 jd 60&amp;#34;
119) &amp;#34;loglevel&amp;#34;
120) &amp;#34;notice&amp;#34;
121) &amp;#34;client-output-buffer-limit&amp;#34;
122) &amp;#34;normal 0 0 0 slave 268435456 67108864 60 pubsub 33554432 8388608 60&amp;#34;
123) &amp;#34;unixsocketperm&amp;#34;
124) &amp;#34;0&amp;#34;
125) &amp;#34;slaveof&amp;#34;
126) &amp;#34;&amp;#34;
127) &amp;#34;notify-keyspace-events&amp;#34;
128) &amp;#34;&amp;#34;
129) &amp;#34;bind&amp;#34;
130) &amp;#34;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、可以通过修改&lt;code&gt;redis.conf&lt;/code&gt;或者&lt;code&gt;config set&lt;/code&gt;命令来修改配置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis 127.0.0.1:6379&amp;gt; config set loglevel &amp;#34;notice&amp;#34;
OK
redis 127.0.0.1:6379&amp;gt; config get loglevel
1) &amp;#34;loglevel&amp;#34;
2) &amp;#34;notice&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;四redis参数说明httpwwwrunoobcomredisredis-confhtml&#34;&gt;四、&lt;a href=&#34;http://www.runoob.com/redis/redis-conf.html&#34;&gt;Redis参数说明&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;redis.conf配置项说明如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;daemonize no：Redis 默认不是以守护进程的方式运行，可以通过该配置项修改，使用 yes 启用守护进程&lt;/li&gt;
&lt;li&gt;pidfile /var/run/redis.pid：当Redis以守护进程方式运行时，Redis 默认会把 pid 写入 /var/run/redis.pid 文件，可以通过 pidfile 指定&lt;/li&gt;
&lt;li&gt;port 6379：指定Redis监听端口，默认端口为6379。&lt;/li&gt;
&lt;li&gt;bind 127.0.0.1：绑定的主机地址&lt;/li&gt;
&lt;li&gt;timeout 300：当客户端闲置多长时间后关闭连接，如果指定为0，表示关闭该功能&lt;/li&gt;
&lt;li&gt;loglevel verbose：指定日志记录级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为verbose&lt;/li&gt;
&lt;li&gt;logfile stdout：日志记录方式，默认为标准输出，如果配置Redis为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给/dev/null&lt;/li&gt;
&lt;li&gt;databases 16：设置数据库的数量，默认数据库为0，可以使用SELECT &lt;dbid&gt;命令在连接上指定数据库id&lt;/li&gt;
&lt;li&gt;save &lt;seconds&gt; &lt;changes&gt;：指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合，Redis默认配置文件中提供了三个条件：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;save 900 1
save 300 10
save 60 10000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;分别表示900秒（15分钟）内有1个更改，300秒（5分钟）内有10个更改以及60秒内有10000个更改。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;rdbcompression yes：指定存储至本地数据库时是否压缩数据，默认为yes，Redis采用LZF压缩，如果为了节省CPU时间，可以关闭该选项，但会导致数据库文件变的巨大&lt;/li&gt;
&lt;li&gt;dbfilename dump.rdb：指定本地数据库文件名，默认值为dump.rdb。dump.rdb是由Redis服务器自动生成的 默认情况下 每隔一段时间redis服务器程序会自动对数据库做一次遍历，把内存快照写在一个叫做“dump.rdb”的文件里，这个持久化机制叫做SNAPSHOT。有了SNAPSHOT后，如果服务器宕机，重新启动redis服务器程序时redis会自动加载dump.rdb，将数据库状态恢复到上一次做SNAPSHOT时的状态。&lt;/li&gt;
&lt;li&gt;dir ./：指定本地数据库存放目录&lt;/li&gt;
&lt;li&gt;slaveof &lt;masterip&gt; &lt;masterport&gt;：设置当本机为slav服务时，设置master服务的IP地址及端口，在Redis启动时，它会自动从master进行数据同步&lt;/li&gt;
&lt;li&gt;masterauth &lt;master-password&gt;：当master服务设置了密码保护时，slave服务连接master的密码&lt;/li&gt;
&lt;li&gt;requirepass foobared：设置Redis连接密码，如果配置了连接密码，客户端在连接Redis时需要通过AUTH &lt;password&gt;命令提供密码，默认关闭&lt;/li&gt;
&lt;li&gt;maxclients 128：设置同一时间最大客户端连接数，默认无限制，Redis可以同时打开的客户端连接数为Redis进程可以打开的最大文件描述符数，如果设置 maxclients 0，表示不作限制。当客户端连接数到达限制时，Redis会关闭新的连接并向客户端返回max number of clients reached错误信息。&lt;/li&gt;
&lt;li&gt;maxmemory &lt;bytes&gt;：指定Redis最大内存限制，Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis新的vm机制，会把Key存放内存，Value会存放在swap区。&lt;/li&gt;
&lt;li&gt;appendonly no：指定是否在每次更新操作后进行日志记录，Redis在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为 redis本身同步数据文件是按上面save条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为no&lt;/li&gt;
&lt;li&gt;appendfilename appendonly.aof：指定更新日志文件名，默认为appendonly.aof&lt;/li&gt;
&lt;li&gt;appendfsync everysec：指定更新日志条件，共有3个可选值：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;1、no：表示等操作系统进行数据缓存同步到磁盘（快） 
2、always：表示每次更新操作后手动调用fsync()将数据写到磁盘（慢，安全） 
3、everysec：表示每秒同步一次（折衷，默认值）
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;vm-enabled no：指定是否启用虚拟内存机制，默认值为no，VM机制将数据分页存放，由Redis将访问量较少的页即冷数据swap到磁盘上，访问多的页面由磁盘自动换出到内存中。&lt;/li&gt;
&lt;li&gt;vm-swap-file /tmp/redis.swap：虚拟内存文件路径，默认值为/tmp/redis.swap，不可多个Redis实例共享&lt;/li&gt;
&lt;li&gt;vm-max-memory 0：将所有大于vm-max-memory的数据存入虚拟内存,无论vm-max-memory设置多小,所有索引数据都是内存存储的(Redis的索引数据就是keys),也就是说,当vm-max-memory设置为0的时候,其实是所有value都存在于磁盘。默认值为0。&lt;/li&gt;
&lt;li&gt;vm-page-size 32：Redis swap文件分成了很多的页，一个对象可以保存在多个页上面，但一个页上不能被多个对象共享，vm-page-size是要根据存储的数据大小来设定的，如果存储很多小对象，页的大小最好设置为32字节或者64字节；如果存储很大的大对象，则可以使用更大的页，如果不确定，就使用默认值。&lt;/li&gt;
&lt;li&gt;vm-pages 134217728：设置swap文件中的页的数量，由于页表（一种表示页面空闲或使用的bitmap）是在放在内存中的，在磁盘上每8个页将消耗1字节的内存。&lt;/li&gt;
&lt;li&gt;vm-max-threads 4：设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为0,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4&lt;/li&gt;
&lt;li&gt;glueoutputbuf yes：设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启&lt;/li&gt;
&lt;li&gt;指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;hash-max-zipmap-entries 64
hash-max-zipmap-value 512
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;activerehashing yes：指定是否激活重置哈希，默认为开启&lt;/li&gt;
&lt;li&gt;include /path/to/local.conf：指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Redis 进阶知识及操作</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-advanced/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-advanced/</guid>
                <pubDate>Sat, 04 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍了 Redis 的部分高级技术，包括数据备份和恢复、安全、性能测试、分区等。&lt;/p&gt;
&lt;h3 id=&#34;redis-数据备份与恢复&#34;&gt;Redis 数据备份与恢复&lt;/h3&gt;
&lt;h4 id=&#34;redis-数据备份&#34;&gt;Redis 数据备份&lt;/h4&gt;
&lt;p&gt;Redis 的 save 命令用于创建当前数据库的备份&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;redis save&lt;/code&gt; 命令来备份 redis 数据：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis 127.0.0.1:6379&amp;gt; save
OK
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;该命令将在 &lt;code&gt;redis&lt;/code&gt; 安装目录中创建 &lt;code&gt;dump.rdb&lt;/code&gt; 文件&lt;/p&gt;
&lt;p&gt;创建 redis 备份文件也可以使用命令 bgsave，该命令在后台执行。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;127.0.0.1:6379&amp;gt; bgsave
Background saving started
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;redis-数据恢复&#34;&gt;Redis 数据恢复&lt;/h4&gt;
&lt;p&gt;如果需要恢复数据，只需将备份文件 &lt;code&gt;dump.rdb&lt;/code&gt; 移动到 redis 安装目录并启动服务即可。&lt;/p&gt;
&lt;p&gt;获取 &lt;code&gt;redis&lt;/code&gt; 目录可以使用 &lt;code&gt;config&lt;/code&gt; 命令，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis 127.0.0.1:6379&amp;gt; config get dir
1) &amp;#34;dir&amp;#34;
2) &amp;#34;/usr/local/redis/bin&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;config get dir&lt;/code&gt; 输出的 &lt;code&gt;redis&lt;/code&gt; 安装目录为：&lt;code&gt;/usr/local/redis/bin&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;redis-安全&#34;&gt;Redis 安全&lt;/h3&gt;
&lt;p&gt;可以通过 redis 的配置文件设置密码参数，这样客户端连接到 redis 服务就需要密码验证，这样可以让 redis 服务更安全。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;127.0.0.1:6379&amp;gt; config get requirepass
1) &amp;#34;require&amp;#34;
2) &amp;#34;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;默认情况下 requirepass 参数是空的，这就意味着无需通过密码验证就可以连接到 redis 服务。
可以通过以下命令来修改该参数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;127.0.0.1:6379&amp;gt; config set requirepass &amp;#34;abcdef&amp;#34;
OK
127.0.0.1:6379&amp;gt; config get requirepass
1) &amp;#34;requirepass&amp;#34;
2) &amp;#34;abcdef&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;设置密码后，客户端连接 redis 服务就需要密码验证，否则无法执行命令。&lt;/p&gt;
&lt;p&gt;auth 命令基本语法格式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;127.0.0.1:6379&amp;gt; auth password
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;示例&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;127.0.0.1:6379&amp;gt; auth &amp;#34;abcdef&amp;#34;
OK
127.0.0.1:6379&amp;gt; set xkey &amp;#34;MyValue&amp;#34;
OK
127.0.0.1:6379&amp;gt; get xkey
&amp;#34;MyValue&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;redis-性能测试&#34;&gt;Redis 性能测试&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Redis 性能测试是通过同时执行多个命令实现的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;redis 性能测试的基本命令如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis-benchmark [option] [option value]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;同时执行 10000 个请求来检测性能&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis-benchmark -n 10000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;Redis 性能测试工具可选参数如下所示：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;选项&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;默认值&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;-h&lt;/td&gt;
&lt;td&gt;指定服务器主机名&lt;/td&gt;
&lt;td&gt;127.0.0.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;-p&lt;/td&gt;
&lt;td&gt;指定服务器端口&lt;/td&gt;
&lt;td&gt;6379&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;-s&lt;/td&gt;
&lt;td&gt;指定服务器 socket&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;-c&lt;/td&gt;
&lt;td&gt;指定并发连接数&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;-n&lt;/td&gt;
&lt;td&gt;指定请求数&lt;/td&gt;
&lt;td&gt;10000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;-d&lt;/td&gt;
&lt;td&gt;以字节的形式指定 SET/GET 值的数据大小&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;-k&lt;/td&gt;
&lt;td&gt;1=keep alive 0=reconnect&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;-r&lt;/td&gt;
&lt;td&gt;SET/GET/INCR 使用随机 key, SADD 使用随机值&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;-P&lt;/td&gt;
&lt;td&gt;通过管道传输 &lt;numreq&gt; 请求&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;-q&lt;/td&gt;
&lt;td&gt;强制退出 redis。仅显示 query/sec 值&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;--csv&lt;/td&gt;
&lt;td&gt;以 CSV 格式输出&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;-l&lt;/td&gt;
&lt;td&gt;生成循环，永久执行测试&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;-t&lt;/td&gt;
&lt;td&gt;仅运行以逗号分隔的测试命令列表&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;-L&lt;/td&gt;
&lt;td&gt;Idle 模式。仅打开 N 个 idle 连接并等待&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;使用多个参数来测试 redis 的性能&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis-benchmark -h 127.0.0.1 -p 6379 -t set,lpush -n 10000 -q
SET: 2131.74 requests per second
LPUSH: 2257.34 requests per second
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;redis-客户端连接&#34;&gt;Redis 客户端连接&lt;/h3&gt;
&lt;p&gt;Redis 通过监听一个 TCP 端口或者 Unix socket 的方式来接收来自客户端的连接，当一个连接建立后，Redis 内部会进行以下一些操作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;首先，客户端 socket 会被设置为非阻塞模式，因为 Redis 在网络事件处理上采用的是非阻塞多路复用模型。&lt;/li&gt;
&lt;li&gt;然后为这个 socket 设置 TCP_NODELAY 属性，禁用 Nagle 算法&lt;/li&gt;
&lt;li&gt;然后创建一个可读的文件事件用于监听这个客户端 socket 的数据发送&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;最大连接数 maxclients 的默认值是 10000，也可以在 redis.conf 中进行设置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;config get maxclients 
1) &amp;#34;maxclients&amp;#34;
2) &amp;#34;10000&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在服务启动时设置最大连接数为 100000&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis-server --maxclients 10000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;客户端命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;client list&lt;/td&gt;
&lt;td&gt;返回连接到 redis 服务的客户端列表&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;client setname&lt;/td&gt;
&lt;td&gt;设置当前连接的名称&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;client getname&lt;/td&gt;
&lt;td&gt;获取通过 CLIENT SETNAME 命令设置的服务名称&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;client pause&lt;/td&gt;
&lt;td&gt;挂起客户端连接，指定挂起的时间以毫秒计&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;client kill&lt;/td&gt;
&lt;td&gt;关闭客户端连接&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;redis-管道技术&#34;&gt;Redis 管道技术&lt;/h3&gt;
&lt;p&gt;Redis 是一种基于客户端-服务端模型以及请求/响应协议的 TCP 服务，这意味着通常情况下一个请求会遵循以下步骤：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;客户端向服务端发送一个查询请求，并监听 socket 返回，通常是以阻塞模式，等待服务端响应。&lt;/li&gt;
&lt;li&gt;服务端处理命令，并将结果返回给客户端。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Redis 管道技术可以在服务端未响应时，客户端可以继续向服务端发送请求，并最终一次性读取所有服务端的响应。&lt;/p&gt;
&lt;p&gt;示例
查看 redis 管道，只需要启动 redis 实例并输入以下命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$(echo -en &amp;#34;ping\r\n SET x_key redis\r\nGET runoobkey\r\nINCR visitor\r\nINCR visitor\r\nINCR visitor\r\n&amp;#34;; sleep 10) | nc localhost 6379

+PONG
+OK
redis
:1
:2
:3
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上示例中，通过使用 ping 命令查看redis服务是否可用，之后设置了 x_key 的值为 redis，然后获取 x_key 的值并使得 visitor 自增 3 次。
在返回的结果中，可以看到这些命令一次性向 redis 服务提交，并最终一次性读取所有服务端的响应&lt;/p&gt;
&lt;p&gt;管道技术最显著的优势是提高了 redis 服务的性能。&lt;/p&gt;
&lt;h3 id=&#34;redis-分区&#34;&gt;Redis 分区&lt;/h3&gt;
&lt;p&gt;分区是分割数据到多个 Redis 实例的处理过程，因此每个实例只保存 key 的一个子集。&lt;/p&gt;
&lt;h4 id=&#34;分区的优势和不足&#34;&gt;分区的优势和不足&lt;/h4&gt;
&lt;p&gt;1、分区的优势&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;通过利用多台计算机内存的和值，允许我们构造更大的数据库。&lt;/li&gt;
&lt;li&gt;通过多核和多台计算机，允许我们扩展计算能力&lt;/li&gt;
&lt;li&gt;通过多台计算机和网络适配器，允许我们扩展网络带宽。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、分区的不足&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;redis的一些特性在分区方面表现的不是很好：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;涉及多个 key 的操作通常是不被支持的。举例来说，当两个 set 映射到不同的 redis 实例上时，你就不能对这两个 set 执行交集操作&lt;/li&gt;
&lt;li&gt;涉及多个 key 的 redis 事务不能使用&lt;/li&gt;
&lt;li&gt;当使用分区时，数据处理较为复杂，比如你需要处理多个 rdb/aof 文件，并且从多个实例和主机备份持久化文件&lt;/li&gt;
&lt;li&gt;增加或删除容量也比较复杂。redis 集群大多数支持在运行时增加、删除节点的透明数据平衡的能力，但是类似于客户端分区、代理等其他系统则不支持这项特性。然而，一种叫做 presharding 的技术对此是有帮助的&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;分区类型&#34;&gt;分区类型&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Redis 有两种类型分区。 假设有4个Redis实例 R0，R1，R2，R3，和类似user:1，user:2这样的表示用户的多个key，对既定的key有多种不同方式来选择这个key存放在哪个实例中。也就是说，有不同的系统来映射某个key到某个Redis服务。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、范围分区&lt;/p&gt;
&lt;p&gt;最简单的分区方式是按范围分区，就是映射一定范围的对象到特定的Redis实例。&lt;/p&gt;
&lt;p&gt;比如，ID 从 0 到 10000 的用户会保存到实例 R0，ID 从 10001 到 20000 的用户会保存到 R1，以此类推。&lt;/p&gt;
&lt;p&gt;这种方式是可行的，并且在实际中使用，不足就是要有一个区间范围到实例的映射表。这个表要被管理，同时还需要各 种对象的映射表，通常对Redis来说并非是好的方法。&lt;/p&gt;
&lt;p&gt;2、哈希分区&lt;/p&gt;
&lt;p&gt;hash分区，这对任何key都适用，也无需是object_name:这种形式，描述如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;用一个hash函数将key转换为一个数字，比如使用 &lt;code&gt;crc32&lt;/code&gt; hash函数。对key foobar执行crc32(foobar)会输出类似93024922的整数。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对这个整数取模，将其转化为0-3之间的数字，就可以将这个整数映射到4个Redis实例中的一个了。93024922 % 4 = 2，就是说key foobar应该被存到R2实例中。注意：取模操作是取除的余数，通常在多种编程语言中用%操作符实现。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Redis 集群部署</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-cluster/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-cluster/</guid>
                <pubDate>Sat, 04 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍了 Redis 的集群部署。&lt;/p&gt;
&lt;h3 id=&#34;redis-集群的搭建一&#34;&gt;Redis 集群的搭建（一）&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;在一台 CentOS 7 虚拟机中搭建三个节点的 Redis 集群，该节点IP地址为：192.168.244.129&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、根据 &lt;code&gt;在 Linux 中安装 Redis&lt;/code&gt; 安装 Redis 并成功启动单个实例&lt;/p&gt;
&lt;p&gt;2、在 &lt;code&gt;/home/application/redis-4.0.1&lt;/code&gt; 目录下创建 redis-cluster 目录，在该目录下分别创建 redis-1、redis-2、redis-3目录，复制redis.conf到redis-1、redis-2、redis-3目录下并分别创建log目录&lt;/p&gt;
&lt;p&gt;3、修改redis-1、redis-2、redis-3目录下的redis.conf，修改内容如下所示：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;节点&lt;/th&gt;
&lt;th&gt;redis_1&lt;/th&gt;
&lt;th&gt;redis_2&lt;/th&gt;
&lt;th&gt;redis_3&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;192.168.244.129&lt;/td&gt;
&lt;td&gt;192.168.244.129&lt;/td&gt;
&lt;td&gt;192.168.244.129&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;端口&lt;/td&gt;
&lt;td&gt;8001&lt;/td&gt;
&lt;td&gt;8002&lt;/td&gt;
&lt;td&gt;8003&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;daemonize&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;pidfile&lt;/td&gt;
&lt;td&gt;/var/run/redis_8001.pid&lt;/td&gt;
&lt;td&gt;/var/run/redis_8002.pid&lt;/td&gt;
&lt;td&gt;/var/run/redis_8003.pid&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster-enabled&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster-config-file&lt;/td&gt;
&lt;td&gt;./config/nodes_8001.conf&lt;/td&gt;
&lt;td&gt;./config/nodes_8002.conf&lt;/td&gt;
&lt;td&gt;./config/nodes_8003.conf&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster-node-timeout&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;appendonly&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;logfile&lt;/td&gt;
&lt;td&gt;/home/application/redis-4.0.1/redis_cluster/redis_1/log/&lt;/td&gt;
&lt;td&gt;/home/application/redis-4.0.1/redis_cluster/redis_2/log/&lt;/td&gt;
&lt;td&gt;/home/application/redis-4.0.1/redis_cluster/redis_3/log/&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;4、将 redis-trib.rb 复制到 /usr/local/bin 目录下，使用 redis-trib.rb 工具启动集群。
报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost src]# redis-trib.rb create --replicas 1 192.168.244.129:8001 192.168.244.129:8002 192.168.244.129:8003 192.168.244.133:8004 192.168.244.133:8005 192.168.244.133:8006
/usr/share/rubygems/rubygems/core_ext/kernel_require.rb:55:in &lt;span class=&#34;sb&#34;&gt;`require&amp;#39;: cannot load such file -- redis (LoadError)
&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;	from /usr/share/rubygems/rubygems/core_ext/kernel_require.rb:55:in `&lt;/span&gt;require&amp;#39;
	from /usr/local/bin/redis-trib.rb:25:in `&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;使用 gem 安装 Redis，使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost src]# gem install redis
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost src]# gem install redis
ERROR:  Could not find a valid gem &amp;#39;redis&amp;#39; (&amp;gt;= 0), here is why:
          Unable to download data from https://rubygems.org/ - Errno::ECONNREFUSED: Connection refused - connect(2) (https://rubygems.org/latest_specs.4.8.gz)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost application]# gem install redis
ERROR:  Error installing redis:
	redis requires Ruby version &amp;gt;= 2.2.2.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;显示ruby版本须高于2.2.2，查看yum安装的ruby版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ruby -version
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;安装指定版本的-ruby&#34;&gt;安装指定版本的 ruby&lt;/h3&gt;
&lt;p&gt;1）安装 curl，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo yum install curl
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）安装RVM，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -L get.rvm.io | bash -s table
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）执行下面命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;source /usr/local/rvm/scripts/rvm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4）查看rvm库中已知的ruby版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rvm list known
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5）安装一个ruby版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rvm install 2.3.3
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6）使用一个ruby版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rvm use 2.3.3
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7）卸载指定版本的ruby&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rvm remove 2.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8）查看ruby版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ruby --version
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;安装完成后，查看安装的ruby版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# ruby -version
ruby 2.4.1p111 (2017-03-22 revision 58053) [x86_64-linux]
-e:1:in &lt;span class=&#34;sb&#34;&gt;`&amp;lt;main&amp;gt;&amp;#39;: undefined local variable or method `&lt;/span&gt;rsion&amp;#39; for main:Object (NameError)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、使用gem安装redis&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;gem install redis
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、在 &lt;code&gt;192.168.244.129&lt;/code&gt; 上启动三个 Redis 实例，搭建伪分布式集群&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost redis-4.0.1]# redis-trib.rb create --replicas 0 192.168.244.129:8001 192.168.244.129:8002 192.168.244.129:8003 
&amp;gt;&amp;gt;&amp;gt; Creating cluster
&amp;gt;&amp;gt;&amp;gt; Performing hash slots allocation on 3 nodes...
Using 3 masters:
192.168.244.129:8001
192.168.244.129:8002
192.168.244.129:8003
M: f55b5ad14335b51c58922d60ba55990cf303fd54 192.168.244.129:8001
   slots:0-5460 (5461 slots) master
M: 6ea0f62a8dcae5fa94ae778aff06764c4dbe0674 192.168.244.129:8002
   slots:5461-10922 (5462 slots) master
M: af341ce9fda618a5905c3a7d542f649abba5c8a5 192.168.244.129:8003
   slots:10923-16383 (5461 slots) master
Can I set the above configuration? (type &amp;#39;yes&amp;#39; to accept): yes
&amp;gt;&amp;gt;&amp;gt; Nodes configuration updated
&amp;gt;&amp;gt;&amp;gt; Assign a different config epoch to each node
&amp;gt;&amp;gt;&amp;gt; Sending CLUSTER MEET messages to join the cluster
Waiting for the cluster to join..
&amp;gt;&amp;gt;&amp;gt; Performing Cluster Check (using node 192.168.244.129:8001)
M: f55b5ad14335b51c58922d60ba55990cf303fd54 192.168.244.129:8001
   slots:0-5460 (5461 slots) master
   0 additional replica(s)
M: af341ce9fda618a5905c3a7d542f649abba5c8a5 192.168.244.129:8003
   slots:10923-16383 (5461 slots) master
   0 additional replica(s)
M: 6ea0f62a8dcae5fa94ae778aff06764c4dbe0674 192.168.244.129:8002
   slots:5461-10922 (5462 slots) master
   0 additional replica(s)
[OK] All nodes agree about slots configuration.
&amp;gt;&amp;gt;&amp;gt; Check for open slots...
&amp;gt;&amp;gt;&amp;gt; Check slots coverage...
[OK] All 16384 slots covered.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;已经搭建成功Redis集群。&lt;/p&gt;
&lt;h3 id=&#34;搭建-redis-集群二&#34;&gt;搭建 Redis 集群（二）&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;在两台CentOS 7 虚拟机上搭建六个节点的Redis集群，IP地址分别为：192.168.244.129和192.168.244.133&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、下载Redis安装包，使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget http://download.redis.io/releases/redis-4.0.1.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、解压redis-4.0.1.tar.gz文件，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tar -zxf redis-4.0.1.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、进入redis-4.0.1目录下，编译Redis源程序，使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;make 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;编译完成后，使用如下命令测试：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;make test
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果出现如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;!!! WARNING The following tests failed:
&lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;* [err]: Slave should be able to synchronize with the master in tests/integration/replication-psync.tcl

Replication not started.

Cleanup: may take some time... OK
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;虚拟机中安装的时候，机器性能不够的话，很容易出现上述错误。换机器或者更换参数，以及在机器不忙的时候进行编译安装，会顺利通过。&lt;/p&gt;
&lt;p&gt;4、将 src 目录下的 redis-trib.rb 复制到 /usr/local/bin 目录下，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp -f src/redis-trib.rb /usr/local/bin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、在 redis-4.0.1 目录下创建 redis_cluster、data 和 config 目录，在 redis_cluster 目录下创建redis_4，redis_5，redis_6目录，复制redis.conf文件至各目录下，并在各目录下创建log目录。&lt;/p&gt;
&lt;p&gt;6、修改各目录下的redis.conf文件&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;节点&lt;/th&gt;
&lt;th&gt;redis_1&lt;/th&gt;
&lt;th&gt;redis_2&lt;/th&gt;
&lt;th&gt;redis_3&lt;/th&gt;
&lt;th&gt;redis_4&lt;/th&gt;
&lt;th&gt;redis_5&lt;/th&gt;
&lt;th&gt;redis_6&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;IP&lt;/td&gt;
&lt;td&gt;192.168.244.129&lt;/td&gt;
&lt;td&gt;192.168.244.129&lt;/td&gt;
&lt;td&gt;192.168.244.129&lt;/td&gt;
&lt;td&gt;192.168.244.133&lt;/td&gt;
&lt;td&gt;192.168.244.133&lt;/td&gt;
&lt;td&gt;192.168.244.133&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;端口&lt;/td&gt;
&lt;td&gt;8001&lt;/td&gt;
&lt;td&gt;8002&lt;/td&gt;
&lt;td&gt;8003&lt;/td&gt;
&lt;td&gt;8004&lt;/td&gt;
&lt;td&gt;8005&lt;/td&gt;
&lt;td&gt;8006&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;daemonize&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;pidfile&lt;/td&gt;
&lt;td&gt;/var/run/redis_8001.pid&lt;/td&gt;
&lt;td&gt;/var/run/redis_8002.pid&lt;/td&gt;
&lt;td&gt;/var/run/redis_8003.pid&lt;/td&gt;
&lt;td&gt;/var/run/redis_8004.pid&lt;/td&gt;
&lt;td&gt;/var/run/redis_8005.pid&lt;/td&gt;
&lt;td&gt;/var/run/redis800_6.pid&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster-enabled&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster-config-file&lt;/td&gt;
&lt;td&gt;./config/nodes_8001.conf&lt;/td&gt;
&lt;td&gt;./config/nodes_8002.conf&lt;/td&gt;
&lt;td&gt;./config/nodes_8003.conf&lt;/td&gt;
&lt;td&gt;./config/nodes_8004.conf&lt;/td&gt;
&lt;td&gt;./config/nodes_8005.conf&lt;/td&gt;
&lt;td&gt;./config/nodes_8006.conf&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cluster-node-timeout&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;td&gt;15000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;appendonly&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;td&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;logfile&lt;/td&gt;
&lt;td&gt;./redis_cluster/redis_1/log/&lt;/td&gt;
&lt;td&gt;./redis_cluster/redis_2/log/&lt;/td&gt;
&lt;td&gt;./redis_cluster/redis_3/log/&lt;/td&gt;
&lt;td&gt;./redis_cluster/redis_4/log/&lt;/td&gt;
&lt;td&gt;./redis_cluster/redis_5/log/&lt;/td&gt;
&lt;td&gt;./redis_cluster/redis_6/log/&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;将 &lt;code&gt;dump.rdb&lt;/code&gt; 和 &lt;code&gt;appendonly.aof&lt;/code&gt; 文件的目录修改至 &lt;code&gt;./data&lt;/code&gt; 目录下&lt;/p&gt;
&lt;p&gt;7、在 &lt;code&gt;192.168.244.129&lt;/code&gt; 和 &lt;code&gt;192.168.244.133&lt;/code&gt; 上各启动三个Redis实例，搭建含有六个节点的跨主机集群，在 &lt;code&gt;192.168.244.129&lt;/code&gt; 上执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis-trib.rb create --replicas 1 192.168.244.129:8001 192.168.244.129:8002 192.168.244.129:8003 192.168.244.133:8004 192.168.244.133:8005 192.168.244.133:8006
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行后，报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;gt;&amp;gt;&amp;gt; Creating cluster
[ERR] Sorry, can&amp;#39;t connect to node 192.168.244.133:8004
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可能是因为192.168.244.133上的相应端口未开放
解决：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;CentOS 7 使用firewalld代替了iptables
在 &lt;code&gt;192.168.244.133&lt;/code&gt; 上开启防火墙端口8004、8005、8006，使用命令为：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;firewall-cmd --zone=public --add-port=8004/tcp --permanent # --zone &lt;span class=&#34;ni&#34;&gt;#作用域&lt;/span&gt; --add-port=80/tcp  &lt;span class=&#34;ni&#34;&gt;#添加端口&lt;/span&gt;，格式为：端口/通讯协议 --permanent  &lt;span class=&#34;ni&#34;&gt;#永久生效&lt;/span&gt;，没有此参数重启后失效
firewall-cmd --reload # 重启防火墙
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;之后重新启动集群，出现如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost redis-4.0.1]# redis-trib.rb create --replicas 1 192.168.244.129:8001 192.168.244.129:8002 192.168.244.129:8003 192.168.244.133:8004 192.168.244.133:8005 192.168.244.133:8006
&amp;gt;&amp;gt;&amp;gt; Creating cluster
[ERR] Node 192.168.244.129:8001 is not empty. Either the node already knows other nodes (check with CLUSTER NODES) or contains some key in database 0.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：
清理掉 &lt;code&gt;redis-4.0.1&lt;/code&gt; 目录下的 appendonly.aof dump.rdb nodes-*.conf 文件，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rm -f appendonly.aof dump.rdb nodes-*.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重新启动六个Redis实例，出现如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;gt;&amp;gt;&amp;gt; Assign a different config epoch to each node
&amp;gt;&amp;gt;&amp;gt; Sending CLUSTER MEET messages to join the cluster
Waiting for the cluster to join.............................................................................................................................................................................
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Every Redis Cluster node requires two TCP connections open. The
normal Redis TCP port used to serve clients, for example 6379, plus
the port obtained by adding 10000 to the data port, so 16379 in the
example. This second high port is used for the Cluster bus, that is
a node-to-node communication channel using a binary protocol. The
Cluster bus is used by nodes for failure detection, configuration
update, failover authorization and so forth. Clients should never
try to communicate with the cluster bus port, but always with the
normal Redis command port, however make sure you open both ports in
your firewall, otherwise Redis cluster nodes will be not able to
communicate. The command port and cluster bus port offset is fixed
and is always 10000. Note that for a Redis Cluster to work properly
you need, for each node: The normal client communication port
(usually 6379) used to communicate with clients to be open to all
the clients that need to reach the cluster, plus all the other
cluster nodes (that use the client port for keys migrations). The
cluster bus port (the client port + 10000) must be reachable from
all the other cluster nodes. If you don&amp;#39;t open both TCP ports, your
cluster will not work as expected. The cluster bus uses a
different, binary protocol, for node to node data exchange, which
is more suited to exchange information between nodes using little
bandwidth and processing time. i use AWS, due to don&amp;#39;t open 16379
16380 port, cause this issue
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：
在 &lt;code&gt;192.168.244.133&lt;/code&gt; 上开放 &lt;code&gt;18004&lt;/code&gt;、&lt;code&gt;18005&lt;/code&gt; 和 &lt;code&gt;18006&lt;/code&gt; 端口以供 &lt;code&gt;redis&lt;/code&gt; 集群数据通讯。&lt;/p&gt;
&lt;p&gt;在搭建过程中，可以使用redis-trib.rb测试各个节点的连接情况：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost redis-3.2.10]# redis-trib.rb check 192.168.244.133:8007
&amp;gt;&amp;gt;&amp;gt; Performing Cluster Check (using node 192.168.244.133:8007)
M: 2c6977dce48d9abd038d066c37c91306ffd32ca2 192.168.244.133:8007
   slots: (0 slots) master
   0 additional replica(s)
[OK] All nodes agree about slots configuration.
&amp;gt;&amp;gt;&amp;gt; Check for open slots...
&amp;gt;&amp;gt;&amp;gt; Check slots coverage...
[ERR] Not all 16384 slots are covered by nodes.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、登录redis集群节点机，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost redis-4.0.1]# redis-cli -h 192.168.244.129 -p 8003 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;若要停止Redis服务，可以使用命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost redis-4.0.1]# redis-cli -h 192.168.244.129 -p 8003 shutdown
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 常用知识总结</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-common-knowledge/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-common-knowledge/</guid>
                <pubDate>Fri, 03 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了些 Linux 系统的常用知识。&lt;/p&gt;
&lt;h3 id=&#34;文件和目录权限&#34;&gt;文件和目录权限&lt;/h3&gt;
&lt;p&gt;root 默认对所有文件具有读写权限，但默认没有执行权限。&lt;/p&gt;
&lt;h4 id=&#34;目录权限知识&#34;&gt;目录权限知识&lt;/h4&gt;
&lt;p&gt;对于目录来说，
r 查看目录中的内容
w 可以在目录中创建、删除、修改、重命名文件。
x 表示是否可以进入到目录中，是否能查看或修改目录中文件的属性信息。&lt;/p&gt;
&lt;p&gt;目录的 r 权限，需要 x 权限配合。
目录的 w 权限，需要 x 权限配合。
单独的 x 权限没有用。&lt;/p&gt;
&lt;h3 id=&#34;ulimit&#34;&gt;ulimit&lt;/h3&gt;
&lt;p&gt;设置当前shell以及由它启动的进程的资源限制。&lt;/p&gt;
&lt;p&gt;linux 对于每个用户，系统限制其最大进程数。为提高性能，可以根据设备资源情况，设置各linux 用户的最大进程数。&lt;/p&gt;
&lt;p&gt;可以用 &lt;code&gt;ulimit -a&lt;/code&gt; 来显示当前的各种用户进程限制。&lt;/p&gt;
&lt;p&gt;可以通过 &lt;code&gt;ulimit -n 4096&lt;/code&gt; 将每个进程可以打开的文件数目加大到4096，缺省为1024。
其他建议设置成无限制（unlimited）的一些重要设置是：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;数据段长度：ulimit -d unlimited
最大内存大小：ulimit -m unlimited
堆栈大小：ulimit -s unlimited
CPU 时间：ulimit -t unlimited
虚拟内存：ulimit -v unlimited
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;暂时地，适用于通过 ulimit 命令登录 shell 会话期间。
永久地，通过将一个相应的 ulimit 语句添加到由登录 shell 读取的文件中， 即特定于 shell 的用户资源文件。&lt;/p&gt;
&lt;h4 id=&#34;ulimit-的硬限制和软限制&#34;&gt;ulimit 的硬限制和软限制&lt;/h4&gt;
&lt;p&gt;硬限制使用 -H 参数，软限制使用 -S 参数。&lt;/p&gt;
&lt;p&gt;ulimit -a 看到的是软限制，可以通过 ulimit -a -H 查看其硬限制。&lt;/p&gt;
&lt;p&gt;如果 ulimit 不限定使用 -H 或 -S，此时它会同时把两类限制都改掉的。&lt;/p&gt;
&lt;p&gt;软限制可以限制用户/组对资源的使用，硬限制的作用是控制软限制。&lt;/p&gt;
&lt;p&gt;超级用户和普通用户都可以扩大硬限制，但是超级用户可以缩小硬限制，普通用户则不能缩小硬限制。&lt;/p&gt;
&lt;p&gt;硬限制设定后，设定软限制时只能是小于或者等于硬限制。&lt;/p&gt;
&lt;h4 id=&#34;解除资源限制&#34;&gt;解除资源限制&lt;/h4&gt;
&lt;p&gt;1、解除 Linux 系统的最大进程数和最大文件打开数限制：&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;/etc/security/limits.conf&lt;/code&gt; 中添加如下行：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; soft noproc 11000
&lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; hard noproc 11000
&lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; soft nofile 4100
&lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; hard nofile 4100
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;说明：* 代表针对所有用户，&lt;code&gt;noproc&lt;/code&gt; 是代表最大进程数，&lt;code&gt;nofile&lt;/code&gt; 是代表最大文件打开数。&lt;/p&gt;
&lt;p&gt;2、修改所有Linux用户的环境变量文件：&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;/etc/profile&lt;/code&gt;中添加如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ulimit -u 10000
ulimit -n 4096
ulimit -d unlimited
ulimit -m unlimited
ulimit -s unlimited
ulimit -t unlimited
ulimit -v unlimited
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;保存后运行&lt;code&gt;source /etc/profile&lt;/code&gt; 使其生效。&lt;/p&gt;
&lt;h4 id=&#34;参考资料&#34;&gt;参考资料&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/csq_year/article/details/49304895&#34;&gt;https://blog.csdn.net/csq_year/article/details/49304895&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/fengspg/article/details/39646337&#34;&gt;https://blog.csdn.net/fengspg/article/details/39646337&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;僵尸进程和孤儿进程&#34;&gt;僵尸进程和孤儿进程&lt;/h3&gt;
&lt;p&gt;在unix/linux中，正常情况下，子进程是通过父进程创建的，子进程在创建新的进程。子进程的结束和父进程的运行是一个异步过程,即父进程永远无法预测子进程 到底什么时候结束。 当一个 进程完成它的工作终止之后，它的父进程需要调用wait()或者waitpid()系统调用取得子进程的终止状态。
	孤儿进程：一个父进程退出，而它的一个或多个子进程还在运行，那么那些子进程将成为孤儿进程。孤儿进程将被init进程(进程号为1)所收养，并由init进程对它们完成状态收集工作。
	僵尸进程：一个进程使用fork创建子进程，如果子进程退出，而父进程并没有调用 wait 函数或 waitpid 函数获取子进程的状态信息，那么子进程的进程描述符仍然保存在系统中。这种进程称之为僵死进程。&lt;/p&gt;
&lt;p&gt;unix提供了一种机制可以保证只要父进程想知道子进程结束时的状态信息， 就可以得到。这种机制就是: 在每个进程退出的时候,内核释放该进程所有的资源,包括打开的文件,占用的内存等。 但是仍然为其保留一定的信息(包括进程号，退出状态，运行时间等)。直到父进程通过wait / waitpid来取时才释放。 但这样就导致了问题，如果父进程不调用wait / waitpid的话， 那么保留的那段信息就不会释放，其进程号就会一直被占用，但是系统所能使用的进程号是有限的，如果大量的产生僵死进程，将因为没有可用的进程号而导致系统不能产生新的进程. 此即为僵尸进程的危害，应当避免。&lt;/p&gt;
&lt;p&gt;孤儿进程是没有父进程的进程，孤儿进程这个重任就落到了init进程身上，init进程就好像是一个民政局，专门负责处理孤儿进程的善后工作。每当出现一个孤儿进程的时候，内核就把孤 儿进程的父进程设置为init，而init进程会循环地wait()它的已经退出的子进程。这样，当一个孤儿进程凄凉地结束了其生命周期的时候，init进程就会出面处理它的一切善后工作。因此孤儿进程并不会有什么危害。&lt;/p&gt;
&lt;p&gt;任何一个子进程(init除外)在exit()之后，并非马上就消失掉，而是留下一个称为僵尸进程(Zombie)的数据结构，等待父进程处理。这是每个 子进程在结束时都要经过的阶段。如果子进程在exit()之后，父进程没有来得及处理，这时用ps命令就能看到子进程的状态是“Z”。如果父进程能及时 处理，可能用ps命令就来不及看到子进程的僵尸状态，但这并不等于子进程不经过僵尸状态。  如果父进程在子进程结束之前退出，则子进程将由init接管。init将会以父进程的身份对僵尸状态的子进程进行处理。&lt;/p&gt;
&lt;p&gt;解决方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;通过信号机制，子进程退出时向父进程发送 &lt;code&gt;SIGCHILD&lt;/code&gt; 信号，父进程处理 &lt;code&gt;SIGCHILD&lt;/code&gt; 信号。在信号处理函数中调用wait进行处理僵尸进程。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Fork两次，原理是将子进程成为孤儿进程，从而其的父进程变为init进程，通过init进程可以处理僵尸进程。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;守护进程&#34;&gt;守护进程&lt;/h3&gt;
&lt;p&gt;守护进程（Daemon Process），是Linux中的后台服务进程，是一个生存期较长的进程，通常独立于控制终端并且周期性地执行某种任务或等待处理某些发生的事件。&lt;/p&gt;
&lt;p&gt;守护进程是个特殊的孤儿进程，这种进程脱离终端，为什么要脱离终端呢？之所以脱离于终端是为了避免进程被任何终端所产生的信息所打断，其在执行过程中的信息也不在任何终端上显示。由于在 linux 中，每一个系统与用户进行交流的界面称为终端，每一个从此终端开始运行的进程都会依附于这个终端，这个终端就称为这些进程的控制终端，当控制终端被关闭时，相应的进程都会自动关闭。&lt;/p&gt;
&lt;p&gt;Linux 的大多数服务器就是用守护进程实现的。比如，Internet 服务器 inetd，Web 服务器 httpd 等。&lt;/p&gt;
&lt;h3 id=&#34;系统平均负载&#34;&gt;系统平均负载&lt;/h3&gt;
&lt;p&gt;系统平均负载被定义为在特定时间间隔内运行队列中的平均进程数。如果一个进程满足以下条件，则其就会位于运行队列中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;没有在等待I/O操作的结果。&lt;/li&gt;
&lt;li&gt;没有主动进入等待状态（也就是没有调用wait）。&lt;/li&gt;
&lt;li&gt;没有被停止。&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# uptime
 04:10:38 up 19 days,  4:56,  3 users,  load average: 0.90, 0.52, 0.42
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;命令输出的最后内容表示在过去的1、5、15分钟内运行队列中的平均进程数量。&lt;/p&gt;
&lt;p&gt;一般来说只要每个CPU的当前活动进程数不大于3那么系统的性能就是良好的，如果每个CPU的任务数大于5，那么就表示这台机器的性能有严重问题。对于 上面的例子来说，假设系统有两个CPU，那么其每个CPU的当前任务数为：0.90/2=0.45。这表示该系统的性能是良好的。&lt;/p&gt;
&lt;h3 id=&#34;vmswappiness&#34;&gt;vm.swappiness&lt;/h3&gt;
&lt;p&gt;Linux 会使用硬盘的一部分作为 Swap 分区，用来进行进程的调度。如果内存够大，应当告诉 Linux 不必太多地使用 Swap 分区，可以通过修改 swappiness 的数值实现。&lt;/p&gt;
&lt;p&gt;swappiness=0 的时候表示最大限度地使用物理内存，然后才是 swap 空间；&lt;/p&gt;
&lt;p&gt;swappiness=100 的时候表示积极地使用 swap 分区，并且把内存上的数据及时地搬运到 swap 空间里面。&lt;/p&gt;
&lt;p&gt;在 Linux 中，swappiness 的默认值为：60&lt;/p&gt;
&lt;h3 id=&#34;procstat-文件-内容含义&#34;&gt;/proc/stat 文件 内容含义&lt;/h3&gt;
&lt;p&gt;文件内容为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cpu  38612618 56617 34286154 1463872231 372072760 0 957390 9312034 0 0
cpu0 10354076 16022 9826771 452299838 4246512 0 72999 2704956 0 0
cpu1 9711715 13481 9043388 455113973 3912957 0 57785 2331301 0 0
cpu2 9036808 12888 8220419 101656754 360163130 0 47335 1991839 0 0
cpu3 9510018 14225 7195574 454801665 3750159 0 779269 2283936 0 0
intr 8888957117 132 9 0 0 0 0 3 0 0 0 0 24 126 0 0 4364057 0 0 0 0 0 0 0 0 0 0 557138249 2 5427 0 5427157 0 3141694 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
ctxt 15656962072
btime 1528977806
processes 17976269
procs_running 2
procs_blocked 1
softirq 3416731289 3 1574245130 526818 783196686 2384220 0 202 386807575 0 669570655
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;表示的是CPU总的使用情况，从左向右分别表示user，nice，system，idle，iowait，irq和softirq&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;user：处于用户态的运行时间，不包含nice值为负的进程。&lt;/li&gt;
&lt;li&gt;nice：nice值为负的进程所占用的CPU时间。&lt;/li&gt;
&lt;li&gt;system：处于内核态的运行时间。&lt;/li&gt;
&lt;li&gt;idle：除IO等待时间以外的其他等待时间。&lt;/li&gt;
&lt;li&gt;iowait：io等待时间&lt;/li&gt;
&lt;li&gt;irq：硬中断时间&lt;/li&gt;
&lt;li&gt;softirq：软中断时间&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以上所有时间均是从系统启动开始累计到当前时刻，单位为：jiffies（jiffies是内核中的一个全局变量，用来记录自系统启动以来产生的节拍数。在linux中，一个节拍大致可以理解为操作系统进程调度的最小时间片，不同的linux内核，值可能不同，通常在1ms~10ms之间）&lt;/p&gt;
&lt;h3 id=&#34;-和--的区别&#34;&gt;~ 和 / 的区别&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;/&lt;/code&gt; 是目录层的分隔、表示符。只有一个 &lt;code&gt;/&lt;/code&gt; 表明是根目录， &lt;code&gt;/etc/&lt;/code&gt; 表明是根目录下面的 &lt;code&gt;etc&lt;/code&gt; 目录。当然目录最后不需要 &lt;code&gt;/&lt;/code&gt; ，但有 &lt;code&gt;/&lt;/code&gt; 直接表明他是目录，没有末尾的 &lt;code&gt;/&lt;/code&gt; ，那么 &lt;code&gt;/etc&lt;/code&gt; 需要检测一下确定是目录还是文件，虽然习惯上 &lt;code&gt;/etc&lt;/code&gt; 绝对是目录。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;~&lt;/code&gt; 是一个代位符，表明的是个人目录的地址，因为每个用户都有自己的个人目录地址，所以用 &lt;code&gt;~&lt;/code&gt; 作为统一替代这个根据用户不同而不同但有规可循的地址，来保证某些情况下的兼容问题。&lt;/p&gt;
&lt;h3 id=&#34;单引号双引号反引号&#34;&gt;单引号、双引号、反引号&lt;/h3&gt;
&lt;p&gt;1、由单引号括起来的字符都作为普通字符出现。特殊字符用单引号括起来以后，也会失去原有意义，而只作为普通字符解释。&lt;/p&gt;
&lt;p&gt;2、由双引号括起来的字符，除$（美元符号）、\（反斜杠）、’（单引号）、和”（双引号）这几个字符仍是特殊字符并保留其特殊功能外，其余字符仍作为普通字符对待。对于“$”来说，就是用其后指定的变量的值来代替这个变量和$；对于“\”而言，是转义字符，它告诉shell不要对其后面的那个字符进行特殊处理，只当作普通字符即可。可以想见，在双引号中需要在前面加上“\”的只有四个字符$，\，’和”本身。而对”号，若其前面没有加“\”，则Shell会将它同前一个”号匹配。&lt;/p&gt;
&lt;p&gt;把双引号内的内容输出出来，如果内容中有命令、变量等，会先把变量、命令解析出结果，然后再输出最终的内容来。&lt;/p&gt;
&lt;p&gt;3、反引号（`）这个字符所对应的键一般位于键盘的左上角，不要将其同单引号（’）混淆。反引号括起来的字符串被shell解释为命令行，在执行时，shell首先执行该命令行，并以它的标准输出结果取代整个反引号（包括两个反引号）部分。&lt;/p&gt;
&lt;p&gt;4、反引号还可以嵌套使用。但需注意，嵌套使用时内层的反引号必须用反斜杠（\）将其转义。&lt;/p&gt;
&lt;p&gt;5、在反引号之间的命令行中也可以使用shell的特殊字符。Shell为得到&lt;code&gt;中命令的结果，它实际上要去执行&lt;/code&gt;中指定的命令。执行时，命令中的特殊字符，如$，”，?等又将具有特殊含义，并且``所包含的可以是任何一个合法的Shell命令。&lt;/p&gt;
&lt;h3 id=&#34;带双引号和不带双引号的区别&#34;&gt;带双引号和不带双引号的区别：&lt;/h3&gt;
&lt;p&gt;把双引号内的内容输出出来，如果内容中有命令、变量等，会先把变量、命令解析出结果，然后再输出最终的内容来。&lt;/p&gt;
&lt;p&gt;对于 bash 来说&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo $1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;看上去是 打印第一个参数，其实是 把第一个参数按照空格、制表符、换行符等符号来分割开，然后把这些分割后的每一项再按 glob 模式展开，最后把这些值，再用一个空格重新连接起来并打印出来。&lt;/p&gt;
&lt;p&gt;如果 第一个参数 碰巧就是 用一个空格连接的，且没有包含这些 glob 模式，那看上去就是原样输出，其实是转换以后没有发生变化。&lt;/p&gt;
&lt;h3 id=&#34;字符串相关操作&#34;&gt;字符串相关操作&lt;/h3&gt;
&lt;p&gt;判断读取字符串值&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;表达式&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;${var}&lt;/td&gt;
&lt;td&gt;变量var的值, 与$var相同&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${var-DEFAULT}&lt;/td&gt;
&lt;td&gt;如果var没有被声明, 那么就以$DEFAULT作为其值 *&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${var:-DEFAULT}&lt;/td&gt;
&lt;td&gt;如果var没有被声明, 或者其值为空, 那么就以$DEFAULT作为其值 *&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${var=DEFAULT}&lt;/td&gt;
&lt;td&gt;如果var没有被声明, 那么就以$DEFAULT作为其值 *&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${var:=DEFAULT}&lt;/td&gt;
&lt;td&gt;如果var没有被声明, 或者其值为空, 那么就以$DEFAULT作为其值 *&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${var+OTHER}&lt;/td&gt;
&lt;td&gt;如果var声明了, 那么其值就是$OTHER, 否则就为null字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${var:+OTHER}&lt;/td&gt;
&lt;td&gt;如果var被设置了, 那么其值就是$OTHER, 否则就为null字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${var?ERR_MSG}&lt;/td&gt;
&lt;td&gt;如果var没被声明, 那么就打印$ERR_MSG *&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${var:?ERR_MSG}&lt;/td&gt;
&lt;td&gt;如果var没被设置, 那么就打印$ERR_MSG *&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;字符串操作&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;表达式&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;${#string}&lt;/td&gt;
&lt;td&gt;$string的长度&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string:position}&lt;/td&gt;
&lt;td&gt;在$string中, 从位置$position开始提取子串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string:position:length}&lt;/td&gt;
&lt;td&gt;在$string中, 从位置$position开始提取长度为$length的子串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string#substring}&lt;/td&gt;
&lt;td&gt;从变量$string的开头, 删除最短匹配$substring的子串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string##substring}&lt;/td&gt;
&lt;td&gt;从变量$string的开头, 删除最长匹配$substring的子串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string%substring}&lt;/td&gt;
&lt;td&gt;从变量$string的结尾, 删除最短匹配$substring的子串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string%%substring}&lt;/td&gt;
&lt;td&gt;从变量$string的结尾, 删除最长匹配$substring的子串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string/substring/replacement}&lt;/td&gt;
&lt;td&gt;使用$replacement, 来代替第一个匹配的$substring&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string//substring/replacement}&lt;/td&gt;
&lt;td&gt;使用$replacement, 代替所有匹配的$substring&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string/#substring/replacement}&lt;/td&gt;
&lt;td&gt;如果$string的前缀匹配$substring, 那么就用$replacement来代替匹配到的$substring&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${string/%substring/replacement}&lt;/td&gt;
&lt;td&gt;如果$string的后缀匹配$substring, 那么就用$replacement来代替匹配到的$substring&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${varible##*string}&lt;/td&gt;
&lt;td&gt;从左向右截取最后一个string后的字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${varible#*string}&lt;/td&gt;
&lt;td&gt;从左向右截取第一个string后的字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${varible%%string*}&lt;/td&gt;
&lt;td&gt;从右向左截取最后一个string后的字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;${varible%string*}&lt;/td&gt;
&lt;td&gt;从右向左截取第一个string后的字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;例如，对于str=10.10.24.171:5000/xdhuxc/nginx&lt;/p&gt;
&lt;p&gt;${str##*/} ==&amp;gt; nginx&lt;/p&gt;
&lt;p&gt;${str#*/} ==&amp;gt; xdhuxc/nginx&lt;/p&gt;
&lt;p&gt;${str//10.10.24.171/192.168.244.128} ==&amp;gt; 192.168.244.128:5000/xdhuxc/nginx&lt;/p&gt;
&lt;h3 id=&#34;cp&#34;&gt;\cp&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;cp&lt;/code&gt; 命令默认是不会提示 &lt;code&gt;overwrite?&lt;/code&gt; 的，但是 &lt;code&gt;cp&lt;/code&gt; 的 &lt;code&gt;-i&lt;/code&gt; 选项会提示，而一般 &lt;code&gt;Linux&lt;/code&gt; 的启动文件 &lt;code&gt;~/.bashrc&lt;/code&gt; 中会把 &lt;code&gt;cp&lt;/code&gt; 命名成&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;alias cp=&amp;#39;cp -i&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这样在 &lt;code&gt;Linux&lt;/code&gt; 下输入 &lt;code&gt;cp&lt;/code&gt; 命令实际上运行的是 &lt;code&gt;cp -i&lt;/code&gt;，加上一个 &lt;code&gt;\&lt;/code&gt; 符号就是让此次的 &lt;code&gt;cp&lt;/code&gt; 命令不使用别名 &lt;code&gt;cp -i&lt;/code&gt; 运行，就不会有 &lt;code&gt;overwrite?&lt;/code&gt; 的提示了&lt;/p&gt;
&lt;h3 id=&#34;文件测试运算符&#34;&gt;文件测试运算符&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;文件测试运算符用于检测Unix文件的各种属性&lt;/p&gt;
&lt;/blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;操作符&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;-b file&lt;/td&gt;
&lt;td&gt;检测文件是否是块设备文件，如果是，则返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-c file&lt;/td&gt;
&lt;td&gt;检测文件是否是字符设备文件，如果是，则返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-d file&lt;/td&gt;
&lt;td&gt;检测文件是否是目录，如果是，则返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-f file&lt;/td&gt;
&lt;td&gt;检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-w file&lt;/td&gt;
&lt;td&gt;检测文件是否可写，如果是，则返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-x file&lt;/td&gt;
&lt;td&gt;检测文件是否可执行，如果是，则返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-r file&lt;/td&gt;
&lt;td&gt;检测文件是否可读，如果是，则返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-s file&lt;/td&gt;
&lt;td&gt;检测文件是否为空（文件大小是否大于0），不为空返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-e file&lt;/td&gt;
&lt;td&gt;检测文件（包括目录）是否存在，如果是，则返回 true&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;文件颜色的含义&#34;&gt;文件颜色的含义&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;在Linux命令行中，文件和目录的颜色有特殊的含义&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、白色，表示普通文件&lt;/p&gt;
&lt;p&gt;2、蓝色，表示目录&lt;/p&gt;
&lt;p&gt;3、绿色，表示可执行文件&lt;/p&gt;
&lt;p&gt;4、红色，表示压缩文件&lt;/p&gt;
&lt;p&gt;5、浅蓝色，表示链接文件&lt;/p&gt;
&lt;p&gt;6、黄色，表示设备文件&lt;/p&gt;
&lt;p&gt;7、灰色，表示其他文件&lt;/p&gt;
&lt;p&gt;8、红色闪烁，表示链接的文件有问题&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>MySQL 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-questions-and-solutions/</guid>
                <pubDate>Wed, 01 Aug 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了一些使用 MySQL 过程中常见的问题及解决方式，留作后查。&lt;/p&gt;
&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、能看到数据库和表，但是select时报不存在&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; select * from sys_prompt limit 5;
ERROR 1146 (42S02): Table &amp;#39;xdhuxc.sys_prompt&amp;#39; doesn&amp;#39;t exist
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql&amp;gt; drop database yhtdb;
ERROR 1010 (HY000): Error dropping database (can&amp;#39;t rmdir &amp;#39;./yhtdb&amp;#39;, errno: 39)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：在&lt;code&gt;/var/lib/mysql&lt;/code&gt;下，删除该数据库对应的目录，重新导入sql文件。&lt;/p&gt;
&lt;p&gt;2、 mysql 服务启动失败
可能原因：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;1、可能是端口号被占用。
2、可能是 mysql 配置文件修改错误，导致某些配置参数名称错误。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、向数据库表中插入数据时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;(1265, &amp;#34;Data truncated for column &amp;#39;income&amp;#39; at row 1&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;数据库表定义时，定义的字段 income 长度太短，更改该数据类型，增大其长度。&lt;/p&gt;
&lt;p&gt;4、在 Mac 上安装的 MySQL 8.0.1，使用 DbVisualizer 连接时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Product: DbVisualizer Free 10.0.17 [Build &lt;span class=&#34;ni&#34;&gt;#2882&lt;/span&gt;]
OS: Mac OS X
OS Version: 10.14.3
OS Arch: x86_64
Java Version: 1.8.0_191
Java VM: Java HotSpot(TM) 64-Bit Server VM
Java Vendor: Oracle Corporation
Java Home: /Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home
DbVis Home: /Applications/DbVisualizer.app/Contents/Resources/app
User Home: /Users/wanghuan
PrefsDir: /Users/wanghuan/.dbvis
SessionId: 112
BindDir: null

An error occurred while establishing the connection:

Long Message:
Unable to load authentication plugin &amp;#39;caching_sha2_password&amp;#39;.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：使用 root 用户登录进去，执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER USER &amp;#39;root&amp;#39;@&amp;#39;localhost&amp;#39; IDENTIFIED WITH mysql_native_password BY &amp;#39;root@20190322&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、连接 MySQL 时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Long Message:
Access denied for user &amp;#39;root&amp;#39;@&amp;#39;localhost&amp;#39; (using password: YES)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：可能是 mysql 密码配置错误，重新修改 mysql 密码。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;use mysql;
ALTER USER &amp;#39;root&amp;#39;@&amp;#39;localhost&amp;#39; IDENTIFIED WITH mysql_native_password BY &amp;#39;wh19940423&amp;#39;;
flush privileges;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、更新数据时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Error 1062: Duplicate entry &amp;#39;23viewer12fgdfdsgsd&amp;#39; for key &amp;#39;name&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;检查数据库，确实没有重复的名称，删除数据库表，重新创建表结构。&lt;/p&gt;
&lt;p&gt;7、使用 GORM 框架时，插入含时间戳类型的结构体字段时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Error 1292: Incorrect datetime value: &amp;#39;0000-00-00&amp;#39; for column &amp;#39;create_time&amp;#39; at row 1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因：时间戳类型字段 CreateTime，UpdateTime 没有赋值，导致类型为 datetime类型，从而报错。&lt;/p&gt;
&lt;p&gt;8、使用用户名和密码连接 MySQL 时，可能会报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Unable to load authentication plugin &amp;#39;caching_sha2_password&amp;#39;.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这是 mysql 5.x 和 8.x 的区别，5.x 版本的认证插件是：default_authentication_plugin=mysql_native_password，8.x 的认证插件是：default_authentication_plugin=caching_sha2_password。&lt;/p&gt;
&lt;p&gt;mysql 驱动已经更新适配了caching_sha2_password 的密码规则，升级到最新版本即可。&lt;/p&gt;
&lt;p&gt;9、使用用户名和密码连接 MySQL 时，可能会报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;public key retrieval is not allowed
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在连接 MySQL 的参数中，设置 &lt;code&gt;allowPublicKeyRetrieval=true&lt;/code&gt;，如果用户使用了 sha256_password 认证，密码在传输过程中必须使用 TLS 协议保护，但是如果 RSA 公钥不可用，可以使用服务器提供的公钥；可以在连接中通过 ServerRSAPublicKeyFile 指定服务器的 RSA 公钥，或者AllowPublicKeyRetrieval=True参数以允许客户端从服务器获取公钥；但是需要注意的是 AllowPublicKeyRetrieval=True可能会导致恶意的代理通过中间人攻击(MITM)获取到明文密码，所以默认是关闭的，必须显式开启。&lt;/p&gt;
&lt;p&gt;参考：https://mysqlconnector.net/connection-options/&lt;/p&gt;
&lt;p&gt;10、我们在一个 for 循环中，对于每一个元素，启动一个 golang 协程去操作数据库，日志中报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[2020-08-08 11:12:28]  [0.13ms]  DELETE FROM &lt;span class=&#34;sb&#34;&gt;`messages`&lt;/span&gt;  WHERE (isCurrentUpdate = false)  
[0 rows affected or returned ] 
[mysql] 2020/08/08 11:12:28 packets.go:446: busy buffer
[mysql] 2020/08/08 11:12:28 packets.go:427: busy buffer

(/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/xdhuxc-message/src/service/message.go:246) 
[2020-08-08 11:12:28]  driver: bad connection 
ERRO[2020-08-08 11:12:28]/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/xdhuxc-message/src/service/message.go:247 github.com/xdhuxc/xdhuxc-message/src/service.(*messageService).message() 删除数据时出错，错误为：driver: bad connection 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这是由于程序执行太快，可用连接不足导致的，增大程序可以打开的最大连接数，适当减慢程序运行。&lt;/p&gt;
&lt;p&gt;具体代码实现如下：
1、将程序可以打开的连接数增大&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;db.DB().SetMaxOpenConns(5000)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、减慢程序运行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;for _, stock := range stocks {	
	time.Sleep(50*time.Millisecond)

	go func(user model.User) {}	
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>MySQL 常用命令</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-common-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-common-command/</guid>
                <pubDate>Sun, 29 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了一些 MySQL 常用命令，方便查找。&lt;/p&gt;
&lt;h3 id=&#34;数据库管理命令&#34;&gt;数据库管理命令&lt;/h3&gt;
&lt;p&gt;1、显示当前 MySQL 的连接数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;show processlist
或
show full processlist
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、显示 MySQL 的环境变量&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;show variables
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查找最大连接数或服务器响应的最大连接数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;show variables like &amp;#34;%conn%&amp;#34;
或
show global status like &amp;#39;Max_used_connections&amp;#39; # 查询服务器响应的最大连接数
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、临时设置最大连接数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;set global max_connections=200  # 在 mysql 终端中临时设置最大连接数为：200
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者在 /etc/my.cnf 中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[mysqld]
max_connections=200
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、查询缓存的参数说明&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;show global variables like &amp;#34;query_cache%&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、查询 MySQL 运行产生的状态值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;show global status like &amp;#39;qcache%&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、采用直接重置 autoIncrement 值的方法重置 auto_increment&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;alter table marathon auto_increment = 1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、查询数据库权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;show grants for &amp;#39;root&amp;#39;@&amp;#39;localhost&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;字段操作&#34;&gt;字段操作&lt;/h3&gt;
&lt;p&gt;1、修改字段类型&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; MODIFY COLUMN name varchar(30)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、修改字段类型&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; CHANGE COLUME name SET DEFAULT NULL
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、修改字段的数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;UPDATE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; SET name=&amp;#39;wangxin&amp;#39;, age=24 WHERE user_id=13
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、增加新字段&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; ADD &lt;span class=&#34;sb&#34;&gt;`country`&lt;/span&gt; varchar(20) NOT NULL
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、删除字段&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; DROP COLUMN &lt;span class=&#34;sb&#34;&gt;`country`&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;键操作&#34;&gt;键操作&lt;/h3&gt;
&lt;p&gt;1、查询某张表中存在的键&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;SELECT * FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE t WHERE t.TABLE_NAME =&amp;#39;users&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、添加唯一键&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; ADD UNIQUE KEY &lt;span class=&#34;sb&#34;&gt;`name`&lt;/span&gt; (`name`)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、删除唯一键&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; DROP INDEX &lt;span class=&#34;sb&#34;&gt;`name`&lt;/span&gt;
ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; ADD UNIQUE INDEX iam_cloud_uk (`name`, &lt;span class=&#34;sb&#34;&gt;`display_name`&lt;/span&gt;) # 注意，主键名中不能包含中划线
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、添加主键&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; ADD PRIMARY KEY &lt;span class=&#34;sb&#34;&gt;`id`&lt;/span&gt; (`id`)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、删除主键&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ALTER TABLE &lt;span class=&#34;sb&#34;&gt;`users`&lt;/span&gt; DROP PRIMARY KEY
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;数据导出命令&#34;&gt;数据导出命令&lt;/h3&gt;
&lt;p&gt;1、导出数据库中的数据表结构及数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysqldump -uroot -pAdmin369 xdhuxc &amp;gt; /tmp/xdhuxc.sql
或
mysqldump -uroot -p xdhuxc &amp;gt; /tmp/xdhuxc.sql，敲回车后，会提示输入密码
或
mysqldump -uroot xdhuxc &amp;gt; /tmp/xdhuxc.sql，敲回车后，会提示输入密码
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、导出数据库表结构&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-d，--no-data，不导出表数据，只导出表结构。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysqldump -uroot -pAdmin369 -d xdhuxc &amp;gt; /tmp/xdhuxc.sql
或
mysqldump -uroot -p -d xdhuxc &amp;gt; /tmp/xdhuxc.sql，敲回车后，会提示输入密码
或
mysqldump -uroot -d xdhuxc &amp;gt; /tmp/xdhuxc.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、导出数据库表数据&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-t，--no-create-info，不包含创建表的信息，只导出表数据&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysqldump -uroot -pAdmin369 -t xdhuxc &amp;gt; /tmp/xdhuxc.sql
或
mysqldump -uroot -p -t xdhuxc &amp;gt; /tmp/xdhuxc.sql，敲回车后，会提示输入密码
或
mysqldump -uroot -t xdhuxc &amp;gt; /tmp/xdhuxc.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、导出指定表的数据或信息&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;参考上面的命令，在数据库名称后面加上表名称即可。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysqldump -uroot -pAdmin369  -t xdhuxc users &amp;gt; /tmp/xdhuxc_users.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;数据导入命令&#34;&gt;数据导入命令&lt;/h3&gt;
&lt;p&gt;1、在命令行 &lt;code&gt;mysql&amp;gt; &lt;/code&gt; 中使用命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;source mysql_script_path
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、将sql脚本导入MySQL数据库&lt;/p&gt;
&lt;p&gt;1）创建一个空数据库，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;create database xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）将表结构和数据导入数据库&lt;/p&gt;
&lt;p&gt;方式一：使用 &lt;code&gt;source&lt;/code&gt; 命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;use database_name             # 选择数据库
set names utf8                # 设置数据库编码
source /tmp/database_name.sql # 导入数据库表结构和数据
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;方式二：直接使用命令实现，使用命令为：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;使用–default-character-set = utf8指定编码以避免出现乱码。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mysql -u user_name -p password database_name &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt; /tmp/database_name.sql –default-character-set = utf8
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;查询命令&#34;&gt;查询命令&lt;/h3&gt;
&lt;p&gt;1、排除某些字符开头的数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;  select * from users where left(email, 6) &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;&amp;gt; &amp;#34;intern&amp;#34; and is_deleted=false and left(email, 6) &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;&amp;gt; &amp;#34;nomail&amp;#34;;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 left(args1, args2) 函数来实现，args1 表示数据库表字段，args2 表示从该字段起几个字符&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>MongoDB 数据库初步使用</title>
                <link>https://xdhuxc.github.io/posts/storage/mongodb/mongodb-simple-use/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mongodb/mongodb-simple-use/</guid>
                <pubDate>Fri, 20 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;安装好 MongoDB 数据库后，接下来我们演示下通过命令行来操纵 MongoDB 数据库。&lt;/p&gt;
&lt;h3 id=&#34;配置文件参数修改&#34;&gt;配置文件参数修改&lt;/h3&gt;
&lt;p&gt;MongoDB 数据库的配置文件为：&lt;code&gt;/etc/mongod.conf&lt;/code&gt;。
为了使外部应用能够连接本机（使用 VMware Workstation 创建的虚拟机）安装的 MongoDB 数据库，需要修改 &lt;code&gt;/etc/mongod.conf&lt;/code&gt; 文件中的 &lt;code&gt;127.0.0.1&lt;/code&gt; 为本机IP地址。比如，修改&lt;code&gt;127.0.0.1&lt;/code&gt; 为本虚拟机IP地址 &lt;code&gt;192.168.91.128&lt;/code&gt;，连接端口保持默认的 &lt;code&gt;27017&lt;/code&gt; 即可，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# network interfaces
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;net:
  port: 27017
  bindIp: 192.168.91.128  # Enter 0.0.0.0,:: to bind to all IPv4 and IPv6 addresses or, alternatively, use the net.bindIpAll setting.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;使用-mongodb-shell-操作数据库&#34;&gt;使用 MongoDB shell 操作数据库&lt;/h3&gt;
&lt;h5 id=&#34;连接-mongodb-数据库&#34;&gt;连接 MongoDB 数据库&lt;/h5&gt;
&lt;p&gt;使用的命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mongo --host 192.168.91.128 --port 27017
或者
mongo --host 192.168.91.128 # 由于使用 mongodb的默认端口，可以省略对端口的指定。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# mongo --host 192.168.91.128 -p 27017
MongoDB shell version v3.7.9-27-g793e59f
connecting to: mongodb://192.168.91.128:27017/
MongoDB server version: 3.7.9-27-g793e59f
Server has startup warnings:
2018-05-30T21:51:01.053+0800 I CONTROL  [initandlisten]
2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt; NOTE: This is a development version (3.7.9-27-g793e59f) of MongoDB.
2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;       Not recommended for production.
2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten]
2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt; WARNING: Access control is not enabled for the database.
2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;          Read and write access to data and configuration is unrestricted.
2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten]
2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten]
2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt; WARNING: /sys/kernel/mm/transparent_hugepage/enabled is &amp;#39;always&amp;#39;.
2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;        We suggest setting it to &amp;#39;never&amp;#39;
2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten]
2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt; WARNING: /sys/kernel/mm/transparent_hugepage/defrag is &amp;#39;always&amp;#39;.
2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;        We suggest setting it to &amp;#39;never&amp;#39;
2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten]
&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;创建数据库&#34;&gt;创建数据库&lt;/h5&gt;
&lt;p&gt;使用如下命令创建数据库：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;use database_name
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;具体操作如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;show dbs       # 显示数据库列表。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;admin   0.000GB
config  0.000GB
local   0.000GB
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;use xdhuxc     # 创建数据库并切换至该数据库。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;switched to db xdhuxc
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;show dbs       # 再次显示数据库列表，却发现创建的数据库 xdhuxc 不在列表中。要显示新建的数据库，需要至少插入一个文档，空的数据库是不显示出来的。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;admin   0.000GB
config  0.000GB
local   0.000GB
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db             # 显示当前数据库。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 MongoDB 中，默认的数据库是 &lt;code&gt;test&lt;/code&gt;，如果没有创建任何数据库，那么创建的集合和文档将存储在 &lt;code&gt;test&lt;/code&gt; 数据库中。&lt;/p&gt;
&lt;h5 id=&#34;创建集合&#34;&gt;创建集合&lt;/h5&gt;
&lt;p&gt;在创建的 &lt;code&gt;xdhuxc&lt;/code&gt; 数据库中创建 &lt;code&gt;person&lt;/code&gt; 集合，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;use xdhuxc
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;switched to db xdhuxc
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db                            # 显示当前数据库。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;xdhuxc
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.createCollection(&amp;#34;person&amp;#34;) # 在数据库 xdhuxc 中创建集合 person。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;{ &amp;#34;ok&amp;#34; : 1 }
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;show collections              # 显示当前数据库中的集合。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;person
&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;插入数据&#34;&gt;插入数据&lt;/h5&gt;
&lt;p&gt;要将数据插入到 MongoDB 集合中，可以使用 MongoDB 的 &lt;code&gt;insert()&lt;/code&gt; 方法，其基本语法如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;db.collection_name.insert(document)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;向 &lt;code&gt;xdhuxc&lt;/code&gt; 数据库的 &lt;code&gt;person&lt;/code&gt; 集合中插入数据，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.person.insert({              # 插入一条记录，文档以json的格式定义。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;     name : &amp;#34;xiaoming&amp;#34;,
     age : &amp;#34;24&amp;#34;,
     company : &amp;#34;xdhuxc company&amp;#34;
})
WriteResult({ &amp;#34;nInserted&amp;#34; : 1 })
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;person&lt;/code&gt; 为集合的名称，如果集合中不存在 &lt;code&gt;person&lt;/code&gt; 集合，那么 MongoDB 将创建该集合，然后将文档插入该集合中。
在插入的文档中，如果不指定_id参数，那么MongoDB会为此文档分配一个唯一的ObjectId。_id为集合中每个文档唯一的12个字节的十六进制数，12个字节划分如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;_id: ObjectId(4 bytes timestamp, 3 bytes machine id, 2 bytes process id,
   3 bytes incrementer)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查询所有文档，将以非结构化方式显示所有文档。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.person.find()
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;{ &amp;#34;_id&amp;#34; : ObjectId(&amp;#34;5b0f384f244fc0152ed71f5f&amp;#34;), &amp;#34;name&amp;#34; : &amp;#34;xiaoming&amp;#34;, &amp;#34;age&amp;#34; : &amp;#34;24&amp;#34;, &amp;#34;company&amp;#34; : &amp;#34;xdhuxc company&amp;#34; }
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;再插入一条数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.person.insert({
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;     name : &amp;#34;dalong&amp;#34;,
     age : &amp;#34;29&amp;#34;,
     company : &amp;#34;Apple company&amp;#34;
})
WriteResult({ &amp;#34;nInserted&amp;#34; : 1 })
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.person.find()
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;{ &amp;#34;_id&amp;#34; : ObjectId(&amp;#34;5b0f384f244fc0152ed71f5f&amp;#34;), &amp;#34;name&amp;#34; : &amp;#34;xiaoming&amp;#34;, &amp;#34;age&amp;#34; : &amp;#34;24&amp;#34;, &amp;#34;company&amp;#34; : &amp;#34;xdhuxc company&amp;#34; }
{ &amp;#34;_id&amp;#34; : ObjectId(&amp;#34;5b0f3aa0244fc0152ed71f60&amp;#34;), &amp;#34;name&amp;#34; : &amp;#34;dalong&amp;#34;, &amp;#34;age&amp;#34; : &amp;#34;29&amp;#34;, &amp;#34;company&amp;#34; : &amp;#34;Apple company&amp;#34; }
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;接下来，插入一条结构不相同的数据&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.person.insert({
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;     name : &amp;#34;dalong&amp;#34;,
     age : &amp;#34;29&amp;#34;,
     company : &amp;#34;Apple company&amp;#34;,
     address : &amp;#34;Beijing&amp;#34;
})
WriteResult({ &amp;#34;nInserted&amp;#34; : 1 })
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.person.find()
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;{ &amp;#34;_id&amp;#34; : ObjectId(&amp;#34;5b0f384f244fc0152ed71f5f&amp;#34;), &amp;#34;name&amp;#34; : &amp;#34;xiaoming&amp;#34;, &amp;#34;age&amp;#34; : &amp;#34;24&amp;#34;, &amp;#34;company&amp;#34; : &amp;#34;xdhuxc company&amp;#34; }
{ &amp;#34;_id&amp;#34; : ObjectId(&amp;#34;5b0f3aa0244fc0152ed71f60&amp;#34;), &amp;#34;name&amp;#34; : &amp;#34;dalong&amp;#34;, &amp;#34;age&amp;#34; : &amp;#34;29&amp;#34;, &amp;#34;company&amp;#34; : &amp;#34;Apple company&amp;#34; }
{ &amp;#34;_id&amp;#34; : ObjectId(&amp;#34;5b0f3aeb244fc0152ed71f61&amp;#34;), &amp;#34;name&amp;#34; : &amp;#34;dalong&amp;#34;, &amp;#34;age&amp;#34; : &amp;#34;29&amp;#34;, &amp;#34;company&amp;#34; : &amp;#34;Apple company&amp;#34;, &amp;#34;address&amp;#34; : &amp;#34;Beijing&amp;#34; }
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看出，在 MongoDB 中，是以文档的形式来组织非结构化数据的，文档的结构可由使用者自己定义，和 关系型数据库有很大的区别。&lt;/p&gt;
&lt;h5 id=&#34;删除文档&#34;&gt;删除文档&lt;/h5&gt;
&lt;p&gt;使用如下命令删除文档：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.person.remove({})            # 删除集合 person 中的所有文档
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;WriteResult({ &amp;#34;nRemoved&amp;#34; : 3 })
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.person.find()                # 再次查询所有文档，已经在上一步全部删除了，所以没有结果返回。
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;删除数据库&#34;&gt;删除数据库&lt;/h5&gt;
&lt;p&gt;① 切换到待删除数据库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;show dbs
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;admin   0.000GB
config  0.000GB
local   0.000GB
xdhuxc  0.000GB
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;use xdhuxc
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;switched to db xdhuxc
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;② 删除当前数据库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;db.dropDatabase()
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;{ &amp;#34;dropped&amp;#34; : &amp;#34;xdhuxc&amp;#34;, &amp;#34;ok&amp;#34; : 1 }
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;③ 查看删除结果&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;show dbs
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;admin   0.000GB
config  0.000GB
local   0.000GB
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到，数据库 xdhuxc 已经被删除。&lt;/p&gt;
&lt;h3 id=&#34;官方文档&#34;&gt;官方文档&lt;/h3&gt;
&lt;p&gt;MongoDB 的官方文档网址：http://www.mongoing.com/docs/mongo.html&lt;/p&gt;
&lt;p&gt;更多详细的有关 MongoDB的知识，大家可以去 MongoDB 的官方网站学习。&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mongodb/">MongoDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 docker 容器方式部署 FastDFS</title>
                <link>https://xdhuxc.github.io/posts/storage/fastdfs/fastdfs-docker/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/fastdfs/fastdfs-docker/</guid>
                <pubDate>Fri, 20 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了使用 docker 容器方式部署 FastDFS 的方法。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在 &lt;code&gt;/home/xdhuxc/fastdfs/&lt;/code&gt; 目录下创建 &lt;code&gt;tracker&lt;/code&gt;，&lt;code&gt;conf&lt;/code&gt;，&lt;code&gt;storage/data&lt;/code&gt;，&lt;code&gt;store_path&lt;/code&gt; 目录。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、拉取 fastdfs 镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull season/fastdfs:1.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动 tracker 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    -p 22122:22122 \
    --net host \
    -v /home/xdhuxc/fastdfs/tracker:/fastdfs/tracker/data \
    -v /home/xdhuxc/fastdfs/conf:/fdfs_conf \
    --name fastdfs-tracker \
    season/fastdfs:1.2 tracker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 storage 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --net host \
    -v /home/xdhuxc/fastdfs/storage/data:/fastdfs/storage \
    -v /home/xdhuxc/fastdfs/store_path:/fastdfs/store_path \
    -e TRACKER_SERVER=192.168.244.128:22122 \
    --name fastdfs-storage \
    season/fastdfs:1.2 storage
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;容器内配置文件目录为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/fdfs_conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、测试程序见 &lt;a href=&#34;mailto:git@github.com&#34;&gt;git@github.com&lt;/a&gt;:xdhuxc/integration.git&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/fastdfs/">FastDFS</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>GitLab 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/mixed/git/git-gitlab/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/git/git-gitlab/</guid>
                <pubDate>Thu, 19 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了使用 GitLab 时遇到的若干问题及解决方法，以备后需。&lt;/p&gt;
&lt;h3 id=&#34;使用指南&#34;&gt;使用指南&lt;/h3&gt;
&lt;p&gt;1、在 &lt;code&gt;Jenkins&lt;/code&gt; 中编写 &lt;code&gt;shell&lt;/code&gt; 脚本拉取公司 &lt;code&gt;GitLab&lt;/code&gt; 中的代码，会缺少拉取权限，由管理员操作，点击 &lt;code&gt;设置&lt;/code&gt; -&amp;gt; &lt;code&gt;仓库&lt;/code&gt; -&amp;gt; &lt;code&gt;部署秘钥&lt;/code&gt; -&amp;gt; &lt;code&gt;展开&lt;/code&gt;，使用 Jenkins 所在机器的 SSH 公钥创建一个 &lt;code&gt;部署秘钥&lt;/code&gt;，然后在各工程中启用之，即可获得拉取代码得权限。&lt;/p&gt;
&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、在 &lt;code&gt;GitLab&lt;/code&gt; 中某项目的 &lt;code&gt;设置&lt;/code&gt; -&amp;gt; &lt;code&gt;集成&lt;/code&gt; 中配置 &lt;code&gt;Jenkins webhook&lt;/code&gt;，配置完成后点击 &lt;code&gt;Test&lt;/code&gt;，报错如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Hook execution failed: URL &#39;https://jenkins.xdhuxc.me/project/xdhuxc&#39; is blocked: Requests to the local network are not allowed
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;解决：在 &lt;code&gt;管理员区域&lt;/code&gt; 中 &lt;code&gt;设置&lt;/code&gt; 下，在 &lt;code&gt;Outbound requests&lt;/code&gt;部分，选择 &lt;code&gt;Allow requests to the local network from hooks and services&lt;/code&gt;，然后保存之。&lt;/p&gt;
&lt;p&gt;参考链接：https://gitlab.com/gitlab-org/gitlab-ce/issues/46490&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/git/">Git</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/gitlab/">Gitlab</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>MySQL 基础知识总结</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-knowledge/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-knowledge/</guid>
                <pubDate>Thu, 19 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 MySQL 的常用基础知识，可用于日常学习。&lt;/p&gt;
&lt;h3 id=&#34;mysql-主机-127001-与-localhost-的区别&#34;&gt;MySQL 主机 127.0.0.1 与 localhost 的区别&lt;/h3&gt;
&lt;p&gt;1、&lt;code&gt;mysql -h 127.0.0.1&lt;/code&gt; 的时候，使用 &lt;code&gt;TCP/IP&lt;/code&gt; 连接，&lt;code&gt;mysql&lt;/code&gt; 服务器认为该连接来自于 &lt;code&gt;127.0.0.1&lt;/code&gt; 或者是 &lt;code&gt;localhost.localdomain&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2、&lt;code&gt;mysql -h localhost&lt;/code&gt; 的时候，使用 &lt;code&gt;Unix Socket&lt;/code&gt; 连接，不是使用 &lt;code&gt;TCP/IP&lt;/code&gt; 连接，不受网络防火墙和网卡相关的的限制，此时，&lt;code&gt;mysql&lt;/code&gt; 服务器认为该客户端是来自 &lt;code&gt;localhost&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;3、mysql 权限管理中的 &lt;code&gt;localhost&lt;/code&gt; 有特定含义。&lt;/p&gt;
&lt;p&gt;虽然两者连接方式有所区别，但当 &lt;code&gt;localhost&lt;/code&gt; 为默认的 &lt;code&gt;127.0.0.1&lt;/code&gt; 时，两种连接方式使用的权限记录都是以下的1.row的记录（因为记录在前，先被匹配）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;*************************** 1. row &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;*************************
                Host: localhost
                User: root
......

&lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;************************* 2. row &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;*************************
                Host: 127.0.0.1
                User: root
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;innodb-引擎&#34;&gt;InnoDB 引擎&lt;/h4&gt;
&lt;p&gt;InnoDB 引擎为独立表空间模式，每个数据库的每个表都会生成一个数据空间。&lt;/p&gt;
&lt;p&gt;独立表空间的优点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;每个表都有自己独立的表空间。&lt;/li&gt;
&lt;li&gt;每个表的数据和索引都会存在自己的表空间中。&lt;/li&gt;
&lt;li&gt;可以实现单表在不同的数据库中移动。&lt;/li&gt;
&lt;li&gt;空间可以回收（除 drop table 操作外，表空间不能自己回收）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;独立表空间的缺点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;单表增加过大，如超过100G。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;结论：&lt;/p&gt;
&lt;p&gt;共享表空间在 insert 操作上稍有优势，其他都没独立表空间表现好。当启用独立表空间时，需要合理调整 innodb_open_files 参数的值。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 常用操作总结</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-common-operations/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-common-operations/</guid>
                <pubDate>Fri, 13 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了些 Linux 系统中的常用操作，以备后需。&lt;/p&gt;
&lt;h3 id=&#34;清理过大的-cache-内存&#34;&gt;清理过大的 cache 内存&lt;/h3&gt;
&lt;p&gt;清理过大的cache内存，系统中运行大量容器，cache过大&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/cache-1.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;/proc是一个虚拟文件系统，可以通过对它的读写操作，做为与kernel实体间进行通信的一种手段。也就是说，可以通过修改/proc中的文件，来对当前kernel的行为做出调整。我们可以通过调整/proc/sys/vm/drop_caches来释放内存。&lt;/p&gt;
&lt;p&gt;1）查看 &lt;code&gt;/proc/sys/vm/drop_caches&lt;/code&gt; 的值，默认为 &lt;code&gt;0&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/cache-2.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;2）执行sync命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sync
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;sync 命令运行 sync 子命令。如果必须停止系统，则运行 sync 命令以确保文件系统的完整性。sync 命令将所有未写的系统缓冲区写到磁盘中，包含已修改的 i-node、已延迟的块 I/O 和读写映射文件。&lt;/p&gt;
&lt;p&gt;3）将/proc/sys/vm/drop_caches的值设置为3&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo 3 &amp;gt; /proc/sys/vm/drop_caches
&lt;span class=&#34;gh&#34;&gt;#查看/proc/sys/vm/drop_caches的当前值
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cat /proc/sys/vm/drop_caches
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/cache-3.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;drop_caches 数值的含义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;echo 1 &amp;gt; /proc/sys/vm/drop_caches #仅清除页面缓存&lt;/li&gt;
&lt;li&gt;echo 2 &amp;gt; /proc/sys/vm/drop_caches #清除目录项和inode&lt;/li&gt;
&lt;li&gt;echo 3 &amp;gt; /proc/sys/vm/drop_caches #清除页面缓存，目录项和inode&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;挂载磁盘&#34;&gt;挂载磁盘&lt;/h3&gt;
&lt;p&gt;1、使用 &lt;code&gt;fdisk –l&lt;/code&gt;（查看当前系统所有硬盘及分区情况）， 找到待挂载的磁盘。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/disk.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;2、创建分区待挂载的目录，例如 &lt;code&gt;/xdhuxc&lt;/code&gt;，必须是空目录。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir /xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、格式化新建的磁盘分区。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkfs.ext4 /dev/vdb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、修改 /etc/fstab，添加如下内容，将分区信息写进去。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/dev/vdb  /xdhuxc      ext4    defaults        0 0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、执行如下命令，加载所有在fstab中记录的文件系统。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mount –a
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;打包时的文件格式转换和赋权&#34;&gt;打包时的文件格式转换和赋权&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;find ./ -regex &amp;#39;.*\.sh$&amp;#39; -or -regex &amp;#39;.*\.exp$&amp;#39; | xargs chmod 755 &amp;gt; /dev/null
find ./ -regex &amp;#39;.*\.sh$&amp;#39; -or -regex &amp;#39;.*\.exp$&amp;#39; | xargs dos2unix -q
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;使用curl不产生输出&#34;&gt;使用curl不产生输出&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -s http://www.baidu.com 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1 &amp;gt; /dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;调整进程优先级&#34;&gt;调整进程优先级&lt;/h3&gt;
&lt;h4 id=&#34;nice-命令&#34;&gt;nice 命令&lt;/h4&gt;
&lt;p&gt;nice 命令可以修改进程的优先级，进而调整进程的调度。nice 命令是在进程启动时调整进程的优先级。nice 值的范围为：[-20, 19]，-20 表示进程的最高优先级，19 表示进程的最低优先级。Linux 进程的默认 nice 值为：0。使用 nice 可调整进程的优先级，这样调度器就会依据进程优先级为其分配 CPU 资源。&lt;/p&gt;
&lt;p&gt;1、执行命令 &lt;code&gt;sleep 300 &amp;amp;&lt;/code&gt;，然后查看该进程&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/nice-1.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;没有 nice 命令，进程优先级数值为 0，进程优先级 NI 默认值为：0&lt;/p&gt;
&lt;p&gt;2、执行命令 &lt;code&gt;nice sleep 300 &amp;amp;&lt;/code&gt;，然后查看该进程&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/nice-2.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;使用 nice 命令后，优先级 NI 的数值为 10，nice 命令将 NI 默认调整为 10，降低了该进程的优先级。&lt;/p&gt;
&lt;p&gt;3、执行命令 &lt;code&gt;nice -n 15 sleep 300 &amp;amp;&lt;/code&gt;，然后查看该进程&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/nice-3.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;在默认值 0 的基础上加 15，非管理员可以将 NI 值调整为 0~19 之间的任意值，降低了进程的优先级。&lt;/p&gt;
&lt;p&gt;4、执行命令 &lt;code&gt;nice -n -15 sleep 300 &amp;amp;&lt;/code&gt;，然后查看该进程&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/nice-4.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;仅管理员可以在默认值的基础上 -n，调高进程的优先级，普通用户无权调高进程优先级。&lt;/p&gt;
&lt;p&gt;在实际应用中，如果要运行一个 CPU 密集型程序，就可以通过 nice 命令来启动它，这样可以保证其进程获得更高的优先级，即使服务器或者台式机在负载很重的情况下，也可以快速响应。&lt;/p&gt;
&lt;h4 id=&#34;renice-命令&#34;&gt;renice 命令&lt;/h4&gt;
&lt;p&gt;renice 命令可以重新调整进程执行的优先级，可以指定群组或者用户名调整进程优先级等级，并修改隶属于该群组或用户的所有程序优先级。等级范围为：[-20, 19]，同样，只有管理员可以调高优先级，用于调整运行中的进程的优先级。&lt;/p&gt;
&lt;p&gt;使用方法和 nice 相同&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/common-operations/renice.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;一个紧急进程，需要更多的 CPU 资源时，可以调高运行中的该进程。&lt;/p&gt;
&lt;h3 id=&#34;配置-centos-但需要不更新-dns&#34;&gt;配置 CentOS 但需要不更新 DNS&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;配置CentOS不更新DNS，即不刷新/etc/resolv.conf文件&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;修改配置 &lt;code&gt;/etc/NetworkManager/NetworkManager.conf&lt;/code&gt;，添加 &lt;code&gt;dns=none&lt;/code&gt;，修改完成后，使用 &lt;code&gt;systemctl restart NetworkManager&lt;/code&gt; 命令重启 &lt;code&gt;NetworkManager&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;升级-linux-内核&#34;&gt;升级 Linux 内核&lt;/h3&gt;
&lt;p&gt;1、导入ELRepo&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org (external link)
rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm (external link)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、列出可用的内核软件包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@wanghuan-private-test-5 yum.repos.d]# yum --disablerepo=&amp;#34;*&amp;#34; --enablerepo=&amp;#34;elrepo-kernel&amp;#34; list available
Loaded plugins: fastestmirror
elrepo-kernel                                                                                                                                   | 2.9 kB  00:00:00     
elrepo-kernel/primary_db                                                                                                                        | 1.8 MB  00:00:13     
Loading mirror speeds from cached hostfile
 &lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; elrepo-kernel: mirrors.tuna.tsinghua.edu.cn
Available Packages
kernel-lt.x86_64                                                                   4.4.142-1.el7.elrepo                                                   elrepo-kernel
kernel-lt-devel.x86_64                                                             4.4.142-1.el7.elrepo                                                   elrepo-kernel
kernel-lt-doc.noarch                                                               4.4.142-1.el7.elrepo                                                   elrepo-kernel
kernel-lt-headers.x86_64                                                           4.4.142-1.el7.elrepo                                                   elrepo-kernel
kernel-lt-tools.x86_64                                                             4.4.142-1.el7.elrepo                                                   elrepo-kernel
kernel-lt-tools-libs.x86_64                                                        4.4.142-1.el7.elrepo                                                   elrepo-kernel
kernel-lt-tools-libs-devel.x86_64                                                  4.4.142-1.el7.elrepo                                                   elrepo-kernel
kernel-ml.x86_64                                                                   4.17.8-1.el7.elrepo                                                    elrepo-kernel
kernel-ml-devel.x86_64                                                             4.17.8-1.el7.elrepo                                                    elrepo-kernel
kernel-ml-doc.noarch                                                               4.17.8-1.el7.elrepo                                                    elrepo-kernel
kernel-ml-headers.x86_64                                                           4.17.8-1.el7.elrepo                                                    elrepo-kernel
kernel-ml-tools.x86_64                                                             4.17.8-1.el7.elrepo                                                    elrepo-kernel
kernel-ml-tools-libs.x86_64                                                        4.17.8-1.el7.elrepo                                                    elrepo-kernel
kernel-ml-tools-libs-devel.x86_64                                                  4.17.8-1.el7.elrepo                                                    elrepo-kernel
perf.x86_64                                                                        4.17.8-1.el7.elrepo                                                    elrepo-kernel
python-perf.x86_64                                                                 4.17.8-1.el7.elrepo                                                    elrepo-kernel
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、安装最新的主线稳定内核&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum --enablerepo=elrepo-kernel install kernel-ml
yum install -y kernel-ml.x86_64 --enablerepo=elrepo-kernel
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、设置GRUB默认的内核版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;grub2-set-default 0 # 设置GRUB初始化页面的第一个内核将作为默认内核。
grub2-mkconfig -o /boot/grub2/grub.cfg # 重新创建内核配置。
reboot  # 重新启动机器才能使新内核生效。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>HTTP 的长连接和短连接</title>
                <link>https://xdhuxc.github.io/posts/common/http/http-long-and-short-connection/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/common/http/http-long-and-short-connection/</guid>
                <pubDate>Thu, 12 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 HTTP 协议中的长连接和短连接，算是 HTTP 协议中进阶的内容。&lt;/p&gt;
&lt;h4 id=&#34;http-协议与-tcpip-协议的关系&#34;&gt;HTTP 协议与 TCP/IP 协议的关系&lt;/h4&gt;
&lt;p&gt;HTTP 的长连接和短连接本质上是 TCP 的长连接和短连接。HTTP 协议属于应用层协议，在传输层使用 TCP 协议，在网络层使用 IP 协议。IP 协议主要解决网络路由和寻址问题，TCP 协议主要解决如何在 IP 层之上可靠地传输数据包，使在网络上的另一端收到发送端发出的所有包，并且接收顺序与发送顺序一致，TCP 有可靠、面向连接的特点。&lt;/p&gt;
&lt;h4 id=&#34;http-协议是无状态的&#34;&gt;HTTP 协议是无状态的&lt;/h4&gt;
&lt;p&gt;HTTP 协议是无状态的，指的是协议对于事务的处理没有记忆能力，服务端不知道客户端是什么状态。也就是说，打开一个服务器上的网页和之前打开这个服务器上的同一网页之间没有任何联系。HTTP 是一个无状态的面向连接的协议，无状态不代表 HTTP 不能保持 TCP 连接，更不能代表 HTTP 使用的是 UDP 协议（无连接的协议）&lt;/p&gt;
&lt;h4 id=&#34;长连接短连接&#34;&gt;长连接，短连接&lt;/h4&gt;
&lt;p&gt;在 HTTP/1.0 中，默认使用的是短连接。也就是说，&lt;code&gt;浏览器和服务器每进行一次 HTTP操作，就建立一次连接，但任务结束就中断连接&lt;/code&gt;。如果客户端浏览器访问的某个 HTML 或其他类型的 Web 页中包含有其他的 Web 资源，如 JavaScript文件、图像文件、CSS文件等；当浏览器每遇到这样一个 Web 资源，就会建立一个 HTTP 会话。&lt;/p&gt;
&lt;p&gt;但从 HTTP/1.1 起，默认使用长连接，用以保持连接特性。使用长连接的 HTTP 协议，会在响应头有加入这行代码：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Connection:keep-alive
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输 HTTP 数据的 TCP 连接不会关闭。如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的连接。Keep-Alive 不会永久保持连接，它有一个保持时间，可以在不同的服务器软件中设定这个时间。实现长连接要客户端和服务端都支持长连接。&lt;/p&gt;
&lt;p&gt;HTTP 协议的长连接和短连接，实质上是 TCP 协议的长连接和短连接。&lt;/p&gt;
&lt;h3 id=&#34;tcp-连接&#34;&gt;TCP 连接&lt;/h3&gt;
&lt;p&gt;当网络通信采用TCP协议时，在真正的读写操作之前，服务器与客户端之间必须建立一个连接，当读写操作完成后，双方不再需要这个连接时，它们可以释放这个连接，连接的建立是需要三次握手的，而释放则需要四次挥手，所以说每个连接的建立都是需要资源消耗和时间消耗的。&lt;/p&gt;
&lt;p&gt;经典的三次握手示意图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;C:/Users/wanghuan/Desktop/%E7%94%B5%E5%AD%90%E4%B9%A6/three_times.jpg&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;经典的四次挥手示意图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;C:/Users/wanghuan/Desktop/%E7%94%B5%E5%AD%90%E4%B9%A6/four_times.jpg&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;tcp-短连接&#34;&gt;TCP 短连接&lt;/h4&gt;
&lt;p&gt;TCP短连接的情况，客户端向服务器发起连接请求，服务器接收到请求，然后双方建立连接。客户端向服务器发送消息，服务器回应客户端，然后一次读写操作就完成了。&lt;/p&gt;
&lt;p&gt;这时候双方任何一个都可以发起close操作，不过一般都是客户端先发起close操作，因为一般的服务器不会响应完客户端后立即关闭连接的，当然不排除有特殊的情况。所以，短连接一般只会在客户端/服务器之间传递一次读写操作。&lt;/p&gt;
&lt;p&gt;短连接的优点是：管理起来比较简单，存在的连接都是有用的连接，不需要额外的控制手段。&lt;/p&gt;
&lt;h3 id=&#34;tcp-长连接&#34;&gt;TCP 长连接&lt;/h3&gt;
&lt;p&gt;TCP 长连接的情况，客户端向服务端发起连接请求，服务端接收到客户端的连接请求，双方建立连接。客户端与服务端完成一次读写之后，他们之间的连接并不会主动关闭，后续的读写操作会继续使用这个连接。&lt;/p&gt;
&lt;p&gt;TCP的保活功能，保活功能主要为服务器应用提供，服务器应用希望知道客户主机是否崩溃，从而可以代表客户端使用资源。如果客户端已经消失，使得服务器上保留着一个半开放的连接，而服务器又在等待来自客户端的数据，则服务器将永远等待客户端的数据。保活功能就是试图在服务器端检测到这种半开放的连接。&lt;/p&gt;
&lt;p&gt;如果一个给定的连接在两个小时内没有任何的动作，则服务器就向客户端发一个探测报文段，客户端必须处于以下四个状态之一：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;客户端依然正常运行，并从服务器可达。客户端的TCP响应正常，而服务器也知道对方是正常的，服务器在两个小时后将保活定时器复位。&lt;/li&gt;
&lt;li&gt;客户端已经崩溃，并且关闭或者正在重新启动。在任何一种情况下，客户端的TCP都没有响应。服务端将不能收到对探测的响应，并在75秒后超时。服务器总共发送10个这样的探测，每个间隔75秒。如果服务器没有收到一个响应，它就认为客户端已经关闭并终止连接。&lt;/li&gt;
&lt;li&gt;客户端崩溃并已经重新启动。服务器将收到一个对其保活探测的响应，这个响应是一个复位，使得服务器终止这个连接。&lt;/li&gt;
&lt;li&gt;客户端正常运行，但是服务器不可达，这种情况与第二种情况类似，TCP能发现的就是没有收到探查的响应。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;长连接和短连接的操作过程&#34;&gt;长连接和短连接的操作过程&lt;/h3&gt;
&lt;p&gt;短连接的操作步骤是：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;建立连接-&amp;gt;数据传输-&amp;gt;关闭连接...建立连接-&amp;gt;数据传输-&amp;gt;关闭连接
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;长连接的操作步骤是：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;建立连接-&amp;gt;数据传输...(保持连接)...数据传输-&amp;gt;关闭连接
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;长连接和短连接的优点和缺点&#34;&gt;长连接和短连接的优点和缺点&lt;/h3&gt;
&lt;p&gt;长连接可以省去较多的TCP建立和关闭操作，减少浪费，节约时间。对于频繁请求资源的客户来说，比较适用长连接。不过这里存在一个问题，存活功能的探测周期太长，还有就是它只是探测TCP连接的存活，属于比较斯文的做法。遇到恶意的连接时，保活功能就不够使了。在长连接的应用场景下，客户端一般不会主动关闭它们之间的连接，客户端与服务器之间的连接如果一直不关闭的话，会存在一个问题，随着客户端连接越来越多，服务器早晚有扛不住的时候，这时候服务器需要采取一些策略，如关闭一些长时间没有读写事件发生的连接，这样可以避免一些恶意连接导致服务端服务受损；如果条件再允许的话，就可以以客户端机器为颗粒度，限制每个客户端的最大长连接数，这样可以完全避免某个客户端连累后端服务。&lt;/p&gt;
&lt;p&gt;短连接对于服务器来说管理较为简单，存在的连接都是有用的连接，不需要额外的控制手段。但如果客户端请求频繁，将在TCP的建立和关闭操作上浪费时间和带宽。&lt;/p&gt;
&lt;p&gt;长连接和短连接的产生在于客户端和服务器采取的关闭策略，具体的应用场景采用具体的策略，没有十全十美的选择，只有合适的选择。&lt;/p&gt;
&lt;h3 id=&#34;长连接和短连接的使用场景&#34;&gt;长连接和短连接的使用场景&lt;/h3&gt;
&lt;p&gt;长连接多用于操作频繁、点对点的通讯，而且连接数不能太多的情况。每个TCP连接都需要三次握手，这需要时间。如果每个操作都是先连接，再操作的话，那么处理速度会降低很多，所以每个操作完后都不断开，再次处理时直接发送数据包就行，不用建立TCP连接。例如，数据库的连接使用长连接，如果用短连接频繁地通信会造成socket错误，而且频繁的socket创建也是对资源的浪费。&lt;/p&gt;
&lt;p&gt;而像Web网站的HTTP服务一般都用短连接，因为长连接对于服务器来说会耗费一定的资源，而像Web网站这么频繁的成千上万甚至上亿客户端的连接用短连接会更省一些资源，如果使用长连接，而且同时有成千上万的用户，如果每个用户都占用一个连接的话，那么服务器端肯定承受不了。所以，并发量大，但每个用户无需频繁操作的情况下，使用短连接较好。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://maimai.cn/article/detail?fid=469286418&#34;&gt;https://maimai.cn/article/detail?fid=469286418&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/http/">HTTP</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 中 Shell 脚本基础知识</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-shell-script/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-shell-script/</guid>
                <pubDate>Wed, 11 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Linux Shell 脚本编写中常用的语法知识。&lt;/p&gt;
&lt;h3 id=&#34;shell简介&#34;&gt;Shell简介&lt;/h3&gt;
&lt;p&gt;Shell 是顺序执行的命令列表&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bash shell&lt;/code&gt; 的命令分为两类：外部命令和内部命令。外部命令是通过系统调用或独立的程序实现的，如sed、awk等等。内部命令是由特殊的文件格式（.def）所实现，如cd、history、exec等等。&lt;/p&gt;
&lt;h3 id=&#34;binbash的含义&#34;&gt;#!/bin/bash的含义&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;#!/bin/bash&lt;/code&gt; 指此脚本使用 &lt;code&gt;/bin/bash&lt;/code&gt; 来解释执行，&lt;code&gt;#!&lt;/code&gt; 是特殊的表示符，其后跟的是解释执行此脚本的 &lt;code&gt;shell&lt;/code&gt; 的路径。&lt;/p&gt;
&lt;h3 id=&#34;参数的含义&#34;&gt;$参数的含义&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;$$  是脚本运行的当前进程ID号&lt;/li&gt;
&lt;li&gt;$#  表示传递给脚本的参数个数&lt;/li&gt;
&lt;li&gt;$!  是最后执行的后台命令的PID&lt;/li&gt;
&lt;li&gt;$0  是脚本本身的名字&lt;/li&gt;
&lt;li&gt;$1  是传递给该Shell脚本或函数的第一个参数&lt;/li&gt;
&lt;li&gt;$2  是传递给该Shell脚本或函数的第二个参数&lt;/li&gt;
&lt;li&gt;$n  是传递给该Shell脚本或函数的第n个参数&lt;/li&gt;
&lt;li&gt;$?  显示最后命令的退出状态，0表示没有错误，其他表示有错误&lt;/li&gt;
&lt;li&gt;$@  表示传递给该脚本或函数的所有参数的列表&lt;/li&gt;
&lt;li&gt;$*  是以一个单字符串显示所有向脚本传递的参数，与位置变量不同，参数可超过九个。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;关于 &lt;code&gt;@&lt;/code&gt; 和 &lt;code&gt;*&lt;/code&gt; 的异同：&lt;/p&gt;
&lt;p&gt;相同点：都是引用所有参数&lt;/p&gt;
&lt;p&gt;不同点：只有在双引号中体现出来。假设在脚本运行时写了三个参数，分别存储在1、2、3，则“@”等价于“1”、“2”、“3”（传递了三个参数）；而“*”表示“123”（传递了一个参数）&lt;/p&gt;
&lt;h3 id=&#34;getopts-命令&#34;&gt;getopts 命令&lt;/h3&gt;
&lt;p&gt;内部命令 getopts可以很方便地处理命令行参数，其一般格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;getopts options variable
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;getopts 的设计目标是在循环中运行，每次执行循环，getopts就检查下一个命令行参数，并判断它是否合法，即检查参数是否以“-”开头，后面跟一个包含在options中的字母。如果是，就把匹配的选项字母存储在指定的变量variable中，并返回退出状态0；如果“-”后面的字母没有包含在options中，就在variable中存入一个“？”，并返回退出状态0；如果命令行中已经没有参数，或者下一个参数不以“-”开头，就返回不为0的退出状态。&lt;/p&gt;
&lt;p&gt;注意以下几点：&lt;/p&gt;
&lt;p&gt;1、getopts允许把选项堆叠在一起（如-ms）。&lt;/p&gt;
&lt;p&gt;2、如果要带参数，须在对应选项后加“:”（如h后需要加参数h:ms），此时选项和参数之间至少有一个空白字符分隔，这样的选项不能堆叠。&lt;/p&gt;
&lt;p&gt;3、如果在需要参数的选项之后没有找到参数，它就在给定的变量中存入“?”，并向标准错误输出中写入错误信息；否则将实际参数写入特殊变量：OPTARG。&lt;/p&gt;
&lt;p&gt;4、另外一个特殊变量：OPTIND，反映下一个要处理的参数索引，初值是1，每次执行getopts时都会更新。&lt;/p&gt;
&lt;h3 id=&#34;local&#34;&gt;local&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;一般用于局部变量声明，多在函数内部使用。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、Shell脚本中定义的变量是全局变量，其作用域从被定义的地方开始，到Shell脚本结束或被显式删除处为止。&lt;/p&gt;
&lt;p&gt;2、Shell函数定义的变量默认是全局变量，其作用域从函数被调用时执行变量定义的地方开始，到Shell脚本结束或被显式删除处为止。函数定义的变量可以被显式定义成局部的，其作用域局限于函数内。但请注意，函数的参数是局部的。&lt;/p&gt;
&lt;p&gt;3、如果同名，Shell函数定义的局部变量会屏蔽脚本定义的全局变量。&lt;/p&gt;
&lt;h3 id=&#34;shift&#34;&gt;shift&lt;/h3&gt;
&lt;p&gt;shift 命令用于对参数的移动（左移），通常用于在不知道传入参数个数的情况下依次遍历每个参数，然后进行相应处理，常见于Linux中各种程序的启动脚本。&lt;/p&gt;
&lt;h3 id=&#34;-devnull-21&#34;&gt;&amp;gt; /dev/null 2&amp;gt;&amp;amp;1&lt;/h3&gt;
&lt;p&gt;Linux 中的标准输入和输出包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;0，表示标准输入（stdin），即键盘输入。&lt;/li&gt;
&lt;li&gt;1，表示标准输出（stdout），即屏幕输出，系统默认是1。&lt;/li&gt;
&lt;li&gt;2，表示标准错误输出（stderr），即屏幕输出。&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nohup command &amp;gt; /dev/null 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;等价于&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nohup command 1 &amp;gt; /dev/null 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;1）nohup：表示当前用户和系统的会话下的进程忽略响应hup消息，从而不挂断地运行命令。&lt;/p&gt;
&lt;p&gt;2）command：表示Shell命令或者为一个可执行的程序。&lt;/p&gt;
&lt;p&gt;3）&amp;gt;：表示重定向到哪里。&lt;/p&gt;
&lt;p&gt;4）/dev/null：表示Linux的空设备文件。&lt;/p&gt;
&lt;p&gt;5）2：表示标准错误输出&lt;/p&gt;
&lt;p&gt;6）&amp;amp;1：&amp;amp;表示等同于的意思，2&amp;gt;&amp;amp;1，表示把标准错误输出定向到前一个（&amp;amp;的作用）打开的文件中去。&lt;/p&gt;
&lt;p&gt;7）&amp;amp;：命令最后面加一个&amp;amp;，表示后台执行，即这条指令在后台运行。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1 &amp;gt; /dev/null&lt;/code&gt;，表示标准输出重定向到空设备文件，也就是不输出任何信息到终端，不显示任何信息。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;2 &amp;gt; &amp;amp;1&lt;/code&gt;，表示标准错误输出重定向等同于标准输出，因为之前标准输出已经重定向到了空设备文件，所以标准错误输出也重定向到空设备文件。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;gt;  /dev/null 2&amp;gt;&amp;amp;1&lt;/code&gt;，常用来避免shell命令或程序等运行中有内容输出。&lt;/p&gt;
&lt;h3 id=&#34;命令组&#34;&gt;命令组&lt;/h3&gt;
&lt;p&gt;命令组是在括号中的命令列表，将会作为一个子shell来运行，一般格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;(cmd1,cmd2,cmd3)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;命令执行控制&#34;&gt;命令执行控制&lt;/h4&gt;
&lt;p&gt;1、&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; 表示命令之间的关系为：与，格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cmd_1 &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; cmd_2 # 如果命令cmd_1执行成功，则执行cmd_2，否则cmd_2不执行。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、&lt;code&gt;||&lt;/code&gt; 表示命令之间的关系为：或，格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cmd_1 || cmd_2 # 如果命令cmd_1执行成功，则不执行命令cmd_2，否则执行cmd_2。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、&lt;code&gt;;&lt;/code&gt; 表示命令之间的关系为：顺序，格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cmd_1 ; cmd_2 # 无论cmd_1是否执行成功，都会执行cmd_2。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;-与--&#34;&gt;$() 与 ` `&lt;/h3&gt;
&lt;p&gt;在 bash 中，$() 与 ` `（反引号） 都是用来作命令替换的，先完成引号里面的命令，然后将其结果替换出来，再重组成新的命令。&lt;/p&gt;
&lt;p&gt;在操作上，这两者都能达到相应的效果，但是建议使用 $()&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;` ` 很容易与&#39;&#39;（单引号）搞混乱，惹来无端麻烦。&lt;/li&gt;
&lt;li&gt;在多层次的复合替换中，` ` 必须要做额外的转义处理，而 $() 比较直观。&lt;/li&gt;
&lt;li&gt;$() 的弊端是，并不是所有的类 unix 系统都支持这种方式，但是反引号是肯定支持的。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$var 和 ${var}&lt;/p&gt;
&lt;p&gt;一般情况下，$var 和 ${var} 是没有区别的，但是用 ${}会比较精确地界定变量名称的范围。&lt;/p&gt;
&lt;h3 id=&#34;退出状态码&#34;&gt;退出状态码&lt;/h3&gt;
&lt;p&gt;shell 中运行的每个命令都使用退出状态码来告诉 shell 它完成了处理。退出状态码是一个 0~255 之间的整数值，在命令执行结束时由命令返回给 shell。&lt;/p&gt;
&lt;p&gt;典型的退出状态码及其意义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;0：命令运行成功&lt;/li&gt;
&lt;li&gt;1：通知未知错误&lt;/li&gt;
&lt;li&gt;2：误用 shell 命令&lt;/li&gt;
&lt;li&gt;126：命令不可执行&lt;/li&gt;
&lt;li&gt;127：没有找到命令&lt;/li&gt;
&lt;li&gt;128：无效退出参数&lt;/li&gt;
&lt;li&gt;130：命令通过 Ctrl + C 终止&lt;/li&gt;
&lt;li&gt;255：退出状态码越界&lt;/li&gt;
&lt;li&gt;137：OOMKilld，内存溢出错误。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;exit 命令用于在 shell 脚本中指定退出状态码，退出状态码最大只能到 255，若其大于 255，则返回模除 256 后的余数。&lt;/p&gt;
&lt;h3 id=&#34;shell脚本调试&#34;&gt;Shell脚本调试&lt;/h3&gt;
&lt;p&gt;脚本调试的主要工作就是发现引发脚本错误的原因以及脚本源代码中定位错误。&lt;/p&gt;
&lt;h4 id=&#34;通过-echo-方式&#34;&gt;通过 echo 方式&lt;/h4&gt;
&lt;p&gt;功能描述：最简单也是最常用的调试方式，在任何怀疑出错的地方用 echo 打印变量&lt;/p&gt;
&lt;p&gt;使用场景：所有怀疑可能有问题的地方&lt;/p&gt;
&lt;p&gt;示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo $xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;通过选项方式&#34;&gt;通过选项方式&lt;/h4&gt;
&lt;h5 id=&#34;-n&#34;&gt;-n&lt;/h5&gt;
&lt;p&gt;功能描述：读取 shell 脚本，但不实际执行。&lt;/p&gt;
&lt;p&gt;使用场景：用于测试 shell 脚本中是否存在语法错误。&lt;/p&gt;
&lt;p&gt;示例：&lt;code&gt;bash -n xdhuxc.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;xdhuxc.sh内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;function xdhuxc() {
    echo &amp;#34;bash function is called&amp;#34;
}
echo &amp;#34;xdhuxc start&amp;#34;
xdhuxc
echo &amp;#34;xdhuxc end&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;-c&#34;&gt;-c&lt;/h5&gt;
&lt;p&gt;功能描述：使 shell 解释器从字符串而非文件中读取并执行命令。&lt;/p&gt;
&lt;p&gt;使用场景：当需要调试一小段脚本的执行结果时，非常方便。&lt;/p&gt;
&lt;p&gt;示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;bash -c &amp;#39;a=2;b=3;let c=a+b;echo c=$c&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;-v&#34;&gt;-v&lt;/h5&gt;
&lt;p&gt;功能描述：区别于 -x 参数，该选项打印命令行的原始内容，-x 参数打印出经过替换后的命令行的内容。&lt;/p&gt;
&lt;p&gt;使用场景：仅想显示命令行的原始内容。&lt;/p&gt;
&lt;p&gt;示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;bash -v xdhuxc.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;-x&#34;&gt;-x&lt;/h5&gt;
&lt;p&gt;功能描述：提供跟踪执行信息，在执行脚本的过程中，把实际执行的每个命令显示出来，行首显示 +，+ 后面显示经过替换之后的命令行内容，有助于分析实际执行的是什么命令&lt;/p&gt;
&lt;p&gt;使用场景：是调试 shell 脚本的强有力工具，shell 脚本调试的首选手段。&lt;/p&gt;
&lt;p&gt;示例：&lt;/p&gt;
&lt;p&gt;1、在命令行提供参数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$sh -x xdhuxc.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、脚本开头提供参数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env bash -x
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、在脚本中用 &lt;code&gt;set&lt;/code&gt; 命令启用或禁用参数：其中 &lt;code&gt;set -x&lt;/code&gt; 表示启用；&lt;code&gt;set +x&lt;/code&gt; 表示禁用。&lt;/p&gt;
&lt;h4 id=&#34;通过-test-的方式返回值为-0则为真返回值为1则为假&#34;&gt;通过 test 的方式，返回值为 0，则为真；返回值为1，则为假。&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;test -f /etc/hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;通过-trap-来调试&#34;&gt;通过 trap 来调试&lt;/h4&gt;
&lt;p&gt;功能描述：用于捕获指定的信号并执行预定义的命令&lt;/p&gt;
&lt;p&gt;语法格式：&lt;code&gt;trap cmd signal&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;说明：
signal 是要捕获的信号&lt;/p&gt;
&lt;p&gt;cmd 是捕获到指定的信号，所要执行的命令，可以用 kill -l 命令查看系统中全部可用的信号名。捕获信号后所执行的命令，可以是一条或多条合法的 shell 语句，也可以是一个函数名。shell 脚本执行时，会产生三个伪信号（之所以称为伪信号，是因为这是 shell 自己产生的，而非操作系统产生的），通过使用 trap 捕获这三个伪信号并输出信息对调试有很大的帮助。&lt;/p&gt;
&lt;p&gt;shell 的三个伪信号：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;EXIT：从一个函数中退出或整个脚本执行完毕。&lt;/li&gt;
&lt;li&gt;ERR：当一个命令执行不成功，返回非 0 状态时。&lt;/li&gt;
&lt;li&gt;DEBUG：脚本中每一条命令执行之前。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
errorTrap() {
    echo &amp;#34;[LINE : $1] Error: Command or function exited with status $?&amp;#34;
}

hello() {
    return 1;
}
trap $(errorTrap $LINENO) ERR
xdhuxc
hello
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行 xdhuxc.sh 脚本：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;bash xdhuxc.sh

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;使用调试工具-bashdb&#34;&gt;使用调试工具 bashdb&lt;/h4&gt;
&lt;p&gt;使用 shell 调试器 bashdb，可以实现对 shell 脚本的断点设置、单步执行和变量观察等许多功能。&lt;/p&gt;
&lt;p&gt;使用方式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;bashdb -c xdhuxc.sh
或者
bashdb xdhuxc.sh
或者
bashdb --debug xdhuxc.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;bash--x-xdhuxcsh&#34;&gt;bash -x xdhuxc.sh&lt;/h4&gt;
&lt;p&gt;使用命令 &lt;code&gt;bash -x xdhuxc.sh&lt;/code&gt; 调试脚本xdhuxc.sh，示例输出如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;++ cd ../..
++ pwd
+ DCE_HOME=/yonyou/developercenter_enterprise
+ DCE_IP=192.168.244.133
+ echo -e /yonyou/developercenter_enterprise
/yonyou/developercenter_enterprise
+ echo -e 192.168.244.133
192.168.244.133
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&amp;quot;+&amp;quot; 号后面显示的是经过了变量替换之后的命令行的内容，有助于分析实际执行的是什么命令&lt;/p&gt;
&lt;p&gt;带加号表示该条语句是Shell执行的。&lt;/p&gt;
&lt;p&gt;不带加号表示该语句是Shell产生的输出。&lt;/p&gt;
&lt;h4 id=&#34;set--e&#34;&gt;set -e&lt;/h4&gt;
&lt;p&gt;set -e 语句告诉 bash 如果任何语句的执行结果不是 true，则应该退出。这样做的好处是防止错误像滚雪球般变大而导致一个致命的错误，而这些错误本应该在之前就被处理掉。&lt;/p&gt;
&lt;h3 id=&#34;字符串比较&#34;&gt;字符串比较&lt;/h3&gt;
&lt;p&gt;字符串比较的作用：测试字符串是否相等，长度是否为零，字符串是否为NULL等
常用的字符串比较符号如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;比较符&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;=&lt;/td&gt;
&lt;td&gt;比较两个字符串是否相同，相同则为“是”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;!=&lt;/td&gt;
&lt;td&gt;比较两个字符串是否不同，不同则为“是”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-n&lt;/td&gt;
&lt;td&gt;比较字符串的长度是否大于0，如果大于0则为“是”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-z&lt;/td&gt;
&lt;td&gt;比较字符串的长度是否等于0，如果等于0则为“是”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;数字比较&#34;&gt;数字比较&lt;/h3&gt;
&lt;p&gt;常用的数字比较符如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;比较符&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;-eq&lt;/td&gt;
&lt;td&gt;等于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-ge&lt;/td&gt;
&lt;td&gt;大于等于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-le&lt;/td&gt;
&lt;td&gt;小于等于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-ne&lt;/td&gt;
&lt;td&gt;不等于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-gt&lt;/td&gt;
&lt;td&gt;大于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-lt&lt;/td&gt;
&lt;td&gt;小于&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;字符串测试&#34;&gt;字符串测试&lt;/h3&gt;
&lt;p&gt;在编写 Shell 脚本时，经常需要进行判断，以下是一些测试字符串的方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;[ -z abc ] abc的值的长度为零则为真&lt;/li&gt;
&lt;li&gt;[ -n abc ] 如果字符串的长度不为零，则为真&lt;/li&gt;
&lt;li&gt;[ -a file_name ] 如果file_name存在，则为真&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/shell/">Shell</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>在 CentOS 7 上安装 MongoDB 数据库</title>
                <link>https://xdhuxc.github.io/posts/storage/mongodb/centos7-install-mongodb/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mongodb/centos7-install-mongodb/</guid>
                <pubDate>Fri, 06 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;h3 id=&#34;mongodb-简介&#34;&gt;MongoDB 简介&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;MongoDB&lt;/code&gt; 是一个基于分布式文件存储的数据库。由 &lt;code&gt;C++&lt;/code&gt; 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;MongoDB&lt;/code&gt; 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。&lt;/p&gt;
&lt;h3 id=&#34;准备工作&#34;&gt;准备工作&lt;/h3&gt;
&lt;p&gt;（1）在 &lt;code&gt;/etc/yum.repos.d&lt;/code&gt; 目录下创建文件 &lt;code&gt;mongodb-org-4.0.repo&lt;/code&gt;，内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[mongodb-org-4.0]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/development/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-3.8.asc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;（2）关闭SELinux&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;setenforce 0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;安装mongodb&#34;&gt;安装MongoDB&lt;/h3&gt;
&lt;p&gt;执行如下命令安装MongoDB&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y mongodb-org-unstable.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;MongoDB的配置文件路径为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/etc/mongod.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在该文件中配置有MongoDB的日志文件路径和数据文件路径
日志文件路径为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/var/log/mongodb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;数据文件路径为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/var/lib/mongo
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果使用其他用户启动 &lt;code&gt;MongoDB&lt;/code&gt; 进程，需要确保该用户对 &lt;code&gt;/var/log/mongodb&lt;/code&gt;  和&lt;code&gt;/var/lib/mongo&lt;/code&gt; 有访问权限。&lt;/p&gt;
&lt;h3 id=&#34;mongodb进程管理命令&#34;&gt;MongoDB进程管理命令&lt;/h3&gt;
&lt;p&gt;1、查看 &lt;code&gt;MongoDB&lt;/code&gt; 的启动状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl status mongod
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、停止 &lt;code&gt;MongoDB&lt;/code&gt; 进程&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl stop mongod
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、重启 &lt;code&gt;MongoDB&lt;/code&gt; 进程&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart mongod
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、启动 &lt;code&gt;MongoDB&lt;/code&gt; shell&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mongo --host 127.0.0.1:27017
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、卸载 &lt;code&gt;MongoDB&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;① 停止 &lt;code&gt;MongoDB&lt;/code&gt; 进程&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl stop mongod
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;② 删除 &lt;code&gt;MongoDB&lt;/code&gt; 的安装包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum erase $(rpm -qa | grep mongodb-org)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;③ 删除 &lt;code&gt;MongoDB&lt;/code&gt; 数据和日志目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rm -f /var/log/mongodb
rm -f /var/lib/mongo
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;Redhat&lt;/code&gt; 或者 &lt;code&gt;CentOS&lt;/code&gt; 上安装 &lt;code&gt;MongoDB&lt;/code&gt; 的官方文档地址：
&lt;a href=&#34;https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/&#34;&gt;https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/&lt;/a&gt;&lt;/p&gt;
</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/centos7/">CentOS7</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mongodb/">MongoDB</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>HTTP 协议基础知识</title>
                <link>https://xdhuxc.github.io/posts/common/http/http-basic-knowledge/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/common/http/http-basic-knowledge/</guid>
                <pubDate>Mon, 02 Jul 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了些 HTTP 协议的基本知识，可用于复习 HTTP 协议的基础知识。&lt;/p&gt;
&lt;h3 id=&#34;http-简介&#34;&gt;HTTP 简介&lt;/h3&gt;
&lt;p&gt;HTTP协议是Hyper Text Transfer Protocol（超文本传输协议）的缩写，用于从万维网服务器传输超文本到本地浏览器的传送协议。&lt;/p&gt;
&lt;p&gt;HTTP 是一个基于TCP/IP协议来传输数据（HTML文件、图片文件等）的协议&lt;/p&gt;
&lt;h3 id=&#34;http-工作原理&#34;&gt;HTTP 工作原理&lt;/h3&gt;
&lt;p&gt;HTTP 协议工作于客户端-服务器架构上，浏览器作为HTTP客户端通过URL向HTTP服务端发送所有请求，HTTP服务器根据接收到的请求，向客户端发送响应信息。&lt;/p&gt;
&lt;p&gt;一次 HTTP 操作称为一个事务，其工作过程可分为四步：&lt;/p&gt;
&lt;p&gt;1）首先，客户端与服务器需要建立连接，只要用户点击某个超链接，HTTP的工作就开始。&lt;/p&gt;
&lt;p&gt;2）建立连接后，客户端发送一个请求给服务器，请求方法的格式为：统一资源标识符（URL）、协议版本号，后边是MIME信息，包括请求修饰符、客户端信息和可能的内容。&lt;/p&gt;
&lt;p&gt;3）服务器接收到请求后，给予相应的响应信息，其格式为：一个状态行，包括信息的协议版本号、一个成功或错误的代码，后边是MIME信息，包括服务器信息、实体信息和可能的内容。&lt;/p&gt;
&lt;p&gt;4）客户端接收到服务器所返回的信息，通过浏览器显示在用户的显示屏上，然后客户端与服务器断开连接。&lt;/p&gt;
&lt;p&gt;如果在以上过程中的某一步出现错误，那么产生错误的信息将返回到客户端，由显示屏输出。&lt;/p&gt;
&lt;h3 id=&#34;http-特点&#34;&gt;HTTP 特点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;HTTP是无连接的
无连接的含义是限制每次连接只处理一个请求，服务器处理完客户的请求，并收到客户的应答后，即断开连接，采用这种方式可以节省传输时间。&lt;/li&gt;
&lt;li&gt;HTTP是媒体独立的
这意味着，只要客户端和服务器知道如何处理数据内容，任何类型的数据都可以通过HTTP发送，客户端以及服务器指定使用适合的MIME-TYPE内容类型。&lt;/li&gt;
&lt;li&gt;HTTP是无状态的
无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;请求消息request&#34;&gt;请求消息Request&lt;/h3&gt;
&lt;p&gt;客户端发送一个HTTP请求到服务器的请求消息包括以下格式：
请求行，请求头，空行和请求数据四个部分组成
&lt;img src=&#34;C:/Users/wanghuan/Desktop/%E7%94%B5%E5%AD%90%E4%B9%A6/http-request.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;请求行，用来说明请求类型，要访问的资源以及所使用的HTTP协议版本。&lt;/li&gt;
&lt;li&gt;请求头部，紧接着请求行（即第一行）之后的部分，用来说明服务器要使用的附加信息。&lt;/li&gt;
&lt;li&gt;空行，请求头部后面的空行是必须的，即使第四部分的请求数据为空，也必须有空行。&lt;/li&gt;
&lt;li&gt;主体，即请求数据，可以添加任意的其他数据。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;响应消息response&#34;&gt;响应消息Response&lt;/h3&gt;
&lt;p&gt;一般情况下，服务器接收并处理客户端发过来的请求后会返回一个HTTP的响应消息。
HTTP 响应也由四个部分组成，分别是：状态行、消息报头、空行和响应正文。
&lt;img src=&#34;C:/Users/wanghuan/Desktop/%E7%94%B5%E5%AD%90%E4%B9%A6/http-response.jpg&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;状态行，由HTTP协议版本号、状态码和状态消息三部分组成。&lt;/li&gt;
&lt;li&gt;响应头部，用来说明客户端要使用的一些附加信息。&lt;/li&gt;
&lt;li&gt;空行，消息报头后面的空行是必须的。&lt;/li&gt;
&lt;li&gt;响应正文，服务器返回给客户端的文本信息。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;http-请求方法&#34;&gt;HTTP 请求方法&lt;/h3&gt;
&lt;p&gt;根据HTTP标准，HTTP请求可以使用多种请求方法。
HTTP 1.0 定义了三种请求方法：GET，POST和HEAD方法。
HTTP 1.1 新增了五种请求方法：OPTIONS，PUT，DELETE，TRACE 和 CONNECT 方法。&lt;/p&gt;
&lt;p&gt;在 HTTP/1.0 中，默认使用短连接，也就是说，浏览器和服务器每进行一次 HTTP操作，就建立一次连接，但任务结束就中断连接。&lt;/p&gt;
&lt;p&gt;在 HTTP/1.1 中，默认使用长连接，用以保持连接特性。在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输 HTTP 数据的 TCP 连接不会关闭。如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的连接。Keep-Alive 不会永久保持连接，它有一个保持时间，可以在不同的服务器软件中设定这个时间。实现长连接要客户端和服务端都支持长连接。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GET：请求指定的页面信息，并返回实体主体。&lt;/li&gt;
&lt;li&gt;HEAD：类似于GET请求，只不过返回的响应中没有具体的内容，用于获取报头。&lt;/li&gt;
&lt;li&gt;POST：向指定资源提交数据进行处理请求（例如提交表单或上传文件）。数据被包含在请求体中，POST请求可能会导致新的资源的建立或已有资源的修改。&lt;/li&gt;
&lt;li&gt;PUT：从客户端向服务器传送的数据取代指定的文档内容。&lt;/li&gt;
&lt;li&gt;DELETE：请求服务器删除指定的页面。&lt;/li&gt;
&lt;li&gt;CONNECT：HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器。&lt;/li&gt;
&lt;li&gt;OPTIONS：允许客户端查看服务器的性能。&lt;/li&gt;
&lt;li&gt;TRACE：回显服务器收到的请求，主要用于测试或诊断。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;get-请求和-post-请求的区别&#34;&gt;GET 请求和 POST 请求的区别&lt;/h3&gt;
&lt;h4 id=&#34;请求数据&#34;&gt;请求数据&lt;/h4&gt;
&lt;p&gt;GET请求，请求的数据会附在URL之后，即把数据放置在HTTP协议头中，以?分隔URL和传输数据，多个参数使用&amp;amp;连接。&lt;/p&gt;
&lt;p&gt;POST请求，把提交的数据放置在HTTP包的包体中。&lt;/p&gt;
&lt;p&gt;因此，GET提交的数据会在浏览器地址栏中显示出来，而POST方式提交数据时，浏览器地址栏不会改变。&lt;/p&gt;
&lt;h4 id=&#34;传输数据大小&#34;&gt;传输数据大小&lt;/h4&gt;
&lt;p&gt;首先，HTTP协议没有对传输的数据大小进行限制，HTTP协议规范也没有对URL长度进行限制。&lt;/p&gt;
&lt;p&gt;但在实际开发过程中，对于GET请求，特定的浏览器和服务器对URL的长度有限制，因此，在使用GET请求时，传输数据会受到URL长度的限制。&lt;/p&gt;
&lt;p&gt;对于POST请求，由于不是URL传值，理论上是不会受限制的，但是实际上各个服务器会规定对POST提交数据大小进行限制，Apache，IIS都有各自的配置。&lt;/p&gt;
&lt;h4 id=&#34;安全性&#34;&gt;安全性&lt;/h4&gt;
&lt;p&gt;POST的安全性比GET的高。这里的安全是指真正的安全，而不同于上面GET提到的安全方法中的安全，上面提到的安全仅仅是不修改服务器的数据。比如，在进行登录操作，通过GET请求，用户名和密码都会暴露再URL上，因为登录页面有可能被浏览器缓存以及其他人查看浏览器的历史记录的原因，此时的用户名和密码就很容易被他人拿到了。除此之外，GET请求提交的数据还可能会造成Cross-site request frogery攻击&lt;/p&gt;
&lt;p&gt;GET请求和POST请求本质上都是TCP连接，并无差别，但是由于HTTP的规定和浏览器/服务器的限制，导致它们在应用过程中体现出一些不同。&lt;/p&gt;
&lt;p&gt;GET请求产生一个TCP数据包，POST请求产生两个TCP数据包。具体来讲，对于GET请求，浏览器会把HTTP请求头部和请求数据一起发送出去，服务器端响应200，返回数据。&lt;/p&gt;
&lt;p&gt;对于POST请求，浏览器先发送请求头部，服务器响应100，continue，浏览器再发送数据，服务器端响应200，返回数据。&lt;/p&gt;
&lt;p&gt;根据研究，在网络环境好的情况下，发一次包的时间和发两次包的时间差别基本可以无视。而在网络环境差的情况下，两次包的TCP在验证数据包完整性上，有非常大的优点。&lt;/p&gt;
&lt;h3 id=&#34;状态码含义&#34;&gt;状态码含义&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;100：Continue，服务器仅接收到部分请求，但是一旦服务器并没有拒绝该请求，客户端应该继续发送其余的请求。&lt;/li&gt;
&lt;li&gt;200：OK，请求成功，一般用于GET和POST请求&lt;/li&gt;
&lt;li&gt;301：Moved Permanently，永久移动，请求的资源已被永久地移动到新的URI，返回信息会包含新的URI，浏览器会自动重定向到新的URI，今后任何新的请求都应使用新的URI代替。&lt;/li&gt;
&lt;li&gt;302：Found，临时移动，与301类似，但是资源只是临时被移动，客户端应继续使用原来的URI。&lt;/li&gt;
&lt;li&gt;400：Bad Request，客户端请求的语法错误，服务器无法理解。&lt;/li&gt;
&lt;li&gt;403：Forbidden，服务器理解请求客户端的请求，但是拒绝执行此请求。&lt;/li&gt;
&lt;li&gt;404：Not Found，服务器无法根据客户端的请求找到资源。&lt;/li&gt;
&lt;li&gt;500：Internal Server Error，服务器内部错误，无法完成请求。&lt;/li&gt;
&lt;li&gt;502：Bad Gateway，充当网关或代理的服务器，从远端服务器接收到了一个无效的请求。&lt;/li&gt;
&lt;li&gt;503：Service Unavailable，由于超载或系统维护，服务器暂时无法处理客户端的请求。&lt;/li&gt;
&lt;li&gt;504：Gateway Time-out，充当网关或代理的服务器，未及时从远端服务器获取请求。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;curl&#34;&gt;curl&lt;/h3&gt;
&lt;p&gt;使用 curl 发送 POST 请求&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl -v -H &amp;quot;Content-Type:application/json&amp;quot; -H &amp;quot;Host:www.baidu.com&amp;quot; -X POST --data ./xdhuxc.json www.baidu.com
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# curl -v -H &amp;quot;Content-Type:application/json&amp;quot; -H &amp;quot;Host:www.baidu.com&amp;quot; -X POST --data ./xdhuxc.json www.baidu.com
* About to connect() to www.baidu.com port 80 (#0)
*   Trying 14.215.177.38...
* Connected to www.baidu.com (14.215.177.38) port 80 (#0)
&amp;gt; POST / HTTP/1.1                       # 请求行
&amp;gt; User-Agent: curl/7.29.0               # 请求头部
&amp;gt; Accept: */*                           # 请求头部
&amp;gt; Content-Type:application/json         # 请求头部
&amp;gt; Host:www.baidu.com                    # 请求头部
&amp;gt; Content-Length: 13                    # 请求头部
&amp;gt;                                       # 空行
* upload completely sent off: 13 out of 13 bytes
&amp;lt; HTTP/1.1 302 Found                    # 状态行
&amp;lt; Connection: Keep-Alive                # 响应头部
&amp;lt; Content-Length: 17931                 # 响应头部
&amp;lt; Content-Type: text/html               # 响应头部
&amp;lt; Date: Sat, 21 Jul 2018 02:54:33 GMT   # 响应头部
&amp;lt; Etag: &amp;quot;54d9748e-460b&amp;quot;                 # 响应头部 
&amp;lt; Server: bfe/1.0.8.18                  # 响应头部
&amp;lt;                                       # 空行
&amp;lt;html&amp;gt;                                  # 以下为响应体
&amp;lt;head&amp;gt;
* Connection #0 to host www.baidu.com left intact  # 响应体
&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;注意：
-H，--header：设置头部信息Content-Type为application/json。
-d，--data：添加发送的数据。
-X：指定HTTP请求的方法，如果使用了-d，默认使用POST方法，可以省略-X参数。&lt;/p&gt;
&lt;p&gt;使用curl发送GET请求&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl -G -d &amp;quot;name=xdhuxc&amp;amp;password=Xdhuxc163&amp;quot; -F &amp;quot;file=@/Users/fungleo/Downloads/401.png&amp;quot; http://www.baidu.com
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;http-请求头&#34;&gt;HTTP 请求头&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;请求头&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;th&gt;示例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Accept&lt;/td&gt;
&lt;td&gt;客户端可接受的响应内容类型（Content-Type）&lt;/td&gt;
&lt;td&gt;Accept: text/plain&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Accept-Charset&lt;/td&gt;
&lt;td&gt;客户端可接受的字符集&lt;/td&gt;
&lt;td&gt;Accept-Charset: utf-8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Host&lt;/td&gt;
&lt;td&gt;表示服务器的域名以及服务器所监听的端口号。如果所请求的端口是对应的服务的标准端口（80），则端口号可以省略&lt;/td&gt;
&lt;td&gt;Host:www.baidu.com或Host:www.baidu.com:80&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Referer&lt;/td&gt;
&lt;td&gt;表示浏览器所访问的前一个页面，可以认为是之前访问页面的链接将浏览器带到了当前页面。Referer其实是Referrer这个单词，但RFC制作标准时给拼错了，后来也就将错就错使用Referer了。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Connection&lt;/td&gt;
&lt;td&gt;客户端浏览器想要优先使用的连接类型&lt;/td&gt;
&lt;td&gt;Connection: keep-alive;Connection:Upgrade&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Content-Type&lt;/td&gt;
&lt;td&gt;请求体的MIME类型（用于POST和PUT请求中）&lt;/td&gt;
&lt;td&gt;Content-Type: application/x-www-from-urlencoded&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Accept-Encoding&lt;/td&gt;
&lt;td&gt;客户端可接受的响应内容的编码方式&lt;/td&gt;
&lt;td&gt;Accept-Encoding: gzip,deflate&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Accept-Language&lt;/td&gt;
&lt;td&gt;客户端可接受的响应内容语言列表&lt;/td&gt;
&lt;td&gt;Accept-Language:zh-CN,en-US&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Cache-Control&lt;/td&gt;
&lt;td&gt;用来指定当前的请求/响应中，是否使用缓存机制&lt;/td&gt;
&lt;td&gt;Cache-Control: no-cache&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Content-Length&lt;/td&gt;
&lt;td&gt;以八进制表示的请求体长度&lt;/td&gt;
&lt;td&gt;Content-Length: 348&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;User-Agent&lt;/td&gt;
&lt;td&gt;浏览器的身份标识字符串&lt;/td&gt;
&lt;td&gt;User-Agent：Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Upgrade&lt;/td&gt;
&lt;td&gt;要求服务器升级到一个高版本协议&lt;/td&gt;
&lt;td&gt;Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/qq_30553235/article/details/79282113&#34;&gt;https://blog.csdn.net/qq_30553235/article/details/79282113&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;http-响应头&#34;&gt;HTTP 响应头&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;响应头&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;th&gt;示例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Status&lt;/td&gt;
&lt;td&gt;通用网关接口的响应头字段，用来说明当前HTTP连接的响应状态&lt;/td&gt;
&lt;td&gt;Status: 200 OK&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Server&lt;/td&gt;
&lt;td&gt;服务器的名称&lt;/td&gt;
&lt;td&gt;Server: nginx/1.6.3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ETag&lt;/td&gt;
&lt;td&gt;一个代表响应服务端资源（如页面）版本的报文头属性，如果某个服务端资源发生变化了，这个ETag就会相应发生变化。它是Cache-Control的有益补充，可以让客户端更智能地处理什么时候需要从服务端获取资源，什么时候可以直接从缓存中返回响应。对于服务器端某个资源的某个特定版本的一个标识符，通常是一个 消息散列&lt;/td&gt;
&lt;td&gt;ETag: &amp;quot;737060cd8c284d8af7ad3082f209582d&amp;quot;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Age&lt;/td&gt;
&lt;td&gt;响应对象在代理缓存中存在的时间，以秒为单位&lt;/td&gt;
&lt;td&gt;Age: 12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Allow&lt;/td&gt;
&lt;td&gt;对于特定资源的有效动作&lt;/td&gt;
&lt;td&gt;Allow: GET, HEAD&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Cache-Control&lt;/td&gt;
&lt;td&gt;通知从服务器到客户端内的所有缓存机制，表示它们是否可以缓存这个对象及缓存有效时间，单位为秒&lt;/td&gt;
&lt;td&gt;Cache-Control: max-age=3600&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Connection&lt;/td&gt;
&lt;td&gt;针对该连接所预期的选项&lt;/td&gt;
&lt;td&gt;Connection: close&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Content-Encoding&lt;/td&gt;
&lt;td&gt;服务器端响应资源所使用的编码类型&lt;/td&gt;
&lt;td&gt;Content-Encoding: gzip&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Content-Language&lt;/td&gt;
&lt;td&gt;服务器端响应资源所使用的语言&lt;/td&gt;
&lt;td&gt;Content-Language: zh-cn&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Content-Length&lt;/td&gt;
&lt;td&gt;服务端响应消息体的长度，用八进制字节表示&lt;/td&gt;
&lt;td&gt;Content-Length: 348&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Content-Type&lt;/td&gt;
&lt;td&gt;当前内容的MIME类型&lt;/td&gt;
&lt;td&gt;Content-Type: text/html; charset=utf-8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Expires&lt;/td&gt;
&lt;td&gt;指定一个日期/时间，超过该时间则认为此回应已经过期&lt;/td&gt;
&lt;td&gt;Expires: Thu, 01 Dec 1994 16:00:00 GMT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Refresh&lt;/td&gt;
&lt;td&gt;用于重定向，或者当一个新的资源被创建时，默认会在5秒后刷新重定向&lt;/td&gt;
&lt;td&gt;Refresh: 5; url=http://itbilu.com&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/u012361288/article/details/54425689&#34;&gt;https://blog.csdn.net/u012361288/article/details/54425689&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/wangning528/p/6388464.html&#34;&gt;https://www.cnblogs.com/wangning528/p/6388464.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.runoob.com/http/http-status-codes.html&#34;&gt;http://www.runoob.com/http/http-status-codes.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/http/">HTTP</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 配置 pip 源</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-pip/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-pip/</guid>
                <pubDate>Fri, 29 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在 python 开发过程中，经常需要配置 pip 源，以加快依赖包的下载速度，在构建 docker 镜像时，最好也指定 pip 源。&lt;/p&gt;
&lt;h3 id=&#34;配置-pip-源&#34;&gt;配置 pip 源&lt;/h3&gt;
&lt;p&gt;在当前目录下建立~/.pip/pip.conf文件，添加如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[global]
index-url = http://mirrors.aliyun.com/pypi/simple/

[install]
trusted-host=mirrors.aliyun.com
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;Windows&lt;/code&gt; 系统中，在 &lt;code&gt;C:\Users\wanghuan\AppData\Local\pip&lt;/code&gt; 目录下创建 &lt;code&gt;pip.ini&lt;/code&gt; 文件，写入以上内容并保存即可。&lt;/p&gt;
&lt;h3 id=&#34;使用-python-的-requirementstxt&#34;&gt;使用 Python 的 requirements.txt&lt;/h3&gt;
&lt;p&gt;使用 pip 命令时，通过 &lt;code&gt;-i&lt;/code&gt; 参数指定 pip 源&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Redis 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-questions-and-solutions/</guid>
                <pubDate>Thu, 28 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录下使用 redis 的过程中出现的问题及解决。&lt;/p&gt;
&lt;p&gt;1、使用 go-redis 连接 redis，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:xdhuxc wanghuan$ ./main --config conf.test.yaml
F0910 14:17:00.304868    2673 router.go:50] ERR SELECT is not allowed in cluster mode
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在单机模式下，redis.conf 配置文件中默认的数据库数量是 16 个；但在集群模式下，redis 不支持多数据库，只有一个数据库，默认是 select 0。集群从节点默认是不支持读写操作的，但是在执行过 readonly 命令后可以执行读操作。&lt;/p&gt;
&lt;p&gt;所以，将指定 db 的地方指定为 0 即可解决此问题。&lt;/p&gt;
&lt;p&gt;2、增大 redis 的客户端连接数&lt;/p&gt;
&lt;p&gt;1）redis.conf 中 maxClients 参数的限制，默认为：10000，设置为 0 表示不作限制，但是优先受到 redis 进程能打开的最大文件描述符的限制，为该值减去 32，因为 redis 内部也需要一些文件描述符。&lt;/p&gt;
&lt;p&gt;2）如果需要支持更高的连接数，还需要更改系统的相关配置，比如 ulimit 数目&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ulimit -n 65536 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）更改网络的并发连接数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;net.ipv4.netfilter.ip_conntrack_max
net.nf_conntrack_max
net.netfilter.nf_conntrack_max
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Tomcat 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/devops/tomcat/tomcat-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/tomcat/tomcat-questions-and-solutions/</guid>
                <pubDate>Thu, 28 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了使用 Tomcat 的过程中经常出现的问题及其解决方法。&lt;/p&gt;
&lt;p&gt;1、tomcat 部署项目后，war 包是否可以删除？&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;war 包不能在 tomcat 运行时删除，否则会删除自动解压的工程。&lt;/li&gt;
&lt;li&gt;可以停掉 tomcat 后，再删除 war 包，解压后的工程还会保留着。&lt;/li&gt;
&lt;li&gt;当重新部署的时候，如果有与 war 文件相同的目录，就不会重新部署。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因为 tomcat 在运行期间会监控 webapps 目录下的 war 文件，如果有新增 war 文件，就解压；有删除 war 文件，就连同项目一起删除。&lt;/p&gt;
&lt;p&gt;2、tomcat 下 war 包和同名已解压项目，如何加载？&lt;/p&gt;
&lt;p&gt;当 tomcat 启动的时候，会去查看 webapps 目录下的所有 war 包，同时查看是否有该 war 包对应的已解压文件，如果已经存在，就不会再解压，也不会将已经修改的 jsp 覆盖掉。只有当删除 war 包对应的同名目录后，启动 tomcat 时才会再解压 war 文件。&lt;/p&gt;
&lt;p&gt;3、部署在 tomcat 中的应用，输出的日志是乱码&lt;/p&gt;
&lt;p&gt;中文乱码原因：&lt;/p&gt;
&lt;p&gt;Tomcat 默认是按 &lt;code&gt;ISO-8859-1&lt;/code&gt; 进行 &lt;code&gt;URL&lt;/code&gt; 解码，&lt;code&gt;ISO-8859-1&lt;/code&gt; 并未包括中文字符，中文字符不能被正确解析导致产生乱码。&lt;/p&gt;
&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;1、在 &lt;code&gt;server.xml&lt;/code&gt; 文件，添加如下配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Connector&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;executor&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;tomcatThreadPool&amp;#34;&lt;/span&gt;
               &lt;span class=&#34;na&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;8080&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;HTTP/1.1&amp;#34;&lt;/span&gt;
               &lt;span class=&#34;na&#34;&gt;connectionTimeout&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;20000&amp;#34;&lt;/span&gt;
               &lt;span class=&#34;na&#34;&gt;redirectPort&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;8443&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;URIEncoding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;UTF-8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;指定了用于解码 &lt;code&gt;URI&lt;/code&gt; 的字符编码为 &lt;code&gt;UTF-8&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;2、设置当前系统编码，在 &lt;code&gt;/etc/profile&lt;/code&gt; 文件中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export LANG=zh_CN.utf8
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/tomcat/">Tomcat</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 Docker 容器方式部署 Redis</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-docker/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-docker/</guid>
                <pubDate>Thu, 28 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍以 docker 容器方式部署 Redis 的操作。&lt;/p&gt;
&lt;p&gt;1、最简单的 Redis 容器启动方式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d --name redis redis:latest 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、以持久化存储方式启动 Redis 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d --name redis redis:latest redis-server --appendonly yes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、某个应用连接 Redis&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d --name some-app --link 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、使用自定义配置文件启动 Redis 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -v /home/xdhuxc/redis/redis_master.conf:/usr/local/etc/redis/redis.conf \
    -v /home/xdhuxc/redis/log/redis_master.log:/var/log/redis/redis_master.log \
    -v /home/xdhuxc/redis/data:/data \
    --name redis \
    redis:latest \
    redis-server /usr/local/etc/redis/redis.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --network host \
    -v /xdhuxc/docker-compose/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf \
    --name redis \
    redis:4.0.9 \
    redis-server /usr/local/etc/redis/redis.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;redis主从复制集群&#34;&gt;Redis主从复制集群&lt;/h3&gt;
&lt;p&gt;1、安装并启动 Docker，执行如下命令安装 docker&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y docker
systemctl enable docker
systemctl start docker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、直接从 dockerhub 官网拉取 Redis镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull redis
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、准备配置文件，从官方下载的Redis镜像中没有redis.conf配置文件，因此需要提前准备配置文件。
从 &lt;a href=&#34;https://redis.io/&#34;&gt;Redis官网&lt;/a&gt; 下载最新稳定版 Redis，目前为：redis-4.0.2，下载redis-4.0.2.tar.gz，解压该软件包，获取redis.conf 配置文件&lt;/p&gt;
&lt;p&gt;4、启动 Redis 主节点&lt;/p&gt;
&lt;p&gt;1）修改配置文件&lt;/p&gt;
&lt;p&gt;注释掉 bind 127.0.0.1 所在行
注释掉 protected-mode yes所在行
注释掉 daemonize no  或者设置为 no 所在行（否则容器启动，加载配置文件后就退出，没有其他提示），报错为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store ~]# docker logs redis
1:C 10 Nov 00:59:40.915 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
1:C 10 Nov 00:59:40.916 # Redis version=4.0.2, bits=64, commit=00000000, modified=0, pid=1, just started
1:C 10 Nov 00:59:40.916 # Configuration loaded
[root@store ~]# docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS                          PORTS               NAMES
f5ba4eeb8a53        redis:latest        &amp;#34;docker-entrypoint.sh&amp;#34;   About a minute ago   Exited (0) About a minute ago                       redis
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）启动 Redis Master 容器
启动命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -v /home/xdhuxc/redis/conf/redis_master.conf:/usr/local/etc/redis/redis.conf \
    --name redis-master \
    redis:latest \
    redis-server /usr/local/etc/redis/redis.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store ~]# docker logs redis-master
1:C 10 Nov 00:03:25.961 # Fatal error, can&amp;#39;t open config file &amp;#39;/usr/local/etc/redis/redis.conf&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：在启动命令中加入 &lt;code&gt;--privileged=true&lt;/code&gt; 参数&lt;/p&gt;
&lt;p&gt;对于挂载的文件，要提前建立好空文件，否则会以文件名为目录名创建目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -v /home/xdhuxc/redis/redis-master.conf:/usr/local/etc/redis/redis.conf \
    -v /home/xdhuxc/redis/data:/data
    -v /hoem/xdhuxc/redis/log/redis-master.log:/var/log/redis/redis-master.log \ &lt;span class=&#34;ni&#34;&gt;#由redis&lt;/span&gt;.conf中logfile指定
    --name redis-master \
    redis:latest \
    redis-server /usr/local/etc/redis/redis.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;正确的启动命令：（取消logfile参数）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -v /home/xdhuxc/redis/conf/redis-master.conf:/usr/local/etc/redis/redis.conf \
    -v /home/xdhuxc/redis/data:/data \
    --name redis-master \
    redis:4.0.2 \
    redis-server /usr/local/etc/redis/redis.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;测试 Redis Master 容器，可以正常使用。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@centos_1 conf]# docker exec -it redis-master /bin/bash
root@1cc216ffcba8:/data# redis-cli                                                                                        
127.0.0.1:6379&amp;gt; set aaa aaa
OK
127.0.0.1:6379&amp;gt; get aaa
&amp;#34;aaa&amp;#34;
127.0.0.1:6379&amp;gt; set 123 abc
OK
127.0.0.1:6379&amp;gt; get 123
&amp;#34;abc&amp;#34;
127.0.0.1:6379&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、Redis Slave 配置文件和启动（使用同一个 redis-slave.conf）
复制 redis-master.conf 为 redis-slave.conf，并修改如下配置项：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#slaveof &amp;lt;masterip&amp;gt; &amp;lt;masterport&amp;gt; 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;修改为：
slaveof master 6379
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 redis-slave-one 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -v /home/xdhuxc/redis/conf/redis-slave.conf:/usr/local/etc/redis/redis.conf \
    --name redis-slave-one \
    --link redis-master:master \
    redis:4.0.2 \
    redis-server /usr/local/etc/redis/redis.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 redis-slave-two 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -v /home/xdhuxc/redis/conf/redis-slave.conf:/usr/local/etc/redis/redis.conf \
    --name redis-slave-two \
    --link redis-master:master \
    redis:4.0.2 \
    redis-server /usr/local/etc/redis/redis.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 docker 容器方式部署 zookeeper</title>
                <link>https://xdhuxc.github.io/posts/devops/zookeeper/zookeeper-docker/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/zookeeper/zookeeper-docker/</guid>
                <pubDate>Thu, 28 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了使用 docker 容器方式部署 zookeeper 的方法。&lt;/p&gt;
&lt;h3 id=&#34;启动-zookeeper-容器&#34;&gt;启动 zookeeper 容器&lt;/h3&gt;
&lt;p&gt;使用如下命令启动 zookeeper 容器：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --restart=always \
    -p 2181:2181 \
    --hostname=zookeeper \
    -e ZOO_MY_ID=1 \
    -e ZOO_SERVERS=server.1=zookeeper:2888:3888 \
    -v /home/xdhuxc/zookeeper/log:/datalog \
    -v /home/xdhuxc/zookeeper/data:/data \
    --name zookeeper \
    docker.io/zookeeper:3.4.10
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/zookeeper/">Zookeeper</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 docker 容器部署 Tomcat</title>
                <link>https://xdhuxc.github.io/posts/devops/tomcat/tomcat-docker/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/tomcat/tomcat-docker/</guid>
                <pubDate>Thu, 28 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了使用 docker 部署 tomcat 的方法。&lt;/p&gt;
&lt;h3 id=&#34;启动tomcat容器&#34;&gt;启动Tomcat容器&lt;/h3&gt;
&lt;p&gt;使用如下命令启动 &lt;code&gt;Tomcat&lt;/code&gt; 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --restart=always \
    -p 8080:8080 \
    --name=tomcat \
    tomcat:9.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在浏览器地址栏中输入：&lt;code&gt;http://192.168.244.128:8080&lt;/code&gt;，可访问到 &lt;code&gt;Tomcat&lt;/code&gt; 的首页&lt;/p&gt;
&lt;h3 id=&#34;挂载配置文件和-war-包方式启动tomcat容器&#34;&gt;挂载配置文件和 War 包方式启动Tomcat容器&lt;/h3&gt;
&lt;p&gt;根目录为：&lt;code&gt;/usr/local/tomcat/&lt;/code&gt;，&lt;code&gt;conf&lt;/code&gt;、&lt;code&gt;webapps&lt;/code&gt;、&lt;code&gt;bin&lt;/code&gt; 等目录均在该目录下&lt;/p&gt;
&lt;p&gt;创建 &lt;code&gt;/home/xdhuxc/tomcat&lt;/code&gt; 目录，在其下创建 &lt;code&gt;conf&lt;/code&gt; 和 &lt;code&gt;webapps&lt;/code&gt; 目录，&lt;/p&gt;
&lt;p&gt;使用如下命令启动 &lt;code&gt;tomcat&lt;/code&gt; 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --restart=always \
    -p 8080:8080 \
    -v /home/xdhuxc/tomcat/webapps:/usr/local/tomcat/webapps \
    -v /home/xdhuxc/tomcat/conf:/usr/local/tomcat/conf \
    --name=tomcat \
    tomcat:9.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/tomcat/">Tomcat</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>部署 Zookeeper 集群</title>
                <link>https://xdhuxc.github.io/posts/devops/zookeeper/zookeeper-cluster-deployment/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/zookeeper/zookeeper-cluster-deployment/</guid>
                <pubDate>Thu, 28 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 部署 zookeeper 集群的方法。&lt;/p&gt;
&lt;h3 id=&#34;zookeeper集群搭建&#34;&gt;Zookeeper集群搭建&lt;/h3&gt;
&lt;p&gt;三台虚拟机情况如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;虚拟机名称&lt;/th&gt;
&lt;th&gt;IP地址&lt;/th&gt;
&lt;th&gt;其他&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;centos_3&lt;/td&gt;
&lt;td&gt;192.168.244.129&lt;/td&gt;
&lt;td&gt;zk_master&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;centos_4&lt;/td&gt;
&lt;td&gt;192.168.244.135&lt;/td&gt;
&lt;td&gt;zk_slave1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;centos_6&lt;/td&gt;
&lt;td&gt;192.168.244.136&lt;/td&gt;
&lt;td&gt;zk_slave2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;均已经安装了java 1.8.0_144&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;1、在 zk_master 机器上下载 &lt;code&gt;zookeeper-3.4.10.tar.gz&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、解压 &lt;code&gt;zookeeper-3.4.10.tar.gz&lt;/code&gt; 文件，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tar -zxf zookeeper-3.4.10.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、创建所需文件和目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir /data
mkidr -p /data/zookpeer
mkdir -p /data/zookeper/data
mkdir -p /data/zookeeper/log
touch /data/zookeeper/data/myid
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、进入 &lt;code&gt;zookeeper-3.4.10/conf&lt;/code&gt; 目录下，复制配置文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp zoo_sample.cfg zoo.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、修改以下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tickTime=2000 # 单位毫秒，服务器之间或者客户端与服务器之间的心跳间隔
initLimit=10  # 初始化Follower最长时间：10 * 2000 ms
syncLimit=5   # Leader与Follower之间发送消息请求和应答时间长度：5 * 2000 ms
dataDir=/data/zookeeper/data # 日志存储路径
dataLogDir=/data/zookeeper/log # 事务日志存储路径
clientPort=52181 # 客户端端口
server.1=192.168.244.129:12888:13888    
server.2=192.168.244.135:12888:13888    
server.3=192.168.244.136:12888:13888  

autopurge.snapRetainCount=15 # 每次清除日志后保留的文件数目
autopurge.purgeInterval=1 # 清除日志频率，单位小时
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;server.A=B:C:D
A 是一个数字,表示这个是第几号服务器,
B 是这个服务器的ip地址
C 第一个端口用来集群成员的信息交换,表示的是这个服务器与集群中的Leader服务器交换信息的端口
D 是在leader挂掉时专门用来进行选举leader所用&lt;/p&gt;
&lt;p&gt;6、向 &lt;code&gt;/data/zookeeper/data/myid&lt;/code&gt; 中写入服务标识&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo &amp;#34;1&amp;#34; &amp;gt; /data/zookeeper/data/myid
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、将 zk_master 中的 zookeeper-3.4.10 复制到 zk_slave1 和 zk_slave2 机器上&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;scp -r /home/application/zookeeper-3.4.10 root@192.168.244.135:/home/application/
scp -r /home/application/zookeeper-3.4.10 root@192.168.244.136:/home/application/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、在 zk_slave1 和 zk_slave2 上创建 myid 文件并写入内容
在 zk_slave1 上&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;touch /data/zookeeper/data/myid
echo &amp;#34;2&amp;#34; &amp;gt; /data/zookeeper/data/myid
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 zk_slave2 上&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;touch /data/zookeeper/data/myid
echo &amp;#34;3&amp;#34; &amp;gt; /data/zookeeper/data/myid
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;9、在三台机器上都开放防火墙端口&lt;code&gt;52181&lt;/code&gt;，&lt;code&gt;12888&lt;/code&gt;，&lt;code&gt;13888&lt;/code&gt;，并重新启动防火墙。&lt;/p&gt;
&lt;p&gt;10、在三台机器上分别启动Zookeeper&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@centos_3 bin]# cd /home/application/zookeeper-3.4.10/bin
[root@centos_3 bin]# ./zkServer.sh start

[root@centos_4 bin]# cd /home/application/zookeeper-3.4.10/bin
[root@centos_4 bin]# ./zkServer.sh start

[root@centos_6 bin]# cd /home/application/zookeeper-3.4.10/bin
[root@centos_6 bin]# ./zkServer.sh start
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;11、查看 zookeeper 的启动状态
在 zk_master 上&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@centos_3 bin]# ./zkServer.sh status
ZooKeeper JMX enabled by default
Using config: /home/application/zookeeper-3.4.10/bin/../conf/zoo.cfg
Mode: follower
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 zk_slave1 上&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@centos_4 bin]# ./zkServer.sh status
ZooKeeper JMX enabled by default
Using config: /home/application/zookeeper-3.4.10/bin/../conf/zoo.cfg
Mode: leader
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 zk_slave2 上&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@centos_6 bin]# ./zkServer.sh status
ZooKeeper JMX enabled by default
Using config: /home/application/zookeeper-3.4.10/bin/../conf/zoo.cfg
Mode: follower
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;相关问题及解决&#34;&gt;相关问题及解决&lt;/h3&gt;
&lt;p&gt;1、启动 zookeeper 节点后出现如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@centos_6 bin]# ./zkServer.sh status
ZooKeeper JMX enabled by default
Using config: /home/application/zookeeper-3.4.10/bin/../conf/zoo.cfg
Error contacting service. It is probably not running.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;查看 &lt;code&gt;/home/application/zookeeper-3.4.10/bin&lt;/code&gt; 目录下的 &lt;code&gt;zookeeper.out&lt;/code&gt; 文件，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;017-10-10 16:06:47,701 [myid:1] - WARN  [WorkerSender[myid=1]:QuorumCnxManager@588] - Cannot open channel to 3 at election address /192.168.244.136:13888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:562)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:538)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:452)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:433)
	at java.lang.Thread.run(Thread.java:748)
2017-10-10 16:06:47,705 [myid:1] - INFO  [WorkerSender[myid=1]:QuorumPeer$QuorumServer@167] - Resolved hostname: 192.168.244.136 to address: /192.168.244.136
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;分别在三台虚拟机上开放 &lt;code&gt;52181&lt;/code&gt;、&lt;code&gt;12888&lt;/code&gt;、&lt;code&gt;13888&lt;/code&gt; 三个端口，重新启动，即可正常启动。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/zookeeper/">Zookeeper</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Redis 概述</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-summary/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-summary/</guid>
                <pubDate>Wed, 27 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍 Redis 的特点及优势，还有它和其他键值数据库的区别。&lt;/p&gt;
&lt;h3 id=&#34;redis-简介&#34;&gt;Redis 简介&lt;/h3&gt;
&lt;p&gt;REmote DIctionary Server，缩写为：Redis，是一个高性能的 key-value 数据库。&lt;/p&gt;
&lt;p&gt;Redis 是一个开源的使用 ANSI C 语言编写、遵守 BSD 协议、支持网络、可基于内存、也可持久化的日志型、Key-Value 数据库，并提供多种编程语言的 API。&lt;/p&gt;
&lt;p&gt;它通常被称为数据结构服务器，因为值可以是字符串，哈希表，列表， 集合和有序集合等类型。&lt;/p&gt;
&lt;h3 id=&#34;redis-特点&#34;&gt;Redis 特点&lt;/h3&gt;
&lt;p&gt;Redis 与其他 key - value 缓存产品有以下三个特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Redis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Redis不仅仅支持简单的 key-value 类型的数据，同时还提供 list、set、zset、hash 等数据结构的存储。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Redis 支持数据的备份，即 master-slave 模式的数据备份。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;redis-优势&#34;&gt;Redis 优势&lt;/h3&gt;
&lt;p&gt;Redis 的优势包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;性能极高：Redis能读的速度是 110000 次/s，写的速度是 81000 次/s。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;丰富的数据类型：Redis支持字符串、列表、哈希表、 集合及有序集合等大多数数据类型操作。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;原子性：Redis 的所有操作都是原子性的，同时 Redis 还支持对几个操作全并后的原子性执行。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;丰富的特性：Redis 还支持发布/订阅，通知，键过期等特性。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;redis-与其他键值数据库的区别&#34;&gt;Redis 与其他键值数据库的区别：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Redis 有着更为复杂的数据结构并且提供对它们的原子性操作，这是一个不同于其他键值数据库的进化路径。Redis 的数据类型都是基于基本数据结构的同时对程序员透明，无需进行额外的抽象。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Redis 运行在内存中，但是可以持久化到磁盘，所以在对不同数据集进行高速读写时需要权衡内存，因为数据量不能大于硬件内存。在内存数据库方面的另一个优点是，相比在磁盘上相同的复杂的数据结构，在内存中操作起来非常简单，这样 Redis 可以做很多内部复杂性很强的事情。同时，在磁盘格式方面它们是紧凑的以追加的方式产生的，因为他们并不需要进行随机访问。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Git 常用命令备忘录</title>
                <link>https://xdhuxc.github.io/posts/mixed/git/git-common-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/git/git-common-command/</guid>
                <pubDate>Tue, 19 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了一些 git 使用过程中常用的命令，方便查看。&lt;/p&gt;
&lt;h3 id=&#34;git-命令&#34;&gt;Git 命令&lt;/h3&gt;
&lt;h4 id=&#34;tag&#34;&gt;tag&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;tag 命令用于创建一个标签，表示一个提交点，默认情况下，基于本地当前分支的最后一个提交创建标签。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、创建本地标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git tag tagName
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、推送至远程仓库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git push origin tagName
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、查看某个 tag 的信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git show tagName
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、查看本地所有 tag&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git tag -l
或
git tag
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、基于某个特定的提交创建标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git log --pretty=oneline    # 查看当前分支的提交历史，其中包含提交 ID
git tag -a tagName commitID # 基于特定的 commitID 提交创建标签
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、查看远程所有标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git ls-remote --tags origin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、删除标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git tag -d tagName       # 删除本地标签
git push origin :tagName # 删除远程标签
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、重命名标签，采取的方法是：删除旧标签，创建新标签的策略&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 如果标签只存在于本地，那么只需要删除本地旧标签，创建新的标签即可
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;git tag oldTagName
git tag newTagName
git push origin newTagName
&lt;span class=&#34;gh&#34;&gt;# 如果标签已经推送至远程，则不仅要删除本地的，还要删除远程的，再重新创建和推送
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;git tag -d oldTagName
git push origin:oldTagName
git tag newTagName
git push origin newTagName
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;9、迁出标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git checkout -b branchName tagName
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;clone&#34;&gt;clone&lt;/h4&gt;
&lt;p&gt;1、迁出指定标签的代码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git clone --branch tagName git@github.xdhuxc/xdhuxc.git
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;remote&#34;&gt;remote&lt;/h4&gt;
&lt;p&gt;1、列出已经存在的远程分支&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:xdhuxc wanghuan$ git remote
origin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、列出已经存在的远程分支的地址&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:xdhuxc wanghuan$ git remote get-url origin
git@github.xdhuxc/xdhuxc.git
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、添加远程仓库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git remote add origin git@github.xdhuxc/xdhuxc.git
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;head&#34;&gt;head&lt;/h4&gt;
&lt;p&gt;HEAD指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令git reset --hard commit_id&lt;/p&gt;
&lt;p&gt;在Git中，用HEAD表示当前版本，上一个版本就是HEAD^，上上一个版本就是HEAD^^，当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100&lt;/p&gt;
&lt;h4 id=&#34;log&#34;&gt;log&lt;/h4&gt;
&lt;p&gt;可以查看提交历史，包括提交的时间，作者，和提交是的说明（即-m 命令后的内容），以便确定要回退到哪个版本。&lt;/p&gt;
&lt;h4 id=&#34;relog&#34;&gt;relog&lt;/h4&gt;
&lt;p&gt;查看命令历史，查到每次提交的id号，即commit id,以及提交时的说明，以便确定要回到未来的哪个版本。&lt;/p&gt;
&lt;h3 id=&#34;从功能到命令&#34;&gt;从功能到命令&lt;/h3&gt;
&lt;h4 id=&#34;切换分支&#34;&gt;切换分支&lt;/h4&gt;
&lt;p&gt;1、使用本地 git 命令创建新分支&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git branch xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、切换到新分支，master 分支上的内容自动同步&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git checkout xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、将新分支发布到 github 上&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git push origin xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;git-将一个本地工程推向多个远程仓库&#34;&gt;git 将一个本地工程推向多个远程仓库&lt;/h4&gt;
&lt;p&gt;推送时，可以同时推送至多个远程仓库
1、添加另外一个远程仓库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git remote set-url --add origin git@github.com:xdhuxc/xdhuxc.git
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、推送&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git push origin master:master
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;设置本地分支对应的远程分支&#34;&gt;设置本地分支对应的远程分支&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;git branch --set-upstream-to=origin/s0.20.2 s0.20.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此命令将本地分支 &lt;code&gt;s0.20.2&lt;/code&gt; 对应的远程分支设置为 &lt;code&gt;s0.20.2&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;生成ssh-key&#34;&gt;生成SSH-key&lt;/h4&gt;
&lt;p&gt;github的SSH配置如下：&lt;/p&gt;
&lt;p&gt;1、设置GitHub用户的用户名和邮箱
设置命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt; git config --global user.name &amp;#34;xdhuxc&amp;#34; &lt;span class=&#34;ni&#34;&gt;#设置GitHub用户的用户名&lt;/span&gt;

git config --global user.email &amp;#34;xdhuxc@163.com&amp;#34; &lt;span class=&#34;ni&#34;&gt;#设置GitHub用户的邮箱&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看是否已经有了ssh密钥：&lt;code&gt;cd ~/.ssh&lt;/code&gt;，如果没有密钥则不会有此文件夹，有则备份删除；生成密钥：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ssh-keygen -t rsa -C &amp;#34;xdhuxc@163.com&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;按三个“Enter”，密码为空，在此过程中，将会在 &lt;code&gt;~/.ssh&lt;/code&gt; 目录下生成 &lt;code&gt;id_rsa&lt;/code&gt; 和 &lt;code&gt;id_rsa.pub&lt;/code&gt; 两个文件。&lt;/p&gt;
&lt;p&gt;3、在github上添加SSH密钥，即添加id_rsa.pub文件中的内容至“settings”-&amp;gt;“SSH and GPG keys”。&lt;/p&gt;
&lt;p&gt;4、测试是否能够连接成功。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ssh git@github.com
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/git/">Git</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 iptraf 观察端口网络流量</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-iptraf-network-flow/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-iptraf-network-flow/</guid>
                <pubDate>Tue, 19 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细记录了在 Linux 系统中使用 iptraf 进行端口流量观察的方法，可以帮助我们分析应用程序端口的网络流入和网络流出。&lt;/p&gt;
&lt;p&gt;iptraf 是一个基于ncurses开发的IP局域网监控工具，可以实时地监视网卡流量，可以生成各种网络统计数据，包括TCP信息、UDP统计、ICMP和OSPF信息、以太网负载信息、节点统计、IP校验和错误和其他一些信息。&lt;/p&gt;
&lt;h3 id=&#34;观察端口网络流量&#34;&gt;观察端口网络流量&lt;/h3&gt;
&lt;p&gt;1、安装 &lt;code&gt;iptraf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y iptraf-ng-1.1.4-6.el7.x86_64
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动 &lt;code&gt;iptraf-ng&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptraf-ng
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;进入如下页面：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG626.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;使用 &lt;code&gt;↑&lt;/code&gt; 或 &lt;code&gt;↓&lt;/code&gt;，选择 &lt;code&gt;Configure&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG627.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;按 &lt;code&gt;Enter&lt;/code&gt;，进入设置页面，&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG628.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;进行适当的配置，可以让统计的结果更直观，信息更加丰富。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Reverse DNS lookups：查看连接的IP所对应的域名，在IP traffic monitor的pkt captured 对话框中就可以看到域名结果，这个不是很直观，开启后会有点影响抓包性能。&lt;/li&gt;
&lt;li&gt;TCP/UDP service names：在有端口的地方都会把端口号换成相应的服务名，非常有用，很直观。&lt;/li&gt;
&lt;li&gt;Activity mode：显示流量是按Kbits/s还是Kbytes/s，改为Kbytes，更符合习惯。&lt;/li&gt;
&lt;li&gt;Additional ports：按端口号监控额外需要监控的端口，默认只监控小于1024的。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;选择 &lt;code&gt;Additional ports&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG629.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;按 &lt;code&gt;Enter&lt;/code&gt;，进入端口设置页面，设置端口范围为：&lt;code&gt;1024~10000&lt;/code&gt;，按 &lt;code&gt;Tab&lt;/code&gt; 键跳转至第二个输入框。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG630.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;按 &lt;code&gt;Enter&lt;/code&gt; 键保存端口设置。然后退出配置页面&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG631.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;退出 &lt;code&gt;iptraf&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG632.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;3、重新打开iptraf&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptraf-ng
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;选择 &lt;code&gt;Statistical breakdowns&lt;/code&gt;，&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG633.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;按 &lt;code&gt;Enter&lt;/code&gt; 键，选择 &lt;code&gt;By TCP/UDP port&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG634.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;选择待检测的网卡 &lt;code&gt;ens192&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG635.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;按 &lt;code&gt;Enter&lt;/code&gt; 键，就可以看到此网卡上的端口对应的协议类型和网络流量了。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG636.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;按 &lt;code&gt;S&lt;/code&gt; 键，对输出信息进行排序&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG637.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;按 &lt;code&gt;B&lt;/code&gt; 键，按照总的字节数进行排序&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/iptraf-network-flow/WechatIMG638.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;按 &lt;code&gt;X&lt;/code&gt; 键退出。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cnblogs.com/taosim/articles/4030292.html&#34;&gt;https://www.cnblogs.com/taosim/articles/4030292.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/quiet_girl/article/details/50777210&#34;&gt;https://blog.csdn.net/quiet_girl/article/details/50777210&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/iptraf/">iptraf</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 docker 容器方式部署 MySQL 数据库管理工具 phpMyAdmin</title>
                <link>https://xdhuxc.github.io/posts/storage/mysql/mysql-phpmyadmin-with-docker/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/mysql/mysql-phpmyadmin-with-docker/</guid>
                <pubDate>Tue, 12 Jun 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了基于 docker 容器方式部署 MySQL 数据库管理工具 phpMyAdmin 的方法。&lt;/p&gt;
&lt;h3 id=&#34;phpmyadmin&#34;&gt;phpmyadmin&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;phpmyadmin&lt;/code&gt; 是一个 &lt;code&gt;MySQL&lt;/code&gt; 数据库管理工具，使用 &lt;code&gt;phpmyadmin&lt;/code&gt; 实现在网页中连接、操作数据库，实现数据迁移。使用前，必须确保主机上数据库 &lt;code&gt;mysqld&lt;/code&gt; 服务已经启动。&lt;/p&gt;
&lt;p&gt;1、拉取 phpMyAdmin 镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull phpmyadmin/phpmyadmin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动 phpMyAdmin 镜像&lt;/p&gt;
&lt;p&gt;连接单个数据库时启动 phpmyadmin 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run --name=myadmin -p 8080:80 -e PMA_HOST=192.168.244.128 -e MYSQL_ROOT_PASSWORD=286X326_h -d phpmyadmin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;PMA_HOST：待连接的 MySQL 数据库服务器所在主机；
MYSQL_ROOT_PASSWORD：MySQL 数据库 root 用户密码；
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、在同一个页面中连接多个数据库时启动 phpmyadmin 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run --name=myadmin -p 8080:80 -e PMA_HOSTS=192.168.244.128,192.168.244.134 -e PMA_ARBITRARY=1 -d phpmyadmin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;PMA_HOSTS：待连接的 MySQL 数据库所在主机 IP 地址，多个 IP 地址以 &lt;span class=&#34;sb&#34;&gt;`,`&lt;/span&gt; 分隔；
PMA_ARBITRARY：允许连接多个 MySQL 数据库；
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/* Arbitrary server connection */                                     
if (isset($_ENV[&amp;#39;PMA_ARBITRARY&amp;#39;]) &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; $_ENV[&amp;#39;PMA_ARBITRARY&amp;#39;] === &amp;#39;1&amp;#39;) {                              
    $cfg[&amp;#39;AllowArbitraryServer&amp;#39;] = true;                                                            
} 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、访问 phpMyAdmin&lt;/p&gt;
&lt;p&gt;访问地址为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.1.161:8080
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在启动容器时，更改端口后访问地址为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.1.161:8090/
或
http://172.20.1.161:8090/index.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在MySQL服务器所在主机上，以root用户登陆进去，执行如下命令，为用户赋予远程访问权限：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;GRANT ALL PRIVILEGES ON &lt;span class=&#34;ge&#34;&gt;*.*&lt;/span&gt; TO &amp;#39;root&amp;#39;@&amp;#39;172.17.0.2&amp;#39; IDENTIFIED BY &amp;#39;286X326_h&amp;#39; WITH GRANT OPTION;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;286X326_h为数据库root用户密码&lt;/p&gt;
&lt;h3 id=&#34;将-phpmyadmin-嵌入其他页面&#34;&gt;将 phpMyAdmin 嵌入其他页面&lt;/h3&gt;
&lt;p&gt;进入容器中，复制 &lt;code&gt;/www/libraries/config.default.php&lt;/code&gt; 到 &lt;code&gt;/www&lt;/code&gt; 目录下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp /www/libraries/config.default.php /www/config.inc.php
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;更改 &lt;code&gt;/www/config.inc.php&lt;/code&gt; 的配置参数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$cfg[&amp;#39;AllowThirdPartyFraming&amp;#39;] = true; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 &lt;code&gt;/www/libraries/Header.php&lt;/code&gt; 文件中的 sendHttpHeaders 函数，将 &lt;code&gt;X-Frame-Options &lt;/code&gt;由 &lt;code&gt;deny&lt;/code&gt; 改为 &lt;code&gt;ALLOW-FROM&lt;/code&gt;，并加入待嵌入页面的地址，例如：&lt;code&gt;ALLOW-FROM http://123.103.9.208:6081/#outer/index/28&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt; if (! $GLOBALS[&amp;#39;cfg&amp;#39;][&amp;#39;AllowThirdPartyFraming&amp;#39;]) {                                          
            header(                                                                                 
                &amp;#39;X-Frame-Options: ALLOW-FROM http://123.103.9.208:6081/#outer/index/28&amp;#39;             
            );                                                                                      
        }             
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 &lt;code&gt;/www/js/cross_framing_protection.js&lt;/code&gt; 文件中的内容如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/* vim: set expandtab sw=4 ts=4 sts=4: */
/**
 &lt;span class=&#34;k&#34;&gt;*&lt;/span&gt; Conditionally included if framing is not allowed
 */
if (self == top) {
    document.documentElement.style.display = &amp;#39;block&amp;#39;;
    //var style_element = document.getElementById(&amp;#34;cfs-style&amp;#34;);
    // check if style_element has already been removed
    // to avoid frequently reported js error
    //if (typeof(style_element) != &amp;#39;undefined&amp;#39; &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; style_element != null) {
    //    style_element.parentNode.removeChild(style_element);
    //}
} else {
    //top.location = self.location;
    document.documentElement.style.display = &amp;#39;block&amp;#39;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;phpmyadmin同步功能 &lt;a href=&#34;http://www.360doc.com/content/12/1204/15/1440938_252069458.shtml&#34;&gt;http://www.360doc.com/content/12/1204/15/1440938_252069458.shtml&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;嵌入其他页面，需要修改配置 &lt;a href=&#34;http://blog.csdn.net/l6807718/article/details/51179507&#34;&gt;http://blog.csdn.net/l6807718/article/details/51179507&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;解决问题的 &lt;a href=&#34;http://vps.gl/vps/161.html&#34;&gt;http://vps.gl/vps/161.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;官方文档 &lt;a href=&#34;https://docs.phpmyadmin.net/en/latest/setup.html#installing-using-docker&#34;&gt;https://docs.phpmyadmin.net/en/latest/setup.html#installing-using-docker&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在centos中安装phpmyadmin，包括安装httpd，php &lt;a href=&#34;http://www.cnblogs.com/xjxz/p/6550397.html&#34;&gt;http://www.cnblogs.com/xjxz/p/6550397.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/mysql/">MySQL</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/phpmyadmin/">phpMyAdmin</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 中配置时间同步</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-ntp/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-ntp/</guid>
                <pubDate>Sat, 19 May 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 Linux 系统中使用 NTP 进行时间同步的方法。&lt;/p&gt;
&lt;p&gt;1、将Linux系统时钟同步到远程NTP服务器，需要在系统上安装NTP以实现与NTP服务器的自动时间同步，要开始自动时间同步到远程NTP服务器，使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;timedatectl set-ntp true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行该命令后，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# timedatectl set-ntp true
Failed to set ntp: NTP not supported.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;检查本机是否安装了 &lt;code&gt;ntp&lt;/code&gt; 客户端，如果没有，使用如下命令安装：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y ntp
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、重启 &lt;code&gt;ntp&lt;/code&gt; 客户端并设置开机启动&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl restart ntpd
systemctl enable ntpd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、可看到 &lt;code&gt;NTP synchronized&lt;/code&gt; 已经为 &lt;code&gt;yes&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# timedatectl 
      Local time: Sat 2019-12-28 11:52:05 CST
  Universal time: Sat 2019-12-28 03:52:05 UTC
        RTC time: Sat 2019-12-28 03:52:04
       Time zone: Asia/Shanghai (CST, +0800)
     NTP enabled: yes
NTP synchronized: yes
 RTC in local TZ: no
      DST active: n/a
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、要禁用NTP时间同步，使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;timedatectl set-ntp false
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/ntp/">NTP</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Ansible 学习之简单入门</title>
                <link>https://xdhuxc.github.io/posts/devops/ansible/ansible-playbook/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/ansible/ansible-playbook/</guid>
                <pubDate>Mon, 14 May 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了 Ansible Playbook 的使用方法。&lt;/p&gt;
&lt;h3 id=&#34;ansible-playbook&#34;&gt;Ansible Playbook&lt;/h3&gt;
&lt;p&gt;ansible playbook 是一系列 ansible 命令的集合，使用 yaml 语言编写，playbook 命令根据自上而下的顺序依次执行。Ansible 可以完成一组复杂的动作，例如部署环境、搭建服务、修改配置等。Ansible 可以允许传输某个命令的状态到后面的指令，例如，我们可以从一台机器的文件中抓取内容并赋为变量，然后在另外一台机器中使用，这使得我们可以实现一些复杂的部署机制，这是 ansible 命令所无法实现的。&lt;/p&gt;
&lt;p&gt;ansible-playbook 的简单使用方法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ansible-playbook ./xdhuxc-play.yaml # 执行 xdhuxc-play.yaml 文件
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;简单示例&#34;&gt;简单示例&lt;/h4&gt;
&lt;p&gt;下面是一个简单的 ansible-playbook 的示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: create user
    hosts: all
    user: root
    gather_facts: false
    vars:
      user: &amp;#34;xdhuxc&amp;#34;
    tasks:
      &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: create user
          user: name=&amp;#34;{{user}}&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上 playbook 实现的功能是：新增一个用户&lt;/p&gt;
&lt;p&gt;说明如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;name：对该 playbook 实现的功能做一个描述，后面执行过程中，会打印 name 变量的值；&lt;/li&gt;
&lt;li&gt;hosts：指定了要进行操作的主机。&lt;/li&gt;
&lt;li&gt;user：指定了登录远程主机操作的用户。&lt;/li&gt;
&lt;li&gt;gather_facts：指定了在以下任务部分执行前，是否先执行 setup 模块获取主机相关信息。&lt;/li&gt;
&lt;li&gt;vars：指定变量。这里指定一个变量 user，其值为 xdhuxc，需要注意，变量值一定要使用双引号引住。&lt;/li&gt;
&lt;li&gt;task：指定了一个任务，其下面的 name 参数同样是对任务的描述，在执行过程中会打印出来。user 指定了调用 user 模块，name 是 user 模块里的一个参数，而增加的用户名字调用了上面 vars 中的 user 变量的值。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果想实现删除用户，只需要将该 playbook 文件的最后一行替换为如下行：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;user: name=&amp;#34;{{user}}&amp;#34; state=absent remove=yes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;通过-playbook-安装-apache-示例&#34;&gt;通过 PlayBook 安装 Apache 示例&lt;/h4&gt;
&lt;p&gt;通过 ansible-playbook 实现对多台主机同时安装 apache。需要注意的是，多台被管理主机的操作系统可能不同，从而apache包名不同。假设同时存在 CentOS 和 Debian 两种操作系统。具体 PlayBook 内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 安装 apache
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; hosts: all
  remote_user: root
  gather_facts: True
  tasks:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: install apache on CentOS
      yum: 
        name: httpd
        state: latest
      when: ansible_os_family == &amp;#34;CentOS&amp;#34;
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: install apache on Debian
      yum: 
        name: apache2
        state: latest
      when: ansible_os_family == &amp;#34;Debian&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上 playbook 使用了 when 语句，同时也开启了 gather_facts setup 模块，这里的 ansible_os_family 变量就是直接使用 setup 模块获取的信息。如果有大量主机，就在运行的时候加上 -f 选项，然后指定一个合适的并发主机数量即可。&lt;/p&gt;
&lt;h4 id=&#34;playbook-的构成&#34;&gt;PlayBook 的构成&lt;/h4&gt;
&lt;p&gt;playbook 是由一个或多个 play 组成的列表，play 的主要功能在于将事先归并为一组的主机修饰成通过 ansible 中的 task 定义好的角色。从根本上来讲，task 其实就是调用 ansible 的一个 module。将多个 play 组织在一个 playbook 中，即可让他们联动起来按照事先编排的顺序共同完成任务。&lt;/p&gt;
&lt;p&gt;PlayBook 主要由以下四部分组成：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Target section：定义将要执行 playbook 的远程主机组。&lt;/li&gt;
&lt;li&gt;Variable section：定义 playbook 运行时需要使用的变量。&lt;/li&gt;
&lt;li&gt;Task section：定义将要在远程主机上执行的任务列表。&lt;/li&gt;
&lt;li&gt;Handler section：定义 task 执行完成以后需要调用的任务。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;而其一般所需的目录层为如下五个：（视具体情况可变化）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;vars 变量层&lt;/li&gt;
&lt;li&gt;tasks 任务层&lt;/li&gt;
&lt;li&gt;handlers 触发条件&lt;/li&gt;
&lt;li&gt;files 文件&lt;/li&gt;
&lt;li&gt;template 模板&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;hosts-和-users&#34;&gt;Hosts 和 Users&lt;/h5&gt;
&lt;p&gt;PlayBook 中的每一个 play 的目的都是为了让某个或某些主机以某个指定的用户身份执行任务。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;hosts：用于指定要执行指定任务的主机，可以是一个或多个由冒号分隔的主机组。&lt;/li&gt;
&lt;li&gt;remote_user：用于指定远程主机上的执行任务的用户。不过 remote_user 也可用于各 task 中，也可以通过指定 sudo 的方式在远程主机上执行任务，其可用于 play 全局或某任务。此外，还可以在 sudo 时，使用 sudo_user 指定 sudo 时切换的用户。&lt;/li&gt;
&lt;li&gt;user：与 remote_user 相同。&lt;/li&gt;
&lt;li&gt;sudo：如果设置为 yes，执行该任务组的用户在执行任务的时候，获取 root 权限。&lt;/li&gt;
&lt;li&gt;sudo_user：如果设置 user 为 xdhuxc，sudo 为 yes，sudo_user 为 wanghuan 时，则 xdhuxc 用户在执行任务时会获得 wanghuan 用户的权限。&lt;/li&gt;
&lt;li&gt;connection：连接到远程主机的方式，默认为 ssh。&lt;/li&gt;
&lt;li&gt;gather_facts：除非明确说明不需要在远程主机上执行 setup 模块，否则默认自动执行。如果确实不需要 setup 模块传递过来的变量，则可以将该选项设置为：False&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;示例如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; hosts: webnodes
  tasks:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: test ping connection
    remote_user: xdhuxc
    sudo: yes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;任务列表和-action&#34;&gt;任务列表和 Action&lt;/h5&gt;
&lt;p&gt;play 的主体部分是任务列表。任务列表中的各任务按次序逐个在 hosts 中指定的所有主机上执行，即在所有主机上完成第一个任务后，再开始第二个。在自上而下运行某 playbook 时，如果中途发生错误，所有已执行任务都将回滚。因此，发生错误时，修正 playbook 后重新执行一次即可。&lt;/p&gt;
&lt;p&gt;task 的目的是使用指定的参数执行模块，而在模块参数中可以使用变量。模块执行是幂等的，这意味着多次执行是安全的，因为其结果均一致。每个 task 都应该有其 name，用于 playbook 的执行结果输出，建议其内容尽可能清晰地描述任务执行步骤。如果未提供 name，则 action 的结果将用于输出。&lt;/p&gt;
&lt;p&gt;定义 task 的可以使用 &amp;quot;action: module options&amp;quot; 或 &amp;quot;module: options&amp;quot; 的格式，推荐使用后者以实现向后兼容。如果 action 一行的内容过多，也可以使用在行首使用几个空白字符进行换行。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tasks:
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: make sure apache is running
  service: 
    name: httpd 
    state: running
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在众多的模块中，只有 command 和 shell 模块仅需要给定一个列表，而无需使用“key=value”格式，例如&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tasks:
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: disable selinux
  command: /sbin/setenforce 0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果命令或脚本的退出码不为零，可以使用如下方式替代：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;task:
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: run this command and ignore the result
  shell: /usr/bin/ls || /bin/true
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 ignore_errors 来忽略错误信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;task:
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: run this command and ignore the result
  shell: /usr/bin/dockerd
  ignore_errors: True
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;handlers&#34;&gt;handlers&lt;/h5&gt;
&lt;p&gt;handlers 用于当关注的资源发生变化时采取一定的操作。&lt;/p&gt;
&lt;p&gt;notify 这个 action 可用于在每个 play 的最后被触发，这样可以避免多次有改变发生时，每次都执行指定的操作，取而代之仅在所有的变化发生完成后一次性地执行指定操作。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;notify&lt;/code&gt; 中列出的操作称为 &lt;code&gt;handler&lt;/code&gt;，也即 &lt;code&gt;notify&lt;/code&gt; 中调用 &lt;code&gt;handler&lt;/code&gt; 中定义的操作。&lt;/p&gt;
&lt;p&gt;注意，在 &lt;code&gt;notify&lt;/code&gt; 中定义内容一定要和 &lt;code&gt;task&lt;/code&gt; 中定义的 &lt;code&gt;- name&lt;/code&gt; 内容一样，这样才能达到触发的效果，否则会不生效。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: template configuration file
    template: 
      src: /srv/httpd.j2
      dest: /etc/httpd.conf
    notify:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; restart memcached
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; restart apache
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;handler 是 task 列表的这些 task，与前述的 task 并没有本质上的不同&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;handlers:
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: restart memcached
 service: 
   name: memcached
   state: restarted
&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: restart apache
 service:
   name: apache
   state: restarted 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;tags&#34;&gt;tags&lt;/h5&gt;
&lt;p&gt;tags 用于让用户选择运行或略过 playbook 中的部分代码。ansible 具有幂等性，因此会自动跳过没有变化的部分，即便如此，有些代码为测试其确实没有发生变化的时间依然会非常地长。此时，如果确信其没有变化就可以通过 tags 跳过这些代码片段。&lt;/p&gt;
&lt;h5 id=&#34;完整的-playbook-示例&#34;&gt;完整的 PlayBook 示例&lt;/h5&gt;
&lt;p&gt;/etc/ansible/hosts 文件配置如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[client]
10.10.24.32
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;一个安装 httpd web 服务器的示例 yaml&lt;/p&gt;
&lt;p&gt;/etc/ansible/playbook/install_web.yaml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; hosts: client
  vars:
    http_port: 80
    max_clients: 200
  remote_user: root
  tasks:
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: ensure apache is the latest version
    yum:
      name: httpd
      state: latest
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: write the apache config file
    template:
      src: /root/httpd.j2
      dest: /etc/httpd.conf
    notify:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; restart apache
  &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: ensure apache is running and enable it at boot
    service:
      name: httpd
      state: started
      enabled: yes
  handlers:
    &lt;span class=&#34;k&#34;&gt;-&lt;/span&gt; name: restart apache
      service:
        name: httpd
        state: restarted
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在安装 ansible 的机器上，运行如下命令执行该 playbook&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc roles]# pwd
/etc/ansible/roles
[root@xdhuxc roles]# ls
install_web.retry  install_web.yaml
[root@xdhuxc roles]# ansible-playbook ./install_web.yaml 

PLAY [client] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;***********************************************************************************************************************************************************

TASK [Gathering Facts] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;**************************************************************************************************************************************************
ok: [10.10.24.32]

TASK [ensure apache is the latest version] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;******************************************************************************************************************************
ok: [10.10.24.32]

TASK [write the apache config file] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;*************************************************************************************************************************************
changed: [10.10.24.32]

TASK [ensure apache is running and enable it at boot] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;*******************************************************************************************************************
changed: [10.10.24.32]

RUNNING HANDLER [restart apache] &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;****************************************************************************************************************************************
changed: [10.10.24.32]

PLAY RECAP &lt;span class=&#34;ge&#34;&gt;**&lt;/span&gt;**************************************************************************************************************************************************************
10.10.24.32                : ok=5    changed=3    unreachable=0    failed=0   
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/ansible/">Ansible</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Ansible 学习之简单入门</title>
                <link>https://xdhuxc.github.io/posts/devops/ansible/ansible-simple-use/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/ansible/ansible-simple-use/</guid>
                <pubDate>Mon, 14 May 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Ansible 的特点，和 SaltStack 的对比及其原理。&lt;/p&gt;
&lt;h3 id=&#34;ansible-简介&#34;&gt;Ansible 简介&lt;/h3&gt;
&lt;p&gt;Ansible 是一种集成IT系统的配置管理、应用部署、执行特定任务的运维工具。&lt;/p&gt;
&lt;p&gt;Ansible 基于 Python 语言实现，由 Paramiko（由 Python 实现的高质量 OpenSSH 库） 和 PyYAML 两个关键模块构建。&lt;/p&gt;
&lt;h3 id=&#34;ansible-特点&#34;&gt;Ansible 特点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;部署简单，只需要在主控端部署 ansible 环境，被控端无需做任何操作。&lt;/li&gt;
&lt;li&gt;默认使用 SSH（Secure Shell）协议对设备进行管理。&lt;/li&gt;
&lt;li&gt;主从集中化管理。&lt;/li&gt;
&lt;li&gt;配置简单，功能强大，扩展性强。&lt;/li&gt;
&lt;li&gt;支持 API 及自定义模块，可通过 Python 轻松扩展。&lt;/li&gt;
&lt;li&gt;通过 Playbooks 来定制强大的配置，状态管理。&lt;/li&gt;
&lt;li&gt;对云计算平台，大数据都有很好的支持。&lt;/li&gt;
&lt;li&gt;提供一个功能强大、操作性强的 Web 管理界面和 REST API 接口--- AWX 平台。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ansible-与-saltstack&#34;&gt;Ansible 与 SaltStack&lt;/h3&gt;
&lt;h4 id=&#34;相同点&#34;&gt;相同点&lt;/h4&gt;
&lt;p&gt;都具备功能强大、灵活的系统管理、状态配置，都使用 YAML 格式来描述配置，两者都提供丰富的模板及 API，对云计算和大数据都有很好的支持。&lt;/p&gt;
&lt;h4 id=&#34;区别&#34;&gt;区别&lt;/h4&gt;
&lt;p&gt;最大的区别是 Ansible 无需在被监控主机部署任何客户端代理，默认通过 SSH 通道进行远程命令执行或下发配置。&lt;/p&gt;
&lt;h3 id=&#34;ansible-使用&#34;&gt;Ansible 使用&lt;/h3&gt;
&lt;h4 id=&#34;ansible-安装&#34;&gt;ansible 安装&lt;/h4&gt;
&lt;p&gt;使用 YUM 安装 ansible&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;yum install -y ansible
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;ansible-配置文件&#34;&gt;ansible 配置文件&lt;/h4&gt;
&lt;p&gt;ansible 的配置文件在 &lt;code&gt;/etc/ansible&lt;/code&gt; 目录下&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ls /etc/ansible/
ansible.cfg  hosts  roles
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ansible.cfg 是 ansible 工具的配置文件&lt;/li&gt;
&lt;li&gt;hosts 用来配置被管理的机器&lt;/li&gt;
&lt;li&gt;roles 是一个目录，playbook 将使用它。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ansible-使用-1&#34;&gt;ansible 使用&lt;/h4&gt;
&lt;p&gt;（1）ansible 管理机与被管理机做秘钥认证&lt;/p&gt;
&lt;p&gt;使用 ssh-keygen 生成秘钥，一路回车即可。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa):
Created directory &#39;/root/.ssh&#39;.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:dXG3C6BeEXWB0zYCji16agbNndYwJb51Ezw3WxDRiL0 root@xdhuxc
The key&#39;s randomart image is:
+---[RSA 2048]----+
|         . **=BOo|
|        . B +O=B+|
|         B.=.+*o=|
|      o +.X.. E..|
|     . +SB .   . |
|      . +        |
|       +         |
|      o          |
|                 |
+----[SHA256]-----+
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（2）将公钥写入被管理机&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub -p 22 root@192.168.91.130
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &amp;quot;/root/.ssh/id_rsa.pub&amp;quot;
Usage: /usr/bin/ssh-copy-id [-h|-?|-f|-n] [-i [identity_file]] [-p port] [[-o &amp;lt;ssh -o options&amp;gt;] ...] [user@]hostname
	-f: force mode -- copy keys without trying to check if they are already installed
	-n: dry run    -- no keys are actually copied
	-h|-?: print this help
[root@xdhuxc ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub -p 22 root@192.168.91.130
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &amp;quot;/root/.ssh/id_rsa.pub&amp;quot;
The authenticity of host &#39;192.168.91.130 (192.168.91.130)&#39; can&#39;t be established.
ECDSA key fingerprint is SHA256:9Nn+hqVia1ST1/u0qqZP+gVfeLAAwpYCsGgKlZT+8c4.
ECDSA key fingerprint is MD5:5d:ef:7a:42:ec:73:14:d4:de:38:c5:17:83:03:c7:ef.
Are you sure you want to continue connecting (yes/no)? yes（输入yes）
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@192.168.91.130&#39;s password: （输入被管控机密码）

Number of key(s) added: 1

Now try logging into the machine, with:   &amp;quot;ssh -p &#39;22&#39; &#39;root@192.168.91.130&#39;&amp;quot;
and check to make sure that only the key(s) you wanted were added.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（3）hosts 文件中添加被管控机
向 &lt;code&gt;/etc/ansible/hosts&lt;/code&gt; 文件中加入被管控机信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[Client]
192.168.91.130
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（4） 测试 ansible&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m ping  # 操作 Client 组 （all 为操作 hosts 文件中的所有主机）
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-m：指定执行的模块，例如，-m ping，指定执行 ping 模块。&lt;/li&gt;
&lt;li&gt;-i：指定 hosts 文件位置，默认为：/etc/ansible/hosts。&lt;/li&gt;
&lt;li&gt;-u：指定 SSH 连接的用户名。&lt;/li&gt;
&lt;li&gt;-k：指定远程用户密码。&lt;/li&gt;
&lt;li&gt;-f：指定并发数。&lt;/li&gt;
&lt;li&gt;-s：连接用户不是 root，但是需要 root 权限时使用。&lt;/li&gt;
&lt;li&gt;-K：使用 -s 选项时，-K 指定输入 root 用户密码。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ansible-原理&#34;&gt;ansible 原理&lt;/h3&gt;
&lt;p&gt;ansible 的命令执行过程：&lt;/p&gt;
&lt;p&gt;1、加载配置文件，默认为：&lt;code&gt;/etc/ansible/ansible.cfg&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;2、匹配主机清单&lt;/p&gt;
&lt;p&gt;3、加载指令对应的模块文件，如command，生成.py的文件到本机的临时目录，这个目录就是在 &lt;code&gt;/etc/ansible/ansible.cfg&lt;/code&gt; 定义的&lt;/p&gt;
&lt;p&gt;4、通过 &lt;code&gt;ansible&lt;/code&gt; 将模块或命令生成对应的临时py文件，并将该文件传输至远程服务器的对应执行用户 &lt;code&gt;$HOME/.ansible/tmp/ansible-tmp-数字/XXX.PY&lt;/code&gt; 文件，这个目录就是在 &lt;code&gt;/etc/ansible/ansible.cfg&lt;/code&gt; 定义的&lt;/p&gt;
&lt;p&gt;5、给文件+x 权限&lt;/p&gt;
&lt;p&gt;6、执行并返回结果&lt;/p&gt;
&lt;p&gt;7、删除临时py文件，sleep 0退出&lt;/p&gt;
&lt;p&gt;8、断开远程主机连接&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;官方文档 &lt;a href=&#34;https://docs.ansible.com/ansible/latest/index.html&#34;&gt;https://docs.ansible.com/ansible/latest/index.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;中文文档 &lt;a href=&#34;http://www.ansible.com.cn/&#34;&gt;http://www.ansible.com.cn/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;调用ansible API 示例 &lt;a href=&#34;https://blog.csdn.net/python_tty/article/details/73822071&#34;&gt;https://blog.csdn.net/python_tty/article/details/73822071&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/ansible/">Ansible</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>RabbitMQ 常用命令总结</title>
                <link>https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-common-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-common-command/</guid>
                <pubDate>Wed, 09 May 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 RabbitMq 的常用命令。&lt;/p&gt;
&lt;p&gt;1、查看插件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rabbitmq-plugins list
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、开启管理插件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rabbitmq-plugins enable rabbitmq_management
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 rabbitmq&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl start rabbitmq-server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、查看 rabbitmq 的状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rabbitmqctl status
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、创建新用户&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rabbitmqctl add_user xdhuxc xdhuxc1994
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、为用户 &lt;code&gt;xdhuxc&lt;/code&gt; 赋予 &lt;code&gt;administrator&lt;/code&gt; 角色&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rabbitmqctl set_user_tags xdhuxc administrator
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、为用户 &lt;code&gt;xdhuxc&lt;/code&gt; 赋予权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rabbitmqctl set_permissions -p / xdhuxc &amp;#39;.*&amp;#39; &amp;#39;.*&amp;#39; &amp;#39;.*&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、查看用户及权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rabbitmqctl list_permissions
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/">消息队列</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/rabbitmq/">RabbitMQ</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Ansible 学习之常用模块</title>
                <link>https://xdhuxc.github.io/posts/devops/ansible/ansible-common-model/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/devops/ansible/ansible-common-model/</guid>
                <pubDate>Wed, 02 May 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了 Ansible 常用模块的用法。&lt;/p&gt;
&lt;h3 id=&#34;模块相关命令&#34;&gt;模块相关命令&lt;/h3&gt;
&lt;p&gt;（1）列出 ansible 支持的模块&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible-doc -l
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;（2）查看该模块的帮助信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible-doc ping # 查看 ping 模块的帮助信息
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;以下实验均是在 IP 地址为： 192.168.91.128 的虚拟机上操作的。
/etc/ansible/hosts 文件中配置如下：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# This is the default ansible &#39;hosts&#39; file.
#
# It should live in /etc/ansible/hosts
#
#   - Comments begin with the &#39;#&#39; character
#   - Blank lines are ignored
#   - Groups of hosts are delimited by [header] elements
#   - You can enter hostnames or ip addresses
#   - A hostname/ip can be a member of multiple groups

# Ex 1: Ungrouped hosts, specify before any group headers.

## green.example.com
## blue.example.com
## 192.168.100.1
## 192.168.100.10
[Client]
192.168.91.130

# Ex 2: A collection of hosts belonging to the &#39;webservers&#39; group

## [webservers]
## alpha.example.org
## beta.example.org
## 192.168.1.100
## 192.168.1.110

# If you have multiple hosts following a pattern you can specify
# them like this:

## www[001:006].example.com

# Ex 3: A collection of database servers in the &#39;dbservers&#39; group

## [dbservers]
##
## db01.intranet.mydomain.net
## db02.intranet.mydomain.net
## 10.25.1.56
## 10.25.1.57

# Here&#39;s another example of host ranges, this time there are no
# leading 0s:

## db-[99:101]-node.example.com

&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;常用模块示例&#34;&gt;常用模块示例&lt;/h3&gt;
&lt;h4 id=&#34;ping-模块&#34;&gt;ping 模块&lt;/h4&gt;
&lt;p&gt;检查指定节点机器能否连通，如果主机在线，则回复pong。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m ping
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;ping&amp;quot;: &amp;quot;pong&amp;quot;
}
[root@xdhuxc ~]#
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;远程命令模块commandscriptshell&#34;&gt;远程命令模块（command、script、shell）&lt;/h5&gt;
&lt;p&gt;command 作为 ansible 的默认模块，可以运行远程权限范围所有的 shell 命令，不支持管道符。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m command -a &amp;quot;free -h&amp;quot; # 查看 Client 分组主机内存使用情况。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行结果为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m command -a &amp;quot;free -h&amp;quot;
192.168.91.130 | SUCCESS | rc=0 &amp;gt;&amp;gt;
              total        used        free      shared  buff/cache   available
Mem:           976M        153M        599M        6.7M        223M        638M
Swap:          2.0G          0B        2.0G

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;script 的功能是在远程主机执行主控端存储的 shell 脚本文件，相当于 scp + shell 组合。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m script -a &amp;quot;/root/xdhuxc.sh string buffer&amp;quot;   # 远程执行本地脚本。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;xdhuxc.sh 脚本的内容为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# pwd
/root
[root@xdhuxc ~]# ls
xdhuxc.sh
[root@xdhuxc ~]# cat xdhuxc.sh
#!/usr/bin/env bash
echo &amp;quot;Hello Shell.&amp;quot;
echo $1
echo $2 &amp;gt;&amp;gt; /root/abc.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行结果为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m script -a &amp;quot;/root/xdhuxc.sh string buffer&amp;quot;
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;rc&amp;quot;: 0,
    &amp;quot;stderr&amp;quot;: &amp;quot;Shared connection to 192.168.91.130 closed.\r\n&amp;quot;,
    &amp;quot;stdout&amp;quot;: &amp;quot;Hello Shell.\r\nstring\r\n&amp;quot;,
    &amp;quot;stdout_lines&amp;quot;: [
        &amp;quot;Hello Shell.&amp;quot;,
        &amp;quot;string&amp;quot;
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在 192.168.91.130上，在 root 目录下，会产生 abc.sh 文件。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# pwd
/root
[root@xdhuxc ~]# ls
abc.sh  anaconda-ks.cfg  ~None
[root@xdhuxc ~]# cat abc.sh
buffer
[root@xdhuxc ~]#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;~None 目录下&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~None]# pwd
/root/~None
[root@xdhuxc ~None]# tree -a
.
└── .ansible
    └── tmp

2 directories, 0 files
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;shell 的功能是执行远程主机上的 shell 脚本文件，支持管道符。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m shell -a &amp;quot;/root/xdhuxc.sh&amp;quot; # 执行远程机器上的脚本。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在 root 目录下创建 xdhuxc.sh 文件，&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# pwd
/root
[root@xdhuxc ~]# ll
total 12
-rw-r--r--  1 root root    7 Jun 11 22:19 abc.sh
-rw-------. 1 root root 1424 Apr  9 21:56 anaconda-ks.cfg
drwx------  3 root root   22 Jun 10 11:55 ~None
-rw-r--r--  1 root root   43 Jun 11 22:34 xdhuxc.sh   # xdhuxc.sh 没有执行权限。
[root@xdhuxc ~]# cat xdhuxc.sh
#!/usr/bin/env bash
echo -n &amp;quot;Hello World!&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在 xdhuxc.sh 没有被赋予执行权限时，执行 ansible 命令。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m shell -a &amp;quot;/root/xdhuxc.sh&amp;quot;
192.168.91.130 | FAILED | rc=126 &amp;gt;&amp;gt;
/bin/sh: /root/xdhuxc.sh: Permission deniednon-zero return code

&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;很明显，xdhuxc.sh 没有可执行权限导致的，修改该命令，重新执行，命令执行成功。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m shell -a &amp;quot;chmod +x /root/xdhuxc.sh ; /root/xdhuxc.sh&amp;quot;
 [WARNING]: Consider using the file module with mode rather than running chmod.  If you need to use command because
file is insufficient you can add warn=False to this command task or set command_warnings=False in ansible.cfg to
get rid of this message.

192.168.91.130 | SUCCESS | rc=0 &amp;gt;&amp;gt;
Hello World!

&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;copy-模块&#34;&gt;copy 模块&lt;/h5&gt;
&lt;p&gt;copy 模块用于实现主控端向目标机器复制文件，类似于 scp 功能。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m copy -a &amp;quot;src=/root/xdhuxc.sh dest=/tmp/ owner=root group=root mode=0755&amp;quot; # 向 Client 组中主机复制 xdhuxc.sh 到 /tmp 目录下，文件属主、属组都为 root，权限为：0755
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行结果如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# pwd
/root
[root@xdhuxc ~]# ls
xdhuxc.sh
[root@xdhuxc ~]# ansible Client -m copy -a &amp;quot;src=/root/xdhuxc.sh dest=/tmp/ owner=root group=root mode=0755&amp;quot;
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;checksum&amp;quot;: &amp;quot;406eb4b32e5fe321308cfd40365f765685d64d58&amp;quot;,
    &amp;quot;dest&amp;quot;: &amp;quot;/tmp/xdhuxc.sh&amp;quot;,
    &amp;quot;gid&amp;quot;: 0,
    &amp;quot;group&amp;quot;: &amp;quot;root&amp;quot;,
    &amp;quot;md5sum&amp;quot;: &amp;quot;1abf4cb799e8858ab96bb7035837f248&amp;quot;,
    &amp;quot;mode&amp;quot;: &amp;quot;0755&amp;quot;,
    &amp;quot;owner&amp;quot;: &amp;quot;root&amp;quot;,
    &amp;quot;size&amp;quot;: 72,
    &amp;quot;src&amp;quot;: &amp;quot;~None/.ansible/tmp/ansible-tmp-1528728245.0-152168028566440/source&amp;quot;,
    &amp;quot;state&amp;quot;: &amp;quot;file&amp;quot;,
    &amp;quot;uid&amp;quot;: 0
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在 192.168.91.130 机器上&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~None]# pwd
/root/~None
[root@xdhuxc ~None]# tree -a
.
└── .ansible
    └── tmp
        └── ansible-tmp-1528728229.03-131422320501562

3 directories, 0 files
[root@xdhuxc ~None]# ls /tmp
xdhuxc.sh
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;stat-模块&#34;&gt;stat 模块&lt;/h5&gt;
&lt;p&gt;stat 模块用于获取远程文件状态信息，atime/ctime/mtime/md5/uid/gid等信息。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m stat -a &amp;quot;path=/etc/sysctl.conf&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行结果如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m stat -a &amp;quot;path=/etc/resolv.conf&amp;quot;
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;stat&amp;quot;: {
        &amp;quot;atime&amp;quot;: 1528725838.9349997,
        &amp;quot;attr_flags&amp;quot;: &amp;quot;&amp;quot;,
        &amp;quot;attributes&amp;quot;: [],
        &amp;quot;block_size&amp;quot;: 4096,
        &amp;quot;blocks&amp;quot;: 8,
        &amp;quot;charset&amp;quot;: &amp;quot;us-ascii&amp;quot;,
        &amp;quot;checksum&amp;quot;: &amp;quot;dfebfbbbb5ea787130ffb53eaab925c743f50a56&amp;quot;,
        &amp;quot;ctime&amp;quot;: 1528725836.281,
        &amp;quot;dev&amp;quot;: 64768,
        &amp;quot;device_type&amp;quot;: 0,
        &amp;quot;executable&amp;quot;: false,
        &amp;quot;exists&amp;quot;: true,
        &amp;quot;gid&amp;quot;: 0,
        &amp;quot;gr_name&amp;quot;: &amp;quot;root&amp;quot;,
        &amp;quot;inode&amp;quot;: 17073255,
        &amp;quot;isblk&amp;quot;: false,
        &amp;quot;ischr&amp;quot;: false,
        &amp;quot;isdir&amp;quot;: false,
        &amp;quot;isfifo&amp;quot;: false,
        &amp;quot;isgid&amp;quot;: false,
        &amp;quot;islnk&amp;quot;: false,
        &amp;quot;isreg&amp;quot;: true,
        &amp;quot;issock&amp;quot;: false,
        &amp;quot;isuid&amp;quot;: false,
        &amp;quot;mimetype&amp;quot;: &amp;quot;text/plain&amp;quot;,
        &amp;quot;mode&amp;quot;: &amp;quot;0644&amp;quot;,
        &amp;quot;mtime&amp;quot;: 1528725836.281,
        &amp;quot;nlink&amp;quot;: 1,
        &amp;quot;path&amp;quot;: &amp;quot;/etc/resolv.conf&amp;quot;,
        &amp;quot;pw_name&amp;quot;: &amp;quot;root&amp;quot;,
        &amp;quot;readable&amp;quot;: true,
        &amp;quot;rgrp&amp;quot;: true,
        &amp;quot;roth&amp;quot;: true,
        &amp;quot;rusr&amp;quot;: true,
        &amp;quot;size&amp;quot;: 73,
        &amp;quot;uid&amp;quot;: 0,
        &amp;quot;version&amp;quot;: &amp;quot;1617439728&amp;quot;,
        &amp;quot;wgrp&amp;quot;: false,
        &amp;quot;woth&amp;quot;: false,
        &amp;quot;writeable&amp;quot;: true,
        &amp;quot;wusr&amp;quot;: true,
        &amp;quot;xgrp&amp;quot;: false,
        &amp;quot;xoth&amp;quot;: false,
        &amp;quot;xusr&amp;quot;: false
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;显示了 /etc/sysctl.conf 文件的所有状态信息。&lt;/p&gt;
&lt;h5 id=&#34;get_url-模块&#34;&gt;get_url 模块&lt;/h5&gt;
&lt;p&gt;get_url 模块可以实现从远程主机下载指定 URL 到本地，支持 sha256sum 文件教验。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m get_url -a &amp;quot;url=http://www.baidu.com dest=/tmp/index.html mode=0440 force=yes&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行命令的结果为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m get_url -a &amp;quot;url=http://www.baidu.com dest=/tmp/index.html mode=0440 force=yes&amp;quot;
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;checksum_dest&amp;quot;: &amp;quot;69676fdd06a44063439b46a7df1e326eeae98ed4&amp;quot;,
    &amp;quot;checksum_src&amp;quot;: &amp;quot;063ec2b31e5fa4d889076b948994ed4934d8ad62&amp;quot;,
    &amp;quot;dest&amp;quot;: &amp;quot;/tmp/index.html&amp;quot;,
    &amp;quot;gid&amp;quot;: 0,
    &amp;quot;group&amp;quot;: &amp;quot;root&amp;quot;,
    &amp;quot;md5sum&amp;quot;: &amp;quot;b4715e7fb51d60a983e29f3dc6d7a51a&amp;quot;,
    &amp;quot;mode&amp;quot;: &amp;quot;0440&amp;quot;,
    &amp;quot;msg&amp;quot;: &amp;quot;OK (unknown bytes)&amp;quot;,
    &amp;quot;owner&amp;quot;: &amp;quot;root&amp;quot;,
    &amp;quot;size&amp;quot;: 117044,
    &amp;quot;src&amp;quot;: &amp;quot;/tmp/tmpXgrOKe&amp;quot;,
    &amp;quot;state&amp;quot;: &amp;quot;file&amp;quot;,
    &amp;quot;status_code&amp;quot;: 200,
    &amp;quot;uid&amp;quot;: 0,
    &amp;quot;url&amp;quot;: &amp;quot;http://www.baidu.com&amp;quot;
}
[root@xdhuxc ~]# ansible Client -m command -a &amp;quot;ls /tmp&amp;quot;
192.168.91.130 | SUCCESS | rc=0 &amp;gt;&amp;gt;
ansible_EsBCHn
index.html                              # 下载下来的文件
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;yum-模块&#34;&gt;yum 模块&lt;/h5&gt;
&lt;p&gt;yum 模块用于实现软件包管理。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m yum -a &amp;quot;name=curl state=latest&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;命令执行的结果为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m yum -a &amp;quot;name=curl state=latest&amp;quot;
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;msg&amp;quot;: &amp;quot;Repository base is listed more than once in the configuration\nRepository updates is listed more than once in the configuration\nRepository extras is listed more than once in the configuration\nRepository centosplus is listed more than once in the configuration\nRepository base is listed more than once in the configuration\nRepository updates is listed more than once in the configuration\nRepository extras is listed more than once in the configuration\nRepository centosplus is listed more than once in the configuration\nRepository base is listed more than once in the configuration\nRepository updates is listed more than once in the configuration\nRepository extras is listed more than once in the configuration\nRepository centosplus is listed more than once in the configuration\nRepository base is listed more than once in the configuration\nRepository updates is listed more than once in the configuration\nRepository extras is listed more than once in the configuration\nRepository centosplus is listed more than once in the configuration\nRepository epel is listed more than once in the configuration\nRepository epel-debuginfo is listed more than once in the configuration\nRepository epel-source is listed more than once in the configuration\nhttps://mirrors.aliyun.com/centos/7.4.1708/virt/x86_64/kubernetes19/repodata/repomd.xml: [Errno 14] HTTPS Error 404 - Not Found\nTrying other mirror.\nTo address this issue please refer to the below knowledge base article \n\nhttps://access.redhat.com/articles/1320623\n\nIf above article doesn&#39;t help to resolve this issue please create a bug on https://bugs.centos.org/\n\n&amp;quot;,
    &amp;quot;rc&amp;quot;: 0,
    &amp;quot;results&amp;quot;: [
        &amp;quot;Loaded plugins: fastestmirror\nLoading mirror speeds from cached hostfile\n * epel: mirrors.aliyun.com\nResolving Dependencies\n--&amp;gt; Running transaction check\n---&amp;gt; Package curl.x86_64 0:7.29.0-42.el7 will be updated\n---&amp;gt; Package curl.x86_64 0:7.29.0-46.el7 will be an update\n--&amp;gt; Processing Dependency: libcurl = 7.29.0-46.el7 for package: curl-7.29.0-46.el7.x86_64\n--&amp;gt; Running transaction check\n---&amp;gt; Package libcurl.x86_64 0:7.29.0-42.el7 will be updated\n---&amp;gt; Package libcurl.x86_64 0:7.29.0-46.el7 will be an update\n--&amp;gt; Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package          Arch            Version                   Repository     Size\n================================================================================\nUpdating:\n curl             x86_64          7.29.0-46.el7             base          268 k\nUpdating for dependencies:\n libcurl          x86_64          7.29.0-46.el7             base          220 k\n\nTransaction Summary\n================================================================================\nUpgrade  1 Package (+1 Dependent package)\n\nTotal download size: 488 k\nDownloading packages:\nDelta RPMs disabled because /usr/bin/applydeltarpm not installed.\n--------------------------------------------------------------------------------\nTotal                                              960 kB/s | 488 kB  00:00     \nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  Updating   : libcurl-7.29.0-46.el7.x86_64                                 1/4 \n  Updating   : curl-7.29.0-46.el7.x86_64                                    2/4 \n  Cleanup    : curl-7.29.0-42.el7.x86_64                                    3/4 \n  Cleanup    : libcurl-7.29.0-42.el7.x86_64                                 4/4 \n  Verifying  : curl-7.29.0-46.el7.x86_64                                    1/4 \n  Verifying  : libcurl-7.29.0-46.el7.x86_64                                 2/4 \n  Verifying  : libcurl-7.29.0-42.el7.x86_64                                 3/4 \n  Verifying  : curl-7.29.0-42.el7.x86_64                                    4/4 \n\nUpdated:\n  curl.x86_64 0:7.29.0-46.el7                                                   \n\nDependency Updated:\n  libcurl.x86_64 0:7.29.0-46.el7                                                \n\nComplete!\n&amp;quot;
    ]
}
[root@xdhuxc ~]# ansible Client -m yum -a &amp;quot;name=curl state=latest&amp;quot;
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: false,
    &amp;quot;msg&amp;quot;: &amp;quot;&amp;quot;,
    &amp;quot;rc&amp;quot;: 0,
    &amp;quot;results&amp;quot;: [
        &amp;quot;All packages providing curl are up to date&amp;quot;,
        &amp;quot;&amp;quot;
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;从 msg 和 results 输出的信息可以看到，这就是一个 yum 安装软件包的过程。&lt;/p&gt;
&lt;h5 id=&#34;cron-模块&#34;&gt;cron 模块&lt;/h5&gt;
&lt;p&gt;cron 模块用于配置远程主机 crontab
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m cron -a &amp;quot;name=&#39;check&#39; minute=&#39;1&#39; job=&#39;ntpdate asia.pool.ntp.org&#39;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;运行效果：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ansible Client -m cron -a &amp;quot;name=&#39;check&#39; minute=&#39;1&#39; job=&#39;ntpdate asia.pool.ntp.org&#39;&amp;quot;
192.168.91.130 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;envs&amp;quot;: [],
    &amp;quot;jobs&amp;quot;: [
        &amp;quot;check&amp;quot;
    ]
}
[root@xdhuxc ~]# ansible Client -m command -a &amp;quot;crontab -l&amp;quot;
192.168.91.130 | SUCCESS | rc=0 &amp;gt;&amp;gt;
#Ansible: check
1 * * * * ntpdate asia.pool.ntp.org

[root@xdhuxc ~]#
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;service-模块&#34;&gt;service 模块&lt;/h5&gt;
&lt;p&gt;service 模块可以用来管理远程主机的系统服务。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m service -a &amp;quot;name=haproxy state=stopped&amp;quot;
ansible Client -m service -a &amp;quot;name=haproxy state=restarted&amp;quot;
ansible Client -m service -a &amp;quot;name=haproxy state=reloaded&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;命令执行的结果为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# systemctl status haproxy
● haproxy.service - HAProxy Load Balancer
   Loaded: loaded (/usr/lib/systemd/system/haproxy.service; disabled; vendor preset: disabled)
   Active: active (running) since Mon 2018-06-11 23:17:21 CST; 2s ago
 Main PID: 2135 (haproxy-systemd)
   Memory: 1.9M
   CGroup: /system.slice/haproxy.service
           ├─2135 /usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid
           ├─2136 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds
           └─2137 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds

Jun 11 23:17:21 xdhuxc systemd[1]: Started HAProxy Load Balancer.
Jun 11 23:17:21 xdhuxc systemd[1]: Starting HAProxy Load Balancer...
Jun 11 23:17:21 xdhuxc haproxy-systemd-wrapper[2135]: haproxy-systemd-wrapper: executing /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds
[root@xdhuxc ~]# ansible Client -m service -a &amp;quot;name=haproxy state=stopped&amp;quot;
192.168.91.128 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;name&amp;quot;: &amp;quot;haproxy&amp;quot;,
    &amp;quot;state&amp;quot;: &amp;quot;stopped&amp;quot;,
    &amp;quot;status&amp;quot;: {
        &amp;quot;ActiveEnterTimestamp&amp;quot;: &amp;quot;Mon 2018-06-11 23:17:21 CST&amp;quot;,
        &amp;quot;ActiveEnterTimestampMonotonic&amp;quot;: &amp;quot;4444399885&amp;quot;,
        &amp;quot;ActiveExitTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ActiveState&amp;quot;: &amp;quot;active&amp;quot;,
        &amp;quot;After&amp;quot;: &amp;quot;basic.target system.slice network.target systemd-journald.socket syslog.target&amp;quot;,
        &amp;quot;AllowIsolate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;AmbientCapabilities&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;AssertResult&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;AssertTimestamp&amp;quot;: &amp;quot;Mon 2018-06-11 23:17:21 CST&amp;quot;,
        &amp;quot;AssertTimestampMonotonic&amp;quot;: &amp;quot;4444398724&amp;quot;,
        &amp;quot;Before&amp;quot;: &amp;quot;shutdown.target&amp;quot;,
        &amp;quot;BlockIOAccounting&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;BlockIOWeight&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;CPUAccounting&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;CPUQuotaPerSecUSec&amp;quot;: &amp;quot;infinity&amp;quot;,
        &amp;quot;CPUSchedulingPolicy&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;CPUSchedulingPriority&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;CPUSchedulingResetOnFork&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;CPUShares&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;CanIsolate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;CanReload&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;CanStart&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;CanStop&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;CapabilityBoundingSet&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;ConditionResult&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;ConditionTimestamp&amp;quot;: &amp;quot;Mon 2018-06-11 23:17:21 CST&amp;quot;,
        &amp;quot;ConditionTimestampMonotonic&amp;quot;: &amp;quot;4444398724&amp;quot;,
        &amp;quot;Conflicts&amp;quot;: &amp;quot;shutdown.target&amp;quot;,
        &amp;quot;ControlGroup&amp;quot;: &amp;quot;/system.slice/haproxy.service&amp;quot;,
        &amp;quot;ControlPID&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;DefaultDependencies&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;Delegate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;Description&amp;quot;: &amp;quot;HAProxy Load Balancer&amp;quot;,
        &amp;quot;DevicePolicy&amp;quot;: &amp;quot;auto&amp;quot;,
        &amp;quot;EnvironmentFile&amp;quot;: &amp;quot;/etc/sysconfig/haproxy (ignore_errors=no)&amp;quot;,
        &amp;quot;ExecMainCode&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ExecMainExitTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ExecMainPID&amp;quot;: &amp;quot;2135&amp;quot;,
        &amp;quot;ExecMainStartTimestamp&amp;quot;: &amp;quot;Mon 2018-06-11 23:17:21 CST&amp;quot;,
        &amp;quot;ExecMainStartTimestampMonotonic&amp;quot;: &amp;quot;4444399843&amp;quot;,
        &amp;quot;ExecMainStatus&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ExecReload&amp;quot;: &amp;quot;{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }&amp;quot;,
        &amp;quot;ExecStart&amp;quot;: &amp;quot;{ path=/usr/sbin/haproxy-systemd-wrapper ; argv[]=/usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid $OPTIONS ; ignore_errors=no ; start_time=[Mon 2018-06-11 23:17:21 CST] ; stop_time=[n/a] ; pid=2135 ; code=(null) ; status=0/0 }&amp;quot;,
        &amp;quot;FailureAction&amp;quot;: &amp;quot;none&amp;quot;,
        &amp;quot;FileDescriptorStoreMax&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;FragmentPath&amp;quot;: &amp;quot;/usr/lib/systemd/system/haproxy.service&amp;quot;,
        &amp;quot;GuessMainPID&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;IOScheduling&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;Id&amp;quot;: &amp;quot;haproxy.service&amp;quot;,
        &amp;quot;IgnoreOnIsolate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;IgnoreOnSnapshot&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;IgnoreSIGPIPE&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;InactiveEnterTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;InactiveExitTimestamp&amp;quot;: &amp;quot;Mon 2018-06-11 23:17:21 CST&amp;quot;,
        &amp;quot;InactiveExitTimestampMonotonic&amp;quot;: &amp;quot;4444399885&amp;quot;,
        &amp;quot;JobTimeoutAction&amp;quot;: &amp;quot;none&amp;quot;,
        &amp;quot;JobTimeoutUSec&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;KillMode&amp;quot;: &amp;quot;mixed&amp;quot;,
        &amp;quot;KillSignal&amp;quot;: &amp;quot;15&amp;quot;,
        &amp;quot;LimitAS&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitCORE&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitCPU&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitDATA&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitFSIZE&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitLOCKS&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitMEMLOCK&amp;quot;: &amp;quot;65536&amp;quot;,
        &amp;quot;LimitMSGQUEUE&amp;quot;: &amp;quot;819200&amp;quot;,
        &amp;quot;LimitNICE&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;LimitNOFILE&amp;quot;: &amp;quot;4096&amp;quot;,
        &amp;quot;LimitNPROC&amp;quot;: &amp;quot;3818&amp;quot;,
        &amp;quot;LimitRSS&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitRTPRIO&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;LimitRTTIME&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitSIGPENDING&amp;quot;: &amp;quot;3818&amp;quot;,
        &amp;quot;LimitSTACK&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LoadState&amp;quot;: &amp;quot;loaded&amp;quot;,
        &amp;quot;MainPID&amp;quot;: &amp;quot;2135&amp;quot;,
        &amp;quot;MemoryAccounting&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;MemoryCurrent&amp;quot;: &amp;quot;2060288&amp;quot;,
        &amp;quot;MemoryLimit&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;MountFlags&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;Names&amp;quot;: &amp;quot;haproxy.service&amp;quot;,
        &amp;quot;NeedDaemonReload&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;Nice&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;NoNewPrivileges&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;NonBlocking&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;NotifyAccess&amp;quot;: &amp;quot;none&amp;quot;,
        &amp;quot;OOMScoreAdjust&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;OnFailureJobMode&amp;quot;: &amp;quot;replace&amp;quot;,
        &amp;quot;PermissionsStartOnly&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;PrivateDevices&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;PrivateNetwork&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;PrivateTmp&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;ProtectHome&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;ProtectSystem&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RefuseManualStart&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RefuseManualStop&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RemainAfterExit&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;Requires&amp;quot;: &amp;quot;basic.target&amp;quot;,
        &amp;quot;Restart&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RestartUSec&amp;quot;: &amp;quot;100ms&amp;quot;,
        &amp;quot;Result&amp;quot;: &amp;quot;success&amp;quot;,
        &amp;quot;RootDirectoryStartOnly&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RuntimeDirectoryMode&amp;quot;: &amp;quot;0755&amp;quot;,
        &amp;quot;SameProcessGroup&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;SecureBits&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;SendSIGHUP&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;SendSIGKILL&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;Slice&amp;quot;: &amp;quot;system.slice&amp;quot;,
        &amp;quot;StandardError&amp;quot;: &amp;quot;inherit&amp;quot;,
        &amp;quot;StandardInput&amp;quot;: &amp;quot;null&amp;quot;,
        &amp;quot;StandardOutput&amp;quot;: &amp;quot;journal&amp;quot;,
        &amp;quot;StartLimitAction&amp;quot;: &amp;quot;none&amp;quot;,
        &amp;quot;StartLimitBurst&amp;quot;: &amp;quot;5&amp;quot;,
        &amp;quot;StartLimitInterval&amp;quot;: &amp;quot;10000000&amp;quot;,
        &amp;quot;StartupBlockIOWeight&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;StartupCPUShares&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;StatusErrno&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;StopWhenUnneeded&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;SubState&amp;quot;: &amp;quot;running&amp;quot;,
        &amp;quot;SyslogLevelPrefix&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;SyslogPriority&amp;quot;: &amp;quot;30&amp;quot;,
        &amp;quot;SystemCallErrorNumber&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;TTYReset&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;TTYVHangup&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;TTYVTDisallocate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;TasksAccounting&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;TasksCurrent&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;TasksMax&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;TimeoutStartUSec&amp;quot;: &amp;quot;1min 30s&amp;quot;,
        &amp;quot;TimeoutStopUSec&amp;quot;: &amp;quot;1min 30s&amp;quot;,
        &amp;quot;TimerSlackNSec&amp;quot;: &amp;quot;50000&amp;quot;,
        &amp;quot;Transient&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;Type&amp;quot;: &amp;quot;simple&amp;quot;,
        &amp;quot;UMask&amp;quot;: &amp;quot;0022&amp;quot;,
        &amp;quot;UnitFilePreset&amp;quot;: &amp;quot;disabled&amp;quot;,
        &amp;quot;UnitFileState&amp;quot;: &amp;quot;disabled&amp;quot;,
        &amp;quot;Wants&amp;quot;: &amp;quot;system.slice&amp;quot;,
        &amp;quot;WatchdogTimestamp&amp;quot;: &amp;quot;Mon 2018-06-11 23:17:21 CST&amp;quot;,
        &amp;quot;WatchdogTimestampMonotonic&amp;quot;: &amp;quot;4444399872&amp;quot;,
        &amp;quot;WatchdogUSec&amp;quot;: &amp;quot;0&amp;quot;
    }
}
[root@xdhuxc ~]# systemctl status haproxy
● haproxy.service - HAProxy Load Balancer
   Loaded: loaded (/usr/lib/systemd/system/haproxy.service; disabled; vendor preset: disabled)
   Active: inactive (dead)

Jun 11 23:17:21 xdhuxc systemd[1]: Started HAProxy Load Balancer.
Jun 11 23:17:21 xdhuxc systemd[1]: Starting HAProxy Load Balancer...
Jun 11 23:17:21 xdhuxc haproxy-systemd-wrapper[2135]: haproxy-systemd-wrapper: executing /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds
Jun 11 23:17:51 xdhuxc systemd[1]: Stopping HAProxy Load Balancer...
Jun 11 23:17:51 xdhuxc haproxy-systemd-wrapper[2135]: haproxy-systemd-wrapper: SIGTERM -&amp;gt; 2137.
Jun 11 23:17:51 xdhuxc systemd[1]: Stopped HAProxy Load Balancer.
Jun 11 23:17:51 xdhuxc haproxy-systemd-wrapper[2135]: haproxy-systemd-wrapper: exit, haproxy RC=0
[root@xdhuxc ~]# ansible Client -m service -a &amp;quot;name=haproxy state=restarted&amp;quot;
192.168.91.128 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;name&amp;quot;: &amp;quot;haproxy&amp;quot;,
    &amp;quot;state&amp;quot;: &amp;quot;started&amp;quot;,
    &amp;quot;status&amp;quot;: {
        &amp;quot;ActiveEnterTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ActiveExitTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ActiveState&amp;quot;: &amp;quot;inactive&amp;quot;,
        &amp;quot;After&amp;quot;: &amp;quot;network.target syslog.target systemd-journald.socket basic.target system.slice&amp;quot;,
        &amp;quot;AllowIsolate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;AmbientCapabilities&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;AssertResult&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;AssertTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;Before&amp;quot;: &amp;quot;shutdown.target&amp;quot;,
        &amp;quot;BlockIOAccounting&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;BlockIOWeight&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;CPUAccounting&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;CPUQuotaPerSecUSec&amp;quot;: &amp;quot;infinity&amp;quot;,
        &amp;quot;CPUSchedulingPolicy&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;CPUSchedulingPriority&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;CPUSchedulingResetOnFork&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;CPUShares&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;CanIsolate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;CanReload&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;CanStart&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;CanStop&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;CapabilityBoundingSet&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;ConditionResult&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;ConditionTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;Conflicts&amp;quot;: &amp;quot;shutdown.target&amp;quot;,
        &amp;quot;ControlPID&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;DefaultDependencies&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;Delegate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;Description&amp;quot;: &amp;quot;HAProxy Load Balancer&amp;quot;,
        &amp;quot;DevicePolicy&amp;quot;: &amp;quot;auto&amp;quot;,
        &amp;quot;EnvironmentFile&amp;quot;: &amp;quot;/etc/sysconfig/haproxy (ignore_errors=no)&amp;quot;,
        &amp;quot;ExecMainCode&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ExecMainExitTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ExecMainPID&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ExecMainStartTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ExecMainStatus&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;ExecReload&amp;quot;: &amp;quot;{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }&amp;quot;,
        &amp;quot;ExecStart&amp;quot;: &amp;quot;{ path=/usr/sbin/haproxy-systemd-wrapper ; argv[]=/usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid $OPTIONS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }&amp;quot;,
        &amp;quot;FailureAction&amp;quot;: &amp;quot;none&amp;quot;,
        &amp;quot;FileDescriptorStoreMax&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;FragmentPath&amp;quot;: &amp;quot;/usr/lib/systemd/system/haproxy.service&amp;quot;,
        &amp;quot;GuessMainPID&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;IOScheduling&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;Id&amp;quot;: &amp;quot;haproxy.service&amp;quot;,
        &amp;quot;IgnoreOnIsolate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;IgnoreOnSnapshot&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;IgnoreSIGPIPE&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;InactiveEnterTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;InactiveExitTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;JobTimeoutAction&amp;quot;: &amp;quot;none&amp;quot;,
        &amp;quot;JobTimeoutUSec&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;KillMode&amp;quot;: &amp;quot;mixed&amp;quot;,
        &amp;quot;KillSignal&amp;quot;: &amp;quot;15&amp;quot;,
        &amp;quot;LimitAS&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitCORE&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitCPU&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitDATA&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitFSIZE&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitLOCKS&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitMEMLOCK&amp;quot;: &amp;quot;65536&amp;quot;,
        &amp;quot;LimitMSGQUEUE&amp;quot;: &amp;quot;819200&amp;quot;,
        &amp;quot;LimitNICE&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;LimitNOFILE&amp;quot;: &amp;quot;4096&amp;quot;,
        &amp;quot;LimitNPROC&amp;quot;: &amp;quot;3818&amp;quot;,
        &amp;quot;LimitRSS&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitRTPRIO&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;LimitRTTIME&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LimitSIGPENDING&amp;quot;: &amp;quot;3818&amp;quot;,
        &amp;quot;LimitSTACK&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;LoadState&amp;quot;: &amp;quot;loaded&amp;quot;,
        &amp;quot;MainPID&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;MemoryAccounting&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;MemoryCurrent&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;MemoryLimit&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;MountFlags&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;Names&amp;quot;: &amp;quot;haproxy.service&amp;quot;,
        &amp;quot;NeedDaemonReload&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;Nice&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;NoNewPrivileges&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;NonBlocking&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;NotifyAccess&amp;quot;: &amp;quot;none&amp;quot;,
        &amp;quot;OOMScoreAdjust&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;OnFailureJobMode&amp;quot;: &amp;quot;replace&amp;quot;,
        &amp;quot;PermissionsStartOnly&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;PrivateDevices&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;PrivateNetwork&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;PrivateTmp&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;ProtectHome&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;ProtectSystem&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RefuseManualStart&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RefuseManualStop&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RemainAfterExit&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;Requires&amp;quot;: &amp;quot;basic.target&amp;quot;,
        &amp;quot;Restart&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RestartUSec&amp;quot;: &amp;quot;100ms&amp;quot;,
        &amp;quot;Result&amp;quot;: &amp;quot;success&amp;quot;,
        &amp;quot;RootDirectoryStartOnly&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;RuntimeDirectoryMode&amp;quot;: &amp;quot;0755&amp;quot;,
        &amp;quot;SameProcessGroup&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;SecureBits&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;SendSIGHUP&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;SendSIGKILL&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;Slice&amp;quot;: &amp;quot;system.slice&amp;quot;,
        &amp;quot;StandardError&amp;quot;: &amp;quot;inherit&amp;quot;,
        &amp;quot;StandardInput&amp;quot;: &amp;quot;null&amp;quot;,
        &amp;quot;StandardOutput&amp;quot;: &amp;quot;journal&amp;quot;,
        &amp;quot;StartLimitAction&amp;quot;: &amp;quot;none&amp;quot;,
        &amp;quot;StartLimitBurst&amp;quot;: &amp;quot;5&amp;quot;,
        &amp;quot;StartLimitInterval&amp;quot;: &amp;quot;10000000&amp;quot;,
        &amp;quot;StartupBlockIOWeight&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;StartupCPUShares&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;StatusErrno&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;StopWhenUnneeded&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;SubState&amp;quot;: &amp;quot;dead&amp;quot;,
        &amp;quot;SyslogLevelPrefix&amp;quot;: &amp;quot;yes&amp;quot;,
        &amp;quot;SyslogPriority&amp;quot;: &amp;quot;30&amp;quot;,
        &amp;quot;SystemCallErrorNumber&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;TTYReset&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;TTYVHangup&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;TTYVTDisallocate&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;TasksAccounting&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;TasksCurrent&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;TasksMax&amp;quot;: &amp;quot;18446744073709551615&amp;quot;,
        &amp;quot;TimeoutStartUSec&amp;quot;: &amp;quot;1min 30s&amp;quot;,
        &amp;quot;TimeoutStopUSec&amp;quot;: &amp;quot;1min 30s&amp;quot;,
        &amp;quot;TimerSlackNSec&amp;quot;: &amp;quot;50000&amp;quot;,
        &amp;quot;Transient&amp;quot;: &amp;quot;no&amp;quot;,
        &amp;quot;Type&amp;quot;: &amp;quot;simple&amp;quot;,
        &amp;quot;UMask&amp;quot;: &amp;quot;0022&amp;quot;,
        &amp;quot;UnitFilePreset&amp;quot;: &amp;quot;disabled&amp;quot;,
        &amp;quot;UnitFileState&amp;quot;: &amp;quot;disabled&amp;quot;,
        &amp;quot;Wants&amp;quot;: &amp;quot;system.slice&amp;quot;,
        &amp;quot;WatchdogTimestampMonotonic&amp;quot;: &amp;quot;0&amp;quot;,
        &amp;quot;WatchdogUSec&amp;quot;: &amp;quot;0&amp;quot;
    }
}
[root@xdhuxc ~]# systemctl status haproxy
● haproxy.service - HAProxy Load Balancer
   Loaded: loaded (/usr/lib/systemd/system/haproxy.service; disabled; vendor preset: disabled)
   Active: active (running) since Mon 2018-06-11 23:19:46 CST; 25s ago
 Main PID: 2351 (haproxy-systemd)
   Memory: 1.9M
   CGroup: /system.slice/haproxy.service
           ├─2351 /usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid
           ├─2354 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds
           └─2355 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds

Jun 11 23:19:46 xdhuxc systemd[1]: Started HAProxy Load Balancer.
Jun 11 23:19:46 xdhuxc systemd[1]: Starting HAProxy Load Balancer...
Jun 11 23:19:46 xdhuxc haproxy-systemd-wrapper[2351]: haproxy-systemd-wrapper: executing /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;user-模块&#34;&gt;user 模块&lt;/h5&gt;
&lt;p&gt;user 模块用来进行远程主机用户的管理。
例如：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ansible Client -m user -a &amp;quot;name=wang comment=&#39;user wang&#39;&amp;quot;     # 创建用户 wang
ansible Client -m user -a &amp;quot;name=wang state=absent remove=yes&amp;quot; # 删除用户 wang
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行命令结果如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# cat /etc/passwd | grep wang
[root@xdhuxc ~]# ansible Client -m user -a &amp;quot;name=wang comment=&#39;user wang&#39;&amp;quot;     # 创建用户 wang
192.168.91.128 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;comment&amp;quot;: &amp;quot;user wang&amp;quot;,
    &amp;quot;create_home&amp;quot;: true,
    &amp;quot;group&amp;quot;: 1001,
    &amp;quot;home&amp;quot;: &amp;quot;/home/wang&amp;quot;,
    &amp;quot;name&amp;quot;: &amp;quot;wang&amp;quot;,
    &amp;quot;shell&amp;quot;: &amp;quot;/bin/bash&amp;quot;,
    &amp;quot;state&amp;quot;: &amp;quot;present&amp;quot;,
    &amp;quot;system&amp;quot;: false,
    &amp;quot;uid&amp;quot;: 1001
}
[root@xdhuxc ~]# cat /etc/passwd | grep wang
wang:x:1001:1001:user wang:/home/wang:/bin/bash
[root@xdhuxc ~]# ansible Client -m user -a &amp;quot;name=wang state=absent remove=yes&amp;quot;  # 删除用户 wang
192.168.91.128 | SUCCESS =&amp;gt; {
    &amp;quot;changed&amp;quot;: true,
    &amp;quot;force&amp;quot;: false,
    &amp;quot;name&amp;quot;: &amp;quot;wang&amp;quot;,
    &amp;quot;remove&amp;quot;: true,
    &amp;quot;state&amp;quot;: &amp;quot;absent&amp;quot;
}
[root@xdhuxc ~]# cat /etc/passwd | grep wang
[root@xdhuxc ~]#
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/ansible/">Ansible</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/devops/">DevOps</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 常用代码示例</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-code-example/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-code-example/</guid>
                <pubDate>Fri, 27 Apr 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录些在 Python 开发中经常会用到的代码，下次使用时就可以直接愉快地复制粘贴了。&lt;/p&gt;
&lt;h3 id=&#34;常用代码&#34;&gt;常用代码&lt;/h3&gt;
&lt;p&gt;1、时间戳&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import time

time.strftime(&amp;#39;%Y-%m-%d %H:%M:%S&amp;#39;, time.localtime(time.time()))
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、pycharm 代码模板（Editor -&amp;gt; Code Style -&amp;gt; File and Code Template）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: utf-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# author: ${USER}
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# date: ${DATE}
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# description:
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、日志&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import logging as log

log.basicConfig(level=log.INFO,
                datefmt=&amp;#39;%Y/%m/%d %H:%M:%S&amp;#39;,
                format=&amp;#39;%(asctime)s - %(filename)s[line:%(lineno)d] - %(levelname)s: %(message)s&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、检查文件变动&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import inotify.adapters
import os

def main():
    i = inotify.adapters.Inotify()
    dir_name = os.getenv(&amp;#39;DIR_NAME&amp;#39;, &amp;#39;/etc/envoy/&amp;#39;)
    i.add_watch(dir_name)

    os.chdir(dir_name)
    # CREATE event for a directory:
    os.system(&amp;#39;mkdir foo&amp;#39;)
    # CREATE event for a file:
    os.system(&amp;#39;echo hello &amp;gt; test.txt&amp;#39;)
    # MODIFY event for the file:
    os.system(&amp;#39;echo world &amp;gt;&amp;gt; test.txt&amp;#39;)

    for event in i.event_gen(yield_nones=False):
        (_, type_names, path, filename) = event
        if &amp;#39;IN_CREATE&amp;#39; in type_names:
            print(&amp;#39;the new configuration file is created.&amp;#39;)
        if &amp;#39;IN_ISDIR&amp;#39; in type_names:
            print(&amp;#39;the new directory is created.&amp;#39;)

if &lt;span class=&#34;gs&#34;&gt;__name__&lt;/span&gt; == &amp;#39;__main__&amp;#39;:
    main()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、性能分析&lt;/p&gt;
&lt;p&gt;1）使用 &lt;code&gt;cProfile&lt;/code&gt; 进行性能分析&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;python -m cProfile abc.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）使用 &lt;code&gt;line_profile&lt;/code&gt; 进行性能分析
在待检测的函数上面添加 &lt;code&gt;@profile&lt;/code&gt; 装饰器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;ni&#34;&gt;@profile&lt;/span&gt;   # 不用管此处的提示 &amp;#34;unresolved reference &amp;#39;profile&amp;#39;&amp;#34;
def func1():
    sum = 0
    for i in range(100000):
        sum += i
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;运行该脚本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kernprof -l -v xdhuxc.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://segmentfault.com/a/1190000007518598&#34;&gt;https://segmentfault.com/a/1190000007518598&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>nginx 常用功能及配置详解</title>
                <link>https://xdhuxc.github.io/posts/mixed/nginx/nginx-function-and-configuration/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/nginx/nginx-function-and-configuration/</guid>
                <pubDate>Thu, 26 Apr 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 nginx 的常用功能和其配置的详细含义。&lt;/p&gt;
&lt;h3 id=&#34;nginx-简介&#34;&gt;nginx 简介&lt;/h3&gt;
&lt;p&gt;nginx 是一个轻量级高性能的 web 服务器，它是为快速响应大量静态文件请求和高效利用系统资源而设计的。与apache使用面向进程或线程的方式处理请求不同，nginx使用异步事件驱动模型在负载下性能更突出。&lt;/p&gt;
&lt;p&gt;nginx 功能丰富，可作为 HTTP 服务器，也可作为反向代理服务器和邮件服务器，支持FastCGI、SSL、Virtual Host、URL Rewrite、Gzip等功能，并且支持很多第三方的模块扩展。&lt;/p&gt;
&lt;p&gt;虽然nginx能高效地服务静态文件，但也有人认为nginx处理动态内容并不理想。不像apache服务器，nginx没用使用内嵌解释器的方式来处理动态内容。相反，动态内容被丢给cgi，fastcgi或者像apache这样的web服务器，然后把处理结果返回给nginx，nginx在返给浏览器。这种方式就导致部署起来会更复杂一些。出于这些原因，使用和配置nginx可能会晦涩。nginx的配置感觉更复杂或者不直接。&lt;/p&gt;
&lt;h3 id=&#34;nginx-常用功能&#34;&gt;nginx 常用功能&lt;/h3&gt;
&lt;p&gt;1、HTTP 代理，反向代理&lt;/p&gt;
&lt;p&gt;作为 Web 服务器最常用的功能之一，尤其是反向代理。nginx 在做反向代理时，提供性能稳定、配置灵活的转发功能。 nginx 可以根据不同的正则匹配，采取不同的转发策略，比如图片文件的转发至文件服务器、动态页面的转发至web服务器。并且， nginx 对返回结果进行错误页跳转、异常判断等。如果被分发的服务器存在异常，可以将请求重新转发给另外一台服务器，然后自动去除异常服务器。&lt;/p&gt;
&lt;p&gt;2、负载均衡&lt;/p&gt;
&lt;p&gt;nginx 提供的负载均衡策略有两种：内置策略和扩展策略。内置策略包括：轮询，加权轮询，IP hash。扩展策略非常多，几乎涵盖所有的负载均衡算法。&lt;/p&gt;
&lt;p&gt;IP Hash算法：对客户端请求的IP地址进行Hash操作，然后根据Hash结果将同一个客户端IP的请求分发给同一台服务器进行处理，可以解决 session 不共享的问题。&lt;/p&gt;
&lt;p&gt;3、Web 缓存&lt;/p&gt;
&lt;p&gt;nginx 可以对不同的文件做不同的缓存处理，配置灵活，并且支持FastCGI_Cache，主要用于对 FastCGI的动态程序进行缓存。配合第三方的ngx_cache_purge，对指定的 URL 缓存内容可以进行增删管理。&lt;/p&gt;
&lt;h3 id=&#34;nginx-配置文件&#34;&gt;nginx 配置文件&lt;/h3&gt;
&lt;p&gt;nginx 的强大都是靠配置文件来实现，nginx 就是一个二进制文件 nginx 读入一个配置文件 nginx.conf (nginx.conf可能include包含若干子配置文件)来实现各种各样的功能。&lt;/p&gt;
&lt;h4 id=&#34;nginx-配置文件结构&#34;&gt;nginx 配置文件结构&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;...                           # 全局块
events {                      # events 块
    ...       
}
http {                        # http 块
    ...                       # http 全局块
    server {                  # server 块
        ...                   # server 全局块
        location [PATTERN] {  # location 块  
            ...
        }   
        location [PATTERN] {
            ...
        }
    }
    server {
        ...
    }
    ...                       # http 块
}

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;1、全局块&lt;/p&gt;
&lt;p&gt;配置影响 nginx 全局的指令。一般有运行 nginx 服务器的用户组， nginx 进程 pid 存放路径，日志文件存放路径，配置文件引入，允许生成的 worker process数等。&lt;/p&gt;
&lt;p&gt;2、events 块&lt;/p&gt;
&lt;p&gt;配置影响 nginx 服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网络连接，开启多个网络连接序列化等。&lt;/p&gt;
&lt;p&gt;3、http 块&lt;/p&gt;
&lt;p&gt;可以嵌套多个 server块，配置代理、缓存、日志定义等绝大多数功能和第三方模块的配置，如文件引入、mime-type定义、日志自定义、是否使用 sendfile 传输文件、连接超时时间、单连接请求数等。&lt;/p&gt;
&lt;p&gt;4、server 块&lt;/p&gt;
&lt;p&gt;配置虚拟主机的相关参数，一个 http 块中可以有多个 server 块。&lt;/p&gt;
&lt;p&gt;5、location 块&lt;/p&gt;
&lt;p&gt;配置请求的路由，以及各种页面的处理情况。&lt;/p&gt;
&lt;h4 id=&#34;nginx-配置文件示例&#34;&gt;nginx 配置文件示例&lt;/h4&gt;
&lt;p&gt;nginx.conf文件示例&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;user administrator administrator; # 配置用户或者用户组，默认为nobody nobody。
worker_processes 2;               # 允许生成的进程数，设置值和CPU核心数一致，默认为：1。在nginx1.3.8和1.2.5之后的版本开始支持auto，自动匹配进程数。
pid /var/nginx/nginx.pid # 指定 nginx 进程运行文件存放地址。
error_log /var/log/nginx/error.log debug # 指定错误日志存放路径及级别，该设置可以放入全局块、http块、server块，日志级别依次为：debug|info|notice|warn|error|crit|alert|emerg。
events {
    accept_mutex on; # 设置网络连接序列化，防止惊群现象发生，默认为：on。
    multi_accept on; # 设置一个进程是否同时接受多个网络连接，默认为：off。
    use epoll;        # 指定事件驱动模型，可以为：select|poll|kqueue|epoll|resig|/dev/poll|eventport。
    worker_connections 1024; # 设置最大连接数，默认为：512。
}
http {
    include mime.types; # 文件扩展名与文件类型映射表。
    default_type application/octet-stream; # 指定默认文件类型，默认为：text/plain。
    &lt;span class=&#34;ni&#34;&gt;#access_log&lt;/span&gt; off # 取消服务日志。
    
    log_format  main  &amp;#39;$remote_addr - $remote_user [$time_local] &amp;#34;$request&amp;#34; &amp;#39;
                      &amp;#39;$status $body_bytes_sent &amp;#34;$http_referer&amp;#34; &amp;#39;
                      &amp;#39;&amp;#34;$http_user_agent&amp;#34; &amp;#34;$http_x_forwarded_for&amp;#34;&amp;#39;;  # 自定义格式
    access_log /var/log/nginx/access.log main; # combined为日志格式的默认值。
    sendfile on; # 允许sendfile方式传输文件，默认为：off，可以在http块、server块、location块中定义。
    sendfile_max_chunk 100K; # 每个进程每次调用传输数量不能大于设定的值，默认值为：0，即不设上限。
    keepalive_timeout 65;    # 连接超时时间，默认为：75s，可以在http块、server块和location块中设置。
    
    upstream xdhuxc {
        server 127.0.0.1:8080;
        server 192.168.91.128:9090 backup; # 热备，
    }
    
    error_page 404 https://www.baidu.com # 错误页。
    
    server {
        listen 8080;            # 监听端口。
        server_name 127.0.0.1;  # 监听地址。
        keepalive_requests 120; # 单连接请求上限次数。
        location ~*^.+$ {       # 请求的 url 过滤，正则匹配，~ 为区分大小写，~* 为不区分大小写。
            # root path;   # 根目录。
            # index index.html index.htm; # 设置默认页。
            proxy_pass http://xdhuxc; # 请求转向 xdhuxc 定义的服务器列表。
            deny 127.0.0.1; # 拒绝的IP。
            allow 172.18.5.54; 允许的IP。
        }
        
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意：&lt;/p&gt;
&lt;p&gt;1、log_format中参数的含义&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$remote_addr 和 $http_x_forwarded_for 用以记录客户端的IP地址。
$remote_user 用来记录客户端用户名称。
$time_local 用来记录访问时间与时区。
$request 用来记录请求的url与http协议。
$status 用来记录请求状态，成功为200。
$body_bytes_sent 记录发送给客户端文件主体内容大小。
$http_referer 用来记录从哪个页面链接访问过来的。
$http_user_agent 用来记录客户端浏览器的相关信息。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、惊群现象：一个网络连接到来，多个睡眠的进程被同时叫醒，但只有一个进程能获得连接，这样会影响系统性能。&lt;/p&gt;
&lt;p&gt;3、每个指令必须有分号结尾。&lt;/p&gt;
&lt;h3 id=&#34;负载均衡和反向代理配置&#34;&gt;负载均衡和反向代理配置&lt;/h3&gt;
&lt;h4 id=&#34;代理服务配置&#34;&gt;代理服务配置&lt;/h4&gt;
&lt;p&gt;1、在 http 块中有如下配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;error_page 404 https://www.baidu.com # 设置错误页，当代理遇到状态码为404时，把错误页面导向百度。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;要想让该语句起作用，必须配合着下面的配置一起使用：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;proxy_intercept_errors on; # 如果被代理服务器返回的状态码为400或者大于400，设置的error_page配置起作用，默认为：off。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、如果我们的代理只允许接受get、post请求方法的一种，可进行如下配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;proxy_method get; # 支持客户端的请求方法，post/get。 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、设置支持的http协议版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;proxy_http_version 1.0; # nginx 服务器提供代理服务的http协议版本1.0、1.1，默认为：1.0版本。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、如果 nginx 服务器给两台 web 服务器做代理，负载均衡算法采用轮询。那么当一台服务器 web 程序不能访问时，nginx服务器分发请求还是会给这台不能访问的 web 服务器。如果这里的响应连接时间过长，就会导致客户端的页面一直在等待，严重影响客户体验。&lt;/p&gt;
&lt;p&gt;如果负载均衡中，web 服务器乙发生这样的情况，nginx 首先会去 web 服务器甲请求，但是 nginx 在配置不当的情况下会继续分发请求到 web 服务器乙，然后等待 web 服务器乙响应，直到响应时间超时，才会把请求重新分发给 web 服务器甲。这里的响应时间如果过长，用户等待的时间就会越长。&lt;/p&gt;
&lt;p&gt;以下配置可以作为解决方案：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;proxy_connect_timeout 1; # nginx 服务器与被代理服务器建立连接的超时时间，默认为：60s。
proxy_read_timeout 1; # nginx 服务器向被代理服务器组发出 read 请求后，等待响应的超时时间，默认为：60s。
proxy_send_timeout 1; # nginx 服务器向被代理服务器组发出 write 请求后，等待响应的超时时间，默认为：60s。
proxy_ignore_client_abort on; # 客户端断网时，nginx 服务器是否中断对被代理服务器的请求，默认为：off。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、如果使用 upstream 指令配置了一组服务器作为被代理服务器，服务器中的访问算法遵循配置的负载均衡规则，同时可以使用该指令配置在发生哪些异常情况时，将请求顺次交由下一组服务器处理。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;proxy_next_upstream timeout; # 反向代理 upstream 中设置的服务器组，出现故障时，被代理服务器返回的状态值。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以设置为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;error | timeout | invalid_header | http_500 | http_502 | http_503 | http_504 | http_404 | off 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;error：建立连接或向被代理的服务器发送请求或读取响应信息时，服务器发生错误。&lt;/li&gt;
&lt;li&gt;timeout：建立连接或向被代理服务器发送请求或读取响应信息时，服务器发生超时。&lt;/li&gt;
&lt;li&gt;invalid_header：被代理服务器返回的响应头异常。&lt;/li&gt;
&lt;li&gt;off：无法将请求分发给被代理的服务器。&lt;/li&gt;
&lt;li&gt;http_404,http_500,...：被代理服务器返回的状态码为404，500，502等。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;6、如果想通过 http 获取客户端的真实IP地址，而不是获取代理服务器的IP地址，那么需要做如下配置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;proxy_set_header Host $host; # 只要用户在浏览器中访问的域名绑定了VIP，VIP下面有RS，则就用$host；host 是访问的URL中的域名和端口，比如，www.taobaoc.com:80
proxy_set_header X-Real-IP $remote_addr; # 把源IP（$remote_add，建立HTTP连接header里面的信息）赋值给X-Real-IP，这样在代码中，$X-Real-IP就可以获得源IP。
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # 在nginx 作为代理服务器时，设置的IP列表，会把经过的机器IP、代理机器IP都记录下来，用&amp;#34;,&amp;#34;隔开，代码中使用 &lt;span class=&#34;sb&#34;&gt;`echo $x-forwarded-for | awk -F, &amp;#39;{print $1}&amp;#39;`&lt;/span&gt; 来作为源IP。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、nginx 代理配置的配置文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;include       mime.types;                  # 文件扩展名与文件类型映射表
default_type  application/octet-stream;    # 设置默认文件类型，默认为text/plain
&lt;span class=&#34;gh&#34;&gt;#access_log off;                           # 取消服务日志    
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;log_format main &amp;#39; $remote_addr–$remote_user [$time_local] $request $status $body_bytes_sent $http_referer $http_user_agent $http_x_forwarded_for&amp;#39;; &lt;span class=&#34;ni&#34;&gt;#自定义格式&lt;/span&gt;
access_log log/access.log main;            # combined 为日志格式的默认值
sendfile on;                               # 允许sendfile方式传输文件，默认为off，可以在http块，server块，location块。
sendfile_max_chunk 100k;                   # 每个进程每次调用传输数量不能大于设定的值，默认为0，即不设上限。
keepalive_timeout 65;                      # 连接超时时间，默认为75s，可以在http，server，location块。
proxy_connect_timeout 1;                   # nginx服务器与被代理的服务器建立连接的超时时间，默认60秒
proxy_read_timeout 1;                      # nginx服务器想被代理服务器组发出read请求后，等待响应的超时间，默认为60秒。
proxy_send_timeout 1;                      # nginx服务器想被代理服务器组发出write请求后，等待响应的超时间，默认为60秒。
proxy_http_version 1.0 ;                   # Nginx服务器提供代理服务的http协议版本1.0，1.1，默认设置为1.0版本。
&lt;span class=&#34;gh&#34;&gt;#proxy_method get;                         # 支持客户端的请求方法。post/get；
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;proxy_ignore_client_abort on;              # 客户端断网时，nginx服务器是否终端对被代理服务器的请求。默认为off。
proxy_ignore_headers &amp;#34;Expires&amp;#34; &amp;#34;Set-Cookie&amp;#34;;  &lt;span class=&#34;ni&#34;&gt;#Nginx服务器不处理设置的http相应投中的头域&lt;/span&gt;，这里空格隔开可以设置多个。
proxy_intercept_errors on;                 # 如果被代理服务器返回的状态码为400或者大于400，设置的error_page配置起作用。默认为off。
proxy_headers_hash_max_size 1024;          # 存放http报文头的哈希表容量上限，默认为512个字符。
proxy_headers_hash_bucket_size 128;        # nginx服务器申请存放http报文头的哈希表容量大小。默认为64个字符。
proxy_next_upstream timeout;               # 反向代理upstream中设置的服务器组，出现故障时，被代理服务器返回的状态值。error|timeout|invalid_header|http_500|http_502|http_503|http_504|http_404|off
&lt;span class=&#34;gh&#34;&gt;#proxy_ssl_session_reuse on;               # 默认为：on，如果我们在错误日志中发现“SSL3_GET_FINSHED:digest check failed”的情况时，可以将该指令设置为off。
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;负载均衡配置&#34;&gt;负载均衡配置&lt;/h4&gt;
&lt;p&gt;upstream 配置是写一组被代理的服务器地址，然后配置负载均衡的算法。这里的被代理服务器地址有两种写法：&lt;/p&gt;
&lt;p&gt;1）、&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;upstream xdhuxc {
    server 192.168.91.128:8080;
    server 192.168.91.129:8080;
}
server {
    ...
    location ~*^.+$ {
        proxy_pass http://xdhuxc   # 请求转向 xdhuxc 定义的服务器列表。
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）、&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;upstream xdhuxc {
    server http://192.168.91.128:8080;
    server http://192.168.91.129:8080;
}
server {
    ...
    location ~*^.+$ {
        proxy_pass xdhuxc;         # 请求转向 xdhuxc 定义的服务器列表。
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;1、热备&lt;/p&gt;
&lt;p&gt;如果有两台服务器，当一台服务器发生故障时，才启用第二台服务器给用户提供服务。服务器处理请求的顺序：AAAA（突然A挂了）BBBBBBB...&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;upstream xdhuxc {
    server 192.168.91.128:8080;
    server 192.168.91.129:8080 backup; # 热备
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、轮询&lt;/p&gt;
&lt;p&gt;nginx 默认就是轮询，其权重默认都为：1。服务器处理请求的顺序为：ABABABAB...&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;upstream xdhuxc {
    server 192.168.91.128:8080;
    server 192.168.91.129:8080;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、加权轮询&lt;/p&gt;
&lt;p&gt;nginx 根据配置的权重的大小而分发给不同服务器不同数量的请求。如果不设置，则默认为：1。服务器处理请求的顺序为：ABBABBABBABBABB...&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;upstream xdhuxc {
    server 192.168.91.128:8080 weight=1;
    server 192.168.91.129:8080 weight=2;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、ip_hash&lt;/p&gt;
&lt;p&gt;nginx 会让相同的客户端IP请求相同的服务器。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;upstream xdhuxc {
    server 192.168.91.128:8080;
    server 192.168.91.129:8080;
    ip_hash;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;nginx 负载均衡配置的几个状态参数：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;down：表示当前 server 暂时不参与负载均衡。&lt;/li&gt;
&lt;li&gt;backup：预留的备份机器，当其他所有的非 backup 机器出现故障或者忙的时候，才会请求 backup 机器，因此这台机器的压力最轻。&lt;/li&gt;
&lt;li&gt;max_fails：允许请求失败的次数，默认为：1。当超过最大次数时，返回 proxy_next_upstream 模块定义的错误。&lt;/li&gt;
&lt;li&gt;fail_timeout：在经历了 max_fails 次失败后，暂停服务的时间。max_fails 可以和 fail_timeout 一起使用。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;示例如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;upstream xdhuxc {
    server 192.168.91.128:8080 weight=2 max_fails=2 fail_timeout=2;
    server 192.168.91.129:8080 weight=1 max_fails=2 fail_timeout=1;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;nginx-中-location-的写法&#34;&gt;nginx 中 location 的写法&lt;/h3&gt;
&lt;h4 id=&#34;location-基础知识&#34;&gt;location 基础知识&lt;/h4&gt;
&lt;p&gt;1、location 是在 server 块中配置的。&lt;/p&gt;
&lt;p&gt;2、可以根据不同的 URI 使用不同的配置（location 中配置），来处理不同的请求。&lt;/p&gt;
&lt;p&gt;3、location 是有顺序的，会被第一个匹配的 location 处理。&lt;/p&gt;
&lt;h4 id=&#34;location-配置语法&#34;&gt;location 配置语法&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;location [ = | ~ | ~* | ^~ ] uri {...}
或
location &lt;span class=&#34;ni&#34;&gt;@name&lt;/span&gt; {...}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;location-配置可以有两种配置方法&#34;&gt;location 配置可以有两种配置方法&lt;/h4&gt;
&lt;p&gt;1、前缀 + uri （字符串/正则表达式）&lt;/p&gt;
&lt;p&gt;2、@ + name&lt;/p&gt;
&lt;h4 id=&#34;前缀含义&#34;&gt;前缀含义&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;=：精确匹配，必须全部相等。
~：大小写敏感。
~*：忽略大小写。
^~：只需匹配 uri 部分。
@：内部服务跳转。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;location-配置示例&#34;&gt;location 配置示例&lt;/h4&gt;
&lt;p&gt;（1）=，精确匹配&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;location = / {
    # 规则
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;匹配到 &lt;a href=&#34;http://www.xdhuxc.com/&#34;&gt;http://www.xdhuxc.com/&lt;/a&gt;  这种请求。&lt;/p&gt;
&lt;p&gt;（2）~，大小写敏感&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;location ~ /getUser/ {
    # 规则
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;http://www.xdhuxc.com/getUser/&#34;&gt;http://www.xdhuxc.com/getUser/&lt;/a&gt; 请求成功&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.xdhuxc.com/GetUser/&#34;&gt;http://www.xdhuxc.com/GetUser/&lt;/a&gt; 请求失败&lt;/p&gt;
&lt;p&gt;（3）~*，大小写忽略&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;location ~* /getUser/ {
    # 规则
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这种写法会忽略 uri 部分的大小写&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.xdhuxc.com/getUser/&#34;&gt;http://www.xdhuxc.com/getUser/&lt;/a&gt; 请求成功&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.xdhuxc.com/GetUser/&#34;&gt;http://www.xdhuxc.com/GetUser/&lt;/a&gt; 请求成功&lt;/p&gt;
&lt;p&gt;（4）^~，只匹配以 uri 开头&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;location ^~ /image/ {
    # 规则
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以 /image/ 开头的请求，都会匹配上&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://xdhuxc.com/image/abc.jpg&#34;&gt;http://xdhuxc.com/image/abc.jpg&lt;/a&gt; 请求成功&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://xdhuxc.com/image/cde.mp4&#34;&gt;http://xdhuxc.com/image/cde.mp4&lt;/a&gt; 请求成功&lt;/p&gt;
&lt;p&gt;5、@，nginx 内部跳转&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;location /image/ {
    error_page 404 &lt;span class=&#34;ni&#34;&gt;@image_error&lt;/span&gt;;
}

location &lt;span class=&#34;ni&#34;&gt;@image_error&lt;/span&gt; {
    # 规则
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以 /image/ 开头的请求，如果链接的状态为 404，则会匹配到 @image_error 这条规则上。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/nginx/">Nginx</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Kafka 的部署和常用命令</title>
                <link>https://xdhuxc.github.io/posts/message/kafka/message-queue-kafka-install-and-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/message/kafka/message-queue-kafka-install-and-command/</guid>
                <pubDate>Tue, 10 Apr 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Kafka 的部署和常用命令。&lt;/p&gt;
&lt;h3 id=&#34;部署-kafka&#34;&gt;部署 kafka&lt;/h3&gt;
&lt;h4 id=&#34;原生方式部署-kafka&#34;&gt;原生方式部署 kafka&lt;/h4&gt;
&lt;p&gt;1、启动 &lt;code&gt;zookeeper&lt;/code&gt; 的命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./bin/zookeeper-server-start.sh -daemon ./config/zookeeper.properties
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、&lt;code&gt;zookeeper.properties&lt;/code&gt; 文件内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;dataDir=/xdhuxc/zookeeper/data
&lt;span class=&#34;gh&#34;&gt;# the port at which the clients will connect
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;clientPort=2181
&lt;span class=&#34;gh&#34;&gt;# disable the per-ip limit on the number of connections since this is a non-production config
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;maxClientCnxns=50
tickTime=2000
initLimit=10
syncLimit=5
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 &lt;code&gt;kafka&lt;/code&gt; 的命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./bin/kafka-server-start.sh -daemon ./config/server.properties
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在命令行模式下启动生产者&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./bin/kafka-console-producer.sh --broker-list 192.168.91.128:9092 --topic xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在提示符后面输入消息&lt;/p&gt;
&lt;p&gt;在命令行模式下启动消费者&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./bin/kafka-console-consumer.sh --zookeeper 192.168.91.128:2181 --topic xdhuxc --from-beginning
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看topic是否创建成功&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./bin/kafka-topics.sh --list --zookeeper 192.168.91.128:2181
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;docker-容器部署-kafka&#34;&gt;docker 容器部署 kafka&lt;/h4&gt;
&lt;p&gt;使用如下命令启动 kafka 容器：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --restart=always \
    --net host \
    --name kafka \
    -p 9092:9092 \
    -e KAFKA_ADVERTISED_HOST_NAME=192.168.91.128 \
    -e KAFKA_ADVERTISED_PORT=9092 \
    -e KAFKA_MESSAGE_MAX_BYTES=2000000 \
    -e KAFKA_ZOOKEEPER_CONNECT=192.168.91.128:2181 \
    -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://192.168.91.128:9092 \
    -v /xdhuxc/kafka/data:/kafka \
    -v /xdhuxc/kafka/logs:/opt/kafka/logs \
    wurstmeister/kafka
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;kafka-常用命令&#34;&gt;kafka 常用命令&lt;/h3&gt;
&lt;p&gt;1、创建 topic&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;bin/kafka-topics.sh --create --zookeeper 192.168.91.128:2181 --replication-factor 1 --partitions 3 --topic locallog
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看 topic&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;bin/kafka-topics.sh --list --zookeeper 192.168.91.128:2181
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/kafka/">Kafka</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Redis 常用命令总结</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-command/</guid>
                <pubDate>Tue, 10 Apr 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍了 redis 常用的命令。&lt;/p&gt;
&lt;h3 id=&#34;实用命令&#34;&gt;实用命令&lt;/h3&gt;
&lt;p&gt;1、获取所有的key&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;172.20.26.77:6379&amp;gt; keys &lt;span class=&#34;ge&#34;&gt;*ceryx*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、删除当前数据库中的所有Key&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;flushdb
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、删除所有数据库中的 key&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;flushall  
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、批量删除匹配通配符的 key&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis-cli -h 172.20.26.77 keys &amp;#34;s*&amp;#34; | xargs redis-cli -h 172.20.26.77 del  
或
redis-cli -h 172.20.17.4 -a Xdhuxc123 keys &lt;span class=&#34;ge&#34;&gt;*menu*&lt;/span&gt; | xargs redis-cli -h 172.20.17.4 -a Xdhuxc123 del
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、设置键值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis-cli set /xdhuxc/redis/1 redis1
或
redis-cli set /xdhuxc/redis/1 redis11 # 更新数据
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、连接到主机为： &lt;code&gt;127.0.0.1&lt;/code&gt;，端口为： &lt;code&gt;6379&lt;/code&gt; ，密码为：&lt;code&gt;xdhuxc&lt;/code&gt; 的 redis 服务上&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ ./redis-cli -h 127.0.0.1 -p 6379 -a &amp;#34;xdhuxc&amp;#34;
redis 127.0.0.1:6379&amp;gt;
redis 127.0.0.1:6379&amp;gt; ping
pong
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;redis-键命令&#34;&gt;Redis 键命令&lt;/h3&gt;
&lt;p&gt;Redis 键命令用于管理 Redis 的键。Redis 键命令的基本语法如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis 127.0.0.1:6379&amp;gt; command_name key_name
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Redis 键的基本命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;编号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;del key_name&lt;/td&gt;
&lt;td&gt;删除一个指定的键，如果该键存在&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;dump key_name&lt;/td&gt;
&lt;td&gt;返回存储在指定键的值的序列化版本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;exists key_name&lt;/td&gt;
&lt;td&gt;检查键是否存在&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;expire key_name seconds&lt;/td&gt;
&lt;td&gt;设置键在指定时间秒数之后到期/过期&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;expire key_name timestamp&lt;/td&gt;
&lt;td&gt;设置在指定时间戳之后键到期/过期。这里的时间是Unix时间戳格式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;pexpire key_name milliseconds&lt;/td&gt;
&lt;td&gt;设置键的到期时间，以毫秒为单位&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;pexpire key_name milliseconds-timestamp&lt;/td&gt;
&lt;td&gt;以Unix时间戳形式来设置键的到期时间，以毫秒为单位&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;keys pattern&lt;/td&gt;
&lt;td&gt;查找与指定模式匹配的所有键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;move key_name database&lt;/td&gt;
&lt;td&gt;将键移动到另一个数据库&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;persist key_name&lt;/td&gt;
&lt;td&gt;删除指定键的过期时间，键将持久保持&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;pttl key_name&lt;/td&gt;
&lt;td&gt;获取键的剩余到期时间，以毫秒为单位&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;randomkey&lt;/td&gt;
&lt;td&gt;从Redis返回一个随机的键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;rename old_key_name new_key_name&lt;/td&gt;
&lt;td&gt;更改键的名称。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;renamenx key_name new_key_name&lt;/td&gt;
&lt;td&gt;当new_key_name不存在时，将key_name改名为new_key_name&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;type key_name&lt;/td&gt;
&lt;td&gt;返回存储在键中的值的数据类型&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;ttl key_name&lt;/td&gt;
&lt;td&gt;返回给定键的剩余生存时间，以秒为单位&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/educast/article/details/37695803&#34;&gt;https://blog.csdn.net/educast/article/details/37695803&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/secretx/article/details/73498148&#34;&gt;https://blog.csdn.net/secretx/article/details/73498148&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/kexiaoling/article/details/51810919&#34;&gt;https://blog.csdn.net/kexiaoling/article/details/51810919&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Redis 常用数据类型总结</title>
                <link>https://xdhuxc.github.io/posts/storage/redis/redis-data-type/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/storage/redis/redis-data-type/</guid>
                <pubDate>Tue, 10 Apr 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客主要介绍了 redis 的常用数据类型。&lt;/p&gt;
&lt;h3 id=&#34;字符串&#34;&gt;字符串&lt;/h3&gt;
&lt;p&gt;Redis 中的字符串是一个字节序列，并且字符串是二进制安全的，这意味着它们的长度不由任何特殊的终止字符决定，因此，可以在一个字符串中存储高达 &lt;code&gt;512MB&lt;/code&gt; 的任何内容。&lt;/p&gt;
&lt;p&gt;Redis 字符串数据类型的相关命令用于管理 Redis 字符串值。基本语法格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;redis 127.0.0.1:6379&amp;gt; command_name key_name
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;常用的 Redis 字符串命令如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;set key_name value&lt;/td&gt;
&lt;td&gt;设置指定键的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;get key_name&lt;/td&gt;
&lt;td&gt;获取指定键的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;getrange key_name start end&lt;/td&gt;
&lt;td&gt;获取存储在键上的字符串的子字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;getset key_name value&lt;/td&gt;
&lt;td&gt;将给定键的值设置为value，并并返回键的旧值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;getbit key_name offset&lt;/td&gt;
&lt;td&gt;对键所储存的字符串值，获取指定偏移量上的位&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;mget key_name_1, key_name_2, key_name_3,....&lt;/td&gt;
&lt;td&gt;获取一个或多个给定键的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;setbit key offset value&lt;/td&gt;
&lt;td&gt;对键所存储的字符串值，设置或清除指定偏移量上的位&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;setex key_name seconds value&lt;/td&gt;
&lt;td&gt;使用键和过期时间来设置值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;setnx key_name value&lt;/td&gt;
&lt;td&gt;当键不存在时，设置键的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;setrange key_name offset value&lt;/td&gt;
&lt;td&gt;从指定偏移量开始，用value覆盖给定键所存储的字符串值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;strlen key_name&lt;/td&gt;
&lt;td&gt;返回键所存储的字符串值的长度&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;mset key value [key value...]&lt;/td&gt;
&lt;td&gt;同时设置一个或多个key-value对&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;msetnx key value [key value...]&lt;/td&gt;
&lt;td&gt;同时设置一个或多个key-value对，当且仅当所有给定的键都不存在&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;psetex key_name milliseconds value&lt;/td&gt;
&lt;td&gt;设置键的值，以毫秒为单位设置过期时间&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;incr key_name&lt;/td&gt;
&lt;td&gt;将键中存储的整数值加1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;incrby key_name increment&lt;/td&gt;
&lt;td&gt;将键的整数值按给定的数值增加&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;incrbyfloat key_name increment&lt;/td&gt;
&lt;td&gt;将键的浮点值按给定的数值增加&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18&lt;/td&gt;
&lt;td&gt;decr key_name&lt;/td&gt;
&lt;td&gt;将键的整数值减1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;19&lt;/td&gt;
&lt;td&gt;decrby key_name decrement&lt;/td&gt;
&lt;td&gt;按给定数值减少键的整数值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;append key_name value&lt;/td&gt;
&lt;td&gt;将指定值附加到键&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;散列哈希&#34;&gt;散列/哈希&lt;/h3&gt;
&lt;p&gt;Redis 散列/哈希（Hash）是键值对的集合。Redis 散列/哈希是字符串字段和字符串值之间的映射。因此，哈希/散列特别适合用于存储对象。每个散列/哈希可以存储多达 &lt;code&gt;2^32-1&lt;/code&gt; 个键值对。&lt;/p&gt;
&lt;p&gt;Redis 哈希的基本命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;hdel key_name field_1 [field_2]&lt;/td&gt;
&lt;td&gt;删除一个或多个哈希表字段&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;hexists key_name field&lt;/td&gt;
&lt;td&gt;判断是否存在散列字段&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;hget key_name field&lt;/td&gt;
&lt;td&gt;获取存储在指定键的哈希字段的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;hgetall key_name&lt;/td&gt;
&lt;td&gt;获取存储在指定键的哈希中的所有字段和值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;hincrby key_name field increment&lt;/td&gt;
&lt;td&gt;将哈希字段的整数值按给定数字增加&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;hincrbyfloat key_name field increment&lt;/td&gt;
&lt;td&gt;将哈希字段的浮点值按给定数值增加&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;hkeys key_name&lt;/td&gt;
&lt;td&gt;获取哈希中的所有字段&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;hlen key_name&lt;/td&gt;
&lt;td&gt;获取散列中的字段数量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;hmget key_name field_1 [field_2]&lt;/td&gt;
&lt;td&gt;获取所有给定哈希字段的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;hmset key_name field_1 value_1 [field_2 value_2]&lt;/td&gt;
&lt;td&gt;为多个哈希字段分别设置它们的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;hset key_name field value&lt;/td&gt;
&lt;td&gt;设置散列字段的字符串值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;hsetnx key_name field value&lt;/td&gt;
&lt;td&gt;仅当字段不存在时，才设置散列字段的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;hvals key_name&lt;/td&gt;
&lt;td&gt;获取哈希表中的所有值&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;列表&#34;&gt;列表&lt;/h3&gt;
&lt;p&gt;Redis 列表只是字符串列表，按插入顺序排序。您可以向 Redis 列表的头部或尾部添加元素。列表的最大长度为&lt;code&gt;2^32-1&lt;/code&gt;个元素。&lt;/p&gt;
&lt;p&gt;Redis 列表的基本命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;blpop key_name_1 [key_name_2] timeout&lt;/td&gt;
&lt;td&gt;删除并获取列表中的第一个元素，或阻塞，直到有一个元素可用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;brpop key_name_1 [key_name_2] timeout&lt;/td&gt;
&lt;td&gt;删除并获取列表中的最后一个元素，或阻塞，直到有一个元素可用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;brpoplpush source desitination timeout&lt;/td&gt;
&lt;td&gt;从列表中弹出值，将其推送到另一个列表并返回它; 或阻塞，直到一个可用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;lindex key_name index&lt;/td&gt;
&lt;td&gt;通过其索引从列表获取元素&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;linsert key_name before/after pivot value&lt;/td&gt;
&lt;td&gt;在列表中的另一个元素之前或之后插入元素&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;llen key_name&lt;/td&gt;
&lt;td&gt;获取列表的长度&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;lpop key_name&lt;/td&gt;
&lt;td&gt;删除并获取列表中的第一个元素&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;lpush key_name value_1 [value_2]&lt;/td&gt;
&lt;td&gt;将一个或多个值添加到列表&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;lpushx key_name value&lt;/td&gt;
&lt;td&gt;仅当列表存在时，才向列表添加值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;lrange key_name start stop&lt;/td&gt;
&lt;td&gt;从列表中获取一系列元素&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;lrem key_name count value&lt;/td&gt;
&lt;td&gt;从列表中删除元素&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;lset key_name index value&lt;/td&gt;
&lt;td&gt;通过索引在列表中设置元素的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;ltrim key_name start stop&lt;/td&gt;
&lt;td&gt;让列表只保留指定区间内的元素，不在指定区间之内的元素都将被删除&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;rpop key_name&lt;/td&gt;
&lt;td&gt;删除并获取列表中的最后一个元素&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;rpoplpush source desitination&lt;/td&gt;
&lt;td&gt;移除列表的最后一个元素，并将该元素添加到另一个列表并返回&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;rpush key_name value_1 [value_2]&lt;/td&gt;
&lt;td&gt;在列表中添加一个或多个值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;rpushx key_name value&lt;/td&gt;
&lt;td&gt;为已存在的列表添加值&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;集合&#34;&gt;集合&lt;/h3&gt;
&lt;p&gt;Redis集合是字符串的无序集合。集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。根据集合内元素的唯一性，第二次插入的元素将被忽略。集合中最大的元素个数为 &lt;code&gt;$ 2^{32}-1 $&lt;/code&gt; 个。&lt;/p&gt;
&lt;p&gt;Redis 集合常用命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;sadd key_name member_1 [member_2]&lt;/td&gt;
&lt;td&gt;向集合添加一个或多个成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;scard key_name&lt;/td&gt;
&lt;td&gt;获取集合的成员数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;sdiff key_name_1 [key_name_2]&lt;/td&gt;
&lt;td&gt;返回给定所有集合的差集&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;sdiffstore destination key_name_1 [key_name_2]&lt;/td&gt;
&lt;td&gt;返回给定所有集合的差集并存储在 destination 中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;sinter key_name_1 [key_name_2]&lt;/td&gt;
&lt;td&gt;返回给定所有集合的交集&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;sinterstore destination key_name_1 [key_name_2]&lt;/td&gt;
&lt;td&gt;返回给定所有集合的交集并存储在 destination 中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;sismember key_name memeber&lt;/td&gt;
&lt;td&gt;判断member元素是否是集合key_name的成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;smembers key_name&lt;/td&gt;
&lt;td&gt;返回集合中的所有成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;smove source destination member&lt;/td&gt;
&lt;td&gt;将 member 元素从 source 集合移动到 destination 集合&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;spop key_name&lt;/td&gt;
&lt;td&gt;从集合中删除并返回随机成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;srandmember key_name [count]&lt;/td&gt;
&lt;td&gt;返回集合中一个或多个随机数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;srem key_name member_1 [member_2]&lt;/td&gt;
&lt;td&gt;移除集合中一个或多个成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;sunion key_name_1 [key_name_2]&lt;/td&gt;
&lt;td&gt;返回所有给定集合的并集&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;sunionstore destination key_name_1 [key_name_2]&lt;/td&gt;
&lt;td&gt;所有给定集合的并集存储在 destination 集合中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;sscan key_name cursor [match pattern][count count]&lt;/td&gt;
&lt;td&gt;迭代集合中的元素&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;有序集合&#34;&gt;有序集合&lt;/h3&gt;
&lt;p&gt;Redis 有序集合类似于 Redis 集合，是不重复的字符集合， 不同之处在于，有序集合的每个成员都与分数相关联，这个分数用于 &lt;code&gt;按最小分数到最大分数&lt;/code&gt; 来排序的有序集合。虽然元素是唯一的，但元素的分数值可以重复。&lt;/p&gt;
&lt;p&gt;Redis 有序集合基本命令：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;zadd key_name score_1 member_1 [score_2, member_2]&lt;/td&gt;
&lt;td&gt;向有序集合添加一个或多个成员，或者更新已存在成员的分数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;zcard key_name&lt;/td&gt;
&lt;td&gt;获取有序集合的成员数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;zcount key_name min max&lt;/td&gt;
&lt;td&gt;计算在有序集合中指定区间分数的成员数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;zincrby key_name increment member&lt;/td&gt;
&lt;td&gt;有序集合中对指定成员的分数加上增量 increment&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;zinterstore destination numkeys key_name_1 [key_name_2...]&lt;/td&gt;
&lt;td&gt;计算给定的一个或多个有序集的交集并将结果集存储在新的有序集合 key 中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;zlexcount key_name min max&lt;/td&gt;
&lt;td&gt;在有序集合中计算指定字典区间内成员数量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;zrange key_name start stop [withscores]&lt;/td&gt;
&lt;td&gt;通过索引区间返回有序集合成指定区间内的成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;zrangebylex key_name min max [limit offset count]&lt;/td&gt;
&lt;td&gt;通过字典区间返回有序集合的成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;zrangebyscore key_name min max [withscores][limit]&lt;/td&gt;
&lt;td&gt;通过分数返回有序集合指定区间内的成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;zrank key_name member&lt;/td&gt;
&lt;td&gt;返回有序集合中指定成员的索引&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;zrem key_name member [member...]&lt;/td&gt;
&lt;td&gt;移除有序集合中的一个或多个成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;zremrangebylex key_name min max&lt;/td&gt;
&lt;td&gt;移除有序集合中给定的字典区间的所有成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;zremrangebyrank key_name start stop&lt;/td&gt;
&lt;td&gt;移除有序集合中给定的排名区间的所有成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;zremrangebyscore key_name min max&lt;/td&gt;
&lt;td&gt;移除有序集合中给定的分数区间的所有成员&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;zrevrange key_name start stop [withscores]&lt;/td&gt;
&lt;td&gt;返回有序集中指定区间内的成员，通过索引，分数从高到底&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;zrevrangebyscore key_name max min [withscores]&lt;/td&gt;
&lt;td&gt;返回有序集中指定分数区间内的成员，分数从高到低排序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;zrevrank key_name member&lt;/td&gt;
&lt;td&gt;返回有序集合中指定成员的排名，有序集成员按分数值递减(从大到小)排序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;18&lt;/td&gt;
&lt;td&gt;zscore key_name member&lt;/td&gt;
&lt;td&gt;返回有序集中，成员的分数值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;19&lt;/td&gt;
&lt;td&gt;zunionstore destination numkeys key_name_1 [key_name_2...]&lt;/td&gt;
&lt;td&gt;计算给定的一个或多个有序集的并集，并存储在新的 key 中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;zscan key_name cursor [match pattern][count count]&lt;/td&gt;
&lt;td&gt;迭代有序集合中的元素（包括元素成员和元素分值）&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/redis/">Redis</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>zookeeper 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/mixed/zookeeper/zookeeper-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/zookeeper/zookeeper-questions-and-solutions/</guid>
                <pubDate>Wed, 14 Mar 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在使用 zookeeper 的过程中经常遇到的问题及解决方法。&lt;/p&gt;
&lt;p&gt;1、重启zookeeper时报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Apr 23 17:08:30 localhost zookeeper: 2018-04-23 17:08:30,702 [myid:] - ERROR [main:Util@239] - Last transaction was partial.
Apr 23 17:08:30 localhost zookeeper: 2018-04-23 17:08:30,703 [myid:] - ERROR [main:ZooKeeperServerMain@63] - Unexpected exception, exiting abnormally
Apr 23 17:08:30 localhost zookeeper: java.io.EOFException
Apr 23 17:08:30 localhost zookeeper: at java.io.DataInputStream.readInt(DataInputStream.java:392)
Apr 23 17:08:30 localhost zookeeper: at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决&lt;/p&gt;
&lt;p&gt;找到 &lt;code&gt;/etc/zookeeper/conf/zoo.cfg&lt;/code&gt; 文件，找到 &lt;code&gt;zookeeper&lt;/code&gt; 的数据目录，删除该数据目录，重新启动 &lt;code&gt;zookeeper&lt;/code&gt; 即可。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/zookeeper/">Zookeeper</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>使用 kubeadmin 安装 Kubernetes</title>
                <link>https://xdhuxc.github.io/posts/kubernetes/kubernetes-installation/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/kubernetes/kubernetes-installation/</guid>
                <pubDate>Sat, 10 Mar 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了分别使用 kubeadmin 安装 Kubernetes 的详细过程，还记录了安装过程中可能出现的问题及解决方法。&lt;/p&gt;
&lt;h3 id=&#34;安装-kubernetes&#34;&gt;安装 kubernetes&lt;/h3&gt;
&lt;p&gt;1、修改主机名&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;hostnamectl set-hostname &amp;#39;k8s-master&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、禁用 SELinux&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;setenforce 0
sed -i --follow-symlinks &amp;#39;s/SELINUX=enforcing/SELINUX=disabled/g&amp;#39; /etc/sysconfig/selinux
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、修改内核参数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cat &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;EOF&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;  /etc/sysctl.d/kubernetes.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
vm.swappiness=0
EOF

sysctl --system
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、关闭防火墙&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl stop firewalld
systemctl disable firewalld
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、禁用 swap&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;swapoff -a
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 &lt;code&gt;/etc/fstab&lt;/code&gt; 文件，注释掉 Swap 的自动挂载&lt;/p&gt;
&lt;p&gt;6、使用如下 kubernetes repo 源 及 docker 源&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cat &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;EOF&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
EOF
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、安装 docker&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo # 配置 docker repo 源
yum list docker-ce.x86_64  --showduplicates |sort -r # 查看最新的 Docker 版本
yum install docker-ce-18.06
systemctl restart docker &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; systemctl enable docker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、安装 dubeadm&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y kubeadm 
systemctl restart kubelet &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; systemctl enable kubelet
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;9、使用 kubeadm
执行命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kubeadm init \
     --kubernetes-version=v1.13.1 \
     --pod-network-cidr=10.244.0.0/16 \
     --apiserver-advertise-address=10.0.2.15
     

mkdir -p $HOME/.kube
\cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
chown $(id -u):$(id -g) $HOME/.kube/config
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行效果为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master ~]# kubeadm init \
&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;    --kubernetes-version=v1.13.1 \
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;    --pod-network-cidr=10.244.0.0/16 \
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;    --apiserver-advertise-address=10.0.2.15
&lt;/span&gt;&lt;span class=&#34;ge&#34;&gt;&lt;/span&gt;[init] Using Kubernetes version: v1.13.1
[preflight] Running pre-flight checks
	[WARNING Hostname]: hostname &amp;#34;k8s-master&amp;#34; could not be reached
	[WARNING Hostname]: hostname &amp;#34;k8s-master&amp;#34;: lookup k8s-master on 10.0.2.3:53: no such host
[preflight] Pulling images required for setting up a Kubernetes cluster
[preflight] This might take a minute or two, depending on the speed of your internet connection
[preflight] You can also perform this action in beforehand using &amp;#39;kubeadm config images pull&amp;#39;
[kubelet-start] Writing kubelet environment file with flags to file &amp;#34;/var/lib/kubelet/kubeadm-flags.env&amp;#34;
[kubelet-start] Writing kubelet configuration to file &amp;#34;/var/lib/kubelet/config.yaml&amp;#34;
[kubelet-start] Activating the kubelet service
[certs] Using certificateDir folder &amp;#34;/etc/kubernetes/pki&amp;#34;
[certs] Generating &amp;#34;etcd/ca&amp;#34; certificate and key
[certs] Generating &amp;#34;etcd/healthcheck-client&amp;#34; certificate and key
[certs] Generating &amp;#34;etcd/server&amp;#34; certificate and key
[certs] etcd/server serving cert is signed for DNS names [k8s-master localhost] and IPs [10.0.2.15 127.0.0.1 ::1]
[certs] Generating &amp;#34;etcd/peer&amp;#34; certificate and key
[certs] etcd/peer serving cert is signed for DNS names [k8s-master localhost] and IPs [10.0.2.15 127.0.0.1 ::1]
[certs] Generating &amp;#34;apiserver-etcd-client&amp;#34; certificate and key
[certs] Generating &amp;#34;ca&amp;#34; certificate and key
[certs] Generating &amp;#34;apiserver&amp;#34; certificate and key
[certs] apiserver serving cert is signed for DNS names [k8s-master kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 10.0.2.15]
[certs] Generating &amp;#34;apiserver-kubelet-client&amp;#34; certificate and key
[certs] Generating &amp;#34;front-proxy-ca&amp;#34; certificate and key
[certs] Generating &amp;#34;front-proxy-client&amp;#34; certificate and key
[certs] Generating &amp;#34;sa&amp;#34; key and public key
[kubeconfig] Using kubeconfig folder &amp;#34;/etc/kubernetes&amp;#34;
[kubeconfig] Writing &amp;#34;admin.conf&amp;#34; kubeconfig file
[kubeconfig] Writing &amp;#34;kubelet.conf&amp;#34; kubeconfig file
[kubeconfig] Writing &amp;#34;controller-manager.conf&amp;#34; kubeconfig file
[kubeconfig] Writing &amp;#34;scheduler.conf&amp;#34; kubeconfig file
[control-plane] Using manifest folder &amp;#34;/etc/kubernetes/manifests&amp;#34;
[control-plane] Creating static Pod manifest for &amp;#34;kube-apiserver&amp;#34;
[control-plane] Creating static Pod manifest for &amp;#34;kube-controller-manager&amp;#34;
[control-plane] Creating static Pod manifest for &amp;#34;kube-scheduler&amp;#34;
[etcd] Creating static Pod manifest for local etcd in &amp;#34;/etc/kubernetes/manifests&amp;#34;
[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory &amp;#34;/etc/kubernetes/manifests&amp;#34;. This can take up to 4m0s
[apiclient] All control plane components are healthy after 20.512973 seconds
[uploadconfig] storing the configuration used in ConfigMap &amp;#34;kubeadm-config&amp;#34; in the &amp;#34;kube-system&amp;#34; Namespace
[kubelet] Creating a ConfigMap &amp;#34;kubelet-config-1.13&amp;#34; in namespace kube-system with the configuration for the kubelets in the cluster
[patchnode] Uploading the CRI Socket information &amp;#34;/var/run/dockershim.sock&amp;#34; to the Node API object &amp;#34;k8s-master&amp;#34; as an annotation
[mark-control-plane] Marking the node k8s-master as control-plane by adding the label &amp;#34;node-role.kubernetes.io/master=&amp;#39;&amp;#39;&amp;#34;
[mark-control-plane] Marking the node k8s-master as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]
[bootstrap-token] Using token: 1n0oej.96h4zyk2j1tnp263
[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles
[bootstraptoken] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials
[bootstraptoken] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token
[bootstraptoken] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster
[bootstraptoken] creating the &amp;#34;cluster-info&amp;#34; ConfigMap in the &amp;#34;kube-public&amp;#34; namespace
[addons] Applied essential addon: CoreDNS
[addons] Applied essential addon: kube-proxy

Your Kubernetes master has initialized successfully!

To start using your cluster, you need to run the following as a regular user:

  mkdir -p $HOME/.kube
  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
  sudo chown $(id -u):$(id -g) $HOME/.kube/config

You should now deploy a pod network to the cluster.
Run &amp;#34;kubectl apply -f [podnetwork].yaml&amp;#34; with one of the options listed at:
  https://kubernetes.io/docs/concepts/cluster-administration/addons/

You can now join any number of machines by running the following on each node
as root:

  kubeadm join 10.0.2.15:6443 --token 1n0oej.96h4zyk2j1tnp263 --discovery-token-ca-cert-hash sha256:927f51ac11f8c874b8b9531d465cedcb8b53028f0aac003be071a2fd2acc60e4

[root@k8s-master ~]# mkdir -p $HOME/.kube
[root@k8s-master ~]# \cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
[root@k8s-master ~]# chown $(id -u):$(id -g) $HOME/.kube/config
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;10、查看节点状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master ~]# kubectl get nodes
NAME         STATUS     ROLES    AGE    VERSION
k8s-master   NotReady   master   5m6s   v1.13.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时还需要配置网络插件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://docs.projectcalico.org/v3.4/getting-started/kubernetes/installation/hosted/calico.yaml
kubectl apply -f calico.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时再查看 kubernetes 的状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master ~]# kubectl get nodes
NAME         STATUS   ROLES    AGE   VERSION
k8s-master   Ready    master   15m   v1.13.1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;11、重置集群&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master ~]# kubeadm reset
[reset] WARNING: changes made to this host by &amp;#39;kubeadm init&amp;#39; or &amp;#39;kubeadm join&amp;#39; will be reverted.
[reset] are you sure you want to proceed? [y/N]: y
[preflight] running pre-flight checks
[reset] Reading configuration from the cluster...
[reset] FYI: You can look at this config file with &amp;#39;kubectl -n kube-system get cm kubeadm-config -oyaml&amp;#39;
[reset] stopping the kubelet service
[reset] unmounting mounted directories in &amp;#34;/var/lib/kubelet&amp;#34;
[reset] deleting contents of stateful directories: [/var/lib/etcd /var/lib/kubelet /etc/cni/net.d /var/lib/dockershim /var/run/kubernetes]
[reset] deleting contents of config directories: [/etc/kubernetes/manifests /etc/kubernetes/pki]
[reset] deleting files: [/etc/kubernetes/admin.conf /etc/kubernetes/kubelet.conf /etc/kubernetes/bootstrap-kubelet.conf /etc/kubernetes/controller-manager.conf /etc/kubernetes/scheduler.conf]

The reset process does not reset or clean up iptables rules or IPVS tables.
If you wish to reset iptables, you must do so manually.
For example:
iptables -F &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; iptables -t nat -F &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; iptables -t mangle -F &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; iptables -X

If your cluster was setup to utilize IPVS, run ipvsadm --clear (or similar)
to reset your system&amp;#39;s IPVS tables.

[root@k8s-master ~]# iptables -F &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; iptables -t nat -F &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; iptables -t mangle -F &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; iptables -X
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;问题及解决&#34;&gt;问题及解决&lt;/h4&gt;
&lt;p&gt;1、coredns pod 一直处于 pending 状态，使用 kubectl describe 查看后，错误信息如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;QoS Class:       Burstable
Node-Selectors:  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;none&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
Tolerations:     CriticalAddonsOnly
                 node-role.kubernetes.io/master:NoSchedule
                 node.kubernetes.io/not-ready:NoExecute for 300s
                 node.kubernetes.io/unreachable:NoExecute for 300s
Events:
  Type     Reason            Age                 From               Message
  ----     ------            ----                ----               -------
  Warning  FailedScheduling  33m                 default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn&amp;#39;t tolerate.
  Warning  FailedScheduling  32m (x3 over 32m)   default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn&amp;#39;t tolerate.
  Warning  FailedScheduling  30m                 default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn&amp;#39;t tolerate.
  Warning  FailedScheduling  26m (x6 over 29m)   default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn&amp;#39;t tolerate.
  Warning  FailedScheduling  14m (x29 over 24m)  default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn&amp;#39;t tolerate.
  Warning  FailedScheduling  12m                 default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn&amp;#39;t tolerate.
  Warning  FailedScheduling  5m41s               default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn&amp;#39;t tolerate.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这是因为 kubernetes 出于安全考虑，默认情况下无法在 master 节点上部署 pod，由于我们只有一个节点，所以需要取消此限制，执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master ~]# kubectl taint nodes --all node-role.kubernetes.io/master-
node/k8s-master untainted
[root@k8s-master ~]# kubectl get pods --all-namespaces
NAMESPACE     NAME                                 READY   STATUS             RESTARTS   AGE
kube-system   coredns-86c58d9df4-gzx76             1/1     Running            0          53m
kube-system   coredns-86c58d9df4-vvbt9             1/1     Running            0          54m
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/kubernetes/">Kubernetes</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>JSON 格式数据工具 JQ 的使用</title>
                <link>https://xdhuxc.github.io/posts/tools/tools-json-jq/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/tools/tools-json-jq/</guid>
                <pubDate>Wed, 07 Mar 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下处理 JSON 格式数据的工具 JQ 的使用。&lt;/p&gt;
&lt;h3 id=&#34;jq-工具&#34;&gt;JQ 工具&lt;/h3&gt;
&lt;h4 id=&#34;centos-安装-jq&#34;&gt;CentOS 安装 JQ&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -O jq https://github.com/stedolan/jq/releases/download/jq-1.5/jq-linux64
chmod +x ./jq
mv ./jq /usr/bin
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;jq-语法&#34;&gt;JQ 语法&lt;/h4&gt;
&lt;p&gt;1、获取如下的 JSON 格式文件 xdhuxc.json 中 lastName 的值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
  &amp;#34;uid&amp;#34;: &amp;#34;2378&amp;#34;,
  &amp;#34;nameInfo&amp;#34;: [
    {
      &amp;#34;firstName&amp;#34;: &amp;#34;nova&amp;#34;,
      &amp;#34;lastName&amp;#34;: &amp;#34;jos&amp;#34;
    }
  ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cat xdhuxc.json | jq -r &amp;#39;.nameInfo[].lastName&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;获取如下的 JSON 格式文件 xdhuxc.json 中 value 的值&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
    &amp;#34;action&amp;#34;: &amp;#34;get&amp;#34;,
    &amp;#34;node&amp;#34;: {
        &amp;#34;createdIndex&amp;#34;: 356,
        &amp;#34;key&amp;#34;: &amp;#34;token.key&amp;#34;,
        &amp;#34;modifiedIndex&amp;#34;: 356,
        &amp;#34;value&amp;#34;: &amp;#34;abcdefg&amp;#34;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cat xdhuxc.json | jq -r &amp;#39;.node.value&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;-r：该选项控制 jq 是输出 raw 格式内容或 JSON 格式内容。所谓 JSON 格式是指符合 JSON 标准的格式。例如，假设我们要查询 JSON 字符串 {&amp;quot;name&amp;quot;:&amp;quot;tom&amp;quot;} 中 name 的值，使用 -r 选项时返回的是 tom，不使用 -r 选项时，返回的是 &amp;quot;tom&amp;quot;，返回值多了一对双引号。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/json/">JSON</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 Flask 开发 Python Web 程序</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-flask/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-flask/</guid>
                <pubDate>Tue, 27 Feb 2018 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了一个使用 Flask 开发的 Python web 程序，可以作为使用 Flask 开发 web 程序的入门教程。&lt;/p&gt;
&lt;h3 id=&#34;安装-flask-环境&#34;&gt;安装 Flask 环境&lt;/h3&gt;
&lt;p&gt;1、Flask 依赖两个外部库： Werkzeug 和 Jinja2 。Werkzeug 是一个 WSGI 套件。 WSGI 是 Web 应用与 多种服务器之间的标准 Python 接口，即用于开发，也用于部署。 Jinja2 是用于渲染 模板的。&lt;/p&gt;
&lt;p&gt;2、virtualenv的基本原理是为每个项目安装一套 Python ，多套 Python 并存。但它不是真正地安装多套独立的 Python 拷贝，而是使用了一种巧妙的方法让不同的项目处于各自独立的环境中。使用虚拟环境可以方便地安装 Flask 并且可以在系统的 Python 解释器中避免包的混乱和版本冲突。Python 3.3 以后原生支持虚拟环境，命令为：pyvenv。&lt;/p&gt;
&lt;p&gt;1）安装虚拟 &lt;code&gt;Python&lt;/code&gt; 环境，在 &lt;code&gt;Linux&lt;/code&gt; 或者 &lt;code&gt;Windows&lt;/code&gt; 下，使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo pip install virtualenv
或
sudo easy_install virtualenv
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;Ubuntu&lt;/code&gt; 中使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo apt-get install python-virtualenv
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）使用virtualenv命令在文件夹中创建 Python 虚拟环境&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;virtualenv venv
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）每次需要使用项目时，必须先激活相应的环境&lt;/p&gt;
&lt;p&gt;CentOS 下运行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;. venv/bin/activate
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;Windows&lt;/code&gt; 下运行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;.\venv\Scripts\activate
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果要退出虚拟环境，可以使用&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;.\venv\Scripts\deactivate.bat
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4）安装 flask&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo pip install flask
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;flask-程序结构&#34;&gt;Flask 程序结构&lt;/h3&gt;
&lt;p&gt;1、使用 PyCharm 新建 Flask 项目后，项目结构如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/programming/python/flask/WechatIMG667.png&#34; width=&#34;300px&#34; height=&#34;200px&#34; /&gt;
&lt;/center&gt;
只有三个文件夹（venv文件夹已经用命令行生成）和一个简单地入口类。
&lt;p&gt;2、改造为标准的 Flask 项目&lt;/p&gt;
&lt;p&gt;在命令行中依次使用以下命令来安装 Flask 扩展。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;E:\PycharmProject\xflask&amp;gt;.\venv\Scripts\activate

(venv) E:\PycharmProject\xflask&amp;gt;pip install flask-script
(venv) E:\PycharmProject\xflask&amp;gt;pip install flask-sqlalchemy
(venv) E:\PycharmProject\xflask&amp;gt;pip install flask-migrate
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;flask-script 可以自定义命令行命令，用来启动程序或其他任务；flask-sqlalchemy用来管理数据库的工具，支持多种数据库后台；flask-migrate是数据库迁移工具，该工具命令集成到 flask-script中，方便在命令行中进行操作。
创建 config.py 文件，内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import os

basedir = os.path.abspath(os.path.dirname(__file__))

class config:    
    SECRET_KEY = os.environ.get(&amp;#39;SECRET_KEY&amp;#39;) or &amp;#39;this is a secret string&amp;#39; 
    SQLALCHEMY_TRACK_MODIFICATIONS = True  

    &lt;span class=&#34;ni&#34;&gt;@staticmethod&lt;/span&gt;    
    def init_app(app):        
        pass

class DevelopmentConfig(config):    
    DEBUG = True    
    SQLALCHEMY_DATABASE_URI = os.environ.get(&amp;#39;DEV_DATABASE_URL&amp;#39;) or \        
    &amp;#39;sqlite:///&amp;#39; + os.path.join(basedir, &amp;#39;dev&amp;#39;)

class TestingConfig(config):    
    TESTING = True    
    SQLALCHEMY_DATABASE_URI = os.environ.get(&amp;#39;TEST_DATABASE_URL&amp;#39;) or \                              
    &amp;#39;sqlite:///&amp;#39; + os.path.join(basedir, &amp;#39;test&amp;#39;)

class ProductionConfig(config):    
    SQLALCHEMY_DATABASE_URI = os.environ.get(&amp;#39;DATABASE_URL&amp;#39;) or \                              
    &amp;#39;sqlite:///&amp;#39; + os.path.join(basedir, &amp;#39;data.sqlite&amp;#39;)

config = {    
    &amp;#39;development&amp;#39;: DevelopmentConfig,    
    &amp;#39;testing&amp;#39;: TestingConfig,    
    &amp;#39;production&amp;#39;: ProductionConfig,    
    &amp;#39;default&amp;#39;: DevelopmentConfig
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;config 保存了一些配置变量，SQLALCHEMY_DATABASE_URI 变量在不同的配置中被赋予了不同的值，这样就可以在不同的环境中切换数据库。如果是远程数据库，则从环境变量中读取URL，否则在本地路径中创建。&lt;/p&gt;
&lt;p&gt;创建一个 app 目录，并在此目录中创建一个 &lt;code&gt;__init__.py&lt;/code&gt; 文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;from flask import Flask
from flask_sqlalchemy import SQLAlchemy
from config import config

db = SQLAlchemy()


def create_app(config_name):
    app = Flask(__name__)
    app.config.from_object(config[config_name])
    config[config_name].init_app(app)
    db.init_app(app)

    return app
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Create_app() 就是程序的工厂函数，参数就是配置类的名称，即config.py，其中保存的配置可以使用from_object()方法导入。&lt;/p&gt;
&lt;p&gt;路由和视图函数：
客户端把请求发送给 web服务器，web服务器再把请求发送给 Flask 程序实例，Flask程序实例需要知道每个URL请求要运行哪些代码，所以保存了一个URL到Python函数的映射关系。处理URL和函数之间关系的程序称为路由，这个函数称为视图函数。例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;ni&#34;&gt;@app&lt;/span&gt;.route(&amp;#39;/&amp;#39;)
def index():
    return &amp;#39;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Hello World&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这里使用app.route修饰器来定义路由，app指Flask程序实例对象，后面可以看到使用蓝本管理路由后，由蓝本实例对象来取代app。Flask 使用蓝本来定义路由，在蓝本中定义的路由处于休眠状态，直到蓝本注册到程序上后，路由真正成为程序的一部分。蓝本通常使用结构化的方式保存在包的多个模块中。&lt;/p&gt;
&lt;p&gt;接下来在app目录中创建一个子目录main，并在main目录中创建文件 &lt;code&gt;__init__.py&lt;/code&gt;，在 &lt;code&gt;__init__.py&lt;/code&gt; 中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;from flask import Blueprint

&lt;span class=&#34;gh&#34;&gt;# 实例化 Blueprint 类，两个参数分别为蓝本的名字和蓝本所在包或模块，第二个通常填 __name__ 即可
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;main = Blueprint(&amp;#39;main&amp;#39;, &lt;span class=&#34;gs&#34;&gt;__name__&lt;/span&gt;)


from . import views, errors
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;最后引用了两个文件，写在最后是为了避免循环导入依赖，因为接下来在 main 目录下创建的views.py 和 errors.py 都要导入蓝本 main。&lt;/p&gt;
&lt;p&gt;在main目录下创建 views.py&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;from flask import render_template

&lt;span class=&#34;gh&#34;&gt;# 导入蓝本 main
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;from . import main


&lt;span class=&#34;ni&#34;&gt;@main&lt;/span&gt;.route(&amp;#39;/&amp;#39;)
def index():
    return render_template(&amp;#39;index.html&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在路由的概念解释中，index函数直接返回了HTML字符串，通常不这么做。这里则使用了render_template()函数来渲染index.html，并返回。Flask 使用了 Jinja2引擎来渲染模板，模板文件都放在templates目录下，并且该目录只能命名为templates，否则Jinja2会抛出TemplateNotFound异常。&lt;/p&gt;
&lt;p&gt;由于app是一个Python Package（在目录中包含__init__.py的目录默认成为Python Pckage），所以需要将templates放在app目录下，在app目录下创建templates目录。然后在templates下创建一个index.html和404.html模板。
index.html文件内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;lang&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;en&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meta&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;UTF-8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;index&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Hello World&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;404.html内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;lang&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;en&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meta&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;charset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;UTF-8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Not Found&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Can&amp;#39;t find request page!&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;定义errors.py，内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;from flask import render_template
from . import main


&lt;span class=&#34;ni&#34;&gt;@main&lt;/span&gt;.app_errorhandler(404)
def page_not_found(e):
    return render_template(&amp;#39;404.html&amp;#39;), 404
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;让程序的路由保存在views.py中，而错误处理交给errors.py，这两个模块已经和蓝本main关联起来了（在蓝本中导入了这两个模块）。现在需要在工厂函数中注入蓝本main，将如下代码加入到app/&lt;strong&gt;init&lt;/strong&gt;.py中&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;from flask import Flask
from flask_sqlalchemy import SQLAlchemy
from config import config
from .main import main as main_blueprint

db = SQLAlchemy()


def create_app(config_name):
    app = Flask(__name__)
    app.config.from_object(config[config_name])
    config[config_name].init_app(app)
    db.init_app(app)

    # 在工厂函数中注册蓝本 main
    app.register_blueprint(main_blueprint)
    return app
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建requirements.txt，程序中必须包含一个requirements.txt文件，用于记录所有的依赖包和其版本号，便于在其他电脑上创建相同的开发环境。直接在终端下使用如下命令创建requirements.txt文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;pip freeze &amp;gt; requirements.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以后安装了新的依赖包或者升级版本后，重新执行该命令即可更新requirements.txt文件。&lt;/p&gt;
&lt;p&gt;如果需要在另外一台电脑上创建这个虚拟环境的完全副本，运行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;pip install -r requirements.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建启动脚本 manage.py&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import os
from app import create_app, db
from flask_script import Manager, Shell
from flask_migrate import Migrate, MigrateCommand

app = create_app(os.getenv(&amp;#39;FLASK_CONFIG&amp;#39;) or &amp;#39;default&amp;#39;)
manager = Manager(app)
migrate = Migrate(app, db)


def make_shell_context():
    return dict(app=app, db=db)


manager.add_command(&amp;#34;shell&amp;#34;,Shell(make_context=make_shell_context))
manager.add_command(&amp;#39;db&amp;#39;, MigrateCommand)

if &lt;span class=&#34;gs&#34;&gt;__name__&lt;/span&gt; == &amp;#39;__main__&amp;#39;:
    manager.run()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这个脚本首先创建程序，然后增加了两个命令：shell和db，后续可以在命令行中直接使用。&lt;/p&gt;
&lt;p&gt;到目前为止，我们的flask程序目录结构如下：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/programming/python/flask/WechatIMG668.jpeg&#34; width=&#34;500px&#34; height=&#34;200px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;接下来，运行我们的程序，在命令行中进入E:\PycharmProject\xflask&amp;gt;目录，执行如下命令即可运行程序：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;python manage.py runserver
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;命令行运行截图如下：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/programming/python/flask/WechatIMG669.png&#34; width=&#34;500px&#34; height=&#34;200px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;Flask 默认的本机地址为：http://127.0.0.1:5000或者http://localhost:5000，可以在浏览器中访问，如下图所示，可以按“Ctrl + C”退出程序。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/programming/python/flask/WechatIMG670.png&#34; width=&#34;500px&#34; height=&#34;200px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;此时，默认只能本地访问网站，如果需要其他人也可以访问，需要指定0.0.0.0这个IP，就需要再加入参数，指定主机和端口，这样其他人访问时，只需要输入机器的IP地址，再加上端口就可以了。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;python manage.py runserver --host 0.0.0.0 --port 8080
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在终端中使用上述命令启动程序&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/programming/python/flask/WechatIMG671.png&#34; width=&#34;500px&#34; height=&#34;200px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;在浏览器中访问如下：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/programming/python/flask/WechatIMG672.png&#34; width=&#34;500px&#34; height=&#34;200px&#34; /&gt;
&lt;/center&gt;
&lt;h4 id=&#34;一个-flask-项目的标准结构&#34;&gt;一个 Flask 项目的标准结构&lt;/h4&gt;
&lt;p&gt;Flask 项目有四个顶级目录：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;app：Flask程序保存在此目录中。&lt;/li&gt;
&lt;li&gt;migrations：包含数据库迁移脚本。&lt;/li&gt;
&lt;li&gt;tests：单元测试放在此目录下。&lt;/li&gt;
&lt;li&gt;venv：Python虚拟环境。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;同时还有一些文件，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;requirements.txt：列出了所有的依赖包，以便于在其他机器环境中重新生成相同的环境。&lt;/li&gt;
&lt;li&gt;config.py：存储配置。&lt;/li&gt;
&lt;li&gt;manage.py：启动程序或者其他任务。&lt;/li&gt;
&lt;li&gt;gun.conf：Gunicorn配置文件。&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/flask/">Flask</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>nginx 常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/mixed/nginx/nginx-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/nginx/nginx-questions-and-solutions/</guid>
                <pubDate>Fri, 29 Dec 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 nginx 使用时常见的问题及解决方法。&lt;/p&gt;
&lt;p&gt;1、启动nginx时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc nginx]# ./sbin/nginx -s reopen
nginx: [error] invalid PID number &amp;#34;&amp;#34; in &amp;#34;/var/run/nginx.pid&amp;#34;
[root@xdhuxc nginx]# ./sbin/nginx -s reload
nginx: [error] invalid PID number &amp;#34;&amp;#34; in &amp;#34;/var/run/nginx.pid&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：
执行如下命令即可：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc nginx]# ./sbin/nginx -c conf/nginx.conf
[root@xdhuxc nginx]# ./sbin/nginx -s reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/nginx/">Nginx</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 中 Shell 脚本示例</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-shell-code-example/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-shell-code-example/</guid>
                <pubDate>Sun, 10 Dec 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了些 Linux Shell 脚本的典型示例代码，以备后查。&lt;/p&gt;
&lt;h3 id=&#34;读取输入&#34;&gt;读取输入&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
function set_kubernetes_prometheus() {
    while [ 0 ] ;
    do
        echo -n &amp;#34;请输入三个参数（以空格分隔开）:&amp;#34;
        stty erase ^H
        read P1 P2 P3
        if [ -n &amp;#34;${P1}&amp;#34; -a -n &amp;#34;${P2}&amp;#34; -a -n &amp;#34;${P3}&amp;#34; ] ; then
            break
        fi
    done

    echo &amp;#34;参数 1 为：${P1}&amp;#34;
    echo &amp;#34;参数 2 为：${P2}&amp;#34;
    echo &amp;#34;参数 3 为：${P3}&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;计算三个数中的最大数&#34;&gt;计算三个数中的最大数&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# author：xdhuxc
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# time：2017-07-19
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# description：计算三个数中的最大数
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
echo &amp;#34;Please enter three numbers:&amp;#34;
	# -p，允许在read命令行中直接指定一个提示。
	read -p &amp;#34;The first number is :&amp;#34; x
	read -p &amp;#34;The second number is :&amp;#34; y
	read -p &amp;#34;The third number is : &amp;#34; z
max = $x
if [ $y -ge $max ]; then
   max = $y
fi
if [ $z -ge $max ]; then
   max = $z
fi
echo &amp;#34;The maximum number is $max&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;计算100以内的偶数的和&#34;&gt;计算100以内的偶数的和&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# author: xdhuxc
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# time: 2017-07-19
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# description：计算100以内的偶数的和
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;sum = 0
for i in $(seq 1 100); do
	if [ $[$i % 2] -eq 0 ]; then
		let sum += $i
	fi
done
echo &amp;#34;The sum is $sum.&amp;#34;

sum = 0
for ((i=1; i&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;= 100; i++))
do
	if [ $[$i % 2] -eq 0 ]; then
		let sum += $i
	fi
done
echo &amp;#34;The sum is $sum.&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;在某个目录下的所有文件中查找关键字&#34;&gt;在某个目录下的所有文件中查找关键字&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# author: xdhuxc
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# time: 2017-12-04
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# description：在某个目录下的所有文件中查找关键字，输出匹配文件的全路径
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# parameter 1：根目录名
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# parameter 2：查找关键字
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;function traverse_dir(){
    local base_dir=$1
    local key=$2

    &lt;span class=&#34;ni&#34;&gt;#set&lt;/span&gt; -x
    for file in $base_dir/*
    do
        if [ -d $file ]; then
            traverse_dir $file $key
        else
            grep -w $key $file &amp;gt; /dev/null
            if [ $? -eq 0 ]; then
                    echo -e $file
            fi
        fi
    done
}

traverse_dir $1 $2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;加载-docker-镜像&#34;&gt;加载 docker 镜像&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# author: xdhuxc
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# time: 2017-12-04
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# description：加载当前目录下的tar格式镜像，更改镜像标签，再导出为tar格式镜像
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 加载当前目录下的镜像
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;for tar_image in ./*.tar
do
	if [ -f $tar_image ]; then
		docker load -i $tar_image
	fi
done

&lt;span class=&#34;gh&#34;&gt;# 更改镜像标签
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;docker images | awk &amp;#39;NR &amp;gt; 1 {print $1, $2}&amp;#39; | while read old_image_name tag
do
	&lt;span class=&#34;ni&#34;&gt;#new_image_name&lt;/span&gt;=${old_image_name//10.10.24.171/192.168.244.128}
	new_image_name=${old_image_name#*\/}
	# 修改镜像标签
	docker tag $old_image_name:$tag $new_image_name:$tag
	# 删除旧的标签
	docker rmi -f $old_image_name:$tag
        # 导出为tar格式镜像
	tar_name=${new_image_name##*\/}-${tag}.tar
	docker save $new_image_name:$tag -o $tar_name 
done
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;删除已经退出的docker镜像&#34;&gt;删除已经退出的docker镜像&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# author: xdhuxc
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# time: 2017-12-04
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# description：删除已经退出的docker镜像
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 删除已经退出的容器
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;docker ps -a | awk &amp;#39;NR &amp;gt; 1 {print $1}&amp;#39; | while read container_id
do
    status=$(docker inspect --format={{.State.Status}} $container_id)
	if [ &amp;#34;$status&amp;#34;x = &amp;#34;exited&amp;#34;x ]; then
		docker rm -f $container_id &amp;gt; /dev/null
	fi
done
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;删除所有镜像&#34;&gt;删除所有镜像&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/bin/bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 更改镜像标签 yonyoucloud-middleware/mesos-master 1.4.0 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;docker images | awk &amp;#39;NR &amp;gt; 1 {print $1, $2}&amp;#39; | while read old_image_name tag
do
	# 删除镜像
	docker rmi $old_image_name:$tag
done
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;替换某文件中的键值对&#34;&gt;替换某文件中的键值对&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 替换某文件中的键值对
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 参数1：带文件路径的文件名
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 参数2：键
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 参数3：值
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# jdbc.url=jdbc.mysql
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 描述：如果文件中没有该键，则添加该键值对；如果有，则更新键的值
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
function replace_text(){
    full_path_file=$1
    key=$2
    value=$3
    grep &amp;#34;${key}=&amp;#34; ${full_path_file} &amp;gt; /dev/null 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1
    if [ &amp;#34;$?&amp;#34; == &amp;#34;0&amp;#34; ] ; then
        # 获取 key-value所在的行

        echo &amp;#34;存在键${key}，其值为：${old_value}，替换其值为：${value}&amp;#34;
        &lt;span class=&#34;ni&#34;&gt;#sed&lt;/span&gt; &amp;#34;s/${key}=//g&amp;#34; ${full_path_file}
        sed &amp;#34;s/${key}=${old_value}/${key}=${value}/g&amp;#34; ${full_path_file}
    else
        echo &amp;#34;不存在键 ${key}，添加键值对：${key}=${value}&amp;#34;
        echo &amp;#34;${key}=${value}&amp;#34; &amp;gt;&amp;gt; ${full_path_file}
    fi
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;使用cat命令向文件中追加内容&#34;&gt;使用cat命令向文件中追加内容&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;两个EOF之间的内容左端顶格，因为其之间的内容会原样追加到文件中&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
cat &amp;gt;&amp;gt; /etc/profile &lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;EOF&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;RUN_AS_USER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;root&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;JAVA_HOME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;${nexus_shell_dir}/jdk1.7.0_80&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;PATH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;$JAVA_HOME/bin:$PATH&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;EOF&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;source&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;etc&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;profile&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;RUN_AS_USER&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;expect-的使用&#34;&gt;expect 的使用&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env bash
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 安装 expect
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;command -v expect &amp;gt; /dev/null 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1
if [ &amp;#34;$?&amp;#34; != &amp;#34;0&amp;#34; ] ; then
    echo -e &amp;#34;当前机器尚未安装 expect。&amp;#34;
    echo -e &amp;#34;使用 yum 安装 except...&amp;#34;
    yum install -y expect 
fi

if [ $(command -v expect) ] ; then
    # 生成 ssh key
    chmod +x ssh-keygen.exp 
    ./ssh-keygen.exp &amp;gt; /dev/null 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1

    # 复制 ssh key 到各机器
    cat hosts | while read line
    do
        echo -e &amp;#34;${line}&amp;#34; &amp;gt; ./host.tmp
        cat host.tmp | awk -F &amp;#39;[: ]&amp;#39; &amp;#39;{print $1, $2, $3, $4}&amp;#39; | while read target_host username password port
        do
        	echo -e ${target_host}
        	echo -e ${username}
        	echo -e ${password}
                echo -e ${port}
        	if [ -n ${target_host} -a -n ${username} -a -n ${password} ] ; then
            		./ssh-copy-id.exp ${target_host} ${username} ${password} ${port}
        	fi
	done
    done
fi 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;获取当前脚本的路径&#34;&gt;获取当前脚本的路径&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;current_path=$(cd &amp;#34;$(dirname &amp;#34;$0&amp;#34;)&amp;#34;; pwd)
full_path=$(realpath $0)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行结果为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;/xdhuxc/script/tools
/xdhuxc/script/tools/test.sh
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/shell/">Shell</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>正则表达式规则及常用正则表达式总结</title>
                <link>https://xdhuxc.github.io/posts/programming/common/regular-expression/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/common/regular-expression/</guid>
                <pubDate>Sat, 09 Dec 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了下正则表达式的常用规则，并收集些常用的正则表达式。&lt;/p&gt;
&lt;h3 id=&#34;特殊字符&#34;&gt;特殊字符&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;^：以某个字符串开头，^a，匹配以 a 开头的字符串，^abc，匹配以 abc 开头的字符串。&lt;/li&gt;
&lt;li&gt;*：表示 * 前面的一个字符可以重复任意多次。&lt;/li&gt;
&lt;li&gt;.：可以表示任意一个字符。&lt;/li&gt;
&lt;li&gt;$：以某个字符串结尾，a$，匹配以 a 结尾的字符串，abc$，匹配以 abc 结尾的字符串。&lt;/li&gt;
&lt;li&gt;?：使用非贪婪匹配模式，从左向右匹配字符串。&lt;/li&gt;
&lt;li&gt;+：表示 + 号前面的字符至少出现一次。&lt;/li&gt;
&lt;li&gt;{2}：表示前面的字符恰好出现两次。&lt;/li&gt;
&lt;li&gt;{2,}：表示前面的字符出现两次以上。&lt;/li&gt;
&lt;li&gt;{2,5}：表示前面的字符出现 2~5 次。&lt;/li&gt;
&lt;li&gt;|：表示多个匹配模式之间或的关系。&lt;/li&gt;
&lt;li&gt;[]：[abcd]，表示匹配一个字符，该字符为 a，b，c，d 中的一个。
[1~9]，表示匹配一个字符，该字符为 1~9 之中的一个。
[^1]，表示匹配一个字符，该字符不是 1。&lt;/li&gt;
&lt;li&gt;\s: 表示匹配一个空格。&lt;/li&gt;
&lt;li&gt;\S：表示匹配一个非空格。&lt;/li&gt;
&lt;li&gt;\w：表示匹配一个字符，模式等同于：[a~zA~Z0~9_]。&lt;/li&gt;
&lt;li&gt;\W：表示匹配一个字符，该字符不在模式 [a~zA~Z0~9_] 之中。&lt;/li&gt;
&lt;li&gt;[\u4E00-\u9FA5]：匹配一个汉字。&lt;/li&gt;
&lt;li&gt;\d：匹配数字&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;常用正则表达式&#34;&gt;常用正则表达式&lt;/h3&gt;
&lt;p&gt;1）邮箱&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）域名&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(/.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+/.?
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）IP&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4）电话号码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5）URL&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;=]*)?$
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>SVN 的安装，配置和使用</title>
                <link>https://xdhuxc.github.io/posts/tools/tools-svn/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/tools/tools-svn/</guid>
                <pubDate>Thu, 07 Dec 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了版本控制管理工具 SVN 的安装，配置和使用。&lt;/p&gt;
&lt;h3 id=&#34;svn-安装和配置&#34;&gt;SVN 安装和配置&lt;/h3&gt;
&lt;h4 id=&#34;安装-svn-服务器&#34;&gt;安装 &lt;code&gt;svn&lt;/code&gt; 服务器&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y subversion
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;查看版本&#34;&gt;查看版本&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;svnserve --version
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;输出如下：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG651.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;h4 id=&#34;创建版本库&#34;&gt;创建版本库&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /root/svn   &lt;span class=&#34;ni&#34;&gt;#创建svn仓库目录&lt;/span&gt;
svnadmin create /root/svn/xdhuxc  &lt;span class=&#34;ni&#34;&gt;#使用svn管理员创建xdhuxc库&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看库中的文件&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG652.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;出现上图中的文件，说明svn代码库已经创建成功。
Subversion目录说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;db：所有版本控制的数据存放文件&lt;/li&gt;
&lt;li&gt;hooks：放置hook脚本文件的目录&lt;/li&gt;
&lt;li&gt;locks：用来放置subversion建库锁定数据的目录，用来追踪存取文件库的客户端&lt;/li&gt;
&lt;li&gt;format：是一个文本文件，里面只放了一个整数，表示当前文件库配置的版本号&lt;/li&gt;
&lt;li&gt;conf：是这个仓库的配置文件（仓库的用户访问账号、权限等）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;进入conf目录，该目录存放当前svn版本库的配置文件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;authz：权限控制文件&lt;/li&gt;
&lt;li&gt;passwd：账号密码文件&lt;/li&gt;
&lt;li&gt;svnserve.conf：SVN服务配置文件&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;subversion-配置&#34;&gt;subversion 配置&lt;/h4&gt;
&lt;p&gt;1、设置账号密码&lt;/p&gt;
&lt;p&gt;修改 &lt;code&gt;conf/passwd&lt;/code&gt; 文件，在 &lt;code&gt;[users]&lt;/code&gt; 块中添加用户和密码，格式为：username=password&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG653.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;2、设置权限&lt;/p&gt;
&lt;p&gt;修改conf/authz文件，在末尾添加如下内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[/] &lt;span class=&#34;ni&#34;&gt;#指定svn仓库目录&lt;/span&gt;，[/]代表根目录
xdhuxc=rw  # 用户xdhuxc的权限，r：读；w：写
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG654.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;3、修改 &lt;code&gt;svnserve.conf&lt;/code&gt; 文件&lt;/p&gt;
&lt;p&gt;打开下面几个注释：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;anon-access = read # 匿名用户可读
auth-access = write # 授权用户可写
password-db = passwd # 使用哪个文件作为账号文件
authz-db = authz # 使用哪个文件作为权限文件
realm = /root/svn/xdhuxc # 认证空间名，版本库所在目录
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意，红色箭头指向的参数，全部要定格写，即前面不能有空格&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG655.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;h4 id=&#34;启动-svn-版本库&#34;&gt;启动 svn 版本库&lt;/h4&gt;
&lt;p&gt;启动 &lt;code&gt;svn&lt;/code&gt; 版本库，并查看 &lt;code&gt;svn&lt;/code&gt; 服务是否开启，默认监听在 &lt;code&gt;3690&lt;/code&gt; 端口&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;svnserve -d -r /root/svn/xdhuxc
ps -ef|grep svn
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-d：表示后台运行svn服务&lt;/li&gt;
&lt;li&gt;-r：指定svn目录&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;停止-svn-命令&#34;&gt;停止 svn 命令&lt;/h4&gt;
&lt;p&gt;使用如下命令停止 svn 服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;killall svnserve
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;svn-使用&#34;&gt;svn 使用&lt;/h3&gt;
&lt;p&gt;1、下载并安装 &lt;code&gt;TorwoiseSVN&lt;/code&gt; 测试&lt;/p&gt;
&lt;p&gt;2、创建空目录 &lt;code&gt;xdhuxc-svn&lt;/code&gt;，右键并选择 &lt;code&gt;SVN Checkout&lt;/code&gt;，&lt;code&gt;checkout&lt;/code&gt; 就是把 &lt;code&gt;SVN&lt;/code&gt; 服务器上的文件下载到本地工作目录内的操作，输入 &lt;code&gt;SVN&lt;/code&gt; 服务器地址，导出文件存放目录 &lt;code&gt;xdhuxc-svn&lt;/code&gt;，点击 &lt;code&gt;OK&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG656.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;第一次登陆时，需要输入认证信息 &lt;code&gt;xdhuxc/Xdhuxc1994&lt;/code&gt;，点击 &lt;code&gt;OK&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG657.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;如果不是空目录，就会出现下图的提示框，选择 &lt;code&gt;Checkout&lt;/code&gt;&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG658.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;登录成功后便可以在该工作目录里进行编辑或创建文件，操作完成后对该目录右键，选择 &lt;code&gt;Check commit&lt;/code&gt; 提交，这个操作等于是上传到 &lt;code&gt;SVN&lt;/code&gt; 服务器&lt;/p&gt;
&lt;p&gt;3、添加新文件&lt;/p&gt;
&lt;p&gt;将文件拖放至xdhuxc-svn目录下，右键，选择“TortoiseSVN”，选择“Repo browser”，右键点击“svn://192.168.91.128”，点击“Add file”&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG659.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
选择要添加的文件 `abc.txt`，点击 `打开`
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG660.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
输入提交信息，点击 `OK`
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG661.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
可到 `linux` 服务器下验证提交结果。
&lt;h3 id=&#34;svn-命令行&#34;&gt;SVN 命令行&lt;/h3&gt;
&lt;p&gt;1、使用Linux的SVN命令进行checkout操作&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;svn checkout svn://192.168.91.128 /svndir
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;第一次使用checkout命令时，需要输入用户名和密码，以后就不用输入用户名和密码了
/svndir为svn仓库文件保存目录
checkout下来的文件夹放到本地就叫做working copy，里面带着.svn目录，该目录是本地文件与svn服务器的连接文件，在这个目录里才能进行svn操作。svn添加文件，要先把要添加的文件放到working copy相应的目录下，执行add，再commit即可。&lt;/p&gt;
&lt;p&gt;2、创建一个文件并添加至SVN&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cd /svndir
touch xyz.txt ; echo &amp;#34;XYZ&amp;#34; &amp;gt;&amp;gt; xyz.txt ; cat xyz.txt
svn add xyz.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG662.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;3、提交该文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;svn commit -m &amp;#34;XYZ commit&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG663.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;4、更新本地仓库文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;svn up
或
svn update
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如下图所示：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG664.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;h3 id=&#34;常见问题及解决&#34;&gt;常见问题及解决&lt;/h3&gt;
&lt;p&gt;1、点击 &lt;code&gt;Checkout&lt;/code&gt; 后，报错如下：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/tools/svn/WechatIMG665.jpeg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;原因：&lt;code&gt;CentOS 7&lt;/code&gt; 默认不对外开放 &lt;code&gt;3690&lt;/code&gt; 端口，因此，开放防火墙 &lt;code&gt;3690&lt;/code&gt; 端口，重启防火墙即可&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -I INPUT -p tcp --dport 3690 -j ACCEPT
systemctl restart iptables
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/svn/">SVN</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Windows 常用命令总结</title>
                <link>https://xdhuxc.github.io/posts/mixed/windows-command-line/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/windows-command-line/</guid>
                <pubDate>Wed, 22 Nov 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了些 &lt;code&gt;Windows&lt;/code&gt; 系统中常用的命令，在 &lt;code&gt;Windows&lt;/code&gt; 系统中进行命令行操作时，会用到。&lt;/p&gt;
&lt;p&gt;1、查看系统 &lt;code&gt;BIOS&lt;/code&gt; 创建时间：&lt;code&gt;WMIC BIOS get releasedate&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ WMIC BIOS get releasedate
ReleaseDate
20140210000000.000000+000
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、调出Windows服务窗口：&lt;code&gt;services.msc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;3、使用Windows自带的计算器：&lt;code&gt;calc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;4、Windows自带的远程桌面连接命令：&lt;code&gt;mstsc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;5、查看本机IP地址和MAC地址：&lt;code&gt;ipconfig /all&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;6、查看当前正在运行的进程：&lt;code&gt;tasklist&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;7、强制杀死进程ID为process_id的进程：&lt;code&gt;taskkill /pid process_id -f&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;8、命令行启动或停止服务：&lt;code&gt;net start/stop service_name&lt;/code&gt;
例如，启动 &lt;code&gt;MySQL&lt;/code&gt; 服务，使用命令为：&lt;code&gt;net start mysql57&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;9、查看端口占用：&lt;code&gt;netstat -ano|findstr &amp;quot;8080&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ netstat -ano|findstr &amp;#34;8080&amp;#34;
  TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING       8552
  TCP    10.4.100.48:49235      192.168.8.81:8080      CLOSE_WAIT      1584
  TCP    10.4.100.48:49653      10.10.24.177:8080      ESTABLISHED     7428
  TCP    10.4.100.48:49655      10.10.24.177:8080      ESTABLISHED     7428
  TCP    10.4.100.48:49657      10.10.24.177:8080      ESTABLISHED     7428
  TCP    [::]:8080              [::]:0                 LISTENING       8552
  TCP    [::1]:51102            [::1]:8080             TIME_WAIT       0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;10、查找某个进程：&lt;code&gt;tasklist|findstr &amp;quot;bash.exe&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ tasklist|findstr &amp;#34;bash&amp;#34;
git-bash.exe                  9820 Console                    1      2,912 K
bash.exe                     10064 Console                    1      8,784 K
bash.exe                      7736 Console                    1      6,100 K
bash.exe                      9400 Console                    1      6,068 K
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;11、查看Windows版本和激活的过期时间&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;slmgr.vbs -xpr
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;12、下载文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;start powershell
$client = new-object System.Net.WebClient
$client.DownloadFile(&amp;#39;http://101.36.79.71:8081/IXC3470347d25cba57732165d795bb3beb6/sw-search-sp/software/1334d9c2b2fb7/ChromeStandalone_66.0.3359.139_Setup.exe&amp;#39;, &amp;#39;C:\Users\wanghuan\Desktop\ChromeStandalone_66.0.3359.139_Setup.exe&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;13、删除命令&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;del /S abc：递归地删除文件夹 abc 及其之下的文件，但是删除每个文件时均需要确认。&lt;/li&gt;
&lt;li&gt;del abc.txt：删除文件 abc.txt。&lt;/li&gt;
&lt;li&gt;del /Q：删除文件时采用安静模式。删除全局通配符时，不要求确认。&lt;/li&gt;
&lt;li&gt;rd abc：删除空文件夹 abc&lt;/li&gt;
&lt;li&gt;rd /s abc：删除文件夹 abc 及其所有子文件夹和文件&lt;/li&gt;
&lt;li&gt;rd /s/q abc：强制删除文件夹及所有子文件夹和文件，不需要确认。&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/windows/">Windows</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 下 iptables 常用命令</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-firewall/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-firewall/</guid>
                <pubDate>Tue, 07 Nov 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了 iptables 常用命令，对于运维人员，会经常需要用到。&lt;/p&gt;
&lt;h3 id=&#34;linux-防火墙简介&#34;&gt;Linux 防火墙简介&lt;/h3&gt;
&lt;p&gt;防火墙是用于实现 &lt;code&gt;Linux&lt;/code&gt; 下访问控制功能的，分为硬件防火墙或者软件防火墙两种。任何一个网络中，防火墙工作的地方一定是在网络的边缘。&lt;/p&gt;
&lt;p&gt;我们的任务就是去定义防火墙如何去工作，这就是防火墙的策略、规则，以达到让它对出入网络的IP、数据进行检测。&lt;/p&gt;
&lt;p&gt;目前市面上比较常见的有三层、四层的防火墙，叫做&lt;code&gt;网络层防火墙&lt;/code&gt;；还有七层的防火墙，其实就是&lt;code&gt;代理层的网关&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;对于 TCP/IP 的七层模型来说，&lt;code&gt;第三层是网络层&lt;/code&gt;，三层的防火墙会在这层&lt;code&gt;对源地址和目标地址&lt;/code&gt;进行检测。而对于&lt;code&gt;七层的防火墙&lt;/code&gt;，不论&lt;code&gt;源端口或者目的端口，源地址或者目的地址&lt;/code&gt;是什么，都将对&lt;code&gt;所有的东西进行检查&lt;/code&gt;。所以，从设计原理上来讲，七层防火墙更加安全，但是却带来了低效率。所以，市面上通常用的防火墙方案，都是两者结合的。又由于我们需要从防火墙所控制的这个口来访问，所以防火墙的工作效率就成了用户能够访问数据多少的一个最重要的控制，配置不好甚至有可能成为流量的瓶颈。&lt;/p&gt;
&lt;h3 id=&#34;iptables&#34;&gt;iptables&lt;/h3&gt;
&lt;p&gt;iptables 是 &lt;code&gt;unix/linux&lt;/code&gt; 自带的基于包过滤的防火墙工具，可以对流入和流出服务器的数据包进行很精细的控制。iptables 主要工作在 OSI 中的二、三、四层。&lt;/p&gt;
&lt;h4 id=&#34;iptables-术语&#34;&gt;iptables 术语&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;容器：用来形容包含或者所属的关系。&lt;code&gt;Netfilter/iptables&lt;/code&gt; 是表的容器，&lt;code&gt;iptables&lt;/code&gt; 包含着各个表；而 &lt;code&gt;iptables&lt;/code&gt; 的表又是链的容器。&lt;/li&gt;
&lt;li&gt;链（chains）：&lt;code&gt;INPUT&lt;/code&gt;、&lt;code&gt;OUTPUT&lt;/code&gt;、&lt;code&gt;FORWARD&lt;/code&gt;、&lt;code&gt;PREROUTING&lt;/code&gt;、&lt;code&gt;POSTRROUTING&lt;/code&gt;，链是规则的容器。&lt;/li&gt;
&lt;li&gt;规则（Policy）：一条条过滤的语句规则。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;filter-表&#34;&gt;filter 表&lt;/h4&gt;
&lt;p&gt;主要和主机自身有关，真正负责主机防火墙功能，过滤流入流出主机的数据包。filter表是iptables默认使用的表。这个表定义了三个链（Chains）：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;INPUT：负责过滤所有目标地址是主机地址的数据包，即，过滤进入主机的数据包。&lt;/li&gt;
&lt;li&gt;FORWARD：负责转发流经主机的数据包，起转发的作用，和Nat关系很大。LVS NAT 模式，net.ipv4_forward = 1。&lt;/li&gt;
&lt;li&gt;OUTPUT：处理所有源地址是本机地址的数据包，即，处理从主机发出去的数据包。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;nat-表&#34;&gt;nat 表&lt;/h4&gt;
&lt;p&gt;nat表负责网络地址转换，即来源与目的IP地址和端口的转换。一般用于局域网共享上网或者特殊的端口转换服务相关。&lt;/p&gt;
&lt;p&gt;这个表定义了三个链（Chain），nat功能就相当于网络的ACL控制，和网络交换机ACL类似。（访问控制列表（Access Control List，ACL），是路由器和交换机接口的指令列表，用来控制端口进出的数据包）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OUTPUT：和主机发出去的数据包有关，改变主机发出数据包的目标地址。&lt;/li&gt;
&lt;li&gt;PREROUTING：在数据包到达防火墙时进行路由判断之前执行的规则，作用是改变数据包的目的地址、目的端口等。&lt;/li&gt;
&lt;li&gt;POSTROUTING：在数据包离开防火墙时进行路由判断之后执行的规则，作用是改变数据包的源地址、源端口等。例如，我们的虚拟机都是192.168.30.0/16，就是出网的时候被我们的企业路由器把源地址改成了公网地址了。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;iptables命令选项输入顺序：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -t 表名 &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;-A&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;I&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 规则链名 [规则号] &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;-i&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;o&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;网卡名&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; -p 协议名 &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;-s&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;源IP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;源子网&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; --sport 源端口 &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;-d&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;目标IP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;目标子网&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; --dport 目标端口 -j 动作
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;选项如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-A：向规则链中添加条目。&lt;/li&gt;
&lt;li&gt;-D：从规则链中删除条目。&lt;/li&gt;
&lt;li&gt;-i：向规则链中插入条目。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;表名包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;raw：高级功能，如、网址过滤。&lt;/li&gt;
&lt;li&gt;mangle：数据包修改，用于实现服务质量。&lt;/li&gt;
&lt;li&gt;net：网络地址转换，用于网关路由器。&lt;/li&gt;
&lt;li&gt;filter：包过滤，用于防火墙规则。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;规则链名包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;INPUT：处理输入数据包。&lt;/li&gt;
&lt;li&gt;OUTPUT：处理输出数据包。&lt;/li&gt;
&lt;li&gt;FORWARD：处理转发数据包。&lt;/li&gt;
&lt;li&gt;PREROUTING：用于目标地址转换（DNAT）&lt;/li&gt;
&lt;li&gt;POSTROUTING：用于源地址转换（SNAT）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;动作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ACCEPT：接收数据包。&lt;/li&gt;
&lt;li&gt;DROP：丢弃数据包。&lt;/li&gt;
&lt;li&gt;REDIRECT：重定向、映射、透明代理。&lt;/li&gt;
&lt;li&gt;SNAT：源地址转换。&lt;/li&gt;
&lt;li&gt;DNAT：目标地址转换。&lt;/li&gt;
&lt;li&gt;LOG：日志记录。&lt;/li&gt;
&lt;li&gt;MASQUERADE：IP伪装（NAT），用于ADSL。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;常用命令&#34;&gt;常用命令&lt;/h4&gt;
&lt;p&gt;1、清理已有 iptables 规则&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -F
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、开放指定的端口&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -A OUTPUT -j ACCEPT                                                     # 允许所有本机向外的访问。
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT                 # 允许已建立的或相关联的通行。
iptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT        # 允许访问本机22端口
iptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 7000:8000 -j ACCEPT # 开放 7000-8000 之间的所有端口
iptables -A INPUT -p tcp -m state --state NEW -m tcp --dport :7000 -j ACCEPT     # 开放 7000 及其以下的所有端口
iptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 8000: -j ACCEPT     # 开放 8000 及其以上的所有端口
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、屏蔽 IP&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -I INPUT -s 123.45.6.7 -j DROP    # 屏蔽单个IP的命令
iptables -I INPUT -s 123.0.0.0/8 -j DROP   # 屏蔽整个123.0.0.0/8网段的所有数据包，即从123.0.0.1到123.255.255.254的IP全部封杀掉。
iptables —I INPUT -s 124.45.0.0/16 -j DROP # 屏蔽整个124.45.0.0/16网段的所有数据包，即从123.45.0.1到123.45.255.254的IP全部封杀掉。
iptables -I INPUT -s 123.45.6.0/24 -j DROP # 屏蔽整个123.45.6.0/24网段的所有数据包，即从123.45.6.1到123.45.6.254的所有数据包，
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、开启防火墙22端口&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;iptables -I INPUT -p tcp --dport 22 -j accept
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、查看防火墙状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo systemctl status firewalld.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、停止防火墙&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo systemctl stop firewalld.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、停止开机自动启动&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo systemctl disable firewalld.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;docker-bridge-网络模式防火墙配置&#34;&gt;docker bridge 网络模式防火墙配置&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;以bridge网络模式运行Docker容器需要的防火墙配置&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;*nat
:PREROUTING ACCEPT [27:11935]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [598:57368]
:POSTROUTING ACCEPT [591:57092]
:DOCKER - [0:0]
-A PREROUTING -m addrtype --dst-type LOCAL -j DOCKER
-A OUTPUT ! -d 127.0.0.0/8 -m addrtype --dst-type LOCAL -j DOCKER
-A POSTROUTING -s 172.17.0.0/16 ! -o docker0 -j MASQUERADE &lt;span class=&#34;ni&#34;&gt;#docker网桥的子网&lt;/span&gt;
-A POSTROUTING -j MASQUERADE
COMMIT
&lt;span class=&#34;gh&#34;&gt;# Completed on Sun Sep 20 17:35:31 2015
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# Generated by iptables-save v1.4.21 on Sun Sep 20 17:35:31 2015
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;*filter
:INPUT ACCEPT [139291:461018923]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [127386:5251162]
:DOCKER - [0:0]
-A FORWARD -o docker0 -j DOCKER
-A FORWARD -o docker0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -i docker0 ! -o docker0 -j ACCEPT
-A FORWARD -i docker0 -o docker0 -j ACCEPT
COMMIT
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://man.linuxde.net/iptables&#34;&gt;http://man.linuxde.net/iptables&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/iptables/">iptables</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>安装 nginx</title>
                <link>https://xdhuxc.github.io/posts/mixed/nginx/nginx-install/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/nginx/nginx-install/</guid>
                <pubDate>Thu, 26 Oct 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了基于源代码和 docker 容器方式部署 nginx 的方法。&lt;/p&gt;
&lt;h3 id=&#34;基于源码安装-nginx&#34;&gt;基于源码安装 nginx&lt;/h3&gt;
&lt;p&gt;1、下载 nginx安装包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt; wget http://nginx.org/download/nginx-1.15.2.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、安装如下软件包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum -y install pcre pcre-devel openssl openssl-devel
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、编译并安装nginx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./configure &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; make &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; make install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、检测nginx是否安装成功&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;whereis nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;基于-docker-容器部署-nginx&#34;&gt;基于 docker 容器部署 nginx&lt;/h3&gt;
&lt;h4 id=&#34;最简单的使用方法&#34;&gt;最简单的使用方法&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -it -p 80:80 --name nginx nginx:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在浏览器地址栏中输入：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;192.168.91.128:80
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;即可访问 nginx 欢迎页面&lt;/p&gt;
&lt;h4 id=&#34;在后台运行-nginx-容器&#34;&gt;在后台运行 nginx 容器&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d -p 80:80 --name nginx nginx:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果不加端口映射，能启动容器，但是在终端和浏览器中无法访问，可能是没有默认配置或者默认配置没起作用。&lt;/p&gt;
&lt;h4 id=&#34;使用自定义配置文件启动-nginx-容器&#34;&gt;使用自定义配置文件启动 nginx 容器&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileded=true \
    -p 80:80
    -v /home/xdhuxc/nginx/logs:/var/log/nginx
    -v /home/xdhuxc/nginx/nginx.conf:/etc/nginx/nginx.conf:rw
    --name nginx
    nginx:latest
    
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;/etc/nginx/nginx.conf 为容器内 nginx 的配置文件，ro 是 readonly 的意思&lt;/p&gt;
&lt;h3 id=&#34;nginx-常用命令&#34;&gt;nginx 常用命令&lt;/h3&gt;
&lt;p&gt;1、检测nginx配置文件 nginx.conf 格式是否正确&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nginx -t
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、重新加载 nginx 配置文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nginx -s reload
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、重启 nginx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nginx -s reopen
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、停止 nginx&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nginx -s stop
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;Nginx中文文档 &lt;a href=&#34;http://www.nginx.cn/doc/&#34;&gt;http://www.nginx.cn/doc/&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/nginx/">Nginx</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 中常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-questions-and-solution/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-questions-and-solution/</guid>
                <pubDate>Sun, 22 Oct 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在 Linux 系统中常见的问题及解决方法，以备后查。&lt;/p&gt;
&lt;p&gt;1、从 Mac 的终端中 scp VirtualBox 虚拟机中的文件时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wanghuans-MacBook-Pro:clickhouse_exporter wanghuan$ scp root@192.168.33.10:/vagrant/clickhouse_exporter ./
root@192.168.33.10: Permission denied (publickey,gssapi-keyex,gssapi-with-mic).
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：在虚拟机内部，修改 /etc/ssh/sshd_config 文件中如下参数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;PermitRootLogin yes
PasswordAuthentication yes
PubkeyAuthentication yes
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后重启虚拟机内 sshd 服务。&lt;/p&gt;
&lt;p&gt;2、wget: unable to resolve host address
问题：DNS解析的问题
将以下内容加入&lt;code&gt;/etc/resolv.conf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;nameserver 8.8.8.8 &lt;span class=&#34;ni&#34;&gt;#google域名服务器&lt;/span&gt;
nameserver 8.8.4.4 &lt;span class=&#34;ni&#34;&gt;#google域名服务器&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、使用 &lt;code&gt;Linux&lt;/code&gt; 服务启动 &lt;code&gt;confd&lt;/code&gt; 进程，启动时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Mar 18 02:26:38 ip-172-27-124-70.ap-southeast-1.compute.internal confd[28240]: 2019-03-18T02:26:38Z ip-172-27-124-70.ap-southeast-1.compute.internal /usr/bin/confd[28240]: FATAL UserHomeNotFound: user home directory not found.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：
在 &lt;code&gt;confd.service&lt;/code&gt; （&lt;code&gt;/usr/lib/systemd/system/confd.service&lt;/code&gt;）中加入如下环境变量&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Service]
Environment=&amp;#34;HOME=/root&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 &lt;code&gt;confd&lt;/code&gt; 服务即可。&lt;/p&gt;
&lt;p&gt;4、在 &lt;code&gt;Linux&lt;/code&gt; 下执行脚本，报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# ./install.sh -h
-bash: ./install.sh: /bin/bash^M: bad interpreter: No such file or directory
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：安装dos2unix，将DOS格式文本文件转换成Unix格式，使用如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y dos2unix
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用方法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;dos2unix filename_1 filename_2 filename_3
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、使用curl命令从网络上下载文件时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl -L https://github.com/docker/compose/releases/download/1.21.2/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:--  0:00:05 --:--:--     0
curl: (35) Peer reports incompatible or unsupported protocol version.
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;（1）更新curl&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum update -y curl
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;更新curl后还是报一样的错误&lt;/p&gt;
&lt;p&gt;（2）更新nss nspr&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum update -y nss nspr nss-util
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;更新后问题得到解决。&lt;/p&gt;
&lt;p&gt;仅更新（1）和仅更新（2）都不起作用&lt;/p&gt;
&lt;p&gt;6、&lt;code&gt;CentOS 7&lt;/code&gt; 虚拟机有网卡，没有 &lt;code&gt;IP&lt;/code&gt; 地址，进入 &lt;code&gt;/etc/sysconfig/network-scripts&lt;/code&gt; 目录下，修改 &lt;code&gt;ifcfg-eth0&lt;/code&gt; 文件&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/linux/questions-and-solutions/WechatIMG622.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;将其中的 &lt;code&gt;ONBOOT&lt;/code&gt; 修改为 &lt;code&gt;yes&lt;/code&gt;，然后使用 &lt;code&gt;systemctl restart network&lt;/code&gt; 命令重启网络&lt;/p&gt;
&lt;p&gt;注意：启动 &lt;code&gt;Windows&lt;/code&gt; 下 &lt;code&gt;VMware&lt;/code&gt; 相关的服务&lt;/p&gt;
&lt;p&gt;7、使用SSH无法登陆服务器，VNC操作命令提示“fork:cannot allocate memory”，或者，在已经登录至该服务器上的终端中执行命令，所有命令均无法执行，一直提示如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# free -h
bash: fork: Cannot allocate memory
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看最大进程数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost /]# sysctl kernel.pid_max
kernel.pid_max = 32768
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看进程数&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# ps -eLf | wc -l
1011
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;1）修改最大进程数，即时生效&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo 1000000 &amp;gt; /proc/sys/kernel/pid_max
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）永久生效的方式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo &amp;#34;kernel.pid_max=1000000 &amp;#34; &amp;gt;&amp;gt; /etc/sysctl.conf
sysctl -p
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>基于 docker 容器部署 Nexus</title>
                <link>https://xdhuxc.github.io/posts/mixed/nexus/nexus-docker/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/nexus/nexus-docker/</guid>
                <pubDate>Sun, 22 Oct 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了使用 docker 容器部署 nexus 的方法。&lt;/p&gt;
&lt;h3 id=&#34;nexus-2&#34;&gt;Nexus 2&lt;/h3&gt;
&lt;p&gt;1、拉取Nexus镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull sonatype/nexus:2.14.5
或
docker pull sonatype/nexus:oss
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动Nexus&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d -p 8081:8081 --name nexus sonatype/nexus:2.14.5
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、持久化数据时容器启动方式&lt;/p&gt;
&lt;p&gt;创建数据目录并更改该目录的所有者，原因见其Dockerfile&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /home/xdhuxc/nexus/data &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; chown -R 200 /home/xdhuxc/nexus/data 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -p 8081:8081 \
    -v /home/xdhuxc/nexus/data:/sonatype-work \
    --name nexus \
    sonatype/nexus:2.14.5
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;配置文件目录：&lt;code&gt;/sonatype-work/conf/nexus.xml&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;测试Nexus是否可访问&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl -u admin:admin123 http://localhost:8081/service/metrics/ping
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、目前，还没有找到方法将配置好的nexus.xml固化到nexus镜像中，采取的方式是：先挂载数据目录启动nexus容器，然后替换本地/home/xdhuxc/nexus/data/conf/nexus.xml文件，重启nexus容器。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -p 8081:8081 \
    -v /data/nexus/data:/sonatype-work \
    --name nexus \
    sonatype/nexus:2.14.5
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;相关问题&#34;&gt;相关问题&lt;/h3&gt;
&lt;p&gt;1、启动nexus容器时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;2018-01-04 06:07:57,156+0000 WARN  [jetty-main-1]  org.sonatype.nexus.util.LockFile - Failed to write lock file
java.io.FileNotFoundException: /sonatype-work/nexus.lock (Permission denied)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：根据 dockerhub 的步骤，更改数据目录的所有者，原因见Dockerfile。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir /data/nexus/data &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; chown -R 200 /data/nexus/data
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重新启动容器即可。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/nexus/">Nexus</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker 常用参数配置</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-configuration-parameter/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-configuration-parameter/</guid>
                <pubDate>Thu, 19 Oct 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客整理了一些使用 docker 的过程中经常使用的参数的配置，对于 docker 进阶使用会非常有帮助。&lt;/p&gt;
&lt;h3 id=&#34;配置文件&#34;&gt;配置文件&lt;/h3&gt;
&lt;h4 id=&#34;dockerservice&#34;&gt;docker.service&lt;/h4&gt;
&lt;p&gt;1、&lt;code&gt;docker.service&lt;/code&gt; 文件路径&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;/usr/lib/systemd/system/docker.service
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、&lt;code&gt;docker.service&lt;/code&gt; 文件内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Unit]
Description=Docker Application Container Engine
Documentation=http://docs.docker.com
After=network.target
Wants=docker-storage-setup.service
Requires=docker-cleanup.timer

[Service]
Type=notify
NotifyAccess=all
EnvironmentFile=-/run/containers/registries.conf
EnvironmentFile=-/etc/sysconfig/docker
EnvironmentFile=-/etc/sysconfig/docker-storage
EnvironmentFile=-/etc/sysconfig/docker-network
Environment=GOTRACEBACK=crash
Environment=DOCKER_HTTP_HOST_COMPAT=1
Environment=PATH=/usr/libexec/docker:/usr/bin:/usr/sbin
ExecStart=/usr/bin/dockerd-current \
          --add-runtime docker-runc=/usr/libexec/docker/docker-runc-current \
          --default-runtime=docker-runc \
          --exec-opt native.cgroupdriver=systemd \
          --userland-proxy-path=/usr/libexec/docker/docker-proxy-current \
          $OPTIONS \
          $DOCKER_STORAGE_OPTIONS \
          $DOCKER_NETWORK_OPTIONS \
          $ADD_REGISTRY \
          $BLOCK_REGISTRY \
          $INSECURE_REGISTRY\
      $REGISTRIES
ExecReload=/bin/kill -s HUP $MAINPID
LimitNOFILE=1048576
LimitNPROC=1048576
LimitCORE=infinity
TimeoutStartSec=0
Restart=on-abnormal
MountFlags=slave
KillMode=process

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、启动 docker 时各参数的含义&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;参数&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;-g，--graph=“/var/lib/docker”&lt;/td&gt;
&lt;td&gt;设置docker的运行时根目录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-s，--storage-driver=“devicemapper”&lt;/td&gt;
&lt;td&gt;设置容器运行时使用指定的存储驱动为devicemapper&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;--insecure-registry 0.0.0.0/0&lt;/td&gt;
&lt;td&gt;允许不安全的仓库连接&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;--registry-mirror xdhuxc.docker.com&lt;/td&gt;
&lt;td&gt;配置镜像加速地址&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;4、docker 的日志文件写入写入到 &lt;code&gt;/var/log/message&lt;/code&gt; 文件中，查看的命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tail -f /var/log/message | grep docker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;journalctl -fu docker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、Docker默认空间大小分为两个，一个是池空间大小，默认为100G；另一个是容器空间大小，默认为10G。&lt;/p&gt;
&lt;h3 id=&#34;常用配置&#34;&gt;常用配置&lt;/h3&gt;
&lt;h4 id=&#34;限制日志文件大小和保留文件个数&#34;&gt;限制日志文件大小和保留文件个数&lt;/h4&gt;
&lt;p&gt;在 &lt;code&gt;docker run&lt;/code&gt; 命令中增加如下参数，限制生成的 &lt;code&gt;json.log&lt;/code&gt; 单个文件大小和保留文件个数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -it --log-opt max-size=100m --log-opt max-file=3 nginx:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;docker-compose.yml&lt;/code&gt; 文件中的书写格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;log_opt:
    max-size: &amp;#39;100M&amp;#39;
    max-file: &amp;#39;3&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当生成 &lt;code&gt;3&lt;/code&gt; 个文件，每个文件达到 &lt;code&gt;100M&lt;/code&gt; 时，会循环写入新的日志。&lt;/p&gt;
&lt;h4 id=&#34;指定-cgroup-driver-的类型&#34;&gt;指定 Cgroup Driver 的类型&lt;/h4&gt;
&lt;p&gt;在 &lt;code&gt;/usr/lib/system/system/docker.service&lt;/code&gt; 中给 &lt;code&gt;docker&lt;/code&gt; 进程启动命令中增加如下参数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;--exec-opt native.cgroupdriver=systemd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>配置 SSH 免密登录</title>
                <link>https://xdhuxc.github.io/posts/common/ssh-no-password-login/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/common/ssh-no-password-login/</guid>
                <pubDate>Tue, 17 Oct 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了配置多台机器 SSH 免密登录的详细过程，在管理多台服务器时会很有用。&lt;/p&gt;
&lt;h3 id=&#34;配置-ssh-免密登录&#34;&gt;配置 SSH 免密登录&lt;/h3&gt;
&lt;p&gt;现有三台虚拟机，分别为：centos_3(192.168.244.129)，centos_4(192.168.244.135)，centos_6(192.168.244.136)&lt;/p&gt;
&lt;p&gt;1、分别在三台虚拟机的 &lt;code&gt;/etc/hosts&lt;/code&gt; 文件中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;192.168.244.129 centos_3
192.168.244.135 centos_4
192.168.244.136 centos_6
192.168.244.129 zk_master
192.168.244.135 zk_slave1
192.168.244.136 zk_slave2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在三台机器上分别安装 &lt;code&gt;openssh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;查看机器上是否安装了&lt;code&gt;ssh&lt;/code&gt;，使用命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rpm -qa|grep openssh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果没有安装，则安装openssh&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y openssh-server
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、在 &lt;code&gt;zk_master&lt;/code&gt; 上生成密钥对&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ssh-keygen -t rsa
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;连续回车会在当前用户的目录下，即 &lt;code&gt;/root/.ssh&lt;/code&gt;，生成隐藏目录 &lt;code&gt;.ssh&lt;/code&gt;，该目录下有私钥文件 &lt;code&gt;id_rsa&lt;/code&gt;，公钥文件 &lt;code&gt;id_rsa.pub&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;4、把 &lt;code&gt;zk_master&lt;/code&gt; 的公钥追加到 &lt;code&gt;authorized_keys&lt;/code&gt; 文件里&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cat /root/.ssh/id_rsa.pub &amp;gt;&amp;gt; /root/.ssh/authorized_keys
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、分别在 &lt;code&gt;zk_slave1&lt;/code&gt;，&lt;code&gt;zk_slave2&lt;/code&gt; 机器上按照上述步骤安装 &lt;code&gt;openssh&lt;/code&gt;，生成密钥对。&lt;/p&gt;
&lt;p&gt;6、使用 &lt;code&gt;root&lt;/code&gt; 用户登陆 &lt;code&gt;zk_slave1&lt;/code&gt;，把 &lt;code&gt;zk_slave1&lt;/code&gt; 的公钥远程复制到 &lt;code&gt;zk_master&lt;/code&gt; 机器上,然后追加到 &lt;code&gt;zk_master&lt;/code&gt; 机器上的 &lt;code&gt;authorized_keys&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# copy到zk_master的root目录下，输入zk_master的密码
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;scp /root/.ssh/id_rsa.pub root@192.168.244.135:/root/
&lt;span class=&#34;gh&#34;&gt;# 登陆zk_master之后追加到授权文件里
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cat /root/id_rsa.pub &amp;gt;&amp;gt; /root/.ssh/authorized_keys
&lt;span class=&#34;gh&#34;&gt;# 删除远程传过来的zk_slave1公钥
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;rm -f /root/id_rsa.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、使用 &lt;code&gt;root&lt;/code&gt; 用户登陆 &lt;code&gt;zk_slave2&lt;/code&gt;，把 &lt;code&gt;zk_slave2&lt;/code&gt; 的公钥远程复制到 &lt;code&gt;zk_master&lt;/code&gt; 机器上,然后追加到 &lt;code&gt;zk_master&lt;/code&gt; 机器上的 &lt;code&gt;authorized_keys&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# 复制到zk_master的root目录下，输入zk_master的密码
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;scp /root/.ssh/id_rsa.pub root@192.168.244.136:/root/
&lt;span class=&#34;gh&#34;&gt;# 登陆zk_master之后追加到授权文件里
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cat /root/id_rsa.pub &amp;gt;&amp;gt; /root/.ssh/authorized_keys
&lt;span class=&#34;gh&#34;&gt;# 删除远程传过来的zk_slave2公钥
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;rm -f /root/id_rsa.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;8、把存有 &lt;code&gt;zk_master&lt;/code&gt;，&lt;code&gt;zk_slave1&lt;/code&gt;，&lt;code&gt;zk_slave2&lt;/code&gt; 公钥文件的授权文件 &lt;code&gt;authorized_keys&lt;/code&gt; 文件远程复制到 &lt;code&gt;zk_slave1&lt;/code&gt;，&lt;code&gt;zk_slave2&lt;/code&gt; 上去&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;scp /root/.ssh/authorized_keys root@192.168.244.135:/root/.ssh
scp /root/.ssh/authorized_keys root@192.168.244.136:/root/.ssh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;9、分别在三台机器上用远程登陆命令 &lt;code&gt;ssh&lt;/code&gt; 登陆验证是否成功&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ssh zk_slave1
ssh zk_slave2
ssh zk_master
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;第一次 &lt;code&gt;ssh&lt;/code&gt; 时需要输入密码，之后便可以互相免密访问。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.chinaunix.net/uid-26284395-id-2949145.html&#34;&gt;http://blog.chinaunix.net/uid-26284395-id-2949145.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/ssh/">SSH</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 中的异常处理</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-exception/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-exception/</guid>
                <pubDate>Tue, 26 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Python 中的异常处理。&lt;/p&gt;
&lt;p&gt;Python 提供了两个非常重要的功能来处理 Python 程序在运行中出现的异常和错误，可以使用该功能来调试 Python 程序。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;异常处理&lt;/li&gt;
&lt;li&gt;断言&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;python-标准异常&#34;&gt;Python 标准异常&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;异常名称&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;BaseException&lt;/td&gt;
&lt;td&gt;所有异常的基类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SystemExit&lt;/td&gt;
&lt;td&gt;解释器请求退出&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;KeyboardInterrupt&lt;/td&gt;
&lt;td&gt;用户中断执行(通常是输入^C)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Exception&lt;/td&gt;
&lt;td&gt;常规错误的基类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;StopIteration&lt;/td&gt;
&lt;td&gt;迭代器没有更多的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;GeneratorExit&lt;/td&gt;
&lt;td&gt;生成器(generator)发生异常来通知退出&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;StandardError&lt;/td&gt;
&lt;td&gt;所有的内建标准异常的基类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ArithmeticError&lt;/td&gt;
&lt;td&gt;所有数值计算错误的基类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FloatingPointError&lt;/td&gt;
&lt;td&gt;浮点计算错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OverflowError&lt;/td&gt;
&lt;td&gt;数值运算超出最大限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ZeroDivisionError&lt;/td&gt;
&lt;td&gt;除(或取模)零 (所有数据类型)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AssertionError&lt;/td&gt;
&lt;td&gt;断言语句失败&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AttributeError&lt;/td&gt;
&lt;td&gt;对象没有这个属性&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;EOFError&lt;/td&gt;
&lt;td&gt;没有内建输入,到达EOF 标记&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;EnvironmentError&lt;/td&gt;
&lt;td&gt;操作系统错误的基类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IOError&lt;/td&gt;
&lt;td&gt;输入/输出操作失败&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OSError&lt;/td&gt;
&lt;td&gt;操作系统错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;WindowsError&lt;/td&gt;
&lt;td&gt;系统调用失败&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ImportError&lt;/td&gt;
&lt;td&gt;导入模块/对象失败&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;LookupError&lt;/td&gt;
&lt;td&gt;无效数据查询的基类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IndexError&lt;/td&gt;
&lt;td&gt;序列中没有此索引(index)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;KeyError&lt;/td&gt;
&lt;td&gt;映射中没有这个键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;MemoryError&lt;/td&gt;
&lt;td&gt;内存溢出错误(对于Python 解释器不是致命的)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NameError&lt;/td&gt;
&lt;td&gt;未声明/初始化对象 (没有属性)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UnboundLocalError&lt;/td&gt;
&lt;td&gt;访问未初始化的本地变量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ReferenceError&lt;/td&gt;
&lt;td&gt;弱引用(Weak reference)试图访问已经垃圾回收了的对象&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RuntimeError&lt;/td&gt;
&lt;td&gt;一般的运行时错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NotImplementedError&lt;/td&gt;
&lt;td&gt;尚未实现的方法&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SyntaxError&lt;/td&gt;
&lt;td&gt;Python 语法错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IndentationError&lt;/td&gt;
&lt;td&gt;缩进错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TabError&lt;/td&gt;
&lt;td&gt;Tab 和空格混用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SystemError&lt;/td&gt;
&lt;td&gt;一般的解释器系统错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TypeError&lt;/td&gt;
&lt;td&gt;对类型无效的操作&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ValueError&lt;/td&gt;
&lt;td&gt;传入无效的参数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UnicodeError&lt;/td&gt;
&lt;td&gt;Unicode 相关的错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UnicodeDecodeError&lt;/td&gt;
&lt;td&gt;Unicode 解码时的错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UnicodeEncodeError&lt;/td&gt;
&lt;td&gt;Unicode 编码时错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UnicodeTranslateError&lt;/td&gt;
&lt;td&gt;Unicode 转换时错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Warning&lt;/td&gt;
&lt;td&gt;警告的基类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DeprecationWarning&lt;/td&gt;
&lt;td&gt;关于被弃用的特征的警告&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FutureWarning&lt;/td&gt;
&lt;td&gt;关于构造将来语义会有改变的警告&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OverflowWarning&lt;/td&gt;
&lt;td&gt;旧的关于自动提升为长整型(long)的警告&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PendingDeprecationWarning&lt;/td&gt;
&lt;td&gt;关于特性将会被废弃的警告&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RuntimeWarning&lt;/td&gt;
&lt;td&gt;可疑的运行时行为(runtime behavior)的警告&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SyntaxWarning&lt;/td&gt;
&lt;td&gt;可疑的语法的警告&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UserWarning&lt;/td&gt;
&lt;td&gt;用户代码生成的警告&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;异常&#34;&gt;异常&lt;/h3&gt;
&lt;p&gt;异常即是一个事件，该事件会在程序执行过程中发生，影响了程序的正常执行。&lt;/p&gt;
&lt;p&gt;一般情况下，在Python无法正常处理程序时就会发生一个异常。&lt;/p&gt;
&lt;p&gt;异常是Python对象，表示一个错误。当Python脚本发生异常时,需要捕获处理它，否则程序会终止执行。&lt;/p&gt;
&lt;h3 id=&#34;异常处理&#34;&gt;异常处理&lt;/h3&gt;
&lt;p&gt;捕捉异常可以使用 &lt;code&gt;try/except&lt;/code&gt; 语句。&lt;code&gt;try/except&lt;/code&gt; 语句用来检测 &lt;code&gt;try&lt;/code&gt; 语句块中的错误，从而让 &lt;code&gt;except&lt;/code&gt; 语句捕获异常信息并处理。&lt;/p&gt;
&lt;p&gt;如果不想在异常发生时结束程序，只需在try里捕获它。&lt;/p&gt;
&lt;p&gt;简单的 &lt;code&gt;try....except...else&lt;/code&gt; 的语法&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;try:
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;语句&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;        &lt;span class=&#34;ni&#34;&gt;#运行别的代码&lt;/span&gt;
except &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;名字&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;：
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;语句&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;        &lt;span class=&#34;ni&#34;&gt;#如果在try部份引发了&lt;/span&gt;&amp;#39;name&amp;#39;异常
except &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;名字&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;，&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;数据&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;:
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;语句&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;        &lt;span class=&#34;ni&#34;&gt;#如果引发了&lt;/span&gt;&amp;#39;name&amp;#39;异常，获得附加的数据
else:
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;语句&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;        &lt;span class=&#34;ni&#34;&gt;#如果没有异常发生&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;try的工作原理是，当开始一个try语句后，python就在当前程序的上下文中作标记，这样当异常出现时就可以回到这里，try子句先执行，接下来会发生什么依赖于执行时是否出现异常。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当try后的语句执行时发生异常，python就跳回到try并执行第一个匹配该异常的except子句，异常处理完毕，控制流就通过整个try语句（除非在处理异常时又引发新的异常）。&lt;/li&gt;
&lt;li&gt;如果在try后的语句里发生了异常，却没有匹配的except子句，异常将被递交到上层的try，或者到程序的最上层（这样将结束程序，并打印缺省的出错信息）。&lt;/li&gt;
&lt;li&gt;如果在try子句执行时没有发生异常，python将执行else语句后的语句（如果有else的话），然后控制流通过整个try语句。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;使用-except-而不带任何异常类型&#34;&gt;使用 except 而不带任何异常类型&lt;/h4&gt;
&lt;p&gt;可以不带任何异常类型使用except，如下实例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;try:
    正常的操作
   ......................
except:
    发生异常，执行这块代码
   ......................
else:
    如果没有异常执行这块代码
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上方式 &lt;code&gt;try-except&lt;/code&gt; 语句捕获所有发生的异常。但这不是一个很好的方式,不能通过该程序识别出具体的异常信息。因为它捕获所有的异常。&lt;/p&gt;
&lt;h4 id=&#34;使用-except-而带多种异常类型&#34;&gt;使用 except 而带多种异常类型&lt;/h4&gt;
&lt;p&gt;可以使用相同的 except 语句来处理多个异常信息，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;try:
    正常的操作
   ......................
except(Exception1[, Exception2[,...ExceptionN]]]):
   发生以上多个异常中的一个，执行这块代码
   ......................
else:
    如果没有异常执行这块代码
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;try-finally-语句&#34;&gt;try-finally 语句&lt;/h4&gt;
&lt;p&gt;try-finally 语句无论是否发生异常都将执行最后的代码。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;try:
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;语句&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
finally:
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;语句&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;    &lt;span class=&#34;ni&#34;&gt;#退出try时总会执行&lt;/span&gt;
raise
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当在try块中抛出一个异常，立即执行finally块代码。&lt;/p&gt;
&lt;p&gt;finally块中的所有语句执行后，异常被再次触发，并执行except块代码。&lt;/p&gt;
&lt;p&gt;参数的内容不同于异常。&lt;/p&gt;
&lt;h3 id=&#34;异常的参数&#34;&gt;异常的参数&lt;/h3&gt;
&lt;p&gt;一个异常可以带上参数，可作为输出的异常信息参数。可以通过except语句来捕获异常的参数，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;try:
    正常的操作
   ......................
except ExceptionType, Argument:
    你可以在这输出 Argument 的值...
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;变量接收的异常值通常包含在异常的语句中。在元组的表单中变量可以接收一个或者多个值。&lt;/p&gt;
&lt;p&gt;元组通常包含错误字符串，错误数字，错误位置。&lt;/p&gt;
&lt;h3 id=&#34;触发异常&#34;&gt;触发异常&lt;/h3&gt;
&lt;p&gt;可以使用 raise 语句自己触发异常，raise语法格式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;raise [Exception [, args [, traceback]]]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;语句中Exception是异常的类型（例如，NameError）参数是一个异常参数值。该参数是可选的，如果不提供，异常的参数是&amp;quot;None&amp;quot;。&lt;/p&gt;
&lt;p&gt;最后一个参数是可选的（在实践中很少使用），如果存在，是跟踪异常对象。&lt;/p&gt;
&lt;p&gt;一个异常可以是一个字符串，类或对象。 Python的内核提供的异常，大多数都是实例化的类，这是一个类的实例的参数。&lt;/p&gt;
&lt;p&gt;定义一个异常非常简单，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;def functionName( level ):
    if level &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;1:&lt;/span&gt;
        &lt;span class=&#34;na&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Invalid&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;level&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;!&amp;#34;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;level&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;err&#34;&gt;#&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;触发异常后&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;，&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;后面的代码就不会再执行&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意：为了能够捕获异常，&amp;quot;except&amp;quot;语句必须有用相同的异常来抛出类对象或者字符串。&lt;/p&gt;
&lt;p&gt;例如捕获以上异常，&amp;quot;except&amp;quot;语句如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;try:
    正常逻辑
except &amp;#34;Invalid level!&amp;#34;:
    触发自定义异常    
else:
    其余代码
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;用户自定义异常&#34;&gt;用户自定义异常&lt;/h3&gt;
&lt;p&gt;通过创建一个新的异常类，程序可以命名它们自己的异常。异常应该是典型的继承自 &lt;code&gt;Exception&lt;/code&gt; 类，通过直接或间接的方式。&lt;/p&gt;
&lt;p&gt;以下为与 &lt;code&gt;RuntimeError&lt;/code&gt; 相关的实例,实例中创建了一个类，基类为 &lt;code&gt;RuntimeError&lt;/code&gt;，用于在异常触发时输出更多的信息。&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;try&lt;/code&gt; 语句块中，用户自定义的异常后执行 &lt;code&gt;except&lt;/code&gt; 块语句，变量 e 是用于创建 &lt;code&gt;NetworkError&lt;/code&gt; 类的实例。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;class NetworkError(RuntimeError):
    def &lt;span class=&#34;gs&#34;&gt;__init__&lt;/span&gt;(self, arg):
        self.args = arg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在定义以上类后，可以触发该异常，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;try:
    raise Networkerror(&amp;#34;Bad hostname&amp;#34;)
except Networkerror,e:
    print e.args
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 数据库操作</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-database/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-database/</guid>
                <pubDate>Tue, 26 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Python 中的数据库操作。&lt;/p&gt;
&lt;p&gt;DB-API 是一个规范，它定义了一系列必须的对象和数据库存取方式, 以便为各种各样的底层数据库系统和多种多样的数据库接口程序提供一致的访问接口 。&lt;/p&gt;
&lt;p&gt;Python 的 DB-API，为大多数的数据库实现了接口，使用它连接各数据库后，就可以用相同的方式操作各数据库。&lt;/p&gt;
&lt;p&gt;Python DB-API使用流程：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;引入 API 模块&lt;/li&gt;
&lt;li&gt;获取与数据库的连接&lt;/li&gt;
&lt;li&gt;执行SQL语句和存储过程&lt;/li&gt;
&lt;li&gt;关闭数据库连接&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;mysqldb&#34;&gt;MySQLdb&lt;/h3&gt;
&lt;p&gt;MySQLdb 是用于Python连接Mysql数据库的接口，它实现了 Python 数据库 API 规范 V2.0，基于 MySQL C API 上建立的。&lt;/p&gt;
&lt;h4 id=&#34;连接-mysql-数据库&#34;&gt;连接 MySQL 数据库&lt;/h4&gt;
&lt;p&gt;以下代码演示了连接 MySQL 数据库的方法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- conding: utf-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
import MySQLdb

&lt;span class=&#34;gh&#34;&gt;# 打开数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db = MySQLdb.connect(&amp;#34;localhost&amp;#34;, &amp;#34;root&amp;#34;, &amp;#34;root456&amp;#34;, &amp;#34;xdhuxc&amp;#34;)

&lt;span class=&#34;gh&#34;&gt;# 使用cursor()方法获取操作游标
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor = db.cursor()

&lt;span class=&#34;gh&#34;&gt;# 使用execute方法执行SQL语句
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor.execute(&amp;#34;select version()&amp;#34;)

&lt;span class=&#34;gh&#34;&gt;# 使用fetchone()方法获取一条数据库记录
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;data = cursor.fetchone()

print &amp;#34;Database version: %s&amp;#34; % data

&lt;span class=&#34;gh&#34;&gt;# 关闭数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db.close()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;创建数据库表&#34;&gt;创建数据库表&lt;/h4&gt;
&lt;p&gt;以下代码演示了创建数据库表的方法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
import MySQLdb

&lt;span class=&#34;gh&#34;&gt;# 打开数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db = MySQLdb.connect(&amp;#34;localhost&amp;#34;,&amp;#34;root&amp;#34;,&amp;#34;root456&amp;#34;,&amp;#34;xdhuxc&amp;#34; )

&lt;span class=&#34;gh&#34;&gt;# 使用cursor()方法获取操作游标 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor = db.cursor()

&lt;span class=&#34;gh&#34;&gt;# 如果数据表已经存在使用 execute() 方法删除表。
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor.execute(&amp;#34;drop table if exists employee&amp;#34;)

&lt;span class=&#34;gh&#34;&gt;# 创建数据表SQL语句
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;sql = &amp;#34;&amp;#34;&amp;#34;create table employee (
         first_name char(20) not null,
         last_name  char(20),
         age int,  
         sex char(1),
         income float 
         )
      &amp;#34;&amp;#34;&amp;#34;
&lt;span class=&#34;gh&#34;&gt;# 执行SQL语句
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor.execute(sql)

&lt;span class=&#34;gh&#34;&gt;# 关闭数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db.close()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;数据库插入操作&#34;&gt;数据库插入操作&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
import MySQLdb

&lt;span class=&#34;gh&#34;&gt;# 打开数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db = MySQLdb.connect(&amp;#34;localhost&amp;#34;,&amp;#34;root&amp;#34;,&amp;#34;root456&amp;#34;,&amp;#34;xdhuxc&amp;#34; )

&lt;span class=&#34;gh&#34;&gt;# 使用cursor()方法获取操作游标 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor = db.cursor()

&lt;span class=&#34;gh&#34;&gt;# SQL 插入语句
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;sql = &amp;#34;&amp;#34;&amp;#34;
         insert into employee(first_name,
         last_name, age, sex, income)
         values (&amp;#39;Mac&amp;#39;, &amp;#39;Mohan&amp;#39;, 20, &amp;#39;M&amp;#39;, 2000)
      &amp;#34;&amp;#34;&amp;#34;
&lt;span class=&#34;gh&#34;&gt;#sql = &amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;#         insert into employee(first_name, \
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;#         last_name, age, sex, income) \
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;#         values (&amp;#39;%s&amp;#39;, &amp;#39;%s&amp;#39;, &amp;#39;%d&amp;#39;, &amp;#39;%c&amp;#39;, &amp;#39;%d&amp;#39; )&amp;#34; % \
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;#         (&amp;#39;Mac&amp;#39;, &amp;#39;Mohan&amp;#39;, 20, &amp;#39;M&amp;#39;, 2000)      
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;#      &amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;      
try:
   # 执行sql语句
   cursor.execute(sql)
   # 提交到数据库执行
   db.commit()
except:
   # 如果有错误，则回滚
   db.rollback()

&lt;span class=&#34;gh&#34;&gt;# 关闭数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db.close()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用变量向 SQL 语句中传递参数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;user_name = &amp;#34;root&amp;#34;
password = &amp;#34;root456&amp;#34;

cursor.execute(&amp;#39;insert into login values (&amp;#34;%s&amp;#34;, &amp;#34;%s&amp;#34;)&amp;#39; % (user_name, password))
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;数据库查询操作&#34;&gt;数据库查询操作&lt;/h4&gt;
&lt;p&gt;Python 查询 MySQL 使用 &lt;code&gt;fetchone()&lt;/code&gt; 方法获取单条数据, 使用 &lt;code&gt;fetchall()&lt;/code&gt; 方法获取多条数据。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;fetchone(): 该方法获取下一个查询结果集，结果集是一个对象。&lt;/li&gt;
&lt;li&gt;fetchall():接收全部的返回结果行。&lt;/li&gt;
&lt;li&gt;rowcount: 这是一个只读属性，并返回执行execute()方法后影响的行数。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;查询 employee 表中 salary 字段大于 1000 的所有数据：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
import MySQLdb

&lt;span class=&#34;gh&#34;&gt;# 打开数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db = MySQLdb.connect(&amp;#34;localhost&amp;#34;,&amp;#34;root&amp;#34;,&amp;#34;root456&amp;#34;,&amp;#34;xdhuxc&amp;#34; )

&lt;span class=&#34;gh&#34;&gt;# 使用cursor()方法获取操作游标 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor = db.cursor()

&lt;span class=&#34;gh&#34;&gt;# SQL 查询语句
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;sql = &amp;#34;select * from employee where income &amp;gt; &amp;#39;%d&amp;#39;&amp;#34; % (1000)
try:
   # 执行SQL语句
   cursor.execute(sql)
   # 获取所有记录列表
   results = cursor.fetchall()
   for row in results:
      first_name = row[0]
      last_name = row[1]
      age = row[2]
      sex = row[3]
      income = row[4]
      # 打印结果
      print &amp;#34;first_name=%s,last_name=%s,age=%d,sex=%s,income=%d&amp;#34; % \
             (first_name, last_name, age, sex, income )
except:
   print &amp;#34;Error: unable to fecth data&amp;#34;

&lt;span class=&#34;gh&#34;&gt;# 关闭数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db.close()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;数据库更新操作&#34;&gt;数据库更新操作&lt;/h4&gt;
&lt;p&gt;更新操作用于更新数据表的的数据&lt;/p&gt;
&lt;p&gt;将 EMPLOYEE 表中的 SEX 字段为 &#39;M&#39; 的 AGE 字段递增 1：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
import MySQLdb

&lt;span class=&#34;gh&#34;&gt;# 打开数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db = MySQLdb.connect(&amp;#34;localhost&amp;#34;, &amp;#34;root&amp;#34;, &amp;#34;root456&amp;#34;, &amp;#34;xdhuxc&amp;#34; )

&lt;span class=&#34;gh&#34;&gt;# 使用cursor()方法获取操作游标 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor = db.cursor()

&lt;span class=&#34;gh&#34;&gt;# SQL 更新语句
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;sql = &amp;#34;update employee set age = age + 1 where sex = &amp;#39;%c&amp;#39;&amp;#34; % (&amp;#39;M&amp;#39;)
try:
   # 执行SQL语句
   cursor.execute(sql)
   # 提交到数据库执行
   db.commit()
except:
   # 发生错误时回滚
   db.rollback()

&lt;span class=&#34;gh&#34;&gt;# 关闭数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db.close()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;删除操作&#34;&gt;删除操作&lt;/h4&gt;
&lt;p&gt;删除操作用于删除数据表中的数据&lt;/p&gt;
&lt;p&gt;删除数据表 employee 中 age 大于 20 的所有数据：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
import MySQLdb

&lt;span class=&#34;gh&#34;&gt;# 打开数据库连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db = MySQLdb.connect(&amp;#34;localhost&amp;#34;, &amp;#34;root&amp;#34;, &amp;#34;root456&amp;#34;, &amp;#34;xdhuxc&amp;#34;)

&lt;span class=&#34;gh&#34;&gt;# 使用cursor()方法获取操作游标 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;cursor = db.cursor()

&lt;span class=&#34;gh&#34;&gt;# SQL 删除语句
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;sql = &amp;#34;delete from employee where age &amp;gt; &amp;#39;%d&amp;#39;&amp;#34; % (20)
try:
   # 执行SQL语句
   cursor.execute(sql)
   # 提交修改
   db.commit()
except:
   # 发生错误时回滚
   db.rollback()

&lt;span class=&#34;gh&#34;&gt;# 关闭连接
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;db.close()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;执行事务&#34;&gt;执行事务&lt;/h4&gt;
&lt;p&gt;事务机制可以确保数据一致性。&lt;/p&gt;
&lt;p&gt;事务应该具有4个属性：原子性、一致性、隔离性、持久性。这四个属性通常称为ACID特性。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;原子性（atomicity）。一个事务是一个不可分割的工作单位，事务中包括的诸操作要么都做，要么都不做。&lt;/li&gt;
&lt;li&gt;一致性（consistency）。事务必须是使数据库从一个一致性状态变到另一个一致性状态。一致性与原子性是密切相关的。&lt;/li&gt;
&lt;li&gt;隔离性（isolation）。一个事务的执行不能被其他事务干扰。即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。&lt;/li&gt;
&lt;li&gt;持久性（durability）。持续性也称永久性（permanence），指一个事务一旦提交，它对数据库中数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其有任何影响。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;对于支持事务的数据库， 在Python数据库编程中，当游标建立之时，就自动开始了一个隐形的数据库事务。
commit() 方法提交当前游标的所有更新操作，rollback() 方法回滚当前游标的所有操作。每一个方法都开始了一个新的事务。&lt;/p&gt;
&lt;h4 id=&#34;错误处理&#34;&gt;错误处理&lt;/h4&gt;
&lt;p&gt;DB API中定义了一些数据库操作的错误及异常&lt;/p&gt;
&lt;p&gt;下表列出了这些错误和异常：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;异常&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Warning&lt;/td&gt;
&lt;td&gt;当有严重警告时触发，例如插入数据是被截断等等。必须是 StandardError 的子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Error&lt;/td&gt;
&lt;td&gt;警告以外所有其他错误类。必须是 StandardError 的子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;InterfaceError&lt;/td&gt;
&lt;td&gt;当有数据库接口模块本身的错误（而不是数据库的错误）发生时触发。 必须是Error的子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DatabaseError&lt;/td&gt;
&lt;td&gt;和数据库有关的错误发生时触发。 必须是Error的子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DataError&lt;/td&gt;
&lt;td&gt;当有数据处理时的错误发生时触发，例如：除零错误，数据超范围等等。 必须是DatabaseError的子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OperationalError&lt;/td&gt;
&lt;td&gt;指非用户控制的，而是操作数据库时发生的错误。例如：连接意外断开、 数据库名未找到、事务处理失败、内存分配错误等等操作数据库是发生的错误。 必须是DatabaseError的子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IntegrityError&lt;/td&gt;
&lt;td&gt;完整性相关的错误，例如外键检查失败等。必须是DatabaseError子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;InternalError&lt;/td&gt;
&lt;td&gt;数据库的内部错误，例如游标（cursor）失效了、事务同步失败等等。 必须是DatabaseError子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ProgrammingError&lt;/td&gt;
&lt;td&gt;程序错误，例如数据表（table）没找到或已存在、SQL语句语法错误、 参数数量错误等等。必须是DatabaseError的子类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NotSupportedError&lt;/td&gt;
&lt;td&gt;不支持错误，指使用了数据库不支持的函数或API等。例如在连接对象上 使用.rollback()函数，然而数据库并不支持事务或者事务已关闭。 必须是DatabaseError的子类&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 面向对象</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-oriented-object/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-oriented-object/</guid>
                <pubDate>Tue, 26 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Python 中的面向对象 和网络编程。&lt;/p&gt;
&lt;h3 id=&#34;面向对象技术的基本概念&#34;&gt;面向对象技术的基本概念&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;类(Class): 用来描述具有相同的属性和方法的对象的集合。它定义了该集合中每个对象所共有的属性和方法。对象是类的实例。&lt;/li&gt;
&lt;li&gt;类变量：类变量在整个实例化的对象中是公用的。类变量定义在类中且在函数体之外。类变量通常不作为实例变量使用。&lt;/li&gt;
&lt;li&gt;数据成员：类变量或者实例变量用于处理类及其实例对象的相关的数据。&lt;/li&gt;
&lt;li&gt;方法重写：如果从父类继承的方法不能满足子类的需求，可以对其进行改写，这个过程叫方法的覆盖（override），也称为方法的重写。&lt;/li&gt;
&lt;li&gt;实例变量：定义在方法中的变量，只作用于当前实例的类。&lt;/li&gt;
&lt;li&gt;继承：即一个派生类继承基类的字段和方法。继承也允许把一个派生类的对象作为一个基类对象对待。&lt;/li&gt;
&lt;li&gt;实例化：创建一个类的实例，类的具体对象。&lt;/li&gt;
&lt;li&gt;方法：类中定义的函数。&lt;/li&gt;
&lt;li&gt;对象：通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;类&#34;&gt;类&lt;/h3&gt;
&lt;p&gt;使用 class 语句来创建一个新类，class 之后为类的名称并以冒号结尾，如下实例:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;class ClassName:
   &amp;#39;类的帮助信息&amp;#39;   &lt;span class=&#34;ni&#34;&gt;#类文档字符串&lt;/span&gt;，帮助信息可以通过ClassName.__doc__查看。
   class_suite  &lt;span class=&#34;ni&#34;&gt;#类体&lt;/span&gt;，由类成员，方法，数据属性组成。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;一个简单的Python类实例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
class Employee:
   &amp;#39;所有员工的基类&amp;#39;
   empCount = 0
 
   def &lt;span class=&#34;gs&#34;&gt;__init__&lt;/span&gt;(self, name, salary):
      self.name = name
      self.salary = salary
      Employee.empCount += 1
   
   def displayCount(self):
     print &amp;#34;Total Employee %d&amp;#34; % Employee.empCount
 
   def displayEmployee(self):
      print &amp;#34;Name : &amp;#34;, self.name,  &amp;#34;, Salary: &amp;#34;, self.salary
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;empCount 变量是一个类变量，它的值将在这个类的所有实例之间共享。你可以在内部类或外部类使用 Employee.empCount 访问。&lt;/li&gt;
&lt;li&gt;第一种方法__init__()方法是一种特殊的方法，被称为类的构造函数或初始化方法，当创建了这个类的实例时就会调用该方法&lt;/li&gt;
&lt;li&gt;self 代表类的实例，self 在定义类的方法时是必须有的，虽然在调用时不必传入相应的参数。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;self代表类的实例而非类&#34;&gt;self代表类的实例，而非类&lt;/h4&gt;
&lt;p&gt;类的方法与普通的函数只有一个特殊的区别——它们必须有一个额外的第一个参数名称, 按照惯例它的名称是 self。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;class Xdhuxc:
    def xdhuxc(self):
        print self
        print self.__class__
        print self.__doc__
        print self.__module__

x = Xdhuxc()
x.xdhuxc()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上程序执行结果为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;__main__.Xdhuxc&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;instance&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;at&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;0x02190940&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;gs&#34;&gt;__main__&lt;/span&gt;.Xdhuxc
None
&lt;span class=&#34;gs&#34;&gt;__main__&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;从执行结果可以看出，self 代表的是类的实例，代表当前对象的地址，而 self.&lt;strong&gt;class&lt;/strong&gt; 则指向类。
self 不是 python 关键字，将它换成 xdhuxc 也是可以正常执行的&lt;/p&gt;
&lt;h4 id=&#34;创建实例对象&#34;&gt;创建实例对象&lt;/h4&gt;
&lt;p&gt;在 Python 中，类的实例化类似函数调用方式。使用类的名称 Employee 来实例化，并通过 &lt;strong&gt;init&lt;/strong&gt; 方法接受参数。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;#34;创建 Employee 类的第一个对象&amp;#34;
emp1 = Employee(&amp;#34;Zara&amp;#34;, 2000)
&amp;#34;创建 Employee 类的第二个对象&amp;#34;
emp2 = Employee(&amp;#34;Manni&amp;#34;, 5000)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;访问属性&#34;&gt;访问属性&lt;/h4&gt;
&lt;p&gt;可以使用点(.)来访问对象的属性。使用如下类的名称访问类变量：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;emp1.displayEmployee()
emp2.displayEmployee()
print &amp;#34;Total Employee %d&amp;#34; % Employee.empCount
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以添加，删除，修改类的属性，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;emp1.age = 7  # 添加一个 &amp;#39;age&amp;#39; 属性
emp1.age = 8  # 修改 &amp;#39;age&amp;#39; 属性
del emp1.age  # 删除 &amp;#39;age&amp;#39; 属性
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以使用以下函数的方式来访问属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;getattr(obj, name[, default]) : 访问对象的属性。&lt;/li&gt;
&lt;li&gt;hasattr(obj,name) : 检查是否存在一个属性。&lt;/li&gt;
&lt;li&gt;setattr(obj,name,value) : 设置一个属性。如果属性不存在，会创建一个新属性。&lt;/li&gt;
&lt;li&gt;delattr(obj, name) : 删除属性。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用方式如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;hasattr(emp1, &amp;#39;age&amp;#39;)    # 如果存在 &amp;#39;age&amp;#39; 属性返回 True。
getattr(emp1, &amp;#39;age&amp;#39;)    # 返回 &amp;#39;age&amp;#39; 属性的值
setattr(emp1, &amp;#39;age&amp;#39;, 8) # 添加属性 &amp;#39;age&amp;#39; 值为 8
delattr(empl, &amp;#39;age&amp;#39;)    # 删除属性 &amp;#39;age&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;内置类属性&#34;&gt;内置类属性&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;dict&lt;/strong&gt; : 类的属性（包含一个字典，由类的数据属性组成）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;doc&lt;/strong&gt; :类的文档字符串&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;name&lt;/strong&gt;: 类名&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;module&lt;/strong&gt;: 类定义所在的模块（类的全名是&#39;&lt;strong&gt;main&lt;/strong&gt;.className&#39;，如果类位于一个导入模块module_name中，那么className.&lt;strong&gt;module&lt;/strong&gt; 等于 module_name）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;bases&lt;/strong&gt; : 类的所有父类构成元素（包含了一个由所有父类组成的元组）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;对象销毁垃圾回收&#34;&gt;对象销毁(垃圾回收)&lt;/h3&gt;
&lt;p&gt;Python 使用了引用计数这一简单技术来跟踪和回收垃圾。
在 Python 内部记录着所有使用中的对象各有多少引用。
一个内部跟踪变量，称为一个引用计数器。
当对象被创建时， 就创建了一个引用计数， 当这个对象不再需要时， 也就是说， 这个对象的引用计数变为0 时， 它被垃圾回收。但是回收不是&amp;quot;立即&amp;quot;的， 由解释器在适当的时机，将垃圾对象占用的内存空间回收。&lt;/p&gt;
&lt;p&gt;垃圾回收机制不仅针对引用计数为0的对象，同样也可以处理循环引用的情况。循环引用指的是，两个对象相互引用，但是没有其他变量引用他们。这种情况下，仅使用引用计数是不够的。Python 的垃圾收集器实际上是一个引用计数器和一个循环垃圾收集器。作为引用计数的补充， 循环垃圾收集器也会留心被分配的总量很大（及未通过引用计数销毁的那些）的对象。 在这种情况下， 解释器会暂停下来， 试图清理所有未引用的循环。&lt;/p&gt;
&lt;p&gt;析构函数 &lt;strong&gt;del&lt;/strong&gt; ，__del__在对象销毁的时候被调用，当对象不再被使用时，__del__方法运行。&lt;/p&gt;
&lt;h3 id=&#34;类的继承&#34;&gt;类的继承&lt;/h3&gt;
&lt;p&gt;面向对象的编程带来的主要好处之一是代码的重用，实现这种重用的方法之一是通过继承机制。继承完全可以理解成类之间的类型和子类型关系。&lt;/p&gt;
&lt;p&gt;需要注意的地方：继承语法 class 派生类名（基类名）：//... 基类名写在括号里，基本类是在类定义的时候，在元组之中指明的。&lt;/p&gt;
&lt;p&gt;Python 继承中的若干特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在继承中基类的构造（&lt;strong&gt;init&lt;/strong&gt;()方法）不会被自动调用，它需要在其派生类的构造中亲自专门调用。&lt;/li&gt;
&lt;li&gt;在调用基类的方法时，需要加上基类的类名前缀，且需要带上self参数变量。区别于在类中调用普通函数时并不需要带上self参数&lt;/li&gt;
&lt;li&gt;Python总是首先查找对应类型的方法，如果它不能在派生类中找到对应的方法，它才开始到基类中逐个查找。（先在本类中查找调用的方法，找不到才去基类中找）。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果在继承元组中列了一个以上的类，那么它就被称作&amp;quot;多重继承&amp;quot; 。&lt;/p&gt;
&lt;p&gt;派生类的声明，与他们的父类类似，继承的基类列表跟在类名之后，语法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;class SubClassName (ParentClass1[, ParentClass2, ...]):
   &amp;#39;Optional class documentation string&amp;#39;
   class_suite
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以使用issubclass()或者isinstance()方法来检测。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;issubclass() - 布尔函数判断一个类是另一个类的子类或者子孙类，语法：issubclass(sub,sup)&lt;/li&gt;
&lt;li&gt;isinstance(obj, Class) 布尔函数如果obj是Class类的实例对象或者是一个Class子类的实例对象则返回true。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;方法重写&#34;&gt;方法重写&lt;/h4&gt;
&lt;p&gt;如果父类方法的功能不能满足需求，可以在子类重写父类的方法。&lt;/p&gt;
&lt;p&gt;基础重载方法：&lt;/p&gt;
&lt;p&gt;下表列出了一些通用的功能，你可以在自己的类重写：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;方法&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;简单调用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;init&lt;/strong&gt; ( self [,args...] )&lt;/td&gt;
&lt;td&gt;构造函数&lt;/td&gt;
&lt;td&gt;简单的调用方法: obj = className(args)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;del&lt;/strong&gt;( self )&lt;/td&gt;
&lt;td&gt;析构方法, 删除一个对象&lt;/td&gt;
&lt;td&gt;简单的调用方法 : del obj&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;repr&lt;/strong&gt;( self )&lt;/td&gt;
&lt;td&gt;转化为供解释器读取的形式&lt;/td&gt;
&lt;td&gt;简单的调用方法 : repr(obj)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;str&lt;/strong&gt;( self )&lt;/td&gt;
&lt;td&gt;用于将值转化为适于人阅读的形式&lt;/td&gt;
&lt;td&gt;简单的调用方法 : str(obj)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;cmp&lt;/strong&gt; ( self, x )&lt;/td&gt;
&lt;td&gt;对象比较&lt;/td&gt;
&lt;td&gt;简单的调用方法 : cmp(obj, x)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;运算符重载&#34;&gt;运算符重载&lt;/h4&gt;
&lt;p&gt;Python同样支持运算符重载，实例如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
class Vector:
   def &lt;span class=&#34;gs&#34;&gt;__init__&lt;/span&gt;(self, a, b):
      self.a = a
      self.b = b
 
   def &lt;span class=&#34;gs&#34;&gt;__str__&lt;/span&gt;(self):
      return &amp;#39;Vector (%d, %d)&amp;#39; % (self.a, self.b)
   
   def &lt;span class=&#34;gs&#34;&gt;__add__&lt;/span&gt;(self,other):
      return Vector(self.a + other.a, self.b + other.b)
 
v1 = Vector(2,10)
v2 = Vector(5,-2)
print v1 + v2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;类属性与方法&#34;&gt;类属性与方法&lt;/h4&gt;
&lt;h5 id=&#34;类的私有属性&#34;&gt;类的私有属性&lt;/h5&gt;
&lt;p&gt;__private_attrs：两个下划线开头，声明该属性为私有，不能在类的外部被使用或直接访问。在类内部的方法中使用时 self.__private_attrs。&lt;/p&gt;
&lt;h5 id=&#34;类的方法&#34;&gt;类的方法&lt;/h5&gt;
&lt;p&gt;在类的内部，使用 def 关键字可以为类定义一个方法，与一般函数定义不同，类方法必须包含参数 self,且为第一个参数&lt;/p&gt;
&lt;h5 id=&#34;类的私有方法&#34;&gt;类的私有方法&lt;/h5&gt;
&lt;p&gt;__private_method：两个下划线开头，声明该方法为私有方法，不能在类地外部调用。在类的内部调用 self.__private_methods&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
class JustCounter:
    __secretCount = 0  # 私有变量
    publicCount = 0    # 公开变量
 
    def count(self):
        self.__secretCount += 1
        self.publicCount += 1
        print self.__secretCount
 
counter = JustCounter()
counter.count()
counter.count()
print counter.publicCount
print counter.__secretCount  # 报错，实例不能访问私有变量
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Python不允许实例化的类访问私有数据，但可以使用 object._className__attrName 访问属性&lt;/p&gt;
&lt;h3 id=&#34;单下划线双下划线头尾双下划线说明&#34;&gt;单下划线、双下划线、头尾双下划线说明&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;foo&lt;/strong&gt;: 定义的是特列方法，类似 &lt;strong&gt;init&lt;/strong&gt;() 之类的。&lt;/li&gt;
&lt;li&gt;_foo: 以单下划线开头的表示的是 protected 类型的变量，即保护类型只能允许其本身与子类进行访问，不能用于 from module import *&lt;/li&gt;
&lt;li&gt;__foo: 双下划线的表示的是私有类型(private)的变量, 只能是允许这个类本身进行访问了。&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 中的正则表达式</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-regular-expression/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-regular-expression/</guid>
                <pubDate>Mon, 25 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Python 中的正则表达式。&lt;/p&gt;
&lt;p&gt;正则表达式是一个特殊的字符序列，它能方便地检查一个字符串是否与某种模式匹配。&lt;/p&gt;
&lt;p&gt;re 模块使 Python 语言拥有全部的正则表达式功能。&lt;/p&gt;
&lt;p&gt;compile 函数根据一个模式字符串和可选的标志参数生成一个正则表达式对象。该对象拥有一系列方法用于正则表达式匹配和替换。&lt;/p&gt;
&lt;p&gt;re 模块也提供了与这些方法功能完全一致的函数，这些函数使用一个模式字符串做为它们的第一个参数。&lt;/p&gt;
&lt;h3 id=&#34;正则表达式修饰符---可选标志&#34;&gt;正则表达式修饰符 - 可选标志&lt;/h3&gt;
&lt;p&gt;正则表达式可以包含一些可选标志修饰符来控制匹配的模式。修饰符被指定为一个可选的标志。多个标志可以通过按位 OR(|) 它们来指定。如 re.I | re.M 被设置成 I 和 M 标志：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;修饰符&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;re.I&lt;/td&gt;
&lt;td&gt;使匹配对大小写不敏感&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re.L&lt;/td&gt;
&lt;td&gt;做本地化识别（locale-aware）匹配&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re.M&lt;/td&gt;
&lt;td&gt;多行匹配，影响 ^ 和 $&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re.S&lt;/td&gt;
&lt;td&gt;使 . 匹配包括换行在内的所有字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re.U&lt;/td&gt;
&lt;td&gt;根据Unicode字符集解析字符。这个标志影响 \w, \W, \b, \B.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re.X&lt;/td&gt;
&lt;td&gt;该标志通过给予更灵活的格式以便将正则表达式写得更易于理解。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;正则表达式模式&#34;&gt;正则表达式模式&lt;/h3&gt;
&lt;p&gt;模式字符串使用特殊的语法来表示一个正则表达式&lt;/p&gt;
&lt;p&gt;1、字母和数字表示他们自身。一个正则表达式模式中的字母和数字匹配同样的字符串。&lt;/p&gt;
&lt;p&gt;2、多数字母和数字前加一个反斜杠时会拥有不同的含义。&lt;/p&gt;
&lt;p&gt;3、标点符号只有被转义时才匹配自身，否则它们表示特殊的含义。&lt;/p&gt;
&lt;p&gt;4、反斜杠本身需要使用反斜杠转义。&lt;/p&gt;
&lt;p&gt;5、由于正则表达式通常都包含反斜杠，所以你最好使用原始字符串来表示它们。模式元素(如 r&#39;\t&#39;，等价于 &#39;\t&#39;)匹配相应的特殊字符。&lt;/p&gt;
&lt;p&gt;正则表达式模式语法中的特殊元素：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;模式&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;^&lt;/td&gt;
&lt;td&gt;匹配字符串的开头&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;$&lt;/td&gt;
&lt;td&gt;匹配字符串的末尾&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;.&lt;/td&gt;
&lt;td&gt;匹配任意字符，除了换行符，当re.DOTALL标记被指定时，则可以匹配包括换行符的任意字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;[...]&lt;/td&gt;
&lt;td&gt;用来表示一组字符,单独列出：[amk] 匹配 &#39;a&#39;，&#39;m&#39;或&#39;k&#39;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;[^...]&lt;/td&gt;
&lt;td&gt;不在[]中的字符：[^abc] 匹配除了a,b,c之外的字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\w&lt;/td&gt;
&lt;td&gt;匹配字母数字及下划线&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\W&lt;/td&gt;
&lt;td&gt;匹配非字母数字及下划线&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\s&lt;/td&gt;
&lt;td&gt;匹配任意空白字符，等价于 [\t\n\r\f]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\S&lt;/td&gt;
&lt;td&gt;匹配任意非空字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\d&lt;/td&gt;
&lt;td&gt;匹配任意数字，等价于 [0-9]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\D&lt;/td&gt;
&lt;td&gt;匹配任意非数字&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\A&lt;/td&gt;
&lt;td&gt;匹配字符串开始&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\Z&lt;/td&gt;
&lt;td&gt;匹配字符串结束，如果是存在换行，只匹配到换行前的结束字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\z&lt;/td&gt;
&lt;td&gt;匹配字符串结束&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\G&lt;/td&gt;
&lt;td&gt;匹配最后匹配完成的位置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re*&lt;/td&gt;
&lt;td&gt;匹配0个或多个的表达式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re+&lt;/td&gt;
&lt;td&gt;匹配1个或多个的表达式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re?&lt;/td&gt;
&lt;td&gt;匹配0个或1个由前面的正则表达式定义的片段，非贪婪方式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re {n,}&lt;/td&gt;
&lt;td&gt;精确匹配n个前面表达式。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;re {n,m}&lt;/td&gt;
&lt;td&gt;匹配 n 到 m 次由前面的正则表达式定义的片段，贪婪方式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;a&lt;/td&gt;
&lt;td&gt;b&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(re)&lt;/td&gt;
&lt;td&gt;G匹配括号内的表达式，也表示一个组&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(?imx)&lt;/td&gt;
&lt;td&gt;正则表达式包含三种可选标志：i, m, 或 x 。只影响括号中的区域。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(?-imx)&lt;/td&gt;
&lt;td&gt;正则表达式关闭 i, m, 或 x 可选标志。只影响括号中的区域。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(?:re)&lt;/td&gt;
&lt;td&gt;类似 (...), 但是不表示一个组&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(?imx:re)&lt;/td&gt;
&lt;td&gt;在括号中使用i, m, 或 x 可选标志&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(?-imx:re)&lt;/td&gt;
&lt;td&gt;在括号中不使用i, m, 或 x 可选标志&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(?#...)&lt;/td&gt;
&lt;td&gt;注释&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 中的网络编程</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-network/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-network/</guid>
                <pubDate>Sun, 24 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Python 中的网络编程。&lt;/p&gt;
&lt;p&gt;Python 提供了两个级别访问的网络服务：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;低级别的网络服务支持基本的 Socket，提供了标准的 BSD Sockets API，可以访问底层操作系统Socket接口的全部方法。&lt;/li&gt;
&lt;li&gt;高级别的网络服务模块 SocketServer， 它提供了服务器中心类，可以简化网络服务器的开发。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;socket&#34;&gt;Socket&lt;/h3&gt;
&lt;p&gt;Socket，又称“套接字”，应用程序通常通过“套接字”向网络发出请求或者应答网络请求，使主机间或者一台计算机上的进程间可以通讯。&lt;/p&gt;
&lt;h4 id=&#34;socket函数&#34;&gt;socket()函数&lt;/h4&gt;
&lt;p&gt;Python 中，我们用 socket（）函数来创建套接字，语法格式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;socket.socket([family[, type[, proto]]])
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;family: 套接字家族可以使AF_UNIX或者AF_INET&lt;/li&gt;
&lt;li&gt;type: 套接字类型可以根据是面向连接的还是非连接分为SOCK_STREAM或SOCK_DGRAM&lt;/li&gt;
&lt;li&gt;protocol: 一般不填默认为0.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;socket-对象内建方法&#34;&gt;Socket 对象(内建)方法&lt;/h4&gt;
&lt;p&gt;（1）服务端套接字&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;函数&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;s.bind()&lt;/td&gt;
&lt;td&gt;绑定地址（host,port）到套接字， 在AF_INET下,以元组（host,port）的形式表示地址。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.listen()&lt;/td&gt;
&lt;td&gt;开始TCP监听。backlog指定在拒绝连接之前，操作系统可以挂起的最大连接数量。该值至少为1，大部分应用程序设为5就可以了。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.accept()&lt;/td&gt;
&lt;td&gt;被动接受TCP客户端连接,(阻塞式)等待连接的到来&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;（2）客户端套接字&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;函数&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;s.connect()&lt;/td&gt;
&lt;td&gt;主动初始化TCP服务器连接。一般address的格式为元组（hostname,port），如果连接出错，返回socket.error错误。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.connect_ex()&lt;/td&gt;
&lt;td&gt;connect()函数的扩展版本,出错时返回出错码,而不是抛出异常&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;（3）公共用途的套接字函数&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;函数&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;s.recv()&lt;/td&gt;
&lt;td&gt;接收TCP数据，数据以字符串形式返回，bufsize指定要接收的最大数据量。flag提供有关消息的其他信息，通常可以忽略&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.send()&lt;/td&gt;
&lt;td&gt;发送TCP数据，将string中的数据发送到连接的套接字。返回值是要发送的字节数量，该数量可能小于string的字节大小&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.sendall()&lt;/td&gt;
&lt;td&gt;完整发送TCP数据，完整发送TCP数据。将string中的数据发送到连接的套接字，但在返回之前会尝试发送所有数据。成功返回None，失败则抛出异常&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.recvfrom()&lt;/td&gt;
&lt;td&gt;接收UDP数据，与recv()类似，但返回值是（data,address）。其中data是包含接收数据的字符串，address是发送数据的套接字地址&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.sendto()&lt;/td&gt;
&lt;td&gt;发送UDP数据，将数据发送到套接字，address是形式为（ipaddr，port）的元组，指定远程地址。返回值是发送的字节数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.close()&lt;/td&gt;
&lt;td&gt;关闭套接字&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.getpeername()&lt;/td&gt;
&lt;td&gt;返回连接套接字的远程地址。返回值通常是元组（ipaddr,port）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.getsockname()&lt;/td&gt;
&lt;td&gt;返回套接字自己的地址。通常是一个元组(ipaddr,port)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.setsockopt(level,optname,value)&lt;/td&gt;
&lt;td&gt;设置给定套接字选项的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.getsockopt(level,optname[.buflen])&lt;/td&gt;
&lt;td&gt;返回套接字选项的值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.settimeout(timeout)&lt;/td&gt;
&lt;td&gt;设置套接字操作的超时期，timeout是一个浮点数，单位是秒。值为None表示没有超时期。一般，超时期应该在刚创建套接字时设置，因为它们可能用于连接的操作（如connect()）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.gettimeout()&lt;/td&gt;
&lt;td&gt;返回当前超时期的值，单位是秒，如果没有设置超时期，则返回None&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.fileno()&lt;/td&gt;
&lt;td&gt;返回套接字的文件描述符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.setblocking(flag)&lt;/td&gt;
&lt;td&gt;如果flag为0，则将套接字设为非阻塞模式，否则将套接字设为阻塞模式（默认值）。非阻塞模式下，如果调用recv()没有发现任何数据，或send()调用无法立即发送数据，那么将引起socket.error异常&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;s.makefile()&lt;/td&gt;
&lt;td&gt;创建一个与该套接字相关连的文件&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;示例&#34;&gt;示例&lt;/h3&gt;
&lt;h4 id=&#34;服务器端&#34;&gt;服务器端&lt;/h4&gt;
&lt;p&gt;1、使用 socket 模块的 socket 函数来创建一个 socket 对象。socket 对象可以通过调用其他函数来设置一个 socket 服务。&lt;/p&gt;
&lt;p&gt;2、可以通过调用 bind(hostname, port) 函数来指定服务的 port(端口)。&lt;/p&gt;
&lt;p&gt;3、调用 socket 对象的 accept 方法。该方法等待客户端的连接，并返回 connection 对象，表示已连接到客户端。&lt;/p&gt;
&lt;p&gt;代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 文件名：server.py
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
import socket               # 导入 socket 模块

s = socket.socket()         # 创建 socket 对象
host = socket.gethostname() # 获取本地主机名
port = 12345                # 设置端口
s.bind((host, port))        # 绑定端口

s.listen(5)                 # 等待客户端连接
while True:
    c, addr = s.accept()     # 建立客户端连接。
    print &amp;#39;连接地址：&amp;#39;, addr
    c.send(&amp;#39;欢迎访问菜鸟教程！&amp;#39;)
    c.close()                # 关闭连接
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;客户端&#34;&gt;客户端&lt;/h4&gt;
&lt;p&gt;一个简单的客户端实例连接到以上创建的服务。端口号为 12345。&lt;/p&gt;
&lt;p&gt;socket.connect(hosname, port ) 方法打开一个 TCP 连接到主机为 hostname 端口为 port 的服务商。连接后我们就可以从服务端后期数据，记住，操作完成后需要关闭连接。&lt;/p&gt;
&lt;p&gt;代码如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 文件名：client.py
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
import socket               # 导入 socket 模块

s = socket.socket()         # 创建 socket 对象
host = socket.gethostname() # 获取本地主机名
port = 12345                # 设置端口好

s.connect((host, port))
print s.recv(1024)
s.close()  
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;运行该程序&#34;&gt;运行该程序&lt;/h4&gt;
&lt;p&gt;1、打开两个终端，第一个终端执行 server.py 文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ python server.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、第二个终端执行 client.py 文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ python client.py
It is python language
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、再打开第一个终端，就会看到有以下信息输出：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;连接地址： (&amp;#39;192.168.0.118&amp;#39;, 62461)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;internet-模块&#34;&gt;Internet 模块&lt;/h3&gt;
&lt;p&gt;Python网络编程的一些重要模块&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;协议&lt;/th&gt;
&lt;th&gt;功能&lt;/th&gt;
&lt;th&gt;端口号&lt;/th&gt;
&lt;th&gt;Python模块&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;HTTP&lt;/td&gt;
&lt;td&gt;网页访问&lt;/td&gt;
&lt;td&gt;80&lt;/td&gt;
&lt;td&gt;httplib, urllib, xmlrpclib&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NNTP&lt;/td&gt;
&lt;td&gt;阅读和张贴新闻文章，俗称为&amp;quot;帖子&amp;quot;&lt;/td&gt;
&lt;td&gt;119&lt;/td&gt;
&lt;td&gt;nntplib&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FTP&lt;/td&gt;
&lt;td&gt;文件传输&lt;/td&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;ftplib, urllib&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SMTP&lt;/td&gt;
&lt;td&gt;发送邮件&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;td&gt;smtplib&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;POP3&lt;/td&gt;
&lt;td&gt;接收邮件&lt;/td&gt;
&lt;td&gt;110&lt;/td&gt;
&lt;td&gt;poplib&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IMAP4&lt;/td&gt;
&lt;td&gt;获取邮件&lt;/td&gt;
&lt;td&gt;143&lt;/td&gt;
&lt;td&gt;imaplib&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Telnet&lt;/td&gt;
&lt;td&gt;命令行&lt;/td&gt;
&lt;td&gt;23&lt;/td&gt;
&lt;td&gt;telnetlib&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Gopher&lt;/td&gt;
&lt;td&gt;信息查找&lt;/td&gt;
&lt;td&gt;70&lt;/td&gt;
&lt;td&gt;gopherlib, urllib&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Nexus 安装和自定义配置</title>
                <link>https://xdhuxc.github.io/posts/mixed/nexus/nexus-install-configuration/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/nexus/nexus-install-configuration/</guid>
                <pubDate>Fri, 22 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了 Nexus 的安装和配置。&lt;/p&gt;
&lt;h3 id=&#34;nexus&#34;&gt;Nexus&lt;/h3&gt;
&lt;p&gt;Nexus 是一个广泛使用的包管理工具，可以用来做 maven，rpm 等包的管理仓库，缓存包，供内部程序使用。&lt;/p&gt;
&lt;p&gt;Nexus 默认管理员用户名/密码为：admin/admin123，访问地址为：http://localhost:8081/nexus/ （需要开放8081端口，CentOS 7 Minimal模式安装，启动后会自动启动firewalld）&lt;/p&gt;
&lt;p&gt;如果有问题，可以使用bin/nexus console 来排查问题&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;/data/sonatype-work/nexus/conf/nexus.xml&lt;/code&gt; 中可以修改仓库的配置信息&lt;/p&gt;
&lt;p&gt;使用自己的 nexus.xml 覆盖 &lt;code&gt;/data/sonatype-work/nexus/conf/nexus.xml&lt;/code&gt; 目录下的nexus.xml文件，可以直接获得配置。注意，第一次启动Nexus时，并没有 sonatype-work 目录及其子目录，需要在覆盖 nexus.xml 文件后重新启动nexus&lt;/p&gt;
&lt;p&gt;1、上传Nexus.tar.gz到系统根目录下并解压&lt;/p&gt;
&lt;p&gt;2、运行nexus，命令为&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export RUN_AS_USER=root
./nexus start
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;默认存储路径为：（Nexus根目录在/data下）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;file:/data/sonatype-work/nexus/storage/central/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;注意&#34;&gt;注意：&lt;/h3&gt;
&lt;p&gt;扩充Nexus时，一定要先执行如下三步：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum clean all
yum repolist
yum makecache
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;配置-yumepeldocker-源&#34;&gt;配置 yum，epel，docker 源&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;使用阿里云或中科大的yum和epel源&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;base&#34;&gt;Base&lt;/h4&gt;
&lt;p&gt;创建仓库，类型为：proxy，&lt;/p&gt;
&lt;p&gt;仓库id：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;centos7_base #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7_base/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;名称为：CentOS7-Base&lt;/p&gt;
&lt;p&gt;Remote Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://mirrors.aliyun.com/centos/7.3.1611/os/x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Override Local Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;file:/data/sonatype-work/nexus/storage/Base-x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download Remote Indexes，选为：true&lt;/p&gt;
&lt;p&gt;仓库路径：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://192.168.244.129:8081/nexus/content/repositories/centos7_base/
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;update&#34;&gt;Update&lt;/h4&gt;
&lt;p&gt;创建仓库，类型为：proxy，&lt;/p&gt;
&lt;p&gt;仓库id：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;centos7-updates #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-updates/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;名称为：CentOS7-Updates&lt;/p&gt;
&lt;p&gt;Remote Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;https://mirrors.aliyun.com/centos/7/updates/x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Override Local Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;file:/data/sonatype-work/nexus/storage/centos7-updates/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download Remote Indexes，选为：true&lt;/p&gt;
&lt;p&gt;仓库路径：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://192.168.244.129:8081/nexus/content/repositories/centos7-updates/
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;extras&#34;&gt;Extras&lt;/h4&gt;
&lt;p&gt;创建仓库，类型为：proxy，&lt;/p&gt;
&lt;p&gt;仓库id：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;centos7-extras #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-extras/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;名称为：CentOS7-Extras&lt;/p&gt;
&lt;p&gt;Remote Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;https://mirrors.aliyun.com/centos/7/extras/x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Override Local Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;file:/data/sonatype-work/nexus/storage/centos7-extras/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download Remote Indexes，选为：true
仓库路径：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://192.168.244.129:8081/nexus/content/repositories/centos7-extras/
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;docker&#34;&gt;Docker&lt;/h4&gt;
&lt;p&gt;创建仓库，类型为：proxy，&lt;/p&gt;
&lt;p&gt;仓库id：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;centos7-docker #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-docker/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;名称为：CentOS7-Docker&lt;/p&gt;
&lt;p&gt;Remote Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;https://yum.dockerproject.org/repo/main/centos/7/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Override Local Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;file:/data/sonatype-work/nexus/storage/centos7-docker/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download Remote Indexes，选为：true
仓库路径：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://192.168.244.129:8081/nexus/content/repositories/centos7-docker/
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;docker-ce&#34;&gt;Docker CE&lt;/h4&gt;
&lt;p&gt;创建仓库，类型为：proxy，&lt;/p&gt;
&lt;p&gt;仓库id：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;centos7-dockerce #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-dockerce/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;名称为：CentOS7-DockerCE&lt;/p&gt;
&lt;p&gt;Remote Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;https://download.docker.com/linux/centos/7/x86_64/stable/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Override Local Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;file:/data/sonatype-work/nexus/storage/centos7-dockerce/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download Remote Indexes，选为：true
仓库路径：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://192.168.244.129:8081/nexus/content/repositories/centos7-dockerce/
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;epel&#34;&gt;EPEL&lt;/h4&gt;
&lt;p&gt;创建仓库，类型为：proxy，&lt;/p&gt;
&lt;p&gt;仓库id：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;centos7-epel #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-epel/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;名称为：CentOS7-Docker&lt;/p&gt;
&lt;p&gt;Remote Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;https://mirrors.aliyun.com/epel/7/x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Override Local Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;file:/data/sonatype-work/nexus/storage/centos7-epel/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download Remote Indexes，选为：true
仓库路径：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://192.168.244.129:8081/nexus/content/repositories/centos7-epel/
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;ustc-epel&#34;&gt;USTC EPEL&lt;/h4&gt;
&lt;p&gt;创建仓库，类型为：proxy，&lt;/p&gt;
&lt;p&gt;仓库id：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;centos7-ustc-epel #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-ustc-epel/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;名称为：CentOS7-USTC-EPEL&lt;/p&gt;
&lt;p&gt;Remote Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;https://mirrors.ustc.edu.cn/epel/7/x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Override Local Storage Location：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;file:/data/sonatype-work/nexus/storage/centos7-ustc-epel/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download Remote Indexes，选为：true
仓库路径：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://192.168.244.129:8081/nexus/content/repositories/centos7-ustc-epel/
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;使用自定义的repo&#34;&gt;使用自定义的repo&lt;/h3&gt;
&lt;p&gt;xdhuxc.repo的内容如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[base]
name=CentOS-$releasever - Base
baseurl=http://192.168.244.129:8081/nexus/content/repositories/centos7_base/ # 此路径为仓库路径
gpgcheck=0
gpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-CentOS-7

[updates]
name=CentOS-$releasever - Updates
baseurl=http://192.168.244.129:8081/nexus/content/repositories/centos7-updates/
gpgcheck=0
gpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-CentOS-7

[extras]
name=CentOS-$releasever - Extras
http://192.168.244.129:8081/nexus/content/repositories/centos7-extras/
gpgcheck=0
gpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-CentOS-7

[epel]
name=Extra Packages for Enterprise Linux 7 - $basearch
baseurl=http://192.168.244.129:8081/nexus/content/repositories/centos7-epel/
failovermethod=priority
enabled=1
gpgcheck=0
gpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-EPEL-7

[dockerrepo]
name=Docker Repository
baseurl=http://192.168.244.129:8081/nexus/content/repositories/centos7-docker/
enabled=1
gpgcheck=0
gpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-docker
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;复制xdhuxc.repo到/etc/yum.repos.d目录下，执行如下命令：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak
mv xdhuxc.repo /etc/yum.repos.d/CentOS-Base.repo
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;使用自己的nexus.xml覆盖&lt;code&gt;/data/sonatype-work/nexus/conf /nexus.xml&lt;/code&gt;目录下的nexus.xml文件，可以直接获得配置。注意，第一次启动Nexus时，并没有sonatype-work目录及其子目录，需要在覆盖nexus.xml文件后重新启动nexus&lt;/p&gt;
&lt;p&gt;清除yum并生成缓存，执行如下命令：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;yum clean
yum makecache
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;eple:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://mirror.premi.st/epel/7/x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://mirrors.aliyun.com/epel/6/x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;puppetlabs&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://yum.puppetlabs.com/el/7/products/x86_64/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;puppetlabdsdependencies&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;http://yum.puppetlabs.com/el/7/dependencies/x86_64/
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/nexus/">Nexus</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 中的日期、时间、函数和模块</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-date-time/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-date-time/</guid>
                <pubDate>Wed, 20 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Python 语言中的日期、时间、函数和模块。&lt;/p&gt;
&lt;h1 id=&#34;一日期和时间&#34;&gt;一、日期和时间&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Python 程序能用很多方式处理日期和时间，转换日期格式是一个常见的功能。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Python 提供了一个 time 和 calendar 模块可以用于格式化日期和时间。&lt;/p&gt;
&lt;p&gt;时间间隔是以秒为单位的浮点小数。&lt;/p&gt;
&lt;p&gt;每个时间戳都以自从1970年1月1日午夜（历元）经过了多长时间来表示。&lt;/p&gt;
&lt;p&gt;Python 的 time 模块下有很多函数可以转换常见日期格式。如函数time.time()用于获取当前时间戳, 如下所示：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/usr/bin/python
# -*- coding: UTF-8 -*-

import time;  # 引入time模块

ticks = time.time()
print &amp;quot;当前时间戳为:&amp;quot;, ticks
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;时间戳单位最适于做日期运算。但是1970年之前的日期就无法以此表示了。太遥远的日期也不行，UNIX和Windows只支持到2038年。&lt;/p&gt;
&lt;h2 id=&#34;时间元组&#34;&gt;时间元组&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;很多Python函数用一个元组装起来的9组数字处理时间&lt;/p&gt;
&lt;/blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;值&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;四位数字年&lt;/td&gt;
&lt;td&gt;2008&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;月&lt;/td&gt;
&lt;td&gt;1到12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;日&lt;/td&gt;
&lt;td&gt;1到31&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;小时&lt;/td&gt;
&lt;td&gt;0到23&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;分钟&lt;/td&gt;
&lt;td&gt;0到59&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;秒&lt;/td&gt;
&lt;td&gt;0到61（60或61是闰秒）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;一周的第几日&lt;/td&gt;
&lt;td&gt;0到6（0是周一）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;一年的第几日&lt;/td&gt;
&lt;td&gt;1到366（儒略历）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;夏令时&lt;/td&gt;
&lt;td&gt;-1, 0, 1, -1是决定是否为夏令时的旗帜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;上述也就是struct_time元组。这种结构具有如下属性：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;序号&lt;/th&gt;
&lt;th&gt;属性&lt;/th&gt;
&lt;th&gt;值&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;tm_year&lt;/td&gt;
&lt;td&gt;2008&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;tm_mon&lt;/td&gt;
&lt;td&gt;1到12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;tm_mday&lt;/td&gt;
&lt;td&gt;1到31&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;tm_hour&lt;/td&gt;
&lt;td&gt;0到23&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;tm_min&lt;/td&gt;
&lt;td&gt;0到59&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;tm_sec&lt;/td&gt;
&lt;td&gt;0到61（60或61是闰秒）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;tm_wday&lt;/td&gt;
&lt;td&gt;0到6（0是周一）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;tm_yday&lt;/td&gt;
&lt;td&gt;1到366（儒略历）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;tm_isdst&lt;/td&gt;
&lt;td&gt;-1, 0, 1, -1是决定是否为夏令时的旗帜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;获取当前时间&#34;&gt;获取当前时间&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;从返回浮点数的时间戳方式向时间元组转换，只要将浮点数传递给如localtime之类的函数。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/usr/bin/python
# -*- coding: UTF-8 -*-

import time

localtime = time.localtime(time.time())
print &amp;quot;本地时间为 :&amp;quot;, localtime
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;获取格式化的时间&#34;&gt;获取格式化的时间&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;可以根据需求选取各种格式，但是最简单的获取可读的时间模式的函数是asctime()。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/usr/bin/python
# -*- coding: UTF-8 -*-

import time

localtime = time.asctime( time.localtime(time.time()) )
print &amp;quot;本地时间为 :&amp;quot;, localtime
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;格式化日期&#34;&gt;格式化日期&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;可以使用 time 模块的 strftime 方法来格式化日期。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;time.strftime(format[, t])
&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/usr/bin/python
# -*- coding: UTF-8 -*-

import time

# 格式化成2016-03-20 11:45:39形式
print time.strftime(&amp;quot;%Y-%m-%d %H:%M:%S&amp;quot;, time.localtime()) 

# 格式化成Sat Mar 28 22:24:24 2016形式
print time.strftime(&amp;quot;%a %b %d %H:%M:%S %Y&amp;quot;, time.localtime()) 
  
# 将格式字符串转换为时间戳
a = &amp;quot;Sat Mar 28 22:24:24 2016&amp;quot;
print time.mktime(time.strptime(a,&amp;quot;%a %b %d %H:%M:%S %Y&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Python中时间日期格式化符号&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;%y 两位数的年份表示（00-99）&lt;/li&gt;
&lt;li&gt;%Y 四位数的年份表示（000-9999）&lt;/li&gt;
&lt;li&gt;%m 月份（01-12）&lt;/li&gt;
&lt;li&gt;%d 月内中的一天（0-31）&lt;/li&gt;
&lt;li&gt;%H 24小时制小时数（0-23）&lt;/li&gt;
&lt;li&gt;%I 12小时制小时数（01-12）&lt;/li&gt;
&lt;li&gt;%M 分钟数（00=59）&lt;/li&gt;
&lt;li&gt;%S 秒（00-59）&lt;/li&gt;
&lt;li&gt;%a 本地简化星期名称&lt;/li&gt;
&lt;li&gt;%A 本地完整星期名称&lt;/li&gt;
&lt;li&gt;%b 本地简化的月份名称&lt;/li&gt;
&lt;li&gt;%B 本地完整的月份名称&lt;/li&gt;
&lt;li&gt;%c 本地相应的日期表示和时间表示&lt;/li&gt;
&lt;li&gt;%j 年内的一天（001-366）&lt;/li&gt;
&lt;li&gt;%p 本地A.M.或P.M.的等价符&lt;/li&gt;
&lt;li&gt;%U 一年中的星期数（00-53）星期天为星期的开始&lt;/li&gt;
&lt;li&gt;%w 星期（0-6），星期天为星期的开始&lt;/li&gt;
&lt;li&gt;%W 一年中的星期数（00-53）星期一为星期的开始&lt;/li&gt;
&lt;li&gt;%x 本地相应的日期表示&lt;/li&gt;
&lt;li&gt;%X 本地相应的时间表示&lt;/li&gt;
&lt;li&gt;%Z 当前时区的名称&lt;/li&gt;
&lt;li&gt;%% %号本身&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;获取某月日历&#34;&gt;获取某月日历&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Calendar模块有很广泛的方法用来处理年历和月历，例如打印某月的月历。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/usr/bin/python
# -*- coding: UTF-8 -*-

import calendar

cal = calendar.month(2016, 1)
print &amp;quot;以下输出2016年1月份的日历:&amp;quot;
print cal;
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;其他相关模块和函数&#34;&gt;其他相关模块和函数&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;在Python中，其他处理日期和时间的模块还有:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;datetime模块&lt;/li&gt;
&lt;li&gt;pytz模块&lt;/li&gt;
&lt;li&gt;dateutil模块&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;二python函数&#34;&gt;二、Python函数&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;函数是组织好的，可重复使用的，用来实现单一，或相关联功能的代码段。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;函数能提高应用的模块性，和代码的重复利用率。Python提供了许多内建函数，比如print()。也可以自己创建函数，这被叫做用户自定义函数。&lt;/p&gt;
&lt;h3 id=&#34;一定义一个函数&#34;&gt;（一）定义一个函数&lt;/h3&gt;
&lt;p&gt;可以定义一个由自己想要功能的函数，以下是简单的规则：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;函数代码块以 def 关键词开头，后接函数标识符名称和圆括号()。&lt;/li&gt;
&lt;li&gt;任何传入参数和自变量必须放在圆括号中间。圆括号之间可以用于定义参数。&lt;/li&gt;
&lt;li&gt;函数的第一行语句可以选择性地使用文档字符串—用于存放函数说明。&lt;/li&gt;
&lt;li&gt;函数内容以冒号起始，并且缩进。&lt;/li&gt;
&lt;li&gt;return [表达式] 结束函数，选择性地返回一个值给调用方。不带表达式的return相当于返回 None。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;语法&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;def functionname( parameters ):
   &amp;quot;函数_文档字符串&amp;quot;
   function_suite
   return [expression]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;默认情况下，参数值和参数名称是按函数声明中定义的的顺序匹配起来的。&lt;/p&gt;
&lt;h3 id=&#34;二函数调用&#34;&gt;（二）函数调用&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;定义一个函数只给了函数一个名称，指定了函数里包含的参数，和代码块结构。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这个函数的基本结构完成以后，可以通过另一个函数调用执行，也可以直接从Python提示符执行。&lt;/p&gt;
&lt;h3 id=&#34;三参数传递&#34;&gt;（三）参数传递&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;在 python 中，类型属于对象，变量是没有类型的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;a=[1,2,3]
a=&amp;quot;Runoob&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;[1,2,3] 是 List 类型，&amp;quot;Runoob&amp;quot; 是 String 类型，而变量 a 是没有类型，她仅仅是一个对象的引用（一个指针），可以是 List 类型对象，也可以指向 String 类型对象。&lt;/p&gt;
&lt;h4 id=&#34;可更改mutable与不可更改immutable对象&#34;&gt;可更改(mutable)与不可更改(immutable)对象&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;在 python 中，字符串, 元组, 和 数字 是不可更改的对象，而 列表,字典 等则是可以修改的对象。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;不可变类型：变量赋值 a=5 后再赋值 a=10，这里实际是新生成一个 int 值对象 10，再让 a 指向它，而 5 被丢弃，不是改变a的值，相当于新生成了a。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可变类型：变量赋值 la=[1,2,3,4] 后再赋值 la[2]=5 则是将 list la 的第三个元素值更改，本身la没有动，只是其内部的一部分值被修改了。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;python 函数的参数传递：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;不可变类型：类似 c++ 的值传递，如 整数、字符串、元组。如fun（a），传递的只是a的值，没有影响a对象本身。比如在 fun（a）内部修改 a 的值，只是修改另一个复制的对象，不会影响 a 本身。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可变类型：类似 c++ 的引用传递，如 列表，字典。如 fun（la），则是将 la 真正的传过去，修改后fun外部的la也会受影响&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;python 中一切都是对象，严格意义我们不能说值传递还是引用传递，我们应该说传不可变对象和传可变对象。&lt;/p&gt;
&lt;h3 id=&#34;四参数&#34;&gt;（四）参数&lt;/h3&gt;
&lt;p&gt;调用函数时可使用的正式参数类型：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;必备参数&lt;/li&gt;
&lt;li&gt;关键字参数&lt;/li&gt;
&lt;li&gt;默认参数&lt;/li&gt;
&lt;li&gt;不定长参数&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;必备参数&#34;&gt;必备参数&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;必备参数须以正确的顺序传入函数。调用时的数量必须和声明时的一样。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;关键字参数&#34;&gt;关键字参数&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;关键字参数和函数调用关系紧密，函数调用使用关键字参数来确定传入的参数值。
使用关键字参数允许函数调用时参数的顺序与声明时不一致，因为 Python 解释器能够用参数名匹配参数值。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;缺省参数&#34;&gt;缺省参数&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;调用函数时，缺省参数的值如果没有传入，则被认为是默认值。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;不定长参数&#34;&gt;不定长参数&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;可能需要一个函数能处理比当初声明时更多的参数，这些参数叫做不定长参数，声明时不会命名。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;基本语法如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;def functionname([formal_args,] *var_args_tuple ):
   &amp;quot;函数_文档字符串&amp;quot;
   function_suite
   return [expression]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;加了星号（*）的变量名会存放所有未命名的变量参数。选择不多传参数也可。&lt;/p&gt;
&lt;h3 id=&#34;五匿名函数&#34;&gt;（五）匿名函数&lt;/h3&gt;
&lt;p&gt;python 使用 lambda 来创建匿名函数&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lambda只是一个表达式，函数体比def简单很多。&lt;/li&gt;
&lt;li&gt;lambda的主体是一个表达式，而不是一个代码块。仅仅能在lambda表达式中封装有限的逻辑进去。&lt;/li&gt;
&lt;li&gt;lambda函数拥有自己的命名空间，且不能访问自有参数列表之外或全局命名空间里的参数。&lt;/li&gt;
&lt;li&gt;虽然lambda函数看起来只能写一行，却不等同于C++的内联函数，后者的目的是调用小函数时不占用栈内存从而增加运行效率。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;语法-1&#34;&gt;语法&lt;/h4&gt;
&lt;p&gt;lambda函数的语法只包含一个语句，如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;lambda [arg1 [,arg2,.....argn]]:expression
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;六return语句&#34;&gt;（六）return语句&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;return语句[表达式]退出函数，选择性地向调用方返回一个表达式。不带参数值的return语句返回None。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;七变量作用域&#34;&gt;（七）变量作用域&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;一个程序的所有的变量并不是在哪个位置都可以访问的。访问权限决定于这个变量是在哪里赋值的。
变量的作用域决定了在哪一部分程序你可以访问哪个特定的变量名称。两种最基本的变量作用域如下：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;全局变量&lt;/li&gt;
&lt;li&gt;局部变量&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;定义在函数内部的变量拥有一个局部作用域，定义在函数外的拥有全局作用域。
局部变量只能在其被声明的函数内部访问，而全局变量可以在整个程序范围内访问。调用函数时，所有在函数内声明的变量名称都将被加入到作用域中。&lt;/p&gt;
&lt;p&gt;全局变量想作用于函数内，需加 global修饰
1、global---将变量定义为全局变量。可以通过定义为全局变量，实现在函数内部改变变量值。
2、一个global语句可以同时定义多个变量，如 global x, y, z。&lt;/p&gt;
&lt;h1 id=&#34;三模块&#34;&gt;三、模块&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Python 模块(Module)，是一个 Python 文件，以 .py 结尾，包含了 Python 对象定义和Python语句。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;模块能够有逻辑地组织Python代码段，把相关的代码分配到一个模块里能让代码更好用，更易懂。&lt;/p&gt;
&lt;p&gt;模块能定义函数，类和变量，模块里也能包含可执行的代码。&lt;/p&gt;
&lt;h3 id=&#34;import语句&#34;&gt;import语句&lt;/h3&gt;
&lt;p&gt;模块定义好后，我们可以使用 import 语句来引入模块，语法如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;import module1[, module2[,... moduleN]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;要引用模块 math，就可以在文件最开始的地方用 import math 来引入。在调用 math 模块中的函数时，必须这样引用：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;module_name.function_name
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;当解释器遇到 import 语句，如果模块在当前的搜索路径就会被导入。
搜索路径是一个解释器会先进行搜索的所有目录的列表。如想要导入模块 support.py，需要把命令放在脚本的顶端。&lt;/p&gt;
&lt;p&gt;一个模块只会被导入一次，不管执行了多少次import。这样可以防止导入模块被一遍又一遍地执行。&lt;/p&gt;
&lt;h3 id=&#34;fromimport-语句&#34;&gt;From…import 语句&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Python 的 from 语句从模块中导入一个指定的部分到当前命名空间中。
语法如下：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;from modname import name1[, name2[, ... nameN]]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;要导入模块 fib 的 fibonacci 函数，使用如下语句：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;from fib import fibonacci
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个声明不会把整个 fib 模块导入到当前的命名空间中，它只会将 fib 里的 fibonacci 单个引入到执行这个声明的模块的全局符号表。&lt;/p&gt;
&lt;h3 id=&#34;fromimport-语句-1&#34;&gt;From…import* 语句&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;把一个模块的所有内容全都导入到当前的命名空间也是可行的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;只需使用如下声明：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;from modname import *
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这提供了一个简单的方法来导入一个模块中的所有项目。然而这种声明不该被过多地使用。
例如我们想一次性引入 math 模块中所有的东西，语句如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;from math import * 
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;搜索路径&#34;&gt;搜索路径&lt;/h3&gt;
&lt;p&gt;当导入一个模块，Python 解析器对模块位置的搜索顺序是：
1、当前目录
2、如果不在当前目录，Python 则搜索在 shell 变量 PYTHONPATH 下的每个目录。
3、如果都找不到，Python会查看默认路径。UNIX下，默认路径一般为/usr/local/lib/python/。&lt;/p&gt;
&lt;p&gt;模块搜索路径存储在 system 模块的 sys.path 变量中。变量里包含当前目录，PYTHONPATH和由安装过程决定的默认目录。&lt;/p&gt;
&lt;h4 id=&#34;pythonpath-变量&#34;&gt;PYTHONPATH 变量&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;作为环境变量，PYTHONPATH 由装在一个列表里的许多目录组成。PYTHONPATH 的语法和 shell 变量 PATH 的一样。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在 Windows 系统，典型的 PYTHONPATH 如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set PYTHONPATH=c:\python27\lib;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在 UNIX 系统，典型的 PYTHONPATH 如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set PYTHONPATH=/usr/local/lib/python
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;命名空间和作用域&#34;&gt;命名空间和作用域&lt;/h4&gt;
&lt;p&gt;变量是拥有匹配对象的名字（标识符）。命名空间是一个包含了变量名称（键）和它们各自相应的对象（值）的字典。&lt;/p&gt;
&lt;p&gt;一个 Python 表达式可以访问局部命名空间和全局命名空间里的变量。如果一个局部变量和一个全局变量重名，则局部变量会覆盖全局变量。&lt;/p&gt;
&lt;p&gt;每个函数都有自己的命名空间。类的方法的作用域规则和通常函数的一样。&lt;/p&gt;
&lt;p&gt;Python 会智能地猜测一个变量是局部的还是全局的，它假设任何在函数内赋值的变量都是局部的。
因此，如果要给函数内的全局变量赋值，必须使用 global 语句。&lt;/p&gt;
&lt;p&gt;global VarName 的表达式会告诉 Python， VarName 是一个全局变量，这样 Python 就不会在局部命名空间里寻找这个变量了。&lt;/p&gt;
&lt;h3 id=&#34;dir函数&#34;&gt;dir()函数&lt;/h3&gt;
&lt;p&gt;dir() 函数一个排好序的字符串列表，内容是一个模块里定义过的名字。
返回的列表容纳了在一个模块里定义的所有模块，变量和函数。如下一个简单的实例：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/usr/bin/python
# -*- coding: UTF-8 -*-
 
# 导入内置math模块
import math
 
content = dir(math)
 
print content;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;以上实例输出结果：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[&#39;__doc__&#39;, &#39;__file__&#39;, &#39;__name__&#39;, &#39;acos&#39;, &#39;asin&#39;, &#39;atan&#39;, 
&#39;atan2&#39;, &#39;ceil&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;degrees&#39;, &#39;e&#39;, &#39;exp&#39;, 
&#39;fabs&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;frexp&#39;, &#39;hypot&#39;, &#39;ldexp&#39;, &#39;log&#39;,
&#39;log10&#39;, &#39;modf&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;radians&#39;, &#39;sin&#39;, &#39;sinh&#39;, 
&#39;sqrt&#39;, &#39;tan&#39;, &#39;tanh&#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在这里，特殊字符串变量__name__指向模块的名字，__file__指向该模块的导入文件名。&lt;/p&gt;
&lt;h3 id=&#34;globals-和-locals-函数&#34;&gt;globals() 和 locals() 函数&lt;/h3&gt;
&lt;p&gt;根据调用位置的不同，globals() 和 locals() 函数可被用来返回全局和局部命名空间里的名字。
如果在函数内部调用 locals()，返回的是所有能在该函数里访问的命名。
如果在函数内部调用 globals()，返回的是所有在该函数里能访问的全局名字。
两个函数的返回类型都是字典。所以名字能用 keys() 函数获取。&lt;/p&gt;
&lt;h3 id=&#34;reload函数&#34;&gt;reload()函数&lt;/h3&gt;
&lt;p&gt;当一个模块被导入到一个脚本，模块顶层部分的代码只会被执行一次。
因此，如果你想重新执行模块里顶层部分的代码，可以用 reload() 函数。该函数会重新导入之前导入过的模块。语法如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;reload(module_name) # 在这里，module_name要直接放模块的名字，而不是一个字符串形式
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;python中的包&#34;&gt;Python中的包&lt;/h3&gt;
&lt;p&gt;包是一个分层次的文件目录结构，它定义了一个由模块及子包，和子包下的子包等组成的 Python 的应用环境。&lt;/p&gt;
&lt;p&gt;简单来说，包就是文件夹，但该文件夹下必须存在 &lt;strong&gt;init&lt;/strong&gt;.py 文件, 该文件的内容可以为空。&lt;strong&gt;int&lt;/strong&gt;.py用于标识当前文件夹是一个包。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 中的数据类型</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-data-type/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-data-type/</guid>
                <pubDate>Mon, 18 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Python 语言中的数据类型。&lt;/p&gt;
&lt;h3 id=&#34;python变量类型&#34;&gt;Python变量类型&lt;/h3&gt;
&lt;p&gt;变量存储在内存中的值。这就意味着在创建变量时会在内存中开辟一个空间。&lt;/p&gt;
&lt;p&gt;基于变量的数据类型，解释器会分配指定内存，并决定什么数据可以被存储在内存中。&lt;/p&gt;
&lt;p&gt;因此，变量可以指定不同的数据类型，这些变量可以存储整数，小数或字符。&lt;/p&gt;
&lt;h3 id=&#34;变量赋值&#34;&gt;变量赋值&lt;/h3&gt;
&lt;p&gt;Python 中的变量赋值不需要类型声明。&lt;/p&gt;
&lt;p&gt;每个变量在内存中创建，都包括变量的标识，名称和数据这些信息。&lt;/p&gt;
&lt;p&gt;每个变量在使用前都必须赋值，变量赋值以后该变量才会被创建。&lt;/p&gt;
&lt;p&gt;等号（=）用来给变量赋值。&lt;/p&gt;
&lt;p&gt;等号（=）运算符左边是一个变量名,等号（=）运算符右边是存储在变量中的值。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/env
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
counter = 100 # 赋值整型变量
miles = 1000.0 # 浮点型
name = &amp;#34;John&amp;#34; # 字符串
 
print counter
print miles
print name
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;多个变量赋值&#34;&gt;多个变量赋值&lt;/h3&gt;
&lt;p&gt;Python 允许你同时为多个变量赋值。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;a = b = c = 1 # 创建一个整型对象，值为1，三个变量被分配到相同的内存空间上。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以为多个对象指定多个变量。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;a, b, c = 1, 2, &amp;#34;john&amp;#34; # 两个整型对象1和2分别分配给变量 a 和 b，字符串对象 &amp;#34;john&amp;#34; 分配给变量 c。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;标准数据类型&#34;&gt;标准数据类型&lt;/h3&gt;
&lt;p&gt;在内存中存储的数据可以有多种类型。Python定义了一些标准类型，用于存储各种类型的数据。&lt;/p&gt;
&lt;p&gt;Python有五个标准的数据类型：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Numbers（数字）&lt;/li&gt;
&lt;li&gt;String（字符串）&lt;/li&gt;
&lt;li&gt;List（列表）&lt;/li&gt;
&lt;li&gt;Tuple（元组）&lt;/li&gt;
&lt;li&gt;Dictionary（字典）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;python 的所有数据类型都是类,可以通过 type() 查看该变量的数据类型。&lt;/p&gt;
&lt;h5 id=&#34;数字&#34;&gt;数字&lt;/h5&gt;
&lt;p&gt;数字数据类型用于存储数值，不可改变的数据类型，这意味着改变数字数据类型会分配一个新的对象。&lt;/p&gt;
&lt;p&gt;当你指定一个值时，Number对象就会被创建，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;var_a = 1
var_b = 12
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以通过使用del语句删除单个或多个对象的引用，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;del var
del var_a, var_b
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Python支持四种不同的数字类型：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;int（有符号整型），通常被称为是整型或整数，是正或负整数，不带小数点。&lt;/li&gt;
&lt;li&gt;long（长整型[也可以代表八进制和十六进制]），无限大小的整数，整数最后是一个大写或小写的L。&lt;/li&gt;
&lt;li&gt;float（浮点型），浮点型由整数部分与小数部分组成，浮点型也可以使用科学计数法表示。&lt;/li&gt;
&lt;li&gt;complex（复数），复数由实数部分和虚数部分构成，可以用a + bj,或者complex(a,b)表示， 复数的实部a和虚部b都是浮点型。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注意：&lt;/p&gt;
&lt;p&gt;1、长整型也可以使用小写&amp;quot;l&amp;quot;，建议使用大写&amp;quot;L&amp;quot;，避免与数字&amp;quot;1&amp;quot;混淆。Python使用&amp;quot;L&amp;quot;来显示长整型。&lt;/p&gt;
&lt;p&gt;2、Python还支持复数，复数由实数部分和虚数部分构成，可以&lt;code&gt;用a + bj&lt;/code&gt;,或者&lt;code&gt;complex(a,b)&lt;/code&gt;表示， 复数的实部a和虚部b都是&lt;code&gt;浮点型&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&#34;字符串&#34;&gt;字符串&lt;/h4&gt;
&lt;p&gt;字符串或串(String)是由数字、字母、下划线组成的一串字符。&lt;/p&gt;
&lt;p&gt;一般记为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;s=&amp;#34;a1a2···an&amp;#34;(n&amp;gt;=0) 是编程语言中表示文本的数据类型。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;python的字串列表有2种取值顺序：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;从左到右索引，默认从0开始，最大范围是字符串长度-1；&lt;/li&gt;
&lt;li&gt;从右到左索引，默认从-1开始，最大范围是字符串开头；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Python不支持单字符类型，单字符也在Python也是作为一个字符串使用。&lt;/p&gt;
&lt;p&gt;如果要实现从字符串中获取一段子字符串的话，可以使用变量[头下标:尾下标]，就可以截取相应的字符串，其中下标是从0开始算起，可以是正数或负数，下标可以为空表示取到头或尾。
例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;s = &amp;#39;ilovepython&amp;#39;，则s[1:5]的结果为：love，取到的最大范围包括下边界、不包括上边界。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;当使用以冒号分隔的字符串，python返回一个新的对象，结果包含了以这对偏移标识的连续的内容，左边的开始是包含了下边界。&lt;/p&gt;
&lt;p&gt;加号（+）是字符串连接运算符，星号（*）是重复操作。&lt;/p&gt;
&lt;h4 id=&#34;字符串格式化&#34;&gt;字符串格式化&lt;/h4&gt;
&lt;p&gt;Python 支持格式化字符串的输出 。尽管这样可能会用到非常复杂的表达式，但最基本的用法是将一个值插入到一个有字符串格式符 %s 的字符串中。&lt;/p&gt;
&lt;p&gt;在 Python 中，字符串格式化使用与 C 中 sprintf 函数一样的语法。
如下示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
print &amp;#34;My name is %s and weight is %d kg!&amp;#34; % (&amp;#39;Zara&amp;#39;, 21) 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;输出结果为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;My name is Zara and weight is 21 kg!
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;python字符串格式化符号&#34;&gt;Python字符串格式化符号&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;符号&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;%c&lt;/td&gt;
&lt;td&gt;格式化字符及其ASCII码&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%s&lt;/td&gt;
&lt;td&gt;格式化字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%d&lt;/td&gt;
&lt;td&gt;格式化整数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%u&lt;/td&gt;
&lt;td&gt;格式化无符号整型&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%o&lt;/td&gt;
&lt;td&gt;格式化无符号八进制数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%x&lt;/td&gt;
&lt;td&gt;格式化无符号十六进制数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%X&lt;/td&gt;
&lt;td&gt;格式化无符号十六进制数（大写）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%f&lt;/td&gt;
&lt;td&gt;格式化浮点数字，可指定小数点后的精度&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%e&lt;/td&gt;
&lt;td&gt;用科学计数法格式化浮点数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%E&lt;/td&gt;
&lt;td&gt;作用同%e，用科学计数法格式化浮点数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%g&lt;/td&gt;
&lt;td&gt;%f和%e的简写&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%p&lt;/td&gt;
&lt;td&gt;用十六进制数格式化变量的地址&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%G&lt;/td&gt;
&lt;td&gt;%f 和 %E 的简写&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;python三引号&#34;&gt;Python三引号&lt;/h3&gt;
&lt;p&gt;python中三引号可以将复杂的字符串进行复制:&lt;/p&gt;
&lt;p&gt;python三引号允许一个字符串跨多行，字符串中可以包含换行符、制表符以及其他特殊字符。&lt;/p&gt;
&lt;p&gt;三引号的语法是一对连续的单引号或者双引号（通常都是成对的用）。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;gt;&amp;gt;&amp;gt; hi = &amp;#39;&amp;#39;&amp;#39;hi 
there&amp;#39;&amp;#39;&amp;#39;
&amp;gt;&amp;gt;&amp;gt; hi   # repr()
&amp;#39;hi\nthere&amp;#39;
&amp;gt;&amp;gt;&amp;gt; print hi  # str()
hi 
there  
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;三引号让程序员从引号和特殊字符串的泥潭里面解脱出来，自始至终保持一小块字符串的格式是所谓的WYSIWYG（所见即所得）格式的。&lt;/p&gt;
&lt;p&gt;一个典型的用例是，当你需要一块HTML或者SQL时，这时用字符串组合，特殊字符串转义将会非常的繁琐。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;errHTML = &amp;#39;&amp;#39;&amp;#39;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;HTML&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;HEAD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;TITLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
Friends CGI Demo&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;TITLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;HEAD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BODY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;H3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;ERROR&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;H3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;%s&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;P&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;FORM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;INPUT&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;TYPE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;button&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;VALUE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;Back&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;ONCLICK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;window.history.back()&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;FORM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BODY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;HTML&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&amp;#39;&amp;#39;&amp;#39;
cursor.execute(&amp;#39;&amp;#39;&amp;#39;
CREATE TABLE users (  
login VARCHAR(8), 
uid INTEGER,
prid INTEGER)
&amp;#39;&amp;#39;&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;unicode字符串&#34;&gt;Unicode字符串&lt;/h4&gt;
&lt;p&gt;Python 中定义一个 Unicode 字符串和定义一个普通字符串一样简单：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;gt;&amp;gt;&amp;gt; u&amp;#39;Hello World !&amp;#39;
u&amp;#39;Hello World !&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;引号前小写的&amp;quot;u&amp;quot;表示这里创建的是一个 Unicode 字符串。如果你想加入一个特殊字符，可以使用 Python 的 Unicode-Escape 编码。如下例所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;gt;&amp;gt;&amp;gt; u&amp;#39;Hello\u0020World !&amp;#39;
u&amp;#39;Hello World !&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;被替换的 \u0020 标识表示在给定位置插入编码值为 0x0020 的 Unicode 字符（空格符）。&lt;/p&gt;
&lt;h4 id=&#34;列表&#34;&gt;列表&lt;/h4&gt;
&lt;p&gt;List（列表） 是 Python 中使用最频繁的数据类型。&lt;/p&gt;
&lt;p&gt;列表可以完成大多数集合类的数据结构实现。它支持字符，数字，字符串甚至可以包含列表（即嵌套）。&lt;/p&gt;
&lt;p&gt;列表用 [ ] 标识，是 python 最通用的复合数据类型，列表是允许更新的。
一个列表如下所示：
list = [ &#39;runoob&#39;, 786 , 2.23, &#39;john&#39;, 70.2 ]&lt;/p&gt;
&lt;p&gt;列表中值的切割也可以用到变量 [头下标:尾下标] ，就可以截取相应的列表，从左到右索引默认 0 开始，从右到左索引默认 -1 开始，下标可以为空表示取到头或尾。&lt;/p&gt;
&lt;p&gt;加号 + 是列表连接运算符，星号 * 是重复操作。&lt;/p&gt;
&lt;p&gt;Python已经内置确定序列的长度以及确定最大和最小的元素的方法，列表的数据项不需要具有相同的类型。&lt;/p&gt;
&lt;h4 id=&#34;元组&#34;&gt;元组&lt;/h4&gt;
&lt;p&gt;元组（tuple）是另一个数据类型，类似于List（列表）。&lt;/p&gt;
&lt;p&gt;元组用&amp;quot;()&amp;quot;标识。内部元素用逗号隔开。但是元组不能二次赋值，相当于只读列表，元组是不允许更新的。&lt;/p&gt;
&lt;p&gt;一个元组如下所示：
tuple = ( &#39;runoob&#39;, 786 , 2.23, &#39;john&#39;, 70.2 )&lt;/p&gt;
&lt;h4 id=&#34;无关闭分隔符&#34;&gt;无关闭分隔符&lt;/h4&gt;
&lt;p&gt;任意无符号的对象，以逗号隔开，默认为元组，如下示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
print &amp;#39;abc&amp;#39;, -4.24e93, 18+6.6j, &amp;#39;xyz&amp;#39;;
x, y = 1, 2;
print &amp;#34;Value of x , y : &amp;#34;, x,y;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;运行的结果为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;abc -4.24e+93 (18+6.6j) xyz
Value of x , y : 1 2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;字典&#34;&gt;字典&lt;/h4&gt;
&lt;p&gt;字典（dictionary）是除列表（List）以外python之中最灵活的内置数据结构类型，是无序的对象集合。&lt;/p&gt;
&lt;p&gt;字典（directory）与列表（list）之间的区别在于：字典当中的元素是通过键来存取的，而不是通过偏移存取。&lt;/p&gt;
&lt;p&gt;字典是另一种可变容器模型，且可存储任意类型对象。&lt;/p&gt;
&lt;p&gt;字典用 &lt;code&gt;{ }&lt;/code&gt; 标识，字典由索引(key)和它对应的值value组成，字典的每个键值(key=&amp;gt;value)对用冒号(:)分割，每个对之间用逗号(,)分割，整个字典包括在花括号({})中，格式如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;d = {key1:value1, key2:value2, key3:value3}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;键必须是唯一的，但值则不必。值可以取任何数据类型，但键必须是不可变的，如字符串，数字或元组。&lt;/p&gt;
&lt;p&gt;一个字典如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;dict = {&amp;#39;name&amp;#39;:&amp;#39;john&amp;#39;, &amp;#39;code&amp;#39;:6734, &amp;#39;dept&amp;#39;:&amp;#39;sales&amp;#39;}
或
dict = {&amp;#39;abc&amp;#39;:456}
或
dict = {&amp;#39;abc&amp;#39;:123, 98.6:23}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;字典值可以没有限制地取任何python对象，既可以是标准的对象，也可以是用户定义的，但键不行。&lt;/p&gt;
&lt;p&gt;1、不允许同一个键出现两次。创建时如果同一个键被赋值两次，后一个值会被记住。&lt;/p&gt;
&lt;p&gt;2、由于键必须不可变，所以可以用数字、字符串或元组充当，用列表就不行，&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 中的文件和输入输出流</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-file-and-directory/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-file-and-directory/</guid>
                <pubDate>Mon, 18 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Python 语言中的文件和输入输出流。&lt;/p&gt;
&lt;h3 id=&#34;文件io&#34;&gt;文件I/O&lt;/h3&gt;
&lt;p&gt;基本的的I/O函数&lt;/p&gt;
&lt;h4 id=&#34;打印到屏幕&#34;&gt;打印到屏幕&lt;/h4&gt;
&lt;p&gt;最简单的输出方法是用print语句，可以给它传递零个或多个用逗号隔开的表达式。此函数把传递的表达式转换成一个字符串表达式，并将结果写到标准输出。&lt;/p&gt;
&lt;h4 id=&#34;读取键盘输入&#34;&gt;读取键盘输入&lt;/h4&gt;
&lt;p&gt;Python提供了两个内置函数从标准输入读入一行文本，默认的标准输入是键盘。如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;raw_input&lt;/li&gt;
&lt;li&gt;input&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;raw_input函数&#34;&gt;raw_input函数&lt;/h4&gt;
&lt;p&gt;raw_input([prompt]) 函数从标准输入读取一个行，并返回一个字符串（去掉结尾的换行符）：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*- 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
xdhuxc = raw_input(&amp;#34;请输入：&amp;#34;);
print &amp;#34;输入的内容是: &amp;#34;, xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将提示输入任意字符串，然后在屏幕上显示相同的字符串。当输入&amp;quot;Hello Python！&amp;quot;，它的输出如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;请输入：Hello Python！
输入的内容是:  Hello Python！
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;input-函数&#34;&gt;input 函数&lt;/h4&gt;
&lt;p&gt;input([prompt]) 函数和 raw_input([prompt]) 函数基本类似，但是 input 可以接收一个Python表达式作为输入，并将运算结果返回。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*- 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
xdhuxc = input(&amp;#34;请输入：&amp;#34;);
print &amp;#34;输入的内容是: &amp;#34;, xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;会产生如下的对应着输入的结果：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;请输入：[x*5 for x in range(2,10,2)]
输入的内容是:  [10, 20, 30, 40]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;打开和关闭文件&#34;&gt;打开和关闭文件&lt;/h3&gt;
&lt;p&gt;Python 提供了必要的函数和方法进行默认情况下的文件基本操作。可以用 file 对象做大部分的文件操作。&lt;/p&gt;
&lt;h4 id=&#34;open-函数&#34;&gt;open 函数&lt;/h4&gt;
&lt;p&gt;必须先用Python内置的open()函数打开一个文件，创建一个file对象，相关的方法才可以调用它进行读写。语法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;file object = open(file_name [, access_mode][, buffering])
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;各个参数的含义如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;file_name：file_name变量是一个包含了你要访问的文件名称的字符串值。&lt;/li&gt;
&lt;li&gt;access_mode：access_mode决定了打开文件的模式：只读，写入，追加等。所有可取值见如下的完全列表。这个参数是非强制的，默认文件访问模式为只读(r)。&lt;/li&gt;
&lt;li&gt;buffering：如果buffering的值被设为0，就不会有寄存。如果buffering的值取1，访问文件时会寄存行。如果将buffering的值设为大于1的整数，表明了这就是的寄存区的缓冲大小。如果取负值，寄存区的缓冲大小则为系统默认。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;不同模式打开文件的完全列表：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;模式&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;r&lt;/td&gt;
&lt;td&gt;以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;rb&lt;/td&gt;
&lt;td&gt;以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;r+&lt;/td&gt;
&lt;td&gt;打开一个文件用于读写。文件指针将会放在文件的开头。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;rb+&lt;/td&gt;
&lt;td&gt;以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;W&lt;/td&gt;
&lt;td&gt;打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;wb&lt;/td&gt;
&lt;td&gt;以二进制格式打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;w+&lt;/td&gt;
&lt;td&gt;打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;wb+&lt;/td&gt;
&lt;td&gt;以二进制格式打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;a&lt;/td&gt;
&lt;td&gt;打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ab&lt;/td&gt;
&lt;td&gt;以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;a+&lt;/td&gt;
&lt;td&gt;打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ab+&lt;/td&gt;
&lt;td&gt;以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;file-对象的属性&#34;&gt;File 对象的属性&lt;/h3&gt;
&lt;p&gt;一个文件被打开后，你有一个file对象，你可以得到有关该文件的各种信息。&lt;/p&gt;
&lt;p&gt;file对象相关的所有属性的列表&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;属性&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;file.closed&lt;/td&gt;
&lt;td&gt;返回true如果文件已被关闭，否则返回false&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;file.mode&lt;/td&gt;
&lt;td&gt;返回被打开文件的访问模式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;file.name&lt;/td&gt;
&lt;td&gt;返回文件的名称&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;file.softspace&lt;/td&gt;
&lt;td&gt;如果用print输出后，必须跟一个空格符，则返回false。否则返回true&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;close-方法&#34;&gt;close() 方法&lt;/h4&gt;
&lt;p&gt;File 对象的 close()方法刷新缓冲区里任何还没写入的信息，并关闭该文件，这之后便不能再进行写入。&lt;/p&gt;
&lt;p&gt;当一个文件对象的引用被重新指定给另一个文件时，Python 会关闭之前的文件。用 close()方法关闭文件是一个很好的习惯。其语法为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;fileObject.close()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;读写文件&#34;&gt;读写文件&lt;/h4&gt;
&lt;p&gt;file 对象提供了一系列方法，能让文件访问更轻松。使用 &lt;code&gt;read()&lt;/code&gt; 和 &lt;code&gt;write()&lt;/code&gt; 方法来读取和写入文件。&lt;/p&gt;
&lt;h4 id=&#34;write方法&#34;&gt;write()方法&lt;/h4&gt;
&lt;p&gt;write()方法可将任何字符串写入一个打开的文件。需要重点注意的是，Python字符串可以是二进制数据，而不是仅仅是文字。&lt;/p&gt;
&lt;p&gt;write() 方法不会在字符串的结尾添加换行符 &lt;code&gt;&#39;\n&#39;&lt;/code&gt;，其语法为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;fileObject.write(string) # 在这里，被传递的参数是要写入到已打开文件的内容
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;read方法&#34;&gt;read()方法&lt;/h4&gt;
&lt;p&gt;read()方法从一个打开的文件中读取一个字符串。需要重点注意的是，Python字符串可以是二进制数据，而不是仅仅是文字。其语法为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;fileObject.read([count]) # 在这里，被传递的参数是要从已打开文件中读取的字节计数。该方法从文件的开头开始读入，如果没有传入count，它会尝试尽可能多地读取更多的内容，很可能是直到文件的末尾。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;重命名和删除文件&#34;&gt;重命名和删除文件&lt;/h4&gt;
&lt;p&gt;Python 的 os 模块提供了执行文件处理操作的方法，比如重命名和删除文件。&lt;/p&gt;
&lt;p&gt;要使用这个模块，你必须先导入它，然后才可以调用相关的各种功能&lt;/p&gt;
&lt;p&gt;rename()方法需要两个参数，当前的文件名和新文件名。其语法格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;os.rename(current_file_name, new_file_name)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以用remove()方法删除文件，需要提供要删除的文件名作为参数。其语法格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;os.remove(file_name)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;目录&#34;&gt;目录&lt;/h3&gt;
&lt;p&gt;所有文件都包含在各个不同的目录下，不过 Python 也能轻松处理。os 模块有许多方法能帮你创建，删除和更改目录。&lt;/p&gt;
&lt;p&gt;可以使用 os 模块的 mkdir() 方法在当前目录下创建新的目录。需要提供一个包含了要创建的目录名称的参数。其语法格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;os.mkdir(&amp;#34;new_directory_name&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以用 chdir() 方法来改变当前的目录。chdir() 方法需要的一个参数是你想设成当前目录的目录名称。其语法格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;os.chdir(&amp;#34;new_directory_name&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;getcwd() 方法显示当前的工作目录。其语法格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;os.getcwd()
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;rmdir() 方法删除目录，目录名称以参数传递。在删除这个目录之前，它的所有内容应该先被清除。其语法格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;os.rmdir(&amp;#34;directory_name&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;目录的完全合规的名称必须被给出，否则会在当前目录下搜索该目录。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 发送邮件</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-email/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-email/</guid>
                <pubDate>Mon, 18 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下在 Python 邮件的发送。&lt;/p&gt;
&lt;h3 id=&#34;发送邮件&#34;&gt;发送邮件&lt;/h3&gt;
&lt;p&gt;python的smtplib提供了一种很方便的途径发送电子邮件。它对smtp协议进行了简单的封装。&lt;/p&gt;
&lt;p&gt;Python创建SMTP 对象语法如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;import smtplib

smtpObj = smtplib.SMTP( [host [, port [, local_hostname]]] )
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;host: SMTP 服务器主机。 你可以指定主机的ip地址或者域名如: xdhuxc.com，这个是可选参数。&lt;/li&gt;
&lt;li&gt;port: 如果你提供了 host 参数, 你需要指定 SMTP 服务使用的端口号，一般情况下 SMTP 端口号为25。&lt;/li&gt;
&lt;li&gt;local_hostname: 如果 SMTP 在你的本机上，你只需要指定服务器地址为 localhost 即可。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Python SMTP 对象使用 sendmail 方法发送邮件，语法如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;SMTP.sendmail(from_addr, to_addrs, msg[, mail_options, rcpt_options]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;from_addr: 邮件发送者地址。&lt;/li&gt;
&lt;li&gt;to_addrs: 字符串列表，邮件发送地址。&lt;/li&gt;
&lt;li&gt;msg: 发送消息，msg 是字符串，表示邮件。我们知道邮件一般由标题，发信人，收件人，邮件内容，附件等构成，发送邮件的时候，要注意 msg 的格式。这个格式就是 smtp 协议中定义的格式&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;使用本地邮件服务器&#34;&gt;使用本地邮件服务器&lt;/h4&gt;
&lt;p&gt;执行示例需要本机已安装了支持 SMTP 的服务，如：sendmail。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import smtplib
from email.mime.text import MIMEText
from email.header import Header
 
sender = &amp;#39;xdhuxc@163.com&amp;#39;
receivers = [&amp;#39;xdhuxc@126.com&amp;#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱
 
&lt;span class=&#34;gh&#34;&gt;# 三个参数：第一个为文本内容，第二个 plain 设置文本格式，第三个 utf-8 设置编码
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;message = MIMEText(&amp;#39;Python 邮件发送测试...&amp;#39;, &amp;#39;plain&amp;#39;, &amp;#39;utf-8&amp;#39;)
message[&amp;#39;From&amp;#39;] = Header(&amp;#34;菜鸟教程&amp;#34;, &amp;#39;utf-8&amp;#39;)
message[&amp;#39;To&amp;#39;] =  Header(&amp;#34;测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
 
subject = &amp;#39;Python SMTP 邮件测试&amp;#39;
message[&amp;#39;Subject&amp;#39;] = Header(subject, &amp;#39;utf-8&amp;#39;)
 
 
try:
    smtpObj = smtplib.SMTP(&amp;#39;localhost&amp;#39;)
    smtpObj.sendmail(sender, receivers, message.as_string())
    print &amp;#34;邮件发送成功&amp;#34;
except smtplib.SMTPException:
    print &amp;#34;Error: 无法发送邮件&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用三个引号来设置邮件信息，标准邮件需要三个头部信息： From, To, 和 Subject ，每个信息直接使用空行分割。&lt;/p&gt;
&lt;p&gt;通过实例化 smtplib 模块的 SMTP 对象 smtpObj 来连接到 SMTP 访问，并使用 sendmail 方法来发送信息。&lt;/p&gt;
&lt;p&gt;执行以上程序，如果你本机安装 sendmail（邮件传输代理程序），就会输出：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ python test.py
邮件发送成功
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;使用其他邮件服务商的-smtp-访问qq网易google等&#34;&gt;使用其他邮件服务商的 SMTP 访问（QQ、网易、Google等）。&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import smtplib
from email.mime.text import MIMEText
from email.header import Header
 
&lt;span class=&#34;gh&#34;&gt;# 第三方 SMTP 服务
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;mail_host=&amp;#34;smtp.163.com&amp;#34;  &lt;span class=&#34;ni&#34;&gt;#设置服务器&lt;/span&gt;
mail_user=&amp;#34;XXXX&amp;#34;    &lt;span class=&#34;ni&#34;&gt;#用户名&lt;/span&gt;
mail_pass=&amp;#34;XXXXXX&amp;#34;   &lt;span class=&#34;ni&#34;&gt;#口令&lt;/span&gt; 
 
 
sender = &amp;#39;xdhuxc@163.com&amp;#39;
receivers = [&amp;#39;xdhuxc@126.com&amp;#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱
 
message = MIMEText(&amp;#39;Python 邮件发送测试...&amp;#39;, &amp;#39;plain&amp;#39;, &amp;#39;utf-8&amp;#39;)
message[&amp;#39;From&amp;#39;] = Header(&amp;#34;xdhuxc 测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
message[&amp;#39;To&amp;#39;] =  Header(&amp;#34;测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
 
subject = &amp;#39;Python SMTP 邮件测试&amp;#39;
message[&amp;#39;Subject&amp;#39;] = Header(subject, &amp;#39;utf-8&amp;#39;)
 
 
try:
    smtpObj = smtplib.SMTP() 
    smtpObj.connect(mail_host, 25)    # 25 为 SMTP 端口号
    smtpObj.login(mail_user,mail_pass)  
    smtpObj.sendmail(sender, receivers, message.as_string())
    print &amp;#34;邮件发送成功&amp;#34;
except smtplib.SMTPException:
    print &amp;#34;Error: 无法发送邮件&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;发送html格式的邮件&#34;&gt;发送HTML格式的邮件&lt;/h4&gt;
&lt;p&gt;Python发送HTML格式的邮件与发送纯文本消息的邮件不同之处就是将MIMEText中_subtype设置为html。具体代码如下:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import smtplib
from email.mime.text import MIMEText
from email.header import Header
 
sender = &amp;#39;xdhuxc@163.com&amp;#39;
receivers = [&amp;#39;xdhuxc@126.com&amp;#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱
 
mail_msg = &amp;#34;&amp;#34;&amp;#34;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Python 邮件发送测试...&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://www.xdhuxc.org&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;这是一个链接&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&amp;#34;&amp;#34;&amp;#34;
message = MIMEText(mail_msg, &amp;#39;html&amp;#39;, &amp;#39;utf-8&amp;#39;)
message[&amp;#39;From&amp;#39;] = Header(&amp;#34;xdhuxc 测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
message[&amp;#39;To&amp;#39;] =  Header(&amp;#34;测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
 
subject = &amp;#39;Python SMTP 邮件测试&amp;#39;
message[&amp;#39;Subject&amp;#39;] = Header(subject, &amp;#39;utf-8&amp;#39;)
 
 
try:
    smtpObj = smtplib.SMTP(&amp;#39;localhost&amp;#39;)
    smtpObj.sendmail(sender, receivers, message.as_string())
    print &amp;#34;邮件发送成功&amp;#34;
except smtplib.SMTPException:
    print &amp;#34;Error: 无法发送邮件&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;发送带附件的邮件&#34;&gt;发送带附件的邮件&lt;/h4&gt;
&lt;p&gt;发送带附件的邮件，首先要创建MIMEMultipart()实例，然后构造附件，如果有多个附件，可依次构造，最后利用smtplib.smtp发送。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.header import Header
 
sender = &amp;#39;xdhuxc@163.com&amp;#39;
receivers = [&amp;#39;xdhuxc@126.com&amp;#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱
 
&lt;span class=&#34;gh&#34;&gt;#创建一个带附件的实例
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;message = MIMEMultipart()
message[&amp;#39;From&amp;#39;] = Header(&amp;#34;xdhuxc 测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
message[&amp;#39;To&amp;#39;] =  Header(&amp;#34;测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
subject = &amp;#39;Python SMTP 邮件测试&amp;#39;
message[&amp;#39;Subject&amp;#39;] = Header(subject, &amp;#39;utf-8&amp;#39;)
 
&lt;span class=&#34;gh&#34;&gt;#邮件正文内容
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;message.attach(MIMEText(&amp;#39;这是 xdhuxc 测试Python 邮件发送测试……&amp;#39;, &amp;#39;plain&amp;#39;, &amp;#39;utf-8&amp;#39;))
 
&lt;span class=&#34;gh&#34;&gt;# 构造附件1，传送当前目录下的 test.txt 文件
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;att1 = MIMEText(open(&amp;#39;test.txt&amp;#39;, &amp;#39;rb&amp;#39;).read(), &amp;#39;base64&amp;#39;, &amp;#39;utf-8&amp;#39;)
att1[&amp;#34;Content-Type&amp;#34;] = &amp;#39;application/octet-stream&amp;#39;
&lt;span class=&#34;gh&#34;&gt;# 这里的filename可以任意写，写什么名字，邮件中显示什么名字
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;att1[&amp;#34;Content-Disposition&amp;#34;] = &amp;#39;attachment; filename=&amp;#34;test.txt&amp;#34;&amp;#39;
message.attach(att1)
 
&lt;span class=&#34;gh&#34;&gt;# 构造附件2，传送当前目录下的 xdhuxc.txt 文件
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;att2 = MIMEText(open(&amp;#39;xdhuxc.txt&amp;#39;, &amp;#39;rb&amp;#39;).read(), &amp;#39;base64&amp;#39;, &amp;#39;utf-8&amp;#39;)
att2[&amp;#34;Content-Type&amp;#34;] = &amp;#39;application/octet-stream&amp;#39;
att2[&amp;#34;Content-Disposition&amp;#34;] = &amp;#39;attachment; filename=&amp;#34;xdhuxc.txt&amp;#34;&amp;#39;
message.attach(att2)
 
try:
    smtpObj = smtplib.SMTP(&amp;#39;localhost&amp;#39;)
    smtpObj.sendmail(sender, receivers, message.as_string())
    print &amp;#34;邮件发送成功&amp;#34;
except smtplib.SMTPException:
    print &amp;#34;Error: 无法发送邮件&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;在-html-文本中添加图片&#34;&gt;在 HTML 文本中添加图片&lt;/h4&gt;
&lt;p&gt;邮件的 HTML 文本中一般邮件服务商添加外链是无效的，正确添加突破的实例如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import smtplib
from email.mime.image import MIMEImage
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.header import Header
 
sender = &amp;#39;xdhuxc@163.com&amp;#39;
receivers = [&amp;#39;xdhuxc@126.com&amp;#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱
 
msgRoot = MIMEMultipart(&amp;#39;related&amp;#39;)
msgRoot[&amp;#39;From&amp;#39;] = Header(&amp;#34;xdhuxc 测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
msgRoot[&amp;#39;To&amp;#39;] =  Header(&amp;#34;测试&amp;#34;, &amp;#39;utf-8&amp;#39;)
subject = &amp;#39;Python SMTP 邮件测试&amp;#39;
msgRoot[&amp;#39;Subject&amp;#39;] = Header(subject, &amp;#39;utf-8&amp;#39;)
 
msgAlternative = MIMEMultipart(&amp;#39;alternative&amp;#39;)
msgRoot.attach(msgAlternative)
 
 
mail_msg = &amp;#34;&amp;#34;&amp;#34;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Python 邮件发送测试...&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;href&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://www.xdhuxc.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;xdhuxc 测试链接&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;图片演示：&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;img&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;cid:image1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&amp;#34;&amp;#34;&amp;#34;
msgAlternative.attach(MIMEText(mail_msg, &amp;#39;html&amp;#39;, &amp;#39;utf-8&amp;#39;))
 
&lt;span class=&#34;gh&#34;&gt;# 指定图片为当前目录
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;fp = open(&amp;#39;test.png&amp;#39;, &amp;#39;rb&amp;#39;)
msgImage = MIMEImage(fp.read())
fp.close()
 
&lt;span class=&#34;gh&#34;&gt;# 定义图片 ID，在 HTML 文本中引用
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;msgImage.add_header(&amp;#39;Content-ID&amp;#39;, &amp;#39;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#39;)
msgRoot.attach(msgImage)
 
try:
    smtpObj = smtplib.SMTP(&amp;#39;localhost&amp;#39;)
    smtpObj.sendmail(sender, receivers, msgRoot.as_string())
    print &amp;#34;邮件发送成功&amp;#34;
except smtplib.SMTPException:
    print &amp;#34;Error: 无法发送邮件&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;使用第三方-smtp-服务发送&#34;&gt;使用第三方 SMTP 服务发送&lt;/h4&gt;
&lt;p&gt;使用第三方 SMTP 服务发送邮件，SMTP服务器地址为：smtp.xxx.com，端口为：25&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import smtplib
from email.mime.text import MIMEText
from email.utils import formataddr
 
my_sender=&amp;#39;xdhuxc@126.com&amp;#39;    # 发件人邮箱账号
my_pass = &amp;#39;xxxxxxxxxx&amp;#39;              # 发件人邮箱密码
my_user=&amp;#39;xdhuxc@126.com&amp;#39;      # 收件人邮箱账号，我这边发送给自己
def mail():
    ret=True
    try:
        msg=MIMEText(&amp;#39;填写邮件内容&amp;#39;,&amp;#39;plain&amp;#39;,&amp;#39;utf-8&amp;#39;)
        msg[&amp;#39;From&amp;#39;]=formataddr([&amp;#34;Fromxdhuxc&amp;#34;,my_sender])  # 括号里的对应发件人邮箱昵称、发件人邮箱账号
        msg[&amp;#39;To&amp;#39;]=formataddr([&amp;#34;FK&amp;#34;,my_user])              # 括号里的对应收件人邮箱昵称、收件人邮箱账号
        msg[&amp;#39;Subject&amp;#39;]=&amp;#34;xdhuxc 测试发送邮件测试&amp;#34;                # 邮件的主题，也可以说是标题
 
        server=smtplib.SMTP_SSL(&amp;#34;smtp.qq.com&amp;#34;, 465)  # 发件人邮箱中的SMTP服务器，端口是25
        server.login(my_sender, my_pass)  # 括号中对应的是发件人邮箱账号、邮箱密码
        server.sendmail(my_sender,[my_user,],msg.as_string())  # 括号中对应的是发件人邮箱账号、收件人邮箱账号、发送邮件
        server.quit()  # 关闭连接
    except Exception:  # 如果 try 中的语句没有执行，则会执行下面的 ret=False
        ret=False
    return ret
 
ret=mail()
if ret:
    print(&amp;#34;邮件发送成功&amp;#34;)
else:
    print(&amp;#34;邮件发送失败&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;线程&#34;&gt;线程&lt;/h3&gt;
&lt;p&gt;Python中使用线程有两种方式：函数或者用类来包装线程对象。&lt;/p&gt;
&lt;h4 id=&#34;函数式&#34;&gt;函数式&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;调用thread模块中的start_new_thread()函数来产生新线程。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;语法如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;thread.start_new_thread ( function, args[, kwargs] )
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;参数说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;function - 线程函数。&lt;/li&gt;
&lt;li&gt;args - 传递给线程函数的参数,他必须是个tuple类型。&lt;/li&gt;
&lt;li&gt;kwargs - 可选参数。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;示例：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import thread
import time
 
&lt;span class=&#34;gh&#34;&gt;# 为线程定义一个函数
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;def print_time( threadName, delay):
   count = 0
   while count &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;5:&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delay&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;count&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;1&lt;/span&gt;
      &lt;span class=&#34;na&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;%&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;s:&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;threadName&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ctime&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
 
&lt;span class=&#34;gh&#34;&gt;# 创建两个线程
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;try:&lt;/span&gt;
   &lt;span class=&#34;na&#34;&gt;thread&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;start_new_thread&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;print_time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;(&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Thread-1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
   &lt;span class=&#34;na&#34;&gt;thread&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;start_new_thread&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;print_time&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;(&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Thread-2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;,&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;except:&lt;/span&gt;
   &lt;span class=&#34;na&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;Error:&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;unable&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;start&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;thread&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&amp;#34;&lt;/span&gt;
 
&lt;span class=&#34;na&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;1:&lt;/span&gt;
   &lt;span class=&#34;na&#34;&gt;pass&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;线程的结束一般依靠线程函数的自然结束；也可以在线程函数中调用thread.exit()，他抛出SystemExit exception，达到退出线程的目的。&lt;/p&gt;
&lt;h4 id=&#34;线程模块&#34;&gt;线程模块&lt;/h4&gt;
&lt;p&gt;Python通过两个标准库thread和threading提供对线程的支持。thread提供了低级别的、原始的线程以及一个简单的锁。&lt;/p&gt;
&lt;p&gt;thread 模块提供的其他方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;threading.currentThread(): 返回当前的线程变量。&lt;/li&gt;
&lt;li&gt;threading.enumerate(): 返回一个包含正在运行的线程的list。正在运行指线程启动后、结束前，不包括启动前和终止后的线程。&lt;/li&gt;
&lt;li&gt;threading.activeCount(): 返回正在运行的线程数量，与len(threading.enumerate())有相同的结果。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;除了使用方法外，线程模块同样提供了Thread类来处理线程，Thread类提供了以下方法:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;run(): 用以表示线程活动的方法。&lt;/li&gt;
&lt;li&gt;start():启动线程活动。&lt;/li&gt;
&lt;li&gt;join([time]): 等待至线程中止。这阻塞调用线程直至线程的join() 方法被调用中止-正常退出或者抛出未处理的异常-或者是可选的超时发生。&lt;/li&gt;
&lt;li&gt;isAlive(): 返回线程是否活动的。&lt;/li&gt;
&lt;li&gt;getName(): 返回线程名。&lt;/li&gt;
&lt;li&gt;setName(): 设置线程名。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;使用threading模块创建线程&#34;&gt;使用Threading模块创建线程&lt;/h4&gt;
&lt;p&gt;使用Threading模块创建线程，直接从threading.Thread继承，然后重写__init__方法和run方法&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import threading
import time
 
exitFlag = 0
 
class myThread (threading.Thread):   &lt;span class=&#34;ni&#34;&gt;#继承父类threading&lt;/span&gt;.Thread
    def &lt;span class=&#34;gs&#34;&gt;__init__&lt;/span&gt;(self, threadID, name, counter):
        threading.Thread.__init__(self)
        self.threadID = threadID
        self.name = name
        self.counter = counter
    def run(self):                   &lt;span class=&#34;ni&#34;&gt;#把要执行的代码写到run函数里面&lt;/span&gt; 线程在创建后会直接运行run函数 
        print &amp;#34;Starting &amp;#34; + self.name
        print_time(self.name, self.counter, 5)
        print &amp;#34;Exiting &amp;#34; + self.name
 
def print_time(threadName, delay, counter):
    while counter:
        if exitFlag:
            threading.Thread.exit()
        time.sleep(delay)
        print &amp;#34;%s: %s&amp;#34; % (threadName, time.ctime(time.time()))
        counter -= 1
 
&lt;span class=&#34;gh&#34;&gt;# 创建新线程
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;thread1 = myThread(1, &amp;#34;Thread-1&amp;#34;, 1)
thread2 = myThread(2, &amp;#34;Thread-2&amp;#34;, 2)
 
&lt;span class=&#34;gh&#34;&gt;# 开启线程
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;thread1.start()
thread2.start()
 
print &amp;#34;Exiting Main Thread&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;线程同步&#34;&gt;线程同步&lt;/h4&gt;
&lt;p&gt;如果多个线程共同对某个数据修改，则可能出现不可预料的结果，为了保证数据的正确性，需要对多个线程进行同步。&lt;/p&gt;
&lt;p&gt;使用Thread对象的Lock和Rlock可以实现简单的线程同步，这两个对象都有acquire方法和release方法，对于那些需要每次只允许一个线程操作的数据，可以将其操作放到acquire和release方法之间。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import threading
import time
 
class myThread (threading.Thread):
    def &lt;span class=&#34;gs&#34;&gt;__init__&lt;/span&gt;(self, threadID, name, counter):
        threading.Thread.__init__(self)
        self.threadID = threadID
        self.name = name
        self.counter = counter
    def run(self):
        print &amp;#34;Starting &amp;#34; + self.name
       # 获得锁，成功获得锁定后返回True
       # 可选的timeout参数不填时将一直阻塞直到获得锁定
       # 否则超时后将返回False
        threadLock.acquire()
        print_time(self.name, self.counter, 3)
        # 释放锁
        threadLock.release()
 
def print_time(threadName, delay, counter):
    while counter:
        time.sleep(delay)
        print &amp;#34;%s: %s&amp;#34; % (threadName, time.ctime(time.time()))
        counter -= 1
 
threadLock = threading.Lock()
threads = []
 
&lt;span class=&#34;gh&#34;&gt;# 创建新线程
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;thread1 = myThread(1, &amp;#34;Thread-1&amp;#34;, 1)
thread2 = myThread(2, &amp;#34;Thread-2&amp;#34;, 2)
 
&lt;span class=&#34;gh&#34;&gt;# 开启新线程
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;thread1.start()
thread2.start()
 
&lt;span class=&#34;gh&#34;&gt;# 添加线程到线程列表
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;threads.append(thread1)
threads.append(thread2)
 
&lt;span class=&#34;gh&#34;&gt;# 等待所有线程完成
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;for t in threads:
    t.join()
print &amp;#34;Exiting Main Thread&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;线程优先级队列-queue&#34;&gt;线程优先级队列（ Queue）&lt;/h4&gt;
&lt;p&gt;Python的Queue模块中提供了同步的、线程安全的队列类，包括FIFO（先入先出)队列Queue，LIFO（后入先出）队列LifoQueue，和优先级队列PriorityQueue。这些队列都实现了锁原语，能够在多线程中直接使用。可以使用队列来实现线程间的同步。&lt;/p&gt;
&lt;p&gt;Queue模块中的常用方法:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Queue.qsize() 返回队列的大小&lt;/li&gt;
&lt;li&gt;Queue.empty() 如果队列为空，返回True,反之False&lt;/li&gt;
&lt;li&gt;Queue.full() 如果队列满了，返回True,反之False&lt;/li&gt;
&lt;li&gt;Queue.full 与 maxsize 大小对应&lt;/li&gt;
&lt;li&gt;Queue.get([block[, timeout]])获取队列，timeout等待时间&lt;/li&gt;
&lt;li&gt;Queue.get_nowait() 相当Queue.get(False)&lt;/li&gt;
&lt;li&gt;Queue.put(item) 写入队列，timeout等待时间&lt;/li&gt;
&lt;li&gt;Queue.put_nowait(item) 相当Queue.put(item, False)&lt;/li&gt;
&lt;li&gt;Queue.task_done() 在完成一项工作之后，Queue.task_done()函数向任务已经完成的队列发送一个信号&lt;/li&gt;
&lt;li&gt;Queue.join() 实际上意味着等到队列为空，再执行别的操作&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
import Queue
import threading
import time
 
exitFlag = 0
 
class myThread (threading.Thread):
    def &lt;span class=&#34;gs&#34;&gt;__init__&lt;/span&gt;(self, threadID, name, q):
        threading.Thread.__init__(self)
        self.threadID = threadID
        self.name = name
        self.q = q
    def run(self):
        print &amp;#34;Starting &amp;#34; + self.name
        process_data(self.name, self.q)
        print &amp;#34;Exiting &amp;#34; + self.name
 
def process_data(threadName, q):
    while not exitFlag:
        queueLock.acquire()
        if not workQueue.empty():
            data = q.get()
            queueLock.release()
            print &amp;#34;%s processing %s&amp;#34; % (threadName, data)
        else:
            queueLock.release()
        time.sleep(1)
 
threadList = [&amp;#34;Thread-1&amp;#34;, &amp;#34;Thread-2&amp;#34;, &amp;#34;Thread-3&amp;#34;]
nameList = [&amp;#34;One&amp;#34;, &amp;#34;Two&amp;#34;, &amp;#34;Three&amp;#34;, &amp;#34;Four&amp;#34;, &amp;#34;Five&amp;#34;]
queueLock = threading.Lock()
workQueue = Queue.Queue(10)
threads = []
threadID = 1
 
&lt;span class=&#34;gh&#34;&gt;# 创建新线程
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;for tName in threadList:
    thread = myThread(threadID, tName, workQueue)
    thread.start()
    threads.append(thread)
    threadID += 1
 
&lt;span class=&#34;gh&#34;&gt;# 填充队列
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;queueLock.acquire()
for word in nameList:
    workQueue.put(word)
queueLock.release()
 
&lt;span class=&#34;gh&#34;&gt;# 等待队列清空
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;while not workQueue.empty():
    pass
 
&lt;span class=&#34;gh&#34;&gt;# 通知线程是时候退出
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;exitFlag = 1
 
&lt;span class=&#34;gh&#34;&gt;# 等待所有线程完成
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;for t in threads:
    t.join()
print &amp;#34;Exiting Main Thread&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;json&#34;&gt;JSON&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式，易于人阅读和编写。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;json-函数&#34;&gt;JSON 函数&lt;/h4&gt;
&lt;p&gt;使用 JSON 函数需要导入 json 库：import json。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;函数&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;json.dumps&lt;/td&gt;
&lt;td&gt;将 Python 对象转换成 JSON 字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;json.loads&lt;/td&gt;
&lt;td&gt;将已编码的 JSON 字符串转换为 Python 对象&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;jsondumps&#34;&gt;json.dumps&lt;/h4&gt;
&lt;p&gt;json.dumps 用于将 Python 对象转换成 JSON 字符串。&lt;/p&gt;
&lt;p&gt;语法为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;json.dumps(obj, skipkeys=False, ensure_ascii=True, check_circular=True, allow_nan=True, cls=None, indent=None, separators=None, encoding=&amp;#34;utf-8&amp;#34;, default=None, sort_keys=False, **kw)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id=&#34;示例&#34;&gt;示例&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#!/usr/bin/python
import json

data = [ { &#39;a&#39; : 1, &#39;b&#39; : 2, &#39;c&#39; : 3, &#39;d&#39; : 4, &#39;e&#39; : 5 } ]

json = json.dumps(data)
print json
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;执行结果为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[{&amp;quot;a&amp;quot;: 1, &amp;quot;c&amp;quot;: 3, &amp;quot;b&amp;quot;: 2, &amp;quot;e&amp;quot;: 5, &amp;quot;d&amp;quot;: 4}]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;使用参数让 JSON 数据格式化输出：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; import json
&amp;gt;&amp;gt;&amp;gt; print json.dumps({&#39;a&#39;: &#39;xdhuxc&#39;, &#39;b&#39;: 7}, sort_keys=True, indent=4, separators=(&#39;,&#39;, &#39;: &#39;))
{
    &amp;quot;a&amp;quot;: &amp;quot;xdhuxc&amp;quot;,
    &amp;quot;b&amp;quot;: 7
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;python 原始类型向 json 类型的转化对照表：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Python&lt;/th&gt;
&lt;th&gt;JSON&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;dict&lt;/td&gt;
&lt;td&gt;object&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;list, tuple&lt;/td&gt;
&lt;td&gt;array&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;str, unicode&lt;/td&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;int, long, float&lt;/td&gt;
&lt;td&gt;number&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;True&lt;/td&gt;
&lt;td&gt;true&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;False&lt;/td&gt;
&lt;td&gt;false&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;None&lt;/td&gt;
&lt;td&gt;null&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;jsonloads&#34;&gt;json.loads&lt;/h3&gt;
&lt;p&gt;json.loads 用于解码 JSON 数据。该函数返回 Python 字段的数据类型。&lt;/p&gt;
&lt;p&gt;语法为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;json.loads(s[, encoding[, cls[, object_hook[, parse_float[, parse_int[, parse_constant[, object_pairs_hook[, **kw]]]]]]]])
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;import json

jsonData = &amp;#39;{&amp;#34;a&amp;#34;:1,&amp;#34;b&amp;#34;:2,&amp;#34;c&amp;#34;:3,&amp;#34;d&amp;#34;:4,&amp;#34;e&amp;#34;:5}&amp;#39;;

text = json.loads(jsonData)
print text
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上代码执行结果为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{u&amp;#39;a&amp;#39;: 1, u&amp;#39;c&amp;#39;: 3, u&amp;#39;b&amp;#39;: 2, u&amp;#39;e&amp;#39;: 5, u&amp;#39;d&amp;#39;: 4}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;json 类型转换到 python 的类型对照表：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;JSON&lt;/th&gt;
&lt;th&gt;Python&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;object&lt;/td&gt;
&lt;td&gt;dict&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;array&lt;/td&gt;
&lt;td&gt;list&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;string&lt;/td&gt;
&lt;td&gt;unicode&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;number (int)&lt;/td&gt;
&lt;td&gt;int, long&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;number (real)&lt;/td&gt;
&lt;td&gt;float&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;true&lt;/td&gt;
&lt;td&gt;True&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;false&lt;/td&gt;
&lt;td&gt;False&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;null&lt;/td&gt;
&lt;td&gt;None&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 中的条件语句</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-condition/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-condition/</guid>
                <pubDate>Sat, 16 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Python 语言中的条件语句。&lt;/p&gt;
&lt;h3 id=&#34;python-条件语句&#34;&gt;Python 条件语句&lt;/h3&gt;
&lt;p&gt;Python 条件语句是通过一条或多条语句的执行结果（True或者False）来决定执行的代码块&lt;/p&gt;
&lt;p&gt;Python 程序语言指定任何非0和非空（null）值为true，0 或者 null为false&lt;/p&gt;
&lt;p&gt;Python 编程中 if 语句用于控制程序的执行，基本形式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if 判断条件:
    执行语句...
else:
    执行语句...
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其中&amp;quot;判断条件&amp;quot;成立时（非零），则执行后面的语句，而执行内容可以多行，以缩进来区分表示同一范围。
else 为可选语句，当需要在条件不成立时执行内容则可以执行相关语句&lt;/p&gt;
&lt;p&gt;if 语句的判断条件可以用&amp;gt;（大于）、&amp;lt;(小于)、==（等于）、&amp;gt;=（大于等于）、&amp;lt;=（小于等于）来表示其关系。&lt;/p&gt;
&lt;p&gt;当判断条件为多个值时，可以使用以下形式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if 判断条件1:
    执行语句1……
elif 判断条件2:
    执行语句2……
elif 判断条件3:
    执行语句3……
else:
    执行语句4……
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;多个条件判断时，使用 elif 来实现，如果判断需要多个条件需同时判断时，可以使用 or （或），表示两个条件有一个成立时判断条件成功；使用 and （与）时，表示只有两个条件同时成立的情况下，判断条件才成功。&lt;/p&gt;
&lt;p&gt;当if有多个条件时可使用括号来区分判断的先后顺序，括号中的判断优先执行，此外 and 和 or 的优先级低于&amp;gt;（大于）、&amp;lt;（小于）等判断符号，即大于和小于在没有括号的情况下会比与或要优先判断。&lt;/p&gt;
&lt;p&gt;python 复合布尔表达式计算采用短路规则，即如果通过前面的部分已经计算出整个表达式的值，则后面的部分不再计算。&lt;/p&gt;
&lt;h3 id=&#34;python-循环语句&#34;&gt;Python 循环语句&lt;/h3&gt;
&lt;p&gt;循环语句允许我们执行一个语句或语句组多次&lt;/p&gt;
&lt;h4 id=&#34;while循环&#34;&gt;while循环&lt;/h4&gt;
&lt;p&gt;在给定的判断条件为 true 时执行循环体，否则退出循环体。&lt;/p&gt;
&lt;p&gt;Python 编程中 while 语句用于循环执行程序，即在某条件下，循环执行某段程序，以处理需要重复处理的相同任务。其基本形式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;while 判断条件：
    执行语句……
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行语句可以是单个语句或语句块。判断条件可以是任何表达式，任何非零、或非空（null）的值均为true。
当判断条件假false时，循环结束。
执行流程图如下：
&lt;img src=&#34;http://www.runoob.com/wp-content/uploads/2013/11/python_while_loop.jpg&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;Python while语句执行过程
&lt;img src=&#34;http://www.runoob.com/wp-content/uploads/2013/11/loop-over-python-list-animation.gif&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;
&lt;p&gt;while 语句还有另外两个重要的命令 continue、break 来跳过循环，continue 用于跳过该次循环，break 则是用于退出循环，此外&amp;quot;判断条件&amp;quot;还可以是个常值，表示循环必定成立。&lt;/p&gt;
&lt;p&gt;如果条件判断语句永远为 true，循环将会无限的执行下去。&lt;/p&gt;
&lt;p&gt;注意：以上的无限循环你可以使用 &lt;code&gt;CTRL+C&lt;/code&gt; 来中断循环。&lt;/p&gt;
&lt;p&gt;在 python 中，&lt;code&gt;while … else&lt;/code&gt; 在循环条件为 &lt;code&gt;false&lt;/code&gt; 时执行 &lt;code&gt;else&lt;/code&gt; 语句块&lt;/p&gt;
&lt;p&gt;类似 if 语句的语法，如果你的 while 循环体中只有一条语句，你可以将该语句与 while 写在同一行中&lt;/p&gt;
&lt;h4 id=&#34;for循环&#34;&gt;for循环&lt;/h4&gt;
&lt;p&gt;重复执行语句&lt;/p&gt;
&lt;p&gt;Python for 循环可以遍历任何序列的项目，如一个列表或者一个字符串。&lt;/p&gt;
&lt;p&gt;for 循环的语法格式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;for iterating_var in sequence:
   statements(s)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;遍历字符串和列表&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
for letter in &amp;#39;Python&amp;#39;:     # 第一个实例
   print &amp;#39;当前字母 :&amp;#39;, letter
 
fruits = [&amp;#39;banana&amp;#39;, &amp;#39;apple&amp;#39;,  &amp;#39;mango&amp;#39;]
for fruit in fruits:        # 第二个实例
   print &amp;#39;当前水果 :&amp;#39;, fruit
 
print &amp;#34;Good bye!&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;通过序列索引迭代（一种执行循环的遍历方式是通过索引）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
fruits = [&amp;#39;banana&amp;#39;, &amp;#39;apple&amp;#39;,  &amp;#39;mango&amp;#39;]
&lt;span class=&#34;gh&#34;&gt;# 函数 len() 返回列表的长度，即元素的个数
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 函数 range()返回一个序列的数
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;for index in range(len(fruits)):
   print &amp;#39;当前水果 :&amp;#39;, fruits[index]
 
print &amp;#34;Good bye!&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 python 中，&lt;code&gt;for … else&lt;/code&gt; 表示这样的意思，for 中的语句和普通的没有区别，else 中的语句会在循环正常执行完（即 for 不是通过 break 跳出而中断的）的情况下执行，&lt;code&gt;while … else&lt;/code&gt; 也是一样。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt; 
for num in range(10,20):  # 迭代 10 到 20 之间的数字
   for i in range(2,num): # 根据因子迭代
      if num%i == 0:      # 确定第一个因子
         j=num/i          # 计算第二个因子
         print &amp;#39;%d 等于 %d * %d&amp;#39; % (num,i,j)
         break            # 跳出当前循环
   else:                  # 循环的 else 部分
      print num, &amp;#39;是一个质数&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;嵌套循环&#34;&gt;嵌套循环&lt;/h4&gt;
&lt;p&gt;Python 语言允许在一个循环体里面嵌入另一个循环。&lt;/p&gt;
&lt;p&gt;Python for 循环嵌套语法&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;for iterating_var in sequence:
   for iterating_var in sequence:
      statements(s)
   statements(s)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Python while 循环嵌套语法&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;while expression:
   while expression:
      statement(s)
   statement(s)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以在循环体内嵌入其他的循环体，如在 while 循环中可以嵌入 for 循环， 反之，你可以在 for 循环中嵌入 while 循环&lt;/p&gt;
&lt;h3 id=&#34;循环控制语句&#34;&gt;循环控制语句&lt;/h3&gt;
&lt;p&gt;循环控制语句可以更改语句执行的顺序&lt;/p&gt;
&lt;p&gt;Python支持以下循环控制语句：&lt;/p&gt;
&lt;h4 id=&#34;break语句&#34;&gt;break语句&lt;/h4&gt;
&lt;p&gt;在语句块执行过程中终止循环，并且跳出整个循环&lt;/p&gt;
&lt;p&gt;break 语句用来终止循环语句，即循环条件没有 False 条件或者序列还没被完全递归完，也会停止执行循环语句。&lt;/p&gt;
&lt;p&gt;break 语句用在 while 和 for 循环中。&lt;/p&gt;
&lt;p&gt;如果使用嵌套循环，break 语句将停止执行最深层的循环，并开始执行下一行代码。&lt;/p&gt;
&lt;p&gt;Python 语言 break 语句语法&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;break
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;continue-语句&#34;&gt;continue 语句&lt;/h4&gt;
&lt;p&gt;在语句块执行过程中终止当前循环，跳出该次循环，执行下一次循环&lt;/p&gt;
&lt;p&gt;Python continue 语句跳出本次循环，而 break 跳出整个循环。&lt;/p&gt;
&lt;p&gt;continue 语句用来告诉 Python 跳过当前循环的剩余语句，然后继续进行下一轮循环。&lt;/p&gt;
&lt;p&gt;continue 语句用在 while 和 for 循环中。&lt;/p&gt;
&lt;p&gt;Python 语言 continue 语句语法格式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;continue
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;pass-语句&#34;&gt;pass 语句&lt;/h4&gt;
&lt;p&gt;pass是空语句，是为了保持程序结构的完整性&lt;/p&gt;
&lt;p&gt;Python pass是空语句，是为了保持程序结构的完整性。pass 不做任何事情，一般用做占位语句。&lt;/p&gt;
&lt;p&gt;Python 语言 pass 语句语法格式如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;pass
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 运算符</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-operator/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-operator/</guid>
                <pubDate>Wed, 13 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Python 语言中的运算符。&lt;/p&gt;
&lt;p&gt;Python 语言支持以下类型的运算符：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;算术运算符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关系运算符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;赋值运算符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;逻辑运算符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;位运算符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;成员运算符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;身份运算符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;运算符优先级&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;python-算术运算符&#34;&gt;Python 算术运算符&lt;/h3&gt;
&lt;p&gt;算术运算符实现对数字的运算。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;运算符&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;| 加 - 两个对象相加&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;| 减 - 得到负数或是一个数减去另一个数&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;| 乘 - 两个数相乘或是返回一个被重复若干次的字符串
/ | 除 - x除以y
% | 取模 - 返回除法的余数
**| 幂 - 返回x的y次幂
//| 取整除 - 返回商的整数部分&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;注意：Python2.x 里，整数除整数，只能得出整数。如果要得到小数部分，把其中一个数改成浮点数即可。&lt;/p&gt;
&lt;h3 id=&#34;python-比较运算符&#34;&gt;Python 比较运算符&lt;/h3&gt;
&lt;p&gt;比较运算符用于数字的比较。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;运算符&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;==&lt;/td&gt;
&lt;td&gt;等于   - 比较对象是否相等&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;!=&lt;/td&gt;
&lt;td&gt;不等于 - 比较两个对象是否不相等&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&amp;lt;&amp;gt;&lt;/td&gt;
&lt;td&gt;不等于 - 比较两个对象是否不相等&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;| 大于   - 返回x是否大于y
&amp;lt;  | 小于   - 返回x是否小于y
= | 大于等于	- 返回x是否大于等于y
&amp;lt;= | 小于等于 -	返回x是否小于等于y&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;注意：所有比较运算符返回1表示真，返回0表示假。这分别与特殊的变量True和False等价。注意，这些变量名的大写。&lt;/p&gt;
&lt;h3 id=&#34;python-赋值运算符&#34;&gt;Python 赋值运算符&lt;/h3&gt;
&lt;p&gt;赋值运算符用于为变量赋值。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;运算符&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;实例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;=&lt;/td&gt;
&lt;td&gt;简单的赋值运算符&lt;/td&gt;
&lt;td&gt;c = a + b 将 a + b 的运算结果赋值为 c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;+=&lt;/td&gt;
&lt;td&gt;加法赋值运算符&lt;/td&gt;
&lt;td&gt;c += a 等效于 c = c + a&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;-=&lt;/td&gt;
&lt;td&gt;减法赋值运算符&lt;/td&gt;
&lt;td&gt;c -= a 等效于 c = c - a&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;*=&lt;/td&gt;
&lt;td&gt;乘法赋值运算符&lt;/td&gt;
&lt;td&gt;c *= a 等效于 c = c * a&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/=&lt;/td&gt;
&lt;td&gt;除法赋值运算符&lt;/td&gt;
&lt;td&gt;c /= a 等效于 c = c / a&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%=&lt;/td&gt;
&lt;td&gt;取模赋值运算符&lt;/td&gt;
&lt;td&gt;c %= a 等效于 c = c % a&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;**=&lt;/td&gt;
&lt;td&gt;幂赋值运算符&lt;/td&gt;
&lt;td&gt;c **= a 等效于 c = c ** a&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;//=&lt;/td&gt;
&lt;td&gt;取整除赋值运算符&lt;/td&gt;
&lt;td&gt;c //= a 等效于 c = c // a&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;python-位运算符&#34;&gt;Python 位运算符&lt;/h3&gt;
&lt;p&gt;按位运算符是把数字看作二进制来进行计算的。&lt;/p&gt;
&lt;p&gt;Python中的按位运算法则如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;运算符&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&amp;amp;&lt;/td&gt;
&lt;td&gt;按位与运算符：参与运算的两个值,如果两个相应位都为1,则该位的结果为1,否则为0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;按位或运算符：只要对应的二个二进位有一个为1时，结果位就为1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;^&lt;/td&gt;
&lt;td&gt;按位异或运算符：当两对应的二进位相异时，结果为1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;~&lt;/td&gt;
&lt;td&gt;按位取反运算符：对数据的每个二进制位取反,即把1变为0,把0变为1 。~x 类似于 -x-1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&amp;lt;&amp;lt;&lt;/td&gt;
&lt;td&gt;左移动运算符：运算数的各二进位全部左移若干位，由&amp;quot;&amp;lt;&amp;lt;&amp;quot;右边的数指定移动的位数，高位丢弃，低位补0。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;| 右移动运算符：把&amp;quot;&amp;gt;&amp;gt;&amp;quot;左边的运算数的各二进位全部右移若干位，&amp;quot;&amp;gt;&amp;gt;&amp;quot;右边的数指定移动的位数&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;python-逻辑运算符&#34;&gt;Python 逻辑运算符&lt;/h3&gt;
&lt;p&gt;逻辑运算符用于对操作数进行逻辑运算。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;运算符&lt;/th&gt;
&lt;th&gt;逻辑表达式&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;and&lt;/td&gt;
&lt;td&gt;x and y&lt;/td&gt;
&lt;td&gt;布尔&amp;quot;与&amp;quot; - 如果 x 为 False，x and y 返回 False，否则它返回 y 的计算值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;or&lt;/td&gt;
&lt;td&gt;x or y&lt;/td&gt;
&lt;td&gt;布尔&amp;quot;或&amp;quot;	- 如果 x 是非 0，它返回 x 的值，否则它返回 y 的计算值&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;not&lt;/td&gt;
&lt;td&gt;not x&lt;/td&gt;
&lt;td&gt;布尔&amp;quot;非&amp;quot; - 如果 x 为 True，返回 False 。如果 x 为 False，它返回 True&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;python-成员运算符&#34;&gt;Python 成员运算符&lt;/h3&gt;
&lt;p&gt;Python支持成员运算符，包含了一系列的成员，例如字符串，列表或元组。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;运算符&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;实例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;in&lt;/td&gt;
&lt;td&gt;如果在指定的序列中找到值返回 True，否则返回 False&lt;/td&gt;
&lt;td&gt;x 在 y 序列中 , 如果 x 在 y 序列中返回 True&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;not in&lt;/td&gt;
&lt;td&gt;如果在指定的序列中没有找到值返回 True，否则返回 False&lt;/td&gt;
&lt;td&gt;x 不在 y 序列中 , 如果 x 不在 y 序列中返回 True&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;python-身份运算符&#34;&gt;Python 身份运算符&lt;/h3&gt;
&lt;p&gt;身份运算符用于比较两个对象的存储单元。&lt;/p&gt;
&lt;p&gt;id() 函数用于获取对象内存地址。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;运算符&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;实例&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;is&lt;/td&gt;
&lt;td&gt;is 是判断两个标识符是不是引用自一个对象&lt;/td&gt;
&lt;td&gt;x is y, 类似 id(x) == id(y) , 如果引用的是同一个对象则返回 True，否则返回 False&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;is not&lt;/td&gt;
&lt;td&gt;is not 是判断两个标识符是不是引用自不同对象&lt;/td&gt;
&lt;td&gt;x is not y ， 类似 id(a) != id(b)。如果引用的不是同一个对象则返回结果 True，否则返回 False&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;is-和--的区别&#34;&gt;is 和 == 的区别&lt;/h3&gt;
&lt;p&gt;is 用于判断两个变量引用对象是否为同一个。&lt;/p&gt;
&lt;p&gt;== 用于判断引用变量的值是否相等。&lt;/p&gt;
&lt;h3 id=&#34;python-运算符优先级&#34;&gt;Python 运算符优先级&lt;/h3&gt;
&lt;p&gt;以下表格列出了从最高到最低优先级的所有运算符：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;运算符&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;**&lt;/td&gt;
&lt;td&gt;指数 (最高优先级)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;~+-&lt;/td&gt;
&lt;td&gt;按位翻转, 一元加号和减号 (最后两个的方法名为 +@ 和 -@)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;/ % // | 乘，除，取模和取整除&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;| 加法减法&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;lt;&amp;lt; | 右移，左移运算符
&amp;amp; | 位 &#39;AND&#39;
^ | | 位运算符
&amp;lt;= &amp;lt; &amp;gt; &amp;gt;= | 比较运算符
&amp;lt;&amp;gt; == != | 等于运算符
= %= /= //= -= += *= **= | 赋值运算符
is not is | 身份运算符
in not in | 成员运算符
not or and| 逻辑运算符&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 基础语法</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-basic-programming-syntax/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-basic-programming-syntax/</guid>
                <pubDate>Tue, 12 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Python 编程的基础语法。&lt;/p&gt;
&lt;h3 id=&#34;python编程&#34;&gt;Python编程&lt;/h3&gt;
&lt;p&gt;Python编程方式&lt;/p&gt;
&lt;h4 id=&#34;交互式编程&#34;&gt;交互式编程&lt;/h4&gt;
&lt;p&gt;交互式编程不需要创建脚本文件，是通过 Python 解释器的交互模式进来编写代码。&lt;/p&gt;
&lt;p&gt;在 linux上，只需要在命令行中输入 Python 命令即可启动交互式编程，提示窗口如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ python
Python 2.7.6 (default, Sep  9 2014, 15:04:36) 
[GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.39)] on darwin
Type &amp;#34;help&amp;#34;, &amp;#34;copyright&amp;#34;, &amp;#34;credits&amp;#34; or &amp;#34;license&amp;#34; for more information.
&amp;gt;&amp;gt;&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 Windows 上，安装 Python 时已经安装了默认的交互式编程客户端。&lt;/p&gt;
&lt;h4 id=&#34;脚本式编程&#34;&gt;脚本式编程&lt;/h4&gt;
&lt;p&gt;通过脚本参数调用解释器开始执行脚本，直到脚本执行完毕。当脚本执行完成后，解释器不再有效。&lt;/p&gt;
&lt;p&gt;所有 Python 文件将以 &lt;code&gt;.py&lt;/code&gt; 为扩展名。&lt;/p&gt;
&lt;p&gt;假设已经设置了 Python 解释器 PATH 变量。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;xdhuxc.py&lt;/code&gt; 文件的内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: utf-8 -*- 
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
print &amp;#34;Hello,Python!&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用以下命令运行程序：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ python xdhuxc.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用另外一种方式来执行Python脚本，修改 &lt;code&gt;xdhuxc.py&lt;/code&gt; 文件，内容如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: utf-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
print &amp;#34;Hello, Python!&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;这里，假定 Python 解释器在 &lt;code&gt;/usr/bin&lt;/code&gt; 目录中，使用以下命令执行脚本：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ chmod +x xdhuxc.py # 为脚本xdhuxc.py添加可执行权限
$ ./xdhuxc.py
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;python-标识符&#34;&gt;Python 标识符&lt;/h3&gt;
&lt;p&gt;在 Python 里，标识符由字母、数字、下划线组成。&lt;/p&gt;
&lt;p&gt;在 Python 中，所有标识符可以包括英文、数字以及下划线 &lt;code&gt;_&lt;/code&gt;，但不能以数字开头。&lt;/p&gt;
&lt;p&gt;在 Python 中，标识符是区分大小写的。&lt;/p&gt;
&lt;p&gt;以 &lt;code&gt;下划线开头&lt;/code&gt; 的标识符是有特殊意义的：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;以单下划线开头 &lt;code&gt;_foo&lt;/code&gt; 的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用 &lt;code&gt;from xxx import *&lt;/code&gt; 而导入；&lt;/li&gt;
&lt;li&gt;以双下划线开头的 &lt;code&gt;__foo&lt;/code&gt; 代表类的私有成员；&lt;/li&gt;
&lt;li&gt;以双下划线开头和结尾的 &lt;code&gt;__foo__&lt;/code&gt; 代表 &lt;code&gt;Python&lt;/code&gt; 里特殊方法专用的标识，如 &lt;code&gt;__init__()&lt;/code&gt; 代表类的构造函数。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;python-保留字&#34;&gt;Python 保留字&lt;/h3&gt;
&lt;p&gt;Python 的保留字不能用作常数或变量，或任何其他标识符名称。&lt;/p&gt;
&lt;p&gt;所有 Python 的关键字只包含小写字母。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;and&lt;/th&gt;
&lt;th&gt;exec&lt;/th&gt;
&lt;th&gt;not&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;assert&lt;/td&gt;
&lt;td&gt;finally&lt;/td&gt;
&lt;td&gt;or&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;break&lt;/td&gt;
&lt;td&gt;for&lt;/td&gt;
&lt;td&gt;pass&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;class&lt;/td&gt;
&lt;td&gt;from&lt;/td&gt;
&lt;td&gt;print&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;continue&lt;/td&gt;
&lt;td&gt;global&lt;/td&gt;
&lt;td&gt;raise&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;def&lt;/td&gt;
&lt;td&gt;if&lt;/td&gt;
&lt;td&gt;return&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;del&lt;/td&gt;
&lt;td&gt;import&lt;/td&gt;
&lt;td&gt;try&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;elif&lt;/td&gt;
&lt;td&gt;in&lt;/td&gt;
&lt;td&gt;while&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;else&lt;/td&gt;
&lt;td&gt;is&lt;/td&gt;
&lt;td&gt;with&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;except&lt;/td&gt;
&lt;td&gt;lambda&lt;/td&gt;
&lt;td&gt;yield&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;行和缩进&#34;&gt;行和缩进&lt;/h3&gt;
&lt;p&gt;Python 与其他语言最大的区别就是：Python 的代码块不使用大括号 {} 来控制类，函数以及其他逻辑判断。&lt;/p&gt;
&lt;p&gt;python 最具特色的就是用缩进来写模块。&lt;/p&gt;
&lt;p&gt;缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。&lt;/p&gt;
&lt;p&gt;在 Python 的代码块中，必须使用相同数量的行首缩进空格数。建议在每个缩进层次使用 单个制表符 或 两个空格 或 四个空格 , 切记不能混用&lt;/p&gt;
&lt;h3 id=&#34;多行语句&#34;&gt;多行语句&lt;/h3&gt;
&lt;p&gt;Python语句中一般以新行作为为语句的结束符。&lt;/p&gt;
&lt;p&gt;在 Python 中，可以在同一行显示多条语句，方法是用分号 &lt;code&gt;;&lt;/code&gt; 分开。&lt;/p&gt;
&lt;p&gt;可以使用斜杠（ \）将一行的语句分为多行显示，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;total = item_one + \
        item_two + \
        item_three
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;语句中包含 [], {} 或 () 括号就不需要使用多行连接符，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;days = [&amp;#39;Monday&amp;#39;, &amp;#39;Tuesday&amp;#39;, &amp;#39;Wednesday&amp;#39;,
        &amp;#39;Thursday&amp;#39;, &amp;#39;Friday&amp;#39;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;python-引号&#34;&gt;Python 引号&lt;/h3&gt;
&lt;p&gt;Python 可以使用单引号 &lt;code&gt;&#39;&lt;/code&gt;、双引号 &lt;code&gt;&amp;quot;&lt;/code&gt;、三引号 &lt;code&gt;&#39;&#39;&#39;&lt;/code&gt; 或 &lt;code&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/code&gt; 来表示字符串，引号的开始与结束必须是相同的类型。&lt;/p&gt;
&lt;p&gt;其中三引号可以由多行组成，是编写多行文本的快捷语法，常用于文档字符串，在文件的特定位置，被当做注释。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;word = &amp;#39;word&amp;#39;
sentence = &amp;#34;这是一个句子。&amp;#34;
paragraph = &amp;#34;&amp;#34;&amp;#34;这是一个段落。
包含了多个语句&amp;#34;&amp;#34;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;python-注释&#34;&gt;Python 注释&lt;/h3&gt;
&lt;p&gt;python 中单行注释采用 &lt;code&gt;# &lt;/code&gt;开头。&lt;/p&gt;
&lt;p&gt;注释可以在语句或表达式行末；&lt;/p&gt;
&lt;p&gt;Python 中多行注释使用三个单引号 &lt;code&gt;&#39;&#39;&#39;&lt;/code&gt; 或三个双引号 &lt;code&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/code&gt;。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 文件名：test.py
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;

&amp;#39;&amp;#39;&amp;#39;
这是多行注释，使用单引号。
这是多行注释，使用单引号。
这是多行注释，使用单引号。
&amp;#39;&amp;#39;&amp;#39;

&amp;#34;&amp;#34;&amp;#34;
这是多行注释，使用双引号。
这是多行注释，使用双引号。
这是多行注释，使用双引号。
&amp;#34;&amp;#34;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;空行&#34;&gt;空行&lt;/h3&gt;
&lt;p&gt;函数之间或类的方法之间用空行分隔，表示一段新的代码的开始。类和函数入口之间也用一行空行分隔，以突出函数入口的开始。&lt;/p&gt;
&lt;p&gt;空行与代码缩进不同，空行并不是Python语法的一部分。书写时不插入空行，Python解释器运行也不会出错。但是空行的作用在于分隔两段不同功能或含义的代码，便于日后代码的维护或重构。&lt;/p&gt;
&lt;p&gt;注意：空行也是程序代码的一部分。&lt;/p&gt;
&lt;h3 id=&#34;代码组&#34;&gt;代码组&lt;/h3&gt;
&lt;p&gt;缩进相同的一组语句构成一个代码块，称之代码组。&lt;/p&gt;
&lt;p&gt;像 &lt;code&gt;if&lt;/code&gt;、&lt;code&gt;while&lt;/code&gt;、&lt;code&gt;def&lt;/code&gt; 和 &lt;code&gt;class&lt;/code&gt; 这样的复合语句，首行以关键字开始，以冒号 &lt;code&gt;:&lt;/code&gt; 结束，该行之后的一行或多行代码构成代码组。&lt;/p&gt;
&lt;p&gt;将首行及后面的代码组称为一个子句。
如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;if expression : 
   suite 
elif expression :  
   suite  
else :  
   suite 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;其他&#34;&gt;其他&lt;/h3&gt;
&lt;p&gt;1、print 默认输出是换行的，如果要实现不换行需要在变量末尾加上逗号。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;#!/usr/bin/python
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -*- coding: UTF-8 -*-
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
x=&amp;#34;a&amp;#34;
&lt;span class=&#34;gh&#34;&gt;# 换行输出
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;print x

print &amp;#39;---------&amp;#39;
&lt;span class=&#34;gh&#34;&gt;# 不换行输出
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;print x,
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、&lt;code&gt;#!/usr/bin/python&lt;/code&gt; 的含义&lt;/p&gt;
&lt;p&gt;脚本语言的第一行，目的就是指出，你想要你的这个文件中的代码用什么可执行程序去运行它，&lt;/p&gt;
&lt;p&gt;&lt;code&gt;#!/usr/bin/python&lt;/code&gt; : 是告诉操作系统执行这个脚本的时候，调用 /usr/bin 下的 python 解释器；&lt;/p&gt;
&lt;p&gt;&lt;code&gt;#!/usr/bin/env &lt;/code&gt;：python(推荐）: 这种用法是为了防止操作系统用户没有将 python 装在默认的 /usr/bin 路径里。当系统看到这一行的时候，首先会到 env 设置里查找 python 的安装路径，再调用对应路径下的解释器程序完成操作。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>一些其他问题及解决方式</title>
                <link>https://xdhuxc.github.io/posts/mixed/mixed/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/mixed/</guid>
                <pubDate>Sat, 09 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了一些其他的问题及解决方法。&lt;/p&gt;
&lt;h3 id=&#34;google-浏览器配置可访问自定义的-https&#34;&gt;Google 浏览器配置可访问自定义的 &lt;code&gt;https&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Windows&lt;/code&gt; 系统下，在 &lt;code&gt;chrome&lt;/code&gt; 快捷方式的属性中，修改快捷方式中的目标，添加 &lt;code&gt;--test-type --ignore-certificate-errors&lt;/code&gt;，最后目标项的值为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;#34;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe&amp;#34; --test-type --ignore-certificate-errors
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后使用该快捷方式打开浏览器，即可访问自定义的 &lt;code&gt;https&lt;/code&gt; 地址。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/%E6%9D%82%E9%A1%B9/">杂项</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Python 简介及开发环境搭建</title>
                <link>https://xdhuxc.github.io/posts/programming/python/python-introduction/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/programming/python/python-introduction/</guid>
                <pubDate>Fri, 08 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍下 Python 及其开发环境搭建。&lt;/p&gt;
&lt;h3 id=&#34;python&#34;&gt;Python&lt;/h3&gt;
&lt;p&gt;Python 是一个高层次的结合了解释性、编译性、互动性和面向对象的脚本语言。&lt;/p&gt;
&lt;h4 id=&#34;python-1&#34;&gt;Python&lt;/h4&gt;
&lt;p&gt;Python 的设计具有很强的可读性，相比其他语言经常使用英文关键字，其他语言的一些标点符号，它具有比其他语言更有特色语法结构。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Python 是一种解释型语言： 这意味着开发过程中没有了编译这个环节。类似于PHP和Perl语言。&lt;/li&gt;
&lt;li&gt;Python 是交互式语言： 这意味着，您可以在一个Python提示符，直接互动执行写你的程序。&lt;/li&gt;
&lt;li&gt;Python 是面向对象语言: 这意味着Python支持面向对象的风格或代码封装在对象的编程技术。&lt;/li&gt;
&lt;li&gt;Python 是初学者的语言：Python 对初级程序员而言，是一种伟大的语言，它支持广泛的应用程序开发，从简单的文字处理到 WWW 浏览器再到游戏。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;python的特点&#34;&gt;Python的特点&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;易于学习：Python有相对较少的关键字，结构简单，和一个明确定义的语法，学习起来更加简单。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;易于阅读：Python代码定义的更清晰。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;易于维护：Python的成功在于它的源代码是相当容易维护的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;一个广泛的标准库：Python的最大的优势之一是丰富的库，跨平台的，在UNIX，Windows和Macintosh兼容很好。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;互动模式：互动模式的支持，您可以从终端输入执行代码并获得结果的语言，互动的测试和调试代码片断。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可移植：基于其开放源代码的特性，Python已经被移植（也就是使其工作）到许多平台。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可扩展：如果你需要一段运行很快的关键代码，或者是想要编写一些不愿开放的算法，你可以使用C或C++完成那部分程序，然后从你的Python程序中调用。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;数据库：Python提供所有主要的商业数据库的接口。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;GUI编程：Python支持GUI可以创建和移植到许多系统调用。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可嵌入: 你可以将Python嵌入到C/C++程序，让你的程序的用户获得&amp;quot;脚本化&amp;quot;的能力。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;python-环境搭建&#34;&gt;Python 环境搭建&lt;/h3&gt;
&lt;p&gt;Python可应用于多平台包括 Linux 和 Mac OS X。&lt;/p&gt;
&lt;h4 id=&#34;在-linuxunix-上搭建-python-环境&#34;&gt;在 Linux/Unix 上搭建 Python 环境&lt;/h4&gt;
&lt;p&gt;1、打开WEB浏览器访问 &lt;a href=&#34;http://www.python.org/download/&#34;&gt;http://www.python.org/download/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2、选择适用于Unix/Linux的源码压缩包，下载并解压压缩包。&lt;/p&gt;
&lt;p&gt;3、如果需要自定义一些选项修改Modules/Setup，执行 ./configure 脚本&lt;/p&gt;
&lt;p&gt;4、执行命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;make
make install
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行以上操作后，Python会安装在 /usr/local/bin 目录中，Python库安装在/usr/local/lib/pythonXX，XX为你使用的Python的版本号。&lt;/p&gt;
&lt;h4 id=&#34;在-windows-上搭建-python-开发环境&#34;&gt;在 Windows 上搭建 Python 开发环境&lt;/h4&gt;
&lt;p&gt;1、打开 WEB 浏览器访问 &lt;a href=&#34;http://www.python.org/download/&#34;&gt;http://www.python.org/download/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2、在下载列表中选择Window平台安装包，包格式为：python-XYZ.msi 文件 ， XYZ 为要安装的版本号。&lt;/p&gt;
&lt;p&gt;3、要使用安装程序 python-XYZ.msi, Windows系统必须支持Microsoft Installer 2.0搭配使用。只要保存安装文件到本地计算机，然后运行它。&lt;/p&gt;
&lt;p&gt;4、下载后，双击下载包，进入Python安装向导，安装非常简单，你只需要使用默认的设置一直点击&amp;quot;下一步&amp;quot;直到安装完成即可。&lt;/p&gt;
&lt;h4 id=&#34;环境变量的设置&#34;&gt;环境变量的设置&lt;/h4&gt;
&lt;p&gt;程序和可执行文件可以在许多目录，而这些路径很可能不在操作系统提供可执行文件的搜索路径中。&lt;/p&gt;
&lt;p&gt;path(路径)存储在环境变量中，这是由操作系统维护的一个命名的字符串。这些变量包含可用的命令行解释器和其他程序的信息。&lt;/p&gt;
&lt;p&gt;Unix或Windows中路径变量为PATH（UNIX区分大小写，Windows不区分大小写）。&lt;/p&gt;
&lt;p&gt;1、在 Unix/Linux 中设置环境变量&lt;/p&gt;
&lt;p&gt;在 bash shell 命令行下输入&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;export PATH=&amp;#34;$PATH:/usr/local/bin/python&amp;#34; # /usr/local/bin/python 是 Python 的安装目录
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在 Windows 中设置环境变量
在命令提示框中输入：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;PATH=%PATH%;C:\Python # C:\Python为Python的安装路径
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;python-环境变量&#34;&gt;Python 环境变量&lt;/h3&gt;
&lt;p&gt;Python 中重要的环境变量&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;变量名&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;PYTHONPATH&lt;/td&gt;
&lt;td&gt;PYTHONPATH是Python搜索路径，默认我们import的模块都会从PYTHONPATH里面寻找&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PYTHONSTARTUP&lt;/td&gt;
&lt;td&gt;Python启动后，先寻找PYTHONSTARTUP环境变量，然后执行此文件中变量指定的执行代码&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PYTHONCASEOK&lt;/td&gt;
&lt;td&gt;加入PYTHONCASEOK的环境变量, 就会使python导入模块的时候不区分大小写.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PYTHONHOME&lt;/td&gt;
&lt;td&gt;另一种模块搜索路径。它通常内嵌于的PYTHONSTARTUP或PYTHONPATH目录中，使得两个模块库更容易切换。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;运行-python&#34;&gt;运行 Python&lt;/h3&gt;
&lt;p&gt;有三种方式可以运行Python&lt;/p&gt;
&lt;h4 id=&#34;交互式解释器&#34;&gt;交互式解释器&lt;/h4&gt;
&lt;p&gt;可以通过命令行窗口进入 python，并在交互式解释器中开始编写 Python 代码。&lt;/p&gt;
&lt;p&gt;可以在 Unix，DOS或任何其他提供了命令行或者shell的系统中进行 python 编码工作。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ python # Unix/Linux
或
C:&amp;gt;python # Windows/DOS
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;命令行脚本&#34;&gt;命令行脚本&lt;/h4&gt;
&lt;p&gt;在应用程序中通过引入解释器，可以在命令行中执行Python脚本，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;$ python script_name.py # Unix/Linux
或
C:&amp;gt;python script_name.py # Windows/DOS
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意：在执行脚本时，请检查脚本是否有可执行权限。&lt;/p&gt;
&lt;h4 id=&#34;集成开发环境&#34;&gt;集成开发环境&lt;/h4&gt;
&lt;p&gt;PyCharm功能：调试、语法高亮、Project管理、代码跳转、智能提示、自动完成、单元测试、版本控制……&lt;/p&gt;
&lt;h3 id=&#34;python中文编码&#34;&gt;Python中文编码&lt;/h3&gt;
&lt;p&gt;在 Python 2.x 中，默认的编码格式是 ASCII 格式，在没修改编码格式时无法正确打印汉字，所以在读取中文时会报错。&lt;/p&gt;
&lt;p&gt;解决：在文件开头加入 &lt;code&gt;# -*- coding: utf-8 -*-&lt;/code&gt; 或者 &lt;code&gt;#coding=utf-8&lt;/code&gt; 即可。&lt;/p&gt;
&lt;p&gt;在 Python 3.x 中源码文件默认使用 utf-8 编码，所以可以正常解析中文，无需指定 utf-8 编码。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/python/">Python</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 常用命令总结</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-common-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-common-command/</guid>
                <pubDate>Thu, 07 Sep 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在 Linux 系统中常用的命令，以备后查。&lt;/p&gt;
&lt;h2 id=&#34;chown&#34;&gt;chown&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;chown将指定文件的拥有者改为指定的用户或组，用户可以是用户名或者用户ID；组可以是组名或者组ID；文件是以空格分开的要改变权限的文件列表，支持通配符。系统管理员经常使用chown命令，在将文件拷贝到另一个用户的名录下之后，让用户拥有使用该文件的权限。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;通过chown改变文件的拥有者和群组。在更改文件的所有者或所属群组时，可以使用用户名称和用户识别码设置。普通用户不能将自己的文件改变成其他的拥有者。其操作权限一般为管理员。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;chown [options] [所有者][:[组]] 文件...
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;参数&#34;&gt;参数&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-c：显示更改的部分的信息
-f：忽略错误信息
-h：修复符号链接
-R：处理指定目录以及其子目录下的所有文件
-v：显示详细的处理信息
-deference：作用于符号链接的指向，而不是链接文件本身
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、将文件 abc.txt 的所有者设置为 xdhuxc，所属组设置为 jessie。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;chown jessie:xdhuxc abc.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、把文件 abc.txt 所属的组设置为 jessie&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;chown :jessie abc.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、将akhdie目录及其所有子目录和所有文件到新的用户xdhuxc和用户组jessie&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;chown -R jessie:xdhuxc akhdie/*
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ln&#34;&gt;ln&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ln命令的功能是为某一个文件在另外一个位置建立一个同步的链接。
当我们需要在不同的目录，用到相同的文件时，我们不需要在每一个需要的目录下都放一个必须相同的文件，我们只要在某个固定的目录，放上该文件，然后在 其它的目录下用ln命令链接它就可以，不必重复的占用磁盘空间。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-1&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ln [参数] [源文件或目录] [目标文件或目录]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;链接的分类&#34;&gt;链接的分类&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;链接(link)，我们可以将其视为档案的别名，而链接又可分为两种 : 硬链接(hard link)与软链接(symbolic link)，硬链接的意思是一个档案可以有多个名称，而软链接的方式则是产生一个特殊的档案，该档案的内容是指向另一个档案的位置。硬链接是存在同一个文件系统中，而软链接却可以跨越不同的文件系统。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;软链接&#34;&gt;软链接&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;软链接，以路径的形式存在。类似于Windows操作系统中的快捷方式&lt;/li&gt;
&lt;li&gt;软链接可以 跨文件系统 ，硬链接不可以&lt;/li&gt;
&lt;li&gt;软链接可以对一个不存在的文件名进行链接&lt;/li&gt;
&lt;li&gt;软链接可以对目录进行链接&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;硬链接&#34;&gt;硬链接&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;硬链接，以文件副本的形式存在。但不占用实际空间。&lt;/li&gt;
&lt;li&gt;不允许给目录创建硬链接&lt;/li&gt;
&lt;li&gt;硬链接只有在同一个文件系统中才能创建&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;注意&#34;&gt;注意：&lt;/h2&gt;
&lt;p&gt;1、ln命令会保持每一处链接文件的同步性，也就是说，不论你改动了哪一处，其它的文件都会发生相同的变化；&lt;/p&gt;
&lt;p&gt;2、ln的链接又分软链接和硬链接两种，软链接就是ln –s 源文件 目标文件，它只会在你选定的位置上生成一个文件的镜像，不会占用磁盘空间，硬链接 ln 源文件 目标文件，没有参数-s， 它会在你选定的位置上生成一个和源文件大小相同的文件，无论是软链接还是硬链接，文件都保持同步变化。&lt;/p&gt;
&lt;h3 id=&#34;参数-1&#34;&gt;参数&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-b：删除，覆盖以前建立的链接
-s：软链接(符号链接)
-v：显示详细的处理过程
-i：交互模式，文件存在则提示用户是否覆盖
-f：强制执行
-n：把符号链接视为一般目录
-d：允许超级用户制作目录的硬链接
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-1&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、给文件给文件创建软链接，为abc.log文件创建软链接abc_link，如果abc.log丢失，abc_link将失效.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ln -s abc.log abc_link
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、给文件创建硬链接，为abc.log创建硬链接abc_link，abc.log与abc_link的各项属性相同&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ln abc.log abc_link
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、给目录创建软链接&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ln -sv /usr/local/src /home/xdhuxc/src
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;目录只能创建软链接。&lt;/li&gt;
&lt;li&gt;目录创建链接必须用绝对路径，相对路径创建会不成功，会提示：符号连接的层数过多 这样的错误。&lt;/li&gt;
&lt;li&gt;在链接目标目录中修改文件都会在源文件目录中同步变化。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;使用场合&#34;&gt;使用场合&lt;/h3&gt;
&lt;p&gt;1、软链接适用场景（相当于windows的的快捷方式）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在文件系统中多处共享同一个较大文件时，使用软链接就可以避免创建多个副本。&lt;/li&gt;
&lt;li&gt;维护动态库文件的版本时，使用软链接，在升级库文件后，只需修改软链接的源文件，而使用该库的程序则不需要修改。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、硬链接使用场景&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;其实是一个指针，指向文件索引节点，系统并不为它重新分配inode.通过使用硬链接可达到备份数据(实际是备份节点)的效果。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;mkdir&#34;&gt;mkdir&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;mkdir 命令用于创建目录&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-2&#34;&gt;语法：&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mkdir [options] directory_name
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;参数-2&#34;&gt;参数&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-p,--parents：可以是一个路径名称。此时若路径中的某些目录尚不存在,加上此选项后,系统将自动建立好那些尚不存在的目录,即一次可以建立多个目录
-m：-mode=模式，设定权限&amp;lt;模式&amp;gt; 
-v,--verbose：每次创建新目录都显示信息
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-2&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、在当前目录下，建立一个名为 directory_name 的子目录。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mkdir directory_name
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、在当前目录下的  directory_name 目录中，建立一个名为 sub_directory_name 的子目录。 若 directory_name  目录原本不存在，则建立一个。若不加 -p，且原本 directory_name 目录不存在，则产生错误。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mkdir -p directory_name/sub_directory_name
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、创建权限为777的目录abc&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mkdir -m 777 abc
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;sudo&#34;&gt;sudo&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;sudo命令用来以其他身份来执行命令，预设的身份为root。在/etc/sudoers中设置了可执行sudo指令的用户。若其未经授权的用户企图使用sudo，则会发出警告的邮件给管理员。用户使用sudo时，必须先输入密码，之后有5分钟的有效期限，超过期限则必须重新输入密码。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-3&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo [options] others
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-V：显示版本编号；
-l 显示出自己（执行 sudo 的使用者）的权限；
-u username/#uid 不加此参数，代表要以 root 的身份执行指令，而加了此参数，可以以 username 的身份执行指令（#uid 为该 username 的使用者号码）；
-s 执行环境变数中的 SHELL 所指定的 shell ，或是 /etc/passwd 里所指定的 shell；
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-3&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、指定以用户xdhuxc权限执行命令&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo -u xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、显示sudo设置&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo -L
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、以root权限执行上一条命令&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo !!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4、以 xdhuxc 用户编辑 /home/xdhuxc/www 目录中的 index.html 文件&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sudo -u xdhuxc vim ~www/index.html
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;echo&#34;&gt;echo&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;用于字符串的输出，一般起到一个提示符的作用&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-4&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo 字符串
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;参数-3&#34;&gt;参数：&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-e：若字符串中出现以下字符，则加以特殊处理，而不会将它当成一般字符对待。 特殊字符有：

    \a 发出警告声
    \b 删除前一个字符
    \c 最后不加上换行符号
    \f 换行但光标仍旧停留在原来的位置
    \n 换行且光标移至行首
    \r 光标移至行首，但不换行
    \t 插入tab
    \v 与\f相同
    \\ 插入\字符
    \nnn 插入nnn（八进制）所代表的ASCII字符
    - help 显示帮助
    - version 显示版本信息
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-4&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、显示普通字符串&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo &amp;quot;I will be better!&amp;quot;
或                           # 输出为：I will be better!
echo &amp;quot;I will be better!&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、显示转义字符&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo &amp;quot;\&amp;quot;I will be better!\&amp;quot;&amp;quot; # 输出为：&amp;quot;I will be better!&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、显示变量&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo &amp;quot;$name will be better!&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4、显示换行或不换行&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo -e &amp;quot;OK! \n&amp;quot; # -e 开启转义 \n 换行
或
echo -e &amp;quot;OK! \c&amp;quot; # -e 开启转义 \c 不换行
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;5、显示结果定向至文件&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo &amp;quot;I will be better!&amp;quot; &amp;gt; mylife
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;6、原样输出字符串，不进行转义或取变量，用单引号&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo &#39;$name\&amp;quot;&#39; # 输出结果为：$name\&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;7、显示命令执行结果，使用反引号&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;echo `date` # 结果将显示当前日期
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ps&#34;&gt;ps&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ps命令用于显示当前进程 (process) 的状态&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-5&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ps [options] [--help]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-1&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-A：列出所有的进程；
-a：显示终端中包括其它用户的所有进程；
-x：显示无控制终端的进程；
-w：加宽显示，可以显示较多的信息；
-au：显示较详细的信息；
-aux：显示所有进程，也包含其他使用者的进程；
-f：用全格式来显示。
-e：选择全部的进程，等同于 -A。
-L：可能的话，追加 LWP 和 NLWP 栏显示线程。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;au(x)输出格式：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
USER：进程所有者；
PID：进程ID号，是一个进程的唯一标识ID；
%CPU：进程的CPU使用率；
%MEM：进程的内存占用率；
VSZ：进程占用的虚拟内存大小；
RSS：
TTY：终端；
STAT：进程的状态，包括；



START：进程开始时间；
TIME：进程执行的时间；
COMMAND：所执行的指令；
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-5&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、显示进程信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ps -A
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、显示root进程用户信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ps -u root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、显示所有进程信息，连同命令行&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ps -ef
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ps--ef-和-ps-aux-的区别&#34;&gt;ps -ef 和 ps aux 的区别&lt;/h2&gt;
&lt;p&gt;1、-ef 是 System V 展示风格，而 aux 是 BSD 风格。
ps -ef 的执行输出：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ps -ef | head -n 2
UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 Jun07 ?        00:01:36 /usr/lib/systemd/systemd --switched-root --system --deserialize 21
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;字段含义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;UID：用户ID或用户名。&lt;/li&gt;
&lt;li&gt;PID：进程ID。&lt;/li&gt;
&lt;li&gt;PPID：父进程ID。&lt;/li&gt;
&lt;li&gt;LWP：轻量进程（light weight process）或者线程ID。&lt;/li&gt;
&lt;li&gt;C：CPU 用于计算执行优先级的因子。数值越大，表明该进程是 CPU 密集型运算，执行优先级会降低；数值越小，表明该进程是 I/O  密集型运算，执行优先级会提高。&lt;/li&gt;
&lt;li&gt;NLWP：进程里的LWP（线程）数。&lt;/li&gt;
&lt;li&gt;STIME：进程启动的时间。&lt;/li&gt;
&lt;li&gt;TTY：完整的终端名称。&lt;/li&gt;
&lt;li&gt;TIME：CPU时间。&lt;/li&gt;
&lt;li&gt;CMD：完整的启动进程所用的命令和参数。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ps aux 的执行输出&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[root@xdhuxc ~]# ps aux | head -n 2
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.0 190788  3544 ?        Ss   Jun07   1:36 /usr/lib/systemd/systemd --switched-root --system --deserialize 21
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;字段含义：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;USER：用户名称。&lt;/li&gt;
&lt;li&gt;PID：进程ID号，是一个进程的唯一标识ID。&lt;/li&gt;
&lt;li&gt;%CPU：进程占 CPU 的百分比。&lt;/li&gt;
&lt;li&gt;%MEM：进程占用物理内存的百分比。&lt;/li&gt;
&lt;li&gt;VSZ：进程占用的虚拟内存大小，单位：KB。&lt;/li&gt;
&lt;li&gt;RSS：进程占用的物理内存大小，单位：KB。&lt;/li&gt;
&lt;li&gt;TTY：终端名称（缩写），若为?，则表示此进程与终端无关，因为它们是由系统启动的。&lt;/li&gt;
&lt;li&gt;STAT：进程状态
（1）S：睡眠。
（2）s：表示该进程是回话的先导进程。
（3）N：表示该进程拥有比普通优先级更低的优先级。
（4）R：正在运行。
（5）D：短期等待。
（6）Z：僵死进程。
（7）T：被跟踪或者被停止&lt;/li&gt;
&lt;li&gt;STARTED：进程的启动时间。&lt;/li&gt;
&lt;li&gt;TIME：CPU 时间，即进程使用 CPU 的总时间。&lt;/li&gt;
&lt;li&gt;COMMAND：启动进程所用的命令和参数，如果命令过长，会被截断显示。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、COMMAND 列如果过长，ps aux 会截断显示；而 ps -ef 则不会。&lt;/p&gt;
&lt;h2 id=&#34;grep&#34;&gt;grep&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;grep命令用于查找文件里符合条件的字符串。grep指令用于查找内容包含指定的范本样式的文件，如果发现某文件的内容符合所指定的范本样式，预设grep指令会把含有范本样式的那一列显示出来。若不指定任何文件名称，或是所给予的文件名为&amp;quot;-&amp;quot;，则grep指令会从标准输入设备读取数据。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;学习网址：
&lt;a href=&#34;http://blog.csdn.net/xy010902100449/article/details/51426354&#34;&gt;http://blog.csdn.net/xy010902100449/article/details/51426354&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.csdn.net/shuanzia/article/details/50392987&#34;&gt;http://blog.csdn.net/shuanzia/article/details/50392987&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;语法-6&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;grep [-options] pattern file_name
或
grep [-options] pattern directory_name
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-2&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-c,--count：计算符合模式的列数；
-d,--directories：当指定要查找的是目录而非文件时，必须使用这项参数，否则grep命令将回报信息并停止动作；
-v,--recursive：查找不匹配的行；
-o：只打印出匹配到的字符；
-E：将范本样式为延伸的普通表示法来使用，意味着能使用扩展正则表达式；
--color：把匹配到的字符用颜色显示出来；
-i：不区分大小写；
-n：在行首显示行号；
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-6&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、在当前目录中，查找后缀包含&amp;quot;sh&amp;quot;字样的文件中包含&amp;quot;test&amp;quot;字符串的文件&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;grep test *file
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、以递归的方式查找符合条件的文件。查找目录/etc/acpi 及其子目录下所有文件中包含字符串&amp;quot;update&amp;quot;的文件，并打印出该字符串所在行的内容&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;grep -r update /etc/acpi # 以递归的方式查找目录/etc/acpi下包含字符串“update”的文件
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、反向查找，打印出不符合条件行的内容，查找文件名中包含 test 的文件中不包含test 的行&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;grep -v test *test*
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;tar&#34;&gt;tar&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;tar 是用来建立、还原备份文件的工具程序，它可以加入，解开备份文件内的文件。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-7&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tar [options] file_name
或
tar [options] derictory_name
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-3&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-C destination_directory_name,--directory=destination_directory_name：解压或压缩到指定的目录。
-f file_name,--file=file_name：指定待压缩或解压的文件
-t,--list： 列出待解压或压缩文件的内容。
-v,--verbose：显示命令执行的过程。
-x,--extract,--get：从压缩文件中解压文件。
-z,--gzip,--unzip：通过gzip命令处理压缩文件
--exclude=pattern：去除符合模式的文件。
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-7&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、压缩文件，压缩文件a.c为abc.tar.gz&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tar -czvf abc.tar.gz a.c 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、列出压缩文件abc.tar.gz的内容&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tar -tzvf abc.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、解压文件abc.tar.gz&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tar -zxf abc.tar.gz # 不显示解压过程
或者
tar -zxvf abc.tar.gz # 显示解压过程
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4、解压文件abc.tgz&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tar -xz abc.tgz -C /data/xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ls&#34;&gt;ls&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ls 命令用于显示指定工作目录下的内容，列出当前工作目录的文件及子目录的文件&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-8&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ls [-options] directory_name
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-4&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-a 显示所有文件及目录 (ls默认将文件名或目录名开头为&amp;quot;.&amp;quot;的视为隐藏文档，不会列出)
-l：除文件名称外，亦将文件型态、权限、拥有者、文件大小等资讯详细列出
-r：将文件以相反次序显示，原定依英文字母次序；
-t：将文件依建立时间之先后次序列出
-A：同 -a ，但不列出 &amp;quot;.&amp;quot; (目前目录) 及 &amp;quot;..&amp;quot; (父目录)
-F：在列出的文件名称后加一符号；例如可执行档则加 &amp;quot;*&amp;quot;, 目录则加 &amp;quot;/&amp;quot;
-R：若目录下有文件，则以下之文件亦皆依序列出
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-8&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、列出根目录()下的所有目录&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ls /
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、列出当前工作目录下所有文件名以 s 开头的文件，越新的排越后面&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ls -ltr s*
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、将 /bin 目录及其所有子目录和文件详细信息列出&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ls -lR /bin
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4、列出当前目录下的所有文件及子目录，目录于名称后加 &amp;quot;/&amp;quot;, 可执行文件于名称后加 &amp;quot;*&amp;quot;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;ls -AF
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;eval&#34;&gt;eval&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;此命令适用于那些一次扫描无法实现其功能的变量.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;eval cmd_line
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;1、eval命令将会首先扫描命令行，进行所有的替换，然后再执行命令。此命令适用于那些一次扫描无法实现其功能的变量，该命令对变量进行两次扫描，如果第一遍扫描后，cmd_line是个普通命令，则执行此命令；如果cmd_line中含有变量的间接引用，则保证间接引用的语义。这些需要进行两次扫描的变量有时候被称为复杂变量。&lt;/p&gt;
&lt;p&gt;2、eval也可以用于回显简单变量，不一定是复杂变量。&lt;/p&gt;
&lt;h2 id=&#34;rm&#34;&gt;rm&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;rm命令用于删除一个文件或者目录&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-9&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rm [options] file_name/directory_name
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-5&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-i：删除文件或目录前逐一询问确认；
-f：强制删除，即使原文件或目录属性设置为只读，也直接删除，无需逐一确认；
-r：递归删除目录及其子目录下的所有文件；
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-9&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、删除文件abc.txt&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rm abc.txt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、递归删除当前目录下的所有文件及子目录&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;rm -r *
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;注意-1&#34;&gt;注意&lt;/h3&gt;
&lt;p&gt;1、文件一旦通过rm命令删除，则无法恢复，所以必须格外小心地使用该命令。
2、若删除目录，则必须配合选项&amp;quot;-r&amp;quot;。&lt;/p&gt;
&lt;h2 id=&#34;which&#34;&gt;which&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;which指令会在环境变量$PATH设置的目录里查找符合条件的文件。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-10&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;which [file...]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-6&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-V：显示版本信息
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-10&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、使用命令 which 查看命令 bash 的绝对路径&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;which bash # 显示bash可执行程序的绝对路径 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;mv&#34;&gt;mv&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;mv命令用来为文件或目录改名或将文件或目录移入其它位置。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-11&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mv [options] source destination
mv [options] source... directory
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;参数-4&#34;&gt;参数&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-i：若指定目录已有同名文件，则先询问是否覆盖旧文件;
-f：在mv操作要覆盖某已有的目标文件时不给任何指示;
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-11&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、将文件file_name_1重命名为file_name_2&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mv file_name_1 file_name_2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、将info目录放入logs目录中。如果logs目录不存在，则该命令将info改名为logs。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mv info/ logs
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、将/usr/xdhuxc目录下的所有文件和目录移到/home目录下&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;mv /usr/xdhuxc/* /home
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;scp&#34;&gt;scp&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;scp是linux系统下基于ssh登陆进行安全的远程文件复制命令。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-12&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;scp [options] [[user@]host1:]file1 [...]  [[user@]host2]:]file2
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;参数-5&#34;&gt;参数&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-r：递归复制整个目录；
-q：不显示传输进度条；
-v：详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题；
-P：指定数据传输用到的端口号；
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-12&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、从本地复制文件到远程主机&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;scp local_file remote_username@remote_ip:remote_folder # 指定了用户名，命令执行后需要再输入密码，仅指定了远程的目录，文件名字不变
或
scp local_file remote_username@remote_ip:remote_file # 指定了用户名，命令执行后需要再输入密码，指定了文件名；
或
scp local_file remote_ip:remote_folder # 没有指定用户名，命令执行后需要输入用户名和密码，仅指定了远程的目录，文件名字不变
或
scp local_file remote_ip:remote_file # 没有指定用户名，命令执行后需要输入用户名和密码，指定了文件名；
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、从本地复制目录到远程主机&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;scp -r local_folder remote_username@remote_ip:remote_folder # 指定了用户名，命令执行后需要再输入密码；
或
scp -r local_folder remote_ip:remote_folder # 没有指定用户名，命令执行后需要输入用户名和密码；
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;注意-2&#34;&gt;注意&lt;/h3&gt;
&lt;p&gt;1、使用scp命令要确保使用的用户具有可读取远程服务器相应文件的权限，否则scp命令是无法起作用的。&lt;/p&gt;
&lt;h2 id=&#34;groupadd&#34;&gt;groupadd&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;groupadd命令用于创建一个新的工作组，新工作组的信息将被添加到系统文件中。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-13&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;groupadd [options] 参数
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-7&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-g：指定新建工作组的id；
-r：创建系统工作组，系统工作组的组id小于500；
-K：覆盖配置文件 /etc/login.defs；
-o：允许添加组ID号不唯一的工作组
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-13&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、创建一个工作组，并设置组ID加入系统，此时在 /etc/passwd 文件中产生一个组 ID（GID） 是344的项目。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;groupadd -g 344 xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;useradd&#34;&gt;useradd&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;useradd 可用来建立用户帐号。帐号建好之后，再用passwd设定帐号的密码．而可用userdel删除帐号。使用useradd指令所建立的帐号，实际上是保存在/etc/passwd文本文件中。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-14&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;useradd [options] others
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-8&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-d directory_name：指定用户进入系统时的目录；
-g：指定用户所属的群组；
-m：自动创建用户进入系统时的目录；
-r：建立系统帐号；
-s shell_name：指定用户进入系统后所使用的shell；
-u user_id：指定用户id
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-14&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、创建一个一般用户&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;useradd akfdrt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、为创建的用户指定用户组&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;useradd -g root akfdrt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、创建一个系统用户&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;useraddd -r akfdrt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4、为新创建的用户指定 home 目录&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;useradd -d /home/akfdrt akfdrt
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;5、创建新用户且指定用户id&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;useradd akfdrt -u 273
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;su&#34;&gt;su&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;su命令用于变更为其他使用者的身份，除 root 外，需要键入该使用者的密码。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-15&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;su [-fmp] [-c command] [-s shell] [--help] [--version] [-] [USER [ARG]]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-9&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-c command 或 --command=command 变更为帐号为 USER 的使用者并执行指令（command）后再变回原来使用者
-s shell 或 --shell=shell 指定要执行的 shell （bash csh tcsh 等），预设值为 /etc/passwd 内的该使用者（USER） shell;
USER 欲变更的使用者帐号
ARG 传入新的 shell 参数
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-15&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、变更帐号为 root 并在执行 ls 指令后退出变回原使用者&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;su -c ls root
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、变更帐号为 root 并传入 -f 参数给新执行的 shell&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;su root -f
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、变更帐号为 ajdlfw 并改变工作目录至 ajdlfw 的 home 目录&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;su - ajdlfw
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;netstat&#34;&gt;netstat&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;netstat命令用于显示网络状态。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-16&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;netstat [-acCeFghilMnNoprstuvVwx][-A&amp;lt;网络类型&amp;gt;][--ip]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-10&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-a,--all：显示所有连接中的Socket；
-t,--tcp：显示TCP传输协议的连接状况；
-u,--udp：显示UDP传输协议的连接状况；
-v,--verbose：显示命令的执行过程；
-V,--version：显示版本信息；
-r,--route：显示路由表；
-i,--interfaces：显示网络界面信息表单；
-n,--numeric：直接使用IP地址，而不通过域名服务器；
-s,--statistics：显示网络工作信息统计表；
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-16&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、显示详细的网络状况&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;netstat -a
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、显示当前用户UDP连接状况&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;netstat -nu
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、显示UDP端口号的使用情况&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;netstat -apu
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4、显示网卡列表&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;netstat -i
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;5、显示网络统计信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;netstat -s
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;6、显示监听的套接口&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;netstat -l
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;kill&#34;&gt;kill&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;kill 命令用于删除执行中的程序或工作。kill可将指定的信息送至程序。预设的信息为SIGTERM(15)，可将指定程序终止。若仍无法终止该程序，可使用SIGKILL(9)信息尝试强制删除程序。程序或工作的编号可利用ps指令或jobs指令查看。
语法&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-17&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;kill [-s &amp;lt;信息名称或编号&amp;gt;][程序]
或
kill [-l &amp;lt;信息编号&amp;gt;]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-11&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-l &amp;lt;信息编号&amp;gt; 　若不加&amp;lt;信息编号&amp;gt;选项，则-l参数会列出全部的信息名称；
-s &amp;lt;信息名称或编号&amp;gt; 　指定要送出的信息；
[程序] 可以是程序的PID或是PGID，也可以是工作编号。
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-17&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、杀死指定用户xdhuxc的所有进程&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;kill -9 $(ps -ef|grep xdhuxc)
或
kill -u xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;curl&#34;&gt;curl&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;curl命令是一个利用URL规则在命令行下工作的文件传输工具。它支持文件的上传和下载，所以是综合传输工具，但按传统，习惯称curl为下载工具。作为一款强力工具，curl支持包括HTTP、HTTPS、ftp等众多协议，还支持POST、cookies、认证、从指定偏移处下载部分文件、用户代理字符串、限速、文件大小、进度条等特征。做网页处理流程和数据检索自动化，curl可以祝一臂之力。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-18&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl [options] 参数
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-12&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-o：将文件保存为命令行中指定的文件名的文件中；
-O：使用URL中默认的文件名保存文件到本地；
-C：可对大文件使用断点续传功能
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-18&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、 将文件下载到本地，并命名为：kjsifg.html&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl -o kjsifg.html http://www.gnu.org/software/gettext/manual/gettext.html
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、将文件下载到本地，并命名为gettext.html&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl -O http://www.gnu.org/software/gettext/manual/gettext.html
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;wget&#34;&gt;wget&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;wget命令用来从指定的URL下载文件。wget非常稳定，它在带宽很窄的情况下和不稳定网络中有很强的适应性，如果是由于网络的原因下载失败，wget会不断的尝试，直到整个文件下载完毕。如果是服务器打断下载过程，它会再次联到服务器上从停止的地方继续下载。这对从那些限定了链接时间的服务器上下载大文件非常有用&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-19&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wget [options] 参数
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-13&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-r：递归下载方式；
-v：显示详细执行过程；
-q：不显示执行过程；
-nv：下载时只显示更新和出错信息，不显示指令的详细执行过程；
-c：断点续传，重新启动下载中断的文件
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-19&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、使用 wget下载单个文件，保存在当前目录，在下载的过程中会显示进度条，包含（下载完成百分比，已经下载的字节，当前下载速度，剩余下载时间）。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wget http://www.linux.net/abc.zip
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、使用 wget 下载文件并以不同的文件名保存&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wget -O wordpress.zip http://www.linux.net/download.aspx?id=1080
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、使用 wget 下载多个文件&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;wget -i file_list.txt
cat file_list &amp;lt;&amp;lt; EOF
url_1
url_2
url_3
url_4
EOF
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;注意-3&#34;&gt;注意&lt;/h3&gt;
&lt;p&gt;1、wget 默认会以最后一个符合 / 的后面的字符来命令文件，对于动态链接的下载通常文件名会不正确。
为了解决该问题，可以使用选项 -O 来指定一个文件名。&lt;/p&gt;
&lt;h2 id=&#34;cp&#34;&gt;cp&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;cp命令用于复制文件或目录&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-20&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cp [options] source destination
或
cp [options] source... directory
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-14&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-a：此选项通常在复制目录时使用，它保留链接、文件属性，并复制目录下的所有内容。其作用等于dpR参数组合；
-f：覆盖已经存在的目标文件而不给出提示；
-i：在覆盖目标文件之前给出提示，要求用户确认是否覆盖，回答&amp;quot;y&amp;quot;时目标文件将被覆盖；
-p：除复制文件的内容外，还把修改时间和访问权限也复制到新文件中；
-r,-R：若给出的源文件是一个目录文件，此时将复制该目录下所有的子目录和文件。
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-20&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、将目录 /abc 下的所有文件及子目录复制到新目录/new_abc下&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;cp -r /abc/ /new_abc/ 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;find&#34;&gt;find&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;find命令用来在指定目录下查找文件。任何位于参数之前的字符串都将被视为欲查找的目录名。如果使用该命令时，不设置任何参数，则find命令将在当前目录下查找子目录与文件。并且将查找到的子目录和文件全部进行显示。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-21&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;find path -option [-print] [-exec -ok command] {};
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-15&#34;&gt;选项&lt;/h3&gt;
&lt;p&gt;find 根据下列规则判断 path 和 expression，在命令列上第一个 - ( ) , ! 之前的部份为 path，之后的是 expression。如果 path 是空字串则使用目前路径，如果 expression 是空字串则使用 -print 为预设 expression。&lt;/p&gt;
&lt;p&gt;expression 中可使用的选项：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-name name, -iname name：文件名称符合 name 的文件。iname 会忽略大小写
-type file_type：文件类型是file_type的文件
文件类型包括：
d：目录；
c：字符设备文件，比如猫、键盘、鼠标等串口设备；
b：块设备文件，比如硬盘、光驱等设备；
p：命名管道文件；
f：普通文件；
l：符号链接文件；
s：套接字文件
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以使用 &lt;code&gt;()&lt;/code&gt; 将运算符分隔，并使用下列运算&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;expression_1 -and expression_2
! expression
-not expression
expression_1 -or expression_2
expression_1, expression_2
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-21&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、将当前目录及其子目录下所有扩展名名是 &lt;code&gt;.c&lt;/code&gt; 的文件列出来。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;find . -name &amp;quot;*.c&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、将当前目录及其子目录中所有的普通文件列出&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;find . -type f
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、查找名字符合正则表达式的文件&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;find ./ -regex .*so.*\.gz
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;source&#34;&gt;source&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;source命令通常用于重新执行刚修改的初始化文件，使之立即生效，而不必注销并重新登录。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-22&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;source file_name
或
source . file_name
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;df&#34;&gt;df&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;df命令用于显示目前在Linux系统上的文件系统的磁盘使用情况统计。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-23&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;df [options]... [FILE]...
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-16&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-h：--human-readable 使用人类可读的格式，预设值是不加这个选项的
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-22&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、显示所有的信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;df -total
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;sed&#34;&gt;sed&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;sed是一种流式编辑器，它是文本处理中非常常用的工具，能够完美地配合正则表达式使用，主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。
处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”，接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕，接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向存储输出。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、直接编辑文件选项-i，会匹配file文件中每一行的第一个book替换为books&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sed -i &#39;s/book/books/g&#39; file #替换操作，s命令
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、使用后缀/g标记会替换每一行中的所有匹配
sed 还可以用行为单位进行部分数据的搜寻并取代&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;sed &#39;s/要被取代的字符串/新的字符串/g&#39;
即
sed &#39;s/book/books/g&#39; file
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;awk&#34;&gt;awk&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;awk是一种编程语言，用于在linux/unix下对文本和数据进行处理。数据可以来自标准输入(stdin)、一个或多个文件，或其它命令的输出。它支持用户自定义函数和动态正则表达式等先进功能，是linux/unix下的一个强大编程工具。它在命令行中使用，但更多是作为脚本来使用。awk有很多内建的功能，比如数组、函数等，这是它和C语言的相同之处，灵活性是awk最大的优势。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、打印每一行的第二个和第三个字段，当使用不带参数的print时，它就打印当前行，当print的参数是以逗号进行分隔时，打印时则以空格作为定界符。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;awk &#39;{ print $2,$3}&#39; file_name
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;du&#34;&gt;du&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;du命令用于显示目录或文件的大小，显示指定的目录或文件所占用的磁盘空间。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;语法-24&#34;&gt;语法&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;du [-abcDhHklmsSx][-L &amp;lt;符号连接&amp;gt;][-X &amp;lt;文件&amp;gt;][--block-size][--exclude=&amp;lt;目录或文件&amp;gt;][--max-depth=&amp;lt;目录层数&amp;gt;][--help][--version][目录或文件]
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;选项-17&#34;&gt;选项&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;--max-depth=&amp;lt;目录层数&amp;gt; 超过指定层数的目录后，予以忽略
-h或--human-readable 以K，M，G为单位，以人类易读的方式显示，提高信息的可读性。
-S或--separate-dirs 显示个别目录的大小时，并不含其子目录的大小。
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;示例-23&#34;&gt;示例&lt;/h3&gt;
&lt;p&gt;1、显示指定文件所占空间，以人类易读的方式显示。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;du -h abc.log
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker 中常见问题及解决</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-questions-and-solutions/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-questions-and-solutions/</guid>
                <pubDate>Sat, 26 Aug 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在使用 docker 的过程中常见的问题及解决方法。&lt;/p&gt;
&lt;p&gt;1、配置的镜像加速地址不生效，可能是因为同时配置了代理的缘故，取消代理的配置，重启 &lt;code&gt;docker&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;2、使用 &lt;code&gt;docker save&lt;/code&gt; 保存镜像，在另外的机器上重新加载该镜像，但是当 &lt;code&gt;docker pull&lt;/code&gt; 该镜像时，还是会从 &lt;code&gt;docker store&lt;/code&gt; 上拉取，并没有直接使用本地的，很可能是因为 &lt;code&gt;docker save&lt;/code&gt; 和 &lt;code&gt;docker load&lt;/code&gt; 时使用的 &lt;code&gt;docker&lt;/code&gt; 的版本不一致，使用相同版本的 &lt;code&gt;docker&lt;/code&gt; 试试。&lt;/p&gt;
&lt;p&gt;3、在使用 &lt;code&gt;VMware workstation&lt;/code&gt; 创建的虚拟机中，拉取 &lt;code&gt;docker&lt;/code&gt; 镜像时，报错如下：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/docker/questions-and-solutions/WechatIMG639.png&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;在一些实验室环境，服务器没有直接连接外网的权限，需要通过网络代理。通常会将网络代理直接配置在 &lt;code&gt;/etc/environment&lt;/code&gt;、&lt;code&gt;/etc/profile&lt;/code&gt; 之类的配置文件中，这对于大部分操作都是可行的。然而，&lt;code&gt;docker&lt;/code&gt; 命令却使用不了这些代理。比如 &lt;code&gt;docker pull&lt;/code&gt; 时需要从外网下载镜像，就会出现上述错误。&lt;/p&gt;
&lt;p&gt;所以，需要我们配置 docker 的网络代理&lt;/p&gt;
&lt;p&gt;1）为 &lt;code&gt;docker&lt;/code&gt; 服务创建一个内嵌的 &lt;code&gt;systemd&lt;/code&gt; 目录&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /etc/systemd/system/docker.service.d
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）创建 &lt;code&gt;/etc/systemd/system/docker.service.d/http-proxy.conf&lt;/code&gt; 文件，并添加 &lt;code&gt;HTTP_PROXY&lt;/code&gt; 环境变量&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Service]
Environment=&amp;#34;HTTP_PROXY=http://10.3.15.206:8888/&amp;#34; &amp;#34;HTTPS_PROXY=http://10.3.15.206:8888/&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;10.3.15.206&lt;/code&gt; 为代理的 &lt;code&gt;IP&lt;/code&gt; 地址，&lt;code&gt;8888&lt;/code&gt; 为代理的端口。可以使用 &lt;code&gt;http&lt;/code&gt; 代理 &lt;code&gt;https&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;3）如果还有内部的不需要使用代理来访问的 &lt;code&gt;Docker registries&lt;/code&gt;，那么还需要指定 &lt;code&gt;NO_PROXY&lt;/code&gt; 环境变量&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[Service]
Environment=&amp;#34;HTTP_PROXY=http://[proxy-addr]:[proxy-port]/&amp;#34; &amp;#34;HTTPS_PROXY=http://[proxy-addr]:[proxy-port]/&amp;#34; &amp;#34;NO_PROXY=localhost,127.0.0.1,docker-registry.somecorporation.com&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4）更新配置并重启docker服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload
systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;或者直接在 &lt;code&gt;/usr/lib/system/system/docker.service&lt;/code&gt; 中添加环境变量，重启加载配置，启动 &lt;code&gt;docker&lt;/code&gt; 服务。&lt;/p&gt;
&lt;p&gt;1）在 &lt;code&gt;docker.service&lt;/code&gt; 中添加如下环境变量&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Environment=HTTP_PROXY=http://10.3.15.206:8888/
Environment=HTTPS_PROXY=http://10.3.15.206:8888/
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）重新加载配置并重启 &lt;code&gt;docker&lt;/code&gt; 服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload
systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、推送镜像到私有仓库时报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker push 192.168.91.128:5000/busybox:latest
The push refers to a repository [192.168.91.128:5000/busybox]
Get https://192.168.91.128:5000/v1/_ping: http: server gave HTTP response to HTTPS client
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;原因：由提示可知，Docker 客户端使用 HTTPS 协议访问 Docker Registry，Docker Registry 采用 HTTP 协议响应导致的。&lt;/p&gt;
&lt;p&gt;解决：在 &lt;code&gt;/etc/docker/daemon.json&lt;/code&gt; 文件中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{ 
    # 192.168.91.128为镜像仓库所在主机的IP地址
    # 5000为镜像仓库的访问端口号
    &amp;#34;insecure-registries&amp;#34;:[&amp;#34;192.168.91.128:5000&amp;#34;] 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后重新启动 Docker 进程，即可拉取镜像。&lt;/p&gt;
&lt;p&gt;5、有些非常大的docker镜像文件，在执行加载命令时，提示“no space left on device ”，如下图所示：
&lt;img src=&#34;https://thumbnail0.baidupcs.com/thumbnail/ba983385327a8fbf8f0ac2c2046d4e86?fid=766960113-250528-475660698789264&amp;amp;time=1516104000&amp;amp;rt=sh&amp;amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-ddjVf5Fp3DawhAuIVoOCL0hDxeA%3D&amp;amp;expires=8h&amp;amp;chkv=0&amp;amp;chkbd=0&amp;amp;chkpc=&amp;amp;dp-logid=367320601015891313&amp;amp;dp-callid=0&amp;amp;size=c710_u400&amp;amp;quality=100&amp;amp;vuk=-&amp;amp;ft=video&#34; alt=&#34;image&#34;&gt;
但实际上，docker的工作目录存储空间足够，因此可能是docker限制了最大可加载镜像的大小，在启动 docker 的命令中添加如下参数：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;--storage-opt dm.basesize=60G --storage-opt dm.loopmetadatasize=10G
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 docker 进程，即可加载大型镜像。&lt;/p&gt;
&lt;p&gt;6、从镜像仓库拉取镜像时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@iuap-vm-23 compose_manage]# docker pull 172.20.26.113:5000/yonyoucloud-middleware/mysql:5.6.37
5.6.37: Pulling from yonyoucloud-middleware/mysql
4b3659249717: Pulling fs layer 
c8583c11f183: Pulling fs layer 
7e7cf3a87134: Pulling fs layer 
00b4cfdf2950: Pulling fs layer 
df7f67bbf575: Pulling fs layer 
b63454f1c8a6: Pulling fs layer 
2af4970f1cf4: Waiting 
07f81aa4b24b: Waiting 
ec3e1cfce710: Waiting 
3cfb59dd6cbd: Waiting 
912915d933d3: Pulling fs layer 
open /data/developercenter_enterprise/data_center/docker/data/tmp/GetImageBlob519470722: no such file or directory
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 docker&lt;/p&gt;
&lt;p&gt;7、执行 docker ps 命令无果，重新启动 docker 时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-node containers]# systemctl status docker -l
● docker.service - Docker Application Container Engine
   Loaded: loaded (/usr/lib/systemd/system/docker.service; enabled; vendor preset: disabled)
   Active: activating (start) since Thu 2018-06-28 11:28:45 CST; 59s ago
     Docs: https://docs.docker.com
 Main PID: 15819 (dockerd)
   Memory: 109.3M
   CGroup: /system.slice/docker.service
           ├─ 3109 docker-containerd-shim deaf8701233f2b6168510faddcf25144bf7dcba3351c111c5c70cb0bfa7e681a /var/run/docker/libcontainerd/deaf8701233f2b6168510faddcf25144bf7dcba3351c111c5c70cb0bfa7e681a docker-runc
           ├─15819 /usr/bin/dockerd --storage-driver=devicemapper --insecure-registry 0.0.0.0/0 --graph=/data/docker
           ├─15826 docker-containerd -l unix:///var/run/docker/libcontainerd/docker-containerd.sock --metrics-interval=0 --start-timeout 2m --state-dir /var/run/docker/libcontainerd/containerd --shim docker-containerd-shim --runtime docker-runc
           └─17205 docker-containerd-shim ac94b262a5df2f482378b79eb9ce130b29f9dc8c4908d56f4633d8f44d776660 /var/run/docker/libcontainerd/ac94b262a5df2f482378b79eb9ce130b29f9dc8c4908d56f4633d8f44d776660 docker-runc

Jun 28 11:28:45 k8s-node systemd[1]: Starting Docker Application Container Engine...
Jun 28 11:28:45 k8s-node dockerd[15819]: time=&amp;#34;2018-06-28T11:28:45+08:00&amp;#34; level=warning msg=&amp;#34;the \&amp;#34;-g / --graph\&amp;#34; flag is deprecated. Please use \&amp;#34;--data-root\&amp;#34; instead&amp;#34;
Jun 28 11:28:45 k8s-node dockerd[15819]: time=&amp;#34;2018-06-28T11:28:45.616437324+08:00&amp;#34; level=info msg=&amp;#34;libcontainerd: new containerd process, pid: 15826&amp;#34;
Jun 28 11:28:46 k8s-node dockerd[15819]: time=&amp;#34;2018-06-28T11:28:46.622111922+08:00&amp;#34; level=warning msg=&amp;#34;failed to rename /data/docker/tmp for background deletion: %!s(&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;). Deleting synchronously&amp;#34;
Jun 28 11:28:46 k8s-node dockerd[15819]: time=&amp;#34;2018-06-28T11:28:46.644187197+08:00&amp;#34; level=warning msg=&amp;#34;devmapper: Usage of loopback devices is strongly discouraged for production use. Please use &lt;span class=&#34;sb&#34;&gt;`--storage-opt dm.thinpooldev`&lt;/span&gt; or use &lt;span class=&#34;sb&#34;&gt;`man docker`&lt;/span&gt; to refer to dm.thinpooldev section.&amp;#34;
Jun 28 11:28:46 k8s-node dockerd[15819]: time=&amp;#34;2018-06-28T11:28:46.688238156+08:00&amp;#34; level=warning msg=&amp;#34;devmapper: Base device already exists and has filesystem xfs on it. User specified filesystem  will be ignored.&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;首先，查看磁盘是否还有空间，&lt;/p&gt;
&lt;p&gt;8、构建 docker 镜像时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Step 6/7 : ADD src/template /etc/template/
ADD failed: stat /var/lib/docker/tmp/docker-builder488455212/src/template: no such file or directory
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;而实际上，该路径是正确的，可能是将该目录的上级目录放到了 .gitignore 文件中，将该目录放到 .gitignore 文件中包含的目录之外即可。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>nginx 配置 marathon</title>
                <link>https://xdhuxc.github.io/posts/mixed/nginx/nginx-marathon/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/mixed/nginx/nginx-marathon/</guid>
                <pubDate>Sat, 26 Aug 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了配置 nginx 转发 marathon 管理页面到其他地址的方法。&lt;/p&gt;
&lt;p&gt;问题描述：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;marathon&lt;/code&gt; 平时是带端口访问的，现在需要将其统一到 &lt;code&gt;80&lt;/code&gt; 端口访问，使用 &lt;code&gt;nginx&lt;/code&gt; 作为代理。&lt;/p&gt;
&lt;p&gt;一般情况下，其访问地址为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.17.4:8080
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;返回的显示地址为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.17.4:8080/ui/#/apps
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;我们注意到，浏览器地址栏中变动的部分在 &lt;code&gt;/ui/#/&lt;/code&gt; 之后&lt;/p&gt;
&lt;p&gt;在 &lt;code&gt;nginx&lt;/code&gt; 中配置如下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;server {
    listen 80;
    
    location ^~ /marathon/ {
        proxy_set_header Host $http_host;
        proxy_set_header X-Forward-For $proxy_add_x_forward_for;
        proxy_pass http://172.20.17.4:8080/;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;8080&lt;/code&gt; 后面的斜杠至关重要。&lt;/p&gt;
&lt;p&gt;访问如下地址：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.17.4/marathon
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;浏览器地址栏显示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://172.20.17.4/marathon/ui/#/apps
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/nginx/">Nginx</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Dockerfile 知识点总结</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-dockerfile/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-dockerfile/</guid>
                <pubDate>Tue, 22 Aug 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 &lt;code&gt;Dockerfile&lt;/code&gt; 各种命令的使用方法，对于构建 &lt;code&gt;docker&lt;/code&gt; 镜像及运行 &lt;code&gt;Docker&lt;/code&gt; 容器都是不可不知的。&lt;/p&gt;
&lt;h3 id=&#34;dockerfile-简介&#34;&gt;Dockerfile 简介&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Dockerfile&lt;/code&gt; 是一个文本格式的配置文件，可以使用 &lt;code&gt;Dockerfile&lt;/code&gt; 快速创建自定义镜像&lt;/p&gt;
&lt;p&gt;Dockerfile官方网址：https://github.com/docker-library&lt;/p&gt;
&lt;h3 id=&#34;dockerfile-基本结构&#34;&gt;Dockerfile 基本结构&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Dockerfile&lt;/code&gt; 由一行行命令语句组成，并且支持以 “#” 开头的注释行。&lt;/p&gt;
&lt;p&gt;一般而言，&lt;code&gt;Dockerfile&lt;/code&gt; 分为四个部分：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;基础镜像信息&lt;/li&gt;
&lt;li&gt;维护者信息&lt;/li&gt;
&lt;li&gt;镜像操作指令&lt;/li&gt;
&lt;li&gt;容器启动时执行指令&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一个典型的 &lt;code&gt;Dockerfile&lt;/code&gt; 如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# This dockerfile uses the ubuntu image
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# VERSION 2 - EDITION 1
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# Author: docker_user
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# Command format: Instruction [arguments / command]..
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;# 第一行必须指定基于的基础镜像
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;FROM ubuntu

&lt;span class=&#34;gh&#34;&gt;# 维护者信息
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;MAINTAINER docker_user docker_user@email.com

&lt;span class=&#34;gh&#34;&gt;# 镜像的操作指令
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;RUN echo &amp;#34;deb http://archive.ubuntu.com/ubuntu/  raring main universe&amp;#34; &amp;gt;&amp;gt; /etc/apt/sources.list
RUN apt-get update &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install -y nginx
RUN echo &amp;#34;\ndaemon off;&amp;#34; &amp;gt;&amp;gt; /etc/nginx/nginx.conf

&lt;span class=&#34;gh&#34;&gt;# 容器启动时执行指令
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;CMD /usr/sbin/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;指令&#34;&gt;指令&lt;/h3&gt;
&lt;p&gt;指令的一般格式为：INSTRUCTION arguments，指令包括：FROM、MAINTAINER、RUN等。&lt;/p&gt;
&lt;h4 id=&#34;from&#34;&gt;FROM&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;FROM &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; 
或
FROM &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;:&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;第一条指令必须为 &lt;code&gt;FROM&lt;/code&gt; 指令，并且，如果在同一个 &lt;code&gt;Dockerfile&lt;/code&gt; 中创建多个镜像时，可以使用多个 &lt;code&gt;FROM&lt;/code&gt; 指令，每个镜像一次。&lt;/p&gt;
&lt;h4 id=&#34;maintainer&#34;&gt;MAINTAINER&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;MAINTAINER &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;指定维护者信息&lt;/p&gt;
&lt;h4 id=&#34;run&#34;&gt;RUN&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;RUN &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
或
RUN [&amp;#34;executable&amp;#34;, &amp;#34;param1&amp;#34;, &amp;#34;param2&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;前者将在 Shell 终端中运行命令，即 &lt;code&gt;/bin/sh -c&lt;/code&gt; ；&lt;/p&gt;
&lt;p&gt;后者则使用 &lt;code&gt;exec&lt;/code&gt; 执行，指定使用其他终端可以通过这种方式实现，例如 &lt;code&gt;RUN [&amp;quot;/bin/bash&amp;quot;, &amp;quot;-c&amp;quot;, &amp;quot;echo hello&amp;quot;]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;每条RUN指令将在当前镜像基础上执行指定指令，并提交为新的镜像。&lt;/p&gt;
&lt;p&gt;每运行一条RUN指令，镜像添加新的一层，并提交。&lt;/p&gt;
&lt;p&gt;当命令较长时，可以使用 &lt;code&gt;\&lt;/code&gt; 来换行。&lt;/p&gt;
&lt;h4 id=&#34;cmd&#34;&gt;CMD&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;CMD [&amp;#34;executable&amp;#34;, &amp;#34;param1&amp;#34;, &amp;#34;param2&amp;#34;]  &lt;span class=&#34;ni&#34;&gt;#使用&lt;/span&gt; exec 执行，推荐方式
或
CMD command param1 param2 # 在/bin/bash 中执行，提供给需要交互的应用
或
CMD [&amp;#34;param1&amp;#34;, &amp;#34;param2&amp;#34;] # 提供给 ENTRYPOINT 的默认参数
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;指定启动容器时执行的命令，每个 &lt;code&gt;Dockerfile&lt;/code&gt; 只能有一条 &lt;code&gt;CMD&lt;/code&gt; 命令。如果指定了多条命令，只有最后一条会被执行。&lt;/p&gt;
&lt;p&gt;如果用户启动容器时，指定了运行的命令，则会覆盖掉 &lt;code&gt;CMD&lt;/code&gt; 指定的命令。&lt;/p&gt;
&lt;h4 id=&#34;expose&#34;&gt;EXPOSE&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;EXPOSE &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; [&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;...]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;告诉 Docker 服务端容器暴露的端口号，供互联系统使用。&lt;/p&gt;
&lt;p&gt;在启动容器时需要通过 &lt;code&gt;-p&lt;/code&gt; 选项指定，&lt;code&gt;Docker&lt;/code&gt; 主机会自动分配一个端口转发到指定的端口。&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;-p&lt;/code&gt;，则可以具体指定哪个本地端口映射过来。&lt;/p&gt;
&lt;h4 id=&#34;env&#34;&gt;ENV&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ENV &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;指定一个环境变量，会被后续 &lt;code&gt;RUN&lt;/code&gt; 指令使用，并在容器运行时保持&lt;/p&gt;
&lt;h4 id=&#34;copy&#34;&gt;COPY&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;COPY &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;复制本地主机的 &lt;code&gt;&amp;lt;src&amp;gt;&lt;/code&gt;（为 &lt;code&gt;Dockerfile&lt;/code&gt; 所在目录的相对路径，文件或者目录）为容器中的 &lt;code&gt;&amp;lt;dest&amp;gt;&lt;/code&gt;。目标路径不存在时，会自动创建。&lt;/p&gt;
&lt;p&gt;当使用本地目录为源目录时，推荐使用 &lt;code&gt;COPY&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&#34;add&#34;&gt;ADD&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ADD &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;src&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;复制指定的 &lt;code&gt;&amp;lt;src&amp;gt;&lt;/code&gt; 到容器中的 &lt;code&gt;&amp;lt;dest&amp;gt;&lt;/code&gt;，其中 &lt;code&gt;&amp;lt;src&amp;gt;&lt;/code&gt; 可以是 &lt;code&gt;Dockerfile&lt;/code&gt;所在目录的一个相对路径（文件或目录）；&lt;/p&gt;
&lt;p&gt;也可以是一个 &lt;code&gt;URL&lt;/code&gt;，还可以是一个 &lt;code&gt;tar&lt;/code&gt; 文件（自动解压为目录）。&lt;/p&gt;
&lt;h4 id=&#34;entrypoint&#34;&gt;ENTRYPOINT&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ENTRYPOINT [&amp;#34;executable&amp;#34;, &amp;#34;param1&amp;#34;, &amp;#34;param2&amp;#34;]
或
ENTRYPOINT command param1 param2 &lt;span class=&#34;ni&#34;&gt;#在Shell中执行&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;配置容器启动后执行的命令，并且不可被 &lt;code&gt;docker run&lt;/code&gt; 提供的参数覆盖&lt;/p&gt;
&lt;p&gt;每个 &lt;code&gt;Dockerfile&lt;/code&gt; 中只能有一个 &lt;code&gt;ENTRYPOINT&lt;/code&gt;，当指定多个 &lt;code&gt;ENTRYPOINT&lt;/code&gt; 时，只有最后一个生效。&lt;/p&gt;
&lt;h4 id=&#34;volume&#34;&gt;VOLUME&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;VOLUME [&amp;#34;/data&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;创建一个可以从本地主机或其他容器挂载的挂载点，一般用来存放数据库和需要保持的数据等。&lt;/p&gt;
&lt;h4 id=&#34;user&#34;&gt;USER&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;USER daemon
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;指定运行容器时的用户名或 &lt;code&gt;UID&lt;/code&gt;，后续的RUN也会使用指定用户。&lt;/p&gt;
&lt;p&gt;当服务不需要管理员权限时，可以通过该命令指定运行用户。并且可以在之前创建所需要的用户，例如 &lt;code&gt;RUN groupadd -r postgres &amp;amp;&amp;amp; useradd -r -g postgres postgres&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;要临时获取管理员权限，可以使用 &lt;code&gt;gosu&lt;/code&gt;，而不推荐使用 &lt;code&gt;sudo&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&#34;workdir&#34;&gt;WORKDIR&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;WORKDIR /path/to/workdir
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;为后续的 &lt;code&gt;RUN&lt;/code&gt;，&lt;code&gt;CMD&lt;/code&gt;，&lt;code&gt;ENTRYPOINT&lt;/code&gt; 指令配置工作目录&lt;/p&gt;
&lt;p&gt;可以使用多个 &lt;code&gt;WORKDIR&lt;/code&gt; 指令，后续命令如果参数是相对路径，则会基于之前命令指定的路径。例如：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;WORKDIR /a
WORKDIR b
WORKDIR c
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;则最终路径为：&lt;code&gt;/a/b/c&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;onbuild&#34;&gt;ONBUILD&lt;/h4&gt;
&lt;p&gt;格式为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ONBUILD [INSTRUCTION]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;配置当所创建的镜像作为其他新创建镜像的基础镜像时，所执行的操作指令。&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;ONBUILD&lt;/code&gt; 指令的镜像，推荐在标签中注明，例如 &lt;code&gt;ruby:1.9-onbuild&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id=&#34;主要指令&#34;&gt;主要指令&lt;/h3&gt;
&lt;h4 id=&#34;add-和-copy&#34;&gt;ADD 和 COPY&lt;/h4&gt;
&lt;p&gt;ADD：将主机上的文件复制到或者将网络上的文件下载到容器中的指定目录。&lt;/p&gt;
&lt;p&gt;COPY： 将本地目录中的文件复制到容器内的指定目录下面，从而在镜像中增加一个层。在未指定绝对路径的时候，会放到 WORKDIR 目录下面。&lt;/p&gt;
&lt;p&gt;ADD 和 COPY 之间的区别：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ADD 多了两个功能，下载 URL 和对支持的压缩格式的包进行解压，其他都一样。比如，&lt;code&gt;ADD http://foo.com/bar.go /tmp/main.go&lt;/code&gt; 会将文件从互联网上下载下来；&lt;code&gt;ADD /foo.tar.gz /tmp/&lt;/code&gt; 会将压缩文件解压再 COPY 过去。&lt;/li&gt;
&lt;li&gt;如果不希望压缩文件复制到容器中后解压的话，那么使用 COPY。&lt;/li&gt;
&lt;li&gt;如果需要自动下载 URL 并复制到容器的话，那么使用 ADD。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;expose-和-docker-run--p-之间的关系&#34;&gt;EXPOSE 和 docker run -p 之间的关系&lt;/h4&gt;
&lt;p&gt;容器的端口必须被发布（publish）出来后才能被外界使用，Dockerfile 中的 EXPOSE 只是 &lt;code&gt;标记&lt;/code&gt; 某个端口会被暴露出来，只有在使用了 &lt;code&gt;docker run -p&lt;/code&gt; 或者 &lt;code&gt;docker run -P&lt;/code&gt; 后，端口才会被 &lt;code&gt;发布&lt;/code&gt; 出来，此时端口才能被使用。&lt;/p&gt;
&lt;p&gt;在 Dockerfile 中没有指定 EXPOSE port 时，&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;-P&lt;/code&gt; 参数，执行 &lt;code&gt;docker run -d --name no-exposed-port-xdhuxc -P xdhuxc:latest&lt;/code&gt;，此时没有任何端口被发布，说明 docker 在使用了 &lt;code&gt;-P&lt;/code&gt; 参数的情形下只是自动将 EXPOSE 的端口发布出来。&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;-p&lt;/code&gt; 加上一个不存在的端口，执行 &lt;code&gt;docker run -d --name no-exposed-port-xdhuxc -p 8888:9999 xdhuxc:latest&lt;/code&gt;，此时，9999 端口会被暴露，但是没法使用，说明 &lt;code&gt;-p&lt;/code&gt; 会将没有暴露的端口自动暴露出来。&lt;/p&gt;
&lt;p&gt;由此可见，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;EXPOSE&lt;/code&gt; 或者 &lt;code&gt;--expose&lt;/code&gt; 只是为其他命令提供所需信息的元数据，或者只是告诉容器操作人员有哪些已知选择，只是作为记录机制，也就是告诉用户哪些端口会提供服务。它保存在容器的元数据中。&lt;/li&gt;
&lt;li&gt;使用 &lt;code&gt;-p&lt;/code&gt; 发布特定端口，如果该端口已经被暴露出来，则发布它；如果它还没有被暴露，则它会被暴露和发布。docker 不会检查容器端口的正确性。&lt;/li&gt;
&lt;li&gt;使用 &lt;code&gt;-P&lt;/code&gt; 时，docker 会自动将所有已经被暴露的端口发布出来。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;cmd-和-entrypoint&#34;&gt;CMD 和 ENTRYPOINT&lt;/h4&gt;
&lt;p&gt;这两个指令都指定了运行容器时所执行的命令。以下是它们共存的一些规则：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Dockerfile 至少需要指定一个 CMD 或者 ENTRYPOINT 指令。&lt;/li&gt;
&lt;li&gt;CMD 可以用来指定 ENTRYPOINT 指令的参数&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以下是两者共存时，实际执行命令的格式&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;CMD/ENTRYPOINT&lt;/th&gt;
&lt;th&gt;没有 ENTRYPOINT&lt;/th&gt;
&lt;th&gt;ENTRYPOINT entry_exec entry_p1&lt;/th&gt;
&lt;th&gt;ENTRYPOINT [&amp;quot;entry_exec&amp;quot;, &amp;quot;entry_p1&amp;quot;]&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;没有 CMD&lt;/td&gt;
&lt;td&gt;错误，不允许&lt;/td&gt;
&lt;td&gt;/bin/sh -c entry_exec entry_p1&lt;/td&gt;
&lt;td&gt;entry_exec entry_p1&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CMD [&amp;quot;cmd_exec&amp;quot;, &amp;quot;cmd_p1&amp;quot;]&lt;/td&gt;
&lt;td&gt;cmd_exec cmd_p1&lt;/td&gt;
&lt;td&gt;/bin/sh -c entry_exec entry_p1 cmd_exec cmd_p1&lt;/td&gt;
&lt;td&gt;entry_exec entry_p1 cmd_exec cmd_p1&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CMD [&amp;quot;cmd_p1&amp;quot;, &amp;quot;cmd_p2&amp;quot;]&lt;/td&gt;
&lt;td&gt;cmd_p1 cmd_p2&lt;/td&gt;
&lt;td&gt;/bin/sh -c entry_exec entry_p1 cmd_p1 cmd_p2&lt;/td&gt;
&lt;td&gt;entry_exec entry_p1 cmd_p1 cmd_p2&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CMD cmd_exec cmd_p1&lt;/td&gt;
&lt;td&gt;/bin/sh -c cmd_exec cmd_p1&lt;/td&gt;
&lt;td&gt;/bin/sh -c entry_exec entry_p1 cmd_exec cmd_p1&lt;/td&gt;
&lt;td&gt;entry_exec entry_p1 cmd_exec cmd_p1&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;备注&lt;/td&gt;
&lt;td&gt;只有 CMD 时，执行 CMD 定义的指令&lt;/td&gt;
&lt;td&gt;CMD 和 ENTRYPOINT 都存在时，CMD 的指令作为 ENTRYPOINT 的参数。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;构建-docker-镜像应该遵循的原则&#34;&gt;构建 Docker 镜像应该遵循的原则&lt;/h3&gt;
&lt;p&gt;整体原则上，尽量保持镜像功能的明确和内容的精简&lt;/p&gt;
&lt;p&gt;要点包括：&lt;/p&gt;
&lt;p&gt;1、尽量选取满足需求但较小的基础系统镜像；&lt;/p&gt;
&lt;p&gt;2、清理编译生成文件、安装包的缓存等临时文件；&lt;/p&gt;
&lt;p&gt;3、安装各个软件的时候要指定准确的版本号，并避免引入不需要的依赖；&lt;/p&gt;
&lt;p&gt;4、从安全角度考虑，应用要尽量使用系统的库和依赖；&lt;/p&gt;
&lt;p&gt;5、如果安装应用时需要配置一些特殊的环境变量，在安装后要还原不需要保持的变量值；&lt;/p&gt;
&lt;p&gt;6、使用 &lt;code&gt;Dockerfile&lt;/code&gt; 创建镜像时，要添加 &lt;code&gt;.dockerignore&lt;/code&gt; 文件或使用空的工作目录；&lt;/p&gt;
&lt;h3 id=&#34;使用容器时需要避免的一些做法&#34;&gt;使用容器时需要避免的一些做法&lt;/h3&gt;
&lt;p&gt;1、不要在容器中保存数据。&lt;/p&gt;
&lt;p&gt;2、将应用打包到镜像再部署，而不是更新到已有容器。&lt;/p&gt;
&lt;p&gt;3、不要产生过大的镜像。&lt;/p&gt;
&lt;p&gt;4、不要使用单层镜像。&lt;/p&gt;
&lt;p&gt;5、不要从运行着的容器上产生镜像。&lt;/p&gt;
&lt;p&gt;6、不要只是使用 &lt;code&gt;latest&lt;/code&gt; 标签。&lt;/p&gt;
&lt;p&gt;7、不要在容器内运行超过一个的进程。&lt;/p&gt;
&lt;p&gt;8、不要在容器内保存 &lt;code&gt;credentials&lt;/code&gt;，而是要从外部通过环境变量传入。&lt;/p&gt;
&lt;p&gt;9、不要使用 &lt;code&gt;root&lt;/code&gt; 用户运行容器进程。&lt;/p&gt;
&lt;p&gt;10、不要依赖于 IP 地址，而是要从外部通过环境变量传入。&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/dockerfile/">Dockerfile</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker 常用命令</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-common-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-common-command/</guid>
                <pubDate>Sat, 19 Aug 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客记录了在使用 docker 的过程中经常使用的一些命令。&lt;/p&gt;
&lt;h2 id=&#34;docker-信息&#34;&gt;Docker 信息&lt;/h2&gt;
&lt;p&gt;1、显示 docker 版本信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker version
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、显示 docker 系统信息，包括镜像和容器数&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker info
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;容器生命周期管理&#34;&gt;容器生命周期管理&lt;/h2&gt;
&lt;h3 id=&#34;run&#34;&gt;run&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker run 用于创建一个新的容器并运行一个命令&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker run [options] image [command] [args...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-a stdin: 指定标准输入输出内容类型，可选 STDIN/STDOUT/STDERR 三项；
-d：后台运行容器，并返回容器ID；
-i：以交互模式运行容器，通常与 -t 同时使用；
-t：为容器重新分配一个伪输入终端，通常与 -i 同时使用；
--name=&amp;quot;abc&amp;quot;：为容器指定一个名称；
--dns 8.8.8.8：指定容器使用的DNS服务器，默认和宿主机一致；
--dns-search example.com：指定容器DNS搜索域名，默认和宿主机一致；
-h,--hostname=&amp;quot;host_name&amp;quot;：指定容器的主机名为host_name；
-e username=&amp;quot;xdhuxc&amp;quot;：设置环境变量；
--env-file=[]：从指定文件读入环境变量；
--cpuset=&amp;quot;0-2&amp;quot; 或 --cpuset=&amp;quot;0,1,2&amp;quot;：绑定容器到指定CPU运行；
-m：设置容器使用内存最大值；
--net=&amp;quot;bridge&amp;quot;：指定容器的网络连接类型，支持 bridge、host、none、container 四种类型；
--net=bridge：默认值，在Docker网桥上为容器创建新的网络栈；
--net=host：让Docker不要将容器网络放到隔离的命名空间中，即不要容器化容器内的网络。此时容器使用本地主机的网络，它拥有完全的本地主机接口访问权限。容器进程可以跟主机其他root进程一样打开低范围的端口，可以访问本地网络服务，还可以让容器做一些影响整个主机系统的事情，比如重启主机。因此，使用这个选项的时候要非常小心。如果进一步使用--privileged=true参数，容器甚至会被允许直接配置主机的网络堆栈；
--net=container：让Docker将新建容器的进程放到一个已存在容器的网络栈中，新容器进程有自己的文件系统、进程列表和资源限制，但会和已存在的容器共享IP地址和端口等网络资源，两者进程可以直接通过lo环回接口通信；
--net=none：让Docker将新容器放到隔离的网络栈中，但是不进行网络配置。之后，用户可以自己进行配置；
--link=[]：添加链接到另一个容器；
--expose=[]：开放一个端口或一组端口；
-v host_folder:container_folder：将主机目录挂载到容器目录；
--rm：在容器运行结束时自动清理其所产生的数据；
-w,--workdir=&amp;quot;&amp;quot;：指定容器的工作目录；
--privileged=true：使用该参数，容器内的root用户才能拥有真正的root权限；否则，容器内的root用户只具有外部的一个普通用户权限；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、使用docker镜像nginx:latest以后台模式启动一个容器,并将容器命名为xyz_nginx。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker run --name xyz_nginx -d nginx:latest 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、使用镜像 nginx:latest 以后台模式启动一个容器,并将容器的80端口映射到主机随机端口。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker run -P -d nginx:latest 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、使用镜像 nginx:latest 以后台模式启动一个容器,将容器的80端口映射到主机的80端口,主机的目录 /data/xdhuxc映射到容器的 /data。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker run -p 80:80 -v /data/xdhuxc:/data -d nginx:latest  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;4、使用镜像nginx:latest以交互模式启动一个容器,在容器内执行/bin/bash命令&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker run -it nginx:latest /bin/bash 
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;startstoprestart&#34;&gt;start/stop/restart&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker start 用于启动一个或多个已经被停止的容器
docker stop 用于停止一个或多个运行中的容器
docker restart 用于重启一个或多个停止的容器&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h5 id=&#34;语法-1&#34;&gt;语法&lt;/h5&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker start [options] container [container...]

docker stop [options] container [container...]

docker restart [options] container [container...]
&lt;/code&gt;&lt;/pre&gt;&lt;h5 id=&#34;示例-1&#34;&gt;示例&lt;/h5&gt;
&lt;p&gt;1、启动已被停止的容器&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker start xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、停止运行中的容器xdhuxc&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker stop xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、重启容器myrunoob&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker restart xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;kill&#34;&gt;kill&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker kill 用于杀死一个运行中的容器&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-2&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker kill [options] container [container...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-1&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-s：向容器发送一个信号
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-2&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、杀掉运行中的容器xdhuxc&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker kill -s KILL xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;rm&#34;&gt;rm&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker rm 用于删除一个或多个容器&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-3&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker rm [options] container [container...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-2&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-f：通过SIGKILL信号强制删除一个运行中的容器；
-l：移除容器间的网络连接，而非容器本身；
-v：删除与容器关联的卷；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-3&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、强制删除容器xdhuxc_1、xdhuxc_2&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker rm -f xdhuxc_1 xdhuxc_2
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、移除容器nginx_1对容器xdhuxc_1的连接，连接名为：nginx_xdhuxc&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker rm -l nginx_xdhuxc 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、删除容器xdhuxc，并删除容器挂载的数据卷&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker rm -v xdhuxc
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;pauseunpause&#34;&gt;pause/unpause&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker pause 命令用于暂停容器中的所有进程&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;docker unpause命令用于恢复容器中的所有进程&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-4&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker pause [options] container [container...]
docker unpause [options] container [container...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-4&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、暂停数据库容器db_one提供的服务&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker pause db_one
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、恢复数据库容器db_one提供的服务&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker unpause db_one 
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;create&#34;&gt;create&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker create 命令用于创建一个新的容器但不启动它&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-5&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker create [options] image [command] [args...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-5&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、使用镜像nginx:latest创建一个容器,并将容器命名为xnginx&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker create --name=xnginx nginx:latest
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;exec&#34;&gt;exec&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker exec 命令用于在运行的容器中执行命令&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-6&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker exec [options] container command [arg...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-3&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-d：分离模式，即在后台运行；
-i：交互式模式，即使没有附加也保持标准输出打开；
-t：分配一个伪终端；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-6&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、在容器xnginx中以交互模式执行容器内/root/startup.sh脚本&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker exec -it xnginx /bin/sh /root/startup.sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、在容器xnginx中开启一个交互模式的终端&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker exec -i -t xnginx /bin/bash
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;容器操作&#34;&gt;容器操作&lt;/h2&gt;
&lt;h3 id=&#34;ps&#34;&gt;ps&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker ps 命令用于显示容器&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-7&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker ps [options]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-4&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-a：显示所有容器，包括未运行的容器；
-f：根据条件过滤显示的内容；
--format：指定返回值的模板文件；
-l：显示最近创建的容器；
-n：列出最近创建的n个容器；
--no-trunc：不截断输出；
-q：静默模式，只显示容器编号；
-s：显示总的文件大小；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-7&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、列出所有正在运行的容器的信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker ps
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、列出最近创建的5个容器的信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker ps -n 5
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、列出所有创建的容器ID&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker ps -a -q
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;inspect&#34;&gt;inspect&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker inspect 命令用于获取容器或镜像的元数据&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-8&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker inspect [options] name|id [name|id...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-5&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-f：指定返回值的模板文件；
-s：显示总的文件大小；
--type：为指定类型返回JSON；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-8&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、获取镜像mysql:5.7的元数据信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker inspect mysql:5.6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、获取正在运行的容器mysql的IP地址&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker inspect --format=&#39;{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}&#39; mysql
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;top&#34;&gt;top&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker top 命令用于查看容器中运行的进程信息，支持ps命令参数。容器运行时不一定有/bin/bash终端来交互执行top命令，而且容器还不一定有top命令，可以使用docker top来实现查看container中正在运行的进程。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-9&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker top [options] container [ps options]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-9&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、查看容器mysql的进程信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker top mysql
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、查看所有运行中容器的进程信息&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;for i in  `docker ps |grep Up|awk &#39;{print $1}&#39;`;do echo \ &amp;amp;&amp;amp; docker top $i; done
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;attach&#34;&gt;attach&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker attach 命令用于连接到正在运行中的容器&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-10&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker attach [options] container
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;要attach上去的容器必须正在运行，可以同时连接上同一个容器来共享屏幕。
attach后可以通过CTRL-C来detach，但实际上，如果容器当前在运行bash，CTRL-C自然是当前行的输入，没有退出；如果容器当前正在前台运行进程，如输出nginx的access.log日志，CTRL-C不仅会导致退出容器，而且还停止了。这不是我们想要的，detach的意思按理应该是脱离容器终端，但容器依然运行。好在attach是可以带上--sig-proxy=false来确保CTRL-D或CTRL-C不会关闭容器。&lt;/p&gt;
&lt;h4 id=&#34;示例-10&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、容器nginx将访问日志定向到标准输出，连接到容器查看访问信息。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker attach --sig-proxy=false nginx
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;events&#34;&gt;events&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker events 命令用于从服务器获取实时事件&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-11&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker events [options]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-6&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-f：根据条件过滤事件；
--since：从指定的时间戳后显示所有事件；
--until：流水时间显示到指定的时间为止；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-11&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、显示 docker 2016年7月1日后的所有事件。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker events --since=&amp;quot;1467302400&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、显示 docker 镜像为mysql:5.7 2016年7月1日后的相关事件&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker events -f &amp;quot;image&amp;quot;=&amp;quot;mysql:5.7&amp;quot; --since=&amp;quot;1467302400&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;如果指定的时间是到秒级的，需要将时间转成时间戳。如果时间为日期的话，可以直接使用，如--since=&amp;quot;2016-07-01&amp;quot;。&lt;/p&gt;
&lt;h3 id=&#34;logs&#34;&gt;logs&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker logs用于获取容器的日志&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-12&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker logs [options] container
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-7&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-f：跟踪日志输出；
--since：显示某个开始时间的所有日志；
-t：显示时间戳；
--tail：仅列出最新N条容器日志；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-12&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、跟踪查看容器nginx的日志输出&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker logs -f nginx
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、查看容器nginx从2016年07月01日后的最新10条日志&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker logs --since=&amp;quot;2016-07-01&amp;quot; --tail=10 nginx
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;wait&#34;&gt;wait&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker wait 命令用于阻塞运行直到容器停止，然后打印出它的退出代码&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-13&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker wait [options] container [container...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-13&#34;&gt;示例&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker wait container
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;export&#34;&gt;export&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker export 命令用于将文件系统作为一个tar归档文件导出到STDOUT&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-14&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker export [options] container
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-8&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-o：将输入内容写到文件
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-14&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、将ID为a404c6c174a2的容器按日期保存为tar文件。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker export -o mysql-`date +%Y%m%d`.tar a404c6c174a2
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;port&#34;&gt;port&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker port 命令用于列出指定的容器的端口映射，或者查找将PRIVATE_PORT NAT到面向公众的端口&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-15&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker port [options] container [private_port[/proto]]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-15&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、查看容器nginx的端口映射情况&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker port nginx
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;容器-rootfs-命令&#34;&gt;容器 rootfs 命令&lt;/h2&gt;
&lt;h3 id=&#34;commit&#34;&gt;commit&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker commit命令用于从容器创建一个新的镜像&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-16&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker commit [options] container [repository][:tag]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-9&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-a：提交的镜像作者；
-c：使用Dockerfile指令来创建镜像；
-m：提交时的说明文字；
-p：在commit时，将容器暂停；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-16&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、将容器a404c6c174a2 保存为新的镜像，并添加提交人信息和说明信息。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker commit -a &amp;quot;xdhuxc&amp;quot; -m &amp;quot;x-mysql&amp;quot; a404c6c174a2  xmysql:1.0.0 
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;cp&#34;&gt;cp&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker cp 命令用于容器与主机之间的数据复制&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-17&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker cp [options] container:src_path dest_path|-
docker cp [options] src_path|- container:dest_path
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-10&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-L：保持源目标中的链接
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-17&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、将主机/www/run目录复制到容器96f7f14e99ab的/www目录下。&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker cp /www/run 96f7f14e99ab:/www/
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、将主机/www/run目录复制到容器96f7f14e99ab中，目录重命名为www&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker cp /www/run 96f7f14e99ab:/www
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、将容器96f7f14e99ab的/www目录复制到主机的/tmp目录中&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker cp 96f7f14e99ab:/www /tmp/
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;diff&#34;&gt;diff&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker diff 命令用于检查容器里文件结构的更改&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-18&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker diff [options] container
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-18&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、查看容器mysql的文件结构更改&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker diff mysql
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;镜像仓库&#34;&gt;镜像仓库&lt;/h2&gt;
&lt;h3 id=&#34;login&#34;&gt;login&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker login 命令用于登陆到一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;docker logout 命令用于退出一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-19&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker login [options] [server]
docker logout [options] [server]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-11&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-u：登陆的用户名；
-p：登陆的密码；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-19&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、登陆到Docker Hub&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker login -u username -p password
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、退出Docker Hub&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker logout
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;pull&#34;&gt;pull&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker pull 命令用于从镜像仓库中拉取或者更新指定镜像&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-20&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker pull [options] name[:tag|@DIGEST]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-12&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-a：拉取所有 tagged 镜像；
--disable-content-trust：忽略镜像的校验,默认开启；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-20&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、从 Docker Hub 下载java最新版镜像&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker pull java
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、从 Docker Hub 下载 REPOSITORY 为 java 的所有镜像&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker pull -a java
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;push&#34;&gt;push&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker push 命令用于将本地的镜像上传到镜像仓库，要先登陆到镜像仓库&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-21&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker push [options] name[:tag]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-13&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;--disable-content-trust：忽略镜像的校验,默认开启
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-21&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、上传本地镜像apache:latest到镜像仓库中&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker push apache:latest
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;search&#34;&gt;search&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker search 命令用于从 Docker Hub 中查找镜像&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-22&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker search [options] term
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-14&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;--automated：只列出 automated build类型的镜像；
--no-trunc：显示完整的镜像描述；
-s：列出收藏数不小于指定值的镜像；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-22&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、从 Docker Hub 上查找所有镜像名中包含java，并且收藏数大于10的镜像&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker search -s 10 java
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;本地镜像管理&#34;&gt;本地镜像管理&lt;/h2&gt;
&lt;h3 id=&#34;images&#34;&gt;images&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker images 命令用于列出本地镜像&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-23&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker images [options] [repository[:tag]]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-15&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-a：列出本地所有的镜像（含中间映像层，默认情况下，过滤掉中间映像层）；
--digests：显示镜像的摘要信息；
-f：显示满足条件的镜像；
--format：指定返回值的模板文件；
--no-trunc：显示完整的镜像信息；
-q：只显示镜像ID；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-23&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、查看本地镜像列表&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker images
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2、列出本地镜像中 REPOSITORY 为 ubuntu 的镜像列表&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker images ubuntu
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;rmi&#34;&gt;rmi&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker rmi 命令用于删除本地一个或多个镜像&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-24&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker rmi [options] image [image...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-16&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-f：强制删除；
--no-prune：不移除该镜像的过程镜像，默认移除；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-24&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、强制删除本地镜像 &lt;code&gt;nginx:latest&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker rmi -f nginx:latest
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;tag&#34;&gt;tag&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker tag命令用于标记本地镜像，将其归入某一仓库&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-25&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker tag [options] image[:tag] [registry host/][username/]name[:tag]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-25&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、将镜像 &lt;code&gt;ubuntu:15.10&lt;/code&gt; 标记为 &lt;code&gt;xdhuxc/ubuntu:v3&lt;/code&gt; 镜像&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker tag ubuntu:15.10 xdhuxc/ubuntu:v3
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;build&#34;&gt;build&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker build 命令用于使用Dockerfile创建镜像&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-26&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker build [options] path|url|-
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-17&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;--build-arg=[]：设置镜像创建时的变量；
--cpu-shares：设置 cpu 使用权重；
--cpu-period：限制 CPU CFS周期；
--cpu-quota：限制 CPU CFS配额；
--cpuset-cpus：指定使用的CPU id；
--cpuset-mems：指定使用的内存 id；
--disable-content-trust：忽略校验，默认开启；
-f：指定要使用的Dockerfile路径；
--force-rm：设置镜像过程中删除中间容器；
--isolation：使用容器隔离技术；
--label=[]：设置镜像使用的元数据；
-m :设置内存最大值；
--memory-swap：设置Swap的最大值为内存+swap，&amp;quot;-1&amp;quot;表示不限swap；
--no-cache：创建镜像的过程不使用缓存；
--pull：尝试去更新镜像的新版本；
-q：静默模式，成功后只输出镜像ID；
--rm：设置镜像成功后删除中间容器；
--shm-size：设置/dev/shm的大小，默认值是64M；
--ulimit：Ulimit配置。
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-26&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、使用当前目录的 &lt;code&gt;Dockerfile&lt;/code&gt; 创建镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker build -t xdhuxc/mysql:5.7 .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、使用 URL &lt;code&gt;github.com/creack/docker-firefox&lt;/code&gt; 的 &lt;code&gt;Dockerfile&lt;/code&gt; 创建镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker build github.com/creack/docker-firefox
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、指定 dockerfile 构建镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker build -t xdhuxc/go-build:v1.13.11 -f Dockerfile-local .
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;history&#34;&gt;history&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker history 命令用于查看指：定镜像的创建历史&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-27&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker history [options] image
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-18&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-H：以可读的格式打印镜像大小和日期，默认为true；
--no-trunc：显示完整的提交记录；
-q：仅列出提交记录ID；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-27&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、查看本地镜像 &lt;code&gt;xdhuxc/mysql:5.7&lt;/code&gt; 的创建历史&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker history xdhuxc/mysql:5.7
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;save&#34;&gt;save&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker save 命令用于将指定的镜像保存成tar归档文件&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-28&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker save [options] image [image...]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-19&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-o：输出到的文件
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-28&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、将镜像 &lt;code&gt;xdhuxc/mysql:5.7&lt;/code&gt; 保存为 &lt;code&gt;mysql.tar&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker save xdhuxc/mysql:5.7 -o mysql.tar
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;import&#34;&gt;import&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;docker import 命令用于从归档文件中创建镜像&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;语法-29&#34;&gt;语法&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker import [options] file|URL|- [repository[:tag]]
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;选项说明-20&#34;&gt;选项说明&lt;/h4&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-c：应用 docker 指令创建镜像；
-m：提交时的说明文字；
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;示例-29&#34;&gt;示例&lt;/h4&gt;
&lt;p&gt;1、从镜像归档文件 &lt;code&gt;mysql.tar&lt;/code&gt; 创建镜像，命名为 &lt;code&gt;xdhuxc/mysql:5.7&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;docker import mysql.tar xdhuxc/mysql:5.7
&lt;/code&gt;&lt;/pre&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 实用命令总结</title>
                <link>https://xdhuxc.github.io/posts/linux/linux-practical-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/linux/linux-practical-command/</guid>
                <pubDate>Fri, 18 Aug 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客整理了一些 Linux 系统中的实用命令，包括一些组合命令，可以直接修改使用。&lt;/p&gt;
&lt;h3 id=&#34;杀死某个进程&#34;&gt;杀死某个进程&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;kill -9 $(ps -ef | grep -v grep | grep nginx | awk &amp;#39;{print $2}&amp;#39;)
或
ps -ef|grep nginx|grep -v grep|awk &amp;#39;{print $2}&amp;#39;|xargs kill             # 杀死所有Nginx相关进程
或
kill -9 $(netstat -tlnup | grep 80 | awk -F &amp;#39; &amp;#39; &amp;#39;{print $7}&amp;#39; | cut -d / -f1) # 杀死占用某个端口的命令
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;查找占用某端口的进程&#34;&gt;查找占用某端口的进程&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;netstat -tlnup|grep 35888|awk -F &amp;#39; &amp;#39; &amp;#39;{print $7}&amp;#39;|cut -d / -f2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;置空文件&#34;&gt;置空文件&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo &amp;#34;&amp;#34; &amp;gt; abc.txt # abc.txt 文件内部会有一个空行
或
: &amp;gt; abc.txt # abc.txt 文件内部没有空行
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;切换到-root-用户&#34;&gt;切换到 root 用户&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo su - # 由普通用户无密码切换到 root 用户
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;查看进程及其子进程&#34;&gt;查看进程及其子进程&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gh&#34;&gt;# -l：不截断输出，显示整个进程或线程的启动命令
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# 3376：要显示的进程 ID
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;# -a：显示命令行参数
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;pstree -a -l 3376
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;时间格式&#34;&gt;时间格式&lt;/h3&gt;
&lt;p&gt;1）获得 &lt;code&gt;2018-04-19&lt;/code&gt; 样式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;date +&amp;#34;%Y-%m-%d&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行效果如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# date +&amp;#34;%Y-%m-%d&amp;#34;
2018-04-19
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）获得 &lt;code&gt;20180419&lt;/code&gt; 样式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;date +&amp;#34;%Y%m%d&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行效果如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# date +&amp;#34;%Y-%m-%d&amp;#34;
20180419
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）仅包含年月日的日期格式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;date +&amp;#34;%Y-%m-%d&amp;#34; 
或 
date -d today +&amp;#34;%Y-%m-%d&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行效果如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# date +&amp;#34;%Y-%m-%d&amp;#34;
2018-04-19
[root@localhost ~]# date -d today +&amp;#34;%Y-%m-%d&amp;#34;
2018-04-19
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4）包含日期和时间的格式&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;date +&amp;#34;%Y-%m-%d %H:%M:%S&amp;#34; 
或 
date +&amp;#34;%Y-%m-%d %T&amp;#34;
或
date -d today +&amp;#34;%Y-%m-%d %T&amp;#34; 
或
date -d today +&amp;#34;%Y-%m-%d %H:%M:%S&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;执行效果如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# date +&amp;#34;%Y-%m-%d %H:%M:%S&amp;#34;
2018-04-19 11:39:47
[root@localhost ~]# date +&amp;#34;%Y-%m-%d %T&amp;#34;
2018-04-19 11:39:59
[root@localhost ~]# date -d today +&amp;#34;%Y-%m-%d %T&amp;#34; 
2018-04-19 11:40:07
[root@localhost ~]# date -d today +&amp;#34;%Y-%m-%d %H:%M:%S&amp;#34;
2018-04-19 11:40:16
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;修改系统时区&#34;&gt;修改系统时区&lt;/h3&gt;
&lt;p&gt;修改当前机器时间为北京时间：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改EDT时区为CST时区&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;timedatectl set-timezone Asia/Shanghai
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;获取-unix-时间戳&#34;&gt;获取 UNIX 时间戳&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;date +%s
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;删除文件和目录时不删除隐藏的文件和目录&#34;&gt;删除文件和目录时不删除隐藏的文件和目录&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;rm -r ./*
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;想删除隐藏的目录或文件，需要使用如下的命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ls -a | xargs rm -r 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;但是不能删除 &lt;code&gt;.&lt;/code&gt; 和 &lt;code&gt;..&lt;/code&gt; 目录，所以该命令的返回值为 &lt;code&gt;1&lt;/code&gt;。&lt;/p&gt;
&lt;h3 id=&#34;字符串替换&#34;&gt;字符串替换&lt;/h3&gt;
&lt;p&gt;1）将当前目录下所有文件中的 &lt;code&gt;127.0.0.1&lt;/code&gt; 修改为 &lt;code&gt;172.20.15.29&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sed -i &amp;#34;s/127.0.0.1/172.20.15.29/g&amp;#34; ./*
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）将当前目录下所有文件中的 &lt;code&gt;127.0.0.1&lt;/code&gt; 或 &lt;code&gt;localhost&lt;/code&gt; 修改为 &lt;code&gt;172.20.15.29&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sed -i &amp;#34;s/\(127.0.0.1\|localhost\)/172.20.15.29/g&amp;#34; ./*
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;按文件扩展名查找文件&#34;&gt;按文件扩展名查找文件&lt;/h3&gt;
&lt;p&gt;查找当前目录下所有以 &lt;code&gt;.sh&lt;/code&gt;，&lt;code&gt;.service&lt;/code&gt;，&lt;code&gt;.conf&lt;/code&gt;，&lt;code&gt;.yaml&lt;/code&gt; 结尾的文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;find ./ -regex &amp;#39;.*\.sh\|.*\.service\|.*\.conf\|.*\.yaml&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;jar-命令&#34;&gt;jar 命令&lt;/h3&gt;
&lt;p&gt;1）将目录打包成war包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;jar -cvfM0 abc.war */ . # java cvf 打包文件名称 要打包的目录 打包文件保存路径 
-c：创建war包；
-v：显示打包过程；
-f：指定 JAR 文件名，通常这个参数是必须的；
-M：不产生所有项的清单（MANIFEST〕文件，此参数会忽略 -m 参数；
-0：阿拉伯数字0，表示只打包不压缩；
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）解压war包&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;jar -xvf abc.war # 解压war包
或
unzip abc.war -d abc/ &lt;span class=&#34;ni&#34;&gt;#解压war包到指定的目录abc&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;关闭-selinux&#34;&gt;关闭 selinux&lt;/h3&gt;
&lt;p&gt;到 &lt;code&gt;/etc/sysconfig&lt;/code&gt; 目录下，修改 selinux 文件，设置 &lt;code&gt;SELINUX=&amp;quot;enforcing&amp;quot;&lt;/code&gt; 为 &lt;code&gt;disabled&lt;/code&gt; 并重启系统&lt;/p&gt;
&lt;p&gt;使用命令 &lt;code&gt;setenforce 0&lt;/code&gt; 临时关闭 SElinux
使用命令 &lt;code&gt;getenforce&lt;/code&gt; 或 &lt;code&gt;sestatus -v &lt;/code&gt;查看 SElinux 的状态&lt;/p&gt;
&lt;p&gt;注意：
&lt;code&gt;/etc/sysconfig/selinux&lt;/code&gt; 文件链接到了文件&lt;code&gt;/etc/selinux/config&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;firewalld-开放端口&#34;&gt;firewalld 开放端口&lt;/h3&gt;
&lt;p&gt;使用如下命令开放端口：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;firewall-cmd --zone=public --add-port=8004/tcp --permanent 
&lt;span class=&#34;gh&#34;&gt;# --zone #作用域 --add-port=80/tcp  #添加端口，格式为：端口/通讯协议 --permanent  #永久生效，没有此参数重启后失效
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;firewall-cmd --reload # 重启防火墙
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;查看指定进程的相关信息&#34;&gt;查看指定进程的相关信息&lt;/h3&gt;
&lt;p&gt;1、查看如下文件中的内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@k8s-master ~]# cat /proc/4561/status
Name:	java
Umask:	0022
State:	S (sleeping)
Tgid:	4561
Ngid:	4561
Pid:	4561
PPid:	1
TracerPid:	0
Uid:	0	0	0	0
Gid:	0	0	0	0
FDSize:	256
Groups:	0 
VmPeak:	19751020 kB
VmSize:	19751020 kB
VmLck:	       0 kB
VmPin:	       0 kB
VmHWM:	  207228 kB
VmRSS:	  207228 kB
RssAnon:	  192420 kB
RssFile:	   14808 kB
RssShmem:	       0 kB
VmData:	19575744 kB
VmStk:	     132 kB
VmExe:	       4 kB
VmLib:	   16344 kB
VmPTE:	    2336 kB
VmSwap:	       0 kB
Threads:	273
SigQ:	1/513396
SigPnd:	0000000000000000
ShdPnd:	0000000000000000
SigBlk:	0000000000000000
SigIgn:	0000000000000003
SigCgt:	2000000181005ccc
CapInh:	0000000000000000
CapPrm:	0000001fffffffff
CapEff:	0000001fffffffff
CapBnd:	0000001fffffffff
CapAmb:	0000000000000000
Seccomp:	0
Cpus_allowed:	ff,ffffffff,ffffffff
Cpus_allowed_list:	0-71
Mems_allowed:	00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000003
Mems_allowed_list:	0-1
voluntary_ctxt_switches:	4
nonvoluntary_ctxt_switches:	3
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、使用如下命令查看&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;ps -T -p 4561          # 2561 为进程 ID。
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/%E6%8A%80%E6%9C%AF/">技术</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/linux/">linux</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>docker 基础知识</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-basic-knowledge/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-basic-knowledge/</guid>
                <pubDate>Thu, 20 Jul 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Docker 的应用场景，优势及其相关的一些概念。&lt;/p&gt;
&lt;h3 id=&#34;docker&#34;&gt;Docker&lt;/h3&gt;
&lt;p&gt;Docker 是一个开源的应用容器引擎，基于 Go 语言 并遵从 Apache2.0 协议开源。 Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。 容器完全使用沙箱机制，相互之间不会有任何接口，更重要的是容器的性能开销极低。&lt;/p&gt;
&lt;h3 id=&#34;docker-的应用场景&#34;&gt;Docker 的应用场景&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Web 应用的自动化打包和发布；&lt;/li&gt;
&lt;li&gt;自动化测试和持续集成、发布；&lt;/li&gt;
&lt;li&gt;在服务型环境中部署和调整数据库或其他的后台应用；&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;docker-的优势&#34;&gt;Docker 的优势&lt;/h3&gt;
&lt;p&gt;1、更快速的交付和部署。使用Docker，开发人员可以使用镜像来快速构建一套标准的开发环境；开发完成后，测试和运维人员可以直接使用相同环境来部署代码。Docker可以快速创建和删除容器，实现快速迭代，大量节约开发、测试、部署的时间。&lt;/p&gt;
&lt;p&gt;2、更高效的资源利用。Docker容器的运行不需要额外的虚拟化管理程序支持，它是内核级的虚拟化，可以实现更高的性能，同时对资源的额外需求很低。&lt;/p&gt;
&lt;p&gt;3、更轻松的迁移和扩展。Docker容器几乎可以在任意的平台上运行，这种兼容性让用户可以在不同平台之间轻松地迁移应用。&lt;/p&gt;
&lt;p&gt;4、更简单的更新管理。使用Dockerfile，只需要修改配置文件，就可以替代以往大量的更新工作。所有修改都以增量的方式进行分发和更新，从而实现自动化且高效的容器管理。&lt;/p&gt;
&lt;h3 id=&#34;docker-的镜像容器和仓库&#34;&gt;Docker 的镜像、容器和仓库&lt;/h3&gt;
&lt;p&gt;1、Docker的镜像概念类似于虚拟机里的镜像，是一个只读的模板，一个独立的文件系统，包括运行容器所需的数据，可以用来创建新的容器。&lt;/p&gt;
&lt;p&gt;2、Docker容器是由Docker镜像创建的运行实例。Docker容器类似虚拟机，可以支持的操作包括启动、停止、删除等。每个容器间是相互隔离的，容器中会运行特定的应用，包含特定应用的代码及所需的依赖文件。&lt;/p&gt;
&lt;p&gt;3、Docker 仓库是用来存储镜像的位置，Docker提供一个注册服务器（Register）来保存多个仓库，每个仓库又可以包含多个具备不同tag的镜像。Docker运行中使用的默认仓库是 Docker Hub 公共仓库。&lt;/p&gt;
&lt;h3 id=&#34;docker-与虚拟机的比较&#34;&gt;Docker 与虚拟机的比较&lt;/h3&gt;
&lt;p&gt;作为一种轻量级的虚拟化方式，Docker在运行应用上跟传统的虚拟机方式相比具有显著的优势：&lt;/p&gt;
&lt;p&gt;1、Docker容器很快，启动和停止可以在秒级实现，这比传统的虚拟机方式要快得多；&lt;/p&gt;
&lt;p&gt;2、Docker容器对系统资源需求很少，除了运行在其中的容器外，基本不消耗额外的系统资源，保证应用性能的同时，尽量减小系统开销，一台主机上可以同时运行数千个Docker容器；&lt;/p&gt;
&lt;p&gt;3、Docker通过类似Git的操作来方便用户获取、分发和更新应用镜像，指令简明，学习成本较低；&lt;/p&gt;
&lt;p&gt;4、Docker通过Dockerfile配置文件来支持灵活的自动化创建和部署机制，提高工作效率；&lt;/p&gt;
&lt;p&gt;虚拟机是模拟运行的一整套操作系统（提供了运行时环境和其他系统环境）和运行在其上面的应用。&lt;/p&gt;
&lt;p&gt;Docker 容器是独立运行的一个或一组应用，以及它们运行时所必需的环境。&lt;/p&gt;
&lt;p&gt;Docker 技术与虚拟机技术的特性比较：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;特性&lt;/th&gt;
&lt;th&gt;容器&lt;/th&gt;
&lt;th&gt;虚拟机&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;启动速度&lt;/td&gt;
&lt;td&gt;秒级&lt;/td&gt;
&lt;td&gt;分钟级&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;硬盘使用&lt;/td&gt;
&lt;td&gt;一般为MB&lt;/td&gt;
&lt;td&gt;一般为GB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;性能&lt;/td&gt;
&lt;td&gt;接近原生&lt;/td&gt;
&lt;td&gt;弱于&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;系统支持量&lt;/td&gt;
&lt;td&gt;单机支持上千个容器&lt;/td&gt;
&lt;td&gt;一般几十个&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;隔离性&lt;/td&gt;
&lt;td&gt;安全隔离&lt;/td&gt;
&lt;td&gt;完全隔离&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;对-docker-的理解&#34;&gt;对 docker 的理解&lt;/h3&gt;
&lt;p&gt;从 Dockerfile 文件的内容，即系统所完成的操作来看，docker其实是在一个简化的极小版Linux操作系统中安装应用程序所需的环境，然后可以部署应用程序，与外部进行隔离，通过接口和网络与外部进行资源和信息交换。&lt;/p&gt;
&lt;p&gt;docker = linux + 应用环境 + 应用程序&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>docker 基础知识（二）</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-basic-knowledge-two/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-basic-knowledge-two/</guid>
                <pubDate>Thu, 20 Jul 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客介绍了 Docker 容器的一些基础知识和基本原理。&lt;/p&gt;
&lt;p&gt;使用 docker 时，要求 Linux 内核版本必须是 3.10 及以上版本。&lt;/p&gt;
&lt;p&gt;docker 容器的状态机：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/docker/basic-knowledge-two/docker-status.jpg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图1 · docker 容器的状态机
&lt;/center&gt;
&lt;p&gt;一个容器在某个时刻可能处于以下几种状态之一：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;created：已经被创建（使用 docker ps -a 命令可以查看），但是还没有启动（使用 docker ps 命令还无法查看）。&lt;/li&gt;
&lt;li&gt;running：运行中。&lt;/li&gt;
&lt;li&gt;paused：容器的进程被暂停了。&lt;/li&gt;
&lt;li&gt;restarting：容器的进程正在重启过程中。&lt;/li&gt;
&lt;li&gt;exited：即 stopped 状态，表示容器之前运行过，但是现在处于停止状态，可以通过 start 命令使其重新进入 running 状态。区别于 created 状态，它是指一个新创建出来的尚未运行过的容器。&lt;/li&gt;
&lt;li&gt;destroyed：容器被删除了，再也不存在了。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;docker-stop-和-docker-kill-命令的异同&#34;&gt;docker stop 和 docker kill 命令的异同&lt;/h3&gt;
&lt;h4 id=&#34;docker-stop&#34;&gt;docker stop&lt;/h4&gt;
&lt;p&gt;在 docker stop 命令执行的时候，会先向容器中 PID 为 1 的进程（systemd）发送系统信号 SIGTERM，然后等待容器中的应用程序终止执行。如果等待时间达到设定的超时时间（默认为：10 秒，用户可以指定特定的超时时长），会继续发送 SIGKILL 的系统信号强行 KILL 掉进程。在容器中的应用程序，可以选择忽略和不处理 SIGTERM 信号，不过一旦达到超时时间，程序就会被系统强行 kill 掉，因为 SIGKILL 信号是直接发往系统内核的，应用程序没有机会去处理它。&lt;/p&gt;
&lt;p&gt;例如，运行 &lt;code&gt;docker stop mysql -t 20&lt;/code&gt; 命令后：（使用 docker events 命令可以查看实时 docker 事件）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;2018-06-27T15:10:50.647582607+08:00 container kill 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (image=mysql:5.7.22, name=mysql, signal=15)
2018-06-27T15:10:52.320188793+08:00 container die 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (exitCode=0, image=mysql:5.7.22, name=mysql)
2018-06-27T15:10:52.456917929+08:00 network disconnect d007b6118f653475246dec898994a972d2f9a061d01ab5a339977cd70a6887bf (container=1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f, name=bridge, type=bridge)
2018-06-27T15:10:52.524146055+08:00 volume unmount 845a3048d2138831a4e6e542dfd01794cb6524493839590a37f7936942890742 (container=1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f, driver=local)
2018-06-27T15:10:52.537384805+08:00 container stop 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (image=mysql:5.7.22, name=mysql)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;能看到：&lt;/p&gt;
&lt;p&gt;1、首先 docker 向容器发出 SIGTERM 信号（signal = 15）。&lt;/p&gt;
&lt;p&gt;2、等待 20 秒（01:18 到 01:38）。&lt;/p&gt;
&lt;p&gt;3、再发送 SIGKILL 系统信号（signal = 9）。&lt;/p&gt;
&lt;p&gt;4、然后容器就被杀死了（die）。&lt;/p&gt;
&lt;h4 id=&#34;docker-kill&#34;&gt;docker kill&lt;/h4&gt;
&lt;p&gt;而 docker kill 命令会直接发出 SIGKILL 的系统信号，以强行终止容器中程序的运行。&lt;/p&gt;
&lt;p&gt;运行 &lt;code&gt;docker kill mysql&lt;/code&gt; 命令后：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;2018-06-27T15:22:41.785107639+08:00 container kill 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (image=mysql:5.7.22, name=mysql, signal=9)
2018-06-27T15:22:42.003164753+08:00 container die 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (exitCode=137, image=mysql:5.7.22, name=mysql)
2018-06-27T15:22:42.214308124+08:00 network disconnect d007b6118f653475246dec898994a972d2f9a061d01ab5a339977cd70a6887bf (container=1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f, name=bridge, type=bridge)
2018-06-27T15:22:42.294946239+08:00 volume unmount 845a3048d2138831a4e6e542dfd01794cb6524493839590a37f7936942890742 (container=1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f, driver=local)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可见直接发出的是 SIGKILL 信号，容器立刻就被杀掉了。&lt;/p&gt;
&lt;h3 id=&#34;docker-平台的基本构成&#34;&gt;docker 平台的基本构成&lt;/h3&gt;
&lt;p&gt;Docker 平台基本上由三部分组成：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;客户端：用户使用 docker 提供的工具（CLI 以及 API等）来构建、上传镜像并发布命令来创建和启动容器。&lt;/li&gt;
&lt;li&gt;docker 主机：从 docker 镜像仓库拉取镜像并启动容器。&lt;/li&gt;
&lt;li&gt;docker 镜像仓库：用于保存镜像，并提供镜像的上传和下载。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;docker-镜像&#34;&gt;docker 镜像&lt;/h3&gt;
&lt;p&gt;在传统环境中，软件在运行之前需要经过 代码开发 -&amp;gt; 运行环境准备 -&amp;gt; 安装软件 -&amp;gt; 运行软件 等环节；&lt;/p&gt;
&lt;p&gt;在容器环境中，中间的两个环节被镜像制作过程代替了，也就是说，镜像的制作过程也包括运行环境准备和安装软件等两个主要环节，以及一些其他环节。&lt;/p&gt;
&lt;p&gt;镜像是动态的容器的静态表示，包括容器所要运行的应用代码以及运行时的配置。docker 镜像包括一个或多个只读层（read-only layers），因此，镜像一旦被创建就再也不能被修改了。一个运行着的 docker 容器是一个镜像的实例。从同一个镜像中运行的容器包含有相同的应用代码和运行时依赖。但是不像镜像是静态的，每个运行着的容器都有一个可写层（writable layer，也称为 container layer），位于底下的若干只读层之上，运行时的所有变化，包括对数据和文件的写和更新，都会保存在这个层中。因此，从同一个镜像运行的多个容器包含了不同的容器层。&lt;/p&gt;
&lt;p&gt;创建一个 docker 镜像的两种方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;创建一个容器，运行若干命令，然后使用 docker commit 命令来生成一个新的镜像。不建议使用这种方式。&lt;/li&gt;
&lt;li&gt;创建一个 Dockerfile，然后使用 docker build 命令来创建一个镜像。建议使用这种方式。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;docker build 命令的过程：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;容器镜像包括元数据和文件系统，其中文件系统是指对基础镜像的文件系统的修改，元数据不影响文件系统，只是会影响容器的配置。&lt;/li&gt;
&lt;li&gt;每个步骤都会生成一个新的镜像，新的镜像与上一次的镜像相比，要么元数据有了变化，要么文件系统有了变化，而多加了一层。&lt;/li&gt;
&lt;li&gt;docker 在需要执行指令时，通过创建临时镜像，运行指定的命令，再通过 docker commit 来生成新的镜像。&lt;/li&gt;
&lt;li&gt;docker 会将中间镜像都保存在缓存中，这样将来如果能直接使用的话，就不需要再从新创建了。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;镜像分层和容器层&#34;&gt;镜像分层和容器层&lt;/h4&gt;
&lt;p&gt;一个 docker 镜像是基于基础镜像的多层叠加，最终构成了容器的 rootfs（根文件系统）。当 docker 创建了一个容器时，它会在基础镜像的容器层之上添加一层新的薄薄的可写容器层。接下来，所有对容器的变化，比如写新的文件，修改已有文件和删除文件，都只会作用在这个容器层之中。因此，通过不复制完整的 rootfs，docker 减少了容器所占用的空间，以及减少了容器启动所需时间。&lt;/p&gt;
&lt;h4 id=&#34;cow-和镜像大小&#34;&gt;COW 和镜像大小&lt;/h4&gt;
&lt;p&gt;COW，copy-on-write，写时复制技术，一方面带来了容器启动的快捷，另一方也造成了容器镜像大小的增加。每一次 &lt;code&gt;RUN&lt;/code&gt; 命令都会在镜像上增加一层，每一层都会占用磁盘空间。&lt;/p&gt;
&lt;p&gt;例如，在 Ubuntu 14.04 基础镜像中运行 &lt;code&gt;RUN apt-get upgrade&lt;/code&gt; 会在保留基础层的同时再创建一个新层来放所有新的文件，而不是修改老的文件。因此，新的镜像大小会超过直接在老的文件系统上做更新时的文件大小。所以，为了减少镜像大小起见，所有文件相关的操作，比如删除、释放和移动等，都需要尽可能地放在一个 &lt;code&gt;RUN&lt;/code&gt; 指令中进行。&lt;/p&gt;
&lt;h4 id=&#34;镜像的内容&#34;&gt;镜像的内容&lt;/h4&gt;
&lt;p&gt;容器镜像的内容，其实是一个 json 文件加上 tar 包。&lt;/p&gt;
&lt;p&gt;1、将镜像导出为 tar 文件。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# docker images|grep nginx
nginx                                                        latest              3f8a4339aadd        6 months ago        108MB
[root@xdhuxc xdhuxc]# docker save nginx:latest -o nginx.tar
[root@xdhuxc xdhuxc]# ls
nginx.tar
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、解压 nginx.tar 文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# mkdir nginx
[root@xdhuxc xdhuxc]# tar -xf nginx.tar -C nginx
tar: manifest.json: implausibly old time stamp 1970-01-01 08:00:00
tar: repositories: implausibly old time stamp 1970-01-01 08:00:00
[root@xdhuxc xdhuxc]# ll nginx
total 28
-rw-r--r-- 1 root root 5835 Dec 27  2017 3f8a4339aadda5897b744682f5f774dc69991a81af8d715d37a616bb4c99edf5.json
drwxr-xr-x 2 root root 4096 Dec 27  2017 ae57c7dd09b742b01fba1af0f40503e6f7e581a7cda614f0c36fa81af4a02129
drwxr-xr-x 2 root root 4096 Dec 27  2017 b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa
drwxr-xr-x 2 root root 4096 Dec 27  2017 b6eb01f37fe4e3091b0230a181e38d2fa37b4169daab10f85782b92e7437b027
-rw-r--r-- 1 root root  355 Jan  1  1970 manifest.json
-rw-r--r-- 1 root root   88 Jan  1  1970 repositories
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其中的 repositories 文件的内容，就是镜像名称、版本、最上层的 layer 的名称。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# cat nginx/repositories | python -m json.tool
{
    &amp;#34;nginx&amp;#34;: {
        &amp;#34;latest&amp;#34;: &amp;#34;b6eb01f37fe4e3091b0230a181e38d2fa37b4169daab10f85782b92e7437b027&amp;#34;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;而 manifest.json 文件中保存的是镜像的元数据，包括真正包含元数据的 json 文件的名称及每一层的名称、标签等。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# cat nginx/manifest.json | python -m json.tool
[
    {
        &amp;#34;Config&amp;#34;: &amp;#34;3f8a4339aadda5897b744682f5f774dc69991a81af8d715d37a616bb4c99edf5.json&amp;#34;,
        &amp;#34;Layers&amp;#34;: [
            &amp;#34;b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa/layer.tar&amp;#34;,
            &amp;#34;ae57c7dd09b742b01fba1af0f40503e6f7e581a7cda614f0c36fa81af4a02129/layer.tar&amp;#34;,
            &amp;#34;b6eb01f37fe4e3091b0230a181e38d2fa37b4169daab10f85782b92e7437b027/layer.tar&amp;#34;
        ],
        &amp;#34;RepoTags&amp;#34;: [
            &amp;#34;nginx:latest&amp;#34;
        ]
    }
]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3f8a4339aadda5897b744682f5f774dc69991a81af8d715d37a616bb4c99edf5.json 文件真正地包含镜像的所有元数据。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;  1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;  9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 88
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 89
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 90
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 91
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 92
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 93
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 94
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 95
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 96
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 97
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 98
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 99
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;100
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;101
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;102
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;103
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;104
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;105
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;106
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;107
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;108
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;109
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;110
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;111
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;112
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;113
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;114
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;115
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;116
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;117
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;118
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;119
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;120
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;121
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;122
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;123
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;124
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;125
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;126
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;127
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;128
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;129
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;130
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;131
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;132
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;133
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;134
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# cat nginx/3f8a4339aadda5897b744682f5f774dc69991a81af8d715d37a616bb4c99edf5.json | python -m json.tool
{
    &amp;#34;architecture&amp;#34;: &amp;#34;amd64&amp;#34;,
    &amp;#34;config&amp;#34;: {
        &amp;#34;ArgsEscaped&amp;#34;: true,
        &amp;#34;AttachStderr&amp;#34;: false,
        &amp;#34;AttachStdin&amp;#34;: false,
        &amp;#34;AttachStdout&amp;#34;: false,
        &amp;#34;Cmd&amp;#34;: [
            &amp;#34;nginx&amp;#34;,
            &amp;#34;-g&amp;#34;,
            &amp;#34;daemon off;&amp;#34;
        ],
        &amp;#34;Domainname&amp;#34;: &amp;#34;&amp;#34;,
        &amp;#34;Entrypoint&amp;#34;: null,
        &amp;#34;Env&amp;#34;: [
            &amp;#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&amp;#34;,
            &amp;#34;NGINX_VERSION=1.13.8-1~stretch&amp;#34;,
            &amp;#34;NJS_VERSION=1.13.8.0.1.15-1~stretch&amp;#34;
        ],
        &amp;#34;ExposedPorts&amp;#34;: {
            &amp;#34;80/tcp&amp;#34;: {}
        },
        &amp;#34;Hostname&amp;#34;: &amp;#34;&amp;#34;,
        &amp;#34;Image&amp;#34;: &amp;#34;sha256:dac2e319f33250a5b2eea74443b35d7fb05a382a95d21670f2628b92ffa023ce&amp;#34;,
        &amp;#34;Labels&amp;#34;: {
            &amp;#34;maintainer&amp;#34;: &amp;#34;NGINX Docker Maintainers &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;docker-maint&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;com&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;
        },
        &amp;#34;OnBuild&amp;#34;: [],
        &amp;#34;OpenStdin&amp;#34;: false,
        &amp;#34;StdinOnce&amp;#34;: false,
        &amp;#34;StopSignal&amp;#34;: &amp;#34;SIGTERM&amp;#34;,
        &amp;#34;Tty&amp;#34;: false,
        &amp;#34;User&amp;#34;: &amp;#34;&amp;#34;,
        &amp;#34;Volumes&amp;#34;: null,
        &amp;#34;WorkingDir&amp;#34;: &amp;#34;&amp;#34;
    },
    &amp;#34;container&amp;#34;: &amp;#34;71cc5766414f132cf702e88d8de29527bbc2e151f8499b14fcc3540fd853b86d&amp;#34;,
    &amp;#34;container_config&amp;#34;: {
        &amp;#34;ArgsEscaped&amp;#34;: true,
        &amp;#34;AttachStderr&amp;#34;: false,
        &amp;#34;AttachStdin&amp;#34;: false,
        &amp;#34;AttachStdout&amp;#34;: false,
        &amp;#34;Cmd&amp;#34;: [
            &amp;#34;/bin/sh&amp;#34;,
            &amp;#34;-c&amp;#34;,
            &amp;#34;#(nop) &amp;#34;,
            &amp;#34;CMD [\&amp;#34;nginx\&amp;#34; \&amp;#34;-g\&amp;#34; \&amp;#34;daemon off;\&amp;#34;]&amp;#34;
        ],
        &amp;#34;Domainname&amp;#34;: &amp;#34;&amp;#34;,
        &amp;#34;Entrypoint&amp;#34;: null,
        &amp;#34;Env&amp;#34;: [
            &amp;#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&amp;#34;,
            &amp;#34;NGINX_VERSION=1.13.8-1~stretch&amp;#34;,
            &amp;#34;NJS_VERSION=1.13.8.0.1.15-1~stretch&amp;#34;
        ],
        &amp;#34;ExposedPorts&amp;#34;: {
            &amp;#34;80/tcp&amp;#34;: {}
        },
        &amp;#34;Hostname&amp;#34;: &amp;#34;71cc5766414f&amp;#34;,
        &amp;#34;Image&amp;#34;: &amp;#34;sha256:dac2e319f33250a5b2eea74443b35d7fb05a382a95d21670f2628b92ffa023ce&amp;#34;,
        &amp;#34;Labels&amp;#34;: {
            &amp;#34;maintainer&amp;#34;: &amp;#34;NGINX Docker Maintainers &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;docker-maint&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;com&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;
        },
        &amp;#34;OnBuild&amp;#34;: [],
        &amp;#34;OpenStdin&amp;#34;: false,
        &amp;#34;StdinOnce&amp;#34;: false,
        &amp;#34;StopSignal&amp;#34;: &amp;#34;SIGTERM&amp;#34;,
        &amp;#34;Tty&amp;#34;: false,
        &amp;#34;User&amp;#34;: &amp;#34;&amp;#34;,
        &amp;#34;Volumes&amp;#34;: null,
        &amp;#34;WorkingDir&amp;#34;: &amp;#34;&amp;#34;
    },
    &amp;#34;created&amp;#34;: &amp;#34;2017-12-26T18:17:01.106799157Z&amp;#34;,
    &amp;#34;docker_version&amp;#34;: &amp;#34;17.06.2-ce&amp;#34;,
    &amp;#34;history&amp;#34;: [
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-12T01:44:43.599554271Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c #(nop) ADD file:f30a8b5b7cdc9ba33a250899308b490baa9f7a9b29d3a85bd16200aa0a28a04a in / &amp;#34;
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-12T01:44:43.84546055Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c #(nop)  CMD [\&amp;#34;bash\&amp;#34;]&amp;#34;,
            &amp;#34;empty_layer&amp;#34;: true
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-12T05:14:40.530307095Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c #(nop)  LABEL maintainer=NGINX Docker Maintainers &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;docker-maint&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;com&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&amp;#34;,
            &amp;#34;empty_layer&amp;#34;: true
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-26T18:14:42.009655355Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c #(nop)  ENV NGINX_VERSION=1.13.8-1~stretch&amp;#34;,
            &amp;#34;empty_layer&amp;#34;: true
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-26T18:14:42.209098573Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c #(nop)  ENV NJS_VERSION=1.13.8.0.1.15-1~stretch&amp;#34;,
            &amp;#34;empty_layer&amp;#34;: true
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-26T18:16:59.73279946Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c set -x \t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update \t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install --no-install-recommends --no-install-suggests -y gnupg1 \t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; \tNGINX_GPGKEY=573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62; \tfound=&amp;#39;&amp;#39;; \tfor server in \t\tha.pool.sks-keyservers.net \t\thkp://keyserver.ubuntu.com:80 \t\thkp://p80.pool.sks-keyservers.net:80 \t\tpgp.mit.edu \t; do \t\techo \&amp;#34;Fetching GPG key $NGINX_GPGKEY from $server\&amp;#34;; \t\tapt-key adv --keyserver \&amp;#34;$server\&amp;#34; --keyserver-options timeout=10 --recv-keys \&amp;#34;$NGINX_GPGKEY\&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; found=yes &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; break; \tdone; \ttest -z \&amp;#34;$found\&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; echo &amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;2 \&amp;#34;error: failed to fetch GPG key $NGINX_GPGKEY\&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; exit 1; \tapt-get remove --purge --auto-remove -y gnupg1 &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf /var/lib/apt/lists/* \t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; dpkgArch=\&amp;#34;$(dpkg --print-architecture)\&amp;#34; \t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; nginxPackages=\&amp;#34; \t\tnginx=${NGINX_VERSION} \t\tnginx-module-xslt=${NGINX_VERSION} \t\tnginx-module-geoip=${NGINX_VERSION} \t\tnginx-module-image-filter=${NGINX_VERSION} \t\tnginx-module-njs=${NJS_VERSION} \t\&amp;#34; \t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; case \&amp;#34;$dpkgArch\&amp;#34; in \t\tamd64|i386) \t\t\techo \&amp;#34;deb http://nginx.org/packages/mainline/debian/ stretch nginx\&amp;#34; &amp;gt;&amp;gt; /etc/apt/sources.list \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update \t\t\t;; \t\t*) \t\t\techo \&amp;#34;deb-src http://nginx.org/packages/mainline/debian/ stretch nginx\&amp;#34; &amp;gt;&amp;gt; /etc/apt/sources.list \t\t\t\t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; tempDir=\&amp;#34;$(mktemp -d)\&amp;#34; \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; chmod 777 \&amp;#34;$tempDir\&amp;#34; \t\t\t\t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; savedAptMark=\&amp;#34;$(apt-mark showmanual)\&amp;#34; \t\t\t\t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get update \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get build-dep -y $nginxPackages \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ( \t\t\t\tcd \&amp;#34;$tempDir\&amp;#34; \t\t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; DEB_BUILD_OPTIONS=\&amp;#34;nocheck parallel=$(nproc)\&amp;#34; \t\t\t\t\tapt-get source --compile $nginxPackages \t\t\t) \t\t\t\t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-mark showmanual | xargs apt-mark auto &amp;gt; /dev/null \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; { [ -z \&amp;#34;$savedAptMark\&amp;#34; ] || apt-mark manual $savedAptMark; } \t\t\t\t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ls -lAFh \&amp;#34;$tempDir\&amp;#34; \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ( cd \&amp;#34;$tempDir\&amp;#34; &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; dpkg-scanpackages . &amp;gt; Packages ) \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; grep &amp;#39;^Package: &amp;#39; \&amp;#34;$tempDir/Packages\&amp;#34; \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; echo \&amp;#34;deb [ trusted=yes ] file://$tempDir ./\&amp;#34; &amp;gt; /etc/apt/sources.list.d/temp.list \t\t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get -o Acquire::GzipIndexes=false update \t\t\t;; \tesac \t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get install --no-install-recommends --no-install-suggests -y \t\t\t\t\t\t$nginxPackages \t\t\t\t\t\tgettext-base \t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf /var/lib/apt/lists/* \t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; if [ -n \&amp;#34;$tempDir\&amp;#34; ]; then \t\tapt-get purge -y --auto-remove \t\t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -rf \&amp;#34;$tempDir\&amp;#34; /etc/apt/sources.list.d/temp.list; \tfi&amp;#34;
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-26T18:17:00.44958667Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c ln -sf /dev/stdout /var/log/nginx/access.log \t&lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; ln -sf /dev/stderr /var/log/nginx/error.log&amp;#34;
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-26T18:17:00.662765942Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c #(nop)  EXPOSE 80/tcp&amp;#34;,
            &amp;#34;empty_layer&amp;#34;: true
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-26T18:17:00.902045007Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c #(nop)  STOPSIGNAL [SIGTERM]&amp;#34;,
            &amp;#34;empty_layer&amp;#34;: true
        },
        {
            &amp;#34;created&amp;#34;: &amp;#34;2017-12-26T18:17:01.106799157Z&amp;#34;,
            &amp;#34;created_by&amp;#34;: &amp;#34;/bin/sh -c #(nop)  CMD [\&amp;#34;nginx\&amp;#34; \&amp;#34;-g\&amp;#34; \&amp;#34;daemon off;\&amp;#34;]&amp;#34;,
            &amp;#34;empty_layer&amp;#34;: true
        }
    ],
    &amp;#34;os&amp;#34;: &amp;#34;linux&amp;#34;,
    &amp;#34;rootfs&amp;#34;: {
        &amp;#34;diff_ids&amp;#34;: [
            &amp;#34;sha256:2ec5c0a4cb57c0af7c16ceda0b0a87a54f01f027ed33836a5669ca266cafe97a&amp;#34;,
            &amp;#34;sha256:73e2bd4455140950d98430338783415109e4c4dcf955681d334b312b176d964a&amp;#34;,
            &amp;#34;sha256:a103d141fc9823f04f30d1e71705001577eab94df7ac594e5e49f64e2e506c8b&amp;#34;
        ],
        &amp;#34;type&amp;#34;: &amp;#34;layers&amp;#34;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;而剩余的三个目录则与该镜像的三个 layers 一一对应。（使用 docker inspect nginx:latest）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&amp;#34;RootFS&amp;#34;: {
            &amp;#34;Type&amp;#34;: &amp;#34;layers&amp;#34;,
            &amp;#34;Layers&amp;#34;: [
                &amp;#34;sha256:2ec5c0a4cb57c0af7c16ceda0b0a87a54f01f027ed33836a5669ca266cafe97a&amp;#34;,
                &amp;#34;sha256:73e2bd4455140950d98430338783415109e4c4dcf955681d334b312b176d964a&amp;#34;,
                &amp;#34;sha256:a103d141fc9823f04f30d1e71705001577eab94df7ac594e5e49f64e2e506c8b&amp;#34;
            ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;每个目录中的内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# ll nginx/b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa/
total 57072
-rw-r--r-- 1 root root      393 Dec 27  2017 json
-rw-r--r-- 1 root root 58430976 Dec 27  2017 layer.tar
-rw-r--r-- 1 root root        3 Dec 27  2017 VERSION
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解压 layer.tar 文件，查看其内容&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# cd nginx/b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa/
[root@xdhuxc b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa]# mkdir layer
[root@xdhuxc b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa]# tar -xf layer.tar -C layer
[root@xdhuxc b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa]# ll layer/
total 76
drwxr-xr-x  2 root root 4096 Dec 10  2017 bin
drwxr-xr-x  2 root root 4096 Nov 19  2017 boot
drwxr-xr-x  2 root root 4096 Dec 10  2017 dev
drwxr-xr-x 28 root root 4096 Dec 10  2017 etc
drwxr-xr-x  2 root root 4096 Nov 19  2017 home
drwxr-xr-x  8 root root 4096 Dec 10  2017 lib
drwxr-xr-x  2 root root 4096 Dec 10  2017 lib64
drwxr-xr-x  2 root root 4096 Dec 10  2017 media
drwxr-xr-x  2 root root 4096 Dec 10  2017 mnt
drwxr-xr-x  2 root root 4096 Dec 10  2017 opt
drwxr-xr-x  2 root root 4096 Nov 19  2017 proc
drwx------  2 root root 4096 Dec 10  2017 root
drwxr-xr-x  4 root root 4096 Dec 10  2017 run
drwxr-xr-x  2 root root 4096 Dec 10  2017 sbin
drwxr-xr-x  2 root root 4096 Dec 10  2017 srv
drwxr-xr-x  2 root root 4096 Nov 19  2017 sys
drwxrwxrwt  2 root root 4096 Dec 10  2017 tmp
drwxr-xr-x 10 root root 4096 Dec 10  2017 usr
drwxr-xr-x 11 root root 4096 Dec 10  2017 var
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;从以上分析可见：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;docker 镜像中主要是 tar 文件包和元数据 json 文件。&lt;/li&gt;
&lt;li&gt;docker 镜像的打包过程，其实就是将每一层对应的文件打包过程，最后组成一个单一的 tar 文件。&lt;/li&gt;
&lt;li&gt;docker 镜像的使用过程，其实就是将一层层的 tar 文件载入到文件系统的过程。&lt;/li&gt;
&lt;/ul&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Linux 命名空间和 cgroup 在 docker 中的使用</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-namespace-and-cgroup/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-namespace-and-cgroup/</guid>
                <pubDate>Tue, 18 Jul 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了 Linux 系统中命名空间和 cgroup 在 docker 中的使用。docker 容器使用 linux namespace 隔离容器中应用的运行环境，使用 cgroup 来限制应用运行时的资源，这是 docker 容器的基础。&lt;/p&gt;
&lt;h3 id=&#34;linux-namespace-概念&#34;&gt;Linux namespace 概念&lt;/h3&gt;
&lt;p&gt;Linux 内核从版本 2.4.19 开始陆续引入了 namespace 的概念，其目的是将某个特定的全局系统资源，通过抽象的方式，使得 namespace 中的进程看起来拥有它们自己的隔离的全局系统资源实例。&lt;/p&gt;
&lt;p&gt;Linux 内核中实现了六种 namespace，按照引入的先后顺序，列表如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;命名空间名称&lt;/th&gt;
&lt;th&gt;引入的相关内核版本&lt;/th&gt;
&lt;th&gt;被隔离的全局系统资源&lt;/th&gt;
&lt;th&gt;在容器语境下的隔离效果&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Mount 命名空间&lt;/td&gt;
&lt;td&gt;Linux 2.4.19&lt;/td&gt;
&lt;td&gt;文件系统挂载点&lt;/td&gt;
&lt;td&gt;每个容器能看到不同的文件系统层次结构&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UTS 命名空间&lt;/td&gt;
&lt;td&gt;Linux 2.6.19&lt;/td&gt;
&lt;td&gt;hostname 和 domainname&lt;/td&gt;
&lt;td&gt;每个容器可以有自己的 hostname 和 domainname&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IPC 命名空间&lt;/td&gt;
&lt;td&gt;Linux 2.6.19&lt;/td&gt;
&lt;td&gt;特定的进程间通信资源，包括 System V IPC 和 POSIX message queues&lt;/td&gt;
&lt;td&gt;每个容器有其自己的 System V IPC 和 POSIX 消息队列文件系统。因此，只有在同一个 IPC namespace 中的进程之间才能相互通信。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PID 命名空间&lt;/td&gt;
&lt;td&gt;Linux 2.6.24&lt;/td&gt;
&lt;td&gt;进程 ID 数字空间（process ID number space）&lt;/td&gt;
&lt;td&gt;每个 PID namespace 中的进程可以有其独立的 PID；每个容器可以有其 PID 为 1 的 root 进程，也使得容器可以在不同的主机之间迁移，因为 namespace 中的进程 ID 与主机无关了，这也使得容器中的每个进程有两个 PID：容器中的 PID 和主机上的 PID。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Network 命名空间&lt;/td&gt;
&lt;td&gt;始于 Linux 2.6.24，完成于 Linux 2.6.29&lt;/td&gt;
&lt;td&gt;网络相关的系统资源&lt;/td&gt;
&lt;td&gt;每个容器拥有其独立的网络设备、IP地址、IP路由表、/proc/net 目录、端口号等等。这也使得一个主机上多个容器内的同一个应用都可以绑定到各自容器的 80 端口上。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;User 命名空间&lt;/td&gt;
&lt;td&gt;始于 Linux 2.6.23，完成于 Linux 3.8&lt;/td&gt;
&lt;td&gt;用户和组 ID 空间&lt;/td&gt;
&lt;td&gt;在 user namespace 中的进程的用户和组 ID 可以和在宿主机上不同；每个容器可以有不同的用户和组ID，一个主机上的非特权用户可以成为 user namespace 中的特权用户。&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;简单来讲，处于某个命名空间中的进程，能看到独立的它自己的隔离的某些特定系统资源。&lt;/p&gt;
&lt;h3 id=&#34;docker-容器使用-linux-namespace-做运行环境隔离&#34;&gt;docker 容器使用 linux namespace 做运行环境隔离&lt;/h3&gt;
&lt;p&gt;当 docker 创建一个容器时，它会创建新的以上六种 namespace 的实例，然后把容器中的所有进程放到这些 namespace 之中，使得 docker 容器中的进程只能看到隔离的系统资源。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ns]# pwd
/proc/3300/ns          # 3300 为容器在宿主机上的进程ID
[root@xdhuxc ns]# ll
total 0
lrwxrwxrwx 1 1000 1000 0 Jul 11 08:47 ipc -&amp;gt; ipc:[4026532175]  # 1000 为容器在宿主机上的用户
lrwxrwxrwx 1 1000 1000 0 Jul 11 08:47 mnt -&amp;gt; mnt:[4026532173]
lrwxrwxrwx 1 1000 1000 0 Jul 11 08:37 net -&amp;gt; net:[4026532178]
lrwxrwxrwx 1 1000 1000 0 Jul 11 08:47 pid -&amp;gt; pid:[4026532176]
lrwxrwxrwx 1 1000 1000 0 Jul 11 09:00 user -&amp;gt; user:[4026531837]
lrwxrwxrwx 1 1000 1000 0 Jul 11 08:47 uts -&amp;gt; uts:[4026532174]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;pid-命名空间&#34;&gt;PID 命名空间&lt;/h4&gt;
&lt;p&gt;创建容器 zookeeper&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --restart=always \
    --name zookeeper \
    zookeeper:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在容器内的 PID 是 1，PPID 为 0。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker exec -it zookeeper ps -ef
UID        PID  PPID  C STIME TTY          TIME CMD
zookeep+     1     0  0 14:53 ?        00:00:01 /usr/lib/jvm/java-1.8-openjdk/jr
root        47     0  0 14:57 pts/0    00:00:00 ps -ef
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在容器外的 PID 是 3391，PPID 是 3363，即 docker-containerd-shim 进程。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# ps -ef | grep -v grep | grep zookeeper
1000      3391  3363  0 22:53 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3363 是 docker-containerd-shim 进程的 PID。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# ps -ef | grep -v grep | grep 3363
root      3363 21666  0 22:53 ?        00:00:00 docker-containerd-shim -namespace moby -workdir /var/lib/docker/containerd/daemon/io.containerd.runtime.v1.linux/moby/81cae3d22fd7ce29c2b49292bce16ac52f0cca8ea26b21b8f34e551deb7faef2 -address /var/run/docker/containerd/docker-containerd.sock -containerd-binary /usr/bin/docker-containerd -runtime-root /var/run/docker/runtime-runc -systemd-cgroup
1000      3391  3363  0 22:53 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;我们能看到，同一个进程，在容器内外的 PID 是不同的。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在容器内 PID 是 1，PPID 是 0.&lt;/li&gt;
&lt;li&gt;在容器外 PID 是 3391，PPID 是 3363，即 docker-containerd-shim 进程&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;关于 containerd，containerd-shim 和 container 的关系：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/docker/docker-runc.jpg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图1 · containerd，containerd-shim 和 container 之间的关系
&lt;/center&gt;
&lt;ul&gt;
&lt;li&gt;docker 引擎管理着镜像，然后移交给 containerd 运行，containerd 再使用 runC 运行容器。&lt;/li&gt;
&lt;li&gt;containerd 是一个简单的守护进程，它可以使用 runC 管理容器，使用 gRPC 暴露容器的其他功能。它管理容器的开始、停止、暂停和销毁。由于容器运行时是孤立的引擎，引擎最终能够启动和升级而无需重新启动容器。&lt;/li&gt;
&lt;li&gt;runC 是一个轻量级的工具，它是用来运行容器的，只用来做这一件事，并且这一件事要做好。runC 基本上是一个小命令行工具，且它可以不用通过 docker 引擎，直接就可以使用容器。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因此，容器中的主应用在宿主机上的父进程是 containerd-shim，是它通过工具 runC 来启动这些进程的。&lt;/p&gt;
&lt;p&gt;这也能看出来，pid 命名空间通过将宿主机上 PID 映射为容器内的 PID，使得容器内的进程看起来有个独立的 PID 空间。&lt;/p&gt;
&lt;h4 id=&#34;uts-命名空间&#34;&gt;UTS 命名空间&lt;/h4&gt;
&lt;p&gt;容器可以有自己的 hostname 和 domainname&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# hostname
xdhuxc             # 宿主机的主机名
[root@xdhuxc ~]# docker exec -it zookeeper hostname
81cae3d22fd7       # zookeeper 容器的主机名
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;user-命名空间&#34;&gt;user 命名空间&lt;/h4&gt;
&lt;p&gt;在 docker 1.10 版本之前，是不支持 user 命名空间的，也就是说，默认地，容器内的进程的运行用户就是宿主机上的 root 用户。这样的话，当宿主机上的文件或者目录作为挂载卷被映射到容器以后，容器内的进程其实是有 root 的几乎所有权限去修改这些宿主机上的目录的，这会有很大的安全问题。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# id
uid=0(root) gid=0(root) groups=0(root)
[root@xdhuxc ~]# docker exec -it zookeeper id
uid=0(root) gid=0(root)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时以如下命令启动一个容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d -v /bin:/host/bin --name zookeeper zookeeper:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;默认情况下，是这样子的：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# ps -ef | grep zookeeper
1000      3300  3284  0 08:37 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg
root      4323  1602  0 08:48 pts/1    00:00:00 grep --color=auto zookeeper
[root@xdhuxc ~]# docker exec -it zookeeper ps -ef
UID        PID  PPID  C STIME TTY          TIME CMD
zookeep+     1     0  0 00:37 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jr
root        43     0  0 00:48 pts/0    00:00:00 ps -ef
[root@xdhuxc ~]# docker exec -it zookeeper whoami
root
[root@xdhuxc ~]# cat /etc/passwd | grep 1000
[root@xdhuxc ~]# docker exec -it zookeeper id
uid=0(root) gid=0(root)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;则进程的用户在容器内和容器外都是 &lt;code&gt;root&lt;/code&gt;，它可以在容器内对宿主机上的 &lt;code&gt;/bin&lt;/code&gt; 目录做任意操作，非常不安全。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;docker&lt;/code&gt; 1.10 中引入的 &lt;code&gt;user&lt;/code&gt; 命名空间就可以让容器有一个“假”的 &lt;code&gt;root&lt;/code&gt; 用户，它在容器内是 &lt;code&gt;root&lt;/code&gt;，在容器外是一个非 &lt;code&gt;root&lt;/code&gt; 用户。也就是说，&lt;code&gt;user&lt;/code&gt; 命名空间实现了宿主机 &lt;code&gt;users&lt;/code&gt; 和 容器内 &lt;code&gt;users&lt;/code&gt; 之间的映射。&lt;/p&gt;
&lt;h4 id=&#34;network-命名空间&#34;&gt;network 命名空间&lt;/h4&gt;
&lt;p&gt;默认情况下，当 docker 实例被创建出来后，使用 &lt;code&gt;ip netns&lt;/code&gt; 命令无法看到容器实例对应的 network 命名空间，这是因为 ip netns 命令 是从 /var/run/netns 目录中读取内容的。&lt;/p&gt;
&lt;p&gt;操作步骤：
1、找到容器的主进程 ID&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker inspect --format &amp;#39;{{.State.Pid}}&amp;#39; zookeeper
3300
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、创建 /var/run/netns 目录及符号链接&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# mkdir /var/run/netns
[root@xdhuxc ~]# ln -s /proc/3300/ns/net /var/run/netns/zookeeper 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3300 是 zookeeper 容器在宿主机上的进程ID。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# ps -ef | grep -v grep | grep 3300
1000      3300  3284  0 08:37 ?        00:01:10 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;而 1000 是容器内的 zookeeper 用户的用户ID&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;bash-4.4# cat /etc/passwd|grep 1000
zookeeper:x:1000:1000:Linux User,,,:/home/zookeeper:
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;说明在创建容器的时候，docker 自动在 /proc 目录下为每一个容器以其进程ID为目录名创建了存放包括cpu、内存、io、命名空间等各种资源的目录，删除容器时会自动删除该目录。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc 3300]# pwd
/proc/3300
[root@xdhuxc 3300]# ls
attr       clear_refs       cpuset   fd       limits     mem         net        oom_score      projid_map  setgroups  statm    timers
autogroup  cmdline          cwd      fdinfo   loginuid   mountinfo   ns         oom_score_adj  root        smaps      status   uid_map
auxv       comm             environ  gid_map  map_files  mounts      numa_maps  pagemap        sched       stack      syscall  wchan
cgroup     coredump_filter  exe      io       maps       mountstats  oom_adj    personality    sessionid   stat       task
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、此时，可以使用 ip netns 命令了。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# ip netns
zookeeper (id: 0)
[root@xdhuxc ~]# ip netns exec zookeeper ip addr           
1: lo: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;LOOPBACK&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 65536 qdisc noqueue state UNKNOWN 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
237: eth0@if238: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue state UP 
    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;也就是容器内的网桥信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker exec -it zookeeper ip addr
1: lo: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;LOOPBACK&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 65536 qdisc noqueue state UNKNOWN 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
237: eth0@if238: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;M-DOWN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue state UP 
    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;docker-run-命令中-namespace-相关参数&#34;&gt;docker run 命令中 namespace 相关参数&lt;/h4&gt;
&lt;p&gt;docker run 命令中如下几个参数和 namespace 相关：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;--ipc string 指定使用的 IPC 命名空间&lt;/li&gt;
&lt;li&gt;--pid string 指定使用的 PID 命名空间&lt;/li&gt;
&lt;li&gt;--userns string 指定使用的 User 命名空间&lt;/li&gt;
&lt;li&gt;--uts string 指定使用的 UTS 命名空间&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;--userns&#34;&gt;--userns&lt;/h5&gt;
&lt;p&gt;--userns：指定容器使用的 user 命名空间&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;quot;host&amp;quot;：使用 docker 所在宿主机的 user 命名空间。&lt;/li&gt;
&lt;li&gt;&amp;quot;&amp;quot;：使用由 &lt;code&gt;--userns-remap&lt;/code&gt; 指定的 docker daemon user 命名空间。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;可以在启用了 user 命名空间的情况下，强制某个容器运行在宿主机 user 命名空间之中：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# ps -ef|grep zookeeper
1000      9575  9559  0 19:47 ?        00:00:01 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg
root      9910  8341  0 19:51 pts/1    00:00:00 grep --color=auto zookeeper
[root@xdhuxc xdhuxc]# whoami
root
[root@xdhuxc xdhuxc]# docker exec -it zookeeper whoami
root
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;否则默认的话，就会运行在特定的 user 命名空间之中了。&lt;/p&gt;
&lt;h4 id=&#34;--pid&#34;&gt;--pid&lt;/h4&gt;
&lt;p&gt;可以指定容器使用 docker 宿主机 pid 命名空间。这样，在容器中的进程，可以看到宿主机上的所有进程。注意，此时不能启用 user 命名空间。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# docker run -d --name zookeeper --pid host --userns host zookeeper:latest
5b847849106c5d597e33f9f3c346ab2a5a5638f6978d7a3ac6c6e1f2a61e0971
[root@xdhuxc xdhuxc]# docker exec -it zookeeper apk add procps
fetch http://dl-cdn.alpinelinux.org/alpine/v3.7/main/x86_64/APKINDEX.tar.gz
fetch http://dl-cdn.alpinelinux.org/alpine/v3.7/community/x86_64/APKINDEX.tar.gz
(1/3) Installing libintl (0.19.8.1-r1)
(2/3) Installing libproc (3.3.12-r3)
(3/3) Installing procps (3.3.12-r3)
Executing busybox-1.27.2-r11.trigger
OK: 91 MiB in 62 packages
[root@xdhuxc xdhuxc]# docker exec -it zookeeper ps -ef
UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 Jun07 ?        00:01:36 /usr/lib/systemd/systemd --switc # 删除了若干与此无关的行
root      3144     1  0 00:37 ?        00:03:34 /usr/bin/dockerd --storage-drive
root      3151  3144  0 00:37 ?        00:02:28 docker-containerd --config /var/
root      3420  3151  0 00:39 ?        00:00:00 docker-containerd-shim -namespac
999       3436  3420  0 00:39 ?        00:00:00 /bin/sh /usr/lib/rabbitmq/bin/ra
999       3549  3436  0 00:39 ?        00:00:00 /usr/lib/erlang/erts-9.3.3/bin/e
999       3626  3436  0 00:39 ?        00:03:05 /usr/lib/erlang/erts-9.3.3/bin/b
999       3738  3626  0 00:39 ?        00:00:01 erl_child_setup 65536
999       3790  3738  0 00:39 ?        00:00:00 inet_gethost 4
999       3791  3790  0 00:39 ?        00:00:00 inet_gethost 4
993       5460     1  0 Jun30 ?        00:00:00 nginx: worker process
993       5461     1  0 Jun30 ?        00:00:00 nginx: worker process
993       5462     1  0 Jun30 ?        00:00:00 nginx: worker process
993       5463     1  0 Jun30 ?        00:00:00 nginx: worker process
root     10185  3151  0 11:54 ?        00:00:00 docker-containerd-shim -namespac
zookeep+ 10201 10185  4 11:54 ?        00:00:01 /usr/lib/jvm/java-1.8-openjdk/jr
root     10323  8341  0 11:54 ?        00:00:00 docker exec -it zookeeper ps -ef
root     10340 10185  0 11:54 pts/0    00:00:00 ps -ef
root     10347 10185  0 11:54 ?        00:00:00 docker-runc --root /var/run/dock
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;--uts&#34;&gt;--uts&lt;/h4&gt;
&lt;p&gt;可以使容器使用 docker 宿主机的 uts 命名空间。此时，最明显的是，容器的 hostname 和 docker 宿主机的 hostname 是相同的。&lt;/p&gt;
&lt;p&gt;一般情况下，创建的 docker 容器的 hostname 为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker run -d -v /bin:/host/bin --name nginx nginx:latest
35ec0c186dfc6746b343f784bfeafd87e75c8eb256a55f0d7fe91db73522f4a9
[root@xdhuxc ~]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
35ec0c186dfc        nginx:latest        &amp;#34;nginx -g &amp;#39;daemon of…&amp;#34;   5 seconds ago       Up 4 seconds        80/tcp              nginx
[root@xdhuxc ~]# docker exec -it nginx bash
root@35ec0c186dfc:/# hostname
35ec0c186dfc                                # 随机生成的主机名
root@35ec0c186dfc:/# cat /etc/hosts
127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
172.17.0.2	35ec0c186dfc                    # docker 随机生成的主机名，与主机名一致
root@35ec0c186dfc:/# domainname
(none)
root@35ec0c186dfc:/# 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;为 docker 创建的一个随机的字符串。&lt;/p&gt;
&lt;p&gt;为新启动的容器应用宿主机的 uts 命名空间&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# docker run -d --name zookeeper --uts host zookeeper:latest
97cb004b489cbf5e0073a14931953c6b892cbdd4da9df4c06fa7e219727e6780
[root@xdhuxc xdhuxc]# docker exec -it zookeeper hostname
xdhuxc                         # zookeeper 容器的主机名
[root@xdhuxc xdhuxc]# docker exec -it zookeeper cat /etc/hosts
127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
172.17.0.2	97cb004b489c       # docker 为每一个容器随机生成的主机名
[root@xdhuxc xdhuxc]# hostname
xdhuxc                         # 宿主机的主机名
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;但是，却存在这种情况，不知道是什么含义及原因。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# docker inspect --format=&amp;#39;{{.HostConfig.UTSMode}}&amp;#39; zookeeper
host
[root@xdhuxc xdhuxc]# docker inspect --format=&amp;#39;{{.Config.Hostname}}&amp;#39; zookeeper
97cb004b489c
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;总之，docker 守护进程为每个容器都创建了六种 namespaces 的实例，使得容器中的进程都处于一种隔离的运行环境之中。&lt;/p&gt;
&lt;h3 id=&#34;linux-control-groups&#34;&gt;Linux control groups&lt;/h3&gt;
&lt;p&gt;Linux Cgroup 可以让我们为系统中所运行的任务（进程）的用户定义组群分配资源，比如 CPU 时间、系统内存、网络带宽或者这些资源的组合。我们可以监控配置的cgroup，拒绝 cgroup 访问某些资源，甚至在运行的系统中动态配置 cgroup。可以将 control groups 理解为 controller （system resource ）（for）（process）groups，也就是说 cgroup 以一组进程为目标进行系统资源分配和控制。&lt;/p&gt;
&lt;p&gt;cgroup 主要提供如下功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Resource Limitation：限制资源使用，比如，内存使用上限，文件系统的缓存限制等。&lt;/li&gt;
&lt;li&gt;Prioritization：优先级控制，比如，CPU 利用和磁盘 I/O 吞吐。&lt;/li&gt;
&lt;li&gt;Accounting：一些审计或统计，主要目的是为了计费。&lt;/li&gt;
&lt;li&gt;Control：挂起进程，恢复执行进程。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用 cgroup，系统管理员可以更具体地控制对系统资源的分配、优先顺序、拒绝、管理和监控，可以更好地根据任务和用户分配硬件资源，提高总体效率。&lt;/p&gt;
&lt;p&gt;在实际的使用中，系统管理员一般会利用 cgroup 做以下几方面工作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;隔离一个进程集合（例如，nginx 的所有进程），并限制它们所消耗的资源，比如绑定 CPU 的核。&lt;/li&gt;
&lt;li&gt;为这组进程分配其足够使用的内存。&lt;/li&gt;
&lt;li&gt;为这组进程分配相应的网络带宽和磁盘存储限制。&lt;/li&gt;
&lt;li&gt;限制访问某些设备，通过设置设备的白名单来实现。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在 linux 系统中，一切皆文件。为了方便用户使用，Linux 也将 cgroup 实现成了文件系统。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# mount -t cgroup
cgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)
cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)
cgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)
cgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)
cgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpuacct,cpu)
cgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)
cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)
cgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)
cgroup on /sys/fs/cgroup/net_cls type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls)
cgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)
[root@xdhuxc xdhuxc]# lssubsys -m
cpuset /sys/fs/cgroup/cpuset
cpu,cpuacct /sys/fs/cgroup/cpu,cpuacct
memory /sys/fs/cgroup/memory
devices /sys/fs/cgroup/devices
freezer /sys/fs/cgroup/freezer
net_cls /sys/fs/cgroup/net_cls
blkio /sys/fs/cgroup/blkio
perf_event /sys/fs/cgroup/perf_event
hugetlb /sys/fs/cgroup/hugetlb
[root@xdhuxc xdhuxc]# ll /sys/fs/cgroup/
total 0
drwxr-xr-x 5 root root  0 Jul 11 20:05 blkio
lrwxrwxrwx 1 root root 11 Jun  7 15:40 cpu -&amp;gt; cpu,cpuacct
lrwxrwxrwx 1 root root 11 Jun  7 15:40 cpuacct -&amp;gt; cpu,cpuacct
drwxr-xr-x 5 root root  0 Jul 11 20:05 cpu,cpuacct
drwxr-xr-x 4 root root  0 Jun  7 15:40 cpuset
drwxr-xr-x 5 root root  0 Jul 11 20:05 devices
drwxr-xr-x 4 root root  0 Jun  7 15:40 freezer
drwxr-xr-x 4 root root  0 Jun  7 15:40 hugetlb
drwxr-xr-x 5 root root  0 Jul 11 20:05 memory
drwxr-xr-x 4 root root  0 Jun  7 15:40 net_cls
drwxr-xr-x 4 root root  0 Jun  7 15:40 perf_event
drwxr-xr-x 5 root root  0 Jul 11 20:05 systemd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到 /sys/fs/cgroup 目录中有若干个子目录，可以认为这些都是受 cgroup 控制的资源以及这些资源的信息。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;blkio：该子系统为块设备设定输入/输出限制，比如物理设备（磁盘、固态硬盘、USB等等）。&lt;/li&gt;
&lt;li&gt;cpu：该子系统使用调度程序提供对 CPU 的 cgroup 任务访问。&lt;/li&gt;
&lt;li&gt;cpuacct：该子系统自动生成 cgroup 中任务所使用的 CPU 报告。&lt;/li&gt;
&lt;li&gt;cpuset：该子系统为 cgroup 中的任务分配独立 CPU（在多核系统） 和内存节点。&lt;/li&gt;
&lt;li&gt;devices：该子系统可允许或者拒绝 cgroup 中的任何访问设备。&lt;/li&gt;
&lt;li&gt;freezer：该子系统挂起或者恢复 cgroup 中的任务。&lt;/li&gt;
&lt;li&gt;memory：该子系统设定 cgroup 中任务使用的内存限制，并自动生成内存资源使用报告。&lt;/li&gt;
&lt;li&gt;net_cls：该子系统使用等级识别符（classid）标记网络数据包，可允许 Linux 流量控制程序（tc）识别从具体 cgroup 中生成的数据包。&lt;/li&gt;
&lt;li&gt;net_prio：该子系统用来设计网络流量的优先级。&lt;/li&gt;
&lt;li&gt;hugetlb：该子系统主要针对于 HugeTLB 系统进行限制，这是一个大页文件系统。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在 CentOS 7.2.1511 系统中，默认看不到 net_prio 目录&lt;/p&gt;
&lt;h4 id=&#34;通过-cgroup-限制进程的-cpu&#34;&gt;通过 cgroup 限制进程的 CPU&lt;/h4&gt;
&lt;p&gt;编写如下 C 语言程序&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# cat xdhuxc.cpp 
int main(void){
	int i = 0;
	for( ; ; ) {
		i++;
	}
	return 0;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;编译并运行&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# gcc xdhuxc.cpp -o xdhuxc.out
[root@xdhuxc xdhuxc]# ./xdhuxc.out 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 top 命令查看 CPU 占用&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Tasks: 131 total,   2 running, 129 sleeping,   0 stopped,   0 zombie
%Cpu(s): 23.2 us,  0.1 sy,  0.0 ni, 76.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem :  8010904 total,  4122568 free,   331844 used,  3556492 buff/cache
KiB Swap:  2096124 total,  2088680 free,     7444 used.  7014016 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                              
18110 root      20   0    4164    352    280 R  99.7  0.0   2:25.39 xdhuxc.out 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;接下来，我们使用 cgroup 限制其 CPU 占用，操作如下&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# mkdir /sys/fs/cgroup/cpu/xdhuxc
[root@xdhuxc xdhuxc]# cd /sys/fs/cgroup/cpu/xdhuxc
[root@xdhuxc xdhuxc]# ls
cgroup.clone_children  cpuacct.stat          cpu.cfs_period_us  cpu.rt_runtime_us  notify_on_release
cgroup.event_control   cpuacct.usage         cpu.cfs_quota_us   cpu.shares         tasks
cgroup.procs           cpuacct.usage_percpu  cpu.rt_period_us   cpu.stat
[root@xdhuxc xdhuxc]# cat cpu.cfs_quota_us 
-1
[root@xdhuxc xdhuxc]# echo 20000 &amp;gt; cpu.cfs_quota_us 
[root@xdhuxc xdhuxc]# cat cpu.cfs_quota_us 
20000
[root@xdhuxc xdhuxc]# echo 18110 &amp;gt; tasks
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;说明：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mkdir /sys/fs/cgroup/cpu/xdhuxc：创建一个 CPU 控制组 xdhuxc，创建 xdhuxc 之后，可以看到目录下自动创建了相关的文件，这些文件都是伪文件。&lt;/li&gt;
&lt;li&gt;cpu.cfs_period_us：CPU 分配的时间周期，以微秒计算，默认为：100000.&lt;/li&gt;
&lt;li&gt;cpu.cfs_quota_us：表示该 control group 限制占用的时间（以微秒计算），默认为：-1，表示不限制。如果设置为2000，表示占用20000/100000=20%的CPU。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在多核情况下，看到的值会不一样。另外，cfs_quota_us 也是可以大于 cfs_period_us 的，这主要是对于多核情况。有 n 个核时，一个控制组中的进程自然最多就能用到 n 倍的 cpu 时间。&lt;/p&gt;
&lt;p&gt;这两个值在 cgroups 层次中是有限制的，下层的资源不能超过上层。具体的说，就是下层的 cpu.cfs_period_us 值不能小于上层的值，cpu.cfs_quota_us 值不能大于上层的值。&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://xiezhenye.com/2013/10/%E7%94%A8-cgroups-%E7%AE%A1%E7%90%86-cpu-%E8%B5%84%E6%BA%90.html&#34;&gt;http://xiezhenye.com/2013/10/%E7%94%A8-cgroups-%E7%AE%A1%E7%90%86-cpu-%E8%B5%84%E6%BA%90.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;注意：此种方式对C，shell，python起作用，对java似乎不起作用。&lt;/p&gt;
&lt;p&gt;然后再查看 CPU 占用&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Tasks: 131 total,   2 running, 129 sleeping,   0 stopped,   0 zombie
%Cpu(s):  4.6 us,  0.3 sy,  0.0 ni, 95.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.1 st
KiB Mem :  8010904 total,  4123224 free,   331196 used,  3556484 buff/cache
KiB Swap:  2096124 total,  2088680 free,     7444 used.  7014740 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                              
18110 root      20   0    4164    352    280 R  19.9  0.0   8:25.99 xdhuxc.out          
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;它占用的 CPU 几乎就是 20%，也就是我们预设的阈值。这说明通过上面的操作，成功地将这个进程运行所占用的 CPU 资源限制在某个阈值范围内了。&lt;/p&gt;
&lt;p&gt;此时加入另一个 xdhuxc.out&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Tasks: 132 total,   3 running, 129 sleeping,   0 stopped,   0 zombie
%Cpu(s): 27.8 us,  0.2 sy,  0.0 ni, 71.8 id,  0.2 wa,  0.0 hi,  0.0 si,  0.1 st
KiB Mem :  8010904 total,  4123328 free,   331072 used,  3556504 buff/cache
KiB Swap:  2096124 total,  2088680 free,     7444 used.  7014856 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                              
19016 root      20   0    4164    352    280 R 100.0  0.0   1:10.95 xdhuxc.out                           
18110 root      20   0    4164    352    280 R  20.0  0.0   9:07.16 xdhuxc.out       
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;将此 xdhuxc.out 进程的 PID 加入 tasks 文件中，则这两个进程会共享设定的 CPU 限制&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc xdhuxc]# echo 19016 &amp;gt;&amp;gt; tasks 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 top 命令查看两个 xdhuxc.out 进程的 CPU 占用&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Tasks: 132 total,   3 running, 129 sleeping,   0 stopped,   0 zombie
%Cpu(s):  6.3 us,  1.6 sy,  0.0 ni, 91.8 id,  0.0 wa,  0.0 hi,  0.0 si,  0.3 st
KiB Mem :  8010904 total,  4123656 free,   330696 used,  3556552 buff/cache
KiB Swap:  2096124 total,  2088680 free,     7444 used.  7015244 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                               
18110 root      20   0    4164    352    280 R  10.7  0.0   9:28.38 xdhuxc.out                                                                                      
19016 root      20   0    4164    352    280 R   9.3  0.0   2:16.69 xdhuxc.out                 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可见，两个进程比较平均地分享了 CPU 时间。&lt;/p&gt;
&lt;h4 id=&#34;通过-cgroup-限制进程的内存&#34;&gt;通过 cgroup 限制进程的内存&lt;/h4&gt;
&lt;p&gt;类似的，我们针对它占用的内存做如下操作：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc memory]# mkdir /sys/fs/cgroup/memory/xdhuxc
[root@xdhuxc memory]# cd /sys/fs/cgroup/memory/xdhuxc
[root@xdhuxc xdhuxc]# cat memory.limit_in_bytes 
9223372036854775807
[root@xdhuxc xdhuxc]# pwd
/sys/fs/cgroup/memory/xdhuxc
[root@xdhuxc xdhuxc]# echo 128M &amp;gt; memory.limit_in_bytes 
[root@xdhuxc xdhuxc]# echo 18110 &amp;gt; tasks
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;上面的步骤会把进程ID为 18110 的进程占用的内存阈值设置为 128M，超过的话，它会被杀掉。&lt;/p&gt;
&lt;h4 id=&#34;通过-cgroup-限制进程的-io&#34;&gt;通过 cgroup 限制进程的 I/O&lt;/h4&gt;
&lt;p&gt;运行命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;sudo dd if=/dev/sda of=/dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 iotop 命令查看 IO（此时磁盘在快速转动），此时，其读速度为：3.21G/s：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Total DISK READ :      38.15 M/s | Total DISK WRITE :       0.00 B/s
Actual DISK READ:      38.15 M/s | Actual DISK WRITE:       0.00 B/s
  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&amp;gt;    COMMAND                                                                                                     
20322 be/4 root          5.18 G      0.00 B  0.00 % 75.31 % dd if=/dev/sda of=/dev/null
28167 be/0 root          2.35 G      0.00 B  0.00 %  4.58 % [loop0]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;接着做下面的操作：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# mkdir /sys/fs/cgroup/blkio/xdhuxc
[root@xdhuxc ~]# cd /sys/fs/cgroup/blkio/xdhuxc
[root@xdhuxc xdhuxc]# echo &amp;#34;253:0 1048576&amp;#34; &amp;gt; blkio.throttle.read_bps_device # 253:0 对应主设备号和副设备号，可以通过 ls -l /dev/sda 查看
[root@xdhuxc xdhuxc]# echo 20322 &amp;gt; tasks 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;再使用 iotop 命令查看，读速度已经降到了 1M/s 以下。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;20322 be/4 root      993.36 K/s    0.00 B/s  0.00 %  0.00 % dd if=/dev/sda of=/dev/null  
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;似乎对 /dev/vda 设备的IO速度控制不起作用。&lt;/p&gt;
&lt;p&gt;可能只对sda设备起作用，也可能用法不对。&lt;/p&gt;
&lt;h4 id=&#34;术语&#34;&gt;术语&lt;/h4&gt;
&lt;p&gt;cgroups 的术语包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;任务：Tasks，就是系统的一个进程。&lt;/li&gt;
&lt;li&gt;控制组：Control Group，一组按照某种标准划分的进程，其表示了某进程组。cgroup 中的资源控制都是以控制组为单位实现。一个进程可以加入到某个控制组。而资源的限制是定义在这个组上，简单来说，cgroup就是一个目录带一系列的可配置文件。&lt;/li&gt;
&lt;li&gt;层级：Hierarchy，控制组可以组织成hierarchy的形式，即一棵控制组的树形结构（目录结构），控制组树上的子节点继承父节点的属性，简单来说，hierarchy就是在一个或多个子系统上的cgroup目录树。&lt;/li&gt;
&lt;li&gt;子系统：Subsystem，一个子系统就是一个资源控制器，比如CPU子系统就是控制CPU时间分配的一个控制器。子系统必须附加到一个层级上才能起作用，一个子系统附加到某个层级以后，这个层级上的所有控制组群都受到这个子系统的控制。cgroup的子系统可以有很多，也在不断地增加中。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;docker-使用-cgroup-限制容器进程资源的使用&#34;&gt;docker 使用 cgroup 限制容器进程资源的使用&lt;/h3&gt;
&lt;p&gt;环境信息：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker info
Containers: 0
 Running: 0
 Paused: 0
 Stopped: 0
Images: 1
Server Version: 17.12.1-ce
Storage Driver: overlay2
 Backing Filesystem: xfs
 Supports d_type: true
 Native Overlay Diff: true
Logging Driver: json-file
Cgroup Driver: cgroupfs
Plugins:
 Volume: local
 Network: bridge host macvlan null overlay
 Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog
Swarm: inactive
Runtimes: runc
Default Runtime: runc
Init Binary: docker-init
containerd version: 9b55aab90508bd389d7654c4baf173a981477d55
runc version: 9f9c96235cc97674e935002fc3d78361b696a69e
init version: 949e6fa
Security Options:
 seccomp
  Profile: default
Kernel Version: 3.10.0-693.el7.x86_64
Operating System: CentOS Linux 7 (Core)
OSType: linux
Architecture: x86_64
CPUs: 1
Total Memory: 976.3MiB
Name: xdhuxc
ID: JC2S:MKCL:G33Y:CTUN:T5EX:A4J2:HLOM:G4DC:FPX7:ERZL:OF7G:34HV
Docker Root Dir: /var/lib/docker
Debug Mode (client): false
Debug Mode (server): false
Registry: https://index.docker.io/v1/
Labels:
Experimental: false
Insecure Registries:
 0.0.0.0/0
 127.0.0.0/8
Live Restore Enabled: false
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;docker 安装时，会在 /sys/fs/cgroup/ 目录下的各个资源目录下生成以 docker 为名字的目录，即docker控制组。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc docker]# pwd
/sys/fs/cgroup/cpu,cpuacct/docker
[root@xdhuxc docker]# ls
cgroup.clone_children  cgroup.procs  cpuacct.usage         cpu.cfs_period_us  cpu.rt_period_us   cpu.shares  notify_on_release
cgroup.event_control   cpuacct.stat  cpuacct.usage_percpu  cpu.cfs_quota_us   cpu.rt_runtime_us  cpu.stat    tasks
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;默认情况下，docker 每启动一个容器时，会在 /sys/fs/cgroup/cpu/docker/ 目录下，生成以 容器ID 为名字的目录，即当前容器的控制组，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker run -d --name=zookeeper zookeeper:latest
c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a
[root@xdhuxc ~]# cd /sys/fs/cgroup/cpu/docker
[root@xdhuxc docker]# ll
total 0
drwxr-xr-x 2 root root 0 Jul 15 10:03 c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a
-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.clone_children
--w--w--w- 1 root root 0 Jul 15 09:39 cgroup.event_control
-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.procs
-r--r--r-- 1 root root 0 Jul 15 09:39 cpuacct.stat
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpuacct.usage
-r--r--r-- 1 root root 0 Jul 15 09:39 cpuacct.usage_percpu
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.cfs_period_us
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.cfs_quota_us
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.rt_period_us
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.rt_runtime_us
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.shares
-r--r--r-- 1 root root 0 Jul 15 09:39 cpu.stat
-rw-r--r-- 1 root root 0 Jul 15 09:39 notify_on_release
-rw-r--r-- 1 root root 0 Jul 15 09:39 tasks
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时，cpu.cfs_quota_us 的内容为：-1，表示默认情况下并没有限制容器的 CPU 使用。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a]# pwd
/sys/fs/cgroup/cpu/docker/c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a
[root@xdhuxc c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a]# cat cpu.cfs_quota_us 
-1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在容器被 stopped 后，该目录会被删除。&lt;/p&gt;
&lt;p&gt;接下来创建一个带资源限制的 zookeeper 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc docker]# pwd
/sys/fs/cgroup/cpu,cpuacct/docker
[root@xdhuxc docker]# docker run -d --name zookeeper --cpu-quota 25000 --cpu-period 150000 --cpu-shares 30 zookeeper:latest
61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6
[root@xdhuxc docker]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS              PORTS                          NAMES
61952fccaff9        zookeeper:latest    &amp;#34;/docker-entrypoint.…&amp;#34;   About a minute ago   Up About a minute   2181/tcp, 2888/tcp, 3888/tcp   zookeeper
[root@xdhuxc docker]# ll
total 0
drwxr-xr-x 2 root root 0 Jul 15 10:20 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6
-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.clone_children
--w--w--w- 1 root root 0 Jul 15 09:39 cgroup.event_control
-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.procs
-r--r--r-- 1 root root 0 Jul 15 09:39 cpuacct.stat
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpuacct.usage
-r--r--r-- 1 root root 0 Jul 15 09:39 cpuacct.usage_percpu
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.cfs_period_us
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.cfs_quota_us
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.rt_period_us
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.rt_runtime_us
-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.shares
-r--r--r-- 1 root root 0 Jul 15 09:39 cpu.stat
-rw-r--r-- 1 root root 0 Jul 15 09:39 notify_on_release
-rw-r--r-- 1 root root 0 Jul 15 09:39 tasks
[root@xdhuxc docker]# cd 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6/
[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# ls
cgroup.clone_children  cgroup.procs  cpuacct.usage         cpu.cfs_period_us  cpu.rt_period_us   cpu.shares  notify_on_release
cgroup.event_control   cpuacct.stat  cpuacct.usage_percpu  cpu.cfs_quota_us   cpu.rt_runtime_us  cpu.stat    tasks
[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# cat cpu.cfs_quota_us 
25000
[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# cat cpu.cfs_period_us 
150000
[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# cat cpu.shares 
30
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上值正是我们在启动容器时设置的资源值。&lt;/p&gt;
&lt;p&gt;docker 会将容器中的进程的 ID 加入到各个资源对应的 tasks 文件中。
在宿主机上查看进程&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc docker]# ps -ef | grep -v grep | grep zookeeper
xdhuxc     2890   2879  0 10:20 ?        00:00:00 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;tasks 文件中的内容为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# cat tasks 
2890                # 正是宿主机上zookeeper进程的PID
2925
2926
2927
2928
2929
2930
2931
2932
2933
2934
2935
2936
2937
2938
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;表明 docker 是通过上面的机制来使用 cgroup 对容器的 CPU 使用进行限制的。&lt;/p&gt;
&lt;p&gt;类似的，可以通过 docker run 中 mem 相关的参数对容器的内存使用进行限制：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;    --kernel-memory bytes            Kernel memory limit
    --cpuset-mems string             MEMs in which to allow execution (0-3, 0,1)
-m, --memory bytes                   Memory limit
    --memory-reservation bytes       Memory soft limit
    --memory-swap bytes              Swap limit equal to memory plus swap: &amp;#39;-1&amp;#39; to enable unlimited swap
    --memory-swappiness int          Tune container memory swappiness (0 to 100) (default -1)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;例如，运行如下命令&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc docker]# docker run -d --name zookeeper --blkio-weight 100 --memory 50M --cpu-quota 25000 --cpu-period 150000 --cpu-shares 30 zookeeper:latest
bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
[root@xdhuxc docker]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                          NAMES
bf59ef7c32f2        zookeeper:latest    &amp;#34;/docker-entrypoint.…&amp;#34;   4 seconds ago       Up 3 seconds        2181/tcp, 2888/tcp, 3888/tcp   zookeeper
[root@xdhuxc docker]# ps -ef | grep -v grep | grep zookeeper
xdhuxc     3101   3090  0 10:53 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg
[root@xdhuxc docker]# ps -T -p 3101                # 查看进程ID为3101的进程中的线程
   PID   SPID TTY          TIME CMD
  3101   3101 ?        00:00:00 java
  3101   3143 ?        00:00:00 java
  3101   3144 ?        00:00:01 java
  3101   3145 ?        00:00:00 java
  3101   3146 ?        00:00:00 java
  3101   3147 ?        00:00:00 java
  3101   3148 ?        00:00:00 java
  3101   3149 ?        00:00:00 java
  3101   3150 ?        00:00:00 java
  3101   3151 ?        00:00:00 java
  3101   3152 ?        00:00:00 java
  3101   3157 ?        00:00:00 java
  3101   3158 ?        00:00:00 java
  3101   3159 ?        00:00:00 java
  3101   3160 ?        00:00:00 java
[root@xdhuxc docker]# pwd
/sys/fs/cgroup/memory/docker
[root@xdhuxc docker]# ll
total 0
drwxr-xr-x 2 root root 0 Jul 15 10:53 bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.clone_children
--w--w--w- 1 root root 0 Jul 15 09:39 cgroup.event_control
-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.procs
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.failcnt
--w------- 1 root root 0 Jul 15 09:39 memory.force_empty
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.failcnt
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.limit_in_bytes
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.max_usage_in_bytes
-r--r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.slabinfo
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.tcp.failcnt
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.tcp.limit_in_bytes
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.tcp.max_usage_in_bytes
-r--r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.tcp.usage_in_bytes
-r--r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.usage_in_bytes
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.limit_in_bytes
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.max_usage_in_bytes
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.memsw.failcnt
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.memsw.limit_in_bytes
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.memsw.max_usage_in_bytes
-r--r--r-- 1 root root 0 Jul 15 09:39 memory.memsw.usage_in_bytes
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.move_charge_at_immigrate
-r--r--r-- 1 root root 0 Jul 15 09:39 memory.numa_stat
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.oom_control
---------- 1 root root 0 Jul 15 09:39 memory.pressure_level
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.soft_limit_in_bytes
-r--r--r-- 1 root root 0 Jul 15 09:39 memory.stat
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.swappiness
-r--r--r-- 1 root root 0 Jul 15 09:39 memory.usage_in_bytes
-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.use_hierarchy
-rw-r--r-- 1 root root 0 Jul 15 09:39 notify_on_release
-rw-r--r-- 1 root root 0 Jul 15 09:39 tasks
[root@xdhuxc docker]# cd bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da/
[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# ls
cgroup.clone_children  memory.kmem.failcnt             memory.kmem.tcp.limit_in_bytes      memory.max_usage_in_bytes        memory.move_charge_at_immigrate  memory.stat            tasks
cgroup.event_control   memory.kmem.limit_in_bytes      memory.kmem.tcp.max_usage_in_bytes  memory.memsw.failcnt             memory.numa_stat                 memory.swappiness
cgroup.procs           memory.kmem.max_usage_in_bytes  memory.kmem.tcp.usage_in_bytes      memory.memsw.limit_in_bytes      memory.oom_control               memory.usage_in_bytes
memory.failcnt         memory.kmem.slabinfo            memory.kmem.usage_in_bytes          memory.memsw.max_usage_in_bytes  memory.pressure_level            memory.use_hierarchy
memory.force_empty     memory.kmem.tcp.failcnt         memory.limit_in_bytes               memory.memsw.usage_in_bytes      memory.soft_limit_in_bytes       notify_on_release
[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# cat memory.limit_in_bytes 
52428800                   # 正是我们设置的50M的限额
[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# cat tasks 
3101                       # zookeeper 容器进程在宿主机上的进程ID。
3143                       # 以下是 zoookeeper 容器进程所起的线程ID。
3144
3145
3146
3147
3148
3149
3150
3151
3152
3157
3158
3159
3160
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看 IO 限制&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# pwd
/sys/fs/cgroup/blkio/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# ls
blkio.io_merged                   blkio.io_serviced                blkio.leaf_weight                blkio.throttle.io_serviced        blkio.time_recursive   notify_on_release
blkio.io_merged_recursive         blkio.io_serviced_recursive      blkio.leaf_weight_device         blkio.throttle.read_bps_device    blkio.weight           tasks
blkio.io_queued                   blkio.io_service_time            blkio.reset_stats                blkio.throttle.read_iops_device   blkio.weight_device
blkio.io_queued_recursive         blkio.io_service_time_recursive  blkio.sectors                    blkio.throttle.write_bps_device   cgroup.clone_children
blkio.io_service_bytes            blkio.io_wait_time               blkio.sectors_recursive          blkio.throttle.write_iops_device  cgroup.event_control
blkio.io_service_bytes_recursive  blkio.io_wait_time_recursive     blkio.throttle.io_service_bytes  blkio.time                        cgroup.procs
[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# cat blkio.weight
100                        # 正是我们设置的 blkio-weight 的值。
[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# cat tasks 
3101                       # zookeeper 容器进程在宿主机上的进程ID。
3143                       # 以下是 zoookeeper 容器进程所起的线程ID。
3144
3145
3146
3147
3148
3149
3150
3151
3152
3157
3158
3159
3160
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;目录 cpu 和 目录 cpuacct 为符号链接文件，都链接到了 cpu,cpuacct 目录。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc cgroup]# pwd
/sys/fs/cgroup
[root@xdhuxc cgroup]# ls
blkio  cpu  cpuacct  cpu,cpuacct  cpuset  devices  freezer  hugetlb  memory  net_cls  perf_event  systemd
[root@xdhuxc cgroup]# ll
total 0
drwxr-xr-x 5 root root  0 Jul  4 08:52 blkio
lrwxrwxrwx 1 root root 11 Jun  7 15:40 cpu -&amp;gt; cpu,cpuacct
lrwxrwxrwx 1 root root 11 Jun  7 15:40 cpuacct -&amp;gt; cpu,cpuacct
drwxr-xr-x 5 root root  0 Jul  4 08:52 cpu,cpuacct
drwxr-xr-x 4 root root  0 Jun  7 15:40 cpuset
drwxr-xr-x 5 root root  0 Jul  4 08:52 devices
drwxr-xr-x 4 root root  0 Jun  7 15:40 freezer
drwxr-xr-x 4 root root  0 Jun  7 15:40 hugetlb
drwxr-xr-x 5 root root  0 Jul  4 08:52 memory
drwxr-xr-x 4 root root  0 Jun  7 15:40 net_cls
drwxr-xr-x 4 root root  0 Jun  7 15:40 perf_event
drwxr-xr-x 5 root root  0 Jul  4 08:52 systemd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;从上面也可以看出，目前 docker 已经几乎支持了所有的 cgroup 资源，可以限制容器对包括 network、device、cpu 和 memory 在内的资源的使用。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc cgroup]# pwd
/sys/fs/cgroup
[root@xdhuxc cgroup]# find ./ -name bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./blkio/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./cpuset/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./perf_event/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./freezer/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./cpu,cpuacct/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./pids/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./net_cls,net_prio/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./devices/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./hugetlb/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./memory/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
./systemd/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;限制容器的网络流量&#34;&gt;限制容器的网络流量&lt;/h4&gt;
&lt;p&gt;net_cls 和 tc 一起使用可用于限制进程发出的网络包所使用的网络带宽。当使用 cgroup network controll net_cls 后，指定进程发出的所有网络包都会被加一个标签，然后就可以使用其他工具，比如 iptables 或者 traffic controller（TC）来根据网络包上的标签进行流量控制。&lt;/p&gt;
&lt;p&gt;关于 classid，它的格式是：0xAAAABBBB，其中，AAAA 是十六进制的主 ID（major number），BBBB 是十六进制的次 ID（minor number）。因此，0x10001 表示 10:1 ，而 0x00010001 表示 1:!&lt;/p&gt;
&lt;p&gt;1、首先，在宿主机的网卡 eth0 上做如下设置：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tc qdisc del dev eth0 root                         # 删除已有规则
tc qdisc add dev eth0 root handle 10: htb default 12
tc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil 1500kbit burst 10k    # 限速
tc filter add dev eth0 protocol ip parent 10:0 prio 1 u32 match ip protocol 1 0xff flowid 10:1 # 只处理 ping 参数的网络包
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其结果是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在网卡 eth0 上创建了一个 HTB root 队列，handle 10: 表示队列句柄，也就是 major number 为 10。&lt;/li&gt;
&lt;li&gt;创建一个分类 10:1，限制它的发出网络带宽为 80 kbit（千比特每秒）&lt;/li&gt;
&lt;li&gt;创建一个分类器，将 eth0 上 IP IMCP 协议的 major ID 为 10 的 prio 为 1 的网络流量都分类到 10:1 类别。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、启动容器
容器启动后，其 init 进程在宿主机上的 PID 就被加入到 tasks 文件中了。&lt;/p&gt;
&lt;p&gt;设置 net_cls classid：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;echo 0x100001 &amp;gt; net_cls.classid
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后在容器中启动一个 ping 进程，其 ID 也被加入到 tasks 文件中了。&lt;/p&gt;
&lt;p&gt;3、查看 tc 情况&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;tc -s -d class show dev eth0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可以看到 tc 已经在处理 ping 进程产生的数据包了。&lt;/p&gt;
&lt;p&gt;再看一下 net_cls 和 ts 合作的限速效果：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;10488 bytes from 192.168.1.1: icmp_seq=35 ttl=63 time=12.7 ms
10488 bytes from 192.168.1.1: icmp_seq=36 ttl=63 time=15.2 ms
10488 bytes from 192.168.1.1: icmp_seq=37 ttl=63 time=4805 ms
10488 bytes from 192.168.1.1: icmp_seq=38 ttl=63 time=9543 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其中，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;后两条说使用的 tc class 规则是 tc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil 15kbit burst 10k&lt;/li&gt;
&lt;li&gt;前两条所使用的 tc class 规则是 tc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil 10Mbit burst 10k&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;docker-run-命令中-cgroup-相关命令&#34;&gt;docker run 命令中 cgroup 相关命令&lt;/h4&gt;
&lt;p&gt;block IO:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;    --blkio-weight uint16            Block IO (relative weight), between 10 and 1000, or 0 to disable (default 0)
    --blkio-weight-device list       Block IO weight (relative device weight) (default [])
    --cgroup-parent string           Optional parent cgroup for the container
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;CPU:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;    --cpu-period int                 Limit CPU CFS (Completely Fair Scheduler) period
    --cpu-quota int                  Limit CPU CFS (Completely Fair Scheduler) quota
    --cpu-rt-period int              Limit CPU real-time period in microseconds
    --cpu-rt-runtime int             Limit CPU real-time runtime in microseconds
-c, --cpu-shares int                 CPU shares (relative weight)
    --cpus decimal                   Number of CPUs
    --cpuset-cpus string             CPUs in which to allow execution (0-3, 0,1)
    --cpuset-mems string             MEMs in which to allow execution (0-3, 0,1)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Device:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;    --device list                    Add a host device to the container
    --device-cgroup-rule list        Add a rule to the cgroup allowed devices list
    --device-read-bps list           Limit read rate (bytes per second) from a device (default [])
    --device-read-iops list          Limit read rate (IO per second) from a device (default [])
    --device-write-bps list          Limit write rate (bytes per second) to a device (default [])
    --device-write-iops list         Limit write rate (IO per second) to a device (default [])
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Memory:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;    --kernel-memory bytes            Kernel memory limit
-m, --memory bytes                   Memory limit
    --memory-reservation bytes       Memory soft limit
    --memory-swap bytes              Swap limit equal to memory plus swap: &amp;#39;-1&amp;#39; to enable unlimited swap
    --memory-swappiness int          Tune container memory swappiness (0 to 100) (default -1)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;注意：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;cgroup 只能限制 CPU 的使用，而不能保证 CPU 的使用。也就是说，使用 cpuset-cpus，可以让容器在指定的 CPU 或者核上运行，但是不能确保它独占这些CPU；cpu-shares 是个相对值，只有在 CPU 不够用的时候才起作用，也就是说，当 CPU 够用的时候，每个容器会分到足够的 CPU；当不够用的时候，会按照指定的比重在多个容器之间分配 CPU。&lt;/li&gt;
&lt;li&gt;对内存来说，cgroup 可以限制容器使用内存的最大值，使用 -m 参数可以设置最多可以使用的内存。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;参考资料：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cnblogs.com/sammyliu/p/5878973.html&#34;&gt;http://www.cnblogs.com/sammyliu/p/5878973.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://coolshell.cn/articles/17049.html&#34;&gt;https://coolshell.cn/articles/17049.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/qinyushuang/article/details/46611709&#34;&gt;https://blog.csdn.net/qinyushuang/article/details/46611709&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.docker.com/config/containers/resource_constraints/#configure-the-realtime-scheduler&#34;&gt;https://docs.docker.com/config/containers/resource_constraints/#configure-the-realtime-scheduler&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cnblogs.com/sammyliu/p/5886833.html&#34;&gt;http://www.cnblogs.com/sammyliu/p/5886833.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>docker 容器网络模式总结</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-network-mode/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-network-mode/</guid>
                <pubDate>Sat, 15 Jul 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了 Docker 的四种网络模式，在使用 docker 容器时，必须知道容器是以哪种网络模式启动，这对于访问容器中的应用和排查问题都非常重要。&lt;/p&gt;
&lt;h3 id=&#34;单节点网络模式&#34;&gt;单节点网络模式&lt;/h3&gt;
&lt;h4 id=&#34;bridge-网络模式&#34;&gt;bridge 网络模式&lt;/h4&gt;
&lt;p&gt;docker 容器默认使用 bridge 网络模式，其特点如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用一个 linux 网桥，默认为 docker0。&lt;/li&gt;
&lt;li&gt;使用 veth 对，一端在容器的网络命名空间中，一端在 docker0 上。&lt;/li&gt;
&lt;li&gt;该模式下，docker 容器不具有一个公有 IP 地址，由于宿主机的 IP 地址与 veth 对的 IP 地址不在同一个网段内。&lt;/li&gt;
&lt;li&gt;docker 采用 NAT 方式，将容器内部的服务监听的端口与宿主机的某一个端口进行绑定，使得宿主机以外的世界可以主动将网络报文发送至容器内部。&lt;/li&gt;
&lt;li&gt;外界访问容器内的服务时，需要访问宿主机的 IP 地址以及宿主机的端口。&lt;/li&gt;
&lt;li&gt;NAT 模式是在三层网络上的实现手段，因此肯定会影响网络的传输效率。&lt;/li&gt;
&lt;li&gt;容器拥有独立、隔离的网络栈，让容器和宿主机以外的世界通过 NAT 建立通信。&lt;/li&gt;
&lt;/ul&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/docker/docker-bridge.jpg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图1 · bridge 网络模式
&lt;/center&gt;
&lt;p&gt;iptables 的 SNTA 规则，使得从容器离开去外界的网络包的源IP地址被转换为 docker 宿主机的 IP 地址。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination
MASQUERADE  all  --  172.17.0.0/16        0.0.0.0/0
MASQUERADE  all  --  172.18.0.0/16        0.0.0.0/0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;host-网络模式&#34;&gt;host 网络模式&lt;/h4&gt;
&lt;p&gt;host 模式并没有为容器创建一个隔离的网络环境。之所以称之为 host 模式，是因为该模式下的 docker 容器会和宿主机共享同一个网络命名空间，因此 docker 容器可以和宿主机一样，使用宿主机的 eth0，实现和外界的通信。换句话说，docker 容器的 IP 地址即为宿主机 eth0 的 IP 地址。&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/docker/docker-host.jpg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图2 · host 网络模式
&lt;/center&gt;
&lt;p&gt;其特点如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;这种模式下的容器没有隔离的网络命名空间。&lt;/li&gt;
&lt;li&gt;容器的 IP 地址就是 docker 宿主机的 IP 地址。&lt;/li&gt;
&lt;li&gt;需要注意容器中服务的端口号不能与 docker 宿主机上已经使用的端口号相冲突。&lt;/li&gt;
&lt;li&gt;host 模式能够与其他模式共存。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;none-网络模式&#34;&gt;none 网络模式&lt;/h4&gt;
&lt;p&gt;网络模式为 none，即不为 docker 容器构造任何网络环境。一旦 docker 容器采用了 none 网络模式，那么容器内部就只能使用 loopback 网络设备，不会再有其他的网络资源。docker 容器的 none 网络模式意味着不给该容器创建任何网络环境，容器只能使用 127.0.0.1 的本机网络。&lt;/p&gt;
&lt;h4 id=&#34;macvlan&#34;&gt;macvlan&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/CloudMan6/article/details/77186548&#34;&gt;https://blog.csdn.net/CloudMan6/article/details/77186548&lt;/a&gt;
&lt;a href=&#34;https://blog.csdn.net/cloudman6/article/details/77338515&#34;&gt;https://blog.csdn.net/cloudman6/article/details/77338515&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/cloudvtech/article/details/79830887&#34;&gt;https://blog.csdn.net/cloudvtech/article/details/79830887&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/cloudvtech/article/details/79830887&#34;&gt;https://blog.csdn.net/cloudvtech/article/details/79830887&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;多节点-docker-网络&#34;&gt;多节点 docker 网络&lt;/h3&gt;
&lt;p&gt;docker 多节点网络模式可以分为两类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;docker&lt;/code&gt; 在 1.19 版本中引入的基于 &lt;code&gt;VxLAN&lt;/code&gt; 的对跨节点网络的原生支持。&lt;/li&gt;
&lt;li&gt;通过插件方式引入的第三方实现方案，比如 &lt;code&gt;flannel&lt;/code&gt;，&lt;code&gt;calico&lt;/code&gt; 等。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;docker-原生-overlay-网络&#34;&gt;docker 原生 overlay 网络&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;docker&lt;/code&gt; 1.19 版本中增加了对 &lt;code&gt;overlay&lt;/code&gt; 网络的原生支持。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;docker&lt;/code&gt; 支持 &lt;code&gt;consul&lt;/code&gt;，&lt;code&gt;etcd&lt;/code&gt;和&lt;code&gt;zookeeper&lt;/code&gt; 三种分布式的 key-value 存储。&lt;/p&gt;
&lt;p&gt;其中，etcd 是一个高可用的分布式 key-value 存储系统，使用 etcd 的场景默认处理的数据都是控制数据，对于应用数据，只推荐数据量很小，但是更新、访问频繁的情况。&lt;/p&gt;
&lt;p&gt;1、安装 etcd
在 192.168.91.128 上使用如下命令启动 etcd 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    --net=host \
    --restart=always \
    -v /home/xdhuxc/etcd/data:/etcd-data \
    --name etcd \
    quay.io/coreos/etcd:v3.3 \
    /usr/local/bin/etcd \
    --data-dir=/etcd-data --name etcd-single \
    --initial-advertise-peer-urls http://192.168.91.128:2380 --listen-peer-urls http://0.0.0.0:2380 \
    --advertise-client-urls http://192.168.91.128:2379 --listen-client-urls http://0.0.0.0:2379 \
    --initial-cluster etcd-single=http://192.168.91.128:2380
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改 docker.service 文件，在 docker 启动参数中添加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;--cluster-store=etcd://192.168.91.128:2379
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;重启 docker 服务&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;systemctl daemon-reload
systemctl restart docker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在 192.168.91.128 上创建一个 overlay 网络&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker network create --driver overlay net1            # 创建 overlay 网络 net1
0398dac3d6513160ee035c7499332d7dcba8d2fa9643c45488996f628bf8ab91
[root@xdhuxc ~]# docker network ls                                      # 查看当前docker网络
NETWORK ID          NAME                DRIVER              SCOPE
b9149e6e409b        bridge              bridge              local
b9824657dbd0        host                host                local
0398dac3d651        net1                overlay             global
3b216a2f5426        none                null                local
[root@xdhuxc ~]# docker inspect net1
[
    {
        &amp;#34;Name&amp;#34;: &amp;#34;net1&amp;#34;,
        &amp;#34;Id&amp;#34;: &amp;#34;0398dac3d6513160ee035c7499332d7dcba8d2fa9643c45488996f628bf8ab91&amp;#34;,
        &amp;#34;Created&amp;#34;: &amp;#34;2018-07-15T14:14:48.744993416+08:00&amp;#34;,
        &amp;#34;Scope&amp;#34;: &amp;#34;global&amp;#34;,
        &amp;#34;Driver&amp;#34;: &amp;#34;overlay&amp;#34;,
        &amp;#34;EnableIPv6&amp;#34;: false,
        &amp;#34;IPAM&amp;#34;: {
            &amp;#34;Driver&amp;#34;: &amp;#34;default&amp;#34;,
            &amp;#34;Options&amp;#34;: {},
            &amp;#34;Config&amp;#34;: [
                {
                    &amp;#34;Subnet&amp;#34;: &amp;#34;10.0.0.0/24&amp;#34;,
                    &amp;#34;Gateway&amp;#34;: &amp;#34;10.0.0.1&amp;#34;
                }
            ]
        },
        &amp;#34;Internal&amp;#34;: false,
        &amp;#34;Attachable&amp;#34;: false,
        &amp;#34;Ingress&amp;#34;: false,
        &amp;#34;ConfigFrom&amp;#34;: {
            &amp;#34;Network&amp;#34;: &amp;#34;&amp;#34;
        },
        &amp;#34;ConfigOnly&amp;#34;: false,
        &amp;#34;Containers&amp;#34;: {},
        &amp;#34;Options&amp;#34;: {},
        &amp;#34;Labels&amp;#34;: {}
    }
]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 192.168.91.130 上配置 etcd 信息到 docker.service 文件中，并重启 docker 服务。&lt;/p&gt;
&lt;p&gt;在 192.168.91.130 上，我们也能看到这个网络 net1，这说明通过 etcd 的数据共享，网络数据已经是分布式的了，而不仅仅是本地的。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker network ls
NETWORK ID          NAME                DRIVER              SCOPE
2228e2935455        bridge              bridge              local
bddcee3b802a        host                host                local
0398dac3d651        net1                overlay             global
e8a5f558ec10        none                null                local
[root@xdhuxc ~]# docker inspect net1
[
    {
        &amp;#34;Name&amp;#34;: &amp;#34;net1&amp;#34;,
        &amp;#34;Id&amp;#34;: &amp;#34;0398dac3d6513160ee035c7499332d7dcba8d2fa9643c45488996f628bf8ab91&amp;#34;,
        &amp;#34;Created&amp;#34;: &amp;#34;2018-07-15T14:14:48.744993416+08:00&amp;#34;,
        &amp;#34;Scope&amp;#34;: &amp;#34;global&amp;#34;,
        &amp;#34;Driver&amp;#34;: &amp;#34;overlay&amp;#34;,
        &amp;#34;EnableIPv6&amp;#34;: false,
        &amp;#34;IPAM&amp;#34;: {
            &amp;#34;Driver&amp;#34;: &amp;#34;default&amp;#34;,
            &amp;#34;Options&amp;#34;: {},
            &amp;#34;Config&amp;#34;: [
                {
                    &amp;#34;Subnet&amp;#34;: &amp;#34;10.0.0.0/24&amp;#34;,
                    &amp;#34;Gateway&amp;#34;: &amp;#34;10.0.0.1&amp;#34;
                }
            ]
        },
        &amp;#34;Internal&amp;#34;: false,
        &amp;#34;Attachable&amp;#34;: false,
        &amp;#34;Ingress&amp;#34;: false,
        &amp;#34;ConfigFrom&amp;#34;: {
            &amp;#34;Network&amp;#34;: &amp;#34;&amp;#34;
        },
        &amp;#34;ConfigOnly&amp;#34;: false,
        &amp;#34;Containers&amp;#34;: {},
        &amp;#34;Options&amp;#34;: {},
        &amp;#34;Labels&amp;#34;: {}
    }
]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、在网络中创建容器
在 192.168.91.128 上基于 net1 创建容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker run -d --name over-128 --network net1 zookeeper:latest
adaa369ef21931f04625042949a2f757b9be94a9c67d611a2118e7fecf85f517
[root@xdhuxc ~]# docker ps
CONTAINER ID        IMAGE                      COMMAND                  CREATED             STATUS              PORTS                          NAMES
adaa369ef219        zookeeper:latest           &amp;#34;/docker-entrypoint.…&amp;#34;   5 seconds ago       Up 3 seconds        2181/tcp, 2888/tcp, 3888/tcp   over-128
609e50616c43        quay.io/coreos/etcd:v3.3   &amp;#34;/usr/local/bin/etcd…&amp;#34;   13 minutes ago      Up 9 minutes                                       etcd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# ip addr
1: lo: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;LOOPBACK&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: ens33: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    link/ether 00:0c:29:25:e5:b2 brd ff:ff:ff:ff:ff:ff
    inet 192.168.91.128/24 brd 192.168.91.255 scope global dynamic ens33
       valid_lft 1785sec preferred_lft 1785sec
    inet6 fe80::63c8:5192:716b:79be/64 scope link
       valid_lft forever preferred_lft forever
4: docker0: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;NO-CARRIER&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue state DOWN
    link/ether 02:42:54:4e:84:2b brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
       valid_lft forever preferred_lft forever
9: docker_gwbridge: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue state UP           # 用于 NAT 网络
    link/ether 02:42:a4:44:86:a9 brd ff:ff:ff:ff:ff:ff
    inet 172.18.0.1/16 brd 172.18.255.255 scope global docker_gwbridge
       valid_lft forever preferred_lft forever
    inet6 fe80::42:a4ff:fe44:86a9/64 scope link
       valid_lft forever preferred_lft forever
11: veth76cddb3@if10: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue master docker_gwbridge state UP
    link/ether c2:e5:c6:e7:dc:aa brd ff:ff:ff:ff:ff:ff link-netnsid 1
    inet6 fe80::c0e5:c6ff:fee7:dcaa/64 scope link
       valid_lft forever preferred_lft forever
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;docker run -d --name over-130 --network net1 zookeeper:latest
在 192.168.91.130 上基于 net1 创建容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker run -d --name over-130 --network net1 zookeeper:latest
516157dec4d555cbdf96783e37a27fa32566b5bcaa375f99aee1a37f7d7e7d33
[root@xdhuxc ~]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                          NAMES
516157dec4d5        zookeeper:latest    &amp;#34;/docker-entrypoint.…&amp;#34;   5 seconds ago       Up 3 seconds        2181/tcp, 2888/tcp, 3888/tcp   over-130
[root@xdhuxc ~]#
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# ip addr
1: lo: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;LOOPBACK&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: ens38: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    link/ether 00:0c:29:58:10:3c brd ff:ff:ff:ff:ff:ff
    inet 192.168.91.130/24 brd 192.168.91.255 scope global dynamic ens38
       valid_lft 1310sec preferred_lft 1310sec
    inet6 fe80::43cc:6988:179b:cd2d/64 scope link
       valid_lft forever preferred_lft forever
3: docker0: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;NO-CARRIER&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue state DOWN
    link/ether 02:42:fa:be:c4:e2 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:faff:febe:c4e2/64 scope link
       valid_lft forever preferred_lft forever
22: docker_gwbridge: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue state UP        # 用于 NAT 网络
    link/ether 02:42:27:27:a8:1e brd ff:ff:ff:ff:ff:ff
    inet 172.18.0.1/16 brd 172.18.255.255 scope global docker_gwbridge
       valid_lft forever preferred_lft forever
    inet6 fe80::42:27ff:fe27:a81e/64 scope link
       valid_lft forever preferred_lft forever
24: veth06aa5aa@if23: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue master docker_gwbridge state UP
    link/ether ce:53:38:eb:84:ba brd ff:ff:ff:ff:ff:ff link-netnsid 1
    inet6 fe80::cc53:38ff:feeb:84ba/64 scope link
       valid_lft forever preferred_lft forever
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;进入容器 over-128 中，&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker exec -it over-128 bash
bash-4.4# ip addr
1: lo: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;LOOPBACK&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
7: eth0@if8: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;M-DOWN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1450 qdisc noqueue state UP
    link/ether 02:42:0a:00:00:02 brd ff:ff:ff:ff:ff:ff
    inet 10.0.0.2/24 brd 10.0.0.255 scope global eth0
       valid_lft forever preferred_lft forever
10: eth1@if11: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;M-DOWN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue state UP
    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth1
       valid_lft forever preferred_lft forever
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;进入 容器 over-130 中，发现它有三块网卡：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# docker exec -it over-130 bash
bash-4.4# ip addr
1: lo: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;LOOPBACK&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
20: eth0@if21: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;M-DOWN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1450 qdisc noqueue state UP
    link/ether 02:42:0a:00:00:03 brd ff:ff:ff:ff:ff:ff
    inet 10.0.0.3/24 brd 10.0.0.255 scope global eth0
       valid_lft forever preferred_lft forever
23: eth1@if24: &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;BROADCAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;MULTICAST&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;LOWER_UP&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;M-DOWN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; mtu 1500 qdisc noqueue state UP
    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth1
       valid_lft forever preferred_lft forever
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;其中 &lt;code&gt;eth1@if24&lt;/code&gt; 的网络是一个内部的网段，走的还是普通的NAT模式。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;eth0@if21&lt;/code&gt; 是 &lt;code&gt;overlay&lt;/code&gt; 网段上分配的IP地址，它走的是 &lt;code&gt;overlay&lt;/code&gt; 网络，其 &lt;code&gt;MTU&lt;/code&gt; 是1450，而不是1500。&lt;/p&gt;
&lt;p&gt;进一步查看它的路由表，会发现只有同一个 &lt;code&gt;overlay&lt;/code&gt; 网络中的容器之间的通信才会通过 &lt;code&gt;eth0@if21&lt;/code&gt;，其他所有通信还是走的 &lt;code&gt;eth1&lt;/code&gt;。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;bash-4.4# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         172.18.0.1      0.0.0.0         UG    0      0        0 eth1
10.0.0.0        0.0.0.0         255.255.255.0   U     0      0        0 eth0
172.18.0.0      0.0.0.0         255.255.0.0     U     0      0        0 eth1
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时的网络拓扑图为：&lt;/p&gt;
&lt;center&gt;
&lt;img src=&#34;https://xdhuxc.github.io/image/docker/docker-network-bridge.jpg&#34; width=&#34;800px&#34; height=&#34;300px&#34; /&gt;
图3 · overlay 网络模式
&lt;/center&gt;
&lt;p&gt;可见：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;docker 在每个节点上创建了两个 linux 网桥，一个用于 overlay 网络（ov-000100-1de98），一个用于非 overlay 的 NAT 网络（docker_gwbridge）。&lt;/li&gt;
&lt;li&gt;容器内的到 overlay 网络的其它容器的网络流量走 overlay 网卡，即eth0@if21，其它网络流量走 NAT 网卡，即eth1@if24。&lt;/li&gt;
&lt;li&gt;当前 docker 创建 vxlan 隧道的ID范围为：256~1000，因而最多可以创建745个网络。因此，本例中的这个 vxlan 隧道使用的 ID 是256。&lt;/li&gt;
&lt;li&gt;docker vxlan 驱动使用 4789 UDP 端口。&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc ~]# netstat -nlup
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
udp        0      0 0.0.0.0:68              0.0.0.0:*                           3663/dhclient
udp        0      0 0.0.0.0:4789            0.0.0.0:*                           -
udp        0      0 0.0.0.0:59600           0.0.0.0:*                           3663/dhclient
udp6       0      0 :::31602                :::*                                3663/dhclient
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;overlay 网络模型底层需要类似 consul 或 etcd 的 KV 存储系统进行消息同步。&lt;/li&gt;
&lt;li&gt;docker overlay 不使用多播。&lt;/li&gt;
&lt;li&gt;overlay 网络中的容器处于一个虚拟的大二层网络中。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;从 &lt;code&gt;over-128&lt;/code&gt; ping &lt;code&gt;over-130&lt;/code&gt; 不通，升级内核到4.20以上就可以了。&lt;/p&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cnblogs.com/sammyliu/p/5894191.html&#34;&gt;http://www.cnblogs.com/sammyliu/p/5894191.html&lt;/a&gt;&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker Registry 的搭建和配置</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-original-registry/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-original-registry/</guid>
                <pubDate>Thu, 13 Jul 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了 Docker Registry 的搭建和配置。&lt;/p&gt;
&lt;h3 id=&#34;搭建基本的-docker-registry&#34;&gt;搭建基本的 Docker Registry&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;基于 Docker 镜像方式安装Docker Registry V2。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;本机为 CentOS 7 虚拟机，Minimal模式安装，IP地址为：192.168.91.128。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;开发端也为 CentOS 7 虚拟机，Minimal模式安装，IP地址为：192.168.91.129。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&#34;安装-docker&#34;&gt;安装 docker&lt;/h4&gt;
&lt;p&gt;依次执行如下命令，安装并启动 Docker&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y docker
systemctl enable docker
systemctl start docker
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;获取最新版本的-docker-registry-容器&#34;&gt;获取最新版本的 Docker Registry 容器&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;可去 &lt;a href=&#34;https://store.docker.com/images/registry/plans/75b297cc-0ad7-4ccd-8e80-9a30e72ace7e?tab=tags&#34;&gt;官网&lt;/a&gt; 查找最新的版本号
直接使用 docker 命令去官方公有镜像仓库中拉取&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull registry:2.5.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;运行容器&#34;&gt;运行容器&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;V1 Registry 的仓库目录是：/tmp/registry&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;V2 Registry 的仓库目录是：/var/lib/registry&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;使用如下命令运行容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d -p 5000:5000 --restart=always -v /opt/registry:/var/lib/registry  --name=registry registry:2.5.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;访问-docker-registry&#34;&gt;访问 Docker Registry&lt;/h4&gt;
&lt;p&gt;使用如下命令访问 Docker Registry&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;curl http://192.168.91.128:5000/v2/_catalog
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;如果看到类似如下的JSON格式数据，说明Docker Registry已经运行起来了。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{&amp;#34;repositories&amp;#34;:[]}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;推送镜像&#34;&gt;推送镜像&lt;/h4&gt;
&lt;p&gt;推送镜像时报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker push 192.168.91.128:5000/busybox:latest
The push refers to a repository [192.168.91.128:5000/busybox]
6a749002dd6a: Retrying in 1 second 
received unexpected HTTP status: 500 Internal Server Error
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 &lt;code&gt;docker logs registry&lt;/code&gt; 命令查看日志，发现没有创建目录的权限&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;time=&amp;#34;2017-10-30T14:14:01Z&amp;#34; level=error msg=&amp;#34;response completed with error&amp;#34; err.code=unknown err.detail=&amp;#34;filesystem: mkdir /var/lib/registry/docker: permission denied&amp;#34; err.message=&amp;#34;unknown error&amp;#34; go.version=go1.6.4 
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：在启动命令中加入 &lt;code&gt;--privileged=true&lt;/code&gt; 参数，即使用如下命令启动容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d --privileged=true -p 5000:5000 --restart=always -v /opt/registry:/var/lib/registry  --name=registry registry:2.5.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时，可以正确地上传镜像了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker push 192.168.91.128:5000/busybox:latest
The push refers to a repository [192.168.91.128:5000/busybox]
0271b8eebde3: Pushed 
latest: digest: sha256:91ef6c1c52b166be02645b8efee30d1ee65362024f7da41c404681561734c465 size: 527
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;拉取镜像&#34;&gt;拉取镜像&lt;/h4&gt;
&lt;p&gt;直接使用 &lt;code&gt;docker pull&lt;/code&gt; 命令拉取镜像即可，如下所示：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost registry]# docker pull 192.168.91.128:5000/busybox:latest
Trying to pull repository 192.168.91.128:5000/busybox ... 
latest: Pulling from 192.168.91.128:5000/busybox
03b1be98f3f9: Pull complete 
Digest: sha256:030fcb92e1487b18c974784dcc110a93147c9fc402188370fbfd17efabffc6af
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;带权限访问-docker-registry&#34;&gt;带权限访问 Docker Registry&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;控制registry的使用权限，使其只有在登录用户名和密码之后才能使用。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、创建用户名和密码&lt;/p&gt;
&lt;p&gt;可以通过 &lt;code&gt;htpasswd&lt;/code&gt; 来生成 &lt;code&gt;registry&lt;/code&gt; 的用户名和密码文件&lt;/p&gt;
&lt;p&gt;依次执行如下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# mkdir /etc/registry/auth/
[root@store registry]# docker run --entrypoint htpasswd registry:2.5.2 -Bbn admin Admin123 &amp;gt;&amp;gt; /etc/registry/auth/htpasswd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;生成了存储用户名和密码的文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store auth]# pwd
/etc/registry/auth
[root@store auth]# ls
htpasswd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、启动Registry容器&lt;/p&gt;
&lt;p&gt;现在使用如下命令启动容器（注意命令参数之间的空格）&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -p 5000:5000 \
    --restart=always \
    --name=registry \
    -v /etc/registry/auth/:/auth/ \
    -e &amp;#34;REGISTRY_AUTH=htpasswd&amp;#34; \
    -e &amp;#34;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm&amp;#34; \
    -e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \ &lt;span class=&#34;ni&#34;&gt;#此处为相对路径&lt;/span&gt;
    -v /opt/registry/:/var/lib/registry/ \
    registry:2.5.2  
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时，访问仓库时出现错误，需要登录才能访问&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store ~]# curl http://192.168.91.128:5000/v2/_catalog|python -m json.tool
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   134  100   134    0     0  52755      0 --:--:-- --:--:-- --:--:-- 67000
{
    &amp;#34;errors&amp;#34;: [
        {
            &amp;#34;code&amp;#34;: &amp;#34;UNAUTHORIZED&amp;#34;,
            &amp;#34;detail&amp;#34;: [
                {
                    &amp;#34;Action&amp;#34;: &amp;#34;*&amp;#34;,
                    &amp;#34;Name&amp;#34;: &amp;#34;catalog&amp;#34;,
                    &amp;#34;Type&amp;#34;: &amp;#34;registry&amp;#34;
                }
            ],
            &amp;#34;message&amp;#34;: &amp;#34;authentication required&amp;#34;
        }
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;没有登录时，push时提示如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store ~]# docker push 192.168.91.128:5000/busybox:latest
The push refers to a repository [192.168.91.128:5000/busybox]

no basic auth credentials
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;没有登录时，pull时提示如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store ~]# docker pull 192.168.91.128:5000/busybox:latest
Trying to pull repository 192.168.91.128:5000/busybox ... 
Pulling repository 192.168.91.128:5000/busybox
Error: image busybox:latest not found
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;登陆后即可进行正常的 &lt;code&gt;push&lt;/code&gt; 和 &lt;code&gt;pull&lt;/code&gt; 操作&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store ~]# docker login 192.168.91.128:5000
Username: admin
Password: 
Login Succeeded
[root@store ~]# docker pull 192.168.91.128:5000/busybox:latest
Trying to pull repository 192.168.91.128:5000/busybox ... 
latest: Pulling from 192.168.91.128:5000/busybox
03b1be98f3f9: Pull complete 
Digest: sha256:030fcb92e1487b18c974784dcc110a93147c9fc402188370fbfd17efabffc6af
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;访问镜像仓库信息时，使用如下命令：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;也可以这样使用：&lt;code&gt;curl -u admin:Admin123 http://192.168.91.128:5000/v2/_catalog|python -m json.tool&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store ~]# curl --user admin:Admin123 http://192.168.91.128:5000/v2/_catalog|python -m json.tool
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    29  100    29    0     0   4969      0 --:--:-- --:--:-- --:--:--  5800
{
    &amp;#34;repositories&amp;#34;: [
        &amp;#34;busybox&amp;#34;
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;也可以通过宿主机浏览器访问镜像仓库，在弹出的认证对话框中输入正确的用户名和密码，登陆后即可看到所需信息。&lt;/p&gt;
&lt;h3 id=&#34;使用-api-访问docker-registry&#34;&gt;使用 API 访问Docker Registry&lt;/h3&gt;
&lt;p&gt;1、查询注册服务器中的仓库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl http://192.168.91.128:5000/v2/_catalog
{&amp;#34;repositories&amp;#34;:[&amp;#34;busybox&amp;#34;,&amp;#34;nginx&amp;#34;,&amp;#34;phpmyadmin&amp;#34;]}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查询某个仓库中镜像的版本&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl http://192.168.91.128:5000/v2/busybox/tags/list
{&amp;#34;name&amp;#34;:&amp;#34;busybox&amp;#34;,&amp;#34;tags&amp;#34;:[&amp;#34;latest&amp;#34;,&amp;#34;1.2.1&amp;#34;]}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;多用户-docker-仓库创建安全认证和应用httpblogcsdnnetdream_anarticledetails58005324&#34;&gt;&lt;a href=&#34;http://blog.csdn.net/dream_an/article/details/58005324&#34;&gt;多用户 Docker 仓库创建安全认证和应用&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;1、安装 docker，下载 registry 镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;yum install -y docker
systemctl start docker
docker pull registry:2.5.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、在服务器端创建自定义签发的CA证书
执行以下命令：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p /etc/registry/certs &lt;span class=&#34;err&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; openssl req \
    -newkey rsa:4096 -nodes -sha256 -keyout /etc/registry/certs/domain.key \
    -x509 -days 365 -out /etc/registry/certs/domain.crt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;填写如下信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Country Name (2 letter code) [XX]:CN
State or Province Name (full name) []:ShanxiSheng
Locality Name (eg, city) [Default City]:ShangluoShi
Organization Name (eg, company) [Default Company Ltd]:Xdhuxc
Organizational Unit Name (eg, section) []:Xdhuxc
Common Name (eg, your name or your server&amp;#39;s hostname) []:store.xdhuxc.com
Email Address []:xdhuxc@163.com
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;在 &lt;code&gt;/etc/registry/certs&lt;/code&gt; 目录下生成了自定义签发的CA证书&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store certs]# pwd
/etc/registry/certs
[root@store certs]# ls
domain.crt  domain.key
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、添加多用户信息，创建仓库的使用者用户名和密码&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;添加多个 docker 仓库使用者的用户名和其密码&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run --entrypoint htpasswd registry:2.5.2 -Bbn admin Admin123 &amp;gt;&amp;gt; /etc/registry/auth/htpasswd
docker run --entrypoint htpasswd registry:2.5.2 -Bbn root Root123 &amp;gt;&amp;gt; /etc/registry/auth/htpasswd
docker run --entrypoint htpasswd registry:2.5.2 -Bbn xdhuxc Xdhuxc123 &amp;gt;&amp;gt; /etc/registry/auth/htpasswd
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、启动 Docker Registry 容器
使用如下命令启动 Docker Registry 容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    -p 5000:5000 \
    --restart=always \
    --name registry \
    -v /etc/registry/auth:/auth \
    -e &amp;#34;REGISTRY_AUTH=htpasswd&amp;#34; \
    -e &amp;#34;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm&amp;#34; \
    -e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \
    -v /etc/registry/certs:/certs \
    -e REGISTRY_HTTP_TLS_CERTIFICATE=/certs/domain.crt \
    -e REGISTRY_HTTP_TLS_KEY=/certs/domain.key \
    registry:2.5.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、通过 sftp 或者 scp 将远程仓库服务器端的 domain.crt 复制到开发端指定的位置&lt;/p&gt;
&lt;p&gt;对于 Ubuntu 系统&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;mkdir -p ~/certs.d/store.xdhuxc.com:5000
cp ~/domain.crt /etc/docker/certs.d/store.xdhuxc.com:5000/ca.crt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对于 Redhat 系统&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;cp ~/domain.crt /usr/local/share/ca-certificates/store.xdhuxc.com.crt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;对于 CentOS 系统&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# scp root@192.168.91.128:/etc/registry/certs/domain.crt /etc/pki/ca-trust/source/anchors/
The authenticity of host &amp;#39;192.168.91.128 (192.168.91.128)&amp;#39; can&amp;#39;t be established.
ECDSA key fingerprint is SHA256:Db3KNpRrupfzz8n9hvx0ZqCKMVI17+1oHGzWxT6gShA.
ECDSA key fingerprint is MD5:4d:dc:06:bd:da:a9:fa:e4:ba:f9:02:9e:bd:7e:79:a1.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &amp;#39;192.168.91.128&amp;#39; (ECDSA) to the list of known hosts.
root@192.168.91.128&amp;#39;s password: 
domain.crt                                                                   100% 2163     1.7MB/s   00:00    
[root@localhost ~]# /bin/update-ca-trust extract
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# scp root@192.168.91.128:/etc/registry/certs/domain.crt /etc/docker/certs.d/
root@192.168.91.128&amp;#39;s password: 
domain.crt                                                                                                                               100% 2163   746.3KB/s   00:00    
[root@localhost ~]# /bin/update-ca-trust extract
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、从官网下载镜像，重新标记，推送至私有仓库&lt;/p&gt;
&lt;p&gt;1）从dockerhub下载镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker pull alpine
Using default tag: latest
Trying to pull repository docker.io/library/alpine ... 
latest: Pulling from docker.io/library/alpine
b56ae66c2937: Pull complete 
Digest: sha256:b40e202395eaec699f2d0c5e01e6d6cb8e6b57d77c0e0221600cf0b5940cf3ab
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2）重新标记镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker tag docker.io/alpine:latest store.xdhuxc.com:5000/alpine:1.1.0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3）推送至私有仓库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker push store.xdhuxc.com:5000/alpine:1.1.0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;此时，终端显示如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;The push refers to a repository [store.xdhuxc.com:5000/alpine]

no basic auth credentials
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、登录私有的Docker Registry&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker login -u admin -p Admin123 store.xdhuxc.com:5000
Login Succeeded
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、此时，可以推送镜像至私有仓库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker push store.xdhuxc.com:5000/alpine:1.1.0
The push refers to a repository [store.xdhuxc.com:5000/alpine]
2aebd096e0e2: Layer already exists 
1.1.0: digest: sha256:a09e6318d74f23fe68bad84259fedf5e6ce02c38537336419ee5e9abe10aa2af size: 528
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;6、也可以从仓库中拉取镜像到本地&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker pull store.xdhuxc.com:5000/alpine:1.1.0
Trying to pull repository store.xdhuxc.com:5000/alpine ... 
1.1.0: Pulling from store.xdhuxc.com:5000/alpine
b56ae66c2937: Pull complete 
Digest: sha256:a09e6318d74f23fe68bad84259fedf5e6ce02c38537336419ee5e9abe10aa2af
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;退出登陆后，就不能再拉取私有仓库中的镜像了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# docker logout store.xdhuxc.com:5000
Remove login credentials for store.xdhuxc.com:5000
[root@localhost ~]# docker pull store.xdhuxc.com:5000/alpine:1.1.0
Trying to pull repository store.xdhuxc.com:5000/alpine ... 
Pulling repository store.xdhuxc.com:5000/alpine
Error: image alpine:1.1.0 not found
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;7、使用 HTTP API V2 在开发端访问镜像仓库
没有附加登录用户信息时，终端输出如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost certs.d]# curl https://store.xdhuxc.com:5000/v2/alpine/tags/list | python -m json.tool
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   138  100   138    0     0    990      0 --:--:-- --:--:-- --:--:--  1000
{
    &amp;#34;errors&amp;#34;: [
        {
            &amp;#34;code&amp;#34;: &amp;#34;UNAUTHORIZED&amp;#34;,
            &amp;#34;detail&amp;#34;: [
                {
                    &amp;#34;Action&amp;#34;: &amp;#34;pull&amp;#34;,
                    &amp;#34;Name&amp;#34;: &amp;#34;alpine&amp;#34;,
                    &amp;#34;Type&amp;#34;: &amp;#34;repository&amp;#34;
                }
            ],
            &amp;#34;message&amp;#34;: &amp;#34;authentication required&amp;#34;
        }
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用 HTTP 协议和 HTTPS 协议访问镜像仓库，结果是不同的&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# cat /etc/docker/daemon.json 
{}
[root@localhost ~]# curl -u admin:Admin123 http://store.xdhuxc.com:5000/v2/_catalog | python -m json.tool
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    14    0    14    0     0   1722      0 --:--:-- --:--:-- --:--:--  2000
No JSON object could be decoded
[root@localhost ~]# curl -u admin:Admin123 https://store.xdhuxc.com:5000/v2/_catalog | python -m json.tool
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    28  100    28    0     0    193      0 --:--:-- --:--:-- --:--:--   194
{
    &amp;#34;repositories&amp;#34;: [
        &amp;#34;alpine&amp;#34;
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;附带登录用户信息访问时，可以正确访问。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl -u admin:Admin123 https://store.xdhuxc.com:5000/v2/_catalog|python -m json.tool
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    28  100    28    0     0    196      0 --:--:-- --:--:-- --:--:--   198
{
    &amp;#34;repositories&amp;#34;: [
        &amp;#34;alpine&amp;#34;
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;查看镜像信息&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost ~]# curl -u admin:Admin123 https://store.xdhuxc.com:5000/v2/alpine/tags/list | python -m json.tool
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    35  100    35    0     0    282      0 --:--:-- --:--:-- --:--:--   284
{
    &amp;#34;name&amp;#34;: &amp;#34;alpine&amp;#34;,
    &amp;#34;tags&amp;#34;: [
        &amp;#34;1.1.0&amp;#34;
    ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;相关问题&#34;&gt;相关问题&lt;/h3&gt;
&lt;p&gt;1、如果没有在开发端 &lt;code&gt;/etc/hosts&lt;/code&gt; 中添加 Docker Registry 所在主机IP地址和域名的对应关系，会报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@localhost tls]# docker push store.xdhuxc.com:5000/nginx:1.1.0
The push refers to a repository [store.xdhuxc.com:5000/nginx]
Get https://store.xdhuxc.com:5000/v1/_ping: dial tcp: lookup store.xdhuxc.com on 192.168.91.2:53: no such host
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、此时，在浏览器中无法使用域名(store.xdhuxc.com)访问镜像仓库，也就是访问地址 &lt;code&gt;https://store.xdhuxc.com:5000/v2/_catalog&lt;/code&gt;，将会出现 &lt;code&gt;找不到 store.xdhuxc.com 的服务器 DNS 地址。&lt;/code&gt;，在Windows系统的 &lt;code&gt;C:\Windows\System32\drivers\etc\hosts&lt;/code&gt;中添加IP地址和域名的对应关系，便可以使用域名访问了；但是可以使用IP地址直接访问镜像仓库，访问地址为：&lt;code&gt;https://192.168.91.128:5000/v2/_catalog&lt;/code&gt;，均需要输入正确的用户名和密码。&lt;/p&gt;
&lt;p&gt;3、使用自签署的证书后，登录时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@store auth]# docker login store.xdhuxc.com:5000
Username: admin
Password: 
Error response from daemon: Get https://store.xdhuxc.com:5000/v1/users/: x509: certificate signed by unknown authority (possibly because of &amp;#34;crypto/rsa: verification error&amp;#34; while trying to verify candidate authority certificate &amp;#34;store.xdhuxc.com&amp;#34;)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;可能是因为将自签署的CA证书放到了 &lt;code&gt;/etc/pki/ca-trust/source/anchors/&lt;/code&gt; 目录下，然而，docker有自己的证书存放目录，路径为： &lt;code&gt;/etc/docker/certs.d/&lt;/code&gt;。所以，将自签署的CA证书复制到开发端的 &lt;code&gt;/etc/docker/certs.d&lt;/code&gt; 目录下，然后重启docker进程。
另外，根据官方资料，可以在 &lt;code&gt;/etc/docker/certs.d&lt;/code&gt; 目录下创建 &lt;code&gt;store.xdhuxc.com:5000&lt;/code&gt; 目录，将CA证书复制到该目录下即可，无需重启docker进程。&lt;/p&gt;
&lt;h3 id=&#34;使用nginx代理域名访问-docker-registry&#34;&gt;使用Nginx代理，域名访问 Docker Registry&lt;/h3&gt;
&lt;p&gt;可以使用 &lt;code&gt;Nginx&lt;/code&gt; 为 &lt;code&gt;docker&lt;/code&gt; 私有仓库做反向代理，以便使其可以在外网访问&lt;/p&gt;
&lt;p&gt;启动 &lt;code&gt;registry&lt;/code&gt; 容器的命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -p 5000:5000 \
    -v /home/xdhuxc/registry:/var/lib/registry \
    --name=registry \
    registry:2.6.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;启动 &lt;code&gt;nginx&lt;/code&gt; 容器的命令为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker run -d \
    --privileged=true \
    -p 80:80 \
    -v /home/xdhuxc/nginx/conf:/etc/nginx \
    --name=nginx \
    nginx:1.13.7
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;nginx&lt;/code&gt; 的配置为：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;server {
    listen       80;
    server_name  dockerhub.yonyoucloud.com;

    proxy_set_header Host $http_host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

    location / {
        auth_basic off;
	    proxy_pass http://192.168.91.128:5000;
    }

    location /_ping {
 
        auth_basic off;
        proxy_pass http://192.168.91.128:5000;
    }
	
    location /v1/_ping/ {
	
        auth_basic off;
        proxy_pass http://192.168.91.128:5000;
    }

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;为镜像打标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker tag docker.io/registry:2.6.2 dockerhub.yonyoucloud.com/registry:2.6.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;推送至私有镜像仓库&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker push dockerhub.yonyoucloud.com/registry:2.6.2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;推送镜像时，报错如下：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;error parsing HTTP 413 response body: invalid character &amp;#39;&lt;span class=&#34;err&#34;&gt;&amp;lt;&lt;/span&gt;&amp;#39; looking for beginning of value: &amp;#34;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;\r\n&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;413 Request Entity Too Large&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;\r\n&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;bgcolor&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;\&amp;#34;&lt;span class=&#34;s&#34;&gt;white&lt;/span&gt;\&amp;#34;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;\r\n&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;center&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;413 Request Entity Too Large&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;center&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;\r\n&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;center&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;nginx/1.13.7&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;center&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;\r\n&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;\r\n&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;\r\n&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：&lt;/p&gt;
&lt;p&gt;在 nginx.conf 中添加如下语句，重启 nginx 进程或容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;client_max_body_size 0; &lt;span class=&#34;ni&#34;&gt;#不限制上传大型镜像&lt;/span&gt;
chunked_transfer_encoding on;  required to avoid HTTP 411: see Issue &lt;span class=&#34;ni&#34;&gt;#1486&lt;/span&gt; (https://github.com/docker/docker/issues/1486)
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;/etc/docker目录下daemon.json的配置&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@xdhuxc docker]# cat daemon.json
{
	&amp;#34;dns&amp;#34;:[&amp;#34;127.0.0.1&amp;#34;,&amp;#34;8.8.8.8&amp;#34;,&amp;#34;192.168.91.2&amp;#34;],
	&amp;#34;storage-driver&amp;#34;: &amp;#34;devicemapper&amp;#34;,
	&amp;#34;insecure-registries&amp;#34;: [&amp;#34;0.0.0.0/0&amp;#34;]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;参考资料&#34;&gt;参考资料&lt;/h2&gt;
&lt;p&gt;1、https://docs.docker.com/registry/deploying/#basic-configuration&lt;/p&gt;
&lt;p&gt;2、http://blog.csdn.net/gqtcgq/article/details/51163558&lt;/p&gt;
&lt;p&gt;3、http://blog.csdn.net/dream_an/article/details/58005324&lt;/p&gt;
&lt;p&gt;4、http://blog.csdn.net/qq245671051/article/details/69487321&lt;/p&gt;
&lt;p&gt;5、http://blog.csdn.net/felix_yujing/article/details/51564739&lt;/p&gt;
&lt;p&gt;6、http://blog.csdn.net/renhuailin/article/details/50461651&lt;/p&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Harbor 镜像仓库的安装和使用</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-registry-harbor/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-registry-harbor/</guid>
                <pubDate>Mon, 10 Jul 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客详细介绍了 Harbor 的安装，配置和使用过程。&lt;/p&gt;
&lt;h3 id=&#34;安装环境&#34;&gt;安装环境&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;CentOS 7，Minimal模式安装&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1、Python 2.7 及以上版本&lt;/p&gt;
&lt;p&gt;2、Docker engine 1.10 及以上版本&lt;/p&gt;
&lt;p&gt;3、Docker Compose 1.6.0 及以上版本&lt;/p&gt;
&lt;h3 id=&#34;安装配置&#34;&gt;安装配置&lt;/h3&gt;
&lt;p&gt;1、从 &lt;code&gt;https://github.com/vmware/harbor&lt;/code&gt; 上下载 &lt;code&gt;habor&lt;/code&gt; 的离线安装版并解压&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;wget https://github.com/vmware/harbor/releases/download/v1.2.2/harbor-offline-installer-v1.2.2.tgz
tar -xvf harbor-offline-installer-v1.2.2.tgz
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、修改配置文件&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;修改habor.cfg，将hostname改为本机IP地址（192.168.244.135）和自定义端口号（8090）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;gu&#34;&gt;## Harbor的配置文件
&lt;/span&gt;&lt;span class=&#34;gu&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;gh&#34;&gt;#The IP address or hostname to access admin UI and registry service.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;#DO NOT use localhost or 127.0.0.1, because Harbor needs to be accessed by external clients.
&lt;/span&gt;&lt;span class=&#34;gh&#34;&gt;&lt;/span&gt;hostname = 192.168.244.135:8090
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;修改docker-compose.yml，将 nginx 的代理端口映射由 &lt;code&gt;80:80&lt;/code&gt; 改为 &lt;code&gt;8090:80&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  proxy:
    image: vmware/nginx-photon:1.11.13
    container_name: nginx
    restart: always
    volumes:
      - ./common/config/nginx:/etc/nginx:z
    networks:
      - harbor
    ports:
      - 8090:80
      - 443:443
      - 4443:4443
    depends_on:
      - mysql
      - registry
      - ui
      - log
    logging:
      driver: &amp;quot;syslog&amp;quot;
      options:
        syslog-address: &amp;quot;tcp://127.0.0.1:1514&amp;quot;
        tag: &amp;quot;proxy&amp;quot;
networks:
  harbor:
    external: false
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;3、初始化安装脚本和配置文件&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./prepare
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、执行安装脚本，使用root用户执行的，因为默认的模板中有很多文件目录权限只有root用户才有权限。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;./install.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;5、访问，使用默认的用户名和密码：admin/Harbor12345&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;http://192.168.244.135:8090
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;基本使用&#34;&gt;基本使用&lt;/h3&gt;
&lt;h4 id=&#34;注意事项&#34;&gt;注意事项&lt;/h4&gt;
&lt;p&gt;1、在 &lt;code&gt;harbor.cfg&lt;/code&gt; 中将 &lt;code&gt;self_registration&lt;/code&gt; 属性设置为 &lt;code&gt;off&lt;/code&gt;，那么普通用户将无法自己实现注册，只能由管理员创建用户，否则在页面上可以看到注册按钮。&lt;/p&gt;
&lt;p&gt;2、只有项目管理员及开发人员的角色才可以 &lt;code&gt;push&lt;/code&gt; 镜像，其他角色的人员只有 &lt;code&gt;pull&lt;/code&gt; 镜像的权限。&lt;/p&gt;
&lt;h4 id=&#34;上传镜像到-habor-仓库&#34;&gt;上传镜像到 Habor 仓库&lt;/h4&gt;
&lt;p&gt;1、登录到待上传镜像所在的主机，为待上传镜像打上标签，名称按照如下格式：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;habor_registry_ip_address[:port_number]/project_name/image_name[:tag]
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;使用如下命令登录时，出现了错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;[root@centos_1 ~]# docker login -u admin -p Habor12345 192.168.244.135:8090
Error response from daemon: Get https://192.168.244.135:8090/v1/users/: http: server gave HTTP response to HTTPS client
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：修改docker镜像所在主机的&lt;code&gt;/etc/docker/daemon.json&lt;/code&gt;文件，在文件中增加如下内容：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;{
        # 192.168.244.135：搭建的Registry所在主机IP地址
        # 8090：搭建的Registry的端口号
	&amp;#34;insecure-registries&amp;#34;:[&amp;#34;192.168.244.135:8090&amp;#34;]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;然后重新启动docker守护进程&lt;/p&gt;
&lt;p&gt;登录时可能会报如下错误：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;Error response from daemon: Get http://192.168.244.135:8090/v2/: unauthorized: authentication required
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;解决：使用正确的用户名和密码登录，直接将密码写在命令行中&lt;/p&gt;
&lt;p&gt;使用如下命令登录到 Habor registry&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker login -u admin -p Harbor12345 192.168.244.135:8090
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;1、为待上传镜像打上标签&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker tag docker.io/phpmyadmin/phpmyadmin:latest 192.168.244.135:8090/core/phpmyadmin:1.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、推送镜像到Habor Registry&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker push 192.168.244.135:8090/core/phpmyadmin:1.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;从-habor-仓库拉取镜像&#34;&gt;从 Habor 仓库拉取镜像&lt;/h4&gt;
&lt;p&gt;使用命令直接拉取即可&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker pull 192.168.244.135:8090/core/phpmyadmin:1.0.0
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/harbor/">Harbor</category>
                                
                            
                        
                    
                
            </item>
        
            <item>
                <title>Docker 实用命令总结</title>
                <link>https://xdhuxc.github.io/posts/docker/docker-practical-command/</link>
                <guid isPermaLink="true">https://xdhuxc.github.io/posts/docker/docker-practical-command/</guid>
                <pubDate>Sun, 18 Jun 2017 00:00:00 &#43;0000</pubDate>
                
                    <author>xdhuxc@163.com (xdhuxc)</author>
                
                <copyright>xdhuxc 版权所有</copyright>
                
                    <description>&lt;p&gt;本篇博客整理了一些 docker 实用命令，包括一些组合命令，可以直接修改使用。&lt;/p&gt;
&lt;h3 id=&#34;常用命令&#34;&gt;常用命令&lt;/h3&gt;
&lt;p&gt;1、从容器里面复制文件或目录到本地的某个路径&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker cp nginx:/xdhuxc/a.html ./a.html
或
docker cp 980cfa7fa636:/xdhuxc/a.html ./a.html
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、查看容器的root用户密码&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker logs nginx/980cfa7fa636 2&amp;gt;&lt;span class=&#34;err&#34;&gt;&amp;amp;&lt;/span&gt;1 | grep &amp;#39;^User:&amp;#39;|tail -n1 
&lt;span class=&#34;gh&#34;&gt;# Docker容器启动时的root用户的密码是随机分配的。所以，通过这种方式就可以得到redmine容器的root用户的密码了
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、获取容器状态&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker inspect --format=&amp;#39;{{.State.Status}}&amp;#39; ffbb1145d1d7/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;4、获取容器的内部IP地址&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker inspect --format=&amp;#39;{{.NetworkSettins.IPAddress}}&amp;#39; ba24b244e370/redis
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;docker images 默认隐藏了中间状态的镜像，可以使用 docker images -a 命令来查看中间状态的镜像。&lt;/p&gt;
&lt;p&gt;docker history 命令可以查看该镜像中每一层的信息。&lt;/p&gt;
&lt;h3 id=&#34;常用组合命令&#34;&gt;常用组合命令&lt;/h3&gt;
&lt;p&gt;1、删除所有 docker 镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker ps -a | awk &amp;#39;NR &amp;gt; 1 { print $1 }&amp;#39; | xargs docker rm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2、删除为 none 的镜像&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt; docker images | grep none | awk &amp;#39;{ print $3 }&amp;#39;| xargs docker rmi -f
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3、删除已经退出的docker容器&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;docker ps -a|grep Exited|awk &amp;#39;{print $1}&amp;#39;|xargs docker rm
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
                
                
                
                
                
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/categories/docker/">Docker</category>
                                
                            
                        
                    
                        
                            
                                
                                
                                
                                    <category domain="https://xdhuxc.github.io/tags/docker/">Docker</category>
                                
                            
                        
                    
                
            </item>
        
    </channel>
</rss>
