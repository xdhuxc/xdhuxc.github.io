[{"categories":"posts","content":"\u003cp\u003e使用 VirtualBox 来创建虚拟机并配置网络比较复杂，改用 Vagrant 来创建虚拟机，实现 \u0026quot;Code As Infrastructure\u0026quot;， 本篇博客就记录下使用 Vagrant 创建和配置虚拟机的方法。\u003c/p\u003e\n\u003ch3 id=\"基本使用\"\u003e基本使用\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e在 Mac 上安装 vagrant\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebrew install vagrant\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"2\"\u003e\n\u003cli\u003e准备 box，其实就是定制的操作系统镜像\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant box add devalone/ubuntu-20.04-server-x64-puppet\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"3\"\u003e\n\u003cli\u003e初始化\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant init devalone/ubuntu-20.04-server-x64-puppet\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e会在当前目录下生成 Vagrantfile，记录着虚拟机的配置\u003c/p\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e启动虚拟机\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant up\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"5\"\u003e\n\u003cli\u003e登录虚拟机\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant ssh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e进入虚拟机后，使用 \u003ccode\u003esudo su -\u003c/code\u003e 可以切换到 root 用户。\u003c/p\u003e\n\u003cp\u003e如果需要登录到指定虚拟机，使用如下命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant ssh devstack-controller\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"6\"\u003e\n\u003cli\u003e停止虚拟机\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant halt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"7\"\u003e\n\u003cli\u003e查看虚拟机的状态\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant status\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"高级用法\"\u003e高级用法\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e需要增加内存或者 CPU 时，在 Vagrantfile 中增加如下内容：\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econfig.vm.provider \u0026#34;virtualbox\u0026#34; do |vb|\n    # Display the VirtualBox GUI when booting the machine\n    # vb.gui = false\n    # Customize the amount of memory on the VM:\n    vb.memory = 4096\n    vb.cpus = 4\nend\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后使用 \u003ccode\u003evagrant reload\u003c/code\u003e 命令重新加载一下，才能使配置生效。\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e使用如下 Vagrantfile 创建多个虚拟机\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# -*- mode: ruby -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# vi: set ft=ruby :\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eVagrant.configure(\u0026#34;2\u0026#34;) do |config|\n  config.vm.boot_timeout = 1000\n  # 定义多个 VM\n    config.vm.define \u0026#34;devstack-controller\u0026#34; do |controller|\n        controller.vm.box = \u0026#34;devalone/ubuntu-20.04-server-x64-puppet\u0026#34;\n        controller.vm.hostname = \u0026#34;devstack-controller\u0026#34;\n        controller.vm.network \u0026#34;private_network\u0026#34;, ip: \u0026#34;192.168.56.10\u0026#34;\n        \n        controller.vm.provider \u0026#34;virtualbox\u0026#34; do |vb|\n          vb.memory = 4096\n          vb.cpus = 4\n        end\n    end\n\n    config.vm.define \u0026#34;devstack-computer-01\u0026#34; do |computer|\n        computer.vm.box = \u0026#34;devalone/ubuntu-20.04-server-x64-puppet\u0026#34;\n        computer.vm.hostname = \u0026#34;devstack-computer-01\u0026#34;\n        computer.vm.network \u0026#34;private_network\u0026#34;, ip: \u0026#34;192.168.56.11\u0026#34;\n        \n        computer.vm.provider \u0026#34;virtualbox\u0026#34; do |vb|\n          vb.memory = 1024\n          vb.cpus = 2\n        end\n    end\nend\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://www.vagrantbox.es/\"\u003ehttp://www.vagrantbox.es/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://app.vagrantup.com/boxes/search?order=desc\u0026amp;page=1\u0026amp;provider=virtualbox\u0026amp;q=ubuntu+server\u0026amp;sort=created\u0026amp;utf8=%E2%9C%93\"\u003ehttps://app.vagrantup.com/boxes/search?order=desc\u0026amp;page=1\u0026amp;provider=virtualbox\u0026amp;q=ubuntu+server\u0026amp;sort=created\u0026amp;utf8=%E2%9C%93\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://learn.hashicorp.com/tutorials/vagrant/getting-started-index?in=vagrant/getting-started\"\u003ehttps://learn.hashicorp.com/tutorials/vagrant/getting-started-index?in=vagrant/getting-started\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/xishuai/p/macos-use-vagrant-with-virtualbox.html\"\u003ehttps://www.cnblogs.com/xishuai/p/macos-use-vagrant-with-virtualbox.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://codeantenna.com/a/YXYhkTErAM\"\u003ehttps://codeantenna.com/a/YXYhkTErAM\u003c/a\u003e\u003c/p\u003e","date":1642982400,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1642982400,"objectID":"2f6c73bf6b494a42b0f7041d4ad54d62","publishdate":1642982400,"relpermalink":"/posts/cloud/vagrant/vagrant-basic-usage/","section":"posts","summary":"\u003cp\u003e使用 VirtualBox 来创建虚拟机并配置网络比较复杂，改用 Vagrant 来创建虚拟机，实现 \u0026quot;Code As Infrastructure\u0026quot;， 本篇博客就记录下使用 Vagrant 创建和配置虚拟机的方法。\u003c/p\u003e","tags":["Vagrant"],"title":"Vagrant 的基本使用","url":"https://xdhuxc.github.io/posts/cloud/vagrant/vagrant-basic-usage/","wordcount":442},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下将 Python 脚本转换为各类型操作系统上的可执行文件的方法。\u003c/p\u003e\n\u003ch3 id=\"编写-gui-程序\"\u003e编写 GUI 程序\u003c/h3\u003e\n\u003cp\u003e实验环境：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOS：Windows 10\u003c/li\u003e\n\u003cli\u003ePython：3.9.7\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e我们使用 PyQt 编写一个 GUI 程序，代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: utf-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# author: wanghuan\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# date: 1/18/22\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# description:\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport sys\nimport random\nfrom PyQt5.Qt import *\n\npoems = [\u0026#34;问渠那得清如许，为有源头活水来\u0026#34;,\n         \u0026#34;泪眼问花花不语，乱红飞过秋千去\u0026#34;,\n         \u0026#34;莫等闲，白了少年头，空悲切\u0026#34;,\n         \u0026#34;不经一番彻骨寒，怎得梅花扑鼻香\u0026#34;,\n         \u0026#34;风萧萧兮易水寒，壮士一去兮不复还\u0026#34;,\n         \u0026#34;苟利国家生死以，岂因祸福避趋之\u0026#34;,\n         \u0026#34;人生自古谁无死？留取丹心照汗青\u0026#34;,\n         \u0026#34;落红不是无情物，化作春泥更护花\u0026#34;\n         \u0026#34;露从今夜白，月是故乡明\u0026#34;]\n\n\n\u003cspan class=\"gh\"\u003e# 槽函数\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edef handle():\n    label.resize(250, 30)\n    label.setAlignment(Qt.AlignRight | Qt.AlignCenter)\n    label.setStyleSheet(\u0026#34;background-color:green\u0026#34;)\n    label.setWordWrap(True)\n    label.setText(poems[random.randint(0, len(poems)-1)])\n\n\nif \u003cspan class=\"gs\"\u003e__name__\u003c/span\u003e == \u0026#39;__main__\u0026#39;:\n    app = QApplication(sys.argv)  # 实例对象\n\n    # 窗体大小\n    window = QWidget()\n    window.resize(500, 500)\n    window.setWindowTitle(\u0026#39;GUI 程序\u0026#39;)\n    window.move(400, 200)\n\n    # 标签\n    label = QLabel(window)\n    label.setText(\u0026#39;这里会显示一条信息\u0026#39;)\n    label.move(100, 100)\n\n    # 按钮1\n    button = QPushButton(window)\n    button.setText(\u0026#34;点击它\u0026#34;)\n    button.move(200, 200)\n    button.clicked.connect(handle)  # 信号与槽\n\n    # 显示窗体\n    window.show()\n    sys.exit(app.exec_())\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 main.py 同目录下，使用如下命令创建一个虚拟环境\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epython -m venv venv\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后激活虚拟环境：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e.\\venv\\Scripts\\activate\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e安装所需依赖包：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epip install pywin32 PyInstaller PyQT5\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果不是 Windows 系统，则无需安装 pywin32。\u003c/p\u003e\n\u003cp\u003e接下来运行程序\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epython main.py\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e效果如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/exe/WechatIMG1556.png\" width=\"500px\" height=\"500px\" /\u003e\n\u003c/center\u003e\n\u003ch3 id=\"转换为可执行程序\"\u003e转换为可执行程序\u003c/h3\u003e\n\u003cp\u003e在目标操作系统上，执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epyinstaller -F -w main.py\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ePyInstaller 部分参数的含义:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-F：表示生成单个可执行文件\u003c/li\u003e\n\u003cli\u003e-w：表示去掉控制台窗口，这在 GUI 界面时非常有用，如果是命令行程序的话，不需要使用这个选项\u003c/li\u003e\n\u003cli\u003e-i：表示可执行文件的图标\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e开始执行代码，运行完成之后，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/exe/WechatIMG1557.png\" width=\"500px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在 main.py 文件的目录下会生成一个 dist 文件夹， 里面就有生成的 EXE 文件\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/exe/WechatIMG1558.png\" width=\"500px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e双击这个 main.exe，运行效果如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/exe/WechatIMG1559.png\" width=\"500px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://zhuanlan.zhihu.com/p/52654565\"\u003ehttps://zhuanlan.zhihu.com/p/52654565\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://code.py40.com/pyqt5/28.html\"\u003ehttp://code.py40.com/pyqt5/28.html\u003c/a\u003e\u003c/p\u003e","date":1642550400,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1642550400,"objectID":"49462b29ae70072817b19dc0a0b98c57","publishdate":1642550400,"relpermalink":"/posts/programming/python/python-convert-to-exe/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下将 Python 脚本转换为各类型操作系统上的可执行文件的方法。\u003c/p\u003e","tags":["Python"],"title":"将 Python 脚本转换为可执行程序","url":"https://xdhuxc.github.io/posts/programming/python/python-convert-to-exe/","wordcount":801},{"categories":"posts","content":"\u003cp\u003e本篇文章记录了在 Mac 下增加进程最大文件描述符数量的方法。\u003c/p\u003e\n\u003ch3 id=\"背景\"\u003e背景\u003c/h3\u003e\n\u003cp\u003e开发了一个运行在 Mac 系统上的 agent，运行后向 metrics 系统上报指标时，日志中一直报 \u0026quot;too many open files\u0026quot; 错误，除去 agent 中使用的打点 SDK 本身没有使用批量上传的方式外，随着 agent 功能的增多，对文件描述符的占用也必然会增加。\u003c/p\u003e\n\u003cp\u003e然而，Mac 系统中默认的文件描述符是这样的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuan@wanghuans-MBP ~ % launchctl limit maxfiles\n\tmaxfiles    256            unlimited\nwanghuan@wanghuans-MBP ~ % ulimit -n\n256\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e默认情况下，一个进程能打开的最大文件描述符数量只有 256 个，这显然不能满足程序日益增长的功能需要。\u003c/p\u003e\n\u003cp\u003e于是，我们需要将其调大，这样就有两种选择：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e将系统的最大文件描述符调大；\u003c/li\u003e\n\u003cli\u003e将当前进程可使用的最大文件描述符调大；\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e下面我们分别来介绍这两种方法\u003c/p\u003e\n\u003ch3 id=\"修改系统最大文件描述符限制\"\u003e修改系统最大文件描述符限制\u003c/h3\u003e\n\u003cp\u003e修改系统最大文件描述符限制地操作步骤如下：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e在 \u003ccode\u003e/Library/LaunchDaemons\u003c/code\u003e 目录下创建 \u003ccode\u003elimit.maxfiles.plist\u003c/code\u003e 文件，增加如下内容：\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u003c/span\u003e  \n\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE plist PUBLIC \u0026#34;-//Apple//DTD PLIST 1.0//EN\u0026#34;  \n\u003c/span\u003e\u003cspan class=\"cp\"\u003e        \u0026#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd\u0026#34;\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplist\u003c/span\u003e \u003cspan class=\"na\"\u003eversion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;1.0\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eLabel\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003elimit.maxfiles\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eProgramArguments\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003elaunchctl\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003elimit\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003emaxfiles\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e64000\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e524288\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003earray\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eRunAtLoad\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eServiceIPC\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edict\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplist\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、修改文件的权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo chown root:wheel /Library/LaunchDaemons/limit.maxfiles.plist\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、加载新的配置文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo launchctl load -w /Library/LaunchDaemons/limit.maxfiles.plist\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e卸载时使用的命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo launchctl unload /Library/LaunchDaemons/limit.maxfiles.plist\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、检查设置的 limit 是否生效\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elaunchctl limit maxfiles\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这样做会带来一个严重的问题，所有进程的最大文件描述符数量都会同步增大，而操作系统使用 limit 的本来意义就是限制单一进程所能使用的最大文件描述符数量，以防止某些进程不断地创建子进程或者创建网络连接，把系统资源给占尽了，其他进程无法工作。\u003c/p\u003e\n\u003cp\u003e所以，此方法可以作为临时方法救急和测试，绝不要在生产环境中使用。\u003c/p\u003e\n\u003ch3 id=\"修改当前进程可使用的最大文件描述符数量\"\u003e修改当前进程可使用的最大文件描述符数量\u003c/h3\u003e\n\u003cp\u003e在程序启动的时候，使用 cgo 调用 strlimit 来设置当前进程的最大文件描述符数量，这样就不会影响系统的设置了，代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport (\n    \u0026#34;os\u0026#34;\n    \u0026#34;syscall\u0026#34;\n\n    log \u0026#34;github.com/sirupsen/logrus\u0026#34;\n)\n\nfunc main() {\n    var limit syscall.Rlimit\n    err := syscall.Getrlimit(syscall.RLIMIT_NOFILE, \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003elimit)\n    if err != nil {\n        log.Errorf(\u0026#34;get rlimit error: %s\u0026#34;, err)\n        os.Exit(1)\n    }\n\n\tlog.Infof(\u0026#34;the rlimit current: %d, max: %d\u0026#34;, limit.Cur, limit.Max)\n\told := limit.Cur\n\n\tlimit.Cur = 1024\n\terr = syscall.Setrlimit(syscall.RLIMIT_NOFILE, \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003elimit)\n\tif err != nil {\n\t\tlog.Errorf(\u0026#34;set rlimit error: %s\u0026#34;, err)\n\t\tos.Exit(1)\n\t}\n\tlog.Infof(\u0026#34;change rlimit from %d to %d successfully\u0026#34;, old, limit.Cur)\n\n\terr = syscall.Getrlimit(syscall.RLIMIT_NOFILE, \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003elimit)\n\tif err != nil {\n\t\tlog.Errorf(\u0026#34;get rlimit error: %s\u0026#34;, err)\n\t\tos.Exit(1)\n\t}\n\tlog.Infof(\u0026#34;after change, the rlimit cur: %d, max: %d\u0026#34;, limit.Cur, limit.Max)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行这段代码，结果如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eINFO[0000] the rlimit current: 10240, max: 9223372036854775807 \nINFO[0000] change rlimit from 10240 to 1024 successfully \nINFO[0000] after change, the rlimit cur: 1024, max: 9223372036854775807\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到，经过修改后，程序访问到的 limit 值已经被修改了，可以实现既限制当前进程所能打开的最大文件描述符数量，又能保持系统原有的配置。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://superuser.com/questions/302754/increase-the-maximum-number-of-open-file-descriptors-in-snow-leopard\"\u003ehttps://superuser.com/questions/302754/increase-the-maximum-number-of-open-file-descriptors-in-snow-leopard\u003c/a\u003e\u003c/p\u003e","date":1638921600,"description":"","fuzzywordcount":1000,"kind":"page","lang":"zh","lastmod":1638921600,"objectID":"495ba883b3755cf3550d6d102f2107a4","publishdate":1638921600,"relpermalink":"/posts/common/mac/mac-increase-maximum-fd/","section":"posts","summary":"\u003cp\u003e本篇文章记录了在 Mac 下增加进程最大文件描述符数量的方法。\u003c/p\u003e","tags":["Mac"],"title":"Mac 下增加最大文件描述符数量","url":"https://xdhuxc.github.io/posts/common/mac/mac-increase-maximum-fd/","wordcount":900},{"categories":"posts","content":"\u003cp\u003e本篇文章记录了在 Mac 下使用 brew 的方法。\u003c/p\u003e\n\u003ch3 id=\"安装-brew\"\u003e安装 brew\u003c/h3\u003e\n\u003cp\u003e使用如下命令安装 brew：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/bin/bash -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"brew-常用命令\"\u003ebrew 常用命令\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e安装软件\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebrew install gcc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e默认情况下，每次安装软件时，brew 会更新 homebrew 管理的所有软件包并清理缓存，这可能会把一些软件不必要地升级到高版本，带来一些问题。\u003c/p\u003e\n\u003cp\u003e如果需要只安装软件而不更新 homebrew，可以导入如下环境变量到系统中：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport HOMEBREW_NO_AUTO_UPDATE=true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"2\"\u003e\n\u003cli\u003e卸载软件\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebrew uninstall gcc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"3\"\u003e\n\u003cli\u003e搜索软件\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebrew search gcc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e会显示搜索的软件的各种版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e➜  ~ brew search gcc\n==\u0026gt; Formulae\ngcc ✔             gcc@5             gcc@8             libgccjit         ghc ✔             ncc\ngcc@10            gcc@6             gcc@9             x86_64-elf-gcc    scc\ngcc@4.9           gcc@7             i686-elf-gcc      grc               tcc\n\n==\u0026gt; Casks\ngcc-arm-embedded\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"4\"\u003e\n\u003cli\u003e更新软件\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebrew upgrade gcc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"5\"\u003e\n\u003cli\u003e查看安装列表\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebrew list\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"6\"\u003e\n\u003cli\u003e更新 homebrew\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebrew update\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"7\"\u003e\n\u003cli\u003e安装指定版本的软件\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebrew install gcc@7\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/dff8c837b7dd\"\u003ehttps://www.jianshu.com/p/dff8c837b7dd\u003c/a\u003e\u003c/p\u003e","date":1636243200,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1636243200,"objectID":"5e4e2ff43c89c2a25350e8299bf03081","publishdate":1636243200,"relpermalink":"/posts/common/mac/mac-brew-install-and-usage/","section":"posts","summary":"\u003cp\u003e本篇文章记录了在 Mac 下使用 brew 的方法。\u003c/p\u003e","tags":["Mac"],"title":"brew 的使用","url":"https://xdhuxc.github.io/posts/common/mac/mac-brew-install-and-usage/","wordcount":261},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下使用 Python 操作 excel 表格的方法。\u003c/p\u003e\n\u003ch3 id=\"代码示例\"\u003e代码示例\u003c/h3\u003e\n\u003cp\u003e以下是使用 python 操作 excel 表格的示例代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e89\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: utf-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# author: wanghuan\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# date: 9/4/21\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# description:\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport os\nimport xlrd\nimport copy\nimport xlwt\n\ndef convert(value):\n    if not value:\n        return 0.00\n\n    if isinstance(value, float):\n        return value\n    else:\n        return float(value)\n\ndef write(table):\n    book = xlwt.Workbook()\n    sheet = book.add_sheet(\u0026#39;汇总表\u0026#39;)\n    # 写入表头\n    headers = [\u0026#39;日期\u0026#39;, \u0026#39;销售金额\u0026#39;, \u0026#39;回款金额\u0026#39;, \u0026#39;库存金额（含税）\u0026#39;,\t\u0026#39;应收账款余额\u0026#39;, \u0026#39;应付账款\u0026#39;,\t\u0026#39;预付账款余额\u0026#39;, \u0026#39;占用资金总额\u0026#39;]\n    for i in range(len(headers)):\n        sheet.write(0, i, headers[i])\n\n    for i in range(len(table)):\n        for j in range(len(table[i])):\n            sheet.write(i+1, j, table[i][j])\n\n    book.save(\u0026#39;result.xlsx\u0026#39;)\n\n\n\nif \u003cspan class=\"gs\"\u003e__name__\u003c/span\u003e == \u0026#39;__main__\u0026#39;:\n    table = list()\n    rows = [\u0026#39;\u0026#39;] + [0.00] * 7\n    for i in range(31):\n        table.append(rows)\n    count = 0\n    current_date = \u0026#39;\u0026#39;\n    for item in os.listdir():\n        if item.endswith(\u0026#39;.xlsx\u0026#39;) or item.endswith(\u0026#39;.xls\u0026#39;):\n            print(\u0026#39;current xlsx: \u0026#39;, item)\n            count = count + 1\n            # 打开 excel 表格\n            data = xlrd.open_workbook(item)\n            # 根据 sheet 索引获取 sheet\n            sheet = data.sheet_by_index(0)\n            for i in range(sheet.nrows):\n                if i == 0 or i == 1:\n                    continue\n                # print(sheet.row_values(i))\n                if sheet.cell(i, 0).ctype == 3: # 日期类型\n                    print(\u0026#39;current rows: \u0026#39;, sheet.row_values(i))\n                    # 处理第一列的日期\n                    cdate = xlrd.xldate.xldate_as_datetime(sheet.cell(i, 0).value, 0)\n                    current_date = cdate.strftime(\u0026#34;%Y/%m/%d\u0026#34;)\n                    # rows in table\n                    for idx in range(len(table)):\n                        if i-2 == idx:\n                            rit = copy.deepcopy(table[idx])\n                            if count == 1: # 直接填充数据\n                                rit[0] = current_date\n                                rit[1] = convert(sheet.cell(i, 1).value)\n                                rit[2] = convert(sheet.cell(i, 2).value)\n                                rit[3] = convert(sheet.cell(i, 3).value)\n                                rit[4] = convert(sheet.cell(i, 4).value)\n                                rit[5] = convert(sheet.cell(i, 5).value)\n                                rit[6] = convert(sheet.cell(i, 6).value)\n                                rit[7] = convert(sheet.cell(i, 7).value)\n                            else:\n                                if current_date == rit[0]:\n                                    rit[1] = rit[1] + convert(sheet.cell(i, 1).value)\n                                    rit[2] = rit[2] + convert(sheet.cell(i, 2).value)\n                                    rit[3] = rit[3] + convert(sheet.cell(i, 3).value)\n                                    rit[4] = rit[4] + convert(sheet.cell(i, 4).value)\n                                    rit[5] = rit[5] + convert(sheet.cell(i, 5).value)\n                                    rit[6] = rit[6] + convert(sheet.cell(i, 6).value)\n                                    rit[7] = rit[7] + convert(sheet.cell(i, 7).value)\n                            print(\u0026#39;current rows in table index {} -\u0026gt; {}\u0026#39;, idx, rit)\n                            table[idx] = rit\n                else:\n                    print(\u0026#39;the current cell type: {}, break\u0026#39;.format(sheet.cell(i, 0)))\n                    break\n    print(\u0026#39;the final data: {}\u0026#39;.format(table))\n    write(table)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1631923200,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1631923200,"objectID":"2e9de7b4dd73087aa625e2705dae9e87","publishdate":1631923200,"relpermalink":"/posts/programming/python/python-operate-excel/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下使用 Python 操作 excel 表格的方法。\u003c/p\u003e","tags":["Python","excel"],"title":"使用 Python 操作 excel 文档","url":"https://xdhuxc.github.io/posts/programming/python/python-operate-excel/","wordcount":598},{"categories":"posts","content":"\u003cp\u003egolang 的基准测试在有些时候还是很重要的，在需要考虑代码性能的地方，我们需要用基准测试的方法来测试我们的代码。\u003c/p\u003e\n\u003ch3 id=\"基准测试\"\u003e基准测试\u003c/h3\u003e\n\u003cp\u003egolang 中基准测试需要遵循的原则：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e基准测试的代码文件必须以 _test.go 结尾\u003c/li\u003e\n\u003cli\u003e基准测试的函数必须以 Benchmark 开头，必须是可导出的\u003c/li\u003e\n\u003cli\u003e基准测试函数必须接受一个指向 Benchmark 类型的指针作为唯一参数\u003c/li\u003e\n\u003cli\u003e基准测试函数不能有返回值\u003c/li\u003e\n\u003cli\u003eb.ResetTimer 是重置计时器，这样可以避免 for 循环之前的初始化代码的干扰\u003c/li\u003e\n\u003cli\u003e最后的 for 循环很重要，被测试的代码要放到循环里\u003c/li\u003e\n\u003cli\u003eb.N 是基准测试框架提供的，表示循环的次数，因为需要反复调用测试的代码，才可以评估性能\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e使用如下命令运行基准测试：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuan@wanghuans-MacBook-Pro benchmark % go test -bench=. -run=none\ngoos: darwin\ngoarch: amd64\npkg: github.com/xdhuxc/go-study-notes/tools/test/benchmark\nBenchmarkSprintf-4      11860180                93.4 ns/op\nPASS\nok      github.com/xdhuxc/go-study-notes/tools/test/benchmark   1.342s\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e运行基准测试也是使用 \u003ccode\u003ego test\u003c/code\u003e 命令，但是需要加上 \u003ccode\u003e-bench=\u003c/code\u003e 参数，接收一个表达式以匹配基准测试的函数。\u003ccode\u003e.\u003c/code\u003e 表示运行所有的基准测试\u003c/p\u003e\n\u003cp\u003e默认情况下，\u003ccode\u003ego test\u003c/code\u003e 会运行单元测试，为了防止单元测试的输出影响我们查看基准测试的结果，可以使用 \u003ccode\u003e-run=\u003c/code\u003e 匹配一个从来没有的单元测试方法，过滤掉单元测试的输出。\n这里使用 \u003ccode\u003enone\u003c/code\u003e，因为我们无需创建这个名字的单元测试方法。\u003c/p\u003e\n\u003cp\u003e函数名称后的 \u003ccode\u003e-4\u003c/code\u003e 表示运行时对应的 \u003ccode\u003eGOMAXPROCS\u003c/code\u003e 的值；\u003ccode\u003e11860180\u003c/code\u003e 表示运行 for 循环的测试，也就是调用被测试代码的次数；\u003ccode\u003e93.4 ns/op\u003c/code\u003e 表示每次需要耗时 93.4 纳秒。\u003c/p\u003e\n\u003cp\u003e如果想让测试运行的时间更长，可以通过 -benchtime 指定，比如 3 秒。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuan@wanghuans-MacBook-Pro benchmark % go test -bench=. -benchtime=3s -run=none\ngoos: darwin\ngoarch: amd64\npkg: github.com/xdhuxc/go-study-notes/tools/test/benchmark\nBenchmarkSprintf-4      36750073                92.0 ns/op\nPASS\nok      github.com/xdhuxc/go-study-notes/tools/test/benchmark   4.559s\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到，在加长测试时间后，每次执行代码耗费的时间并没有明显的变化。\u003c/p\u003e\n\u003ch3 id=\"比较\"\u003e比较\u003c/h3\u003e\n\u003cp\u003e比较 fmt.Sprintf()，strconv.FormatInt()，strconv.Itoa() 的性能\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuan@wanghuans-MacBook-Pro benchmark % go test -bench=. -run=none              \ngoos: darwin\ngoarch: amd64\npkg: github.com/xdhuxc/go-study-notes/tools/test/benchmark\nBenchmarkSprintf-4      12029704                92.9 ns/op\nBenchmarkFormat-4       270879309                4.44 ns/op\nBenchmarkItoa-4         252876846                4.71 ns/op\nPASS\nok      github.com/xdhuxc/go-study-notes/tools/test/benchmark   4.632s\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e从结果可以看出，strconv.FormatInt() 函数是最快的，其次是 strconv.Itoa()，最慢的是 fmt.Sprintf()。\u003c/p\u003e\n\u003cp\u003e但是差距居然达到了 20 倍左右，那么这个差距为何如此之大呢？我们再通过 -benchmem 找到原因，-benchmem 可以提供每次操作分配内存的次数，以及每次操作分配的字节数。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuan@wanghuans-MacBook-Pro benchmark % go test -bench=. -benchmem -run=none\ngoos: darwin\ngoarch: amd64\npkg: github.com/xdhuxc/go-study-notes/tools/test/benchmark\nBenchmarkSprintf-4      12470200                91.9 ns/op            16 B/op          2 allocs/op\nBenchmarkFormat-4       264188895                4.48 ns/op            0 B/op          0 allocs/op\nBenchmarkItoa-4         249210574                4.84 ns/op            0 B/op          0 allocs/op\nPASS\nok      github.com/xdhuxc/go-study-notes/tools/test/benchmark   4.674s\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e从结果可以看出，性能高的 strconv.FormatInt() 和 strconv.Itoa()，每次操作都不进行内存分配，而 fmt.Sprintf() 要分配两次；\n性能高的 strconv.FormatInt() 和 strconv.Itoa()，每次操作不分配内存，而慢的 fmt.Sprintf() 每次分配内存 16 个字节。\n由此，我们就知道 fmt.Sprintf() 为什么这么慢了，每次操作都进行了内存分配和内存占用太高。\u003c/p\u003e\n\u003ch3 id=\"其他\"\u003e其他\u003c/h3\u003e\n\u003cp\u003e在开发过程中，我们经常会遇到遍历数组的情况，对于最基本的遍历，在终止条件的位置上怎么写？很多时候，我们还是需要注意下的。\u003c/p\u003e\n\u003cp\u003e对于如下所示的两种基本遍历：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efor i := 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003elen\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ex\u003c/span\u003e\u003cspan class=\"err\"\u003e);\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003e_ \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003ei\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e和\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elen := len(x)\nfor i := 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003elen\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003e_ \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003ei\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在运行上，有区别吗？\u003c/p\u003e\n\u003cp\u003e为了验证这个问题，编写如下基准测试：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage benchmark\n\nimport (\n\t\u0026#34;math/rand\u0026#34;\n\t\u0026#34;testing\u0026#34;\n)\n\nconst a = 10^10\nvar x [a]int\nfunc init() {\n\tfor i := 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003elen\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ex\u003c/span\u003e\u003cspan class=\"err\"\u003e);\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003ex\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e]\u003c/span\u003e \u003cspan class=\"err\"\u003e=\u003c/span\u003e \u003cspan class=\"na\"\u003erand\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eIntn\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003efunc\u003c/span\u003e \u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"err\"\u003e()\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003efor\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e0;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003elen\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ex\u003c/span\u003e\u003cspan class=\"err\"\u003e);\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003e_ \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003ei\u003c/span\u003e\n\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003efunc\u003c/span\u003e \u003cspan class=\"na\"\u003elengthOne\u003c/span\u003e\u003cspan class=\"err\"\u003e()\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003elength\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003elen(x)\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003efor\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e0;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003e_ \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003ei\u003c/span\u003e\n\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003efunc\u003c/span\u003e \u003cspan class=\"na\"\u003eBenchmarkLen\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003eb\u003c/span\u003e \u003cspan class=\"err\"\u003e*\u003c/span\u003e\u003cspan class=\"na\"\u003etesting\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eB\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eResetTimer\u003c/span\u003e\u003cspan class=\"err\"\u003e()\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003efor\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e0;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eN\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003elength\u003c/span\u003e\u003cspan class=\"err\"\u003e()\u003c/span\u003e\n\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003efunc\u003c/span\u003e \u003cspan class=\"na\"\u003eBenchmarkLenOne\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003eb\u003c/span\u003e \u003cspan class=\"err\"\u003e*\u003c/span\u003e\u003cspan class=\"na\"\u003etesting\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eB\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eResetTimer\u003c/span\u003e\u003cspan class=\"err\"\u003e()\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003efor\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e0;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eb\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eN\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003elengthOne\u003c/span\u003e\u003cspan class=\"err\"\u003e()\u003c/span\u003e\n\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下命令运行基准测试：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego test -bench=. -benchmem -run=none length_test.go\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e结果如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egoos: darwin\ngoarch: amd64\nBenchmarkLen-4          835416472                1.41 ns/op            0 B/op          0 allocs/op\nBenchmarkLenOne-4       853285748                1.40 ns/op            0 B/op          0 allocs/op\nPASS\nok      command-line-arguments  2.787s\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e多次运行，结果基本类似。\u003c/p\u003e\n\u003cp\u003e所以，看起来，这两种写法不会有性能方面的差别。\u003c/p\u003e\n\u003cp\u003e实际上，我们知道 golang 的数组和切片，在底层存储时，都会带有长度和容量字段，想必 len() 直接返回了数组或切片的长度。\u003c/p\u003e\n\u003cp\u003e在 \u003ca href=\"https://golang.org/ref/spec#Length_and_capacity\"\u003eThe Go Programming Language Specification\u003c/a\u003e 中，关于 len() 函数有如下说明：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eThe expression len(s) is constant if s is a string constant. The expressions len(s) and cap(s) are constants if the type of s is an array or pointer to an array and the expression s does not contain channel receives or (non-constant) function calls; in this case s is not evaluated. Otherwise, invocations of len and cap are not constant and s is evaluated.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e翻译过来就是：\n如果 s 是字符串常量，那么表达式 len(s) 就是常数。如果 s 的类型是数组或指向数组的指针，并且表达式 s 不包含 channel 接收或（非常量的）函数调用，那么表达式 len(s) 和 cap(s) 是常数。\n在这种情况下，不会去计算 s。否则，len 和 cap 的调用不是常数，会对 s 进行计算。\u003c/p\u003e","date":1615161600,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1615161600,"objectID":"32614dfbd87aef07ba52597580609b17","publishdate":1615161600,"relpermalink":"/posts/programming/golang/golang-benchmark/","section":"posts","summary":"\u003cp\u003egolang 的基准测试在有些时候还是很重要的，在需要考虑代码性能的地方，我们需要用基准测试的方法来测试我们的代码。\u003c/p\u003e","tags":["Golang","Benchmark"],"title":"Golang 基准测试的使用方法","url":"https://xdhuxc.github.io/posts/programming/golang/golang-benchmark/","wordcount":1649},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 kubernetes ConfigMap 的一些用法。\u003c/p\u003e\n\u003ch3 id=\"configmap-简介\"\u003eConfigMap 简介\u003c/h3\u003e\n\u003cp\u003e在 Kubernetes 中，应用程序都被打成镜像，会有很多需要自定义的参数和配置，例如，资源的消耗、日志的级别和位置等，这些配置可能会有很多。Kubernetes 提供了 ConfigMap 来实现向容器中提供配置文件或环境变量来实现配置的注入，从而实现了应用配置和镜像的分离，使容器应用不依赖于配置。\u003c/p\u003e\n\u003cp\u003e利用 ConfigMap 可以解耦部署与配置的关系，对于同一个应用部署文件，可以使用 valueFrom 字段引用一个在测试环境和生产环境都有的 ConfigMap，这样就可以降低环境管理和部署的复杂度。\u003c/p\u003e\n\u003cp\u003eConfigMap 是 kubernetes 中的一种资源，主要用于保存配置文件等信息。其声明格式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapiVersion: v1\nkind: ConfigMap\nmetadata:\n  labels:\n    app: kubernetes-transform\n  name: kubernetes-transform-cm\n  namespace: xdhuxc\ndata:\n  config.prod.yaml: |-\n    addr: 8080\n    env: \u0026#34;prod\u0026#34;\n    app: \u0026#34;kubernetes-transform\u0026#34;\n    debug: false\n    db:\n      host: \u0026#34;127.0.0.1:3306\u0026#34;\n      user: \u0026#34;root\u0026#34;\n      password: \u0026#34;IAmRoot\u0026#34;\n      name: \u0026#34;xdhuxc\u0026#34;\n      log: true\n      maxIdleConns: 10\n      maxOpenConns: 100\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e保存为 kubernetes-transform-cm.yaml\u003c/p\u003e\n\u003cp\u003e使用如下命令创建 ConfigMap：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl create -f kubernetes-transform-cm.yaml\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"configmap-引用\"\u003eConfigMap 引用\u003c/h3\u003e\n\u003cp\u003e可以通过三种方式来引用 ConfigMap：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e环境变量方式\u003c/li\u003e\n\u003cli\u003e命令行参数\u003c/li\u003e\n\u003cli\u003e配置文件方式\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"环境变量方式\"\u003e环境变量方式\u003c/h4\u003e\n\u003cp\u003e通过如下方式从 ConfigMap 中引用环境变量：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nspec:\n  containers:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e image: nginx\n    name: nginx\n    env:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: app\n      valueFrom:\n        configMapKeyRef:\n          name: app\n          key: app\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"命令行参数\"\u003e命令行参数\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nspec:\n  containers:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: nginx\n    image: nginx\n    command: [\u0026#34;/bin/sh\u0026#34;, \u0026#34;-c\u0026#34;, \u0026#34;echo $(PROJECT) ${ENV}\u0026#34;]\n    env:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: PROJECT\n      valueFrom:\n        configMapKeyRef:\n          name: kubernetes-transform-cm\n          key: project\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: ENV\n      valueFrom: \n        configMapKeyRef:\n          name: kubernetes-transform-cm\n          key: env\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上配置会将 ConfigMap kubernetes-transform-cm 中的 project，env 的值分别赋给环境变量 PROJECT，ENV\u003c/p\u003e\n\u003ch4 id=\"配置文件方式\"\u003e配置文件方式\u003c/h4\u003e\n\u003cp\u003e通过如下方式将单个文件保存到 Pod 中指定目录下，且不影响该目录下其他文件和目录，注意 subPath 的使用。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapiVersion: v1\nkind: Pod\nspec:\n  containers:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: java-build-container\n    image: xdhuxc.com/java-maven-build:3.6.4\n    imagePullPolicy: Always\n    volumeMounts:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e mountPath: /usr/bin/docker\n      name: docker\n      readOnly: true\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e mountPath: /var/run/docker.sock\n      name: docker-sock\n      readOnly: true\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e mountPath: /root/.password/\n      name: docker-login\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e mountPath: /root/.ssh/\n      name: jenkins-ssh-key\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e mountPath: /root/.m2/\n      name: java-package-cache\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e mountPath: /root/.m2/settings.xml\n      name: sonarqube-maven-settings\n      subPath: settings.xml\n    tty: true\n  imagePullSecrets:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: default-secret\n  volumes:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: docker\n    hostPath:\n      path: /usr/bin/docker\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: docker-sock\n    hostPath:\n      path: /var/run/docker.sock\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: docker-login\n    configMap:\n      name: docker-login\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: jenkins-ssh-key\n    secret:\n      secretName: jenkins-ssh-key\n      defaultMode: 384\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: java-package-cache\n    persistentVolumeClaim:\n      claimName: jenkins-package-cache\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube-maven-settings\n    configMap:\n      name: sonarqube-maven-cm\n      items:\n      \u003cspan class=\"k\"\u003e-\u003c/span\u003e key: settings.xml\n        path: settings.xml\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e使用 ConfigMap 时，需要注意如下事项：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eConfigMap 必须在 Pod 之前创建，如果引用了一个不存在的 ConfigMap，则创建 Pod 时会报错\u003c/li\u003e\n\u003cli\u003eConfigMap 属于某个特定的命名空间，只有处于相同命名空间中的 Pod 才可以引用它\u003c/li\u003e\n\u003cli\u003e如果以挂载卷的形式挂载到容器内部，只能挂载到某个目录下，该目录下原有的文件会被覆盖\u003c/li\u003e\n\u003cli\u003e静态 Pod 不能使用 ConfigMap\u003c/li\u003e\n\u003cli\u003eConfigMap 中的配额管理尚未实现\u003c/li\u003e\n\u003cli\u003e更新 ConfigMap 后，如果是以目录方式挂载的，会自动将挂载的存储卷更新；如果是以文件形式挂载的，则不会自动更新，需要重启 Pod，但是注意可能会有时延\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e","date":1590710400,"description":"","fuzzywordcount":1000,"kind":"page","lang":"zh","lastmod":1590710400,"objectID":"127772ee616aa019bef064ec4de88d73","publishdate":1590710400,"relpermalink":"/posts/kubernetes/kubernetes-configmap/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 kubernetes ConfigMap 的一些用法。\u003c/p\u003e","tags":["Kubernetes"],"title":"Kubernetes ConfigMap 使用","url":"https://xdhuxc.github.io/posts/kubernetes/kubernetes-configmap/","wordcount":977},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍 SonarQube 的部署和常用编程语言的应用，另外给出在 Kubernetes 中使用的方法。\u003c/p\u003e\n\u003ch3 id=\"sonarqube\"\u003eSonarQube\u003c/h3\u003e\n\u003cp\u003eSonarQube 是一个用于代码质量管理的开源平台，用于管理源代码的质量。同时 SonarQube 还对大量的持续集成工具提供了接口支持，可以很方便地在持续集成中使用 SonarQube。此外 SonarQube 的插件还可以对 Java 以外的其他编程语言提供支持，对国际化以及报告文档化也有良好的支持。\u003c/p\u003e\n\u003cp\u003e特性：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e多语言的平台： 支持超过20种编程语言，包括Java、Python、C#、C/C++、JavaScript等常用语言\u003c/li\u003e\n\u003cli\u003e自定义规则： 用户可根据不同项目自定义Quality Profile以及Quality Gates\u003c/li\u003e\n\u003cli\u003e丰富的插件： SonarQube 拥有丰富的插件，从而拥有强大的可扩展性\u003c/li\u003e\n\u003cli\u003e持续集成： 通过对某项目的持续扫描，可以对该项目的代码质量做长期的把控，并且预防新增代码中的不严谨和冗余\u003c/li\u003e\n\u003cli\u003e质量门： 在扫描代码后可以通过对“质量门”的比对判定此次“构建”的结果是否通过，质量门可以由用户定义，由多维度判定是否通过\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"安装-postgresql\"\u003e安装 PostgreSQL\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --name postgresql \\\n    --network=host \\\n    -p 5423:5423 \\\n    -e POSTGRES_PASSWORD=postgrs@2020 \\\n    -e PGDATA=/var/lib/postgresql/data/pgdata \\\n    -v /root/postgresql/data:/var/lib/postgresql/data \\\n    postgres\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建 sonarqube 使用的数据库和用户\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCREATE DATABASE sonarqube;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e请注意，生产环境不要使用容器来运行 PostgreSQL，最好是创建 sonarqube 用户并赋予其相应权限，可以参考：https://docs.sonarqube.org/latest/setup/install-server/\u003c/p\u003e\n\u003ch3 id=\"启动-sonarqube-容器\"\u003e启动 SonarQube 容器\u003c/h3\u003e\n\u003cp\u003e1、创建存储卷\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker volume create --name sonarqube_data\ndocker volume create --name sonarqube_extensions\ndocker volume create --name sonarqube_logs\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、使用 PostgreSQL 启动 SonarQube 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d --name sonarqube \\\n    --network=host \\\n    -p 9000:9000 \\\n    -e SONAR_JDBC_URL=jdbc:postgresql://10.20.0.18/sonarqube \\\n    -e SONAR_JDBC_USERNAME=postgres \\\n    -e SONAR_JDBC_PASSWORD=postgrs@2020 \\\n    -v sonarqube_data:/opt/sonarqube/data \\\n    -v sonarqube_extensions:/opt/sonarqube/extensions \\\n    -v sonarqube_logs:/opt/sonarqube/logs \\\n    sonarqube\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eSonarQube 默认用户名/密码为：admin/admin\u003c/p\u003e\n\u003cp\u003e创建一个外部使用的 Token：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eToken 的生成方式：User \u0026gt; My Account \u0026gt; Security\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003escmp-sonarqube: 33f42c54b432a9124cb966f8b6dd06daeda6f12b\u003c/p\u003e\n\u003ch3 id=\"kubernetes-部署\"\u003eKubernetes 部署\u003c/h3\u003e\n\u003cp\u003e部署到 kubernetes 中的 yaml 文件为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e86\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekind: Deployment\napiVersion: apps/v1\nmetadata:\n  name: sonarqube\n  namespace: sgt\n  labels:\n    app: sonarqube\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sonarqube\n  template:\n    metadata:\n      labels:\n        app: sonarqube\n    spec:\n      volumes:\n        \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube-data\n          persistentVolumeClaim:\n            claimName: sonarqube-data\n        \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube-extensions\n          persistentVolumeClaim:\n            claimName: sonarqube-extensions\n        \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube-logs\n          persistentVolumeClaim:\n            claimName: sonarqube-logs\n      containers:\n        \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube\n          image: \u0026#34;sonarqube:latest\u0026#34;\n          env:\n            \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: SONAR_JDBC_URL\n              value: \u0026#34;jdbc:postgresql://10.20.0.18/sonarqube\u0026#34;\n            \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: SONAR_JDBC_USERNAME\n              value: \u0026#34;postgres\u0026#34;\n            \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: SONAR_JDBC_PASSWORD\n              value: \u0026#34;postgrs@2020\u0026#34;\n          resources:\n            limits:\n              cpu: \u0026#34;1\u0026#34;\n              memory: \u0026#34;2Gi\u0026#34;\n            requests:\n              cpu: \u0026#34;1\u0026#34;\n              memory: \u0026#34;2Gi\u0026#34;\n          ports:\n            \u003cspan class=\"k\"\u003e-\u003c/span\u003e containerPort: 9000\n              name: sonarqube\n          volumeMounts:\n            \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube-data\n              mountPath: /opt/sonarqube/data\n              subPath: data\n            \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube-extensions\n              mountPath: /opt/sonarqube/extensions\n              subPath: extensions\n            \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube-logs\n              mountPath: /opt/sonarqube/logs\n              subPath: logs\n          imagePullPolicy: IfNotPresent\n          livenessProbe:\n            httpGet:\n              path: /sessions/new\n              port: 9000\n            initialDelaySeconds: 600\n      imagePullSecrets:\n        \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: default-secret\n      securityContext:\n        fsGroup: 999\n        runAsUser: 999\n      terminationGracePeriodSeconds: 3600\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app: sonarqube\n  name: sonarqube\n  namespace: sgt\nspec:\n  type: ClusterIP\n  ports:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: sonarqube-port\n      port: 80\n      targetPort: 9000\n  selector:\n    app: sonarqube\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，内存至少2Gi，initialDelaySeconds 设置为 300 或 600 或更大点，否则程序尚未启动，就被 kubernetes 健康检查杀死\u003c/p\u003e\n\u003cp\u003e必须使用三个 PVC 来分别挂载 data，extensions，logs目录，如果只使用一个 PVC，使用 subPath 来区别，ES 会报各种各样的错误。\u003c/p\u003e\n\u003cp\u003e还可以增加环境变量：SONARQUBE_WEB_JVM_OPTS，指定额外的 JVM 参数。虽然官网说 SONARQUBE_JDBC_USERNAME, SONARQUBE_JDBC_PASSWORD, and SONARQUBE_JDBC_URL 会在未来弃用，但在 SONAR_VERSION=8.2.0.32929 时，docker 容器启动时，使用的环境变量名称分别为：SONAR_JDBC_URL，SONAR_JDBC_USERNAME，SONAR_JDBC_PASSWORD；而使用 kubernetes 时，则需要使用带 QUBE 的环境变量名称，否则不会使用我们提供的 PostgreSQL，而是使用默认的 H2 数据库。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e2020-04-27T13:55:28.492308527Z Caused by: java.nio.file.AccessDeniedException: /opt/sonarqube/data/es6\n2020-04-27T13:55:28.49231103Z   at sun.nio.fs.UnixException.translateToIOException(Unknown Source) ~[?:?]\n2020-04-27T13:55:28.49231393Z   at sun.nio.fs.UnixException.rethrowAsIOException(Unknown Source) ~[?:?]\n2020-04-27T13:55:28.492316385Z  at sun.nio.fs.UnixException.rethrowAsIOException(Unknown Source) ~[?:?]\n2020-04-27T13:55:28.492318764Z  at sun.nio.fs.UnixFileSystemProvider.createDirectory(Unknown Source) ~[?:?]\n2020-04-27T13:55:28.492321152Z  at java.nio.file.Files.createDirectory(Unknown Source) ~[?:?]\n2020-04-27T13:55:28.492323672Z  at java.nio.file.Files.createAndCheckIsDirectory(Unknown Source) ~[?:?]\n2020-04-27T13:55:28.492326051Z  at java.nio.file.Files.createDirectories(Unknown Source) ~[?:?]\n2020-04-27T13:55:28.492328386Z  at org.elasticsearch.bootstrap.Security.ensureDirectoryExists(Security.java:413) ~[elasticsearch-6.8.0.jar:6.8.0]\n2020-04-27T13:55:28.492330853Z  at org.elasticsearch.bootstrap.FilePermissionUtils.addDirectoryPath(FilePermissionUtils.java:68) ~[elasticsearch-6.8.0.jar:6.8.0]\n2020-04-27T13:55:28.492333438Z  at org.elasticsearch.bootstrap.Security.addFilePermissions(Security.java:299) ~[elasticsearch-6.8.0.jar:6.8.0]\n2020-04-27T13:55:28.492339522Z  at org.elasticsearch.bootstrap.Security.createPermissions(Security.java:254) ~[elasticsearch-6.8.0.jar:6.8.0]\n2020-04-27T13:55:28.492342118Z  at org.elasticsearch.bootstrap.Security.configure(Security.java:123) ~[elasticsearch-6.8.0.jar:6.8.0]\n2020-04-27T13:55:28.49234464Z   at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:207) ~[elasticsearch-6.8.0.jar:6.8.0]\n2020-04-27T13:55:28.492347213Z  at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:333) ~[elasticsearch-6.8.0.jar:6.8.0]\n2020-04-27T13:55:28.492349763Z  at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:159) ~[elasticsearch-6.8.0.jar:6.8.0]\n2020-04-27T13:55:28.492352443Z  ... 6 more\n2020-04-27T13:55:28.614501888Z 2020.04.27 13:55:28 WARN  app[][o.s.a.p.AbstractManagedProcess] Process exited with exit value [es]: 1\n2020-04-27T13:55:28.614954443Z 2020.04.27 13:55:28 INFO  app[][o.s.a.SchedulerImpl] Process[es] is stopped\n2020-04-27T13:55:28.615619259Z 2020.04.27 13:55:28 INFO  app[][o.s.a.SchedulerImpl] SonarQube is stopped\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：在 sonarqube pod 中加入如下内容：（注意是 Pod 级别的）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esecurityContext:\n  fsGroup: 999\n  runAsUser: 999\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eES 不能以 root 用户启动，sonarqube 用户在容器内的 uid 和 gid 是：999:999\u003c/p\u003e\n\u003cp\u003e如果 ES 索引报错，可以删除 /opt/sonarqube/data 目录下 的 es6 目录，然后重启 SonarQube\u003c/p\u003e\n\u003cp\u003e参考资料：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/qq_40460909/article/details/102797137\"\u003ehttps://blog.csdn.net/qq_40460909/article/details/102797137\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gitlab.com/afireinside/kubernetes-sonarqube\"\u003ehttps://gitlab.com/afireinside/kubernetes-sonarqube\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e注意，SonarQube 官方文档一直强调不能在多个 SonarQube 实例上应用相同的存储卷\u003c/p\u003e\n\u003ch3 id=\"sonarqube-的使用\"\u003eSonarqube 的使用\u003c/h3\u003e\n\u003ch4 id=\"java-maven-项目\"\u003eJava Maven 项目\u003c/h4\u003e\n\u003cp\u003e1、在 ~/.m2/ 目录下创建 settings.xml 文件，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003esettings\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003epluginGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003epluginGroup\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.sonarsource.scanner.maven\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003epluginGroup\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003epluginGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eprofiles\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003esonar\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eactivation\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eactiveByDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etrue\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eactiveByDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eactivation\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"c\"\u003e\u0026lt;!-- Optional URL to server. Default value is http://localhost:9000 --\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003esonar.host.url\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ehttp://10.20.13.120:9000\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003esonar.host.url\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eprofiles\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003esettings\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、运行命令进行代码检查\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emaven clean install\nmaven sonar:sonar\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e结果报告：http://10.20.13.120:9000/dashboard?id=com.scmp:scmp-notify（组件 Key）\u003c/p\u003e\n\u003cp\u003ehttp://10.20.13.120:9000/api/ce/task?id=AXGmIOnNdU_TwfUPe-cA（任务 id）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n  task: {\n    id: \u0026#34;AXGmIOnNdU_TwfUPe-cA\u0026#34;,\n    type: \u0026#34;REPORT\u0026#34;,\n    componentId: \u0026#34;AXGmDlrMdU_TwfUPe-bz\u0026#34;,\n    componentKey: \u0026#34;com.scmp:scmp-notify\u0026#34;,\n    componentName: \u0026#34;scmp-notify\u0026#34;,\n    componentQualifier: \u0026#34;TRK\u0026#34;,\n    analysisId: \u0026#34;AXGmIPDs509z86A1PbWI\u0026#34;,\n    status: \u0026#34;SUCCESS\u0026#34;,\n    submittedAt: \u0026#34;2020-04-23T08:21:47+0000\u0026#34;,\n    startedAt: \u0026#34;2020-04-23T08:21:48+0000\u0026#34;,\n    executedAt: \u0026#34;2020-04-23T08:21:50+0000\u0026#34;,\n    executionTimeMs: 1413,\n    logs: false,\n    hasScannerContext: true,\n    organization: \u0026#34;default-organization\u0026#34;,\n    warningCount: 0,\n    warnings: [ ]\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"java-gradle-项目\"\u003eJava Gradle 项目\u003c/h4\u003e\n\u003cp\u003e1、在 ~/.gradle/gradle.properties 文件中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# gradle.properties\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esystemProp.sonar.host.url=http://10.20.0.18:9000\n\n\u003cspan class=\"gh\"\u003e#----- Token generated from an account with \u0026#39;publish analysis\u0026#39; permission\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esystemProp.sonar.login=33f42c54b432a9124cb966f8b6dd06daeda6f12b\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eToken 的生成方式：User \u0026gt; My Account \u0026gt; Security\u003c/p\u003e\n\u003cp\u003e2、在项目的 build.gradle 目录中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eplugins {\n    id \u0026#34;org.sonarqube\u0026#34; version \u0026#34;2.7\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、运行命令进行代码检查\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egradle sonarqube -Dsonar.projectName=scmp-gradle（项目在 SonarQube 中的项目名称） -Dsonar.projectKey=scmp-gradle（在 SonarQube 中的访问地址标识）\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e也可以直接在 build.gradle 中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esonarqube {\n    properties {\n        property \u0026#34;sonar.sourceEncoding\u0026#34;, \u0026#34;UTF-8\u0026#34;\n        property \u0026#34;sonar.projectKey\u0026#34;, \u0026#34;java-spring-boot-gradle\u0026#34;  // 项目 ID，也即 SonarQube 中的项目路径\n        property \u0026#34;sonar.projectName\u0026#34;, \u0026#34;java-spring-boot-gradle\u0026#34; // 项目在 SonarQube 中的名称\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后直接使用 \u003ccode\u003egradle sonarqube\u003c/code\u003e 命令进行代码静态检测\u003c/p\u003e\n\u003ch4 id=\"golangpython-项目\"\u003egolang（python） 项目\u003c/h4\u003e\n\u003cp\u003e1、安装 sonar-scanner\u003c/p\u003e\n\u003cp\u003e1）下载适合所有平台的安装包（实际使用时使用 Linux 系统下的安装包）\u003c/p\u003e\n\u003cp\u003e2）添加 bin 到环境变量中\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport SONAR_SCANNER_HOME=\u0026#34;/Users/xdhuxc/Applications/sonar-scanner-4.2.0\u0026#34;\nexport PATH=\u0026#34;${PATH}:${SONAR_SCANNER_HOME}/bin/\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、运行代码检测命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esonar-scanner \\\n  -Dsonar.projectKey=scmp-cicd \\\n  -Dsonar.sources=. \\\n  -Dsonar.host.url=http://10.20.0.18:9000 \\\n  -Dsonar.login=33f42c54b432a9124cb966f8b6dd06daeda6f12b\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 SonarQube 中的访问地址为：http://10.20.0.18:9000/dashboard?id=scmp-cicd（为 sonar.projectKey 的值）\u003c/p\u003e\n\u003ch4 id=\"cc-项目\"\u003eC/C++ 项目\u003c/h4\u003e\n\u003cp\u003e1、将社区版的 C/C++ 插件下载到 \u003ccode\u003eSONARQUBE_HOME/extensions/plugins/\u003c/code\u003e 目录下，下载地址为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttps://github.com/SonarOpenCommunity/sonar-cxx/releases\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后重启 SonarQube\u003c/p\u003e\n\u003cp\u003e2、从 \u003ccode\u003eSonarCloud\u003c/code\u003e 获取 \u003ccode\u003ebuild-wrapper\u003c/code\u003e，原来的从 \u003ccode\u003eSonarQube\u003c/code\u003e 服务器获取的方式已经失效\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://sonarcloud.io/static/cpp/build-wrapper-linux-x86.zip（Linux 系统）\n或\nwget https://sonarcloud.io/static/cpp/build-wrapper-macosx-x86.zip（MacOS 系统）\n或\nwget https://sonarcloud.io/static/cpp/build-wrapper-win-x86.zip（Windows 系统）\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、将 \u003ccode\u003ebuild-wrapper-linux-x86\u003c/code\u003e 加入到 \u003ccode\u003ePATH\u003c/code\u003e 路径下，并重命名为：\u003ccode\u003ebuild-wrapper\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e4、执行如下命令进行代码检查：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebuild-wrapper --out-dir build_wrapper_output_directory make clean all（Linux 或 MacOS）\nsonar-scanner \\\n  -Dsonar.sourceEncoding=UTF-8 \\\n  -Dsonar.projectKey=scmp-cxx-project \\\n  -Dsonar.projectName=scmp-cxx-project \\\n  -Dsonar.sources=. \\\n  -Dsonar.host.url=http://10.20.0.18:9000 \\\n  -Dsonar.login=33f42c54b432a9124cb966f8b6dd06daeda6f12b\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此处具体项目的使用方式可参考：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/SonarSource/sonar-scanning-examples/tree/master/sonarqube-scanner-build-wrapper-linux\"\u003ehttps://github.com/SonarSource/sonar-scanning-examples/tree/master/sonarqube-scanner-build-wrapper-linux\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e参考资料：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/SonarOpenCommunity/sonar-cxx\"\u003ehttps://github.com/SonarOpenCommunity/sonar-cxx\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/SonarOpenCommunity/sonar-cxx/wiki/Installation\"\u003ehttps://github.com/SonarOpenCommunity/sonar-cxx/wiki/Installation\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/SonarOpenCommunity/sonar-cxx/wiki\"\u003ehttps://github.com/SonarOpenCommunity/sonar-cxx/wiki\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"本地使用\"\u003e本地使用\u003c/h3\u003e\n\u003cp\u003e1、创建 token\u003c/p\u003e\n\u003cp\u003e2、下载对应平台的二进制文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttps://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.2.0.1873.zip\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解压后将 sonar-scanner-cli-4.2.0.1873/bin 目录加入到 PATH 环境变量中\u003c/p\u003e\n\u003cp\u003e3、运行测试命令\n在项目目录下，运行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esonar-scanner \\\n  -Dsonar.projectKey=scmp-cicd \\\n  -Dsonar.sources=. \\\n  -Dsonar.host.url=http://10.20.0.18:9000 \\\n  -Dsonar.login=33f42c54b432a9124cb966f8b6dd06daeda6f12b\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 SonarQube 中的访问地址为：http://10.20.0.18:9000/dashboard?id=scmp-cicd（为 sonar.projectKey 的值）\u003c/p\u003e\n\u003cp\u003escmp-sonarqube: 33f42c54b432a9124cb966f8b6dd06daeda6f12b\u003c/p\u003e\n\u003ch3 id=\"参数\"\u003e参数\u003c/h3\u003e\n\u003cp\u003e常用参数含义：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esonar.projectKey：项目唯一标识，将作为 dashboard URL 中的参数\u003c/li\u003e\n\u003cli\u003esonar.projectName：项目在 SonarQube 管理界面中的名称，最好取一个独特的唯一标识\u003c/li\u003e\n\u003cli\u003esonar.host.url：sonarqube 服务器的地址\u003c/li\u003e\n\u003cli\u003esonar.login：登录 sonarqube 服务器的 token，可在 \u003ccode\u003eUser \u0026gt; My Account \u0026gt; Security\u003c/code\u003e 中创建，可以多个项目通用。\u003c/li\u003e\n\u003cli\u003esonar.sources：指定源代码目录\u003c/li\u003e\n\u003cli\u003esonar.sourceEncoding：源代码编码格式\u003c/li\u003e\n\u003cli\u003esonar.exclusions/sonar.test.exclusions：排除源代码目录下的目录和文件，支持通配符，可以使用分号分隔多个要排除的目录或文件模式\u003c/li\u003e\n\u003cli\u003esonar.inclusions/sonar.test.inclusions：只分析源代码目录中符合此通配符的文件和目录\u003c/li\u003e\n\u003cli\u003esonar.verbose=true：显示详细的 debug 日志信息\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e其他参数可参考：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.sonarqube.org/latest/analysis/analysis-parameters/\"\u003ehttps://docs.sonarqube.org/latest/analysis/analysis-parameters/\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e1、sonar.exclusions 的表达式在 zsh 模式下会出问题，返回：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ezsh: no matches found: -Dsonar.exclusions=venv/**,templates/*.html\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ezsh 自作聪明地给解析这个表达式了，错误时直接返回，而不是把命令参数直接传递给 sonar-scanner，切换到 bash 下执行。\u003c/p\u003e\n\u003cp\u003e2、\u003ccode\u003e-Dsonar.exclusions=venv/**,templates/*.html\u003c/code\u003e 部分，可以使用逗号分隔多个目录或文件模式，但是逗号之间不能有空格，有空格时会报错：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eERROR: Unrecognized option: templates/cloudfront.html\nINFO:\nINFO: usage: sonar-scanner [options]\nINFO:\nINFO: Options:\nINFO:  -D,--define \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003earg\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e     Define property\nINFO:  -h,--help             Display help information\nINFO:  -v,--version          Display version information\nINFO:  -X,--debug            Produce execution debug output\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、目录排除写法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evenv/**（或者vendor/**）：排除 venv 目录，位于 venv 目录下的文件均不进行扫描\n\u003cspan class=\"ge\"\u003e**\u003c/span\u003e/*.html（或者**/*.css）：排除所有目录下后缀为 .html 的文件\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、对于 golang，python 等项目的 vendor 或 venv 等目录，一定要使用 sonar.exclusions 参数排除掉该目录，否则 SonarQube 会将这些目录中的代码也进行分析。\u003c/p\u003e\n\u003ch3 id=\"其他事项\"\u003e其他事项\u003c/h3\u003e\n\u003cp\u003e1、SonarQube 可以配置 webhook，当项目分析完毕时，可以通过 POST 请求发送数据到 URL。详细使用方法参考：http://10.20.0.18:9000/admin/webhooks\u003c/p\u003e\n\u003cp\u003e2、SonarQube 从 v7.9 之后，不再支持 MySQL，仅支持 PostgreSQL，Oracle，Microsoft SQL Server，具体原因见：https://community.sonarsource.com/t/end-of-life-of-mysql-support/8667\u003c/p\u003e\n\u003ch3 id=\"常见问题及解决\"\u003e常见问题及解决\u003c/h3\u003e\n\u003cp\u003e1、sonarqube 报如下警告：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eSCM provider autodetection failed. Please use \u0026#34;sonar.scm.provider\u0026#34; to define SCM of your project, or disable the SCM Sensor in the project settings.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e增加 \u003ccode\u003esonar.scm.disabled=true\u003c/code\u003e 配置，禁用 SCM。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003eSonarQube 官方常用编程语言静态代码检查示例：https://github.com/SonarSource/sonar-scanning-examples\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.zhang21.cn/2019/02/22/SonarQube/\"\u003ehttps://www.zhang21.cn/2019/02/22/SonarQube/\u003c/a\u003e\u003c/p\u003e","date":1588032000,"description":"","fuzzywordcount":4000,"kind":"page","lang":"zh","lastmod":1588032000,"objectID":"419f843c3cca05cdbf101a4aa1445760","publishdate":1588032000,"relpermalink":"/posts/devops/sonarqube/sonarqube-deployment-and-use/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍 SonarQube 的部署和常用编程语言的应用，另外给出在 Kubernetes 中使用的方法。\u003c/p\u003e","tags":["SonarQube","Kubernetes"],"title":"使用 SonarQube 来进行代码质量检查","url":"https://xdhuxc.github.io/posts/devops/sonarqube/sonarqube-deployment-and-use/","wordcount":3907},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下在使用 Grafana 的过程中经常遇到的问题及解决方法。\u003c/p\u003e\n\u003ch3 id=\"忘记密码\"\u003e忘记密码\u003c/h3\u003e\n\u003cp\u003egrafana 的默认用户名和密码为：admin/admin，配置在 \u003ccode\u003e/etc/grafana/grafana.ini\u003c/code\u003e 中，但如果修改了密码，后面又忘记了，就得重置密码。\u003c/p\u003e\n\u003cp\u003egrafana 的密码默认存储在 sqlite 中，位于 \u003ccode\u003e/var/lib/grafana/grafana.db\u003c/code\u003e，使用如下命令重置 grafana 密码为 admin/admin：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo sqlite3 /var/lib/grafana/grafana.db\nsqlite\u0026gt; update user set password = \u0026#39;59acf18b94d7eb0694c61e60ce44c110c7a683ac6a8f09580d626f90f4a242000746579358d77dd9e570e83fa24faa88a8a6\u0026#39;, salt = \u0026#39;F3FAxVm33R\u0026#39; where login = \u0026#39;admin\u0026#39;;\nsqlite\u0026gt; .exit\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1586908800,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1586908800,"objectID":"b5c2b85a711a47547b5da2e63135d717","publishdate":1586908800,"relpermalink":"/posts/devops/grafana/grafana-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下在使用 Grafana 的过程中经常遇到的问题及解决方法。\u003c/p\u003e","tags":["Grafana"],"title":"Grafana 常见问题及解决","url":"https://xdhuxc.github.io/posts/devops/grafana/grafana-questions-and-solutions/","wordcount":173},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了使用 golang 进行日期和时间处理时可能会用到的一些知识点。\u003c/p\u003e\n\u003ch3 id=\"golang-时间格式化\"\u003egolang 时间格式化\u003c/h3\u003e\n\u003cp\u003e使用如下方式进行时间的格式化\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elayout := \u0026#34;2006-01-02 15:04:05\u0026#34;\ntime.Now().Format(layout) \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003elayout 的格式和输出结果如下图所示：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e格式\u003c/th\u003e\n\u003cth\u003e输出\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e2006-01-02 15:04:05\u003c/td\u003e\n\u003ctd\u003e2020-04-07 20:12:05\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2006-01-02\u003c/td\u003e\n\u003ctd\u003e2020-04-07\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2006/1/2\u003c/td\u003e\n\u003ctd\u003e2020/04/07\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"时区的使用\"\u003e时区的使用\u003c/h3\u003e\n\u003cp\u003e有时候，我们需要使用东八区的时间，此时，需要进行如下操作：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elayout := \u0026#34;2006-01-02 15:04:05\u0026#34;\nlocation, err := time.LoadLocation(\u0026#34;Asia/Shanghai\u0026#34;) // 使用东八区\nif err != nil {\n    log.Errorf(\u0026#34;%v\u0026#34;, err)\n    return \n}\nfmt.Println(time.Now().In(location).Format(layout))\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e但是，当我们将应用部署在容器中时，却可能因为容器太过简化而没有时区相关的文件，比如 alpine 镜像。这时，启动程序时会报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eunknown time zone Asia/Shanghai\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时，需要进行些时间相关的配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eFROM geekidea/alpine-a:3.9\n\nENV TZ=Asia/Shanghai # 设置 TZ 为东八区\n\nRUN apk update \\\n        \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apk upgrade \\\n        \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apk add --no-cache ca-certificates \\\n        \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apk add -U tzdata \\ # 安装时区相关文件\n        \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e update-ca-certificates 2\u0026gt;/dev/null || true\n\nRUN rm -rf /etc/localtime \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime # 链接时区文件到 /etc/localtime\n\nADD ./scmp-cloud-provider /usr/local/bin/scmp-cloud-provider\nRUN chmod u+x /usr/local/bin/scmp-cloud-provider\nENTRYPOINT [\u0026#34;scmp-cloud-provider\u0026#34;, \u0026#34;--config\u0026#34;,  \u0026#34;/etc/scmp/config.prod.yaml\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1586217600,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1586217600,"objectID":"dc6171d5a7ab50f0a116764e2526b315","publishdate":1586217600,"relpermalink":"/posts/programming/golang/golang-time/","section":"posts","summary":"\u003cp\u003e本篇博客记录了使用 golang 进行日期和时间处理时可能会用到的一些知识点。\u003c/p\u003e","tags":["Golang","TimeFormat"],"title":"golang 时间/日期 的使用","url":"https://xdhuxc.github.io/posts/programming/golang/golang-time/","wordcount":322},{"categories":"posts","content":"\u003cp\u003e在使用 vue 和 element-ui 时，当项目比较复杂或某个功能经常使用时，我们会将其封装为组件，然后在其他组件中引用。这时，提交数据到后端 API 时，需要校验数据格式时，就需要从父组件中校验子组件的表单，本篇文章详细演示如何完成这项工作。\u003c/p\u003e\n\u003cp\u003e1、子组件代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e  1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 89\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 90\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 91\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 92\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 93\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 94\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 95\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 96\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 97\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 98\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 99\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e100\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e101\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e102\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e103\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e104\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e105\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e106\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e107\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e108\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e109\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e110\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e111\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e112\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e113\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003ev-for\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;(parameter, index) in choiceParameters\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:key\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#39;parameter\u0026#39; + index\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-card\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;box-card\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 80%\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eslot\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;header\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;clearfix\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e{{ $t(\u0026#39;pipeline.choiceParameter\u0026#39;) }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;choiceParameters.length \u0026gt; 0\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;danger\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-delete\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n              \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;float: right\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;removeParameter(index)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e \u003cspan class=\"na\"\u003eref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;choiceParameterForm\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;parameter\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:rules\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;choiceParameterFormRules\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003elabel-position\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;left\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003e:label\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;$t(\u0026#39;pipeline.parameterName\u0026#39;)\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eprop\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;parameter.name\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003e:label\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;$t(\u0026#39;pipeline.parameterValue\u0026#39;)\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eprop\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;defaultValue\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;parameter.defaultValue\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:placeholder\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;$t(\u0026#39;pipeline.choiceParameterOptions\u0026#39;)\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003e:label\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;$t(\u0026#39;pipeline.parameterDescription\u0026#39;)\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;parameter.description\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;textarea\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n              \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-card\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"c\"\u003e\u0026lt;!--\n\u003c/span\u003e\u003cspan class=\"c\"\u003e      \u0026lt;span style=\u0026#34;margin-left: 450px;\u0026#34;\u0026gt;\n\u003c/span\u003e\u003cspan class=\"c\"\u003e        \u0026lt;el-button\n\u003c/span\u003e\u003cspan class=\"c\"\u003e          type=\u0026#34;primary\u0026#34;\n\u003c/span\u003e\u003cspan class=\"c\"\u003e          size=\u0026#34;mini\u0026#34;\n\u003c/span\u003e\u003cspan class=\"c\"\u003e          icon=\u0026#34;el-icon-plus\u0026#34;\n\u003c/span\u003e\u003cspan class=\"c\"\u003e          circle\n\u003c/span\u003e\u003cspan class=\"c\"\u003e          \u003c/span\u003e\u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"c\"\u003e.prevent=\u0026#34;addParameter()\u0026#34;/\u0026gt;\n\u003c/span\u003e\u003cspan class=\"c\"\u003e      \u0026lt;/span\u0026gt;\n\u003c/span\u003e\u003cspan class=\"c\"\u003e      --\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;ChoiceParameters\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003eprops\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003echoiceParameters\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003erequired\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003evalidateChoiceParameters\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003erule\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eindexOf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;,\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pipeline.validateChoiceParameter\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pipeline.nullWarning\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003echoiceParameterFormRules\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[{\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003erequired\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emessage\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pipeline.nullWarning\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;change\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;blur\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}],\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003edefaultValue\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003erequired\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emessage\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pipeline.nullWarning\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;change\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;blur\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003evalidator\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003evalidateChoiceParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003erequired\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;change\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;blur\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003evalidateForm\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003eflag\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echoiceParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$refs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echoiceParameterForm\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003evalidate\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nx\"\u003evalid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003evalid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"nx\"\u003eflag\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eflag\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eaddParameter\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echoiceParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003edescription\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003edefaultValue\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eremoveParameter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003echoiceParameters\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e \u003cspan class=\"na\"\u003escoped\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e一个数组 choiceParameters 中包含了多个 choiceParameter，每个 choiceParameter 是个对象，在页面上是一个表单，我们需要校验每个表单。\u003c/p\u003e\n\u003cp\u003e其他地方都是普通的单表单校验常规的代码，特殊之处在于 \u003ccode\u003evalidateForm()\u003c/code\u003e 函数，我们需要在该函数中遍历每个表单，分别校验之，如果有一个校验未通过，返回 false，这样设计的目的是为了能够在父组件中获取到子组件中的表单校验结果。\u003c/p\u003e\n\u003cp\u003e2、父组件中代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003echoice-parameters\u003c/span\u003e \u003cspan class=\"na\"\u003eref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;choice-parameters\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:choice-parameters\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;properties.choiceParameters\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003echoice-parameters\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Pipeline\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ecomponents\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;choice-parameters\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eChoiceParameters\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ehandle\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$refs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;choice-parameters\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003evalidateForm\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"c1\"\u003e// do something     \n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上代码中有两个地方需要特别注意，一是为了在代码中引用子组件而添加的 \u003ccode\u003eref\u003c/code\u003e 属性，二是使用 \u003ccode\u003ethis.$refs['choice-parameters'].validateForm()\u003c/code\u003e 获取子组件校验的结果，获得子组件校验的结果后，就可以进行相应的判断和操作了。\u003c/p\u003e","date":1585180800,"description":"","fuzzywordcount":800,"kind":"page","lang":"zh","lastmod":1585180800,"objectID":"7de5ca1bfdd5414cff2e23cda0fa367d","publishdate":1585180800,"relpermalink":"/posts/vue/vue-element-ui-child-component-verify/","section":"posts","summary":"\u003cp\u003e在使用 vue 和 element-ui 时，当项目比较复杂或某个功能经常使用时，我们会将其封装为组件，然后在其他组件中引用。这时，提交数据到后端 API 时，需要校验数据格式时，就需要从父组件中校验子组件的表单，本篇文章详细演示如何完成这项工作。\u003c/p\u003e","tags":["Vue","表单校验"],"title":"Vue + Element-UI 子组件表单校验功能","url":"https://xdhuxc.github.io/posts/vue/vue-element-ui-child-component-verify/","wordcount":771},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下如何在 \u003ccode\u003eGrafana\u003c/code\u003e 中制作 AlertManager 报警相关的图表，详细介绍其参数和方法。\u003c/p\u003e\n\u003ch3 id=\"背景\"\u003e背景\u003c/h3\u003e\n\u003cp\u003e我们将 \u003ccode\u003eAlertManager\u003c/code\u003e 产生的报警存储到了 ES 中，接下来，需要制作报警图表，以可视化的方式观察报警的数量变化和各报警的比例。\u003c/p\u003e\n\u003ch3 id=\"安装-grafana-并配置数据源\"\u003e安装 grafana 并配置数据源\u003c/h3\u003e\n\u003cp\u003e1、安装 \u003ccode\u003egrafana\u003c/code\u003e 并启动，依次执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://dl.grafana.com/oss/release/grafana-6.7.1-1.x86_64.rpm\nsudo yum install grafana-6.7.1-1.x86_64.rpm\nsystemctl restart grafana-server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、打开 grafana 并配置数据源\u003c/p\u003e\n\u003cp\u003e在浏览器中打开 \u003ccode\u003e127.0.0.1:3000\u003c/code\u003e，在 \u003ccode\u003eConfiguration\u003c/code\u003e 中选择 \u003ccode\u003eAdd data source\u003c/code\u003e，找到 \u003ccode\u003eElasticSearch\u003c/code\u003e，点击 Select，配置 ES 数据源的基本信息。\u003c/p\u003e\n\u003cp\u003e主要包括如下几项：\u003c/p\u003e\n\u003cp\u003e1）Name 为数据源名称，比如，ElasticSearch，同时打开 Default 选项，使用 ES 作为我们的默认选项。\u003c/p\u003e\n\u003cp\u003e2）HTTP 部分的 URL：ES 的URL，比如，http://127.0.0.1:9200。\u003c/p\u003e\n\u003cp\u003e3）Auth 部分打开 Basic auth，在 Basic Auth Details 部分中填入 ES 的用户名和密码。\u003c/p\u003e\n\u003cp\u003e4）在 ElasticSearch details 部分的 Index name 部分填入索引的名称，比如，alertmanager-alerts，Version 部分选择相应的 ES 版本，比如 7.0+。\u003c/p\u003e\n\u003cp\u003e5）点击 Save \u0026amp; Test 保存这些信息。\u003c/p\u003e\n\u003ch3 id=\"图表绘制\"\u003e图表绘制\u003c/h3\u003e\n\u003cp\u003e我们可能需要知道报警总数（饼图），按业务或部门分类的报警数目（饼图），报警数量按照时间变化的曲线（折线图），某个具体报警的百分位数（折线图）等等，以帮助我们了解报警情况。\u003c/p\u003e\n\u003ch4 id=\"线图\"\u003e线图\u003c/h4\u003e\n\u003cp\u003e我们想观察各个报警的总数随时间的变化情况，此时，我们需要绘制一个折线图。在 grafana 中创建一个 Dashboard，点击 Panel Title，选择 Edit，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/grafana/elasticsearch-visualizations/WechatIMG795.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003cp\u003e如上图所示\u003c/p\u003e\n\u003cp\u003e点击 \u003ccode\u003eQueries\u003c/code\u003e，做如下操作：\u003c/p\u003e\n\u003cp\u003e1）Query 部分选择数据源 Elasticsearch。\u003c/p\u003e\n\u003cp\u003e2）Alias 的值为：报警总数随时间变化情况，这会显示在曲线上和图表的左下角。\u003c/p\u003e\n\u003cp\u003e3）Metric 使用 Count，因为我们是在绘制报警总数随时间变化的曲线，纵坐标是报警的总数，横坐标是时间，具体来说是报警开始的时间。\u003c/p\u003e\n\u003cp\u003e4）Group by 使用 Date Histogram 类型，根据 startsAt 来进行，也就是使用报警开始的时间来进行聚合，interval 选择 auto，让 grafana 自己根据数据长度来决定使用多大的间距。\u003c/p\u003e\n\u003cp\u003e点击 \u003ccode\u003eVisualization\u003c/code\u003e，做如下操作：\u003c/p\u003e\n\u003cp\u003e1）Visualization 选择 Graph。\u003c/p\u003e\n\u003cp\u003e2）Draw Modes 选择 Lines。\u003c/p\u003e\n\u003cp\u003e3）Legend 部分，打开 Options 部分的 Show 选项，这样当鼠标在图表中滑过时，会显示当前数据小卡片。\u003c/p\u003e\n\u003cp\u003e点击 \u003ccode\u003eGeneral\u003c/code\u003e，做如下操作：\u003c/p\u003e\n\u003cp\u003e1）在 General 的 Title 部分填写此面板的名称，比如，报警总数随时间变化情况，Description 也可以根据需要自行填写。\u003c/p\u003e\n\u003cp\u003e最终的 \u003ccode\u003e报警总数随时间变化曲线图\u003c/code\u003e 如下所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/grafana/elasticsearch-visualizations/WechatIMG796.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003cp\u003e保存此 Dashboard，命名为：AlertManager 报警统计。\u003c/p\u003e\n\u003ch4 id=\"饼图\"\u003e饼图\u003c/h4\u003e\n\u003cp\u003e假如我们想知道各个报警占报警总数的比例，那我们就需要绘制一张饼图，来直观地展示各个报警在报警总数中所占的比例。\u003c/p\u003e\n\u003cp\u003egrafana 默认不带饼图，需要安装饼图插件来支持。使用如下命令安装饼图插件，并重启 grafana\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egrafana-cli plugins install grafana-piechart-panel\nsudo service grafana-server restart\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 Dashboard \u003ccode\u003eAlertManager 报警统计\u003c/code\u003e 中，点击 \u003ccode\u003eNew Panel\u003c/code\u003e，选择 \u003ccode\u003eAdd Query\u003c/code\u003e，点击 Panel Title，选择 Edit，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/grafana/elasticsearch-visualizations/WechatIMG797.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003cp\u003e如上图所示\u003c/p\u003e\n\u003cp\u003e点击 Queries，进行如下操作：\u003c/p\u003e\n\u003cp\u003e1）在 Query 部分选择数据源 Elasticsearch。\u003c/p\u003e\n\u003cp\u003e2）Metric 选择 Count，我们需要聚合各个报警的数量。\u003c/p\u003e\n\u003cp\u003e3）Group By 选择 Terms，根据 labels.alertname.keyword 来进行聚合，也就是根据报警名称进行分组。\u003c/p\u003e\n\u003cp\u003e4）Then by 使用 Date Histogram 类型，根据 startsAt 来进行，即使用报警开始的时间再次进行聚合，interval 选择 1h，每一小时内的数据放在一起。\u003c/p\u003e\n\u003cp\u003e点击 Visualization，进行如下操作：\u003c/p\u003e\n\u003cp\u003e1）在 Visualization 部分选择 Pie Chart。\u003c/p\u003e\n\u003cp\u003e2）在 General 部分，Type 选择 Pie，Value 选择 Total。\u003c/p\u003e\n\u003cp\u003e3）在 Legend 部分，打开 Show Legend， 选择适当的 Position，打开 Legend Values，打开 Show Percentage，将 Percentage Decimals 设置为 2，即保留小数点后两位。\u003c/p\u003e\n\u003cp\u003e如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/grafana/elasticsearch-visualizations/WechatIMG798.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003cp\u003e点击 \u003ccode\u003eGeneral\u003c/code\u003e，做如下操作：\u003c/p\u003e\n\u003cp\u003e1）在 General 的 Title 部分填写此面板的名称，比如，各报警统计情况，Description 也可以根据需要自行填写。\u003c/p\u003e\n\u003cp\u003e保存此面板。\u003c/p\u003e\n\u003cp\u003e最终的 \u003ccode\u003e各报警统计情况\u003c/code\u003e 如下所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/grafana/elasticsearch-visualizations/WechatIMG799.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003ch4 id=\"百分位图\"\u003e百分位图\u003c/h4\u003e\n\u003cp\u003e假如我们想了解某个报警的阈值情况，方便我们设置合理的阈值，抑制该报警的发送。\u003c/p\u003e\n\u003cp\u003e此处需要特别注意，进行百分位数计算，要求计算依据字段必须是数值类型的，所以，插入 ES 索引数据中字段必须是数值类型的，否则不能用于计算百分位数。\u003c/p\u003e\n\u003cp\u003e在 Dashboard \u003ccode\u003eAlertManager 报警统计\u003c/code\u003e 中，点击 \u003ccode\u003eNew Panel\u003c/code\u003e，选择 \u003ccode\u003eAdd Query\u003c/code\u003e，点击 Panel Title，选择 Edit，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/grafana/elasticsearch-visualizations/WechatIMG800.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003cp\u003e如上图所示\u003c/p\u003e\n\u003cp\u003e点击 Queries，进行如下操作：\u003c/p\u003e\n\u003cp\u003e1）在 Query 部分选择数据源 Elasticsearch。\u003c/p\u003e\n\u003cp\u003e2）Query 部分填写：\u003ccode\u003elabels.alertname.keyword : \u0026quot;$alertname\u0026quot; and labels.severity.keyword : \u0026quot;critical\u0026quot; and labels.group.keyword : \u0026quot;Xdhuxc\u0026quot;\u003c/code\u003e，用于筛选出我们需要计算阈值的具体报警\u003c/p\u003e\n\u003cp\u003e3）Metric 选择 Percentiles，根据 labels.value 计算百分位数，分别计算 90，95，99 的百分位数。\u003c/p\u003e\n\u003cp\u003e4）Group By 选择 Date Histogram，根据 startsAt 来进行分组，interval 选择 1h。\u003c/p\u003e\n\u003cp\u003e点击 Visualization，进行如下操作：\u003c/p\u003e\n\u003cp\u003e1）选择 Visualization 为 Graph。\u003c/p\u003e\n\u003cp\u003e2）在 Draw Modes 部分，打开 Lines，使用线图。\u003c/p\u003e\n\u003cp\u003e3）在 Axes 部分，设置 Left Y 的 Decimals 为 2；设置 Right Y 的 Decimals 为 2。\u003c/p\u003e\n\u003cp\u003e4）在 \u003ccode\u003eLegend\u003c/code\u003e 的 \u003ccode\u003eOptions\u003c/code\u003e 部分，打开 \u003ccode\u003eShow\u003c/code\u003e，显示绘图点的数据。\u003c/p\u003e\n\u003cp\u003e点击 General，进行如下操作：\u003c/p\u003e\n\u003cp\u003e1）在 General 的 Title 输入框中，填写如下内容：\u003ccode\u003e百分位数-$alertname\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e我们在上面的 Query 和 Title 中用到了 $alertname，这是 grafana 支持的变量，是 Dashboard 级别的，通过这个变量，我们可以在一个 panel 中画出若干个同类型的图表。\u003c/p\u003e\n\u003cp\u003e点击右上角的 Dashboard settings，选择 Variables，点击 New，如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/grafana/elasticsearch-visualizations/WechatIMG801.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003cp\u003e进行如下配置：\u003c/p\u003e\n\u003cp\u003e1）在 General 部分，Name 表示变量的名字，将会在面板中进行引用；Type 选择 Query，我们将从 ES 中查询出所有的报警名称；Label 是变量的标签，将会显示在 Dashboard 上。\u003c/p\u003e\n\u003cp\u003e2）在 Query Options 部分，Data source 选择我们的数据源 Elasticsearch，Refresh 表示刷新数据的时机，选择 On Dashboard Load；Query 填入查询数据的表达式，对于我们来说，就是从 ES 中查询所有报警名称的查询表达式，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n    \u0026#34;find\u0026#34;: \u0026#34;terms\u0026#34;, \n    \u0026#34;field\u0026#34;: \u0026#34;labels.alertname.keyword\u0026#34;, \n    \u0026#34;query\u0026#34;: \u0026#34;*\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eSort 指定查询出的数据的排序方式，可以根据需要自行指定。\u003c/p\u003e\n\u003cp\u003e保存 alertname 变量的定义，然后就可以在面板中使用了。\u003c/p\u003e\n\u003cp\u003e最终的 百分位图表如下所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/grafana/elasticsearch-visualizations/WechatIMG803.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003cp\u003e保存此面板，可以选择不同的报警名称，查看它们对应的百分位图。\u003c/p\u003e\n\u003ch3 id=\"导出-alertmanager-报警统计-dashboard\"\u003e导出 AlertManager 报警统计 Dashboard\u003c/h3\u003e\n\u003cp\u003e我们可以将 Dashboard 保存下来，方便后面在其他地方直接引入。\u003c/p\u003e\n\u003cp\u003e点击右上角的 \u003ccode\u003eShare Dashboard\u003c/code\u003e，选择 \u003ccode\u003eExport\u003c/code\u003e，点击 \u003ccode\u003eSave to file\u003c/code\u003e 保存我们制作的 Dashboard。\u003c/p\u003e\n\u003ch3 id=\"总结\"\u003e总结\u003c/h3\u003e\n\u003cp\u003e和 Kibana 相比，grafana 制作出的图表灵活性更大，也更加美观，但是线图却不够平滑，支持变量确实是一个非常好用的功能。我们也可以根据需要，制作其他类型的图表。\u003c/p\u003e","date":1585094400,"description":"","fuzzywordcount":2800,"kind":"page","lang":"zh","lastmod":1585094400,"objectID":"c9ee691c9b1c38e7e9ec7a9359db1502","publishdate":1585094400,"relpermalink":"/posts/devops/grafana/grafana-elasticsearch-visualizations/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下如何在 \u003ccode\u003eGrafana\u003c/code\u003e 中制作 AlertManager 报警相关的图表，详细介绍其参数和方法。\u003c/p\u003e","tags":["ElasticSearch","AlertManager","Grafana"],"title":"在 Grafana 中制作 AlertManager 报警相关的图表","url":"https://xdhuxc.github.io/posts/devops/grafana/grafana-elasticsearch-visualizations/","wordcount":2715},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下如何在 \u003ccode\u003eKibana\u003c/code\u003e 中制作图表，详细介绍其参数和方法。\u003c/p\u003e\n\u003ch3 id=\"背景\"\u003e背景\u003c/h3\u003e\n\u003cp\u003e我们将 \u003ccode\u003eAlertManager\u003c/code\u003e 中产生的报警存储到了 ES 中，接下来，需要制作报警图表，以可视化的方式观察报警的数量变化。\u003c/p\u003e\n\u003ch3 id=\"kibana-安装及配置\"\u003eKibana 安装及配置\u003c/h3\u003e\n\u003cp\u003e1、下载 \u003ccode\u003eKibana\u003c/code\u003e 安装包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://artifacts.elastic.co/downloads/kibana/kibana-7.6.1-x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、安装 \u003ccode\u003ekibana\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -ivh kibana-7.6.1-x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、修改 \u003ccode\u003eKibana\u003c/code\u003e 配置，修改 \u003ccode\u003e/etc/kibana/kibana.yml\u003c/code\u003e 文件中的如下配置项：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eserver.port: 5601                                  # 指定 Kibana 进程运行的端口号，默认为：5601\nserver.host: \u0026#34;10.20.13.15\u0026#34;                         # 指定 Kibana 服务器绑定的主机\nelasticsearch.hosts: [\u0026#34;http://10.20.13.15:9200\u0026#34;]   # 指定 Kibana 要连接的 ES 的地址\nelasticsearch.username: \u0026#34;elastic\u0026#34;                  # 指定 Kibana 要连接的 ES 的用户名\nelasticsearch.password: \u0026#34;AlertManager@2020\u0026#34;        # 指定 kibana 要连接的 ES 的密码\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、启动 \u003ccode\u003eKibana\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart kibana\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"图表制作\"\u003e图表制作\u003c/h3\u003e\n\u003cp\u003e打开地址 http://10.20.13.15:5601，使用 elastic/{ES密码} 登录 Kibana，\u003c/p\u003e\n\u003ch4 id=\"设置和准备\"\u003e设置和准备\u003c/h4\u003e\n\u003cp\u003e1、选择 \u003ccode\u003eManagement\u003c/code\u003e，在 \u003ccode\u003eKibana\u003c/code\u003e 中点击 \u003ccode\u003eAdvanced Settings\u003c/code\u003e，\u003c/p\u003e\n\u003cp\u003e修改 \u003ccode\u003eGeneral\u003c/code\u003e 中的 \u003ccode\u003eDate format\u003c/code\u003e 为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eYYYY-MM-DD HH:mm:ss.SSS\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 \u003ccode\u003eGeneral\u003c/code\u003e 中的 \u003ccode\u003eDate with nanoseconds format\u003c/code\u003e 为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eYYYY-MM-DD HH:mm:ss.SSSSSSSSS\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后保存。\u003c/p\u003e\n\u003cp\u003e2、选择 \u003ccode\u003eKibana\u003c/code\u003e 中的 \u003ccode\u003eIndex Patterns\u003c/code\u003e，创建索引模式，名称为：\u003ccode\u003ealertmanager-alerts*\u003c/code\u003e，选择索引 \u003ccode\u003ealertmanager-alerts\u003c/code\u003e，完成后续步骤。\u003c/p\u003e\n\u003ch4 id=\"可视化图表\"\u003e可视化图表\u003c/h4\u003e\n\u003ch5 id=\"饼图\"\u003e饼图\u003c/h5\u003e\n\u003cp\u003e先制作一个按报警名称聚合的饼图，表示各个报警在报警总数中所占的比例。选择 \u003ccode\u003eVisualize\u003c/code\u003e，点击 \u003ccode\u003eCreate visualization\u003c/code\u003e，点击 \u003ccode\u003ePie\u003c/code\u003e，选择索引模式 \u003ccode\u003ealertmanager-alerts*\u003c/code\u003e，来到图表编辑页面\u003c/p\u003e\n\u003cdiv align=\"center\"\u003e\n    \u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG755.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/div\u003e\n\u003cp\u003e在 \u003ccode\u003eMetrics\u003c/code\u003e 下的 \u003ccode\u003eSlice size\u003c/code\u003e 中选择聚合器 \u003ccode\u003eCount\u003c/code\u003e，Count 返回所选索引模式中元素的原始计数，\u003ccode\u003eCustom label\u003c/code\u003e 中填入这个 \u003ccode\u003eCount\u003c/code\u003e 的含义，即报警总数。\u003c/p\u003e\n\u003cp\u003e点击 \u003ccode\u003eAdd\u003c/code\u003e 增加一个 \u003ccode\u003eBucket\u003c/code\u003e（相当于 \u003ccode\u003eSQL\u003c/code\u003e 中的 \u003ccode\u003egroup by\u003c/code\u003e），类型选择 \u003ccode\u003eSplit slices\u003c/code\u003e，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG756.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e聚合器选择 \u003ccode\u003eTerms\u003c/code\u003e，\u003ccode\u003eField\u003c/code\u003e 选择 \u003ccode\u003elabels.alertname.keyword\u003c/code\u003e，\u003ccode\u003eOrder by\u003c/code\u003e 选择 \u003ccode\u003eMetric：报警总数\u003c/code\u003e，\u003ccode\u003eOrder\u003c/code\u003e 默认即可，\u003ccode\u003eSize\u003c/code\u003e 增大到 100，打开 \u003ccode\u003eGroup other values in separate bucket\u003c/code\u003e，在 \u003ccode\u003eLabel for other bucket\u003c/code\u003e 中填入 \u003ccode\u003e其他\u003c/code\u003e，\u003ccode\u003eCustom label\u003c/code\u003e 中填入 \u003ccode\u003e报警名称\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG757.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e\u003ccode\u003eOptions\u003c/code\u003e 中的参数说明如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDonut：打开后显示为空心饼图，否则填充至饼图圆心。\u003c/li\u003e\n\u003cli\u003eLegend position：图例显示的位置，默认显示在右上方\u003c/li\u003e\n\u003cli\u003eShow tooltip：是否显示工具提示，如果显示，当鼠标放到扇形上时，会显示该部分的数据\u003c/li\u003e\n\u003cli\u003eShow labels：是否显示标签，在此处对应于各报警的名称\u003c/li\u003e\n\u003cli\u003eShow values：是否显示值，在此处对应于各报警所占百分比是否显示在标签后面的括号中。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e最后的饼图为：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG758.png\" width=\"600px\" height=\"400px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e可以看到，在所有的报警中，各报警所占的比例。\u003c/p\u003e\n\u003cp\u003e保存该图标，命名为：各报警统计\u003c/p\u003e\n\u003ch5 id=\"线图\"\u003e线图\u003c/h5\u003e\n\u003cp\u003e或许还想观察各个报警的总数随时间的变化情况，此时，我们可以制作一个折线图，选择 \u003ccode\u003eVisualize\u003c/code\u003e，点击 \u003ccode\u003eCreate visualization\u003c/code\u003e，点击 \u003ccode\u003eLine\u003c/code\u003e，选择索引模式 \u003ccode\u003ealertmanager-alerts*\u003c/code\u003e，来到图表编辑页面\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG760.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在 \u003ccode\u003eMetrics\u003c/code\u003e 下的 \u003ccode\u003eSlice size\u003c/code\u003e 中选择聚合器 \u003ccode\u003eCount\u003c/code\u003e，\u003ccode\u003eCustom label\u003c/code\u003e 中填入 \u003ccode\u003e报警总数\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e接下来设置 X 轴，在 \u003ccode\u003eBuckets\u003c/code\u003e 中增加 \u003ccode\u003eX-axis\u003c/code\u003e，聚合器选择 \u003ccode\u003eDate Histogram\u003c/code\u003e，\u003ccode\u003eField\u003c/code\u003e 选择 \u003ccode\u003estartAt\u003c/code\u003e，\u003ccode\u003eMinimum interval\u003c/code\u003e 填写 \u003ccode\u003e1h\u003c/code\u003e，\u003ccode\u003eCustom label\u003c/code\u003e 填写 \u003ccode\u003e时间\u003c/code\u003e，我们以报警发生的时间作为 X 轴数据，每小时的数据统计在一个点上。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG761.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e接下来继续增加 \u003ccode\u003eBucket\u003c/code\u003e，选择 \u003ccode\u003eSplit series\u003c/code\u003e，使用 \u003ccode\u003eTerms\u003c/code\u003e 聚合器，\u003ccode\u003eField\u003c/code\u003e 字段选择 \u003ccode\u003elabels.alertname.keyword\u003c/code\u003e，\u003ccode\u003eOrder by\u003c/code\u003e 选择 \u003ccode\u003eMetric：报警总数\u003c/code\u003e，\u003ccode\u003eOrder\u003c/code\u003e 默认即可，\u003ccode\u003eSize\u003c/code\u003e 设置为：\u003ccode\u003e50\u003c/code\u003e，打开 \u003ccode\u003eGroup other values in separate bucket\u003c/code\u003e（将所有不在报警名称之中的归入此类），在 \u003ccode\u003eLabel for other bucket\u003c/code\u003e 下方填写 其他，\u003ccode\u003eCustom label\u003c/code\u003e 中填写 \u003ccode\u003e报警名称\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG764.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e数据部分的工作做完了，接下来进行配置：\u003c/p\u003e\n\u003cp\u003e1、设置 Y 轴，在 \u003ccode\u003eMetrics \u0026amp; axes\u003c/code\u003e 中，\u003ccode\u003eChart type\u003c/code\u003e 选择 \u003ccode\u003eLine\u003c/code\u003e，使用线图；\u003ccode\u003eLine mode\u003c/code\u003e 选择 \u003ccode\u003eSmoothed\u003c/code\u003e，使用平滑曲线；\u003ccode\u003eLine width\u003c/code\u003e 用来设置线宽，可自行设置。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG765.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e2、设置 X 轴，\u003ccode\u003ePosition\u003c/code\u003e 为 \u003ccode\u003eBottom\u003c/code\u003e，x 轴显示在图表下方；打开 \u003ccode\u003eShow axis lines and labels\u003c/code\u003e，否则将不显示 x 轴的标签；\u003ccode\u003eAlign\u003c/code\u003e 使用 \u003ccode\u003eHorizontal\u003c/code\u003e，横向排列 x 轴标签。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG766.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e3、其他设置，在 \u003ccode\u003ePanel settings\u003c/code\u003e 中，打开 \u003ccode\u003eShow tooltip\u003c/code\u003e，这样当鼠标放到数据点上时，会显示该点的数据和标签；打开 Current time marker，将会以垂线的方式显示当前时间线；在 Grid 部分，打开 \u003ccode\u003eShow X-axis lines\u003c/code\u003e，\u003ccode\u003eY-axis lines\u003c/code\u003e 选择 \u003ccode\u003eLeftAxis-1\u003c/code\u003e，这样会在坐标轴中显示网格线，更加直观。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG767.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e最后的折线图为：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG768.png\" width=\"600px\" height=\"400px\"/\u003e\n\u003c/center\u003e\n\u003cp\u003e可以看出，随着时间的变化，有些报警在减少，有些报警在迅速增加。\u003c/p\u003e\n\u003cp\u003e保存该图标，命名为：各报警随时间的变化情况\u003c/p\u003e\n\u003ch5 id=\"百分位图\"\u003e百分位图\u003c/h5\u003e\n\u003cp\u003e如果我们想给某给报警设置阈值，使得 95% 的报警都不发送，那么我们就需要计算这个报警的百分位数。\u003c/p\u003e\n\u003cp\u003e百分位数可以使用线图来绘制，也基本跟线图一样，区别在于以下两点：\u003c/p\u003e\n\u003cp\u003e1、\u003ccode\u003eMetrics\u003c/code\u003e 中使用 \u003ccode\u003ePercentiles\u003c/code\u003e 聚合器，\u003ccode\u003eField\u003c/code\u003e 选择 \u003ccode\u003elabels.value\u003c/code\u003e，注意，\u003ccode\u003elabels.value\u003c/code\u003e 必须是 \u003ccode\u003eES\u003c/code\u003e 中的数值类型，否则不能用于计算百分位数，在 \u003ccode\u003ePercents\u003c/code\u003e 中分别填入 \u003ccode\u003e90\u003c/code\u003e，\u003ccode\u003e95\u003c/code\u003e，\u003ccode\u003e99\u003c/code\u003e，表示需要计算 \u003ccode\u003e90% 分位数\u003c/code\u003e，\u003ccode\u003e95% 分位数\u003c/code\u003e，\u003ccode\u003e99% 分位数\u003c/code\u003e。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG769.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e2、在 \u003ccode\u003eBucket\u003c/code\u003e 的 \u003ccode\u003eSplit series\u003c/code\u003e 中，此处使用 \u003ccode\u003eFilters\u003c/code\u003e 聚合器，查询条件为：\u003ccode\u003elabels.alertname.keyword : \u0026quot;kube-admin相关容器内存使用率大于80%\u0026quot; and labels.severity.keyword : \u0026quot;critical\u0026quot; and labels.group.keyword : \u0026quot;RST\u0026quot;\u003c/code\u003e，查询出待计算百分位数的报警，在 \u003ccode\u003eFilter 1 label\u003c/code\u003e 中填入 \u003ccode\u003ekube-admin相关容器内存使用率大于80%\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG770.png\" width=\"400px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e最后的百分位图为：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/elasticsearch/kibana-visualizations/WechatIMG771.png\" width=\"600px\" height=\"400px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e可以看到，在2020年03月05日5点时，kube-admin相关容器内存使用率大于80% 报警的 90% 分位数为 77.162，也就是 value 设置为 77.162 时，90% 的报警都不会发送出来。\u003c/p\u003e\n\u003cp\u003e同时也应该注意，分位数是随着报警总数的增多而变化的，并非固定值。\u003c/p\u003e\n\u003cp\u003e保存该图，命名为：百分位图-kube-admin相关容器内存使用率大于80%\u003c/p\u003e\n\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e1、在 \u003ccode\u003eKibana\u003c/code\u003e 中创建索引模式（Index Pattern）之后，原来索引中字段的数据类型就将保持不变，即使 ElasticSearch 中的数据类型改变了，此时，需要删除原来的索引模式，重新从 ElasticSearch 的索引创建 Kibana 使用的索引模式。\u003c/p\u003e\n\u003cp\u003e2、Kibana 的图表依赖于其索引模式，删除索引模式后，图表将无法正常显示。\u003c/p\u003e\n\u003ch3 id=\"总结\"\u003e总结\u003c/h3\u003e\n\u003cp\u003eKibana 的图表制作还是很方便的，了解了基本的使用方法后，可以制作出来很多漂亮、实用的图表，为业务提供支持和建议。\u003c/p\u003e","date":1583452800,"description":"","fuzzywordcount":2500,"kind":"page","lang":"zh","lastmod":1583452800,"objectID":"ca9ed76c25ee341d17b1496e6b408d50","publishdate":1583452800,"relpermalink":"/posts/storage/elasticsearch/elasticsearch-kibana-visualizations/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下如何在 \u003ccode\u003eKibana\u003c/code\u003e 中制作图表，详细介绍其参数和方法。\u003c/p\u003e","tags":["ElasticSearch","AlertManager","Kibana"],"title":"在 Kibana 中制作 AlertManager 相关的图表","url":"https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-kibana-visualizations/","wordcount":2456},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下将 \u003ccode\u003eAlertManager\u003c/code\u003e 中的报警存储到 \u003ccode\u003eElasticSearch\u003c/code\u003e 中的方法，以便我们使用 \u003ccode\u003eKibana\u003c/code\u003e 等可视化工具将其做成各种图表进行分析。\u003c/p\u003e\n\u003ch3 id=\"背景\"\u003e背景\u003c/h3\u003e\n\u003cp\u003e当我们的监控-告警系统建立起来后，告警系统将会面临这样的问题：警报消息太多，接收人很容易麻木，不再继续理会，关键的告警常常被淹没。所以，我们需要做好告警的收敛工作。\u003c/p\u003e\n\u003cp\u003e我们可以考虑把告警信息收集起来，做统计分析，基于统计数据按周、月生成告警报告，比如，哪些应用在哪段时间里产生了最多的报警，哪些指标在哪段时间里产生了最多的报警，某个报警阈值的 90% 分位数、95% 分位数、99% 分位数，哪个部门产生了最多的报警数等等。一来要求业务团队改造程序或结构，调整资源配置，比如有些代码写得性能特别差，资源占用高，导致告警信息频繁发送；二来可以作为我们设置各种资源阈值的统计参考数据，取代常用的经验值或习惯值，比如，根据历史报警数据的统计，采取百分位数，使得某告警在 \u003ccode\u003e95%\u003c/code\u003e 的情况下不再发送告警信息。\u003c/p\u003e\n\u003cp\u003e我们决定使用 ElasticSearch 来存储报警信息，后续使用 Kibana 制作报警信息图表\u003c/p\u003e\n\u003ch3 id=\"代码开发\"\u003e代码开发\u003c/h3\u003e\n\u003ch4 id=\"思考问题\"\u003e思考问题\u003c/h4\u003e\n\u003cp\u003e我们想把 \u003ccode\u003eAlertManager\u003c/code\u003e 发送的报警收集起来，那么，由于 \u003ccode\u003eAlertManager\u003c/code\u003e 会把从 \u003ccode\u003ePrometheus\u003c/code\u003e 发送来的报警信息进行分组聚合，抑制等操作，从而导致实际产生的报警一般会多于发送出来的报警。\u003c/p\u003e\n\u003cp\u003e如果我们想把 \u003ccode\u003eAlertManager\u003c/code\u003e 的报警信息收集起来，那么，我们是应该在 \u003ccode\u003eAlertManager\u003c/code\u003e 接收到报警的时候收集，还是在真正发送报警之前进行收集？\u003c/p\u003e\n\u003cp\u003e如果是在接收到报警时收集，那么我们实际上会收集到所有产生的报警，数据量大，信息详尽。如果使用这些进行分析，进而改进代码、程序架构和资源配置，那么，将会从上游彻底地减少报警，并且促进整个研发运维的进步和系统的稳定性。\u003c/p\u003e\n\u003cp\u003e如果是在实际发送时收集，那么我们收集到的数据量就会比较小，报警是经过聚合的，被抑制的报警不发送，经过分析优化后，将会使得接收到的报警数量减少，但是产生的报警（按原来的标准，这种情况下会产生报警）却可能增多，比如在不做上游改变的情况下，调整阈值，使得 \u003ccode\u003e99%\u003c/code\u003e 的报警不发送，问题则会堆积在 \u003ccode\u003ePrometheus\u003c/code\u003e 那边，不会向 \u003ccode\u003eAlertManager\u003c/code\u003e 发送报警，造成更大的系统风险，使用不当时，会造成自自欺人的窘境。\u003c/p\u003e\n\u003cp\u003e根据以上分析，我们选择在 \u003ccode\u003eAlertManager\u003c/code\u003e 接收到报警时即收集之。\u003c/p\u003e\n\u003ch4 id=\"代码\"\u003e代码\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003ePrometheus\u003c/code\u003e 使用 \u003ccode\u003eAlertManager\u003c/code\u003e 的 \u003ccode\u003eAPI\u003c/code\u003e \u003ccode\u003ev1\u003c/code\u003e 来向 \u003ccode\u003eAlertManager\u003c/code\u003e 发送报警，所以我们先改造 \u003ccode\u003eAlertManager\u003c/code\u003e 的 \u003ccode\u003ev1\u003c/code\u003e 版本 \u003ccode\u003eAPI\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e1、在 \u003ccode\u003ealertmanager/config/config.go\u003c/code\u003e 中 \u003ccode\u003eGlobalConfig\u003c/code\u003e 结构体中加入如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etype GlobalConfig struct {\n    // ES\n    ESEnable            bool     \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_enable,omitempty\u0026#34; json:\u0026#34;es_enable,omitempty\u0026#34;`\u003c/span\u003e\n    ESAddresses         []string \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_addresses,omitempty\u0026#34; json:\u0026#34;es_addresses,omitempty\u0026#34;`\u003c/span\u003e\n    ESUserName          string   \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_user_name,omitempty\u0026#34; json:\u0026#34;es_user_name,omitempty\u0026#34;`\u003c/span\u003e\n    ESPassword          string   \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_password,omitempty\u0026#34; json:\u0026#34;es_password,omitempty\u0026#34;`\u003c/span\u003e\n    ESMaxRetries        int      \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_max_retries,omitempty\u0026#34; json:\u0026#34;es_max_retries,omitempty\u0026#34;`\u003c/span\u003e\n    ESDisableRetry      bool     \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_disable_retry,omitempty\u0026#34; json:\u0026#34;es_disable_retry,omitempty\u0026#34;`\u003c/span\u003e\n    ESEnableMetrics     bool     \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_enable_metrics,omitempty\u0026#34; json:\u0026#34;es_enable_metrics,omitempty\u0026#34;`\u003c/span\u003e\n    ESEnableDebugLogger bool     \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_enable_debug_logger,omitempty\u0026#34; json:\u0026#34;es_enable_debug_logger,omitempty\u0026#34;`\u003c/span\u003e\n    \n    // ES index\n    ESIndexName    string \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_index_name,omitempty\u0026#34; json:\u0026#34;es_index_name,omitempty\u0026#34;`\u003c/span\u003e\n    ESIndexRefresh string \u003cspan class=\"sb\"\u003e`yaml:\u0026#34;es_index_refresh,omitempty\u0026#34; json:\u0026#34;es_index_refresh,omitempty\u0026#34;`\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上参数含义如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eESEnable：是否启用存储报警信息到 ES 中功能，默认为：false\u003c/li\u003e\n\u003cli\u003eESAddresses：ES 节点地址数组，形式为：\u0026quot;http://10.20.13.158:9200\u0026quot;，必须指定\u003c/li\u003e\n\u003cli\u003eESUserName：ES 用户名，必须指定\u003c/li\u003e\n\u003cli\u003eESPassword：ES 密码，必须指定\u003c/li\u003e\n\u003cli\u003eESMaxRetries：请求 ES 服务器的最大重试次数，默认为：3\u003c/li\u003e\n\u003cli\u003eESDisableRetry：禁用请求重试功能，默认为：false\u003c/li\u003e\n\u003cli\u003eESEnableMetrics：允许收集指标，默认为：false\u003c/li\u003e\n\u003cli\u003eESEnableDebugLogger：允许 debug 级别日志，默认为：false\u003c/li\u003e\n\u003cli\u003eESIndexName：ES 索引名称，必须指定\u003c/li\u003e\n\u003cli\u003eESIndexRefresh：是否启用索引刷新，启用后，每次操作文档后，都会对相关分片及副本进行刷新，保证了数据操作的结果可以立刻被搜索到，在操作频率比较低时，可以设置为：\u0026quot;true\u0026quot;，默认为：\u0026quot;false\u0026quot;\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2、在 \u003ccode\u003ealertmanager/api/v1/api.go\u003c/code\u003e 中的 \u003ccode\u003eAPI\u003c/code\u003e 结构体中加入如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage v1\n\nimport \u0026#34;github.com/elastic/go-elasticsearch/v7\u0026#34;\n\ntype API struct {\n\tes       *elasticsearch.Client\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、创建 ES 客户端，修改 \u003ccode\u003ealertmanager/api/v1/api.go\u003c/code\u003e 文件中 \u003ccode\u003efunc (api *API) Update(cfg *config.Config)\u003c/code\u003e 方法代码，加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e// Create ES client\nif cfg.Global.ESEnable {\n    esClient, err := elasticsearch.NewClient(elasticsearch.Config{\n        Addresses:         cfg.Global.ESAddresses,\n        Username:          cfg.Global.ESUserName,\n        Password:          cfg.Global.ESPassword,\n        DisableRetry:      cfg.Global.ESDisableRetry,\n        MaxRetries:        cfg.Global.ESMaxRetries,\n        EnableMetrics:     cfg.Global.ESEnableMetrics,\n        EnableDebugLogger: cfg.Global.ESEnableDebugLogger,\n    })\n    if err != nil {\n        level.Error(api.logger).Log(\u0026#34;msg\u0026#34;, \u0026#34;Create ES client error\u0026#34;, \u0026#34;err\u0026#34;, err)\n    } else {\n        // Ping\n        _, pingError := esClient.Ping()\n        if pingError == nil {\n            api.es = esClient\n        } else {\n            level.Error(api.logger).Log(\u0026#34;msg\u0026#34;, \u0026#34;Ping ES service error\u0026#34;, \u0026#34;err\u0026#34;, pingError)\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、由于 AlertManager 报警信息的数据格式的键值均为字符串，而实际的报警数据中，经常会用到数值类型，比如内存使用率，CPU 使用率，请求次数等等，考虑到以字符串表示的数值在 ES 中将会被当做字符串存储，无法进行某些统计，比如百分位数的计算。我们需要将以字符串表示的数值类型数据转为数值类型。\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003ealertmanager/api\u003c/code\u003e 目录下创建 \u003ccode\u003ees\u003c/code\u003e 目录，在其中创建 \u003ccode\u003ealert.go\u003c/code\u003e 文件，内容如下：（为了 v1 和 v2 版本代码均可引用此部分代码）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage es\n\nimport (\n\t\u0026#34;fmt\u0026#34;\n\t\u0026#34;strconv\u0026#34;\n\t\u0026#34;time\u0026#34;\n\n\t\u0026#34;github.com/prometheus/alertmanager/types\u0026#34;\n\t\u0026#34;github.com/prometheus/common/model\u0026#34;\n)\n\ntype LabelValue interface{}\n\ntype LabelSet map[model.LabelName]LabelValue // 此处使用 Prometheus 中报警的 LabelSet 的键类型，不要使用 string 类型或自定义 string 类型，否则要进行非常麻烦的类型转换\n\nconst (\n\tlabelNameValue model.LabelName = \u0026#34;value\u0026#34; // 在我们的报警中，数值类型的键名统一为：value，值为 CPU 使用率，内存使用率，请求数量等等\n)\n\n// for ES number type index\ntype Alert struct {\n\t// 使用自定义的 LabelSet 类型\n\tLabels LabelSet \u003cspan class=\"sb\"\u003e`json:\u0026#34;labels\u0026#34;`\u003c/span\u003e \n\n\t// Extra key/value information which does not define alert identity.\n\tAnnotations model.LabelSet \u003cspan class=\"sb\"\u003e`json:\u0026#34;annotations\u0026#34;`\u003c/span\u003e\n\n\t// The known time range for this alert. Both ends are optional.\n\tStartsAt     time.Time \u003cspan class=\"sb\"\u003e`json:\u0026#34;startsAt,omitempty\u0026#34;`\u003c/span\u003e\n\tEndsAt       time.Time \u003cspan class=\"sb\"\u003e`json:\u0026#34;endsAt,omitempty\u0026#34;`\u003c/span\u003e\n\tGeneratorURL string    \u003cspan class=\"sb\"\u003e`json:\u0026#34;generatorURL\u0026#34;`\u003c/span\u003e\n\n\t// The authoritative timestamp.\n\tUpdatedAt time.Time\n\tTimeout   bool\n}\n\nfunc Convert(alert *types.Alert) *Alert {\n\tesAlert := new(Alert)\n\n\tesAlert.EndsAt = alert.EndsAt\n\tesAlert.StartsAt = alert.StartsAt\n\tesAlert.Annotations = alert.Annotations\n\tesAlert.GeneratorURL = alert.GeneratorURL\n\tesAlert.Timeout = alert.Timeout\n\tesAlert.UpdatedAt = alert.UpdatedAt\n\tesls := make(LabelSet)\n\t// 注意，此处不能使用反射将所有字符串数值都转换为数值类型，各个不同的报警中可能有相同的键名，而值的类型不同，可能是字符串，可能是字符串数值，如果转换过去了，向 ES 中创建索引时，就会因为类型而出现错误\n\tfor k, v := range alert.Labels {\n\t\tif k == labelNameValue { // 处理数值类型\n\t\t\tresult, err = strconv.ParseFloat(fmt.Sprintf(\u0026#34;%s\u0026#34;, v), 32)\n\t\t\tif err != nil {\n\t\t\t    esls[k] = v\n\t\t\t} else {\n\t\t\t    esls[k] = result\n\t\t\t}\n\t\t} else {\n\t\t\tesls[k] = v\n\t\t}\n\t}\n\tesAlert.Labels = esls\n\n\treturn esAlert\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、编写代码向 ES 中插入数据，有两种方式可以实现，一种是常规的一条一条地插入数据，另一种是批量插入数据，向 \u003ccode\u003ealertmanager/api/v1/api.go\u003c/code\u003e 中添加如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport (\n    uuid \u0026#34;github.com/satori/go.uuid\u0026#34;\n    \u0026#34;github.com/elastic/go-elasticsearch/v7/esapi\u0026#34;\n)\n\n// 一条一条地插入数据\nfunc (api *API) Insert(alerts ...*types.Alert) error {\n\tvar total int\n\tfor _, alert := range alerts {\n\t\tesAlert := es.Convert(alert)\n\t\tdataInBytes, err := json.Marshal(esAlert)\n\t\tif err != nil {\n\t\t\ttotal = total + 1\n\t\t\tlevel.Error(api.logger).Log(\u0026#34;msg\u0026#34;, \u0026#34;Marshal alerts to string error\u0026#34;, \u0026#34;err\u0026#34;, err)\n\t\t\tcontinue\n\t\t}\n\t\treq := esapi.IndexRequest{\n\t\t\tIndex:      api.config.Global.ESIndexName,\n\t\t\tDocumentID: uuid.NewV4().String(),       // 使用 UUID 作为文档 ID\n\t\t\tBody:       strings.NewReader(string(dataInBytes)),\n\t\t\tRefresh:    api.config.Global.ESIndexRefresh,\n\t\t}\n\n\t\t_, err = req.Do(context.Background(), api.es)\n\t\tif err != nil {\n\t\t\ttotal = total + 1\n\t\t\tlevel.Error(api.logger).Log(\u0026#34;msg\u0026#34;, \u0026#34;Insert alerts to ES error\u0026#34;, \u0026#34;err\u0026#34;, err)\n\t\t\tcontinue\n\t\t}\n\t}\n\n\tif total \u0026gt; 0 {\n\t\treturn level.Error(api.logger).Log(\u0026#34;msg\u0026#34;, \u0026#34;There are several errors\u0026#34;, \u0026#34;total\u0026#34;, total)\n\t}\n\n\treturn nil\n}\n\n// 批量插入数据\nfunc (api *API) Batch(alerts ...*types.Alert) error {\n\tvar buf bytes.Buffer\n\tfor _, alert := range alerts {\n\t    // 将 AlertManager 的报警格式转化为 ES 需要的报警格式，差别在于数值类型数据的处理\n\t\tesAlert := es.Convert(alert)\n\n\t\tmetadata := []byte(fmt.Sprintf(`{ \u0026#34;index\u0026#34; : { \u0026#34;_id\u0026#34; : \u0026#34;%s\u0026#34; } }%s`, uuid.NewV4().String(), \u0026#34;\\n\u0026#34;))\n\t\tdata, err := json.Marshal(esAlert)\n\t\tif err != nil {\n\t\t\tlevel.Error(api.logger).Log(\u0026#34;msg\u0026#34;, \u0026#34;Marshal ESAlerts to string error\u0026#34;, \u0026#34;err\u0026#34;, err)\n\t\t\tcontinue\n\t\t}\n\n\t\tdata = append(data, \u0026#34;\\n\u0026#34;...)\n\t\tbuf.Grow(len(metadata) + len(data))\n\t\tbuf.Write(metadata)\n\t\tbuf.Write(data)\n\t}\n\n\t_, err := api.es.Bulk(bytes.NewReader(buf.Bytes()), api.es.Bulk.WithIndex(api.config.Global.ESIndexName), api.es.Bulk.WithRefresh(api.config.Global.ESIndexRefresh))\n\tif err != nil {\n\t\tlevel.Error(api.logger).Log(\u0026#34;msg\u0026#34;, \u0026#34;doing ES Bulk API error\u0026#34;, \u0026#34;err\u0026#34;, err)\n\t\treturn err\n\t}\n\n\treturn nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e建议使用批量插入数据的方式，在我们的测试中，插入 1000 条数据，一条一条插入需要使用 197.13s，而使用批量插入仅需要 1.97s。\u003c/p\u003e\n\u003cp\u003e6、将 AlertManager 接收到的报警数据存储到 ES 中，修改 \u003ccode\u003ealertmanager/api/v1/api.go\u003c/code\u003e 文件中的方法 \u003ccode\u003efunc (api *API) insertAlerts(w http.ResponseWriter, r *http.Request, alerts ...*types.Alert)\u003c/code\u003e，将代码加到 \u003ccode\u003eapi.alerts.Put(validAlerts...)\u003c/code\u003e 代码块之前\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e// insert alerts to ES\nif api.es != nil {\n    _ = api.Batch(validAlerts...)\n}\n\n// Put 方法用于合并报警到已有的报警之中\nif err := api.alerts.Put(validAlerts...); err != nil {\n    api.respondError(w, apiError{\n        typ: errorInternal,\n        err: err,\n    }, nil)\n    return\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参照以上代码修改 API v2 的代码，由于 AlertManager 代码结构的问题，v1 和 v2 版本的 API 无法共用此部分代码。\u003c/p\u003e\n\u003ch3 id=\"测试\"\u003e测试\u003c/h3\u003e\n\u003cp\u003e编写单元测试进行测试，在文件 \u003ccode\u003ealertmanager/api/v1/api_test.go\u003c/code\u003e 中加入如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc newAPIClient() *API {\n\tapiClient := New(nil, nil, nil, nil, nil, nil)\n\tcfg := \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003econfig.Config{\n\t\tGlobal: \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003econfig.GlobalConfig{\n\t\t\tESEnable:            true,\n\t\t\tESAddresses:         []string{\u0026#34;http://127.0.0.1:9200\u0026#34;},\n\t\t\tESUserName:          \u0026#34;elastics\u0026#34;,\n\t\t\tESPassword:          \u0026#34;AlertManager@2020\u0026#34;,\n\t\t\tESMaxRetries:        3,\n\t\t\tESDisableRetry:      false,\n\t\t\tESEnableMetrics:     true,\n\t\t\tESEnableDebugLogger: true,\n\t\t\tESIndexName:         \u0026#34;alertmanager-alerts\u0026#34;,\n\t\t\tESIndexRefresh:      \u0026#34;true\u0026#34;,\n\t\t},\n\t\tRoute: \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003econfig.Route{\n\t\t\tReceiver:   \u0026#34;test\u0026#34;,\n\t\t\tGroupByAll: false,\n\t\t},\n\t}\n\n\tapiClient.Update(cfg)\n\n\treturn apiClient\n}\n\nfunc generateAlerts() []*types.Alert {\n\tgroups := []string{\u0026#34;A\u0026#34;, \u0026#34;B\u0026#34;, \u0026#34;C\u0026#34;, \u0026#34;D\u0026#34;}\n\tseverities := []string{\u0026#34;critical\u0026#34;, \u0026#34;warning\u0026#34;}\n\talertNames := []string{\u0026#34;the usage rate of container related to kube-admin greater than 80%\u0026#34;, \u0026#34;kafka was down\u0026#34;}\n\n\tvar alerts []*types.Alert\n\n\tfor i := 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003e1000\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003els\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003emodel.LabelSet{\u003c/span\u003e\n\t\t\t\u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLabelName\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eAlertNameLabel\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLabelValue\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ealertNames\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003erand\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eIntn\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003elen\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ealertNames\u003c/span\u003e\u003cspan class=\"err\"\u003e))]),\u003c/span\u003e\n\t\t\t\u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLabelName\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003egroup\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;)\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e              \u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLabelValue\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003egroups\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003erand\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eIntn\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003elen\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003egroups\u003c/span\u003e\u003cspan class=\"err\"\u003e))]),\u003c/span\u003e\n\t\t\t\u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLabelName\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eseverity\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;)\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e           \u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLabelValue\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003eseverities\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003erand\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eIntn\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003elen\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003eseverities\u003c/span\u003e\u003cspan class=\"err\"\u003e))]),\u003c/span\u003e\n\t\t\t\u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLabelName\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003evalue\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;)\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e              \u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eLabelValue\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003efmt\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u0026#34;%.\u003c/span\u003e\u003cspan class=\"na\"\u003e2f\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e \u003cspan class=\"na\"\u003erand\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eFloat32\u003c/span\u003e\u003cspan class=\"err\"\u003e()*\u003c/span\u003e\u003cspan class=\"na\"\u003e100\u003c/span\u003e\u003cspan class=\"err\"\u003e)),\u003c/span\u003e\n\t\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003ealert\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026amp;types.Alert{\u003c/span\u003e\n\t\t\t\u003cspan class=\"na\"\u003eAlert:\u003c/span\u003e \u003cspan class=\"na\"\u003emodel\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eAlert\u003c/span\u003e\u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"na\"\u003eLabels:\u003c/span\u003e      \u003cspan class=\"na\"\u003els\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"na\"\u003eAnnotations:\u003c/span\u003e \u003cspan class=\"na\"\u003enil\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"na\"\u003eStartsAt:\u003c/span\u003e    \u003cspan class=\"na\"\u003etime\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eNow\u003c/span\u003e\u003cspan class=\"err\"\u003e(),\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"na\"\u003eEndsAt:\u003c/span\u003e      \u003cspan class=\"na\"\u003etime\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eNow\u003c/span\u003e\u003cspan class=\"err\"\u003e(),\u003c/span\u003e\n\t\t\t\u003cspan class=\"err\"\u003e},\u003c/span\u003e\n\t\t\t\u003cspan class=\"na\"\u003eTimeout:\u003c/span\u003e   \u003cspan class=\"na\"\u003efalse\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\n\t\t\t\u003cspan class=\"na\"\u003eUpdatedAt:\u003c/span\u003e \u003cspan class=\"na\"\u003etime\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eNow\u003c/span\u003e\u003cspan class=\"err\"\u003e(),\u003c/span\u003e\n\t\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003ealerts \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eappend(alerts,\u003c/span\u003e \u003cspan class=\"na\"\u003ealert\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\n\t\u003cspan class=\"na\"\u003ereturn\u003c/span\u003e \u003cspan class=\"na\"\u003ealerts\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003efunc\u003c/span\u003e \u003cspan class=\"na\"\u003eTestAPI_Insert\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003et\u003c/span\u003e \u003cspan class=\"err\"\u003e*\u003c/span\u003e\u003cspan class=\"na\"\u003etesting\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eT\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003eapiClient\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003enewAPIClient()\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003ealerts\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003egenerateAlerts()\u003c/span\u003e\n\n\t\u003cspan class=\"na\"\u003eerr\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eapiClient.Insert(alerts...)\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003erequire\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eNoError\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003et\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eerr\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"na\"\u003efunc\u003c/span\u003e \u003cspan class=\"na\"\u003eTestAPI_Batch\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003et\u003c/span\u003e \u003cspan class=\"err\"\u003e*\u003c/span\u003e\u003cspan class=\"na\"\u003etesting\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eT\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003eapiClient\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003enewAPIClient()\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003ealerts\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003egenerateAlerts()\u003c/span\u003e\n\n\t\u003cspan class=\"na\"\u003eerr\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eapiClient.Batch(alerts...)\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003erequire\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eNoError\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003et\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eerr\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"总结\"\u003e总结\u003c/h3\u003e\n\u003cp\u003e至此，向 AlertManager 中添加存储报警信息到 ES 中的代码开发就完成了，有两点需要特别注意，一是我们是在 AlertManager 接收到发送来的报警信息时将其报警数据存储到 ES 中的（我们将时机选在了去除空标签及标签合法性验证和合并报警消息之间），不是报警从 AlertManager 发送出去时的报警信息；二是由于 AlertManager 代码本身的问题，我们无法复用一些代码，比如创建 ES 客户端的代码，向 ES 中写数据的代码等。\u003c/p\u003e","date":1583452800,"description":"","fuzzywordcount":3300,"kind":"page","lang":"zh","lastmod":1591401600,"objectID":"9c5d191ae55a33d5a0d76b5526e3cd5f","publishdate":1583452800,"relpermalink":"/posts/devops/alertmanager/alertmanager-elasticsearch/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下将 \u003ccode\u003eAlertManager\u003c/code\u003e 中的报警存储到 \u003ccode\u003eElasticSearch\u003c/code\u003e 中的方法，以便我们使用 \u003ccode\u003eKibana\u003c/code\u003e 等可视化工具将其做成各种图表进行分析。\u003c/p\u003e","tags":["DevOps","AlertManager","ElasticSearch"],"title":"将 AlertManager 的报警存储到 ElasticSearch 中","url":"https://xdhuxc.github.io/posts/devops/alertmanager/alertmanager-elasticsearch/","wordcount":3203},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 ElasticSearch 的安装及配置，密码设置等配置要点。\u003c/p\u003e\n\u003ch3 id=\"安装-elasticsearch\"\u003e安装 ElasticSearch\u003c/h3\u003e\n\u003cp\u003e1、下载 \u003ccode\u003eElasticSearch\u003c/code\u003e 的安装包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.6.1-x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、安装 \u003ccode\u003eElasticSearch\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -ivh elasticsearch-7.6.1-x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 ElasticSearch\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart elasticsearch\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e由于 \u003ccode\u003eElasticSearch\u003c/code\u003e 的密码管理是用 \u003ccode\u003ex-pack\u003c/code\u003e 来实现的，安装时，x-pack 默认是不启用的，需要开启。\u003c/p\u003e\n\u003cp\u003e在配置文件 \u003ccode\u003eelasticsearch.yml\u003c/code\u003e（默认路径为：\u003ccode\u003e/etc/elasticsearch/elasticsearch.yml\u003c/code\u003e） 中增加如下配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003expack.security.enabled: true\nxpack.security.transport.ssl.enabled: true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e假设 \u003ccode\u003e10.20.13.15\u003c/code\u003e 为机器 IP 地址，需要在外部访问时，需要配置如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enetwork.host: 10.20.13.15\nhttp.port: 9200\ndiscovery.seed_hosts: [\u0026#34;10.20.13.15\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改后重启 \u003ccode\u003eElasticSearch\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"设置密码\"\u003e设置密码\u003c/h3\u003e\n\u003cp\u003e进入 ElasticSearch 的二进制文件目录下，使用交互式命令行来设置密码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost /usr/share/elasticsearch/bin]# ./elasticsearch-setup-passwords interactive\nInitiating the setup of passwords for reserved users elastic,apm_system,kibana,logstash_system,beats_system,remote_monitoring_user.\nYou will be prompted to enter passwords as the process progresses.\nPlease confirm that you would like to continue [y/N]y  # 输入 y\n\n\nEnter password for [elastic]:      # 为 elasticsearch 设置密码\nReenter password for [elastic]:    # 再次输入 elasticsearch 的密码\nEnter password for [apm_system]:   # 为 apm 设置密码\nReenter password for [apm_system]: # 再次输入 apm 的密码\nEnter password for [kibana]:       # 为 kibana 设置密码\nReenter password for [kibana]:     # 再次输入 kibana 的密码\nEnter password for [logstash_system]:   # 为 logstash 设置密码\nReenter password for [logstash_system]: # 再次输入 logstash 的密码\nEnter password for [beats_system]:      # 为 beats 设置密码\nReenter password for [beats_system]:    # 再次输入 beats 的密码\nEnter password for [remote_monitoring_user]:   # 为 remote_monitoring_user 设置密码\nReenter password for [remote_monitoring_user]: # 再次输入 remote_monitoring_user 的密码\nChanged password for user [apm_system]\nChanged password for user [kibana]\nChanged password for user [logstash_system]\nChanged password for user [beats_system]\nChanged password for user [remote_monitoring_user]\nChanged password for user [elastic]\n[root@sgt-devops-2-test /usr/share/elasticsearch/bin]# \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者使用 API 来设置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -XPUT -u elastic \u0026#39;http://10.20.13.15:9200/_xpack/security/user/elastic/_password\u0026#39; -d \u0026#39;{\n  \u0026#34;password\u0026#34; : \u0026#34;yourpasswd\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003eElasticSearch\u003c/code\u003e 的默认账户为 \u003ccode\u003eelastic\u003c/code\u003e 默认密码为 \u003ccode\u003echangme\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"可视化\"\u003e可视化\u003c/h3\u003e\n\u003cp\u003e使用 \u003ccode\u003eElasticHQ\u003c/code\u003e 作为 \u003ccode\u003eElasticSearch\u003c/code\u003e 的可视化工具\u003c/p\u003e\n\u003cp\u003e启动 \u003ccode\u003eElasticHQ\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -p 5000:5000 -d elastichq/elasticsearch-hq\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e访问：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://10.20.13.15:5000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下方式连接 \u003ccode\u003eelasticsearch\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://elastic:PASSWORD@10.20.13.15:9200\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参考资料：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/ElasticHQ/elasticsearch-HQ\"\u003ehttps://github.com/ElasticHQ/elasticsearch-HQ\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.elastic.co/guide/en/elasticsearch/plugins/current/index.html\"\u003ehttps://www.elastic.co/guide/en/elasticsearch/plugins/current/index.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://docs.elastichq.org\"\u003ehttp://docs.elastichq.org\u003c/a\u003e\u003c/p\u003e","date":1583193600,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1583193600,"objectID":"b4f5ad765dd592fc6d23ca3d50d0cf2d","publishdate":1583193600,"relpermalink":"/posts/storage/elasticsearch/elasticsearch-install-and-password/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 ElasticSearch 的安装及配置，密码设置等配置要点。\u003c/p\u003e","tags":["ElasticSearch","数据库"],"title":"ElasticSearch 的安装及配置和密码设置等","url":"https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-install-and-password/","wordcount":572},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 \u003ccode\u003eAlertManager\u003c/code\u003e 报警收敛的若干种方法。\u003c/p\u003e\n\u003ch3 id=\"背景\"\u003e背景\u003c/h3\u003e\n\u003cp\u003e当一个监控-告警系统建立起来后，告警系统将会面临这样的问题：警报消息太多，接收人很容易麻木，不再继续理会，关键的告警常常被淹没。\u003c/p\u003e\n\u003cp\u003e对于这一问题，\u003ccode\u003eAlertManger\u003c/code\u003e 提供了非常好的解决方案。\u003ccode\u003ePrometheus\u003c/code\u003e 把一条告警信息发送给了 \u003ccode\u003eAlterManager\u003c/code\u003e，\u003ccode\u003eAlterManager\u003c/code\u003e 并不是简简单单地直接发送出去，而是对告警信息进行了一些诸如分组、延时等收敛处理。\u003c/p\u003e\n\u003cp\u003e对报警收敛的支持，\u003ccode\u003eAlertManager\u003c/code\u003e 提供了以下四种方式：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e分组\u003c/li\u003e\n\u003cli\u003e抑制\u003c/li\u003e\n\u003cli\u003e静默\u003c/li\u003e\n\u003cli\u003e延时\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"告警分组\"\u003e告警分组\u003c/h3\u003e\n\u003cp\u003e告警分组是通过对具有相同属性值的告警进行分组聚合，可以有效的减少告警消息的数量。\u003c/p\u003e\n\u003cp\u003e对应 \u003ccode\u003eAlertManager\u003c/code\u003e 的配置，通过 \u003ccode\u003eroute\u003c/code\u003e 部分的 \u003ccode\u003egroup_by\u003c/code\u003e 字段对具有相同属性的告警进行分组聚合。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eroute:\n  # AlertManager 将会把具有相同 alertname 的告警分到相同的组  \n  group_by: [\u0026#39;alertname\u0026#39;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"告警抑制\"\u003e告警抑制\u003c/h3\u003e\n\u003cp\u003e当告警发出后，停止重复发送由此告警引发的其他告警。一般是由更高级别的告警抑制低级别的告警。这可以消除冗余的告警，仅发送关键警报，避免误导运维排查问题的方向。\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003eAlertManager\u003c/code\u003e 的配置中，通过 \u003ccode\u003einhibit_rules\u003c/code\u003e 部分来配置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003einhibit_rules:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e source_match:        # source_match：匹配当前告警发生后其他告警抑制掉\n      severity: \u0026#39;critical\u0026#39;\n    target_match:        # target_match：抑制告警\n      severity: \u0026#39;warning\u0026#39;\n    equal: [\u0026#39;alertname\u0026#39;] # equal：只有包含指定标签才可成立规则\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上配置告诉 \u003ccode\u003eAlertManager\u003c/code\u003e，对于具有相同 \u003ccode\u003ealertname\u003c/code\u003e 的告警，含 \u003ccode\u003eseverity: 'critical'\u003c/code\u003e 标签的告警将会抑制含 \u003ccode\u003eseverity: 'warning'\u003c/code\u003e 标签的告警。\u003c/p\u003e\n\u003ch3 id=\"告警静默\"\u003e告警静默\u003c/h3\u003e\n\u003cp\u003e对可预期的告警，在特定时间段阻止告警的发送，比如，线上环境资源调整或上线，可能会导致告警，此时，可以增加告警静默，阻止相关的告警发送。\u003c/p\u003e\n\u003cp\u003e可以在 \u003ccode\u003ehttp://localhost:9093/#/silences\u003c/code\u003e 中进行创建。\u003c/p\u003e\n\u003ch3 id=\"告警延时\"\u003e告警延时\u003c/h3\u003e\n\u003cp\u003e当故障发生时，若故障未能及时解决，频繁地发送告警是令人崩溃的。\u003ccode\u003egroup_wait\u003c/code\u003e 把开始产生的告警收集起来，最后作为一条告警信息发送出来，\u003ccode\u003erepeat_interval\u003c/code\u003e 可以将重复的告警以更大的时间间隔发送。\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003eAlertManager\u003c/code\u003e 的配置中进行如下配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eroute:\n  group_wait: 60s       # 分组等待的时间为 60 秒，收到告警后并不是马上发送出去，看是否还有具有 alertname 这个标签的报警发过来，如果有的话，一起发出报警\n  group_interval: 60s   # 上一组报警与下一组报警的间隔时间为 60 秒\n  repeat_interval: 15m  # 重复报警时间\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"其他方式\"\u003e其他方式\u003c/h3\u003e\n\u003cp\u003e我们也可以考虑把告警信息都收集起来，做统计分析，基于统计数据按周、月生成告警报告，比如，哪些应用在哪段时间里产生了最多的报警，哪些指标在哪段时间里产生了最多的报警，某个报警阈值的 90% 分位数、95%分位数、99%分位数，哪个部门产生了最多的报警数等等。一来要求业务团队改造程序或结构，调整资源配置，比如有些代码写得性能特别差，资源占用高，导致告警信息频繁发送；二来可以作为我们设置各种资源阈值的统计参考数据，取代常用的经验值或习惯值，比如，根据历史报警数据的统计，采取百分位数，使得某告警在 \u003ccode\u003e95%\u003c/code\u003e 的情况下不再发送告警信息。\u003c/p\u003e\n\u003ch3 id=\"总结和思考\"\u003e总结和思考\u003c/h3\u003e\n\u003cp\u003e做好告警的收敛是很有必要的，也有多种方法。借助于 \u003ccode\u003eAlertManager\u003c/code\u003e，我们可以通过分组、抑制、静默和延时等方法来做告警的收敛。\u003c/p\u003e\n\u003cp\u003e就 \u003ccode\u003eAlertManager\u003c/code\u003e 而言，在告警抑制上，我们还可以考虑更多的告警抑制规则，比如，在多种告警级别（\u003ccode\u003ecritical\u003c/code\u003e、\u003ccode\u003eemergency\u003c/code\u003e、\u003ccode\u003ewarning\u003c/code\u003e等）的情况下，每一种高级别告警抑制所有比它低的级别的告警；在告警延时上，高级别告警的延时参数缩短，低级别告警的延时参数增长。\u003c/p\u003e\n\u003cp\u003e另外，基于统计数据按周、月生成告警报告，改进应用程序和架构，合理设置阈值，更好和更准确地报警。\u003c/p\u003e\n\u003cp\u003e考虑这样一种设计，我们想把 \u003ccode\u003eAlertManager\u003c/code\u003e 发送的报警收集起来，那么，由于 \u003ccode\u003eAlertManager\u003c/code\u003e 会把从 \u003ccode\u003ePrometheus\u003c/code\u003e 发送来的报警信息进行分组聚合，抑制等操作，从而导致实际产生的报警一般会多于发送出来的报警。如果我们想把 \u003ccode\u003eAlertManager\u003c/code\u003e 的报警信息收集起来，那么，我们是应该在 \u003ccode\u003eAlertManager\u003c/code\u003e 接收到报警的时候收集，还是在真正发送报警之前进行收集？\u003c/p\u003e\n\u003cp\u003e如果是在接收到报警时收集，那么我们实际上会收集到所有产生的报警，数据量大，信息详尽。如果使用这些进行分析，进而改进代码、程序架构和资源配置，那么，将会从上游彻底地减少报警，并且促进整个研发运维的进步和系统的稳定性。\u003c/p\u003e\n\u003cp\u003e如果是在实际发送时收集，那么我们收集到的数据量就会比较小，报警是经过聚合的，被抑制的报警不发送，经过分析优化后，将会使得接收到的报警数量减少，但是产生的报警（按原来的标准，这种情况下会产生报警）却可能增多，比如在不做上游改变的情况下，调整阈值，使得 \u003ccode\u003e99%\u003c/code\u003e 的报警不发送，问题则会堆积在 \u003ccode\u003ePrometheus\u003c/code\u003e 那边，不会向 \u003ccode\u003eAlertManager\u003c/code\u003e 发送报警。\u003c/p\u003e\n\u003cp\u003e根据以上分析，我们选择在 \u003ccode\u003eAlertManager\u003c/code\u003e 接收到报警时即收集之。\u003c/p\u003e","date":1582761600,"description":"","fuzzywordcount":1800,"kind":"page","lang":"zh","lastmod":1582761600,"objectID":"b648e66195dac9137a8a3d3a46395a12","publishdate":1582761600,"relpermalink":"/posts/devops/alertmanager/alertmanager-alerts-convergence/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 \u003ccode\u003eAlertManager\u003c/code\u003e 报警收敛的若干种方法。\u003c/p\u003e","tags":["DevOps","AlertManager"],"title":"AlertManager 报警收敛的若干种方法","url":"https://xdhuxc.github.io/posts/devops/alertmanager/alertmanager-alerts-convergence/","wordcount":1794},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了使用 aws-cli 来操作 S3 桶的用法，尽管 AWS 有非常详尽的文档，但我们记录下来后，下次就可以直接复制使用了。\u003c/p\u003e\n\u003ch3 id=\"安装-aws-cli-和配置认证信息\"\u003e安装 aws-cli 和配置认证信息\u003c/h3\u003e\n\u003cp\u003e1）安装 aws-cli\n使用 \u003ccode\u003epip\u003c/code\u003e 安装 \u003ccode\u003eaws-cli\u003c/code\u003e，命令如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epip install -y awscli\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）配置认证信息\n执行 \u003ccode\u003eaws\u003c/code\u003e 命令前，需要在 \u003ccode\u003e~/.aws/credentials\u003c/code\u003e 中配置访问 \u003ccode\u003eAWS\u003c/code\u003e 的 \u003ccode\u003eAccess Key\u003c/code\u003e 和 \u003ccode\u003eSecret Key\u003c/code\u003e，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[default]\naws_access_key_id = ${aws_access_key_id}\naws_secret_access_key = ${aws_access_key_id}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 ~/.aws/config 中配置区域，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[default]\nregion = ap-southeast-1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，需要给该 \u003ccode\u003eAccess Key\u003c/code\u003e 赋予访问要访问资源的权限。\u003c/p\u003e\n\u003ch3 id=\"使用-aws-cli-操作-s3\"\u003e使用 AWS-CLI 操作 S3\u003c/h3\u003e\n\u003cp\u003e1、从一个桶里复制目录到另外一个桶里的目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 将 S3 桶 bucket1 中的所有对象复制到 S3 桶 expire.backup.xdhuxc 的 bucket1 目录下\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eaws s3 cp s3://bucket1/ s3://expire.backup.xdhuxc/bucket1/ --recursive 2\u0026gt;./copys3_bucket1_error.log 1\u0026gt;/dev/null\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e由于复制的对象中包含目录，需要使用 \u003ccode\u003e--recursive\u003c/code\u003e 进行递归复制；在测试时，还可以使用 \u003ccode\u003e--dryrun\u003c/code\u003e 参数，只展示输出结果，不实际执行。另外，我们将错误日记记录下来，舍弃标准输出。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003eAWS CLI S3 复制对象命令\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.aws.amazon.com/cli/latest/reference/s3/cp.html\"\u003ehttps://docs.aws.amazon.com/cli/latest/reference/s3/cp.html\u003c/a\u003e\u003c/p\u003e","date":1574294400,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1574294400,"objectID":"c850c8c43d922d788b76f580bc01d871","publishdate":1574294400,"relpermalink":"/posts/tools/tools-aws-s3/","section":"posts","summary":"\u003cp\u003e本篇博客记录了使用 aws-cli 来操作 S3 桶的用法，尽管 AWS 有非常详尽的文档，但我们记录下来后，下次就可以直接复制使用了。\u003c/p\u003e","tags":["AWS","S3","CLI"],"title":"aws-cli S3 命令行工具使用","url":"https://xdhuxc.github.io/posts/tools/tools-aws-s3/","wordcount":329},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下使用 Vue 和 Element-UI 进行开发时需要注意的一些事项。\u003c/p\u003e\n\u003ch3 id=\"开发建议\"\u003e开发建议\u003c/h3\u003e\n\u003cp\u003e1、对于按钮，一般使用 type='primary'，该类型按钮大小固定，且为亮丽的蓝色，与默认的白色按钮相比，可以丰富页面色彩，更加漂亮。\u003c/p\u003e\n\u003cp\u003e2、固定部分表格的列，对于含有多个相同元素的表格单元格，比如多个按钮，固定该单元格的长度，使其横向或纵向排开，避免被 element-ui 自动计算导致的挤压。\u003c/p\u003e\n\u003cp\u003e3、对于表格中含有过长文本的列，使用 :show-overflow-tooltip=\u0026quot;true\u0026quot; 隐藏部分文本，否则会撑大单元格，导致整个表格被撑大，非常不美观。\u003c/p\u003e\n\u003cp\u003e4、对于表示时间的列，比如创建时间或更新时间，使用类似 scope.row.update_time | parseTime('{y}-{m}-{d} {h}:{i}:{s}') 的方式格式化，然后设置列宽度为 150px，以避免该列被撑大。\u003c/p\u003e\n\u003cp\u003e5、对于 el-table 组件，如果指定了每一列的长度，那么当页面拉长时，就会导致表格列前后多出空框，因此需要保证至少有一列的长度不是指定的。\u003c/p\u003e\n\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e1、如果要为 \u003ccode\u003eel-select\u003c/code\u003e 绑定默认值，需要注意，其 \u003ccode\u003ev-model\u003c/code\u003e 绑定的是字符值，不能绑定对象类型。如果绑定了对象类型，\u003ccode\u003ekey-label-value\u003c/code\u003e 部分正常的话，可是正常使用，但是实现不了默认值效果。\u003c/p\u003e","date":1573171200,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1573171200,"objectID":"16e96dcbd99246f73c904527adb4eef4","publishdate":1573171200,"relpermalink":"/posts/vue/vue-develope-standard/","section":"posts","summary":"\u003cp\u003e本篇博客记录下使用 Vue 和 Element-UI 进行开发时需要注意的一些事项。\u003c/p\u003e","tags":["Vue","Element-UI"],"title":"Vue Element-UI 开发注意事项","url":"https://xdhuxc.github.io/posts/vue/vue-develope-standard/","wordcount":436},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了使用 golang 操作单点 redis 时的一些示例代码，可以经过改造应用到程序中去。\u003c/p\u003e\n\u003cp\u003e我们基于 golang-redis 这个库封装了一些函数，作为代码示例，也方便使用。\u003c/p\u003e\n\u003ch3 id=\"创建-redis-客户端\"\u003e创建 Redis 客户端\u003c/h3\u003e\n\u003cp\u003e使用以下代码创建一个 Redis 客户端，需要提供 redis 的地址（IP:Port），密码和数据库索引\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc NewRedisClient(address string, password string, index int) (*redis.Client, error) {\n\tclient := redis.NewClient(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eredis.Options{\n\t\tAddr:     address,\n\t\tPassword: password,\n\t\tDB:       index,\n\t})\n\n\treturn client, client.Ping().Err()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"创建键值对\"\u003e创建键值对\u003c/h3\u003e\n\u003cp\u003e创建永不过期的 key-value\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc Set(client *redis.Client, key string, value string) error {\n\treturn client.Set(key, value, 0).Err()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建含过期时间的 key-value\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc SetWithDuration(client *redis.Client, key string, value string, duration time.Duration) error {\n\treturn client.Set(key, value, duration).Err()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e对于 redis，创建和更新的操作效果一样\u003c/p\u003e\n\u003ch3 id=\"删除键值对\"\u003e删除键值对\u003c/h3\u003e\n\u003cp\u003e删除一个 key-value\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc Delete(client *redis.Client, key string) error {\n\treturn  client.Del(key).Err()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e删除一组 key-value\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc DeleteKeys(client *redis.Client, keys ...string) error {\n\treturn client.Del(keys...).Err()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"删除数据库\"\u003e删除数据库\u003c/h3\u003e\n\u003cp\u003e删除 redis 数据库所有数据，使用异步删除，主线程会把删除任务交给异步线程来完成删除任务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc DeleteDB(client *redis.Client) error {\n\treturn client.FlushAllAsync().Err()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e删除当前 redis 数据库，如果想要删除其他的 redis 数据库，需要构造 map 存储各个 redis 数据库的客户端，想删除指定的数据库时，取出其客户端即可\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc DeleteCurrentDB(client *redis.Client) error {\n\treturn client.FlushDBAsync().Err()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"查询键值数据\"\u003e查询键值数据\u003c/h3\u003e\n\u003cp\u003e获取 key-value\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc Get(client *redis.Client, key string) (string, error) {\n\treturn client.Get(key).Result()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e模糊查询 key，此操作有危险性，在数据量大时非常消耗性能\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc GetByKeyName(client *redis.Client, key string) ([]string, error) {\n\tvar values []string\n\terr := client.Keys(fmt.Sprintf(\u0026#34;*%s*\u0026#34;, key)).ScanSlice(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003evalues)\n\tif err != nil {\n\t\treturn values, err\n\t}\n\n\treturn values, nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e模糊查询 value，获取所有的 key，然后根据 key 获取 value，再进行筛选，返回由 key-value 组成的 map，此操作会有性能问题，可作为开发和测试环境使用，绝对不能应用于生产环境。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc GetByValue(client *redis.Client, value string) (map[string]string, error) {\n\tvar keys []string\n\n\terr := client.Keys(\u0026#34;*\u0026#34;).ScanSlice(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003ekeys)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\tresult := make(map[string]string)\n\tfor _, k := range keys {\n\t\tv, err := client.Get(k).Result()\n\t\tif err != nil {\n\t\t\tcontinue\n\t\t}\n\t\tif strings.Contains(v, value) {\n\t\t\tresult[k] = v\n\n\t\t}\n\t}\n\n\treturn result, nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e官方 Github 仓库地址\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/go-redis/redis\"\u003ehttps://github.com/go-redis/redis\u003c/a\u003e\u003c/p\u003e","date":1572739200,"description":"","fuzzywordcount":700,"kind":"page","lang":"zh","lastmod":1572739200,"objectID":"e0c44f6e14cf520de861bbb05b507494","publishdate":1572739200,"relpermalink":"/posts/programming/golang/golang-redis/","section":"posts","summary":"\u003cp\u003e本篇博客记录了使用 golang 操作单点 redis 时的一些示例代码，可以经过改造应用到程序中去。\u003c/p\u003e","tags":["Golang","Redis"],"title":"golang 操作单点 Redis 代码示例","url":"https://xdhuxc.github.io/posts/programming/golang/golang-redis/","wordcount":656},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了使用 golang 进行数值处理时可能会用到的一些代码。\u003c/p\u003e\n\u003cp\u003e使用 strconv 包中的方法来进行字符串到数值的转换，math 包封装了常用的基本函数。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport (\n\t\u0026#34;fmt\u0026#34;\n\t\u0026#34;math\u0026#34;\n\t\u0026#34;strconv\u0026#34;\n)\n\nfunc main() {\n\t// 计算 2 的 5 次方\n\tfmt.Println(math.Pow(2, 5))\n\tpercent := \u0026#34;23.456\u0026#34;\n\t\n\t// 使用 strconv 包的 ParseFloat 方法将字符串转换为 float64\n\tresult, _ := strconv.ParseFloat(percent, 32)\n\t// 使用 fmt 包的 Sprintf 方法实现保留小数点后两位\n\tfmt.Println(fmt.Sprintf(\u0026#34;%.2f\u0026#34;, result))\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1572739200,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1572739200,"objectID":"f53441ef302c2b13c7c524b0880b0202","publishdate":1572739200,"relpermalink":"/posts/programming/golang/golang-number/","section":"posts","summary":"\u003cp\u003e本篇博客记录了使用 golang 进行数值处理时可能会用到的一些代码。\u003c/p\u003e","tags":["Golang","String2Number"],"title":"golang 数值处理","url":"https://xdhuxc.github.io/posts/programming/golang/golang-number/","wordcount":147},{"categories":"posts","content":"\u003cp\u003e        华为被美国列入“实体名单”后，已经七十多岁、一向低调不见记者的任正非先生出面，主动召开记者会，谈了很多事情，后来又见了一些国内外的记者，说了一些问题。一向低调、不接受采访的任正非先生主动召开记者会，这说明这件事情对华为来说非常严重，即使不是像中兴那样事关生死存亡，也是非常严重的事情。这可能是两方面的考虑，一方面是华为公司的士气和信心，需要由精神核心人物来稳定和提振，其他角色的人已经起不到这样的作用了；另一方面，是对社会关切的回应和对我们国家技术领域的回应，华为有信心、有能力应对美国的制裁。中兴事件发生后，整个社会对于我国自主技术的信心一落千丈，这种回应对内对外都是非常必要和及时的。\u003c/p\u003e\n\u003cp\u003e　　任正非先生的公开讲话，很多人都看了，但有些人是直接理解语义，这让我感到有些奇怪，这些话恐怕不是表面上的那些意思吧！\u003c/p\u003e\n\u003cp\u003e　　有些事情很精彩，任正非先生在用一种战略的方式和美国作斗争。\u003c/p\u003e\n\u003cp\u003e　　华为每年向美国公司购买上百亿美元的产品和服务，即使自己设计和生产的有些芯片优于美国产品，也要坚持购买。这对华为来说，将会带来两个方面的重大好处，一方面，目前美国企业的芯片设计和软件技术依然是最先进的，在国内和世界其他地区和国家没有可以和华为比肩的产品的情况下，购买过来的美国产品既可以用于华为自己的产品，同时也可以用来学习，仿制和寻找差距，为自己产品的发展提供支持；另一方面，这上百亿美元的产品和服务将会为美国很多高科技企业贡献收入从而其利润，若有不测，就像目前的情况，这些公司将会处在华为和美国政府之间，在微弱意义上，将会成为华为在美国的“代言人”。毕竟，对于商业公司来说，损失的可是真金白银啊，大多数商人和股东可不会在乎其他的东西，等于是将美国公司的经济利益主动捆绑在华为身上。而且，美国的高科技公司大多是上市公司，若有不测，股票价格就会下跌，效果将会非常显著。此处需要说明，这样的操作需要战略思考及其能力，强大的组织及其能力，巨大的体量和资金流动，才能运转得过来，也才可能取胜。不是什么个人和（或）组织都可以作自己的B计划的，也需要具备前述条件，B计划才会真正有价值。\u003c/p\u003e\n\u003cp\u003e　　至于华为推出的“鸿蒙”操作系统，所有人都说生态是最重要的问题，但其实，这个问题的考虑点可能在其他方面。剔除操作系统和应用软件本身的技术方面问题，我们关注下面这些方面，一、一旦华为正式在手机上推出其“鸿蒙”操作系统，从民族情绪和商业公司的角度来看，国内其他手机厂商和应用厂商必须主动或被动支持和适配“鸿蒙”操作系统，否则就可能陷入对内被政府怀疑、被民众唾弃，对外被美国封禁的灭亡境况。以中国手机厂商在整个全球范围内的手机销量占比和日常应用数量占比，加之国内众多的开发者和商业软件的成熟，中长期来看，“鸿蒙”操作系统及其生态将肯定会发展起来的，生态也不会是太大的问题。二、华为必须考虑小米、OV、中兴等其他手机厂商和其他业务关联公司的发展考虑，自己以什么样的方式做哪些，不做哪些，必须明文承若且绝对遵守，否则很难说会发生什么（有一则新闻说，小米和OV等手机厂商准备共同做一种可以在不同品牌手机之间传输文件的功能，可能会预置到手机上，但这个联盟中却没有华为）。生态的核心是什么，自己搭舞台，让别人来表演，用户来观看付费，就是说，自己做基础的承载平台，让别人做上层的面向用户的应用，让别人先于自己赚到钱，否则，生态肯定是发展不起来的（最为经典的反面案例就是百度云盘等，正面案例就是淘宝、微信、“快抖”和苹果商店等）。华为现在的业务产品在横向和（或）纵向地向各个方向扩展，很容易树敌太多导致其他公司表面友好或沉默，实际不合作，从而造成自己的孤立。这是很危险的，其他类型的企业可以在垄断的情况下孤立存在，但是互联网相关的企业绝对不可以、也不可能孤立存在，互联网本身的特性就决定了这一点。我们相信以任正非先生的战略思考能力，应该是不会让这样的事情发生的。三、google 禁止华为使用其系统和产品及服务，这将导致华为的海外用户将无法使用google的服务，从而海外用户购买华为手机的意愿肯定会降低，对其海外业务将会造成挫折。如果“鸿蒙”操作系统及其生态逐步发展起来，对于google 来说，其业务将可能会遭受损失。伴随着Android操作系统的替代，国内的应用软件也将获得随着“鸿蒙”操作系统出海的先机（对于普通用户来说，内置的软件往往就成了某个方面的默认应用），从而为我国的应用软件向国际市场发展提供助力，google和其他美国公司的应用和服务会怎么样呢，我们可以拭目以待。\u003c/p\u003e\n\u003cp\u003e　　在最近的一次记者采访中，任正非先生表示，华为将把自己在5G领域的专利毫无保留地一次性卖给美国公司，换句话说，美国政府禁止美国企业买东西给华为，斩断了华为和美国公司之间的直接经济利益关系。但是反过来，现在华为有东西可以卖给美国公司，将两者之间的直接经济利益关系再次连接起来。通过卖5G相关专利给美国公司，华为一方面可以得到收入，同时也打进了美国市场，扩大了华为的影响力和标准话语权，因为卖技术专利的同时，也是在输出标准，一旦使用了华为的专利，也非常可能在关联方面依赖于华为。一句话，又一次主动将美国公司的经济利益捆绑到华为这边来，毕竟大多数商人和股东是不会在乎其他东西的。\u003c/p\u003e\n\u003cp\u003e　　另外，华为也放出风来，自己已经启动了6G的研究。这也是高明的斗争策略。以华为、中兴和中国移动等为代表的中国公司目前显然已经在5G的标准制定和应用中走在了国际前列。但5G还没有进入全面商用，现在处于渐次铺开，前途大好的状况。这样宣布造成的结果可能是，欧美日韩看到在5G的标准制定中自己已经不占优势，就可能会放弃5G的进一步研究和发展，仅仅通过中国的技术来做5G应用（钱还是要赚的），转而投入资源去发展6G，希望在6G的标准制定中有自己的一席之地。但是，4G主要应用在智能手机带来的个人用户消费中，已经基本满足个人用户的需求，5G将主要应用在工农业等生产活动中，对于个人用户不会有显著的体验提升，那么6G呢，技术难度和标准肯定比5G更高，从而投入的人力和财力更多，研发难度更大，如果没有商业场景供其应用从而获得收入，这项研究就可能会把很多公司和研究机构给拖死。如果欧美日韩放弃或动摇5G进一步的研究和发展而转向6G，对于我国企业来说，将会获得一个更大的时间窗口期，可以扩大我们的优势。\u003c/p\u003e\n\u003cp\u003e　　至于为什么会存在这种可能的情况呢，因为就像很多人简单分析的那样，从1G、2G到3G、4G，再到5G，一路发展过来，国家层面的行业兴衰，通信科技巨头的交椅变换，社会生活和生产的急剧变化，让很多人以为这种趋势会不断延续下去，但情况是会变化的，就连技术本身的发展也并非总是线性的。在我们上大二时，有位教授网络的老师说，“网络带宽啊，能够供大家看部小电影，就足够了”。这句话让我感到很有趣，我原来没有注意这个问题，但老师说得是对的。有些事物，当其数量或（和）质量增长到某个阈值后，其继续增长带来的变化，对于个人来说，在这个方向上，已经没有实际使用的意义了。但有意思的是，当人们去观察这个事物时，往往还停留在那个阈值之前的发展过程中观察，得出一些乱七八糟的结论。一个很典型的例子就是是网络带宽，对于网络带宽，如果某个时空域中的网络带宽足够其中的所有人看清晰度最高的视频，那么网络带宽的继续增加对于这些人而言就没有丝毫实际使用的意义（对于很多个体的人和（或）组织来讲，装逼的意义可以附加在任何事物上，只要他们自己喜欢这么做）。我们姑且称之为“大跃定理”吧。所以，5G对于个人用户的直接使用，相比于现在广泛使用的4G网络，有多大的实际提升价值呢？我们拭目以待吧。\u003c/p\u003e\n\u003cp\u003e　　任正非先生的谈话、态度、思想、战略、宣传、组织、管理等诸多方面，都能看到毛主席的影子，“学毛著标兵”确实名副其实。与此形成鲜明对比的是那些学习所谓“成功学”的人，是多么地愚蠢和可笑！\u003c/p\u003e\n\u003cp\u003e　　在这事情发生时，社会上有各种各样的言论冒出来，能够客观公正看待问题的人较少，情绪化看待的人比较多，有些人甚至连“买国货就是爱国”背后的道理都搞不明白，有人居然把这句话给变成了“爱国就是买国货”，这逻辑水平也是够让人瞠目结舌的了。有意思的是，美国的制裁在全世界范围内给华为做了免费的广告，效应极其强大（美国政府和美国总统的广告效应无人能比，更不要说那些明星），极大地改变了智能手机厂商销售市场的份额占比。在国内市场，大量的中国人通过购买华为手机来支持华为，华为在智能手机销售市场的占比进一步提升，小米和苹果的市场占比下滑比较明显。如果这是一个市场化的过程，不夹杂民族情绪的话，应该不会这么快。\u003c/p\u003e\n\u003cp\u003e　　我们也衷心祝愿华为取得更好的发展，为我们国家的科学和技术，为全人类的发展作出更大的贡献！\u003c/p\u003e","date":1572739200,"description":"","fuzzywordcount":3600,"kind":"page","lang":"zh","lastmod":1572739200,"objectID":"abc3f7c7b69f7e2609d793026a1c7306","publishdate":1572739200,"relpermalink":"/posts/human/human-world-mixed-five/","section":"posts","summary":"","tags":["人间世"],"title":"人间世·杂五","url":"https://xdhuxc.github.io/posts/human/human-world-mixed-five/","wordcount":3525},{"categories":"posts","content":"\u003cp\u003e使用 golang 操作 excel 表格，写了些示例代码，封装了几个常用的函数，特此记录，以备后查。\u003c/p\u003e\n\u003cp\u003e使用 excelize 库 来进行 excel 的操作，项目地址为：https://github.com/360EntSecGroup-Skylar/excelize\u003c/p\u003e\n\u003ch3 id=\"示例代码\"\u003e示例代码\u003c/h3\u003e\n\u003cp\u003e以下代码演示了创建 excel 表格并向其中添加数据的方法，其中用到的函数见下文。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport (\n\t\u0026#34;fmt\u0026#34;\n\t\u0026#34;strconv\u0026#34;\n    \u0026#34;time\u0026#34;\n\t\n\t\u0026#34;github.com/360EntSecGroup-Skylar/excelize\u0026#34;\n\tlog \u0026#34;github.com/sirupsen/logrus\u0026#34;\n)\n\ntype User struct {\n\tID int \u003cspan class=\"sb\"\u003e`json:\u0026#34;id\u0026#34;`\u003c/span\u003e\n\tName string \u003cspan class=\"sb\"\u003e`json:\u0026#34;name\u0026#34;`\u003c/span\u003e\n\tAddress string \u003cspan class=\"sb\"\u003e`json:\u0026#34;address\u0026#34;`\u003c/span\u003e\n}\n\nfunc main() {\n\tusers := []User{\n\t\t{\n\t\t\tID: 1,\n\t\t\tName: \u0026#34;孔子\u0026#34;,\n\t\t\tAddress: \u0026#34;山东曲阜\u0026#34;,\n\t\t},\n\t\t{\n\t\t\tID: 2,\n\t\t\tName: \u0026#34;牛顿\u0026#34;,\n\t\t\tAddress: \u0026#34;英国伦敦\u0026#34;,\n\t\t},\n\t\t{\n\t\t\tID: 3,\n\t\t\tName: \u0026#34;凯撒\u0026#34;,\n\t\t\tAddress: \u0026#34;罗马\u0026#34;,\n\t\t},\n\t}\n\n\tf := excelize.NewFile()\n\tsheetName := \u0026#34;人物信息\u0026#34;\n\tsheet := f.NewSheet(sheetName)\n\tf.SetActiveSheet(sheet)\n\n\t// 合并单元格\n\terr := f.MergeCell(sheetName, \u0026#34;A1\u0026#34;, \u0026#34;A5\u0026#34;)\n\n\theader := map[string]interface{}{\u0026#34;A1\u0026#34;: \u0026#34;编号\u0026#34;, \u0026#34;B1\u0026#34;: \u0026#34;姓名\u0026#34;, \u0026#34;C1\u0026#34;:\u0026#34;地址\u0026#34;}\n\tdata := GenerateData(users, header)\n\terr = Write2File(\u0026#34;历史人物\u0026#34;, sheetName, data, true)\n\tif err != nil {\n\t\tlog.Errorln(err)\n\t}\n\t\n\tRead(\u0026#34;/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/go-study-notes/历史人物_2019-10-22_.xlsx\u0026#34;)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"读取-excel-文件\"\u003e读取 excel 文件\u003c/h3\u003e\n\u003cp\u003e以下代码为读取 excel 表格的代码，要求：文件路径需要是绝对路径，excel 表格中不包含合并的单元格\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc Read(fileFullPath string) {\n\tf, err := excelize.OpenFile(fileFullPath)\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\n\tfor sheetIndex, sheetName := range f.GetSheetMap() {\n\t\tfmt.Println(sheetIndex, \u0026#34;---\u0026gt;\u0026#34;, sheetName)\n\t\trows, err := f.Rows(sheetName)\n\t\tif err != nil {\n\t\t\tlog.Errorln(err)\n\t\t\tcontinue\n\t\t}\n\t\tfor rows.Next() {\n\t\t\t// 获取一行\n\t\t\tcols, err := rows.Columns()\n\t\t\tif err != nil {\n\t\t\t\tlog.Errorln(err)\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\t// 获取行数组中的值\n\t\t\tfor _, colCell := range cols {\n\t\t\t\tfmt.Println(colCell)\n\t\t\t}\n\t\t}\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"组织数据\"\u003e组织数据\u003c/h3\u003e\n\u003cp\u003e我们将数据组织成 map 数组格式，每个数组元素为 excel 表格中的一行，map 中的每个键表示 excel 中的一个位置，比如A1，B2，C3等，其值为需要填充到该单元格中的值，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc GenerateData(users []User, header map[string]interface{}) []map[string]interface{} {\n\tvar maps []map[string]interface{}\n\tvar m map[string]interface{}\n\n\tmaps = append(maps, header)\n\trowCount := 1\n\tfor _, user := range users {\n\t\tindex := strconv.Itoa(rowCount)\n\t\tm = map[string]interface{}{\n\t\t\t\u0026#34;A\u0026#34;+index: user.ID,\n\t\t\t\u0026#34;B\u0026#34;+index: user.Name,\n\t\t\t\u0026#34;C\u0026#34;+index: user.Address,\n\t\t}\n\n\t\tmaps = append(maps, m)\n\t\trowCount = rowCount + 1\n\t}\n\n\treturn maps\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"写-excel-文件\"\u003e写 excel 文件\u003c/h3\u003e\n\u003cp\u003e将组织好的 map 数组写入文件中\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e// 写数据到 excel 中，每个 map[string]interface{} 为一行数据，键为A1，B2，C3等等\nfunc Write2File(fileName string, sheetName string, data []map[string]interface{}, dateContaining bool) error {\n\tf := excelize.NewFile()\n\n\tsheet := f.NewSheet(sheetName)\n\tf.SetActiveSheet(sheet)\n\n\tfor _, item := range data {\n\t\tfor k, v := range item {\n\t\t\terr := f.SetCellValue(sheetName, k, v)\n\t\t\tif err != nil {\n\t\t\t\tlog.Errorln(err)\n\t\t\t\tcontinue\n\t\t\t}\n\t\t}\n\t}\n\n\t// 删除 Sheet1\n\tf.DeleteSheet(\u0026#34;Sheet1\u0026#34;)\n\n\tif dateContaining {\n\t\treturn f.SaveAs(fileName + \u0026#34;_\u0026#34; + time.Now().Format(\u0026#34;2006-01-02\u0026#34;) + \u0026#34;_\u0026#34; + \u0026#34;.xlsx\u0026#34;)\n\t} else {\n\t\treturn f.SaveAs(fileName + \u0026#34;.xlsx\u0026#34;)\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"合并单元格\"\u003e合并单元格\u003c/h3\u003e\n\u003cp\u003e使用 MergeCell 方法可以合并单元格\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eerr := f.MergeCell(sheetName, \u0026#34;A1\u0026#34;, \u0026#34;A5\u0026#34;)\nif err != nil {\n    log.Errorln(err)\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上代码将合并 A1~A5 的单元格，并以单元格 A5 的内容填充合并后的单元格。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/360EntSecGroup-Skylar/excelize\"\u003ehttps://github.com/360EntSecGroup-Skylar/excelize\u003c/a\u003e\u003c/p\u003e","date":1571702400,"description":"","fuzzywordcount":1200,"kind":"page","lang":"zh","lastmod":1571702400,"objectID":"b7d68ded3b2923b0c70cf0268dc1a65d","publishdate":1571702400,"relpermalink":"/posts/programming/golang/golang-excel/","section":"posts","summary":"\u003cp\u003e使用 golang 操作 excel 表格，写了些示例代码，封装了几个常用的函数，特此记录，以备后查。\u003c/p\u003e","tags":["Golang","Excel"],"title":"使用 golang 操作 excel 表格","url":"https://xdhuxc.github.io/posts/programming/golang/golang-excel/","wordcount":1103},{"categories":"posts","content":"\u003cp\u003e记录下 npm 和 node 的升级方法。\u003c/p\u003e\n\u003ch3 id=\"升级-nodejs\"\u003e升级 NodeJS\u003c/h3\u003e\n\u003cp\u003enpm 中有一个模块叫做 n，专门用来做 node.js 版本管理的。\u003c/p\u003e\n\u003cp\u003e使用如下命令更新 node.js 到最新版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enpm install -g n # 安装 n 模块\nn stable         # \u0008更新到最新稳定版的 node.js\nn latest         # 更新到最新版本的 node.js\nn v10.14.2       # 更新到指定版本的 node.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"升级-npm\"\u003e升级 npm\u003c/h3\u003e\n\u003cp\u003e使用如下命令升级 npm\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enpm -g install npm@next\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"查看当前-nodejs-版本对-es6-的支持程度\"\u003e查看当前 node.js 版本对 ES6 的支持程度\u003c/h3\u003e\n\u003cp\u003e可以通过 es-checker 工具查看当前 node.js 版本对 ES6 的支持程度\u003c/p\u003e\n\u003cp\u003e1、安装 es-checker\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enpm install -g es-checker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、使用 es-checker 命令检测\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e73\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:ushareit-hawkeye-frontend wanghuan$ node -v\nv10.14.2\nwanghuans-MacBook-Pro:ushareit-hawkeye-frontend wanghuan$ es-checker\n\nECMAScript 6 Feature Detection (v1.4.1)\n\nVariables\n  √ let and const\n  √ TDZ error for too-early access of let or const declarations\n  √ Redefinition of const declarations not allowed\n  √ destructuring assignments/declarations for arrays and objects\n  √ ... operator\n\nData Types\n  √ For...of loop\n  √ Map, Set, WeakMap, WeakSet\n  √ Symbol\n  √ Symbols cannot be implicitly coerced\n\nNumber\n  √ Octal (e.g. 0o1 ) and binary (e.g. 0b10 ) literal forms\n  √ Old octal literal invalid now (e.g. 01 )\n  √ Static functions added to Math (e.g. Math.hypot(), Math.acosh(), Math.imul() )\n  √ Static functions added to Number (Number.isNaN(), Number.isInteger() )\n\nString\n  √ Methods added to String.prototype (String.prototype.includes(), String.prototype.repeat() )\n  √ Unicode code-point escape form in string literals (e.g. \\u{20BB7} )\n  √ Unicode code-point escape form in identifier names (e.g. var \\u{20BB7} = 42; )\n  √ Unicode code-point escape form in regular expressions (e.g. var regexp = /\\u{20BB7}/u; )\n  √ y flag for sticky regular expressions (e.g. /b/y )\n  √ Template String Literals\n\nFunction\n  √ arrow function\n  √ default function parameter values\n  √ destructuring for function parameters\n  √ Inferences for function name property for anonymous functions\n  × Tail-call optimization for function calls and recursion\n\nArray\n  √ Methods added to Array.prototype ([].fill(), [].find(), [].findIndex(), [].entries(), [].keys(), [].values() )\n  √ Static functions added to Array (Array.from(), Array.of() )\n  √ TypedArrays like Uint8Array, ArrayBuffer, Int8Array(), Int32Array(), Float64Array()\n  √ Some Array methods (e.g. Int8Array.prototype.slice(), Int8Array.prototype.join(), Int8Array.prototype.forEach() ) added to the TypedArray prototypes\n  √ Some Array statics (e.g. Uint32Array.from(), Uint32Array.of() ) added to the TypedArray constructors\n\nObject\n  √ \u003cspan class=\"gs\"\u003e__proto__\u003c/span\u003e in object literal definition sets [[Prototype]] link\n  √ Static functions added to Object (Object.getOwnPropertySymbols(), Object.assign() )\n  √ Object Literal Computed Property\n  √ Object Literal Property Shorthands\n  √ Proxies\n  √ Reflect\n\nGenerator and Promise\n  √ Generator function\n  √ Promises\n\nClass\n  √ Class\n  √ super allowed in object methods\n  √ class ABC extends Array { .. }\n\nModule\n  × Module export command\n  × Module import command\n\n\n=========================================\nPasses 39 feature Detections\nYour runtime supports 92% of ECMAScript 6\n=========================================\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到，当前 node.js 版本 v10.14.2 对 ES6 的支持程度达到 92 %。\u003c/p\u003e","date":1571184000,"description":"","fuzzywordcount":700,"kind":"page","lang":"zh","lastmod":1571184000,"objectID":"31f6222e49caa1904d770a8e314f279f","publishdate":1571184000,"relpermalink":"/posts/programming/javascript/javascript-node-npm/","section":"posts","summary":"\u003cp\u003e记录下 npm 和 node 的升级方法。\u003c/p\u003e","tags":["JavaScript","Node","npm"],"title":"升级 NPM 和 Node","url":"https://xdhuxc.github.io/posts/programming/javascript/javascript-node-npm/","wordcount":607},{"categories":"posts","content":"\u003cp\u003e公司有业务使用到了 Clickhouse，需要使用 prometheus 监控 Clickhouse，展示 Clickhouse 集群的指标信息，于是进行了一番探索，特此记录。\u003c/p\u003e\n\u003cp\u003e使用 github 上的 \u003ca href=\"https://github.com/f1yegor/clickhouse_exporter\"\u003ehttps://github.com/f1yegor/clickhouse_exporter\u003c/a\u003e 项目提供的 clickhouse_exporter 来收集 Clickhouse 的指标信息。\u003c/p\u003e\n\u003cp\u003e1、克隆 clickhouse_exporter 工程到本地\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit clone https://github.com/f1yegor/clickhouse_exporter\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、编译\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emake build\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意使用交叉编译的方式编译目标操作系统上的可执行文件，给文件添加执行权限后，移动至 /usr/bin 目录下\u003c/p\u003e\n\u003cp\u003e3、部署\n以 Linux 系统服务方式运行 \u003ccode\u003eclickhouse_exporter\u003c/code\u003e，\u003ccode\u003eclickhouse_exporter.service\u003c/code\u003e（\u003ccode\u003e/usr/lib/systemd/system/clickhouse_exporter.service\u003c/code\u003e）文件内容为：：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=clickhouse_exporter\nDocumentation=http://www.clickhouse_exporter.io/\nAfter=network.target\n\n[Service]\nType=simple\nEnvironment=\u0026#34;CLICKHOUSE_USER=default\u0026#34;\nEnvironment=\u0026#34;CLICKHOUSE_PASSWORD=\u0026#34;\nExecStart=/usr/bin/clickhouse_exporter -scrape_uri=http://192.168.33.10:8123/\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在非默认情况下，通过 \u003ccode\u003eCLICKHOUSE_USER\u003c/code\u003e 和 \u003ccode\u003eCLICKHOUSE_PASSWORD\u003c/code\u003e 环境变量指定 clickhouse 的认证信息；\u003ccode\u003ehttp://192.168.33.10:8123/\u003c/code\u003e 为 \u003ccode\u003eclickhouse\u003c/code\u003e 运行的端点\u003c/p\u003e\n\u003cp\u003e4、在 prometheus.yaml 文件中增加如下内容并重启\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eglobal:\n  scrape_interval:     1s\n  evaluation_interval: 1s\n\nscrape_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: clickhouse\n    static_configs:\n      \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;127.0.0.1:9116\u0026#39;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003e127.0.0.1:9116\u003c/code\u003e 为 \u003ccode\u003eclickhouse_exporter\u003c/code\u003e 运行的端点，如果有多个，以 yaml 格式数组书写在 \u003ccode\u003etargets\u003c/code\u003e 处\u003c/p\u003e\n\u003cp\u003e5、向 grafana 中加入 clickhouse 仪表板\u003c/p\u003e\n\u003cp\u003e参考以下链接处的文档向 grafana 中加入 clickhouse 仪表板\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://grafana.com/grafana/dashboards/882\"\u003ehttps://grafana.com/grafana/dashboards/882\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/f1yegor/clickhouse_exporter\"\u003ehttps://github.com/f1yegor/clickhouse_exporter\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://grafana.com/grafana/dashboards/882\"\u003ehttps://grafana.com/grafana/dashboards/882\u003c/a\u003e\u003c/p\u003e","date":1570665600,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1570665600,"objectID":"912ce066eb6e0ab285059457c7725315","publishdate":1570665600,"relpermalink":"/posts/devops/prometheus/prometheus-grafana-clickhouse/","section":"posts","summary":"\u003cp\u003e公司有业务使用到了 Clickhouse，需要使用 prometheus 监控 Clickhouse，展示 Clickhouse 集群的指标信息，于是进行了一番探索，特此记录。\u003c/p\u003e","tags":["Grafana","DevOps","clickhouse"],"title":"使用 Grafana 监控 Clickhouse","url":"https://xdhuxc.github.io/posts/devops/prometheus/prometheus-grafana-clickhouse/","wordcount":459},{"categories":"posts","content":"\u003cp\u003e使用 golang 的 flag 包读取命令行参数，然而，奇怪的事情发生了，读取到的 redis 密码是错误的，这很奇怪，本地验证 redis 密码没有问题，但是代码中就是认证失败，于是研究了一下，特此记录。\u003c/p\u003e\n\u003cp\u003e使用 golang 的 flag 包读取命令行参数，然而，奇怪的事情发生了，读取到的 redis 密码是错误的。这很奇怪，本地验证 redis 密码没有问题，但是代码中就是认证失败，于是研究了一下，特此记录。\u003c/p\u003e\n\u003cp\u003e测试使用的系统和 golang 版本如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:one wanghuan$ go version\ngo version go1.12.9 darwin/amd64\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e测试使用的代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport (\n\t\u0026#34;flag\u0026#34;\n\t\u0026#34;fmt\u0026#34;\n\t\u0026#34;os\u0026#34;\n)\n\nvar password string\n\nfunc init() {\n\tflag.StringVar(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003epassword, \u0026#34;password\u0026#34;, \u0026#34;\u0026#34;, \u0026#34;the password to authenticate with (only used with vault and etcd backends)\u0026#34;)\n}\n\nfunc main() {\n\tfmt.Printf(\u0026#34;the args is %s\\n\u0026#34;, os.Args)\n\n\tflag.Parse()\n\n\tfmt.Printf(\u0026#34;the password is %s\\n\u0026#34;, password)\n\n\tif password == \u0026#34;qZ2XisdsdgGiLSf0b$HBL#LDLUG5uUGr8v0\u0026#34; {\n\t\tfmt.Println(true)\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e测试的结果如下：\n1、$ 在 # 之前\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:one wanghuan$ ./flag --password qZ2XisdsdgGiLSf0b$HBL#LDLUG5uUGr8v0\nthe args is [./flag --password qZ2Xis#dsdg#Gi#LSf0b#LDLUG5uUGr8v0]\nthe password is qZ2XisdsdgGiLSf0b#LDLUG5uUGr8v0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e对比结果：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eqZ2XisdsdgGiLSf0b$HBL#LDLUG5uUGr8v0\nqZ2XisdsdgGiLSf0b    \u003cspan class=\"ni\"\u003e#LDLUG5uUGr8v0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到，去除了 $ 到 # 之间的字符，结果包含 #，不包含 $。\u003c/p\u003e\n\u003cp\u003e2、$ 在最后一个 # 之后\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:one wanghuan$ ./flag --password qZ2XisdsdgGiLSf0bHBL#LDL$UG5uUGr8v0\nthe args is [./flag --password qZ2XisdsdgGiLSf0bHBL#LDL]\nthe password is qZ2XisdsdgGiLSf0bHBL#LDL\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e对比结果：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eqZ2XisdsdgGiLSf0bHBL#LDL$UG5uUGr8v0\nqZ2XisdsdgGiLSf0bHBL#LDL\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到，去除了 $ 及其之后的字符串\u003c/p\u003e\n\u003cp\u003e3、$ 在最后一个 # 之前\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:one wanghuan$ ./flag --password qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0\nthe args is [./flag --password qZ2Xisdsdg#GiL#Sf0b#LDLUG5u#UGr8v0]\nthe password is qZ2Xisdsdg#GiL#Sf0b#LDLUG5u#UGr8v0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e对比结果\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eqZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0\nqZ2Xisdsdg#GiL#Sf0b    \u003cspan class=\"ni\"\u003e#LDLUG5u#UGr8v0\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到，和第一种情况类似，去除了 $ 到其之后的第一个 # 之间的字符\u003c/p\u003e\n\u003cp\u003e根据以上实验可以看出：\n1）$ 及其之后的字符被 \u0026quot;吞\u0026quot; 掉了，看起来是 $ 及其之后到第一个 # 之间的字符被 Shell 当做变量解释了。\u003c/p\u003e\n\u003cp\u003e2）从 args 的值可以看出，在参数进入到 golang 程序之前， $ 及其之后到第一个 # 之间的字符已经被 Shell 当做变量解释完毕。\u003c/p\u003e\n\u003cp\u003e要解决这个问题，其实很简单，给含 $ 的字符串加上引号（单引号或双引号都可以）就可以了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:one wanghuan$ ./flag --password \u0026#39;qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0\u0026#39;\nthe args is [./flag --password qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0]\nthe password is qZ2Xisdsdg#GiL#Sf0b$HBL#LDLUG5u#UGr8v0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1569715200,"description":"","fuzzywordcount":700,"kind":"page","lang":"zh","lastmod":1569715200,"objectID":"2d8cb6a8d69a81509d4d869f1b9d7578","publishdate":1569715200,"relpermalink":"/posts/programming/golang/golang-args/","section":"posts","summary":"\u003cp\u003e使用 golang 的 flag 包读取命令行参数，然而，奇怪的事情发生了，读取到的 redis 密码是错误的，这很奇怪，本地验证 redis 密码没有问题，但是代码中就是认证失败，于是研究了一下，特此记录。\u003c/p\u003e","tags":["Golang"],"title":"Golang flag 包读取参数怪事","url":"https://xdhuxc.github.io/posts/programming/golang/golang-args/","wordcount":645},{"categories":"posts","content":"\u003cp\u003e        除去在深度睡眠状态下和死亡状态下，人的意识必须时时刻刻被某种东西填充着，这东西可能是吸烟时的惆怅、焦虑或无聊，或是不停地滑动着屏幕刷微博或微信，或是坐公交或地铁时耳机里的声音，或是各视频网站上的视频，或是感官系统当前获得的信息，或是对过去的记忆或其回想，或是对未来的规划和漫无目的的遐想，或是读一本有趣的书籍等等，总是不会处于空洞的状态，直到其彻底失去意识活动。根据研究，在轻度睡眠状态下，人的大脑可以得到休息，但就像所有人都能感觉到的那样，我们的意识在这种情况下依然在活动，在轻微地和舒适地活动，甚至是更加随机地活动。\u003c/p\u003e\n\u003cp\u003e　　“如果想让地里不长杂草，方法其实是唯一的，那就是在地里种上麦子”，这话是佛祖说的还是苏格拉底说的，我就不清楚了，可能需要去问他们。人的意识必须被某种东西占据着，所以，如果人没有用一种有益于其自身的东西（比如读书、写作、学习外语、工作、适度的娱乐、运动等活动）去占据它，那么它就会被其他的、挤进来的东西（比如各种信息流软件）占据着并浪费着，或处于一种轻松的漫无目的的遐想之中，呆呆地感受着这个世界。\u003c/p\u003e\n\u003cp\u003e　　这种意识的填充性可以分为两种类型：一类是空洞填充，人的意识仅仅是被某种存在物主动地或被动地占据着，仅仅如此，没有其他的意义了，一般对应着人的自然属性；另一类是价值填充，某种存在物先入为主地占据着人的意识，从而这人对其他类似的存在物进行排斥，表现为总是习惯性地用这种存在物来解释事物，一般对应着人的社会属性。\u003c/p\u003e\n\u003cp\u003e　　空洞填充就像上面介绍的那样，仅仅是占据着人的意识。真正值得研究的是价值填充，这里面会有一些对我们有意义的东西。\u003c/p\u003e\n\u003cp\u003e　　\u0026quot;人性\u0026quot;是个伪概念！（此处参见《人间世·四·意识·一》）\u003c/p\u003e\n\u003cp\u003e　　\u0026quot;人性\u0026quot;这个概念被提出来，就是在理论层面上，从根本上和源头上来规范人的所有行为的。无论是“性善论”、“性恶论”还是“环境塑造论”，都是肯定“人性”这个东西是存在的，都是认为有一种东西在普遍地约束和规定着人的行为。但是，为什么有这个规定着人的行为的东西存在呢？其实就是提出来安慰人心的，用这样一个概念，从根本上和源头上解释人的行为，尤其是解释这样一类事物：人的社会属性和人的自然属性相矛盾着的地方，就是说，按照社会公共价值准则，事情应该如此来做，但总会有些人，使用不符合这公共价值准则的方式来做，其他人不接受这种做法，但也奈何不了，就会习惯性地使用“人性使然”来解释。由于“人性”是人的天性，内在地决定了这事情，所以就强迫自己从心理上接受（这种精神、心理和价值观上的煎熬行为和状态参见《人间世·七·人·七》），从而在意识中填充了对这问题的解释。这种做法对人自身的心理、精神、价值追求、社会认同等有了个交代，填充着那个位置，而不管那个位置究竟是个什么样的具体的存在物，最为根本的动因是，保护了自己的心灵安全、精神安全和价值观念安全。\u003c/p\u003e\n\u003cp\u003e　　有很多理论，大体都是如此，比如，“经济人”或“理性经济人”这样的概念，一个逻辑构造出来的、现实中根本不存在的东西，却可以在它上面构造很多理论的大厦，用来解释一些现象和问题，实际上仅仅是在接受者的头脑中填充一个对问题的解释而已，并不反映实际的情况。如果这些接受者扔掉那些先入为主的概念和理论，自己去根据自己现实的经验和观察去思考和解释这些现象和问题，把粒度考虑得细一点，逻辑流程更加紧凑一点，尽量发散到现实的场景而不是给出解释者构造的特定逻辑场景，多问几个“为什么”，相信很多人自己就可以探寻出答案。很多问题和现象的答案没有那么难以探究，也简单不到单一因素就可以决定。\u003c/p\u003e\n\u003cp\u003e　　意识的填充性也意味着一般情况下，人的思想及思维会慢慢地走向固化，也就是人对其周围的事物已经无法再产生新的认知了。\u003c/p\u003e\n\u003cp\u003e　　每当说起一些事物时，我们可能会发现，有些人对这事物的认知，一年前是这样，现在还是这样，三年后可能还是那样，五年后可能还是那样，十年后可能还是那样，甚至二十年后可能还是那样。一个人总是在变化，其所处的外部环境总是在变化，事物的内外部环境也总是在变化，但是一个人对事物的认知却基本没有变化，岂非怪事？\u003c/p\u003e\n\u003cp\u003e　　当人在意识中对某个事物形成一定的认知后，这种认知就会在头脑中占据着这事物的若干部分。当有新的与这事物相关的东西进入大脑后，原有的认知部分或全部地或被增强、或被颠覆、或被反向、或被改变、或者保持原样，但总是在已有的认知基础上进行的，而不是全新地建立。在普遍的情况下，人的意识排斥新的同类的或同样的东西，因为他们认为这“新的同类的或同样的东西”和自己意识中已经存在的某个事物相同。这其中包含两个方面的原因：一，作为生物的人懒得动，尤其是大脑懒得运动；二，作为社会化的人，接受新的同类的或同样的东西，就必须替换掉原有的，在意识层面上意味着对前一个自己的特定认知的否定，在实践上往往比这高一个层面，意味着对前一个自己的否定。注意，实际上否定的只是自己对某事物的某个方面的认知，但真正实践的时候，已经转变成了对自己的否定。这样的因素导致一般情况下，人们不愿意去替换掉头脑中已被占据着的位置，从而导致自己的思想和思维的固化。\u003c/p\u003e\n\u003cp\u003e　　对于中国人来说，主观上的原因往往在于，没有多少人真正地把知识应用到生活和工作中去，并对这些知识进行同化、改造、升级、丰富，往往仅仅是将知识作为原始资料搬来搬去，就像我们平时听过的各种传说一样。\u003c/p\u003e\n\u003cp\u003e　　一个人思想和思维固化的一个结果和显著表现就是总是先入为主地看待事物，而没有注意到当前事物和自己意识中的那个事物其实可能有很大的区别。就像前面提及的一样，事物总是在变，然而并不是每个人都能抓住不变的脉络。\u003c/p\u003e\n\u003cp\u003e　　导致有些人总是先入为主地看待事物的原因有很多，此处只说目前最常见的一种：以微信公众号、今日头条为代表的互联网媒体的碎片化知识和信息的传播，一方面普及了这些知识，推广了这些信息，但对于接收者来说，这些逻辑的未经自己推敲和自身实践的知识，往往本身不足以完整地解释和解决问题，从而在实践层面上没法使用，但很多人还是选择相信并且勇敢地应用了。从外部来看的话，每当说起一个事物时，我们可能会发现，有些人对某事物的认知，好像在哪里听说过。是的，确实是听说过，而且是到处听过过同一种奇怪的观点。但是，难道就没有这个人自己的认识吗，难道这个人对这事情的认知就是一大堆“经典理论”的集合吗？\u003c/p\u003e\n\u003cp\u003e　　当前，社会舆论上最鲜明的特点是，以政治正确、女性正确、欧美正确、反欧美正确、道德正确、反道德正确、弱势群体正确、流氓正确、禽兽正确等为代表的“正确理论”先入为主地对各种事物的正误对错进行了规定，其组成的密集交叉火力网把中国人的反思精神及能力和变革精神及能力死死地压制住。这很符合现代文明的精神核心：虚伪，将一切攫取利益的手段隐藏在光鲜的、无可辩驳的旗帜之下，让异己的其他所有人都无话可说。实用的和革命的中国人会怎样对待这些垃圾玩意儿呢？我们拭目以待。\u003c/p\u003e\n\u003cp\u003e　　这是一种认知上的死亡，也是精神上的死亡！对个体的人来说，就好像，一个人被死锁在一个圆球里面，满目所及，满脑所想，都是自己头脑中已经出现过无数遍的事物，一遍，一遍，又一遍地循环，不断地向自己的意识中强化已有的认知，不断地深化这种已有的存在。\u003c/p\u003e\n\u003cp\u003e　　写《人间世》，也是因为我自己陷入了这种困境，陷入了思想和思维的僵化困境，又总是看到别人先入为主地看待事物，这让我感到很恐惧。难道若干年后，我还是今天这个样子吗，对特定事物的观点还是以前的那点内容吗，仅仅是自己的年龄增长了？不，这不是我想要的。我要把这些东西写下来，把自己头脑中的垃圾全部清理出来，也作为自己曾经记忆的一部分保存下来。\u003c/p\u003e\n\u003cp\u003e　　总体上来说，意识的这种填充性是一种安全保护机制，作为生物的人需要时时刻刻对外部环境变化保持警惕以保护自己，作为社会化的人需要时时刻刻填充着自己的意识以保护人的心理和精神上的安全，但是却造成了很多人的思想和意识僵化，现在更是作为时间消费经济的主力支撑。\u003c/p\u003e\n\u003cp\u003e　　对于个人意识的占据，有两种极端的情况，也是很有意思的对比。有些人按照这个社会的资源分配规则，将自己的意识用可以获得更多社会认可的方式去占据它。这些人占据了社会资源分配的制高点，在最初偶然地通过这种方式实现自己的获得感和成就感后，沿着这条道路一直走，一直走，人生的整个过程中都在不断地增加获得感和占据更多的资源。这其中，有些人用分钟来计算自己的时间，把每一件事，工作、吃饭、睡觉、学习、娱乐、交通等等所有事情的时间都精确到分钟级别，上下浮动若干分钟，每一件事也都精确到具体的目的并显化在意识中，将自己的意识完全占据，而且是若干年如一日地坚持执行下去。有些人是这样的，使用刷微信、刷微博、刷抖音、刷今日头条、刷淘宝、看剧、打游戏等方式来占据自己的意识，时间粒度在小时级别甚至更大范围上，同样地若干年如一日地坚持执行下去。\u003c/p\u003e\n\u003cp\u003e　　两者对比起来就有意思了，看起来就像这样：\n　　\u003ccenter\u003e\n　　　　\u003cimg src=\"/image/human/consciousness-two/004201.png\"  width=\"800px\" height=\"５00px\"/\u003e\n　　\u003c/center\u003e\u003c/p\u003e\n\u003cp\u003e　　一般情况下，“优秀”派占据着包括舆论和价值观话语权在内的大量社会资源，唯有称颂，否则就是不上进，政治不正确！“刷”派占据着巨量的人口，不能评价，否则肯定会群情汹汹，惹出一堆乱七八糟的事情来。不过我们可以提个问题，一般地，我们都会认为工作和娱乐是个人活动和存在的一部分，但是对这两部分人来说，恐怕已经不是部分了，可能已经占据了一个人所有的意识。是否可以认为，这两种极端情况下，人都成为了自己的工具，成为了填充自己意识的工具，成为了某种组织（上图中的对端，在高一个层级上，这种活动的另一端是谁）的工具？\u003c/p\u003e\n\u003cp\u003e　　对于有些女性和小孩，如果不从外部找些有益的事情占据她们的意识，那么她们就会自己倒腾出些事情来，恐怕就不是大家所期望的样子了。\u003c/p\u003e\n\u003cp\u003e　　还有个有趣的现象，在一些人对自己的兴趣爱好的叙述中，出现了“睡觉”一词，换句话说，“睡觉”成为了他们的兴趣爱好。\u003c/p\u003e\n\u003cp\u003e　　当把人从繁重的体力和（或）脑力劳动中暂时性地或永久性地解放出来后，人干什么去呢？\n　\n　　市场经济给出的解答，中国人满意吗？\u003c/p\u003e\n\u003cp\u003e　　腾讯（微信、游戏（王者荣耀、绝地求生等）、腾讯视频等）、阿里巴巴（天猫、淘宝等）、京东（京东商城）、今日头条（今日头条、抖音等）、新浪（微博）等互联网企业给出的解答，中国人满意吗？\u003c/p\u003e\n\u003cp\u003e　　每一个中国人，当自己面临这个问题的时候，对于自己的解答解答，自己满意吗？\u003c/p\u003e\n\u003cp\u003e　　这个问题，是否存在统一的和通用的解答呢？如果有，会是什么呢？\u003c/p\u003e","date":1569628800,"description":"","fuzzywordcount":4200,"kind":"page","lang":"zh","lastmod":1569628800,"objectID":"83117788cd3a15ebcb95c61808e82a03","publishdate":1569628800,"relpermalink":"/posts/human/human-world-consciousness-two/","section":"posts","summary":"","tags":["人间世"],"title":"人间世·意识·二","url":"https://xdhuxc.github.io/posts/human/human-world-consciousness-two/","wordcount":4147},{"categories":"posts","content":"\u003cp\u003egolang 中的所有字符使用 UTF-8 编码，当源文件中包含中文，编码是 GB2312 或 GBK 时，就可以在输出中产生乱码。\u003c/p\u003e\n\u003cp\u003e由于 golang 中的所有字符使用 UTF-8 编码，当我们处理的文件中包含中文、编码为 GB2312 或 GBK时，输出这些字符串时就会产生乱码，比如从 Windows 上 excel 中导出的 csv 文件，包含的中文用 GB2312 编码，使用 golang 读取时就会产生乱码。此时，我们需要读取数据后，进行转码，以保证输出正确。\u003c/p\u003e\n\u003cp\u003e示例代码如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport (\n\u0026#34;fmt\u0026#34;\n\n\u0026#34;github.com/axgle/mahonia\u0026#34;\n)\n\nfunc main() {\n\n\tdecoder := mahonia.NewDecoder(\u0026#34;GBK\u0026#34;)\n\t// hello, 涓栫晫\n\tfmt.Println(decoder.ConvertString(\u0026#34;hello, 世界\u0026#34;))\n\n\tdataInBytes := []byte{0xC4, 0xE3, 0xBA, 0xC3, 0xA3, 0xAC, 0xCA, 0xC0, 0xBD, 0xE7, 0xA3, 0xA1}\n\n\t// 你好，世界！\n\tfmt.Println(decoder.ConvertString(string(dataInBytes)))\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，GBK 不要写为 GB2312，由于 GBK 兼容 GB2312，所以使用 GB2312 编码的汉字可以直接使用 GBK 进行解码。\u003c/p\u003e\n\u003cp\u003e不要使用 \u003ccode\u003egithub.com/djimenez/iconv-go\u003c/code\u003e 包，此包中使用了 C 库，在本地（macOS Mojave 10.14.6）可以运行，但在交叉编译时会出问题，其编写的程序到其他平台运行会比较麻烦。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://www.haodaquan.com/94\"\u003ehttp://www.haodaquan.com/94\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/axgle/mahonia\"\u003ehttps://github.com/axgle/mahonia\u003c/a\u003e\u003c/p\u003e","date":1569456000,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1569456000,"objectID":"ab3a0251e065b40ded3144359822cbf7","publishdate":1569456000,"relpermalink":"/posts/programming/golang/golang-gb2312-to-utf8/","section":"posts","summary":"\u003cp\u003egolang 中的所有字符使用 UTF-8 编码，当源文件中包含中文，编码是 GB2312 或 GBK 时，就可以在输出中产生乱码。\u003c/p\u003e","tags":["Golang","字符集"],"title":"Golang 将 GB2312编码的汉字 转为 UTF-8 编码的汉字","url":"https://xdhuxc.github.io/posts/programming/golang/golang-gb2312-to-utf8/","wordcount":366},{"categories":"posts","content":"\u003cp\u003e本篇博客主要记录一些在使用 Python 语言进行开发的过程中经常遇到的问题及其可能的解决方法，记录下来以备后需。\u003c/p\u003e\n\u003ch3 id=\"modulenotfounderror-no-module-named-crypto\"\u003eModuleNotFoundError: No module named 'Crypto'\u003c/h3\u003e\n\u003cp\u003e代码里面从 Crypto 中导入 AES 类，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efrom Crypto.Cipher import AES\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e已经安装了 Crypto 包，但是执行时还是报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTraceback (most recent call last):\n  File \u0026#34;/Users/wanghuan/PycharmProjects/scmp-dingtalk-callback/xyzdfg.py\u0026#34;, line 7, in \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    from Crypto.Cipher import AES\nModuleNotFoundError: No module named \u0026#39;Crypto\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 python 3 中，包名已经变成了 pycryptodomex 或 pycryptodome，使用如下命令安装 pycryptodomex 包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epip install pycryptodomex\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改导入代码为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efrom Cryptodome.Cipher import AES\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"python-环境的-docker-容器看不到-print-函数的输出\"\u003ePython 环境的 Docker 容器看不到 print() 函数的输出\u003c/h3\u003e\n\u003cp\u003e编写 python 脚本，使用 docker 容器运行，启动命令为 \u003ccode\u003eENTRYPOINT [\u0026quot;python3\u0026quot;, \u0026quot;/usr/local/bin/test.py\u0026quot;]\u003c/code\u003e，容器启动正常，脚本执行正常，但是使用 \u003ccode\u003edocker logs\u003c/code\u003e 命令却不见 \u003ccode\u003eprint()\u003c/code\u003e 函数的输出内容。\n原因：\u003c/p\u003e\n\u003cp\u003epython 的缓存机制，stdout 和 stderr 默认都是指向屏幕的，但 stderr 是无缓存的，程序向 stderr 输出的字符，会直接打印到屏幕上。而 stdout 是有缓存的，只有遇到换行或积累到一定的大小，才会输出到屏幕上。\u003c/p\u003e\n\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003epython 命令后面加上 \u003ccode\u003e-u\u003c/code\u003e （unbuffered）参数，强制其标准输出不通过缓存，直接打印到屏幕上。所以，将 \u003ccode\u003eDockerfile\u003c/code\u003e 中的 \u003ccode\u003eENTRYPOINT\u003c/code\u003e 命令改写为：\u003ccode\u003eENTRYPOINT [\u0026quot;python3\u0026quot;, \u0026quot;-u\u0026quot;, \u0026quot;/usr/local/bin/test.py\u0026quot;]\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"脚本运行时间长\"\u003e脚本运行时间长\u003c/h3\u003e\n\u003cp\u003epython 程序运行时间特别长，一个脚本运行了一个小时才出结果，使用 line_profiler 进行分析，发现在迭代时使用了 hasattr() 进行属性存在判断，导致占用时间特别长。\u003c/p\u003e\n\u003ch3 id=\"valueerror-embedded-null-byte\"\u003eValueError: embedded null byte\u003c/h3\u003e\n\u003cp\u003e执行脚本时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTraceback (most recent call last):\n  File \u0026#34;/Users/wanghuan/PycharmProjects/common_test/image_table.py\u0026#34;, line 59, in \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emodule\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    request_id = request_api(image_bin)\n  File \u0026#34;/Users/wanghuan/PycharmProjects/common_test/image_table.py\u0026#34;, line 20, in request_api\n    image = get_file_content(image_bin)\n  File \u0026#34;/Users/wanghuan/PycharmProjects/common_test/image_table.py\u0026#34;, line 14, in get_file_content\n    with open(file_path, \u0026#39;rb+\u0026#39;) as fp:\nValueError: embedded null byte\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e检查一下代码，可能是函数中调用了函数自身。\u003c/p\u003e\n\u003ch3 id=\"xe8xb4xbexe5xbfx97xe7x8cx9b\"\u003e\\xe8\\xb4\\xbe\\xe5\\xbf\\x97\\xe7\\x8c\\x9b\u003c/h3\u003e\n\u003cp\u003e使用 pymysql 连接数据库时，取回的数据中的中文不是 unicode 码，而是如下的乱码。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026#39;\\xe8\\xb4\\xbe\\xe5\\xbf\\x97\\xe7\\x8c\\x9b\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建数据库连接时，原来没有指定字符集，默认的字符集是从文件 \u003ccode\u003e/etc/my.cnf\u003c/code\u003e 中的 \u003ccode\u003edefault-character-set\u003c/code\u003e 配置项读取而来，如果没有该文件或者该配置项，则默认的字符集为：\u003ccode\u003eutf8mb4\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e解决：创建数据库连接时，显式指定字符集为 utf8\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edb = pymysql.connect(\u0026#39;127.0.0.1\u0026#39;, \u0026#39;root\u0026#39;, \u0026#39;Xdhuxc375\u0026#39;, \u0026#39;xdhuxc\u0026#39;, charset=\u0026#39;utf8\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"ascii-codec-cant-decode-byte-0xe4-in-position-40-ordinal-not-in-range128\"\u003e'ascii' codec can't decode byte 0xe4 in position 40: ordinal not in range(128)\u003c/h3\u003e\n\u003cp\u003e使用 Python 开始时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026#39;ascii\u0026#39; codec can\u0026#39;t decode byte 0xe4 in position 40: ordinal not in range(128)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：在文件代码开头处增加如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ereload(sys)                      # reload 才能调用 setdefaultencoding 方法\nsys.setdefaultencoding(\u0026#39;utf-8\u0026#39;)  # 设置 \u0026#39;utf-8\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"json-dumps-字典数据时出现乱码\"\u003ejson dumps 字典数据时出现乱码\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\u0026#34;msg\u0026#34;: \u0026#34;\\u5ba2\\u6237\\u7aef\\u8bf7\\u6c42\\u9519\\u8bef\\uff0c\\u7f3a\\u5c11\\u67e5\\u8be2\\u53c2\\u6570 secretkey \\u6216\notp\\u3002\u0026#34;, \u0026#34;code\u0026#34;: 4}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：添加 ensure_ascii=False 参数，ensure_ascii=True 保证 dumps() 之后的结果里所有的字符都能够被 ascii 表示，因此经过 dumps() 以后的str里，汉字会变成对应的 unicode。因此，当字典中含有中文时，一定要使用 ensure_ascii=False。\u003c/p\u003e\n\u003ch3 id=\"docker-logs-命令却不见-print-函数的输出内容\"\u003e\u003ccode\u003edocker logs\u003c/code\u003e 命令却不见 \u003ccode\u003eprint()\u003c/code\u003e 函数的输出内容\u003c/h3\u003e\n\u003cp\u003e编写 python 脚本，使用 docker 容器运行，启动命令为 \u003ccode\u003eENTRYPOINT [\u0026quot;python3\u0026quot;, \u0026quot;/usr/local/bin/test.py\u0026quot;]\u003c/code\u003e，容器启动正常，脚本执行正常，但是使用 \u003ccode\u003edocker logs\u003c/code\u003e 命令却不见 \u003ccode\u003eprint()\u003c/code\u003e 函数的输出内容。\u003c/p\u003e\n\u003cp\u003e原因：python 的缓存机制，stdout 和 stderr 默认都是指向屏幕的，但 stderr 是无缓存的，程序向 stderr 输出的字符，会直接打印到屏幕上。而 stdout 是有缓存的，只有遇到换行或积累到一定的大小，才会输出到屏幕上。\u003c/p\u003e\n\u003cp\u003e解决：python 命令后面加上 \u003ccode\u003e-u\u003c/code\u003e （unbuffered）参数，强制其标准输出不通过缓存，直接打印到屏幕上。所以，将 \u003ccode\u003eDockerfile\u003c/code\u003e 中的 \u003ccode\u003eENTRYPOINT\u003c/code\u003e 命令改写为：\u003ccode\u003eENTRYPOINT [\u0026quot;python3\u0026quot;, \u0026quot;-u\u0026quot;, \u0026quot;/usr/local/bin/test.py\u0026quot;]\u003c/code\u003e\u003c/p\u003e","date":1569369600,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1531008000,"objectID":"a66c38bb96fcfdb45e0bdb2d87849e08","publishdate":1569369600,"relpermalink":"/posts/programming/python/python-questions-and-solution/","section":"posts","summary":"\u003cp\u003e本篇博客主要记录一些在使用 Python 语言进行开发的过程中经常遇到的问题及其可能的解决方法，记录下来以备后需。\u003c/p\u003e","tags":["Python"],"title":"Python 常见问题及解决","url":"https://xdhuxc.github.io/posts/programming/python/python-questions-and-solution/","wordcount":1218},{"categories":"posts","content":"\u003cbody\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"bomb-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv class=\"normal-rocket\"\u003e\u003c/div\u003e\n    \u003cdiv\u003e\n    \u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;春江花月夜\n    \u003cbr\u003e\n    \u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;唐\u0026nbsp;张若虚\n    \u003cbr\u003e\n    春江潮水连海平，海上明月共潮生。\n     \u003cbr\u003e\n    滟滟随波千万里，何处春江无月明！\n     \u003cbr\u003e\n    江流宛转绕芳甸，月照花林皆似霰；\n     \u003cbr\u003e\n    空里流霜不觉飞，汀上白沙看不见。\n     \u003cbr\u003e\n    江天一色无纤尘，皎皎空中孤月轮。\n     \u003cbr\u003e\n    江畔何人初见月？江月何年初照人？\n     \u003cbr\u003e\n    人生代代无穷已，江月年年望相似。\n     \u003cbr\u003e\n    不知江月待何人，但见长江送流水。\n     \u003cbr\u003e\n    白云一片去悠悠，青枫浦上不胜愁。\n     \u003cbr\u003e\n    谁家今夜扁舟子？何处相思明月楼？\n     \u003cbr\u003e\n    可怜楼上月徘徊，应照离人妆镜台。\n     \u003cbr\u003e\n    玉户帘中卷不去，捣衣砧上拂还来。\n     \u003cbr\u003e\n    此时相望不相闻，愿逐月华流照君。\n     \u003cbr\u003e\n    鸿雁长飞光不度，鱼龙潜跃水成文。\n     \u003cbr\u003e\n    昨夜闲潭梦落花，可怜春半不还家。\n     \u003cbr\u003e\n    江水流春去欲尽，江潭落月复西斜。\n     \u003cbr\u003e\n    斜月沉沉藏海雾，碣石潇湘无限路。\n     \u003cbr\u003e\n    不知乘月几人归，落月摇情满江树。\n    \u003c/div\u003e\n    \u003cdiv class=\"text\"\u003e✨Happy 颖🎉🎉✨\u003c/div\u003e\n    \u003cstyle type=\"text/css\"\u003e\n    \tbody {\n    \t  top: 200px;\n    \t  width: 100%;\n    \t  height: 100%;\n    \t  background: -webkit-radial-gradient(bottom ellipse, #1b2735 0%, #090a0f 100%);\n    \t  background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);\n    \t}\n    \t.text {\n    \t  position: absolute;\n    \t  left: 50%;\n    \t  top: 50%;\n    \t  width: 80%;\n    \t  -webkit-transform: translate(-50%, -50%);\n    \t          transform: translate(-50%, -50%);\n    \t  text-align: center;\n    \t  font-size: 9vw;\n    \t  font-family: 'Concert One', cursive;\n    \t  -webkit-animation: text-animation 5s linear infinite alternate;\n    \t          animation: text-animation 5s linear infinite alternate;\n    \t}\n    \t@-webkit-keyframes text-animation {\n    \t  from {\n    \t    color: white;\n    \t    text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #fff, 0 0 40px #FFDD1B, 0 0 70px #FFDD1B, 0 0 80px #FFDD1B, 0 0 100px #FFDD1B, 0 0 150px #FFDD1B;\n    \t  }\n    \t  to {\n    \t    color: white;\n    \t    text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px #ff0080, 0 0 30px #ff0080, 0 0 40px #ff0080, 0 0 55px #ff0080, 0 0 75px #ff0080;\n    \t    text-align: center;\n    \t  }\n    \t}\n    \t@keyframes text-animation {\n    \t  from {\n    \t    color: white;\n    \t    text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #fff, 0 0 40px #FFDD1B, 0 0 70px #FFDD1B, 0 0 80px #FFDD1B, 0 0 100px #FFDD1B, 0 0 150px #FFDD1B;\n    \t  }\n    \t  to {\n    \t    color: white;\n    \t    text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px #ff0080, 0 0 30px #ff0080, 0 0 40px #ff0080, 0 0 55px #ff0080, 0 0 75px #ff0080;\n    \t    text-align: center;\n    \t  }\n    \t}\n    \t.bomb-rocket, .normal-rocket {\n    \t  position: absolute;\n    \t  bottom: 0;\n    \t  width: 30px;\n    \t  height: 30px;\n    \t  border-radius: 100%;\n    \t  -webkit-animation-timing-function: linear;\n    \t          animation-timing-function: linear;\n    \t  -webkit-animation-iteration-count: infinite;\n    \t          animation-iteration-count: infinite;\n    \t}\n    \t.bomb-rocket:nth-child(1) {\n    \t  left: 91vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-2;\n    \t          animation-name: bomb-rocket-animate-2;\n    \t  -webkit-animation-delay: 1.3s;\n    \t          animation-delay: 1.3s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: red;\n    \t}\n    \t.normal-rocket:nth-child(16) {\n    \t  left: 19vw;\n    \t  -webkit-animation-name: normal-rocket-animate-2;\n    \t          animation-name: normal-rocket-animate-2;\n    \t  -webkit-animation-delay: 0.1s;\n    \t          animation-delay: 0.1s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: red;\n    \t}\n    \t.bomb-rocket:nth-child(2) {\n    \t  left: 8vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-3;\n    \t          animation-name: bomb-rocket-animate-3;\n    \t  -webkit-animation-delay: 1.5s;\n    \t          animation-delay: 1.5s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: springgreen;\n    \t}\n    \t.normal-rocket:nth-child(17) {\n    \t  left: 3vw;\n    \t  -webkit-animation-name: normal-rocket-animate-3;\n    \t          animation-name: normal-rocket-animate-3;\n    \t  -webkit-animation-delay: 0.8s;\n    \t          animation-delay: 0.8s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: turquoise;\n    \t}\n    \t.bomb-rocket:nth-child(3) {\n    \t  left: 7vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-1;\n    \t          animation-name: bomb-rocket-animate-1;\n    \t  -webkit-animation-delay: 1s;\n    \t          animation-delay: 1s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: yellow;\n    \t}\n    \t.normal-rocket:nth-child(18) {\n    \t  left: 57vw;\n    \t  -webkit-animation-name: normal-rocket-animate-1;\n    \t          animation-name: normal-rocket-animate-1;\n    \t  -webkit-animation-delay: 0.3s;\n    \t          animation-delay: 0.3s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: turquoise;\n    \t}\n    \t.bomb-rocket:nth-child(4) {\n    \t  left: 48vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-2;\n    \t          animation-name: bomb-rocket-animate-2;\n    \t  -webkit-animation-delay: 0.2s;\n    \t          animation-delay: 0.2s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: hotpink;\n    \t}\n    \t.normal-rocket:nth-child(19) {\n    \t  left: 2vw;\n    \t  -webkit-animation-name: normal-rocket-animate-2;\n    \t          animation-name: normal-rocket-animate-2;\n    \t  -webkit-animation-delay: 2s;\n    \t          animation-delay: 2s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: yellow;\n    \t}\n    \t.bomb-rocket:nth-child(5) {\n    \t  left: 67vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-3;\n    \t          animation-name: bomb-rocket-animate-3;\n    \t  -webkit-animation-delay: 1.5s;\n    \t          animation-delay: 1.5s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: turquoise;\n    \t}\n    \t.normal-rocket:nth-child(20) {\n    \t  left: 4vw;\n    \t  -webkit-animation-name: normal-rocket-animate-3;\n    \t          animation-name: normal-rocket-animate-3;\n    \t  -webkit-animation-delay: 1.7s;\n    \t          animation-delay: 1.7s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: yellow;\n    \t}\n    \t.bomb-rocket:nth-child(6) {\n    \t  left: 13vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-1;\n    \t          animation-name: bomb-rocket-animate-1;\n    \t  -webkit-animation-delay: 0.2s;\n    \t          animation-delay: 0.2s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: red;\n    \t}\n    \t.normal-rocket:nth-child(21) {\n    \t  left: 21vw;\n    \t  -webkit-animation-name: normal-rocket-animate-1;\n    \t          animation-name: normal-rocket-animate-1;\n    \t  -webkit-animation-delay: 0.3s;\n    \t          animation-delay: 0.3s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: deepskyblue;\n    \t}\n    \t.bomb-rocket:nth-child(7) {\n    \t  left: 78vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-2;\n    \t          animation-name: bomb-rocket-animate-2;\n    \t  -webkit-animation-delay: 0.3s;\n    \t          animation-delay: 0.3s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: springgreen;\n    \t}\n    \t.normal-rocket:nth-child(22) {\n    \t  left: 80vw;\n    \t  -webkit-animation-name: normal-rocket-animate-2;\n    \t          animation-name: normal-rocket-animate-2;\n    \t  -webkit-animation-delay: 1.7s;\n    \t          animation-delay: 1.7s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: hotpink;\n    \t}\n    \t.bomb-rocket:nth-child(8) {\n    \t  left: 29vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-3;\n    \t          animation-name: bomb-rocket-animate-3;\n    \t  -webkit-animation-delay: 0.2s;\n    \t          animation-delay: 0.2s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: deepskyblue;\n    \t}\n    \t.normal-rocket:nth-child(23) {\n    \t  left: 57vw;\n    \t  -webkit-animation-name: normal-rocket-animate-3;\n    \t          animation-name: normal-rocket-animate-3;\n    \t  -webkit-animation-delay: 1.9s;\n    \t          animation-delay: 1.9s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: turquoise;\n    \t}\n    \t.bomb-rocket:nth-child(9) {\n    \t  left: 66vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-1;\n    \t          animation-name: bomb-rocket-animate-1;\n    \t  -webkit-animation-delay: 0.4s;\n    \t          animation-delay: 0.4s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: springgreen;\n    \t}\n    \t.normal-rocket:nth-child(24) {\n    \t  left: 85vw;\n    \t  -webkit-animation-name: normal-rocket-animate-1;\n    \t          animation-name: normal-rocket-animate-1;\n    \t  -webkit-animation-delay: 1.8s;\n    \t          animation-delay: 1.8s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: turquoise;\n    \t}\n    \t.bomb-rocket:nth-child(10) {\n    \t  left: 49vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-2;\n    \t          animation-name: bomb-rocket-animate-2;\n    \t  -webkit-animation-delay: 1.9s;\n    \t          animation-delay: 1.9s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: yellow;\n    \t}\n    \t.normal-rocket:nth-child(25) {\n    \t  left: 78vw;\n    \t  -webkit-animation-name: normal-rocket-animate-2;\n    \t          animation-name: normal-rocket-animate-2;\n    \t  -webkit-animation-delay: 1.1s;\n    \t          animation-delay: 1.1s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: turquoise;\n    \t}\n    \t.bomb-rocket:nth-child(11) {\n    \t  left: 87vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-3;\n    \t          animation-name: bomb-rocket-animate-3;\n    \t  -webkit-animation-delay: 1.5s;\n    \t          animation-delay: 1.5s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: hotpink;\n    \t}\n    \t.normal-rocket:nth-child(26) {\n    \t  left: 37vw;\n    \t  -webkit-animation-name: normal-rocket-animate-3;\n    \t          animation-name: normal-rocket-animate-3;\n    \t  -webkit-animation-delay: 1.8s;\n    \t          animation-delay: 1.8s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: deepskyblue;\n    \t}\n    \t.bomb-rocket:nth-child(12) {\n    \t  left: 86vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-1;\n    \t          animation-name: bomb-rocket-animate-1;\n    \t  -webkit-animation-delay: 1.7s;\n    \t          animation-delay: 1.7s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: hotpink;\n    \t}\n    \t.normal-rocket:nth-child(27) {\n    \t  left: 29vw;\n    \t  -webkit-animation-name: normal-rocket-animate-1;\n    \t          animation-name: normal-rocket-animate-1;\n    \t  -webkit-animation-delay: 0.8s;\n    \t          animation-delay: 0.8s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: hotpink;\n    \t}\n    \t.bomb-rocket:nth-child(13) {\n    \t  left: 97vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-2;\n    \t          animation-name: bomb-rocket-animate-2;\n    \t  -webkit-animation-delay: 0.6s;\n    \t          animation-delay: 0.6s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: deepskyblue;\n    \t}\n    \t.normal-rocket:nth-child(28) {\n    \t  left: 8vw;\n    \t  -webkit-animation-name: normal-rocket-animate-2;\n    \t          animation-name: normal-rocket-animate-2;\n    \t  -webkit-animation-delay: 0.8s;\n    \t          animation-delay: 0.8s;\n    \t  -webkit-animation-duration: 4s;\n    \t          animation-duration: 4s;\n    \t  color: springgreen;\n    \t}\n    \t.bomb-rocket:nth-child(14) {\n    \t  left: 92vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-3;\n    \t          animation-name: bomb-rocket-animate-3;\n    \t  -webkit-animation-delay: 0.6s;\n    \t          animation-delay: 0.6s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: hotpink;\n    \t}\n    \t.normal-rocket:nth-child(29) {\n    \t  left: 37vw;\n    \t  -webkit-animation-name: normal-rocket-animate-3;\n    \t          animation-name: normal-rocket-animate-3;\n    \t  -webkit-animation-delay: 0.5s;\n    \t          animation-delay: 0.5s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: yellow;\n    \t}\n    \t.bomb-rocket:nth-child(15) {\n    \t  left: 1vw;\n    \t  -webkit-animation-name: bomb-rocket-animate-1;\n    \t          animation-name: bomb-rocket-animate-1;\n    \t  -webkit-animation-delay: 2s;\n    \t          animation-delay: 2s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: hotpink;\n    \t}\n    \t.normal-rocket:nth-child(30) {\n    \t  left: 48vw;\n    \t  -webkit-animation-name: normal-rocket-animate-1;\n    \t          animation-name: normal-rocket-animate-1;\n    \t  -webkit-animation-delay: 2s;\n    \t          animation-delay: 2s;\n    \t  -webkit-animation-duration: 5s;\n    \t          animation-duration: 5s;\n    \t  color: red;\n    \t}\n    \t@-webkit-keyframes bomb-rocket-animate-1 {\n    \t  0% {\n    \t    -webkit-transform: rotate(-10deg) translateY(0) scale(0);\n    \t            transform: rotate(-10deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@keyframes bomb-rocket-animate-1 {\n    \t  0% {\n    \t    -webkit-transform: rotate(-10deg) translateY(0) scale(0);\n    \t            transform: rotate(-10deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@-webkit-keyframes bomb-rocket-animate-2 {\n    \t  0% {\n    \t    -webkit-transform: rotate(0deg) translateY(0) scale(0);\n    \t            transform: rotate(0deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(0deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(0deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@keyframes bomb-rocket-animate-2 {\n    \t  0% {\n    \t    -webkit-transform: rotate(0deg) translateY(0) scale(0);\n    \t            transform: rotate(0deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(0deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(0deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@-webkit-keyframes bomb-rocket-animate-3 {\n    \t  0% {\n    \t    -webkit-transform: rotate(10deg) translateY(0) scale(0);\n    \t            transform: rotate(10deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(10deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(10deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@keyframes bomb-rocket-animate-3 {\n    \t  0% {\n    \t    -webkit-transform: rotate(10deg) translateY(0) scale(0);\n    \t            transform: rotate(10deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(10deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(10deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 344.68271px 60.77686px 5px #fff, 344.68271px 60.77686px 10px #fff, 344.68271px 60.77686px 20px currentColor, 344.68271px 60.77686px 30px currentColor, 344.68271px 60.77686px 40px currentColor, 344.68271px 60.77686px 55px currentColor, 344.68271px 60.77686px 75px currentColor, 187.93852px 68.40403px 5px #fff, 187.93852px 68.40403px 10px #fff, 187.93852px 68.40403px 20px currentColor, 187.93852px 68.40403px 30px currentColor, 187.93852px 68.40403px 40px currentColor, 187.93852px 68.40403px 55px currentColor, 187.93852px 68.40403px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 268.11556px 224.97566px 5px #fff, 268.11556px 224.97566px 10px #fff, 268.11556px 224.97566px 20px currentColor, 268.11556px 224.97566px 30px currentColor, 268.11556px 224.97566px 40px currentColor, 268.11556px 224.97566px 55px currentColor, 268.11556px 224.97566px 75px currentColor, 128.55752px 153.20889px 5px #fff, 128.55752px 153.20889px 10px #fff, 128.55752px 153.20889px 20px currentColor, 128.55752px 153.20889px 30px currentColor, 128.55752px 153.20889px 40px currentColor, 128.55752px 153.20889px 55px currentColor, 128.55752px 153.20889px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 119.70705px 328.89242px 5px #fff, 119.70705px 328.89242px 10px #fff, 119.70705px 328.89242px 20px currentColor, 119.70705px 328.89242px 30px currentColor, 119.70705px 328.89242px 40px currentColor, 119.70705px 328.89242px 55px currentColor, 119.70705px 328.89242px 75px currentColor, 34.72964px 196.96155px 5px #fff, 34.72964px 196.96155px 10px #fff, 34.72964px 196.96155px 20px currentColor, 34.72964px 196.96155px 30px currentColor, 34.72964px 196.96155px 40px currentColor, 34.72964px 196.96155px 55px currentColor, 34.72964px 196.96155px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -60.77686px 344.68271px 5px #fff, -60.77686px 344.68271px 10px #fff, -60.77686px 344.68271px 20px currentColor, -60.77686px 344.68271px 30px currentColor, -60.77686px 344.68271px 40px currentColor, -60.77686px 344.68271px 55px currentColor, -60.77686px 344.68271px 75px currentColor, -68.40403px 187.93852px 5px #fff, -68.40403px 187.93852px 10px #fff, -68.40403px 187.93852px 20px currentColor, -68.40403px 187.93852px 30px currentColor, -68.40403px 187.93852px 40px currentColor, -68.40403px 187.93852px 55px currentColor, -68.40403px 187.93852px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -224.97566px 268.11556px 5px #fff, -224.97566px 268.11556px 10px #fff, -224.97566px 268.11556px 20px currentColor, -224.97566px 268.11556px 30px currentColor, -224.97566px 268.11556px 40px currentColor, -224.97566px 268.11556px 55px currentColor, -224.97566px 268.11556px 75px currentColor, -153.20889px 128.55752px 5px #fff, -153.20889px 128.55752px 10px #fff, -153.20889px 128.55752px 20px currentColor, -153.20889px 128.55752px 30px currentColor, -153.20889px 128.55752px 40px currentColor, -153.20889px 128.55752px 55px currentColor, -153.20889px 128.55752px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -328.89242px 119.70705px 5px #fff, -328.89242px 119.70705px 10px #fff, -328.89242px 119.70705px 20px currentColor, -328.89242px 119.70705px 30px currentColor, -328.89242px 119.70705px 40px currentColor, -328.89242px 119.70705px 55px currentColor, -328.89242px 119.70705px 75px currentColor, -196.96155px 34.72964px 5px #fff, -196.96155px 34.72964px 10px #fff, -196.96155px 34.72964px 20px currentColor, -196.96155px 34.72964px 30px currentColor, -196.96155px 34.72964px 40px currentColor, -196.96155px 34.72964px 55px currentColor, -196.96155px 34.72964px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -344.68271px -60.77686px 5px #fff, -344.68271px -60.77686px 10px #fff, -344.68271px -60.77686px 20px currentColor, -344.68271px -60.77686px 30px currentColor, -344.68271px -60.77686px 40px currentColor, -344.68271px -60.77686px 55px currentColor, -344.68271px -60.77686px 75px currentColor, -187.93852px -68.40403px 5px #fff, -187.93852px -68.40403px 10px #fff, -187.93852px -68.40403px 20px currentColor, -187.93852px -68.40403px 30px currentColor, -187.93852px -68.40403px 40px currentColor, -187.93852px -68.40403px 55px currentColor, -187.93852px -68.40403px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -268.11556px -224.97566px 5px #fff, -268.11556px -224.97566px 10px #fff, -268.11556px -224.97566px 20px currentColor, -268.11556px -224.97566px 30px currentColor, -268.11556px -224.97566px 40px currentColor, -268.11556px -224.97566px 55px currentColor, -268.11556px -224.97566px 75px currentColor, -128.55752px -153.20889px 5px #fff, -128.55752px -153.20889px 10px #fff, -128.55752px -153.20889px 20px currentColor, -128.55752px -153.20889px 30px currentColor, -128.55752px -153.20889px 40px currentColor, -128.55752px -153.20889px 55px currentColor, -128.55752px -153.20889px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -119.70705px -328.89242px 5px #fff, -119.70705px -328.89242px 10px #fff, -119.70705px -328.89242px 20px currentColor, -119.70705px -328.89242px 30px currentColor, -119.70705px -328.89242px 40px currentColor, -119.70705px -328.89242px 55px currentColor, -119.70705px -328.89242px 75px currentColor, -34.72964px -196.96155px 5px #fff, -34.72964px -196.96155px 10px #fff, -34.72964px -196.96155px 20px currentColor, -34.72964px -196.96155px 30px currentColor, -34.72964px -196.96155px 40px currentColor, -34.72964px -196.96155px 55px currentColor, -34.72964px -196.96155px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 60.77686px -344.68271px 5px #fff, 60.77686px -344.68271px 10px #fff, 60.77686px -344.68271px 20px currentColor, 60.77686px -344.68271px 30px currentColor, 60.77686px -344.68271px 40px currentColor, 60.77686px -344.68271px 55px currentColor, 60.77686px -344.68271px 75px currentColor, 68.40403px -187.93852px 5px #fff, 68.40403px -187.93852px 10px #fff, 68.40403px -187.93852px 20px currentColor, 68.40403px -187.93852px 30px currentColor, 68.40403px -187.93852px 40px currentColor, 68.40403px -187.93852px 55px currentColor, 68.40403px -187.93852px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 224.97566px -268.11556px 5px #fff, 224.97566px -268.11556px 10px #fff, 224.97566px -268.11556px 20px currentColor, 224.97566px -268.11556px 30px currentColor, 224.97566px -268.11556px 40px currentColor, 224.97566px -268.11556px 55px currentColor, 224.97566px -268.11556px 75px currentColor, 153.20889px -128.55752px 5px #fff, 153.20889px -128.55752px 10px #fff, 153.20889px -128.55752px 20px currentColor, 153.20889px -128.55752px 30px currentColor, 153.20889px -128.55752px 40px currentColor, 153.20889px -128.55752px 55px currentColor, 153.20889px -128.55752px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 328.89242px -119.70705px 5px #fff, 328.89242px -119.70705px 10px #fff, 328.89242px -119.70705px 20px currentColor, 328.89242px -119.70705px 30px currentColor, 328.89242px -119.70705px 40px currentColor, 328.89242px -119.70705px 55px currentColor, 328.89242px -119.70705px 75px currentColor, 196.96155px -34.72964px 5px #fff, 196.96155px -34.72964px 10px #fff, 196.96155px -34.72964px 20px currentColor, 196.96155px -34.72964px 30px currentColor, 196.96155px -34.72964px 40px currentColor, 196.96155px -34.72964px 55px currentColor, 196.96155px -34.72964px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@-webkit-keyframes normal-rocket-animate-1 {\n    \t  0% {\n    \t    -webkit-transform: rotate(-10deg) translateY(0) scale(0);\n    \t            transform: rotate(-10deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@keyframes normal-rocket-animate-1 {\n    \t  0% {\n    \t    -webkit-transform: rotate(-10deg) translateY(0) scale(0);\n    \t            transform: rotate(-10deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(-10deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t            transform: rotate(-10deg) translateY(-50vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@-webkit-keyframes normal-rocket-animate-2 {\n    \t  0% {\n    \t    -webkit-transform: rotate(0deg) translateY(0) scale(0);\n    \t            transform: rotate(0deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(0deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(0deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@keyframes normal-rocket-animate-2 {\n    \t  0% {\n    \t    -webkit-transform: rotate(0deg) translateY(0) scale(0);\n    \t            transform: rotate(0deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(0deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(0deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t            transform: rotate(0deg) translateY(-60vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@-webkit-keyframes normal-rocket-animate-3 {\n    \t  0% {\n    \t    -webkit-transform: rotate(10deg) translateY(0) scale(0);\n    \t            transform: rotate(10deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(10deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(10deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n    \t@keyframes normal-rocket-animate-3 {\n    \t  0% {\n    \t    -webkit-transform: rotate(10deg) translateY(0) scale(0);\n    \t            transform: rotate(10deg) translateY(0) scale(0);\n    \t    opacity: 1;\n    \t    box-shadow: none;\n    \t  }\n    \t  0.1% {\n    \t    -webkit-transform: rotate(10deg) translateY(0) scale(0.1, 0.5);\n    \t            transform: rotate(10deg) translateY(0) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1, 0.5);\n    \t    background: -webkit-linear-gradient(top, currentColor 0%, #000000 80%);\n    \t    background: linear-gradient(180deg, currentColor 0%, #000000 80%);\n    \t    box-shadow: none;\n    \t    opacity: 1;\n    \t  }\n    \t  50.1% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor, 0 0 5px #fff, 0 0 10px #fff, 0 0 20px currentColor, 0 0 30px currentColor, 0 0 40px currentColor, 0 0 55px currentColor, 0 0 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  75% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 1;\n    \t  }\n    \t  100% {\n    \t    -webkit-transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t            transform: rotate(10deg) translateY(-70vh) scale(0.1);\n    \t    background: transparent;\n    \t    box-shadow: 500px 0px 5px #fff, 500px 0px 10px #fff, 500px 0px 20px currentColor, 500px 0px 30px currentColor, 500px 0px 40px currentColor, 500px 0px 55px currentColor, 500px 0px 75px currentColor, 492.40388px 86.82409px 5px #fff, 492.40388px 86.82409px 10px #fff, 492.40388px 86.82409px 20px currentColor, 492.40388px 86.82409px 30px currentColor, 492.40388px 86.82409px 40px currentColor, 492.40388px 86.82409px 55px currentColor, 492.40388px 86.82409px 75px currentColor, 469.84631px 171.01007px 5px #fff, 469.84631px 171.01007px 10px #fff, 469.84631px 171.01007px 20px currentColor, 469.84631px 171.01007px 30px currentColor, 469.84631px 171.01007px 40px currentColor, 469.84631px 171.01007px 55px currentColor, 469.84631px 171.01007px 75px currentColor, 433.0127px 250px 5px #fff, 433.0127px 250px 10px #fff, 433.0127px 250px 20px currentColor, 433.0127px 250px 30px currentColor, 433.0127px 250px 40px currentColor, 433.0127px 250px 55px currentColor, 433.0127px 250px 75px currentColor, 383.02222px 321.3938px 5px #fff, 383.02222px 321.3938px 10px #fff, 383.02222px 321.3938px 20px currentColor, 383.02222px 321.3938px 30px currentColor, 383.02222px 321.3938px 40px currentColor, 383.02222px 321.3938px 55px currentColor, 383.02222px 321.3938px 75px currentColor, 321.3938px 383.02222px 5px #fff, 321.3938px 383.02222px 10px #fff, 321.3938px 383.02222px 20px currentColor, 321.3938px 383.02222px 30px currentColor, 321.3938px 383.02222px 40px currentColor, 321.3938px 383.02222px 55px currentColor, 321.3938px 383.02222px 75px currentColor, 250px 433.0127px 5px #fff, 250px 433.0127px 10px #fff, 250px 433.0127px 20px currentColor, 250px 433.0127px 30px currentColor, 250px 433.0127px 40px currentColor, 250px 433.0127px 55px currentColor, 250px 433.0127px 75px currentColor, 171.01007px 469.84631px 5px #fff, 171.01007px 469.84631px 10px #fff, 171.01007px 469.84631px 20px currentColor, 171.01007px 469.84631px 30px currentColor, 171.01007px 469.84631px 40px currentColor, 171.01007px 469.84631px 55px currentColor, 171.01007px 469.84631px 75px currentColor, 86.82409px 492.40388px 5px #fff, 86.82409px 492.40388px 10px #fff, 86.82409px 492.40388px 20px currentColor, 86.82409px 492.40388px 30px currentColor, 86.82409px 492.40388px 40px currentColor, 86.82409px 492.40388px 55px currentColor, 86.82409px 492.40388px 75px currentColor, 0px 500px 5px #fff, 0px 500px 10px #fff, 0px 500px 20px currentColor, 0px 500px 30px currentColor, 0px 500px 40px currentColor, 0px 500px 55px currentColor, 0px 500px 75px currentColor, -86.82409px 492.40388px 5px #fff, -86.82409px 492.40388px 10px #fff, -86.82409px 492.40388px 20px currentColor, -86.82409px 492.40388px 30px currentColor, -86.82409px 492.40388px 40px currentColor, -86.82409px 492.40388px 55px currentColor, -86.82409px 492.40388px 75px currentColor, -171.01007px 469.84631px 5px #fff, -171.01007px 469.84631px 10px #fff, -171.01007px 469.84631px 20px currentColor, -171.01007px 469.84631px 30px currentColor, -171.01007px 469.84631px 40px currentColor, -171.01007px 469.84631px 55px currentColor, -171.01007px 469.84631px 75px currentColor, -250px 433.0127px 5px #fff, -250px 433.0127px 10px #fff, -250px 433.0127px 20px currentColor, -250px 433.0127px 30px currentColor, -250px 433.0127px 40px currentColor, -250px 433.0127px 55px currentColor, -250px 433.0127px 75px currentColor, -321.3938px 383.02222px 5px #fff, -321.3938px 383.02222px 10px #fff, -321.3938px 383.02222px 20px currentColor, -321.3938px 383.02222px 30px currentColor, -321.3938px 383.02222px 40px currentColor, -321.3938px 383.02222px 55px currentColor, -321.3938px 383.02222px 75px currentColor, -383.02222px 321.3938px 5px #fff, -383.02222px 321.3938px 10px #fff, -383.02222px 321.3938px 20px currentColor, -383.02222px 321.3938px 30px currentColor, -383.02222px 321.3938px 40px currentColor, -383.02222px 321.3938px 55px currentColor, -383.02222px 321.3938px 75px currentColor, -433.0127px 250px 5px #fff, -433.0127px 250px 10px #fff, -433.0127px 250px 20px currentColor, -433.0127px 250px 30px currentColor, -433.0127px 250px 40px currentColor, -433.0127px 250px 55px currentColor, -433.0127px 250px 75px currentColor, -469.84631px 171.01007px 5px #fff, -469.84631px 171.01007px 10px #fff, -469.84631px 171.01007px 20px currentColor, -469.84631px 171.01007px 30px currentColor, -469.84631px 171.01007px 40px currentColor, -469.84631px 171.01007px 55px currentColor, -469.84631px 171.01007px 75px currentColor, -492.40388px 86.82409px 5px #fff, -492.40388px 86.82409px 10px #fff, -492.40388px 86.82409px 20px currentColor, -492.40388px 86.82409px 30px currentColor, -492.40388px 86.82409px 40px currentColor, -492.40388px 86.82409px 55px currentColor, -492.40388px 86.82409px 75px currentColor, -500px 0px 5px #fff, -500px 0px 10px #fff, -500px 0px 20px currentColor, -500px 0px 30px currentColor, -500px 0px 40px currentColor, -500px 0px 55px currentColor, -500px 0px 75px currentColor, -492.40388px -86.82409px 5px #fff, -492.40388px -86.82409px 10px #fff, -492.40388px -86.82409px 20px currentColor, -492.40388px -86.82409px 30px currentColor, -492.40388px -86.82409px 40px currentColor, -492.40388px -86.82409px 55px currentColor, -492.40388px -86.82409px 75px currentColor, -469.84631px -171.01007px 5px #fff, -469.84631px -171.01007px 10px #fff, -469.84631px -171.01007px 20px currentColor, -469.84631px -171.01007px 30px currentColor, -469.84631px -171.01007px 40px currentColor, -469.84631px -171.01007px 55px currentColor, -469.84631px -171.01007px 75px currentColor, -433.0127px -250px 5px #fff, -433.0127px -250px 10px #fff, -433.0127px -250px 20px currentColor, -433.0127px -250px 30px currentColor, -433.0127px -250px 40px currentColor, -433.0127px -250px 55px currentColor, -433.0127px -250px 75px currentColor, -383.02222px -321.3938px 5px #fff, -383.02222px -321.3938px 10px #fff, -383.02222px -321.3938px 20px currentColor, -383.02222px -321.3938px 30px currentColor, -383.02222px -321.3938px 40px currentColor, -383.02222px -321.3938px 55px currentColor, -383.02222px -321.3938px 75px currentColor, -321.3938px -383.02222px 5px #fff, -321.3938px -383.02222px 10px #fff, -321.3938px -383.02222px 20px currentColor, -321.3938px -383.02222px 30px currentColor, -321.3938px -383.02222px 40px currentColor, -321.3938px -383.02222px 55px currentColor, -321.3938px -383.02222px 75px currentColor, -250px -433.0127px 5px #fff, -250px -433.0127px 10px #fff, -250px -433.0127px 20px currentColor, -250px -433.0127px 30px currentColor, -250px -433.0127px 40px currentColor, -250px -433.0127px 55px currentColor, -250px -433.0127px 75px currentColor, -171.01007px -469.84631px 5px #fff, -171.01007px -469.84631px 10px #fff, -171.01007px -469.84631px 20px currentColor, -171.01007px -469.84631px 30px currentColor, -171.01007px -469.84631px 40px currentColor, -171.01007px -469.84631px 55px currentColor, -171.01007px -469.84631px 75px currentColor, -86.82409px -492.40388px 5px #fff, -86.82409px -492.40388px 10px #fff, -86.82409px -492.40388px 20px currentColor, -86.82409px -492.40388px 30px currentColor, -86.82409px -492.40388px 40px currentColor, -86.82409px -492.40388px 55px currentColor, -86.82409px -492.40388px 75px currentColor, 0px -500px 5px #fff, 0px -500px 10px #fff, 0px -500px 20px currentColor, 0px -500px 30px currentColor, 0px -500px 40px currentColor, 0px -500px 55px currentColor, 0px -500px 75px currentColor, 86.82409px -492.40388px 5px #fff, 86.82409px -492.40388px 10px #fff, 86.82409px -492.40388px 20px currentColor, 86.82409px -492.40388px 30px currentColor, 86.82409px -492.40388px 40px currentColor, 86.82409px -492.40388px 55px currentColor, 86.82409px -492.40388px 75px currentColor, 171.01007px -469.84631px 5px #fff, 171.01007px -469.84631px 10px #fff, 171.01007px -469.84631px 20px currentColor, 171.01007px -469.84631px 30px currentColor, 171.01007px -469.84631px 40px currentColor, 171.01007px -469.84631px 55px currentColor, 171.01007px -469.84631px 75px currentColor, 250px -433.0127px 5px #fff, 250px -433.0127px 10px #fff, 250px -433.0127px 20px currentColor, 250px -433.0127px 30px currentColor, 250px -433.0127px 40px currentColor, 250px -433.0127px 55px currentColor, 250px -433.0127px 75px currentColor, 321.3938px -383.02222px 5px #fff, 321.3938px -383.02222px 10px #fff, 321.3938px -383.02222px 20px currentColor, 321.3938px -383.02222px 30px currentColor, 321.3938px -383.02222px 40px currentColor, 321.3938px -383.02222px 55px currentColor, 321.3938px -383.02222px 75px currentColor, 383.02222px -321.3938px 5px #fff, 383.02222px -321.3938px 10px #fff, 383.02222px -321.3938px 20px currentColor, 383.02222px -321.3938px 30px currentColor, 383.02222px -321.3938px 40px currentColor, 383.02222px -321.3938px 55px currentColor, 383.02222px -321.3938px 75px currentColor, 433.0127px -250px 5px #fff, 433.0127px -250px 10px #fff, 433.0127px -250px 20px currentColor, 433.0127px -250px 30px currentColor, 433.0127px -250px 40px currentColor, 433.0127px -250px 55px currentColor, 433.0127px -250px 75px currentColor, 469.84631px -171.01007px 5px #fff, 469.84631px -171.01007px 10px #fff, 469.84631px -171.01007px 20px currentColor, 469.84631px -171.01007px 30px currentColor, 469.84631px -171.01007px 40px currentColor, 469.84631px -171.01007px 55px currentColor, 469.84631px -171.01007px 75px currentColor, 492.40388px -86.82409px 5px #fff, 492.40388px -86.82409px 10px #fff, 492.40388px -86.82409px 20px currentColor, 492.40388px -86.82409px 30px currentColor, 492.40388px -86.82409px 40px currentColor, 492.40388px -86.82409px 55px currentColor, 492.40388px -86.82409px 75px currentColor;\n    \t    opacity: 0;\n    \t  }\n    \t}\n       \u003c/style\u003e\n\u003c/body\u003e\n","date":1567900800,"description":"","fuzzywordcount":39200,"kind":"page","lang":"zh","lastmod":1567900800,"objectID":"a0fe170547a06d753b6b8d27d2fa7fe9","publishdate":1567900800,"relpermalink":"/posts/mixed/fireworks/","section":"posts","summary":"\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;春江花月夜 \u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026","tags":["CSS"],"title":"Happy 颖","url":"https://xdhuxc.github.io/posts/mixed/fireworks/","wordcount":39138},{"categories":"posts","content":"\u003cp\u003e        有一天，我去超市买东西，买了半个西瓜和几条黄瓜，我留意看了下两张单子上的价格尾数，都是4。但是在收银台结算的时候，收银员最后却告诉我，“15元”。我很疑惑，两个4相加，怎么变成零了？于是，我仔细看了下单子，西瓜总价7.24元，黄瓜7.74元，并把单子给两位收银员阿姨看，她们仔细看了下后，突然想起什么来了，告诉我，“这是收银机四舍五入的结果”。好吧，我明白了。\n　　对于超市来说，按照这种四舍五入的逻辑收银，那就意味着尾数为5、6、7、8、9的时候，向上进位，分别多收0.05元、0.04元、0.03元、0.02元、0.01元；尾数为1、2、3、4时，向下取整，分别损失0.01元、0.02元、0.03元、0.04元；尾数为0时，既不多收，也不损失。那么，在完全随机的情况下，也就是现实生活中，尾数为0、1、2、3、4、5、6、7、8、9的概率都是0.1，于是，在平均意义上，就有：\n\u003ccenter\u003e\n\u003cimg src=\"/image/human/mixed-seven/020701.png\"/\u003e\n\u003c/center\u003e\n　　Xi在多收时为正值，在损失时为负值，于是就有：\u003c/p\u003e\n\u003cp\u003e　　E(X)=0\u003cem\u003e0.1-0.01\u003c/em\u003e.01-0.02\u003cem\u003e0.1-0.03\u003c/em\u003e0.1-0.04\u003cem\u003e0.1+0.05\u003c/em\u003e0.1+0.04\u003cem\u003e0.1+0.03\u003c/em\u003e0.1+0.02\u003cem\u003e0.1+0.01\u003c/em\u003e0.1=0.005(元)\u003c/p\u003e\n\u003cp\u003e　　这个数值E(X)的含义是：在平均意义上，每笔收银可以多获得0.005元。在收银次数F非常大的情况下，每笔收银将会真的平均多获得0.005元左右，F的值越大，这个值将会越接近0.005元，总共多获得F*0.005元。\u003c/p\u003e\n\u003cp\u003e　　这个0.005元多不多呢？无论是就其数值本身来说，还是其占一笔收银账款的相对值来讲，其实都可以忽略不计。但在其和收银次数 F 相乘之后，这个数值可能就不小了，就变成了每千笔收银多收入5元。那么，如果一家超市年收银次数在百万次（等价于每月83334次，每天2778次，不太清楚能有多少超市达到甚至超过这个数值。我们强调的是，互联网时代和超级城市产生的量变引起的质变，重点不在于超市收银这一场景），就意味着会多出来近5千元左右的收入，这个数值差不多可以负担一两个收银员一个月的工资了。2018年个税改革之后，8000万人将不用再缴纳个人所得税了，翻译成人话来说，就是有 8000万人在2018年时的月收入在3500~5000元这个区间附近，2018年之前肯定比这更低。与此同时，共和国还有与此数量相当的人口属于贫困人口，根据一种让人感到不可思议的贫困标准划分的。\u003c/p\u003e\n\u003cp\u003e　　考虑到这样一个社会现实，社会总体上是向前进步的，发展着的；但是很多组织和个人是不可信的，有着自己的特殊想法的。基于此，我们做如下恶意猜想：对于称重类的商品，如果对电子秤做手脚，在其计算的时候（因为人可以很容易地控制这个计算逻辑，如果做得高明，可能还需要参考商品单价和其质量的关系，以避免被怀疑），总是将尾数上调至5、6、7、8、9中随机一个，那么在收银计算时，无论其他商品总价如何，至少有一件商品为超市带来了平均0.005元的贡献，从而最后的实际期望就变成了：（假设含称重类商品的收银次数占到总收银次数的四分之三）\u003c/p\u003e\n\u003cp\u003e　　E(X)≥ 0.75*(0.05*0.1 + 0.04*0.1 + 0.03*0.1 + 0.02*0.1 + 0.01*0.1) - 0.25*(0.04*0.1 + 0.03*0.1 + 0.02*0.1 + 0.01*0.1)=0.00875(元)\u003c/p\u003e\n\u003cp\u003e　　对于一家年收银次数达到甚至超过百万次的超市来说，稍微有点儿特殊的想法，可能就又多赚差不多一个收银员一个月的工资。嗯，是的，是这样的。\u003c/p\u003e\n\u003cp\u003e　　实际上，这点钱对于一家超市来说，可能微不足道，但对于一个工薪阶层的人来说，还是能算上让其心疼的钱的。\u003c/p\u003e\n\u003cp\u003e　　这是为什么呢？其实原因可能是这样的，这是历史的遗留问题，原来使用纸币支付时，找零，尤其是货币的最小单位分这个太麻烦，对于超市和顾客都麻烦，而且已经渐渐没有流通中的人民币分了，于是收银机就把“四舍五入”的功能给直接做到其总计功能中去了，但电子支付使得可以精确地支付到人民币分这一最小货币单位，这就暴露出来问题了。而电子支付和纸币支付同时使用使得这个问题将会长期存在。但是如果在默认使用电子结算和支付的机器上进行“四舍五入”，那么就不好说是历史遗留问题还是有意为之了。\u003c/p\u003e\n\u003cp\u003e　　0.01元，这究竟是什么呢？\u003c/p\u003e\n\u003cp\u003e　　这是以货币形式表现的抽象的无差别的人类劳动。价值是什么？价值是凝结在商品中无差别的人类劳动。这个结论起始于这样一种思考，甲商品和乙商品能够进行交换，这是为什么呢？是什么使得它们能够交换的？必然是它们两者都包含的某种同质的东西，外部表现为数量关系？这种同质的东西，在人们探索争论之后，确定为：无差别的人类劳动，并基于此解释人类社会的政治经济问题。\u003c/p\u003e\n\u003cp\u003e　　于是，0.01元、一滴水、一度电、一顿饭、一件衣服、一个苹果、一本书、一克黄金等等，所有这些通过商品交换获得的东西，都包含着同质的存在物：无差别的人类劳动。有意思的事情就是这样子的，有些人在浪费包括食物、水、电等资源性的和消耗（区别于正常的使用）服务性（比如怼服务员、快递员等）的无差别人类劳动时，内心没有一丝波动，甚至还往往会有莫名其妙的优越感；但是这些人下一秒可能就会抱怨996、007，或调侃自己的贫穷了。践踏别人的劳动时如此随心自然，甚至理直气壮，被别人践踏时，各种申冤抱屈理论就迸发出来了，“我是知识流氓，我怕谁？”。一粥一饭，当思来之不易；半丝半缕，恒念物力维艰，劳动是多么辛苦的一件事，这些人恐怕是知道的吧！然而，如果没有珍惜这种无差别的人类劳动的意识和行动，无论增量和（或）存量情况怎么样，这种无差别的人类劳动总是不够用的，因为那个很简单的道理啊。像国人这样有意识地和（或）无意识地浪费资源，甚至是炫耀式地浪费，如果共和国的城市化水平达到知识分子们所谓的\u0026quot;国际标准\u0026quot;，这地球如何承受得了？\u003c/p\u003e\n\u003cp\u003e　　某月，我租住的房子门上贴了水费单，共105元。于是，我就缴了105元水费，然后将缴费页面截图发到四户租住的人群里。随后，其他三户分别发了微信红包给我，竟然不约而同地发了27元红包。如果是我，我肯定会用总值除以人数，然后对小数点后第三位向上取整，然后发红包的，因为本该如此。\u003c/p\u003e\n\u003cp\u003e　　看来，中国人真的已经富裕起来了！\u003c/p\u003e","date":1567900800,"description":"","fuzzywordcount":2500,"kind":"page","lang":"zh","lastmod":1567900800,"objectID":"5a54b0dc96b8ee6b67278a0746b4f2e3","publishdate":1567900800,"relpermalink":"/posts/human/human-world-mixed-seven/","section":"posts","summary":"","tags":["人间世"],"title":"人间世·杂七","url":"https://xdhuxc.github.io/posts/human/human-world-mixed-seven/","wordcount":2430},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 consul 的部署及配置和基本使用。\u003c/p\u003e\n\u003ch3 id=\"基于-docker-安装-consul\"\u003e基于 docker 安装 consul\u003c/h3\u003e\n\u003cp\u003e1、使用 docker 安装 consul\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull consul\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d --name=consul --network=host -e CONSUL_BIND_INTERFACE=eth0 consul\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"原生方式安装-consul\"\u003e原生方式安装 consul\u003c/h3\u003e\n\u003cp\u003e1、下载 \u003ca href=\"https://www.consul.io/downloads.html\"\u003e安装包\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://releases.hashicorp.com/consul/1.6.2/consul_1.6.2_linux_amd64.zip\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、解压\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eunzip consul_1.6.2_linux_amd64.zip \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 consul\u003c/p\u003e\n\u003cp\u003e1）添加执行权限并移动 consul 到 /usr/bin 目录下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003echmod +x consul \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e cp consul /usr/bin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）配置 consul.service（/usr/lib/systemd/system/consul.service），文件内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=confd\nDocumentation=http://www.consul.io/\nAfter=network.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/consul agent -dev -client 0.0.0.0 -ui\n\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eagent 启动参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-dev：以开发环境模式运行，这种模式下 consul节点既是 client，也是 server\u003c/li\u003e\n\u003cli\u003e-client：指定客户端访问的地址，客户端通过 RPC，DNS，HTTP，gRPC 访问都需要用这个地址，可以指定其为：0.0.0.0 绑定所有客户端地址\u003c/li\u003e\n\u003cli\u003e-ui：启动内置的 UI Web 服务\u003c/li\u003e\n\u003cli\u003e-bind：指定 consul 集群节点之间通信的地址\u003c/li\u003e\n\u003cli\u003e-data-dir：指定 consul 节点存放数据的目录\u003c/li\u003e\n\u003cli\u003e-bootstrap-expect：指定期望的 server 节点数量\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e3）启动 consul\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e systemctl restart consul\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"读写数据\"\u003e读写数据\u003c/h3\u003e\n\u003cp\u003e1）添加或更新数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econsul kv put xdhuxc/consul/1 dc1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）查询数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econsul kv get xdhuxc/consul/1\n或\nconsul kv get --detailed xdhuxc/consul/1\n或 \nconsul kv get -recurse # 查询所有数据\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）删除数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econsul kv delete xdhuxc/consul/1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"常用命令\"\u003e常用命令\u003c/h3\u003e\n\u003cp\u003e1、查看集群成员\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econsul members \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果想知道更详细的信息，可以添加 \u003ccode\u003e--detailed\u003c/code\u003e 参数来获得\u003c/p\u003e\n\u003cp\u003e2、停止 consul agent\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econsul leave\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e官方安装指南 \u003ca href=\"https://www.consul.io/docs/install/index.html\"\u003ehttps://www.consul.io/docs/install/index.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/f4e2b2aabd21\"\u003ehttps://www.jianshu.com/p/f4e2b2aabd21\u003c/a\u003e\u003c/p\u003e","date":1566259200,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1577930224,"objectID":"0bb99ab88efceaae9e911561b095343e","publishdate":1566259200,"relpermalink":"/posts/storage/consul/consul-simple-use/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 consul 的部署及配置和基本使用。\u003c/p\u003e","tags":["Consul"],"title":"Consul 的基本使用","url":"https://xdhuxc.github.io/posts/storage/consul/consul-simple-use/","wordcount":539},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 sqlite 的基本使用方法，以备后需。\u003c/p\u003e\n\u003ch3 id=\"sqlite-安装\"\u003esqlite 安装\u003c/h3\u003e\n\u003cp\u003eMac 和 Linux 已经默认安装，使用命令 \u003ccode\u003ewhich sqlite3\u003c/code\u003e 即可查到安装目录，一般为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/usr/bin/sqlite3\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"基本命令\"\u003e基本命令\u003c/h3\u003e\n\u003cp\u003e1、创建数据库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esqlite3 share.db\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看数据库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:~ wanghuan$ sqlite3 /Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/share/sql/share.db # 打开数据库 share.db\nSQLite version 3.24.0 2018-06-04 14:10:15\nEnter \u0026#34;.help\u0026#34; for usage hints.\nsqlite\u0026gt; .databases\nmain: /Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/share/sql/share.db\nsqlite\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、创建数据库表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esqlite\u0026gt; .tables\nsqlite\u0026gt; CREATE TABLE \u003cspan class=\"sb\"\u003e`xdhuxc`\u003c/span\u003e (\n   ...\u0026gt;     \u003cspan class=\"sb\"\u003e`id`\u003c/span\u003e INT PRIMARY KEY NOT NULL,\n   ...\u0026gt;     \u003cspan class=\"sb\"\u003e`name`\u003c/span\u003e VARCHAR(50) NOT NULL,\n   ...\u0026gt;     \u003cspan class=\"sb\"\u003e`code`\u003c/span\u003e CHAR(6) NOT NULL,\n   ...\u0026gt;     \u003cspan class=\"sb\"\u003e`level`\u003c/span\u003e CHAR(5) NOT NULL,\n   ...\u0026gt;     \u003cspan class=\"sb\"\u003e`buy_price`\u003c/span\u003e REAL NOT NULL,\n   ...\u0026gt;     \u003cspan class=\"sb\"\u003e`sell_price`\u003c/span\u003e REAL NOT NULL\n   ...\u0026gt; );\nsqlite\u0026gt; .tables\nshare\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、退出 sqlite\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esqlite\u0026gt; .exit\nwanghuans-MBP:~ wanghuan$\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"可视化\"\u003e可视化\u003c/h3\u003e\n\u003cp\u003e可以使用 \u003ccode\u003eDBeaver\u003c/code\u003e，\u003ccode\u003eTablePlus\u003c/code\u003e 等可视化工具操作之。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.runoob.com/sqlite/sqlite-create-table.html\"\u003ehttps://www.runoob.com/sqlite/sqlite-create-table.html\u003c/a\u003e\u003c/p\u003e","date":1565913600,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1577516379,"objectID":"fe843298dafb57ed95184d5a076c5a6f","publishdate":1565913600,"relpermalink":"/posts/storage/sqlite/sqlite-basic-use/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 sqlite 的基本使用方法，以备后需。\u003c/p\u003e","tags":["SQL","sqlite","数据库"],"title":"sqlite 基本使用","url":"https://xdhuxc.github.io/posts/storage/sqlite/sqlite-basic-use/","wordcount":221},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下在 golang 中使用 glog 的方式，在一些项目中可能会用到，有些地方需要注意。\u003c/p\u003e\n\u003cp\u003egolang/glog 是 google/glog 的 Go 版本实现，基本上实现了原生 glog 的日志格式。在 Kubernetes 中，glog 是默认日志库。\u003c/p\u003e\n\u003ch3 id=\"基本使用\"\u003e基本使用\u003c/h3\u003e\n\u003cp\u003eglog 将日志级别分为 4 种，分别是：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eINFO：普通日志；\u003c/li\u003e\n\u003cli\u003eWARNING：警告日志；\u003c/li\u003e\n\u003cli\u003eERROR：错误日志；\u003c/li\u003e\n\u003cli\u003eFATAL：严重错误日志，打印完日志后程序将会退出。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eglog 的使用示例\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport (\n\t\u0026#34;flag\u0026#34;\n\n\t\u0026#34;github.com/golang/glog\u0026#34;\n)\n\nfunc main() {\n    // 需要使用 flag.Parse() 解析参数，如果不加此语句，会报错误并输出所有级别日志\n    flag.Parse()\n    defer glog.Flush()\n\n    glog.Infoln(\u0026#34;This is a info log for glog\u0026#34;)\n    glog.Infof(\u0026#34;This is a info format log for %s\u0026#34;, \u0026#34;glog\u0026#34;)\n\n    glog.Warningln(\u0026#34;This is a warning log for glog\u0026#34;)\n    glog.Warningf(\u0026#34;This is a warning format log for %s\u0026#34;, \u0026#34;glog\u0026#34;)\n\n    glog.Errorln(\u0026#34;This is a error log for glog\u0026#34;)\n    glog.Errorf(\u0026#34;This is a error format log for %s\u0026#34;, \u0026#34;glog\u0026#34;)\n\n    /*\n    glog.Fatalln(\u0026#34;This is a fatal log for glog\u0026#34;)\n    glog.Fatalf(\u0026#34;This is a fatal format log for %s\u0026#34;, \u0026#34;glog\u0026#34;)\n    */\n\n    // 用于程序结束前刷出缓冲区中的所有日志\n    glog.Flush()\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e1、默认的日志等级为 2，也就是错误日志及严重错误日志才会输出，因此本地运行时，INFO 和 WARNING 级别的日志不会输出，要想让其输出，需要加入如下参数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego run main.go --v 2 --logtostderr true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在使用 docker 运行该应用时，Dockerfile 可参考如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCMD [\u0026#34;xdhuxc-checker\u0026#34;, \u0026#34;--config\u0026#34;, \u0026#34;/etc/xdhuxc/config.prod.yaml\u0026#34;, \u0026#34;--v\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;--logtostderr\u0026#34;, \u0026#34;true\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://zhengyinyong.com/glog-internal.html\"\u003ehttps://zhengyinyong.com/glog-internal.html\u003c/a\u003e\u003c/p\u003e","date":1565308800,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1565308800,"objectID":"48942a8f15a775cbaa8c93d9bbbda9f2","publishdate":1565308800,"relpermalink":"/posts/programming/golang/golang-glog/","section":"posts","summary":"\u003cp\u003e本篇博客记录下在 golang 中使用 glog 的方式，在一些项目中可能会用到，有些地方需要注意。\u003c/p\u003e","tags":["Golang","Log"],"title":"Go glog 日志包的使用","url":"https://xdhuxc.github.io/posts/programming/golang/golang-glog/","wordcount":449},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下在 golang 中进行集合操作的方式，在一些项目中可能会用到。\u003c/p\u003e\n\u003cp\u003e我们使用 \u003ccode\u003egolang-set\u003c/code\u003e 这个包来进行集合操作。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport (\n\t\u0026#34;fmt\u0026#34;\n\tmapset \u0026#34;github.com/deckarep/golang-set\u0026#34;\n)\n\nfunc main() {\n    // 初始化集合 envs\n\tenvs := mapset.NewSet()\n\t// 向集合 envs 中添加元素\n\tenvs.Add(\u0026#34;prod\u0026#34;)\n\tenvs.Add(\u0026#34;test\u0026#34;)\n\tenvs.Add(\u0026#34;pre\u0026#34;)\n\n\tenv := \u0026#34;alpha\u0026#34;\n\t// 判断集合 envs 中是否包含指定元素\n\tif envs.Contains(env) {\n\t\tfmt.Println(\u0026#34;包含\u0026#34;)\n\t} else {\n\t\tfmt.Println(\u0026#34;不包含\u0026#34;)\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e1、从 interface 数组生成新的集合\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurrentEnvs := mapset.NewSetFromSlice([]interface{}{\u0026#34;prod\u0026#34;, \u0026#34;test\u0026#34;, \u0026#34;alpha\u0026#34;})\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、差集计算\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edifferenceSet := envs.Difference(currentEnvs) // envs 对 currentEnvs 的差集\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、判断父集合子集\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eisSuperSet := envs.IsSuperset(currentEnvs)\nisSubSet := currentEnvs.IsSubset(envs)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003eIsProperSubset(other Set) bool\u003c/code\u003e 和 \u003ccode\u003eIsProperSuperset(other Set) bool\u003c/code\u003e 与这两个方法的区别在于：这两者不包括两个集合相等的情况\u003c/p\u003e\n\u003cp\u003e4、并集计算\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eunionSet := envs.Union(currentEnvs)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、交集计算\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eintersection := envs.Intersect(currentEnvs)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、集合相等判断\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eisEqual := envs.Equal(currentEnvs)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、获取集合元素个数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eenvs.Cardinality()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、删除集合元素\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eenvs.Remove(\u0026#34;pre\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果删除的元素不存在，不会出现错误。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/deckarep/golang-set\"\u003ehttps://github.com/deckarep/golang-set\u003c/a\u003e\u003c/p\u003e","date":1565308800,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1565308800,"objectID":"3c441f8f42420c8a3358a5d4d1ec38c8","publishdate":1565308800,"relpermalink":"/posts/programming/golang/golang-set/","section":"posts","summary":"\u003cp\u003e本篇博客记录下在 golang 中进行集合操作的方式，在一些项目中可能会用到。\u003c/p\u003e","tags":["Golang","Set"],"title":"Go Set 的使用","url":"https://xdhuxc.github.io/posts/programming/golang/golang-set/","wordcount":345},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍 Vim 的常用命令及技巧，以备后需。\u003c/p\u003e\n\u003ch3 id=\"常用命令\"\u003e常用命令\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e以下操作均在命令模式下进行\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、显示行号或取消行号，输入\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e:set nonumber # 关闭行号\n:set number   # 开启行号\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查找字符串\n命令模式下，输入\u003ccode\u003e/user\u003c/code\u003e，则会查找字符串\u003ccode\u003euser\u003c/code\u003e（\u003ccode\u003e/要搜索的字符串或者字符\u003c/code\u003e），按下回车之后，可以看到 vim 已经把光标移动到该字符处和高亮了匹配的字符串（vi没高亮，因为它没有颜色）\u003c/p\u003e\n\u003cp\u003e按下 n(小写n)用于查看下一个匹配；按下N（大写N）查看上一个匹配，可以按下Caps Lock键切换大小写，也可以在小写状态按下Shift + n\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003e?user\u003c/code\u003e（\u003ccode\u003e?要搜索的字符串或者字符\u003c/code\u003e），从文件的结尾处往开始处搜索\u003c/p\u003e\n\u003cp\u003e2、取消高亮，输入\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e:nohlsearch\n:set nohlsearch\n:set noh # 简写\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、跳转至文件头部，在命令模式下，按两次 \u003ccode\u003eg\u003c/code\u003e；跳转至文件尾部，在命令模式下，输入 \u003ccode\u003eG\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e4、删除一行，在命令模式下，按两次 \u003ccode\u003ed\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e5、替换每一行中所有的 \u003ccode\u003estr1\u003c/code\u003e 为 \u003ccode\u003estr2\u003c/code\u003e，在命令模式下，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e:%s/str1/str2/g\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e替换当前行所有的 \u003ccode\u003estr1\u003c/code\u003e 为 \u003ccode\u003estr2\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e:s/str1/str2/g\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、按 \u003ccode\u003eu\u003c/code\u003e 可以撤销一次操作\u003c/p\u003e\n\u003cp\u003e7、跳转到指定行\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e打开文件时，使用如下命令打开文件，可直接到指定行\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evim xdhuxc.yaml +25 # 打开文件后光标跳转到第 25 行\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e在命令模式下，直接输入行号，然后回车\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e:25 # 回车后跳转到第 25 行\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"常见问题及解决\"\u003e常见问题及解决\u003c/h3\u003e\n\u003cp\u003e1、将复制的代码粘贴到 vim 中时，代码缩进产生了混乱\u003c/p\u003e\n\u003cp\u003e原因：终端处理粘贴的文本时，会存入键盘缓存。vim 处理时，会把这些内容作为用户键盘输入来处理。如果 vim 开启了自动缩进，那么在遇到换行符时，就会默认把上一行的缩进插入到下一行的开头。\u003c/p\u003e\n\u003cp\u003e解决：vim 编辑模式中有一个 paste 模式，该模式下，可将文本保持原样粘贴到 vim 中，以避免一些格式错误。在 vim 中输入命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e:set paste   # 设置粘贴模式\n:set nopaste # 取消粘贴模式\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1565136000,"description":"","fuzzywordcount":700,"kind":"page","lang":"zh","lastmod":1565136000,"objectID":"f44a8e7d12a3ac3782913776b16fa59e","publishdate":1565136000,"relpermalink":"/posts/tools/tools-vim/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍 Vim 的常用命令及技巧，以备后需。\u003c/p\u003e","tags":["Vim"],"title":"Vim 常用命令及技巧","url":"https://xdhuxc.github.io/posts/tools/tools-vim/","wordcount":675},{"categories":"posts","content":"\u003cp\u003e        香港“占中”事件发生后，有记者问总理，“香港究竟怎么了？”总理回答说，“如果以后有人问你这个问题，你就说，香港将保持长期繁荣稳定。”\u003c/p\u003e\n\u003cp\u003e　　香港问题的鸡肋之处在于，如果香港继续保持繁荣稳定发展，那是资本主义自由制度的胜利果实，但是一旦香港出现衰落，盎格鲁-撒克逊人肯定会利用他们在国际上的学术和舆论力量进行广泛渲染和动员，将其归咎于共和国中央政府，但共和国中央政府是不会把这颗苦胆一直含在嘴里的。\u003c/p\u003e\n\u003cp\u003e　　本次盎格鲁-撒克逊人策划的香港暴乱事件，其实也算是一个机会吧。此次暴乱事件，挑战共和国中央政府权威，也给香港的社会和国际声誉造成了非常严重的破坏性影响。这次暴乱事件，香港社会政界、商界、学界、立法界、司法界等社会主要力量群体对香港社会繁荣稳定的大局，对中央政府权威的维护，对国家的忠诚将全部地体现出来。目前来看，司法界（清一色的盎格鲁-撒克逊国籍，对于“占中”事件的处理，黄之锋等人判刑几个月，但是维护社会秩序的警察则判处两年）和学界（暴乱者大多是学生）基本上是站在暴乱者的一方，政界和商界情况不甚明确，政界和商界都呼吁不要暴力，有些有影响力的人物没有表态或表态模糊，但是却没有解决实际问题，如果以林郑月娥、董建华、梁振英等为首的政界不能妥善解决此次暴乱事件，那么中央政府肯定会怀疑香港政界对国家的忠诚。对外表示相信这些人，对其忠诚和能力有信心，如果事态没有得到妥善解决，而是越闹越大，这可就不好说他们是故意纵容暴乱事件，还是没有力量和能力解决这些问题了。\u003c/p\u003e\n\u003cp\u003e　　如果真的要解决这些问题，等到香港各界人士在此次暴乱事件中表明自己的态度和立场后，共和国中央可以通过全国人大或其常委会立法，对香港的英国殖民遗留问题进行彻底清算，包括司法系统中的外籍人员问题、历史和语文教科书问题、英美情报人员问题等等，同时也对香港社会政界、学界、司法界、立法界、商界等系统进行彻底清算，一举解决影响香港社会繁荣稳定的问题。由于有此次暴乱事件作为依据，这样做在各方都会得到广泛地支持，当然英美肯定会表示“关切和忧虑”的。其实这也算英美采取了错误的策略，过早地采取了激进的操作，给共和国中央以机会。香港社会目前有两个主要矛盾：1、外部，内陆以深圳、上海、北京为代表的城市的巨大发展让香港人有巨大的失落感，如果香港发展停滞不前甚至衰落，可能将会沦落到新一线城市甚至都不如的地步。国家提出粤港澳湾区规划，但是香港人不珍惜；2、内部，香港富豪家族对资源尤其是基础设施资源的垄断导致普通民众生活艰辛，年轻人没有希望。如果英美的策略是利用这两个矛盾，舆论上进行渲染，利用香港人的失落感分隔内地和香港；团结和组织年轻人和底层民众不停地搞小动作，持续地一直搞，表达自己生活艰辛的痛苦和合理的利益诉求，就可以让香港永无宁日。那问题就很麻烦了，因为这两个问题对香港来说，根本就解决不了。\u003c/p\u003e\n\u003cp\u003e　　美国不过是想通过这样的事情来刺激共和国，将共和国引入他们设计的圈套中，但是共和国还是岿然不动，仅仅通过开新闻发布会表明态度和立场，通过官方媒体表明态度和立场，并没有采取实质性行动，因为这些事情还犯不着出手。其实，香港暴乱事件对共和国是一个小事情，顶多是面子上不好看，影响非常有限。但是在什么情况下，共和国中央会出手呢？例如香港有人组织公投，妄图独立，这种情况下，表明态度就不够用了，中央政府肯定会出手的。\u003c/p\u003e\n\u003cp\u003e　　香港的暴乱事件也充分说明把一个国家或地区的精英群体死死地捆绑在脚下的土地上是一件多么重要的事情，不然这片土地上的普通老百姓最终是要为此付出代价的。可以通过立法来管控这方面，规定国家公职人员必须是本国国籍，对于领导干部，包括父母、配偶、子女等在内的直系亲属也都必须是本国国籍，绝不能让“裸官”当领导干部；对于商界，需要把这纳入资本管制和信贷管理考察之中；对于学界，限制这些人在外任职挂职的数量，否则，这些精英群体很有可能吃中国人的饭，砸中国人的锅，就像香港现在的情况一样。\u003c/p\u003e\n\u003cp\u003e　　另外，香港能乱到哪里去呢？\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://www.ceweekly.cn/2016/0316/144634.shtml\"\u003ehttp://www.ceweekly.cn/2016/0316/144634.shtml\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mp.weixin.qq.com/s/ntQQBNahUO9CvwiCzeJ2SA\"\u003ehttps://mp.weixin.qq.com/s/ntQQBNahUO9CvwiCzeJ2SA\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mp.weixin.qq.com/s/XbMoZLB-_iNDC9WhGI6v8A\"\u003ehttps://mp.weixin.qq.com/s/XbMoZLB-_iNDC9WhGI6v8A\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mp.weixin.qq.com/s?src=11\u0026amp;timestamp=1565186243\u0026amp;ver=1776\u0026amp;signature=ofRGRmQ0K2BS\"\u003ehttps://mp.weixin.qq.com/s?src=11\u0026amp;timestamp=1565186243\u0026amp;ver=1776\u0026amp;signature=ofRGRmQ0K2BS\u003c/a\u003e\u003cem\u003eMjaUEXtpdcN7G7Ptob\u003c/em\u003e8ynW\u003cem\u003eLEGF6tqhWdEn5IyUpWj19Nsv\u003c/em\u003eXKAOFFW2TkqhDS-APLO70RK2kyV4ATSvHR2pvoNrzNrI4XFhmEQJe4IQK74j6s38iw\u0026amp;new=1\u003c/p\u003e","date":1565136000,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1565136000,"objectID":"af54db4d5ae8d2a004cdd89acf69d19f","publishdate":1565136000,"relpermalink":"/posts/human/human-world-mixed-six/","section":"posts","summary":"","tags":["人间世"],"title":"人间世·杂六","url":"https://xdhuxc.github.io/posts/human/human-world-mixed-six/","wordcount":1620},{"categories":"posts","content":"\u003cp\u003e本部分内容记录下 golang 开发时常见的一些问题及解决方法。\u003c/p\u003e\n\u003ch3 id=\"x509-certificate-signed-by-unknown-authority\"\u003ex509: certificate signed by unknown authority\u003c/h3\u003e\n\u003cp\u003e编写代码请求华为云 API，使用 docker 容器部署，基础镜像为 \u003ccode\u003egeekidea/alpine-a:3.9\u003c/code\u003e，执行 do 方法时报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eE0807 05:11:19.285019       1 elb_job.go:67] Get https://elb.ap-southeast-3.myhuaweicloud.com/v2.0/lbaas/loadbalancers: x509: certificate signed by unknown authority\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 Dockerfile 中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eRUN apk update \\\n        \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apk upgrade \\\n        \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apk add --no-cache \\\n        ca-certificates \\\n        \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e update-ca-certificates 2\u0026gt;/dev/null || true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e更新 \u003ccode\u003eca-certificates\u003c/code\u003e 试试。\u003c/p\u003e\n\u003ch3 id=\"make-build-报错\"\u003emake build 报错\u003c/h3\u003e\n\u003cp\u003e1）使用 \u003ccode\u003emake build\u003c/code\u003e 进行构建时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:xdhuxc-transform wanghuan$ make build\n\u0026gt;\u0026gt; go build ...\nbuild command-line-arguments: cannot load gitlab.xdhuxc.com/xdhuxc/xdhuxc-transform/src/apis: git ls-remote -q ssh://git@gitlab.xdhuxc.com/xdhuxc.git in /Users/wanghuan/GolandProjects/GoPath/pkg/mod/cache/vcs/32878bb63a0c857fed210744986dde9a48418788fe89eee3f24d5b73f5abcd2a: exit status 128:\n        GitLab: The project you were looking for could not be found.\n        fatal: Could not read from remote repository.\n        \n        Please make sure you have the correct access rights\n        and the repository exists.\nmake: \u003cspan class=\"ge\"\u003e**\u003c/span\u003e* [build] Error 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：以前是可以正常构建的，把 go 版本升级到 1.13 后，就变成这样了，该版本有问题，回退到 1.12 即可解决问题。\u003c/p\u003e\n\u003cp\u003e2）使用 \u003ccode\u003emake build\u003c/code\u003e 进行构建时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:hawkeye wanghuan$ make build\n\u0026gt;\u0026gt; go build ...\n\u003cspan class=\"gh\"\u003e# gitlab.xdhuxc.org/SGT/DevOps/hawkeye/src/apis\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esrc/apis/base.go:55:38: cannot use req (type \u003cspan class=\"ge\"\u003e*\u0026#34;gitlab.xdhuxc.com/xdhuxc/hawkeye/vendor/github.com/emicklei/go-restful\u0026#34;.Request) as type *\u003c/span\u003e\u0026#34;github.com/emicklei/go-restful\u0026#34;.Request in argument to b.auth.GetCustomValue\nsrc/apis/router.go:54:46: cannot use baseController.auth.Auth (type func(*\u0026#34;github.com/emicklei/go-restful\u0026#34;.Request, \u003cspan class=\"ge\"\u003e*\u0026#34;github.com/emicklei/go-restful\u0026#34;.Response, *\u003c/span\u003e\u0026#34;github.com/emicklei/go-restful\u0026#34;.FilterChain)) as type \u0026#34;gitlab.xdhuxc.com/xdhuxc/hawkeye/vendor/github.com/emicklei/go-restful\u0026#34;.FilterFunction in argument to baseController.ws.Filter\nmake: \u003cspan class=\"ge\"\u003e**\u003c/span\u003e* [build] Error 2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：删除本地项目中 \u003ccode\u003egitlab.xdhuxc.com/xdhuxc/hawkeye/vendor/github.com/emicklei/go-restful\u003c/code\u003e 目录，重新编译。\u003c/p\u003e\n\u003ch3 id=\"向-map-中写入键值对时报错-panicassignment-to-entry-in-nil-map\"\u003e向 map 中写入键值对时，报错 \u003ccode\u003epanic：assignment to entry in nil map\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e因为该 map 的初始化方式不对，当仅写 \u003ccode\u003evar map[keyType]ValueType\u003c/code\u003e 时，会得到 nil map，此时向 map 中插入键值对时，会报上述错误。\u003c/p\u003e\n\u003cp\u003e一旦使用 make() 函数进行初始化，就不是 nil map 了。\u003c/p\u003e\n\u003ch3 id=\"都是标签惹的祸\"\u003e都是标签惹的祸\u003c/h3\u003e\n\u003cp\u003e在进行 JSON 序列化时，如果给结构体中某两个字段定义了相同的标签值，则这两个字段在序列化后的 JSON 体中都将会被去掉。\u003c/p\u003e\n\u003cp\u003e比如，如下的结构体：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport (\n\t\u0026#34;encoding/json\u0026#34;\n\t\u0026#34;fmt\u0026#34;\n)\n\ntype User struct {\n\tID string \u003cspan class=\"sb\"\u003e`json:\u0026#34;id\u0026#34;`\u003c/span\u003e\n\tName string \u003cspan class=\"sb\"\u003e`json:\u0026#34;name\u0026#34;`\u003c/span\u003e\n\tAddress string  \u003cspan class=\"sb\"\u003e`json:\u0026#34;address\u0026#34;`\u003c/span\u003e\n\tPassword string \u003cspan class=\"sb\"\u003e`json:\u0026#34;name\u0026#34;`\u003c/span\u003e\n}\n\nfunc main() {\n\tuser := User{\n\t\tID: \u0026#34;abc\u0026#34;,\n\t\tName: \u0026#34;xdhuxc\u0026#34;,\n\t\tAddress: \u0026#34;s\u0026#34;,\n\t\tPassword: \u0026#34;073#asd\u0026#34;,\n\t}\n\tdataInBytes, _ := json.Marshal(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003euser)\n\tfmt.Println(string(dataInBytes))\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e输出结果如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\u0026#34;id\u0026#34;:\u0026#34;abc\u0026#34;,\u0026#34;address\u0026#34;:\u0026#34;s\u0026#34;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将字段 Name 和 Password 的 JSON 标签设置为相同的后，两个字段在序列化后直接被去掉了。\u003c/p\u003e\n\u003ch3 id=\"使用-go-mod-tidy-命令报错\"\u003e使用 \u003ccode\u003ego mod tidy\u003c/code\u003e 命令报错\u003c/h3\u003e\n\u003cp\u003e使用 \u003ccode\u003ego mod tidy\u003c/code\u003e 命令时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:confd wanghuan$ go mod tidy\ngo: modules disabled inside GOPATH/src by GO111MODULE=auto; see \u0026#39;go help modules\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e默认设置的 \u003ccode\u003eGO111MODULE=auto\u003c/code\u003e 导致 \u003ccode\u003emodules\u003c/code\u003e 默认在 \u003ccode\u003e$GOPATH/src\u003c/code\u003e 路径下是不启用的。如果需要在 \u003ccode\u003e$GOPATH/src\u003c/code\u003e 目录下也能使用 \u003ccode\u003emodules\u003c/code\u003e，需要把 \u003ccode\u003eGO111MODULE\u003c/code\u003e 环境变量设置为 \u003ccode\u003eon\u003c/code\u003e。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eexport GO111MODULE=on\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"使用-vscode-运行-golang-程序单元测试没有代码日志输出\"\u003e使用 VSCode 运行 golang 程序单元测试，没有代码日志输出\u003c/h3\u003e\n\u003cp\u003e在 \u003ccode\u003e.vscode/settings.json\u003c/code\u003e 文件中，加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026#34;go.testFlags\u0026#34;: [\n    \u0026#34;-v\u0026#34;\n],\n\u0026#34;go.testTimeout\u0026#34;: \u0026#34;300s\u0026#34;,  # 单元测试执行时间超过 300s，则直接结束该测试，\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"使用-git-拉取私有仓库代码时报错\"\u003e使用 git 拉取私有仓库代码时，报错\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewanghuan@wanghuans-MBP xdhuxc-cicd % make build\n\u0026gt;\u0026gt; go build ...\ngo: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/log\ngo: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/src/models\ngo: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-jenkins\ngo: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/pkg\ngo: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/src/service\ngo: finding module for package gitlab.xdhuxc.com/sgt/xdhuxc-common/event\nsrc/apis/base.go:9:2: module gitlab.xdhuxc.com/sgt/xdhuxc-common/event: git ls-remote -q origin in /Users/wanghuan/GolandProjects/GoPath/pkg/mod/cache/vcs/28da36e7c579b99f1d7066993405e1672802dc58e6f44b68d781fae79c0b54fb: exit status 128:\n        fatal: could not read Username for 'https://gitlab.xdhuxc.com': terminal prompts disabled\nConfirm the import path was entered correctly.\nIf this is a private repository, see https://golang.org/doc/faq#git_https for additional information.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e参照 \u003ca href=\"https://golang.org/doc/faq#git_https\"\u003ehttps://golang.org/doc/faq#git_https\u003c/a\u003e 中的方法，在 ~/.gitconfig 文件中加入如下内容：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[url \u0026quot;ssh://git@gitlab.xdhuxc.com/\u0026quot;]\n        insteadOf = https://gitlab.xdhuxc.com/\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"this-download-does-not-match-the-one-reported-by-the-checksum-server\"\u003eThis download does NOT match the one reported by the checksum server.\u003c/h3\u003e\n\u003cp\u003e使用 \u003ccode\u003ego mod tidy\u003c/code\u003e 整理 golang 项目依赖时，控制台显示如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuan@wanghuans-MacBook-Pro scmp-common % go mod tidy\ngithub.com/panjf2000/ants@v1.2.0: verifying module: checksum mismatch\n        downloaded: h1:Ufw4aDz9RqH1RVblx2W9L9Uv5vSX5apbX5+peR7LQ5k=\n        sum.golang.org: h1:pMQ1/XpSgnWx3ro4y1xr/uA3jXUsTuAaU3Dm0JjwggE=\n\nSECURITY ERROR\nThis download does NOT match the one reported by the checksum server.\nThe bits may have been replaced on the origin server, or an attacker may\nhave intercepted the download attempt.\n\nFor more information, see \u0026#39;go help module-auth\u0026#39;.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：先清理 mod 的缓存，然后再指定该命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego clean -modcache\ngo mod tidy\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1564963200,"description":"","fuzzywordcount":1100,"kind":"page","lang":"zh","lastmod":1564963200,"objectID":"1d3e338f543a17f0f4ef579a91298fa6","publishdate":1564963200,"relpermalink":"/posts/programming/golang/golang-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本部分内容记录下 golang 开发时常见的一些问题及解决方法。\u003c/p\u003e","tags":["Golang"],"title":"Golang 常见问题及解决","url":"https://xdhuxc.github.io/posts/programming/golang/golang-questions-and-solutions/","wordcount":1071},{"categories":"posts","content":"\u003cp\u003e        其实，我觉得现在我们应该支持中美贸易战，在目前这种程度上打下去，中长期来看，对我们的好处是远远大于现在的损失的。当然，如果程度不断加深，不断地加深，会有一方首先妥协的，但大概率不会是美国。\u003c/p\u003e\n\u003cp\u003e　　特朗普掀起的贸易战打碎了中国政、商、学、媒等各界对美国和西方在精神和思想上的依赖甚至依恋，使得中美国联姻进入“冷战期”，从而中国政、商、学、媒等各界就得自己动脑子去思考和解决诸如社会、经济、教育、医疗、科学、技术、伦理等各领域各方面的问题了。一方面是美国不让他们抄袭了，另一方面我们本身的发展在一些方面马上就到无处抄袭的水平了，后续在其他更广更深的方面都会到达无处抄袭的地步，中国人需要尽快明白。\u003c/p\u003e\n\u003cp\u003e　　中美贸易战对我国政府来讲，是一个提高其应对外部风险能力的非常好的锻炼机会，这对于国家长期稳定发展是件好事情。\u003c/p\u003e\n\u003cp\u003e　　中美贸易战只是美国全球范围内贸易战的一部分，长期在目前这个程度（增加10%~30%的贸易关税，不包含其他方面，美帝的全面科技、金融封锁对其他国家都是是致命性的打击）上打下去，会把美国的国家信用打光，会把美国的盟友打光，造成美国的孤立，并且会导致其他国家和组织之间的广泛联合，长期来看，对我国是有利的。\u003c/p\u003e\n\u003cp\u003e　　如果特朗普或特朗普的继任者突然停止了贸易战，很可能会造成中国社会各界（至少有那么一部分人）对美国的错误判断和对中美关系的错误认识，认为美国不敢和中国打贸易战，理由若干，从而心存侥幸，这是非常危险的。\u003c/p\u003e\n\u003cp\u003e　　此次贸易战也将成为中美两国试探对方一般性底线的测试，将为日后中长期时间范围内两国关系处理的重要参照，所以，首先妥协的一方，大幅让步的一方，将可能在日后承担不可承受的巨大代价。\u003c/p\u003e\n\u003cp\u003e　　中国的小朋友已经开始拯救地球了，大人也《流浪地球》了，特朗普瞥了一眼这些人，“你们还是先拯救拯救你们自己吧，地球和宇宙还轮不到你们来拯救！”，这盆冷水泼得正是时候！\u003c/p\u003e\n\u003cp\u003e　　但是从另一方面看，美国人所谓的“对华遏制”似乎有点儿奇怪。\u003c/p\u003e\n\u003cp\u003e　　美国从2018年4月开始对中兴进行制裁，到2019年5月将华为列入“实体名单”，这中间的一年多时间实际上给华为提供了很大的缓冲期来预防不测，当然华为的准备其实比这早多了。如果是战略层面的遏制和打击，从而是经过系统地谋划之后再出招，那么肯定是出其不意，同时发难，全面封杀，而且是轻易不会同意和解的，除非发现打击无效或达不到预期效果，为了场面上大家都好看和后续合作，拿钱了事，同意和解。但是对于中兴，美国人没有赶尽杀绝，而是同意交钱撤人和解，这不是他们仁慈或遵守所谓“规则”，而是他们战略上的混乱所致。\u003c/p\u003e\n\u003cp\u003e　　另一方面，如果美国真的要对中国进行全面遏制和打击，那么为什么没有选择中国的软肋进行全面的攻击呢？如果美国抓住中国的软肋，中国互联网经济和精英阶层对美国的依赖性，对中国的经济和精英阶层进行全面的打击，那么，共和国会不会签署丧权辱国的条约，就很难说了。如果美国利用其技术和金融等综合性力量打击中国的房地产和互联网，对中国的房地产企业和互联网企业进行全面的制裁，包括金融、技术、供应链、准入等企业生产经营的所有方面，制裁对象包括企业及其子公司，关联企业等和公司高管及其家属等个人，如此操作，即便不能使中国经济崩溃，也能很轻松地让美国赚个几万亿。一旦开始制裁，这些公司中的上市公司股价肯定会大幅下降，中兴通讯的股价直接就是腰斩，还可用低价收购优质资产的中国公司，美国资本就可以趁机轻松赚个几万亿。建立在美国基础技术上的中国互联网及其经济将如何保持并发展？投降的声音一定是最大的？另一方面，贫富分化作为中国社会目前最主要的矛盾，美国可以利用这一点，公开中国人在美国和世界其他地方的财产状况，以刺激整个中国社会，激化中国社会的矛盾，这将会对中国社会的政、学、商、媒、娱等精英阶层产生巨大的威胁，从而迫使中国在和美国的谈判中惟命是从。当然了，公开这些信息也是有技巧的，分批公开，先公开小角色的，然后慢慢展开，逐步公开重量级人物的，不断向中国的精英阶层传导极限压力，直到这些人所组成的群体无法承受，将压力层层向上传导，直到整个国家层面的妥协。在这种刺激下，整个中国社会从精英阶层到普通民众的恐慌可想而知。但是，需要注意的是，对知识分子（主要是各大高校和自媒体等）和留学人员（包括正在留学的和有留学经历的），则要施以怀柔政策，不断向这些人输送物质利益和精神利益，比如大肆夸赞这些人的贡献和成就，让他们以和西方合作为荣耀，给他们和美国院校合作的机会，让他们成为“访美学者”，“旅美学者”等，从而这些人将会成为美国在中国的代言人，在中美竞争和对抗中成为内应，成为中国社会力量的腐蚀者。当然了，现在情况也差不多是这样，但是美国可以继续强化这一点。比如在美国对中国企业的制裁中，我国企业明显处于劣势，甚至有些企业的经营和发展已经无法进行下去了，但是还有人在鼓吹“供应链理论”，给我们这个社会营造“美好中好大家好”的氛围，不知道那些被制裁的我国企业的负责人怎么看待“供应链理论”呢？这类理论在中美以合作为主的关系下，是行得通的，也符合实际，但是当中美关系的主流变为竞争甚至斗争时，这类理论的立场和利益偏向性就很明显了。\u003c/p\u003e\n\u003cp\u003e　　如果美国如此谋划并实施，不知道还有多少中国人对我们在贸易站及其后继的对美斗争中胜利有信心呢？当然了，作为国家之间的斗争，实际比这要系统和缜密地多，也要狠毒和致命地多，还要占据舆论和理论制高点，让对方把血吐尽，还要说不出话来，就像苏联那样。\u003c/p\u003e\n\u003cp\u003e　　之所以是今天的局面，绝不是美国仁慈，可怜他们在中国的代言人，而是美国本身战略混乱的结果，一方面两国之间的竞争和斗争本身还没有到彻底撕破脸的地步，另一方面，特朗普这个二三流的商人总统对政治问题，包括国内政治和国际政治的思考太过简单和随机，从其“推特治国”释放消息的小聪明可以推知，快四年了，他还是没从二三流商人的小手段中走出来，一流的商人和政治家是不可能靠这种方式胜利的。\u003c/p\u003e\n\u003cp\u003e　　但是，我们需要肯定一点，这个二三流的商人总统凭借着美国总统，唯一超级大国总统的身份和地位，从而其国家的综合性力量，将近代以来，尤其是二战后至今，世界各国政界、商界和学界共同构建和发展起来并普遍认同的国际政治、经济体系给打碎了，各种退群和不合作直接导致无数国际政治、经济和文化等组织和活动无法进行或没有任何成果（是的，没有美国的参与就是没法进行），这一方面暴露了这种体系本身的矛盾和不合理，给共和国提供了“九合诸侯”的机会，另一方面也让世界各国普通老百姓看到，自己的国家在美国面前多么苍白无力和软弱，而且无可奈何。日韩欧洲被迫付给美国军队军费、买美国昂贵的武器、买美国昂贵的能源；中国人被迫吃美国转基因食物换和平（两宋也差不多这样吧）；墨西哥被迫同意对难民采取措施以换取美国不加征关税等等，而这绝对是会变本加厉的，而歌颂美国的，也差不多是这些人吧。如果没有特朗普，这些东西会一直隐藏在普通老百姓的视野之外。\u003c/p\u003e\n\u003cp\u003e　　显然，有些人和组织的“外国友人”对我们中国人不友好啊！\u003c/p\u003e","date":1564790400,"description":"","fuzzywordcount":2900,"kind":"page","lang":"zh","lastmod":1564790400,"objectID":"0b32107995a26b2910fb1c188ed24734","publishdate":1564790400,"relpermalink":"/posts/human/human-world-mixed-two/","section":"posts","summary":"","tags":["人间世"],"title":"人间世·杂二","url":"https://xdhuxc.github.io/posts/human/human-world-mixed-two/","wordcount":2820},{"categories":"posts","content":"\u003cp\u003e本部分内容记录下 Vue 使用过程中的遇到的一些问题，方便后面再次遇到时解决。\u003c/p\u003e\n\u003ch3 id=\"通过父组件向子组件传值时报错如下\"\u003e通过父组件向子组件传值时，报错如下\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evue.runtime.esm.js:587 [Vue warn]: Avoid mutating a prop directly since the value will be overwritten whenever the parent component re-renders. Instead, use a data or computed property based on the prop\u0026#39;s value. Prop being mutated: \u0026#34;pods\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e父组件中引用该组件的方式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003einstances\u003c/span\u003e \u003cspan class=\"na\"\u003e:pods\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;pods\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003einstances\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决方法：在父组件中，改写代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003einstances\u003c/span\u003e \u003cspan class=\"na\"\u003e:pods\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esync\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;pods\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003einstances\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在父组件中改变 pods 数据时，就像平时一样直接改变即可。\u003c/p\u003e\n\u003cp\u003e子组件中，代码改写如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport default {\n  name: \u0026#39;Instances\u0026#39;,\n  props: {\n    pods: {\n      type: Array,\n      default() {\n        return [];\n      }\n    }\n  },\n  data() {\n    return {};\n  }\n}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e子组件中改变数据的代码部分不能采用直接赋值，而要改为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e this.$emit(\u0026#39;update:pods\u0026#39;, pods);\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"error-in-nexttick-typeerror-cannot-read-property-clearvalidate-of-undefined\"\u003eError in nextTick: \u0026quot;TypeError: Cannot read property 'clearValidate' of undefined\u0026quot;\u003c/h3\u003e\n\u003cp\u003e点击编辑按钮时，处理函数代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehandleEdit(index, app) {\n  this.dialogStatus = \u0026#39;update\u0026#39;;\n  this.$nextTick(() =\u0026gt; {\n    this.$refs[\u0026#39;deploymentForm\u0026#39;].clearValidate();\n  });\n  this.getVolumeTypesData(5);\n  this.getURISchemesData(6);\n  this.getPortProtocolsData(7);\n  this.convertBackend2Deployment(app);\n  this.dialogDeploymentVisible = true;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e每次刷新页面后，第一次点击时，总是会报如下错误，而之后的点击事件却没有报错，有点奇怪。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evue.runtime.esm.js:587 [Vue warn]: Error in nextTick: \u0026#34;TypeError: Cannot read property \u0026#39;clearValidate\u0026#39; of undefined\u0026#34;\n\nfound in\n\n---\u0026gt; \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eDeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e at src/views/kubernetes/application/deployment/index.vue\n       \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eApplication\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e at src/views/kubernetes/application/index.vue\n         \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eAppMain\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e at src/views/layout/components/AppMain.vue\n           \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eLayout\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e at src/views/layout/Layout.vue\n             \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eApp\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e at src/App.vue\n               \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eRoot\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\nwarn @ vue.runtime.esm.js:587\nlogError @ vue.runtime.esm.js:1733\nglobalHandleError @ vue.runtime.esm.js:1728\nhandleError @ vue.runtime.esm.js:1717\n(anonymous) @ vue.runtime.esm.js:1835\nflushCallbacks @ vue.runtime.esm.js:1754\nvue.runtime.esm.js:1737 TypeError: Cannot read property \u0026#39;clearValidate\u0026#39; of undefined\n    at VueComponent.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eanonymous\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e (index.vue?bb9b:837)\n    at Array.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eanonymous\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e (vue.runtime.esm.js:1833)\n    at MessagePort.flushCallbacks (vue.runtime.esm.js:1754)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将代码修改为如下方式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehandleEdit(index, app) {\n  this.dialogStatus = \u0026#39;update\u0026#39;;\n  this.getVolumeTypesData(5);\n  this.getURISchemesData(6);\n  this.getPortProtocolsData(7);\n  this.dialogDeploymentVisible = true;    \n  this.convertBackend2Deployment(app);\n  this.$nextTick(() =\u0026gt; {\n    this.$refs[\u0026#39;deploymentForm\u0026#39;].clearValidate();\n  });\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因是，\u003ccode\u003ethis.dialogDeploymentVisible = true\u003c/code\u003e 执行后，才会创建表单 deploymentForm，正是因为执行 \u003ccode\u003ethis.$refs['deploymentForm'].clearValidate()\u003c/code\u003e 时，\u003ccode\u003ethis.dialogDeploymentVisible = true\u003c/code\u003e 还没有执行，表单还没有创建，所以才会抛出上面的错误。\u003c/p\u003e\n\u003ch3 id=\"使用-compression-webpack-plugin-压缩文件时报错\"\u003e使用 compression-webpack-plugin 压缩文件时报错\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:xdhuxc-ui wanghuan$ npm run build:prod --report\n\u003cspan class=\"k\"\u003e\n\u003c/span\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003ecloud-manage-platform@2.0.0 build:prod /Users/wanghuan/WebstormProjects/xdhuxc-ui\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003ecross-env NODE_ENV=production env_config=prod node build/build.js\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\nBrowserslist: caniuse-lite is outdated. Please run next command \u003cspan class=\"sb\"\u003e`npm update caniuse-lite browserslist`\u003c/span\u003e\n/Users/wanghuan/WebstormProjects/xdhuxc-ui/node_modules/compression-webpack-plugin/node_modules/schema-utils/src/validateOptions.js:32\n    throw new ValidationError(ajv.errors, name);\n    ^\n\nValidationError: Compression Plugin Invalid Options\n\noptions should NOT have additional properties\n\n    at validateOptions (/Users/wanghuan/WebstormProjects/xdhuxc-ui/node_modules/compression-webpack-plugin/node_modules/schema-utils/src/validateOptions.js:32:11)\n    at new CompressionPlugin (/Users/wanghuan/WebstormProjects/xdhuxc-ui/node_modules/compression-webpack-plugin/dist/index.js:40:30)\n    at Object.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eanonymous\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e (/Users/wanghuan/WebstormProjects/xdhuxc-ui/build/webpack.prod.conf.js:145:9)\n    at Module._compile (internal/modules/cjs/loader.js:689:30)\n    at Object.Module._extensions..js (internal/modules/cjs/loader.js:700:10)\n    at Module.load (internal/modules/cjs/loader.js:599:32)\n    at tryModuleLoad (internal/modules/cjs/loader.js:538:12)\n    at Function.Module._load (internal/modules/cjs/loader.js:530:3)\n    at Module.require (internal/modules/cjs/loader.js:637:17)\n    at require (internal/modules/cjs/helpers.js:22:18)\n    at Object.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eanonymous\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e (/Users/wanghuan/WebstormProjects/xdhuxc-ui/build/build.js:17:19)\n    at Module._compile (internal/modules/cjs/loader.js:689:30)\n    at Object.Module._extensions..js (internal/modules/cjs/loader.js:700:10)\n    at Module.load (internal/modules/cjs/loader.js:599:32)\n    at tryModuleLoad (internal/modules/cjs/loader.js:538:12)\n    at Function.Module._load (internal/modules/cjs/loader.js:530:3)\n    at Function.Module.runMain (internal/modules/cjs/loader.js:742:12)\n    at startup (internal/bootstrap/node.js:282:19)\n    at bootstrapNodeJSCore (internal/bootstrap/node.js:743:3)\nnpm ERR! code ELIFECYCLE\nnpm ERR! errno 1\nnpm ERR! cloud-manage-platform@2.0.0 build:prod: \u003cspan class=\"sb\"\u003e`cross-env NODE_ENV=production env_config=prod node build/build.js`\u003c/span\u003e\nnpm ERR! Exit status 1\nnpm ERR! \nnpm ERR! Failed at the cloud-manage-platform@2.0.0 build:prod script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /Users/wanghuan/.npm/_logs/2019-10-08T07_42_00_941Z-debug.log\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e主要问题在于 webpack 和 compression-webpack-plugin 的版本的适配性问题，在不同的版本搭配下，compression-webpack-plugin 的配置写法不同。\u003c/p\u003e\n\u003cp\u003e原来默认安装的 compression-webpack-plugin 的版本为 3.0.0，降低版本到 1.1.12，即可正常构建。\u003c/p\u003e\n\u003ch3 id=\"引用组件注意事项\"\u003e引用组件注意事项\u003c/h3\u003e\n\u003cp\u003e引用组件时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026#34;export \u0026#39;InfoCard\u0026#39; was not found in \u0026#39;@/components/InfoCard/index.vue\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可能是引用的方式不对，注意，引用组件是是引用默认的组件，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport InfoCard from \u0026#39;@/components/InfoCard/index.vue\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e而不是命名的组件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport { InfoCard } from \u0026#39;@/components/InfoCard/index.vue\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1564704000,"description":"","fuzzywordcount":1000,"kind":"page","lang":"zh","lastmod":1564704000,"objectID":"a155b6182a402f46f0f1afcd589b341a","publishdate":1564704000,"relpermalink":"/posts/vue/vue-common-question-and-solution/","section":"posts","summary":"\u003cp\u003e本部分内容记录下 Vue 使用过程中的遇到的一些问题，方便后面再次遇到时解决。\u003c/p\u003e","tags":["Vue"],"title":"Vue 常见问题及解决","url":"https://xdhuxc.github.io/posts/vue/vue-common-question-and-solution/","wordcount":980},{"categories":"posts","content":"\u003cp\u003e本部分内容记录下使用 golang 将结构体序列化和反序列化为 JSON 时，需要注意的一些小问题。\u003c/p\u003e\n\u003ch3 id=\"序列化为-json\"\u003e序列化为 JSON\u003c/h3\u003e\n\u003cp\u003e示例代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport (\n\t\u0026#34;encoding/json\u0026#34;\n\t\u0026#34;fmt\u0026#34;\n)\n\ntype User struct {\n\tName string \u003cspan class=\"sb\"\u003e`json:\u0026#34;name\u0026#34;`\u003c/span\u003e\n\tAddresses []Address \u003cspan class=\"sb\"\u003e`json:\u0026#34;addresses\u0026#34;`\u003c/span\u003e\n\tAge int \u003cspan class=\"sb\"\u003e`json:\u0026#34;age,omitempty\u0026#34;`\u003c/span\u003e\n\tEmail []string \u003cspan class=\"sb\"\u003e`json:\u0026#34;email\u0026#34;`\u003c/span\u003e\n\tDepartment string \u003cspan class=\"sb\"\u003e`json:\u0026#34;department,omitempty\u0026#34;`\u003c/span\u003e\n\tProvince string\n}\n\ntype Address struct {\n\tName string \u003cspan class=\"sb\"\u003e`json:\u0026#34;name\u0026#34;`\u003c/span\u003e\n}\n\nfunc (u *User) String() string {\n\n\tif bytes, err := json.Marshal(\u003cspan class=\"ni\"\u003e\u0026amp;u);\u003c/span\u003e err == nil {\n\t\treturn string(bytes)\n\t}\n\n\treturn \u0026#34;\u0026#34;\n}\n\nfunc main() {\n\tu := User{\n\t\tName: \u0026#34;xdhuxc\u0026#34;,\n\t\tEmail: []string{},\n\t\tAge: 20,\n\t}\n\n\tfmt.Println(u.String())\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e输出的结果为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\u0026#34;name\u0026#34;:\u0026#34;xdhuxc\u0026#34;,\u0026#34;addresses\u0026#34;:null,\u0026#34;age\u0026#34;:20,\u0026#34;email\u0026#34;:[],\u0026#34;Province\u0026#34;:\u0026#34;\u0026#34;}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到：\u003c/p\u003e\n\u003cp\u003e1、数组或者切片如果不初始化，默认情况下将会被序列化为 null，这对前端来说是一个非常难处理的事情。但是，赋予空数组或者空切片之后，将会序列化为 JSON 的空数组，因此，对于服务器端 API 来说，在空值情况下，不能不处理，而是要将其设置成空数组或空切片\u003c/p\u003e\n\u003cp\u003e2、增加 omitempty 修饰符后，在该字段零值情况下，将会在序列化时去除掉，因此要慎用该选项，最好不用该修饰符，而是采用零值填充，既不泄露信息，同时也保证字段始终存在，方便在系统中各处判断和使用；但这样做会增加网络传输的数据量，因此需要权衡。\u003c/p\u003e\n\u003cp\u003e3、如果不指定字段的 JSON 标签，默认将使用 golang 字段名称作为 JSON 字段名称，也就是同名迁移。最好为每个字段指定 JSON 标签，在命名上，按照 JSON 字段命名的方式来命名。\u003c/p\u003e\n\u003ch3 id=\"解析-json\"\u003e解析 JSON\u003c/h3\u003e\n\u003cp\u003e我们可以使用 gjson 来解析 JSON 格式的字符串为 go 中的变量，而不需要将其反序列化为 Golang 中的结构体，这在我们只需要少数几个字段的值时非常方便。\n示例如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n  \u0026#34;name\u0026#34;: \u0026#34;xdhuxc\u0026#34;,\n  \u0026#34;age\u0026#34;: 20,\n  \u0026#34;children\u0026#34;: [\u0026#34;A\u0026#34;,\u0026#34;B\u0026#34;,\u0026#34;C\u0026#34;]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下方式可以获取 name 字段的值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ename := gjson.GetBytes(dataInBytes, \u0026#34;name\u0026#34;).String()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以使用 String()，Bool()，Int()，Float()等方法将获取的值转换为需要的类型\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eage := gjson.GetBytes(dataInBytes, \u0026#34;age\u0026#34;).Int()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下方式获取 children 的值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003echildren := gjson.GetBytes(dataInBytes, \u0026#34;children\u0026#34;).Array()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当循环获取 children 的值时，\n\u003ccode\u003egjson.Get(children[i].Raw\u003c/code\u003e 获取到的字符串是带双引号的，即：\u0026quot;B\u0026quot;，而 \u003ccode\u003egjson.Get(children[i].String()\u003c/code\u003e 获取到的字符串是不带双引号的，即：B，在将其获取到的值作为参数传递时，如果不注意这一点，会出现错误。\u003c/p\u003e\n\u003cp\u003e另外，根据代码部分的说明，如果数据本身就是字节形式的, \u003ccode\u003eGetBytes(json []byte, path string)\u003c/code\u003e 方法优于 \u003ccode\u003eGet(string(data), path)\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"常见问题及解决\"\u003e常见问题及解决\u003c/h3\u003e\n\u003cp\u003e1、使用 \u003ccode\u003ejson.Marshal()\u003c/code\u003e 对结构体进行序列化时，报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eruntime: goroutine stack exceeds 1000000000-byte limit\nfatal error: stack overflow\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可能是结构体中出现了循环引用，使用 \u003ccode\u003ejson:\u0026quot;-\u0026quot;\u003c/code\u003e 不导出该字段即可解决。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/tidwall/gjson\"\u003ehttps://github.com/tidwall/gjson\u003c/a\u003e\u003c/p\u003e","date":1564617600,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1564617600,"objectID":"67b7d002ab7f70c6dea5fa202e934bc7","publishdate":1564617600,"relpermalink":"/posts/programming/golang/golang-json-serialize/","section":"posts","summary":"\u003cp\u003e本部分内容记录下使用 golang 将结构体序列化和反序列化为 JSON 时，需要注意的一些小问题。\u003c/p\u003e","tags":["Golang","JSON"],"title":"Go JSON 序列化和反序列化","url":"https://xdhuxc.github.io/posts/programming/golang/golang-json-serialize/","wordcount":859},{"categories":"posts","content":"\u003cp\u003e本部分内容记录下 Vue 中组件封装的使用方法，可以使用一些组件，实现代码和逻辑抽象。\u003c/p\u003e\n\u003ch3 id=\"动态数组组件\"\u003e动态数组组件\u003c/h3\u003e\n\u003cp\u003e这是一个动态数组组件，从父组件传入一个字符串数组，通过在页面点击按钮，实现对数组元素的动态增删，可用于类似 Kubernetes Deployment 的容器启动参数和启动命令这样的数组结构。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003e:label\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;label\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ev-for\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;(item, index) in items\u0026#34;\u003c/span\u003e           \u003cspan class=\"err\"\u003e//\u003c/span\u003e \u003cspan class=\"na\"\u003e数据渲染\u003c/span\u003e\n        \u003cspan class=\"na\"\u003e:key\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#39;item\u0026#39; + index\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;items[index]\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;items.length \u0026gt; 0\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;danger\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-delete\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n            \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;removeItem(index)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e // 删除按钮，在每一个数组元素显示的输入框之后，用于删除当前元素。\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;margin-left: 203px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n          \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;primary\u0026#34;\u003c/span\u003e\n          \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-plus\u0026#34;\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n          \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;addItem()\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e           // 增加按钮，单独设置在底部，可以从 0 开始增加，用于增加一个元素。\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DunamicArrays\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 组件名称\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e  \u003cspan class=\"nx\"\u003eprops\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e              \u003cspan class=\"c1\"\u003e// 从父组件传递过来的数据名称，在父组件中为这个名称赋予数据\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e        \u003cspan class=\"c1\"\u003e// 数据类型，可以为 Array，Number，String，Object等，如果传递过来的数据类型不对，直接报错\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nx\"\u003erequired\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e     \u003cspan class=\"c1\"\u003e// 是否必须\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e         \u003cspan class=\"c1\"\u003e// 数据默认值\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003elabel\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e              \u003cspan class=\"c1\"\u003e// 标签，可选项，用于表明数组含义\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e             \u003cspan class=\"c1\"\u003e// 定义对数据的操作函数 \n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nx\"\u003eaddItem\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eremoveItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e \u003cspan class=\"na\"\u003escoped\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"动态键值数组组件\"\u003e动态键值数组组件\u003c/h3\u003e\n\u003cp\u003e这是一个动态键值对数组组件，从父组件传入一个键值对数组，通过在页面点击按钮，实现对键值对的动态增删，可用于类似 Kubernetes Deployment 的标签、环境变量等键值对数组结构。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e  1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 89\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 90\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 91\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 92\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 93\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 94\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 95\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 96\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 97\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 98\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 99\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e100\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e101\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e102\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e103\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e104\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e105\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e106\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e107\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e108\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e109\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e110\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e111\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e112\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e113\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;arrayType === \u0026#39;key-value\u0026#39;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e // 数组类型，表示键值对数组中的键值是 key-value 类型的还是 name-value 类型的\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003e:label\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;label\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e     // 标签，可选项，用于表明数组含义\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ev-for\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;(item, index) in items\u0026#34;\u003c/span\u003e   \u003cspan class=\"err\"\u003e//\u003c/span\u003e \u003cspan class=\"na\"\u003e数据渲染\u003c/span\u003e\n          \u003cspan class=\"na\"\u003e:key\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#39;item\u0026#39; + index\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;item.key\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;item.value\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;items.length \u0026gt; 0\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;danger\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-delete\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n              \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;removeItem(index)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;margin-left: 406px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;primary\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-plus\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n            \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;addItem(arrayType)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003ev-else\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003e:label\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;label\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ev-for\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;(item, index) in items\u0026#34;\u003c/span\u003e\n          \u003cspan class=\"na\"\u003e:key\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#39;item\u0026#39; + index\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;item.name\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;item.value\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;items.length \u0026gt; 0\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;danger\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-delete\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n              \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;removeItem(index)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;margin-left: 406px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;primary\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-plus\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n            \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;addItem(arrayType)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;DynamicKeyValueArrays\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e    \u003cspan class=\"c1\"\u003e// 组件名称 \n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e  \u003cspan class=\"nx\"\u003eprops\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e                        \u003cspan class=\"c1\"\u003e// 从父组件传递过来的数据名称，在父组件中为这个名称赋予数据 \n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eArray\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e                  \u003cspan class=\"c1\"\u003e// 数据类型，可以为 Array，Number，String，Object等，如果传递过来的数据类型不对，直接报错\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nx\"\u003erequired\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e               \u003cspan class=\"c1\"\u003e// 是否必须，如果为 true，而实际没有传值，则会报错\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e                   \u003cspan class=\"c1\"\u003e// 数据默认值\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003elabel\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003earrayType\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nb\"\u003eString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003erequired\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;key-value\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// also support name-value\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e                \u003cspan class=\"c1\"\u003e// 定义对数据的操作函数 \n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"nx\"\u003eaddItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earrayType\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earrayType\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;key-value\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003earrayType\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;name-value\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eremoveItem\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e \u003cspan class=\"na\"\u003escoped\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"使用组件\"\u003e使用组件\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e \u003cspan class=\"na\"\u003eref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;arrayForm\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:rules\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;arrayVerifyRules\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003eprop\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;items\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edynamic-arrays\u003c/span\u003e \u003cspan class=\"na\"\u003e:items\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;command\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edynamic-arrays\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e // 通过 :items 定义响应式属性\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        ------------华丽丽的的分割线-------------\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edynamic-key-value-arrays\u003c/span\u003e \u003cspan class=\"na\"\u003e:items\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;labels\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003earray-type\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;name-value\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edynamic-key-value-arrays\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  // 在父组件中使用自定义组件\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eonSubmit\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e Submit \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"nx\"\u003eDynamicArrays\u003c/span\u003e \u003cspan class=\"nx\"\u003efrom\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;@/components/DynamicArrays/index\u0026#39;\u003c/span\u003e                  \u003cspan class=\"c1\"\u003e// 导入自定义组件\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"nx\"\u003eDynamicKeyValueArrays\u003c/span\u003e \u003cspan class=\"nx\"\u003efrom\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;@/components/DynamicKeyValueArrays/index\u0026#39;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 导入自定义组件\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ecomponents\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e                                                               \u003cspan class=\"c1\"\u003e// 在父组件中引用子组件\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"s1\"\u003e\u0026#39;dynamic-arrays\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eDynamicArrays\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"s1\"\u003e\u0026#39;dynamic-key-value-arrays\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eDynamicKeyValueArrays\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ecommand\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ekeyValueType\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;name-value\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emounted\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eonSubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;call component\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e \u003cspan class=\"na\"\u003escoped\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e对于数组和对象这种引用类型的数据，在子组件中改变值后，其父组件中对应的数据也将改变。\u003c/p\u003e","date":1564444800,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1564444800,"objectID":"e89d094f0779eaba05806105443c8d01","publishdate":1564444800,"relpermalink":"/posts/vue/vue-component/","section":"posts","summary":"\u003cp\u003e本部分内容记录下 Vue 中组件封装的使用方法，可以使用一些组件，实现代码和逻辑抽象。\u003c/p\u003e","tags":["Vue"],"title":"Vue 组件封装","url":"https://xdhuxc.github.io/posts/vue/vue-component/","wordcount":1298},{"categories":"posts","content":"\u003cp\u003e本篇博客主要记录一些在使用 Python 语言进行开发的过程中遇到的坑，也就是那些奇奇怪怪的语法带来的问题，这种问题往往比较隐蔽，在排查过程中会耗费大量时间，但是却给我们带来很大的困扰。\u003c/p\u003e\n\u003ch3 id=\"小心-list-元素的组织\"\u003e小心 list 元素的组织\u003c/h3\u003e\n\u003cp\u003e如果我们有一个这样的 list，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003es = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;f\u0026#39;]\nprint(s)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e那么输出结果是什么呢？毫无疑问，是这样的\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;f\u0026#39;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果我们给 list 换个写法，比如下面这样\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003es = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39; \u0026#39;d\u0026#39; \u0026#39;f\u0026#39;]\nprint(s)\n\ns = [\n    \u0026#39;a\u0026#39;,\n    \u0026#39;b\u0026#39;,\n    \u0026#39;c\u0026#39; \n    \u0026#39;d\u0026#39;\n    \u0026#39;f\u0026#39;\n]\nprint(s)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e那么输出结果会是什么样的呢？如果对这个输出结果判断错误，那么，我们的程序就会出现些意料之外的错误。其实，它的结果是这样的\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;cdf\u0026#39;]\n[\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;cdf\u0026#39;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e虽然不知道为什么，但是 python 确实是这么设计的，没有错误提示，也没有错误，将空格当成了字符串连接符来使用了。\u003c/p\u003e\n\u003cp\u003e填补此坑花了我将近三个小时的时间，要谨记此错误！\u003c/p\u003e\n\u003ch3 id=\"加载-sys-模块设置编码的原因\"\u003e加载 sys 模块，设置编码的原因\u003c/h3\u003e\n\u003cp\u003e以下代码中，先重新加载sys模块，再设置编码，而不是先设置编码，再加载sys模块的原因：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport sys\nreload(sys)\nsys.setdefaultencoding(\u0026#39;utf8\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e因为 python 运行的时候首先加载了 Lib/site.py，而在 site.py 文件中有如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif hasattr(sys, \u0026#34;setdefaultencoding\u0026#34;):\n    del sys.setdefaultencoding\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在sys模块加载后，setdefaultencoding 方法被删除了，所以我们需要通过重新导入sys模块来设置系统编码。\u003c/p\u003e\n\u003cp\u003e动态语言有时候需要静态化的设计，删除属性和方法会给其他地方的代码带来重大的错误隐患。\u003c/p\u003e","date":1564185600,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1532649600,"objectID":"859d3df4ecba0e5a17f265502384cbd2","publishdate":1564185600,"relpermalink":"/posts/programming/python/python-programming-hole/","section":"posts","summary":"\u003cp\u003e本篇博客主要记录一些在使用 Python 语言进行开发的过程中遇到的坑，也就是那些奇奇怪怪的语法带来的问题，这种问题往往比较隐蔽，在排查过程中会耗费大量时间，但是却给我们带来很大的困扰。\u003c/p\u003e","tags":["Python"],"title":"Python 常见的坑及其解决方法","url":"https://xdhuxc.github.io/posts/programming/python/python-programming-hole/","wordcount":544},{"categories":"posts","content":"\u003cp\u003e在使用 Vue 和 Element-UI 进行开发时的常用代码，方便后续使用。\u003c/p\u003e\n\u003ch3 id=\"获取当前语言\"\u003e获取当前语言\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ethis.$i18n.locale;\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"刷新当前页面\"\u003e刷新当前页面\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ethis.$router.go(0);\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003erouter.go(n)\u003c/p\u003e\n\u003cp\u003e此方法的参数是一个整数，表示在 history 记录中向前或者后退多少步，类似 window.history.go(n)。\u003c/p\u003e\n\u003ch3 id=\"键值对数组增删\"\u003e键值对数组增删\u003c/h3\u003e\n\u003cp\u003e一个可以动态删减的键值对数组，可以用于各种键值对类型的数据的动态删减，比如环境变量，标签等。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;app-container\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ev-for\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;(label, labelIndex) in labels\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"na\"\u003e:key\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#39;label\u0026#39; + labelIndex\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;label.key\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;label.value\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;labels.length !== 1\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;danger\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-delete\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n            \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;removeLabel(labelIndex)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;argIndex === labels.length - 1\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;primary\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-plus\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n            \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;addLabel()\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eonSubmit\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e Submit \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eaddLabel\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n         \u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n         \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n       \u003cspan class=\"p\"\u003e})\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eremoveLabel\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eonSubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"动态数组增删\"\u003e动态数组增删\u003c/h3\u003e\n\u003cp\u003e一个可以动态增减的字符串数组，可用于一些场景下的参数增删，比如 kubernetes 中容器的命令和其参数的前端表单的开发\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;app-container\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ev-for\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;(arg, argIndex) in args\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"na\"\u003e:key\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#39;arg\u0026#39; + argIndex\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;args[argIndex]\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;args.length !== 1\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;danger\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-delete\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n            \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;removeArg(argIndex)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;argIndex === args.length - 1\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;primary\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-plus\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n            \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;addArg()\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eonSubmit\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e Submit \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003eargs\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eaddArg\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003epush\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eremoveArg\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esplice\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003eonSubmit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econsole\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"响应式数组\"\u003e响应式数组\u003c/h3\u003e\n\u003cp\u003e由于 JavaScript 的限制，Vue 不能检测以下数组的变动：\u003c/p\u003e\n\u003cp\u003e1、当利用索引直接设置一个数组项时，例如：\u003ccode\u003evm.items[3] = 'a'\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e2、修改数组的长度时，例如，\u003ccode\u003evm.items.length = 10\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e比如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evar vm = new Vue({\n    data: {\n        items: [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;]\n    }\n})\nvm.items[3] = \u0026#39;a\u0026#39; // 不是响应式的\nvm.items.length = 20 // 不是响应式的\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上两种改变不是响应式的，因此无法直接在视图上显示出来。\u003c/p\u003e\n\u003cp\u003e解决第一类问题的两种方法如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e// Vue.set\nVue.set(vm.items, 3, \u0026#39;a\u0026#39;)\n// Array.prototype.splice\nvm.items.splice(3, 1, \u0026#39;a\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上两种方法都可以实现和 \u003ccode\u003evm.items[3] = 'a'\u003c/code\u003e 相同的效果，同时也将在响应式系统内触发状态更新。\u003c/p\u003e\n\u003cp\u003e也可以使用 \u003ccode\u003evm.$set\u003c/code\u003e 实例方法，该方法是全局方法 Vue.set 的一个别名：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evm.$set(vm.items, 3, \u0026#39;a\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以使用 \u003ccode\u003esplice\u003c/code\u003e 方法可以解决第二类问题\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evm.items.splice(10)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如上所示的方法更新数组后，视图将会和数组同步变化。\u003c/p\u003e\n\u003cp\u003e参考资料：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://cn.vuejs.org/v2/guide/list.html#%E6%9B%BF%E6%8D%A2%E6%95%B0%E7%BB%84\"\u003ehttps://cn.vuejs.org/v2/guide/list.html#%E6%9B%BF%E6%8D%A2%E6%95%B0%E7%BB%84\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://cn.vuejs.org/v2/guide/reactivity.html\"\u003ehttps://cn.vuejs.org/v2/guide/reactivity.html\u003c/a\u003e\u003c/p\u003e","date":1563926400,"description":"","fuzzywordcount":800,"kind":"page","lang":"zh","lastmod":1563926400,"objectID":"89ec1739d416deb512dcad9bc1658bc6","publishdate":1563926400,"relpermalink":"/posts/vue/vue-common-code-example/","section":"posts","summary":"\u003cp\u003e在使用 Vue 和 Element-UI 进行开发时的常用代码，方便后续使用。\u003c/p\u003e","tags":["JavaScript","Vue"],"title":"Vue 开发常用代码","url":"https://xdhuxc.github.io/posts/vue/vue-common-code-example/","wordcount":789},{"categories":"posts","content":"\u003cp\u003eJavaScript 开发时的常用代码，方便自己查找。\u003c/p\u003e\n\u003ch3 id=\"数组和对象相互转换\"\u003e数组和对象相互转换\u003c/h3\u003e\n\u003cp\u003e在开发中，我们经常需要将如下所示的对象\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n  key1: value1,\n  key2: value2,\n  key3: value3\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e转换成如下形式的数组\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[\n    {\n        key: key1,\n        value: value1\n    },\n    {\n        key: key2,\n        value: value2\n    },\n    {\n        key: key3,\n        value: value3\n    }\n]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者反过来转换，我们可以编写公用函数来完成这个功能。\u003c/p\u003e\n\u003cp\u003e1、将数组转换为对象\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport function convertArray2Object(source) {\n  const len = source.length;\n  const target = {};\n  for (let i = 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003elen\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003etarget\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003esource\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e].\u003c/span\u003e\u003cspan class=\"na\"\u003ekey\u003c/span\u003e\u003cspan class=\"err\"\u003e]\u003c/span\u003e \u003cspan class=\"err\"\u003e=\u003c/span\u003e \u003cspan class=\"na\"\u003esource\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e].\u003c/span\u003e\u003cspan class=\"na\"\u003evalue\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"na\"\u003ereturn\u003c/span\u003e \u003cspan class=\"na\"\u003etarget\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、将对象转换为数组\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport function convertObject2Array(source) {\n  const target = [];\n  for (const k in source) {\n    const temp = {\n      key: k,\n      value: source[k]\n    };\n    target.push(temp);\n  }\n  return target;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"删除对象的属性\"\u003e删除对象的属性\u003c/h3\u003e\n\u003cp\u003e可以使用 delete 操作符来删除对象的属性\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econst a = {\n    name: \u0026#39;hulk\u0026#39;,\n    env: \u0026#39;prod\u0026#39;,\n    image: \u0026#39;nginx\u0026#39;\n}\n// 删除 a 对象的属性 env\ndelete a.env \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"设置-cookie-的过期时间\"\u003e设置 cookie 的过期时间\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport Cookies from \u0026#39;js-cookie\u0026#39;;\nconst expires = new Date(new Date().getTime() + 8 \u003cspan class=\"ge\"\u003e* 60 *\u003c/span\u003e 60 * 1000);\n  return Cookies.set(TokenKey, token, {\n    expires: expires\n});\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1563840000,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1563840000,"objectID":"7227ad5f1920060a17ac26a61343f797","publishdate":1563840000,"relpermalink":"/posts/programming/javascript/javascript-common-code-example/","section":"posts","summary":"\u003cp\u003eJavaScript 开发时的常用代码，方便自己查找。\u003c/p\u003e","tags":["JavaScript"],"title":"JavaScript 常用代码","url":"https://xdhuxc.github.io/posts/programming/javascript/javascript-common-code-example/","wordcount":315},{"categories":"posts","content":"\u003cp\u003eJavaScript 中数组遍历的几种方式，都是一般的方法，但是在遍历数组的同时删除元素的方法需要稍微注意下。\u003c/p\u003e\n\u003ch3 id=\"javascript-中的数组遍历方式\"\u003eJavaScript 中的数组遍历方式\u003c/h3\u003e\n\u003cp\u003e1、标准 for 循环方式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evar a = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;]\nfor (let i = 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003ea.length\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003econsole\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003elog\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e]);\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、for-in 语句\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evar a =  {\n    name: \u0026#39;hulk\u0026#39;,\n    env: \u0026#39;prod\u0026#39;,\n    project: \u0026#39;x-role\u0026#39;\n}\nfor (var key in a) {\n    console.log(a[key]);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e一般使用 for-in 语句来遍历对象的属性，但是对象的属性需要是可枚举的，才能被读取到，非整数类型的名称和继承的那些原型链上面的属性也能被遍历。\u003c/p\u003e\n\u003cp\u003efor-in 在遍历的过程中还会遍历继承链，这是其效率比较低的原因。\u003c/p\u003e\n\u003ch3 id=\"在遍历的过程中删除元素\"\u003e在遍历的过程中删除元素\u003c/h3\u003e\n\u003cp\u003e在遍历的过程中删除元素时，会因为删除元素而导致数组索引变化，删除了错误的元素\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evar a = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;f\u0026#39;]\nfor (let i = 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003ea.length\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eif\u003c/span\u003e \u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ei \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e==\u003c/span\u003e \u003cspan class=\"na\"\u003e3\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esplice\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e);\u003c/span\u003e \u003cspan class=\"err\"\u003e//\u003c/span\u003e \u003cspan class=\"na\"\u003e删除索引号为\u003c/span\u003e \u003cspan class=\"na\"\u003e3\u003c/span\u003e \u003cspan class=\"na\"\u003e的元素\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e}\u003c/span\u003e\n    \n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果需要在遍历数组的过程中删除数组元素，那么我们可以在删除之后调整索引，从而保证下一个操作时索引的正确性\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evar a = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;]\nfor (let i = 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003ea.length\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eif\u003c/span\u003e \u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e]\u003c/span\u003e \u003cspan class=\"err\"\u003e===\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e\u003cspan class=\"na\"\u003ec\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#39;)\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ea\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esplice\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ei--\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e             \u003cspan class=\"err\"\u003e//\u003c/span\u003e \u003cspan class=\"na\"\u003e索引调整\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1563753600,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1563753600,"objectID":"b9a36806665ae3885f20fc66306aadbc","publishdate":1563753600,"relpermalink":"/posts/programming/javascript/javascript_array_traverse/","section":"posts","summary":"\u003cp\u003eJavaScript 中数组遍历的几种方式，都是一般的方法，但是在遍历数组的同时删除元素的方法需要稍微注意下。\u003c/p\u003e","tags":["JavaScript"],"title":"JavaScript 中的数组遍历方式","url":"https://xdhuxc.github.io/posts/programming/javascript/javascript_array_traverse/","wordcount":403},{"categories":"posts","content":"\u003cp\u003e本部分内容为学习消息队列所做的笔记。\u003c/p\u003e\n\u003ch3 id=\"为什么使用消息队列\"\u003e为什么使用消息队列？\u003c/h3\u003e\n\u003cp\u003e使用消息队列有如下好处：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e异步：服务器端组件接到用户请求之后，即可快速响应用户，大大提高了接口的性能。\u003c/li\u003e\n\u003cli\u003e解耦：可以解耦后台组件，后台不同服务按需订阅和消费消息，系统耦合性大大降低。\u003c/li\u003e\n\u003cli\u003e削峰填谷：可以借助于消息中间件缓冲和摊平并发量高峰期的请求。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"使用消息队列有什么优缺点\"\u003e使用消息队列有什么优缺点？\u003c/h3\u003e\n\u003cp\u003e使用了消息中间件后，会带来如下问题：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e系统可用性降低，整个系统的数据传输依赖于消息中间件，如果消息中间件挂宕，系统将无法使用。\u003c/li\u003e\n\u003cli\u003e系统复杂性提高，加入消息中间件后，需要考虑消息重复消费、消息丢失及消息顺序性等问题，系统复杂性提高了。\u003c/li\u003e\n\u003cli\u003e会带来数据一致性问题，消息在系统中各服务之间传递时，可能会不一致。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"怎么保证消息不丢失\"\u003e怎么保证消息不丢失？\u003c/h3\u003e\n\u003cp\u003e使用消息队列的时候，需要考虑消息丢失的问题，以 RabbitMQ 为例来说明下。\u003c/p\u003e\n\u003ch4 id=\"生产者丢失数据\"\u003e生产者丢失数据\u003c/h4\u003e\n\u003cp\u003eRabbitMQ 生产者将数据发送到 RabbitMQ 的时候，可能数据在网络传输中丢失了，此时 RabbitMQ 接收不到数据，消息就丢失了。\u003c/p\u003e\n\u003cp\u003eRabbitMQ 提供了两种方式来解决此问题：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e事务方式\n在生产者发送消息之前，通过 \u003ccode\u003echannel.txSelect\u003c/code\u003e 开启一个事务，接着发送消息。如果消息没有成功被 RabbitMQ 接收到，生产者会收到异常，此时，就可以进行事务回滚 \u003ccode\u003echannel.txRollback\u003c/code\u003e，然后重新发送。\n如果 RabbitMQ 收到了这个消息，就可以通过 \u003ccode\u003echannel.txCommit\u003c/code\u003e 提交事务。但此时生产者的吞吐量和性能都会降低很多，现在一般不这样做。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eConfirm 机制\n在生产者这边设置 Confirm 模式，就是每次发送消息的时候会分配一个唯一的 ID，然后 RabbitMQ 收到之后会回传一个 ACK，告诉生产者，这个消息接收到了；\n如果 RabbitMQ 没有接收到这个消息，则回调一个 Nack 的接口，这个时候生产者就可以重新发送该消息。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e事务机制和 Confirm 机制最大的不同在于事务机制是同步的，提交一个事务之前会阻塞在那里；而 Confirm 机制是异步的，发送一个消息之后就可以发送下一个消息，然后那个消息 RabbitMQ 接收了之后会异步回调一个接口，通知生产者这个消息接收到了。\u003c/p\u003e\n\u003cp\u003e因此，一般在生产者端避免数据丢失，都是使用 Confirm 机制。\u003c/p\u003e\n\u003ch4 id=\"rabbitmq-丢失数据\"\u003eRabbitMQ 丢失数据\u003c/h4\u003e\n\u003cp\u003eRabbitMQ 集群也会丢失消息，在消息发送到 RabbitMQ 之后，默认是没有落地磁盘的，如果 RabbitMQ 服务进程死掉，此时消息就丢失了。\u003c/p\u003e\n\u003cp\u003e为了解决这个问题，RabbitMQ 提供了一个持久化机制，消息写入之后会持久化到磁盘。这样即使是服务挂掉，恢复之后也会自动恢复之前存储的数据，这样的机制可以确保消息不会丢失。\u003c/p\u003e\n\u003cp\u003e设置持久化有两个步骤：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e创建队列的时候，将其设置为持久化的，这样就可以保证 RabbitMQ 持久化队列的元数据，但是不会持久化队列里的数据。\u003c/li\u003e\n\u003cli\u003e发送消息的时候将消息的 deliveryMode 设置为 2，就是将消息设置为持久化的，此时 RabbitMQ 就会将消息持久化到磁盘上去。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如果消息发送到 RabbitMQ 之后，还没来得及持久化到磁盘，RabbitMQ 就挂掉了，数据也就丢失了，怎么处理？\u003c/p\u003e\n\u003cp\u003e对于这个问题，其实是配合上面的 Confirm 机制一起来保证的，就是在消息持久化到磁盘之后才会给生产者发送 ACK 消息。如果真的遇到了那种极端情况，生产者是可以感知到的，此时生产者可以通过重试发送消息给别的 RabbitMQ`节点。\u003c/p\u003e\n\u003ch4 id=\"消费者丢失数据\"\u003e消费者丢失数据\u003c/h4\u003e\n\u003cp\u003e在 RabbitMQ 消费者消费消息的时候，刚拿到消息，RabbitMQ 进程挂掉了，这个时候 RabbitMQ 就会认为消费者已经消费成功了，这条数据就丢失了。\u003c/p\u003e\n\u003cp\u003e对于这个问题，要先说明一下 RabbitMQ 消费消息的机制：在消费者收到消息的时候，会发送一个 ACK 给 RabbitMQ，告诉 RabbitMQ 这条消息被消费到了，这样 RabbitMQ 就会把这条消息删除。\n但是默认情况下，这个发送 ACK 的操作是自动提交的，也就是说消费者一收到这个消息，就会自动返回 ACK 给 RabbitMQ，所以会出现消息丢失的问题。\u003c/p\u003e\n\u003cp\u003e因此，针对这个问题的解决方法就是：关闭 RabbitMQ 消费者的自动提交 ACK，在消费者处理完这条消息之后再手动提交 ACK。这样即使遇到了上面的情况，RabbitMQ 也不会把这条消息删除，会在程序重启之后，重新下发这条消息过来。\u003c/p\u003e\n\u003ch3 id=\"怎么保证消息中间件的高可用性\"\u003e怎么保证消息中间件的高可用性？\u003c/h3\u003e\n\u003cp\u003e使用了消息队列之后，我们希望消息队列服务高可用，不能因为机器宕机了，就出现无法收发消息的情况。\u003c/p\u003e\n\u003cp\u003eRabbitMQ 有三种模式：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e单机模式\u003c/li\u003e\n\u003cli\u003e普通集群模式\u003c/li\u003e\n\u003cli\u003e镜像集群模式\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e1）单机模式\u003c/p\u003e\n\u003cp\u003e单机模式就是在一台机器上部署了一个 RabbitMQ 程序，存在单点问题，可用于测试使用，生产环境不能使用。\u003c/p\u003e\n\u003cp\u003e2）普通集群模式\u003c/p\u003e\n\u003cp\u003e普通集群模式是在多台机器上启动多个 RabbitMQ 实例，类似于 Master-Slave 模式。但是创建的队列只会放在一个 Master RabbitMQ 实例上，其他实例都同步那个接收消息的 RabbitMQ 元数据。\u003c/p\u003e\n\u003cp\u003e在消费消息的时候，如果连接到的 RabbitMQ 实例不是存放队列数据的实例，这个时候 RabbitMQ 就会从存放队列数据的实例上拉取数据，然后返回给客户端。\n这种方式有点麻烦，没有做到真正的分布式，每次消费者连接一个实例后拉取数据，如果连接到的不是存放队列数据的实例，这个时候会造成额外的性能开销。如果从放队列的实例拉取，会导致单实例性能瓶颈。\n如果放队列数据的 RabbitMQ 实例进程挂掉了，会导致其他实例无法拉取数据，这个集群也就无法消费消息了，没有做到真正的高可用。这个方案主要是提高系统的吞吐量，就是说让集群中的多个节点来服务于某个队列的读写操作。\u003c/p\u003e\n\u003cp\u003e3）镜像集群模式\u003c/p\u003e\n\u003cp\u003e镜像集群模式是真正的 RabbitMQ 高可用模式，创建的队列无论是元数据还是队列里的消息都会存在于多个实例上。每次写消息到队列的时候，都会自动把消息同步到多个实例的队列中。\u003c/p\u003e\n\u003cp\u003e这样的话，任何一个机器宕机了，别的实例都可以用来提供服务，真正做到了高可用。\u003c/p\u003e\n\u003cp\u003e但是也存在着不足之处：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e性能开销过高，消息需要同步至所有机器，会导致网络带宽压力和消耗很大。\u003c/li\u003e\n\u003cli\u003e扩展性低：无法解决某个队列数据量特别大的情况，导致队列无法线性扩展，就算加了机器，那个机器也会包含队列的所有数据，队列的数据没有做到分布式存储。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e对于 RabbitMQ 的高可用一般的做法都是开启镜像集群模式，这样最起码做到了高可用，一个节点宕机了，其他节点可以继续提供服务。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://mp.weixin.qq.com/s/gqFVeZIE6nfYQd57pQkfaA\"\u003ehttps://mp.weixin.qq.com/s/gqFVeZIE6nfYQd57pQkfaA\u003c/a\u003e\u003c/p\u003e","date":1562716800,"description":"","fuzzywordcount":2300,"kind":"page","lang":"zh","lastmod":1562716800,"objectID":"d491307a90e30cdbf54e60bfd8617a75","publishdate":1562716800,"relpermalink":"/posts/message/message-queue/","section":"posts","summary":"\u003cp\u003e本部分内容为学习消息队列所做的笔记。\u003c/p\u003e","tags":["消息队列","RabbitMQ"],"title":"消息队列（一）","url":"https://xdhuxc.github.io/posts/message/message-queue/","wordcount":2282},{"categories":"posts","content":"\u003cp\u003e本部分内容记录了一些常用的快捷键，便于查询使用。\u003c/p\u003e\n\u003ch3 id=\"shell-快捷键\"\u003eshell 快捷键\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e快捷键\u003c/th\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + L\u003c/td\u003e\n\u003ctd\u003e清屏，相当于 clear 命令\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + C\u003c/td\u003e\n\u003ctd\u003e发送 SIGINT 信号给前台进程组中的所有进程，常用于终止正在运行的程序\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + Z\u003c/td\u003e\n\u003ctd\u003e发送 SIGTSTP 信号给前台进程组中的所有进程，常用于挂起一个进程\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + R\u003c/td\u003e\n\u003ctd\u003e搜索以前使用过的命令，搜索到后，按“Enter”键，直接执行该命令\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + A 或 HOME\u003c/td\u003e\n\u003ctd\u003e将光标移至行首\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"top-命令快捷键\"\u003etop 命令快捷键\u003c/h3\u003e\n\u003cp\u003e在 Linux shell 下，输入 top 命令，快捷键使用如下：\u003c/p\u003e\n\u003cp\u003e按 ‘X’ 键，再按 ‘B’ 键，默认按 CPU 使用率降序排列\u003c/p\u003e\n\u003cp\u003e按住 ‘Shift’ 键，再按 ‘P’ 键，是按 CPU 使用率降序排列。\u003c/p\u003e\n\u003cp\u003e按住 ‘Shift’ 键，再按 ‘M’ 键，是按 内存 使用率降序排列。\u003c/p\u003e\n\u003cp\u003e按住 ‘Shift’ 键，再按 ‘T’ 键，是按 进程运行时间降序排列。\u003c/p\u003e\n\u003cp\u003e按 ‘F’ 键，进入字段管理页面，使用上下键控制光标移动，\n使用光标选中某字段，按 ‘D’ 或者空格，取消该列的显示，按 ‘q’ 或 ‘Esc’ 再次进入 top 命令页面，可以看到刚才选中的列已经不显示了。\u003c/p\u003e\n\u003cp\u003e在字段管理页面，使用光标选中某字段后，按 ‘S’ 键，可将该字段设置为排序字段，然后按 ‘Esc’ 或 ‘Q’ 键退出，默认按降序排列。若要改为升序排列，按住 ‘Shift’ 键，然后按 ‘R’ 键，即可按照排序字段升序排列。\u003c/p\u003e\n\u003ch3 id=\"vim-快捷键\"\u003evim 快捷键\u003c/h3\u003e\n\u003cp\u003e按住 ‘Shift’ 键，然后按 ‘:’ 键，进入命令模式，输入：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-angular2html\" data-lang=\"angular2html\"\u003eset number\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e按 ‘Enter’ 键，显示行号。\u003c/p\u003e\n\u003cp\u003e输入：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-angular2html\" data-lang=\"angular2html\"\u003eset encoding=utf-8\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e按 ‘Enter’ 键，则修改编码为UTF-8编码。\u003c/p\u003e\n\u003ch3 id=\"jetbrains-快捷键\"\u003eJetBrains 快捷键\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e快捷键\u003c/th\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + X\u003c/td\u003e\n\u003ctd\u003e删除当前行\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + D\u003c/td\u003e\n\u003ctd\u003e删除当前行\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + Alt + ↑\u003c/td\u003e\n\u003ctd\u003e复制当前行到上一行\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + Alt + ↓\u003c/td\u003e\n\u003ctd\u003e复制当前行到下一行\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + F\u003c/td\u003e\n\u003ctd\u003e当前文件全文查找\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + R\u003c/td\u003e\n\u003ctd\u003e当前文件全文查找替换\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + ↑ + R\u003c/td\u003e\n\u003ctd\u003e全路径查找替换\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + ↑ + F\u003c/td\u003e\n\u003ctd\u003e全路径查找\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + l\u003c/td\u003e\n\u003ctd\u003e跳转至指定行\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"word-快捷键\"\u003eword 快捷键\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e快捷键\u003c/th\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + Home\u003c/td\u003e\n\u003ctd\u003e将光标移动到文档首部\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + End\u003c/td\u003e\n\u003ctd\u003e将光标移动到文档尾部\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAlt + Enter\u003c/td\u003e\n\u003ctd\u003e单元格内换行\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eShift + PageDown\u003c/td\u003e\n\u003ctd\u003e选中光标后面的部分，可以按住 ‘Shift’ 键，然后一直按 ‘PageDown’ 键，选中内容后，按 ‘Delete’ 键删除选中内容\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"visio-快捷键\"\u003evisio 快捷键\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e快捷键\u003c/th\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + =\u003c/td\u003e\n\u003ctd\u003e将选中的文字变为下标\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + Shift + =\u003c/td\u003e\n\u003ctd\u003e将选中的文字变为上标\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"windows-快捷键\"\u003ewindows 快捷键\u003c/h3\u003e\n\u003cp\u003e1、按住 Shift 键，右键鼠标，可以在当前目录下打开 PowerShell。\u003c/p\u003e\n\u003ch3 id=\"atom-快捷键\"\u003eAtom 快捷键\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e快捷键\u003c/th\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + /\u003c/td\u003e\n\u003ctd\u003e在当前行插入注释\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + x\u003c/td\u003e\n\u003ctd\u003e删除当前行\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"sublime-text-快捷键\"\u003eSublime Text 快捷键\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e快捷键\u003c/th\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + F\u003c/td\u003e\n\u003ctd\u003e查找\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecommand + ⌥ + F\u003c/td\u003e\n\u003ctd\u003e查找并替换\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"notepad\"\u003eNotepad++\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e快捷键\u003c/th\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + L\u003c/td\u003e\n\u003ctd\u003e删除光标所在行\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCtrl + D\u003c/td\u003e\n\u003ctd\u003e复制当前行到下一行\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"eclipse-快捷键\"\u003eEclipse 快捷键\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003cth\u003e快捷键\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e导入相应的包\u003c/td\u003e\n\u003ctd\u003eCtrl+ Shift + O\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e在当前行插入空行\u003c/td\u003e\n\u003ctd\u003eCtrl + Shif +Enter\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"mindmaster\"\u003eMindMaster\u003c/h3\u003e\n\u003cp\u003e1、在 Topic 内换行，在光标所在位置，按 \u003ccode\u003eShift+Enter\u003c/code\u003e 键\u003c/p\u003e\n\u003ch3 id=\"字体和段落\"\u003e字体和段落\u003c/h3\u003e\n\u003cp\u003e字体：Monaco\u003c/p\u003e\n\u003cp\u003e大小：12 pt\u003c/p\u003e\n\u003cp\u003e在 word 中，段首空两个汉字，设置首行缩进 0.82 cm。\u003c/p\u003e\n\u003ch3 id=\"vs-code\"\u003eVS Code\u003c/h3\u003e\n\u003cp\u003e1、在代码中 \u003ccode\u003eGo To Definition\u003c/code\u003e 时，默认情况下会替换掉原来的页面。如果希望打开一个新页面，需要进行如下配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026#34;workbench.editor.enablePreview\u0026#34;: false\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e通过配置 \u003ccode\u003eworkbench.editor.enablePreview\u003c/code\u003e 为 \u003ccode\u003efalse\u003c/code\u003e 来禁止编辑器的预览功能，这样在浏览代码时就会跳转到代码页面。\u003c/p\u003e\n\u003cp\u003e实际上，VS Code 提供了 Peek 功能，用来在当前页面查看代码，无需跳转到新页面，不过这样会带来新问题：1、挤压了页面空间；2、需要查看的方法或函数还需进一步查看时，就不方便了。另外，对于习惯了跳转到新页面的工程师，还是喜欢用旧的方式。\u003c/p\u003e","date":1562630400,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1562630400,"objectID":"c81e0f6aaeb2a3f351d46a2d7d5a4d9e","publishdate":1562630400,"relpermalink":"/posts/mixed/shortcut_key/","section":"posts","summary":"\u003cp\u003e本部分内容记录了一些常用的快捷键，便于查询使用。\u003c/p\u003e","tags":["快捷键"],"title":"常用快捷键","url":"https://xdhuxc.github.io/posts/mixed/shortcut_key/","wordcount":1234},{"categories":"posts","content":"\u003cp\u003e本篇博客记录一些在软件开发过程中遇到的问题及思考，持续更新。。。\u003c/p\u003e\n\u003ch3 id=\"协议-原生-api-和第三方框架或工具包\"\u003e协议， 原生 API 和第三方框架（或工具包）\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e协议\u003c/p\u003e\n\u003cp\u003e有些程序组件，比如LDAP，同时提供协议访问方式和 API 方式，协议方式直接操作数据，但是也是组件软件迭代时最可能变化的，可根据应用场景进行取舍。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e原生 API\u003c/p\u003e\n\u003cp\u003e1、使用原生 API 有助于加深对基础架构的理解和增强自己的代码能力。\u003c/p\u003e\n\u003cp\u003e2、使用原生 API 操作复杂。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e第三方框架（或工具包）\u003c/p\u003e\n\u003cp\u003e1、使用第三方框架（或工具包）可以避免基础组件版本变化带来的 API 变化，第三方框架去屏蔽版本差异，可以保持程序的稳定性。\u003c/p\u003e\n\u003cp\u003e2、如果第三方框架（或工具包）封装的不够好或者有太多 bug，就会增加程序风险。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"api-调用\"\u003eAPI 调用\u003c/h3\u003e\n\u003cp\u003e1、假如在一个函数中既循环调用了外部 API，又要进行本地循环处理，那么将调用外部 API 的循环放置在外层，将本地处理的循环放置在内层，可以有效提高程序运行效率，因为调用外部 API 网络延时较长，本地处理速度快。\u003c/p\u003e\n\u003cp\u003e2、除非迫不得已，否则绝对不使用用户名和密码的方式调用 API。\u003c/p\u003e\n\u003cp\u003e3、对于 Access Key 和 Secret Key 这种东西，绝对不要直接写在代码中，要保存在本地文件中。\u003c/p\u003e\n\u003ch3 id=\"思考事项\"\u003e思考事项\u003c/h3\u003e\n\u003cp\u003e1、在编写代码时，需要考虑数据量，从而考虑网络、计算和存储的分离。\u003c/p\u003e\n\u003ch3 id=\"问题\"\u003e问题\u003c/h3\u003e\n\u003ch4 id=\"微服务设计\"\u003e微服务设计\u003c/h4\u003e\n\u003cp\u003e整个系统进行了拆分，但是各个服务使用的数据模型有重合（有些完全重合，有些部分重合）的部分，使用 ORM 框架后，如果彼此之间引用私有仓库的包，会出问题，但是放在公有专门的存放仓库之后，代码散乱，组织结构复杂，可读性会降低，如何优雅地处理这个问题？\u003c/p\u003e\n\u003cp\u003e目前是将数据模型复制到需要使用的地方，基本可以解决问题，但是同时，如果公用的数据模型发生变动，其他各处可能需要同步修改，否则会出错误。\u003c/p\u003e\n\u003ch4 id=\"错误处理\"\u003e错误处理\u003c/h4\u003e\n\u003cp\u003e在 web 开发中，是使用 HTTP 的响应状态码响应请求，还是在 HTTP 的响应状态码之内，再包裹一个自定义的状态码及错误信息，在什么场景下采用哪种方式好些？\u003c/p\u003e\n\u003cp\u003e在采取后者的情况下，往往会存在以下问题：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e状态码不是全局统一和集中管理的，从而是所有服务公用一套的，导致有和没有一个样，甚至更加混乱，给解决错误带来更大的困扰，实际上解决错误时还是老一套。\u003c/li\u003e\n\u003cli\u003e状态码的制定规则，是针对具体错误制定，还是针对某个服务来制定？\u003c/li\u003e\n\u003cli\u003e在响应中混用自定义状态码和 HTTP 状态码，导致前端无法统一处理错误。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"生产环境和测试环境分离\"\u003e生产环境和测试环境分离\u003c/h4\u003e\n\u003cp\u003e系统开发一段时间后，逐渐地，测试环境和生产环境产生了分离，其实主要是后台数据库数据的差异（完全的前后端分离架构），导致一些线上环境中产生的错误，无法在测试环境中复现或修改后也无法在测试环境中进行测试，从而往往会在生产环境中进行小测试，如之奈何？\u003c/p\u003e\n\u003cp\u003e1、将生产数据库中除用户信息之外的其他数据每隔一段时间复制到测试数据库中\u003c/p\u003e\n\u003cp\u003e2、在测试环境中使用生产环境的 API 接口。\u003c/p\u003e\n\u003ch3 id=\"真理\"\u003e真理\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e好的架构不是设计出来的，是演进出来的。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"待考虑问题\"\u003e待考虑问题\u003c/h3\u003e\n\u003ch4 id=\"2019年11月15日\"\u003e2019年11月15日\u003c/h4\u003e\n\u003cp\u003e1、设置 \u003ccode\u003eGitLab\u003c/code\u003e 保护，禁止向工程的 \u003ccode\u003emaster\u003c/code\u003e 分支直接推送代码，只能从其他分支合并到 \u003ccode\u003emaster\u003c/code\u003e 分支。\u003c/p\u003e\n\u003cp\u003e2、考虑到将 \u003ccode\u003eDDL\u003c/code\u003e 和 \u003ccode\u003eDML\u003c/code\u003e 写在一个文件中时，在一些 SQL 管理工具中打开整个文件后不小心执行了整个文件，可能会造成不良后果。建议工程的根目录下建立 \u003ccode\u003esql\u003c/code\u003e 目录，内含 \u003ccode\u003e工程名_ddl.sql\u003c/code\u003e 和 \u003ccode\u003e工程名_dml.sql\u003c/code\u003e 两个文件，要求 \u003ccode\u003e工程名_ddl.sql\u003c/code\u003e 可以直接整个文件执行，平时进行的 DML 语句写在 \u003ccode\u003e工程名_dml.sql\u003c/code\u003e 中。\u003c/p\u003e\n\u003cp\u003e3、考虑到这样一种常用的使用场景，也是我们自己最常用的新应用部署场景，将 \u003ccode\u003eDeployment\u003c/code\u003e、\u003ccode\u003eService\u003c/code\u003e、\u003ccode\u003eConfigMap\u003c/code\u003e 全部写在一个文件 \u003ccode\u003emainfest.yaml\u003c/code\u003e 中，使用 \u003ccode\u003ekubectl create -f mainfest.yaml\u003c/code\u003e 来创建该应用及相关常用资源，完善新应用部署功能。目前只能部署单独的 \u003ccode\u003eDeployment\u003c/code\u003e，配置其相应的 \u003ccode\u003eService\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e4、已有 \u003ccode\u003eConfigMap\u003c/code\u003e 落库问题，目前只有通过页面增加的 \u003ccode\u003eConfigMap\u003c/code\u003e 落库，其他已经手工创建的 \u003ccode\u003eConfigMap\u003c/code\u003e 尚未落库，也不能在页面中修改。\u003c/p\u003e\n\u003cp\u003e5、\u003ccode\u003eDeployment\u003c/code\u003e，\u003ccode\u003eService\u003c/code\u003e，\u003ccode\u003eConfigMap\u003c/code\u003e 等资源定期落库。\u003c/p\u003e\n\u003ch4 id=\"2020年01月08日\"\u003e2020年01月08日\u003c/h4\u003e\n\u003cp\u003e1、基于 AlertManager 的报警数据落库问题，为后续统计数据和优化提供数据支撑。\u003c/p\u003e\n\u003ch3 id=\"诡异问题记录\"\u003e诡异问题记录\u003c/h3\u003e\n\u003ch4 id=\"2019年01月03日\"\u003e2019年01月03日\u003c/h4\u003e\n\u003cp\u003e公司的内部系统用户认证突然出了问题，直接使用 LDAP 协议的第三方系统中有些不能访问，修改密码后，可以访问，原因是密码过期。但是使用我们自己开发的 LDAP 接口的第三方系统，却还是不能访问。\u003c/p\u003e\n\u003cp\u003e后来，重启了 LDAP 接口服务后，调用接口的第三方系统终于可以访问了。\u003c/p\u003e\n\u003cp\u003e查看 LDAP 接口代码，代码中在程序启动时初始化了 LDAP 连接对象，其后的操作都是使用该对象进行的。然而，当 LDAP 服务重启后，程序中初始化的连接将会断掉\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eLDAP Result Code 200 \\\u0026#34;Network Error\u0026#34;\\: ldap: connection closed\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时，凡是通过接口访问的，都会出现网络错误。\u003c/p\u003e\n\u003cp\u003e此时，先解决问题，重启 LDAP 接口服务\u003c/p\u003e\n\u003cp\u003e很多第三方的库或框架，会使用连接池技术，在这种情况下，可以在程序启动时，初始化一个连接对象，用于后续对资源的访问，连接对象由连接池来管理。\u003c/p\u003e\n\u003cp\u003e但是，当没有提供连接池时，这样做却可能会出现问题，就像我们所遇到的，连接的对端服务重启了，导致该连接失效，但是客户端代码还是使用的该连接，于是会报出来网络错误等。\u003c/p\u003e\n\u003cp\u003e在预估接口 QPS 不是很大的情况下，可以采用如下两种方式来解决：\u003c/p\u003e\n\u003cp\u003e1、为每次请求创建一个客户端连接对象，响应完后关闭该连接对象。\u003c/p\u003e\n\u003cp\u003e2、初始化一个连接对象，但是每次请求时先检测该连接是否还存活，如果存活着，再处理请求；如果已经无法连接服务，再次创建该连接对象，然后处理请求。\u003c/p\u003e","date":1562630400,"description":"","fuzzywordcount":2200,"kind":"page","lang":"zh","lastmod":1562630400,"objectID":"c81d4bb84a4381469ebc7d62ce4aa402","publishdate":1562630400,"relpermalink":"/posts/programming/programming-design-one/","section":"posts","summary":"\u003cp\u003e本篇博客记录一些在软件开发过程中遇到的问题及思考，持续更新。。。\u003c/p\u003e","tags":["编程"],"title":"程序设计（一）","url":"https://xdhuxc.github.io/posts/programming/programming-design-one/","wordcount":2112},{"categories":"posts","content":"\u003cp\u003e在 Python 开发时，我们经常需要用到虚拟环境，为各个不同的工程提供指定的运行时环境，提供其需要的隔离的依赖包。使用 virtualenvwrapper 可以很方便地管理不同的虚拟环境。\u003c/p\u003e\n\u003ch3 id=\"virtualenvwrapper\"\u003evirtualenvwrapper\u003c/h3\u003e\n\u003cp\u003e1、安装 virtualenvwrapper\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epip install virtualenvwrapper\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epip install virtualenvwrapper-win # windows 系统下\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、修改 Envs 目录为指定目录，添加如下环境变量：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eWORKON_HOME=E:\\PycharmProject\\Envs\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、virtualenvwrapper 的使用\u003c/p\u003e\n\u003cp\u003evirtualenvwrapper 的常用命令：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eworkon：列出所有的虚拟环境；\u003c/li\u003e\n\u003cli\u003eworkon xflask：进入虚拟环境 xflask；\u003c/li\u003e\n\u003cli\u003emkvirtualenv xflask：创建虚拟环境 xflask，统一存放在 Envs 目录下，如果没有虚拟环境目录，则创建 ~/Envs 目录，在其下面创建虚拟环境目录；\u003c/li\u003e\n\u003cli\u003emkvirtualenv --python=C:\\xdhuxc\\Python37-32\\python.exe xflask，使用指定版本的 python 解释器创建虚拟环境；\u003c/li\u003e\n\u003cli\u003edeactivate：退出虚拟环境；\u003c/li\u003e\n\u003cli\u003ermvirtualenv：删除虚拟环境；\u003c/li\u003e\n\u003cli\u003elsvirtualenv：列出所有的虚拟环境，和不带参数的 workon 效果一样。\u003c/li\u003e\n\u003c/ul\u003e","date":1562544000,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1531008000,"objectID":"8df9085738b561ac15ea3379d239bc0d","publishdate":1562544000,"relpermalink":"/posts/programming/python/python-virtualenv/","section":"posts","summary":"\u003cp\u003e在 Python 开发时，我们经常需要用到虚拟环境，为各个不同的工程提供指定的运行时环境，提供其需要的隔离的依赖包。使用 virtualenvwrapper 可以很方便地管理不同的虚拟环境。\u003c/p\u003e","tags":["Python","virtualenv"],"title":"Python virtualenv 的使用","url":"https://xdhuxc.github.io/posts/programming/python/python-virtualenv/","wordcount":343},{"categories":"posts","content":"\u003cp\u003e在编写 \u003ccode\u003eDockerfile\u003c/code\u003e 时，我们可能需要将多条指令合并成一行，这样语法简洁，并且可以减少镜像层数。\u003c/p\u003e\n\u003ch3 id=\"将多条-copy-指令合并为一条\"\u003e将多条 COPY 指令合并为一条\u003c/h3\u003e\n\u003cp\u003e比如，我们的 \u003ccode\u003eDockerfile\u003c/code\u003e 里面有这样的语句：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eFROM python:2.7-stretch\nWORKDIR /xdhuxc/\nCOPY dingtalk_callback.py /xdhuxc/\nCOPY requirements.txt /xdhuxc/\nCOPY settings.py /xdhuxc/\nRUN pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple\nENTRYPOINT [\u0026#34;python\u0026#34;, \u0026#34;-u\u0026#34;, \u0026#34;/xdhuxc/dingtalk_callback.py\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e我们想把多个 \u003ccode\u003eCOPY\u003c/code\u003e 指令合并成一条，可以改写该 \u003ccode\u003eDockerfile\u003c/code\u003e 为如下形式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eFROM python:2.7-stretch\nWORKDIR /xdhuxc/\nCOPY dingtalk_callback.py requirements.txt settings.py /xdhuxc/\nRUN pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple\nENTRYPOINT [\u0026#34;python\u0026#34;, \u0026#34;-u\u0026#34;, \u0026#34;/xdhuxc/dingtalk_callback.py\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eFROM python:2.7-stretch\nWORKDIR /xdhuxc/\nCOPY [\u0026#34;dingtalk_callback.py\u0026#34;, \u0026#34;requirements.txt\u0026#34;, \u0026#34;settings.py\u0026#34;, \u0026#34;/xdhuxc/\u0026#34;]\nRUN pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple\nENTRYPOINT [\u0026#34;python\u0026#34;, \u0026#34;-u\u0026#34;, \u0026#34;/xdhuxc/dingtalk_callback.py\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e路径中包含空格时，必须使用这种形式。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eCOPY\u003c/code\u003e 指令支持通配符，如果复制多个文件时，文件名称本身有规律，则可以使用通配符来实现\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eFROM python:2.7-stretch\nWORKDIR /xdhuxc/\nCOPY dingtalk* /xdhuxc/ # 复制所有以 \u0026#34;dingtalk\u0026#34; 开头的文件到 /xdhuxc/ 目录下\nRUN pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple\nENTRYPOINT [\u0026#34;python\u0026#34;, \u0026#34;-u\u0026#34;, \u0026#34;/xdhuxc/dingtalk_callback.py\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e但要注意，\u003ccode\u003eCOPY\u003c/code\u003e 只能复制目录下的内容，不能复制目录，对于目录的复制，要这样写\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCOPY templates/ /scmp/templates\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e其中，\u003ccode\u003etemplates\u003c/code\u003e 为目录名\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://codeday.me/bug/20171013/84355.html\"\u003ehttps://codeday.me/bug/20171013/84355.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.docker.com/engine/reference/builder/#copy\"\u003ehttps://docs.docker.com/engine/reference/builder/#copy\u003c/a\u003e\u003c/p\u003e","date":1562112000,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1530576000,"objectID":"8e7555f8ae80df827922bd10938fd965","publishdate":1562112000,"relpermalink":"/posts/docker/docker-copy-file-or-folder-one-command/","section":"posts","summary":"\u003cp\u003e在编写 \u003ccode\u003eDockerfile\u003c/code\u003e 时，我们可能需要将多条指令合并成一行，这样语法简洁，并且可以减少镜像层数。\u003c/p\u003e","tags":["Docker","Dockerfile"],"title":"Docker 合并多条 COPY 命令","url":"https://xdhuxc.github.io/posts/docker/docker-copy-file-or-folder-one-command/","wordcount":341},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下部署 ClickHouse Exporter 的过程，使用 prometheus 监控 ClickHouse 时会用到。\u003c/p\u003e\n\u003cp\u003e1、项目地址：https://github.com/f1yegor/clickhouse_exporter\u003c/p\u003e\n\u003cp\u003e2、下载该项目并编译为二进制文件，移动至 /usr/bin/ 目录下，并添加执行权限。\u003c/p\u003e\n\u003cp\u003e3、配置如下环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport CLICKHOUSE_USER=\u0026#34;default\u0026#34;\nexport CLICKHOUSE_PASSWORD=\u0026#34;\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、以 Linux 系统服务方式启动之\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=Clickhouse Exporter\nAfter=network.target\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/clickhouse_exporter -scrape_uri=http://192.168.33.10:8123/\nRestart=on-failure\nRestartSec=5\nLimitNOFILE=65536\n\n[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者可以基于 docker 容器方式部署\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d -p 9116:9116 f1yegor/clickhouse-exporter -scrape_uri=http://192.168.33.10:8123/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1561420800,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1562544000,"objectID":"7a288f0a8cb19983f58dd3f509a3675f","publishdate":1561420800,"relpermalink":"/posts/storage/clickhouse/clickhouse-exporter/","section":"posts","summary":"\u003cp\u003e本篇博客记录下部署 ClickHouse Exporter 的过程，使用 prometheus 监控 ClickHouse 时会用到。\u003c/p\u003e","tags":["ClickHouse"],"title":"部署 clickhouse_exporter","url":"https://xdhuxc.github.io/posts/storage/clickhouse/clickhouse-exporter/","wordcount":192},{"categories":"posts","content":"\u003cp\u003e本篇博客记录一些 git 使用过程中常见的问题及其解决方法。\u003c/p\u003e\n\u003cp\u003e1、使用 git 拉取大工程时，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003exdhuxc@DESKTOP-AFGTEDSW MINGW64 /d/PycharmProject\n$ git clone -b private git@github.com:xdhuxc/xpython.git                                                                                                               .git\nCloning into 'xpython'...\nremote: Counting objects: 4608, done.\nremote: Compressing objects: 100% (71/71), done.\nfatal: pack has bad object at offset 10852763787: inflate returned 1\nfatal: index-pack failed\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e解决方法如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e$ git clone -b private --depth=1 git@github.com:xdhuxc/xpython.git\nCloning into 'xpython'...\nremote: Counting objects: 913, done.\nremote: Compressing objects: 100% (756/756), done.\nremote: Total 913 (delta 143), reused 819 (delta 101)\nReceiving objects: 100% (913/913), 1.79 GiB | 10.33 MiB/s, done.\nResolving deltas: 100% (143/143), done.\nChecking out files: 100% (798/798), done.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、使用 IDEA 复制 GitHub 上的代码时，提示错误如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eFetch failed: Could not read from remote repository.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在 IDEA 中，点击 “File”，选择 “Settings”，找到 “Version Control”，选择 “Git”，修改 “SSH executable” 为 “Native”，重新拉取代码即可。\u003c/p\u003e\n\u003cp\u003e3、git 添加远程仓库时报错\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewanghuans-MacBook-Pro:vue-admin-template wanghuan$ git remote add origin git@github.com:xdhuxc/xpython.git\nfatal: remote origin already exists.\nwanghuans-MacBook-Pro:vue-admin-template wanghuan$ git remote rm origin\nwanghuans-MacBook-Pro:vue-admin-template wanghuan$ git remote add origin git@github.com:xdhuxc/xpython.git\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e解决：先删除远程 Git 仓库，然后再添加远程 Git 仓库。\u003c/p\u003e\n\u003cp\u003e4、拉取代码时，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewanghuans-MacBook-Pro:k8s wanghuan$ git pull\nfatal: refusing to merge unrelated histories\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e原因：本地仓库和远程仓库实际上是两个独立的仓库，可以在 \u003ccode\u003epull\u003c/code\u003e 命令中加入 \u003ccode\u003e --allow-unrelated-histories\u003c/code\u003e 选项来解决该问题，该选项可以合并两个独立创建的仓库的历史。\n命令为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewanghuans-MacBook-Pro:k8s wanghuan$ git pull origin master --allow-unrelated-histories\nFrom gitlab.ushareit.me:sgt/devops/k8s\n * branch            master     -\u0026gt; FETCH_HEAD\nAlready up to date!\nMerge made by the 'recursive' strategy.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e5、使用eclipse，选取指定分支，拉取代码，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eGit repository clone failed.\nJava heap space\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e解决：修改 \u003ccode\u003eeclipse\u003c/code\u003e 安装目录下的 \u003ccode\u003eeclipse.ini\u003c/code\u003e 文件中如下参数的值：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-Xms1024m\n-Xmx5120m\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在 \u003ccode\u003eIDEA\u003c/code\u003e 中，参照修改安装目录 \u003ccode\u003ebin\u003c/code\u003e 下的 \u003ccode\u003eidea.exe.vmoptions\u003c/code\u003e 或 \u003ccode\u003eidea64.exe.vmoptions\u003c/code\u003e 文件。\u003c/p\u003e\n\u003cp\u003e6、拉取 github 上的代码时，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewarning: no common commits\nremote: Counting objects: 3, done.\nremote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0\nUnpacking objects: 100% (3/3), done.\nFrom github.com:xdhuxc/checklist\n * branch            HEAD       -\u0026gt; FETCH_HEAD\nfatal: refusing to merge unrelated histories\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e添加参数\u003ccode\u003e--allow-unrelated-histories\u003c/code\u003e后重新拉取\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit pull --allow-unrelated-histories git@github.com:xdhuxc/checklist.git\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e6、本地修改文件后，拉取 gitlab 上的代码时，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ebash-3.2$ git pull origin master --allow-unrelated-histories -f\nFrom gitlab.ushareit.me:sgt/devops/share-ikc\n * branch            master     -\u0026gt; FETCH_HEAD\nerror: Your local changes to the following files would be overwritten by merge:\n  .gitignore .idea/workspace.xml\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e解决方法：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egit stash\ngit pull origin master\ngit stash pop\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e使用以上命令保留刚才本地修改的代码，并把git服务器上的代码pull到本地（本地刚才修改的代码将会被暂时封存起来\u003c/p\u003e\n\u003cp\u003e7、克隆代码时，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewanghuans-MacBook-Pro:PycharmProjects wanghuan$ git clone git@github.com:jumpserver/jumpserver.git\nCloning into 'jumpserver'...\nremote: Enumerating objects: 83, done.\nremote: Counting objects: 100% (83/83), done.\nremote: Compressing objects: 100% (68/68), done.\nfatal: the remote end hung up unexpectedly55 MiB | 0 bytes/s\nfatal: early EOF\nConnection to github.com closed by remote host.\nfatal: index-pack failed\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e解决方法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:~ wanghuan$ git config --global http.postBuffer 1048576000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、由于公司代码仓库迁移，导致拉取代码时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eUpdate failed\n\t\t\t@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n\t\t\t@       WARNING: POSSIBLE DNS SPOOFING DETECTED!          @\n\t\t\t@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n\t\t\tThe ECDSA host key for gitlab.xdhuxc.com has changed,\n\t\t\tand the key for the corresponding IP address 192.168.19.121\n\t\t\tis unknown. This could either mean that\n\t\t\tDNS SPOOFING is happening or the IP address for the host\n\t\t\tand its host key have changed at the same time.\n\t\t\t@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n\t\t\t@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @\n\t\t\t@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n\t\t\tIT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!\n\t\t\tSomeone could be eavesdropping on you right now (man-in-the-middle attack)!\n\t\t\tIt is also possible that a host key has just been changed.\n\t\t\tThe fingerprint for the ECDSA key sent by the remote host is\n\t\t\tSHA256:motujg8AdfKP+cphjzDnsmEykU4vqQi7joDXi3DL9MY.\n\t\t\tPlease contact your system administrator.\n\t\t\tAdd correct... (show balloon)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因：第一次使用 SSH 连接时，会生成一个认证，存储在客户端的 known_hosts，但是如果服务器端重启，那么认证信息也会改变，用原来的客户端信息连接就会出现上述错误。因此，只要把客户端中的认证信息删除，此后连接时会重新生成认证信息，这样就正常了。\u003c/p\u003e\n\u003cp\u003e在客户端输入命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003essh-keygen -R ${SERVER_IP}\n或\nssh-keygen -R ${SERVER_DOMAIN}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e也可以直接删除 \u003ccode\u003e~/.ssh/known_hosts\u003c/code\u003e 文件\u003c/p\u003e","date":1560902400,"description":"","fuzzywordcount":1200,"kind":"page","lang":"zh","lastmod":1560902400,"objectID":"6e881dfd9f3612edc2de3b50ab17888e","publishdate":1560902400,"relpermalink":"/posts/mixed/git/git-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录一些 git 使用过程中常见的问题及其解决方法。\u003c/p\u003e","tags":["Git","GitHub","GitLab"],"title":"Git 常见问题及解决","url":"https://xdhuxc.github.io/posts/mixed/git/git-questions-and-solutions/","wordcount":1122},{"categories":"posts","content":"\u003cp\u003e在 GitHub 上 fork 其他项目后，过一段时间后，自己账户下的项目就会和原项目主分支差异比较大，提交 Pull Requests 时就会产生冲突，此时就需要和主分支同步代码。操作如下：\u003c/p\u003e\n\u003cp\u003e1、向本地项目添加远程主分支\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:go-common wanghuan$ pwd\n/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/go-common\nwanghuans-MacBook-Pro:go-common wanghuan$ ls\nLICENSE         blog            glog            middleware      pkg             src\nwanghuans-MacBook-Pro:go-common wanghuan$ git remote add upstream git@github.com:iyacontrol/go-common.git\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以使用 git branch -v 查看是否已添加过远程分支，若已添加，则可跳过此步骤。\u003c/p\u003e\n\u003cp\u003e2、获取主分支的最新修改到本地\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:go-common wanghuan$ git fetch upstream\nremote: Enumerating objects: 25, done.\nremote: Counting objects: 100% (25/25), done.\nremote: Compressing objects: 100% (14/14), done.\nremote: Total 20 (delta 7), reused 18 (delta 5), pack-reused 0\nUnpacking objects: 100% (20/20), done.\nFrom github.com:iyacontrol/go-common\n \u003cspan class=\"k\"\u003e*\u003c/span\u003e [new branch]      master     -\u0026gt; upstream/master\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、将 upstream 分支修改的内容合并到本地个人分支\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit merge upstream/master\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此处需要解决合并过程中产生的冲突。\u003c/p\u003e\n\u003cp\u003e或者使用如下步骤来实现：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit checkout master # 切换到 master 分支\ngit merge upstream  # 合并主分支修改到本地分支。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、将本地修改提交到 github 上的个人项目\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit push\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e现在，主分支修改的代码完全同步到 fork 出来的的个人项目分支上，此时在个人项目中提交 \u003ccode\u003ePull requests\u003c/code\u003e 就不会发生冲突。\u003c/p\u003e","date":1560729600,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1560729600,"objectID":"a7e984da7c56fafd2a9576be5e1cdbc0","publishdate":1560729600,"relpermalink":"/posts/mixed/git/github-sync-master-branch/","section":"posts","summary":"\u003cp\u003e在 GitHub 上 fork 其他项目后，过一段时间后，自己账户下的项目就会和原项目主分支差异比较大，提交 Pull Requests 时就会产生冲突，此时就需要和主分支同步代码。操作如下：\u003c/p\u003e","tags":["Git","GitHub"],"title":"GitHub 上 fork 项目后同步原项目","url":"https://xdhuxc.github.io/posts/mixed/git/github-sync-master-branch/","wordcount":363},{"categories":"posts","content":"\u003cp\u003e本篇博客记录一些 Mac 下常用的操作或功能，以备后需。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e更新系统之后，使用 \u003ccode\u003emake\u003c/code\u003e 命令时，报如下错误：\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:scmp-cmdb wanghuan$ make build\nxcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：在命令行中输入如下命令安装命令行工具\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003excode-select --install\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"2\"\u003e\n\u003cli\u003e关闭 MacOS 上的默认启动程序\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e解决：依次点击 \u003ccode\u003eFinder\u003c/code\u003e -\u0026gt; \u003ccode\u003eSystem Preferences\u003c/code\u003e -\u0026gt; \u003ccode\u003eUsers \u0026amp; Groups\u003c/code\u003e，在弹出的对话框中，点击 \u003ccode\u003eLogin Items\u003c/code\u003e，在下方的列表中删除不需要的自启动程序，再点击左下角的 \u003ccode\u003eClick the lock to make changes\u003c/code\u003e。\u003c/p\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003eMac 系统将 \u003ccode\u003ebash\u003c/code\u003e 更换为 \u003ccode\u003ezsh\u003c/code\u003e 后，原来配置的很多环境变量不见了，程序运行出错。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eMac 系统的环境变量，加载顺序为：\u003ccode\u003e/etc/profile\u003c/code\u003e，\u003ccode\u003e/etc/paths\u003c/code\u003e，\u003ccode\u003e~/.bash_profile\u003c/code\u003e， \u003ccode\u003e~/.bash_login\u003c/code\u003e， \u003ccode\u003e~/.profile\u003c/code\u003e， \u003ccode\u003e~/.bashrc\u003c/code\u003e，其中，\u003ccode\u003e/etc/profile\u003c/code\u003e 和 \u003ccode\u003e/etc/paths\u003c/code\u003e 是系统级别的，系统启动时就会自动加载，其他几个是当前用户的环境变量。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e~/.bash_profile\u003c/code\u003e, \u003ccode\u003e~/.bash_login\u003c/code\u003e，\u003ccode\u003e~/.profile\u003c/code\u003e 按照从前往后的顺序读取，如果 \u003ccode\u003e~/.bash_profile\u003c/code\u003e 文件存在，则后面几个文件就会被忽略；如果 \u003ccode\u003e~/.bash_profile\u003c/code\u003e 文件不存在，才会读取后面的文件，以此类推。\u003ccode\u003e~/.bashrc\u003c/code\u003e 没有上述规则，它是 \u003ccode\u003ebash\u003c/code\u003e \u003ccode\u003eshell\u003c/code\u003e 打开的时候载入的。\u003c/p\u003e\n\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003ezsh\u003c/code\u003e 后，我们在 ~/.zshrc 文件中写入环境变量，关闭当前终端，重新打开新的终端，即可看到写入的环境变量。\u003c/p\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e有时候 Mac 从睡眠状态恢复之后没有声音，这是因为 Mac OS X 的核心音频守护进程（coreaudiod）出了问题，杀死该进程即可：（会自动重启）\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo killall coreaudiod\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"5\"\u003e\n\u003cli\u003e清除 DNS 缓存，使用如下命令清除 DNS 缓存\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo killall -HUP mDNSResponder\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"6\"\u003e\n\u003cli\u003e显示隐藏文件和目录\n在终端中输入如下命令，即可显示隐藏文件和目录：\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edefaults write com.apple.finder AppleShowAllFiles -boolean true\nkillall Finder\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果想要隐藏原本隐藏的文件和目录，可以使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edefaults write com.apple.finder AppleShowAllFiles -boolean false \nkillall Finder\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"7\"\u003e\n\u003cli\u003e在 Mac 上打开目录\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eopen 目录路径\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"8\"\u003e\n\u003cli\u003emac monitor activity 不显示各资源数值了，删除 \u003ccode\u003e~/Library/Preferences/com.apple.ActivityMonitor.plist\u003c/code\u003e 文件，然后重启 ActivityMonitor 即可。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erm -f ~/Library/Preferences/com.apple.ActivityMonitor.plist\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"9\"\u003e\n\u003cli\u003e查看 xcode 版本\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003excodebuild -version\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"10\"\u003e\n\u003cli\u003e打开 iOS 开发中的描述文件。*.mobileprovision 是 iOS 开发中的设备描述文件，里面有证书信息、调试设备的 UUID 信息、bundle identifier 等，此文件是二进制格式，不能直接打开，可以使用命令行工具打开。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esecurity cms -D -i m.mobileprovision\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"11\"\u003e\n\u003cli\u003e将 iOS 项目的 ruby 工具链安装到当前目录下\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebundle install --path=`pwd`\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"12\"\u003e\n\u003cli\u003e安装 iOS 项目依赖\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebundle exec pod update --verbose\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1560729600,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1560729600,"objectID":"77643aaec052e088b7af6292e382e9a0","publishdate":1560729600,"relpermalink":"/posts/common/mac/mac-tips/","section":"posts","summary":"\u003cp\u003e本篇博客记录一些 Mac 下常用的操作或功能，以备后需。\u003c/p\u003e","tags":["Mac"],"title":"Mac 功能指南","url":"https://xdhuxc.github.io/posts/common/mac/mac-tips/","wordcount":868},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了在 Jenkins Pipeline 中 groovy 脚本发送 HTTP 请求的用法。\u003c/p\u003e\n\u003cp\u003e在使用 Jenkins Pipeline 时，有时需要和外部系统以 HTTP 方式交互或集成，此时就需要发送 HTTP 请求给外部系统，并接收响应，继续进行处理，而 curl 等命令不太好处理接收到的响应，此时可以使用 groovy 脚本来处理。\u003c/p\u003e\n\u003ch3 id=\"使用方法\"\u003e使用方法\u003c/h3\u003e\n\u003cp\u003e1、使用 Jenkins 第一件事情，安装插件，groovy 脚本发送 HTTP 请求需要安装 \u003ccode\u003eHTTP Request\u003c/code\u003e 插件，插件 ID 为：\u003c/p\u003e\n\u003cp\u003e2、在 pipeline 中编写代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003estage(\u0026#39;Deploy\u0026#39;) {\n    steps {\n        container(\u0026#39;golang-build-container\u0026#39;) {\n            script {\n                ws(projectPath) {  \n                    def payload = \u0026#34;\u0026#34;\u0026#34;\n                        { \u0026#34;app\u0026#34;: \u0026#34;xdhuxc-app\u0026#34; }\n                    \u0026#34;\u0026#34;\u0026#34;\n                    def authorization = \u0026#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1OTExNzkzNTYsInVzZXIiOiJ3YW5naHVhbnxbMTcgMyA0IDUgNiA3IDggOSAxMCAxMSAxMiAxMyAxNiAxOSAyMCAyMSAyMiAyMyAyNCAyNSAyNl18YWRtaW4ifQ.WR7GaFdm0y2SE3WHGYfE_VbTiXZovmm5hBojvhLn5NI\u0026#34;\n                    def app = \u0026#34;xdhuxc-app\u0026#34;\n                    def response = httpRequest acceptType: \u0026#39;APPLICATION_JSON\u0026#39;, contentType: \u0026#39;APPLICATION_JSON\u0026#39;, httpMode: \u0026#39;PUT\u0026#39;, requestBody: payload, url: \u0026#34;http://127.0.0.1:80/xdhuxc/apps?app=${app}\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eauthorization=${authorization}\u0026#34;, validResponseCodes: \u0026#34;100:511\u0026#34;\n                    if (response.status == 200) {\n                        println(\u0026#34;Http request to ${url} is successfully, the body is ${body}\u0026#34;)\n                    } else {\n                        throw new Exception(\u0026#34;the request failed, the http response status is ${response.status}, content is ${response.content}\u0026#34;)\n                    }\n                }\n            }\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，需要加 \u003ccode\u003evalidResponseCodes: \u0026quot;100:511\u0026quot;\u003c/code\u003e，默认的 \u003ccode\u003evalidResponseCodes\u003c/code\u003e 为 \u003ccode\u003e100:399\u003c/code\u003e，这意味着响应状态码为 \u003ccode\u003e400~511\u003c/code\u003e 的请求会直接抛错，拿不到响应。\u003c/p\u003e\n\u003cp\u003e此外，还可以添加自定义请求头：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edef response = httpRequest customHeaders: [[name: \u0026#39;cid\u0026#39;, value: \u0026#39;110\u0026#39;]]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e默认情况下，会输出整个请求的信息，包括：URL、请求头、返回码等。如果请求中含有不希望显示的 token，可以修改 \u003ccode\u003equiet: true\u003c/code\u003e 参数，不显示请求详情。\u003c/p\u003e\n\u003cp\u003e有时，我们可能会在提交的数据中加入变量，这时可通过如下方式提交数据：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport groovy.json.JsonOutput\n\nstage(\u0026#39;Deploy\u0026#39;) {\n    steps {\n        container(\u0026#39;golang-build-container\u0026#39;) {\n            script {\n                ws(env.WORKSPACE) { \n                    def url = \u0026#39;http://127.0.0.1:8000/xdhuxc/apps?app=xdhuxc-cicd\u0026#39;\n                    def body = JsonOutput.toJson([\u0026#34;xdhuxc-cicd\u0026#34;: env.image])\n                    def headers = [[name: \u0026#39;authorization\u0026#39;, value: \u0026#39;Bearer zZXIiOiJzZ3QtamVua2lucy11cGRhdGUtaW1hZ2V8WzE3IDEwIDExIDEyIDEzIDE2IDE5IDIwIDIxIDIyIDIzIDI0IDMgNCA1IDYgNyA4IDldfG9wZW5hcGktc2d0LWplbmtpbnMtdXBkYXRlLWltYWdlIn0\u0026#39;]]\n                    def response = httpRequest acceptType: \u0026#39;APPLICATION_JSON\u0026#39;, contentType: \u0026#39;APPLICATION_JSON\u0026#39;, customHeaders: headers, httpMode: \u0026#39;PUT\u0026#39;, requestBody: body, url: url, validResponseCodes: \u0026#34;100:511\u0026#34;, quiet: true\n                    if (response.status == 200) {\n                        println(\u0026#34;Http request to ${url} is successfully, the body is ${body}\u0026#34;)\n                    } else {\n                        throw new Exception(\u0026#34;Deploy to kubernetes failed, the http response status is ${response.status}, content is ${response.content}\u0026#34;)\n                    }\n                 }\n            }\n        }\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.jenkins.io/doc/pipeline/steps/http_request/#httprequest-perform-an-http-request-and-return-a-response-object\"\u003ehttps://www.jenkins.io/doc/pipeline/steps/http_request/#httprequest-perform-an-http-request-and-return-a-response-object\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ehttp request 插件参数：https://www.jenkins.io/doc/pipeline/steps/http_request/#http-request-plugin\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/jenkinsci/http-request-plugin\"\u003ehttps://github.com/jenkinsci/http-request-plugin\u003c/a\u003e\u003c/p\u003e","date":1560729600,"description":"","fuzzywordcount":700,"kind":"page","lang":"zh","lastmod":1576281600,"objectID":"1ecfbfe0c622ff14026a56be7ab0046c","publishdate":1560729600,"relpermalink":"/posts/devops/jenkins/jenkins-groovy-http/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了在 Jenkins Pipeline 中 groovy 脚本发送 HTTP 请求的用法。\u003c/p\u003e\n\u003cp\u003e在使用 Jenkins Pipeline 时，有时需要和外部系统以 HTTP 方式交互或集成，此时就需要发送 HTTP 请求给外部系统，并接收响应，继续进行处理，而 curl 等命令不太好处理接收到的响应，此时可以使用 groovy 脚本来处理。\u003c/p\u003e","tags":["DevOps","Jenkins","groovy"],"title":"在 Jenkins Pipeline 的 groovy 脚本中发送 HTTP 请求","url":"https://xdhuxc.github.io/posts/devops/jenkins/jenkins-groovy-http/","wordcount":660},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了在 Jenkins 中配置 Gitlab 触发器的过程，从而使得当我们向 gitlab 提交代码时，打上标签，就可以直接触发构建。\u003c/p\u003e\n\u003ch3 id=\"操作和配置\"\u003e操作和配置\u003c/h3\u003e\n\u003cp\u003e1、在 Jenkins 和 Gitlab 之间配置触发构建，希望在 Gitlab 上提交代码时，打上标签提交时，触发该工程在 Jenkins 中的构建。\u003c/p\u003e\n\u003cp\u003e1）在 GitLab 中使用管理员账户，生成 GitLab API Token，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG71.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在 Jenkins 中，\u003ccode\u003e系统设置\u003c/code\u003e -\u0026gt; \u003ccode\u003eAdd Credentials\u003c/code\u003e 中，添加用于认证的 Credentials\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG72.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e使得 Jenkins 可以访问 GitLab 的 API 接口。\u003c/p\u003e\n\u003cp\u003e2）在 Jenkins 中，选中 \u003ccode\u003eBuild when a change is pushed to GitLab\u003c/code\u003e（此处需要使用插件 \u003ccode\u003eGitlab Hook\u003c/code\u003e），将 \u003ccode\u003eGitLab webhook URL\u003c/code\u003e 地址\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG610.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e填写至 GitLab 工程的 \u003ccode\u003e设置\u003c/code\u003e -\u0026gt;\u003ccode\u003e集成\u003c/code\u003e 中 Web hook 下的 \u003ccode\u003e链接\u003c/code\u003e 输入框中；\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG612.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在 Jenkins 中，\u003ccode\u003eBuild when a change is pushed to GitLab\u003c/code\u003e 下，点击 \u003ccode\u003eAdvanced\u003c/code\u003e，再点击 \u003ccode\u003eGenerate\u003c/code\u003e，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG68.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e将生成的 \u003ccode\u003eSecret token\u003c/code\u003e 填写至 GitLab 工程 \u003ccode\u003e设置\u003c/code\u003e -\u0026gt; \u003ccode\u003e集成\u003c/code\u003e 中 Web hook 下的 \u003ccode\u003e安全令牌\u003c/code\u003e 输入框中\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG619.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在触发器部分，取消 \u003ccode\u003e推送事件\u003c/code\u003e 触发器，选择 \u003ccode\u003e标签推送事件\u003c/code\u003e 触发器触发。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG621.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e保存后，可进行测试。\u003c/p\u003e\n\u003cp\u003e3）在项目 \u003ccode\u003e设置\u003c/code\u003e -\u0026gt; \u003ccode\u003e仓库\u003c/code\u003e -\u0026gt; \u003ccode\u003e部署秘钥\u003c/code\u003e -\u0026gt; \u003ccode\u003e展开\u003c/code\u003e，使用 Jenkins 所在机器的公钥创建部署秘钥并为当前工程启用之。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG617.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e2、使用 Jenkins 进行应用的持续集成并构建 docker 镜像，想使用推送代码时的标签迁出代码并以标签作为镜像版本，可以安装 \u003ccode\u003eGit Tag Message Plugin\u003c/code\u003e 插件来实现。\u003c/p\u003e\n\u003cp\u003e安装 \u003ccode\u003eJenkins Git Plugin\u003c/code\u003e 插件后，默认可以获取如下 7 个环境变量：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGIT_COMMIT：对当前 Git 提交的安全哈希算法（SHA）的引用；\u003c/li\u003e\n\u003cli\u003eGIT_COMMITTER_NAME（GIT_AUTHOR_NAME）：发布新 Git 提交时使用的名称；\u003c/li\u003e\n\u003cli\u003eGIT_COMMITTER_EMAIL（GIT_AUTHOR_EMAIL）：发布新的 Git 提交时使用的电子邮件地址；\u003c/li\u003e\n\u003cli\u003eGIT_URL：远程 Git 仓库的基本名称；\u003c/li\u003e\n\u003cli\u003eGIT_URL_N：如果正在使用多个远程 Git 仓库，这将以数字方式列出它们；\u003c/li\u003e\n\u003cli\u003eGIT_BRANCH：Jenkins Git 插件正在操作的当前 Git 分支的名称；\u003c/li\u003e\n\u003cli\u003eGIT_LOCAL_BRANCH：本地 Git 分支的名称，当 Jenkins Git 插件中 “checkout to specific local branch” 选项被选中的时候；\u003c/li\u003e\n\u003cli\u003eGIT_PREVIOUS_COMMIT：当前分支上前一个提交的 id；\u003c/li\u003e\n\u003cli\u003eGIT_PREVIOUS_SUCCESSFUL_COMMIT：这个变量将会输出最后一次成功的构建时提交的哈希值；\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e安装 \u003ccode\u003eGit Tag Message Plugin\u003c/code\u003e 后，可以在脚本中使用环境变量 \u003ccode\u003eGIT_TAG_NAME\u003c/code\u003e 和 \u003ccode\u003eGIT_TAG_MESSAGE\u003c/code\u003e 来获取代码提交的标签信息，只迁出该提交的代码进行集成。\u003c/p\u003e\n\u003cp\u003e如果该方法失效，可以直接在 shell 脚本中使用环境变量获取提交代码得标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etag=${gitlabSourceBranch##*/}\nif [ -z \u0026#34;$tag\u0026#34; ];then\n  echo \u0026#34;the absent of git tag\u0026#34;\n  exit 1\nfi\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、配置钉钉通知构建结果\u003c/p\u003e\n\u003cp\u003e1）安装 Dingding 插件\u003c/p\u003e\n\u003cp\u003e2）增加 \u003ccode\u003ePost-build Actions\u003c/code\u003e，添加\u003ccode\u003e钉钉通知器配置\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/devops/jenkins/WechatIMG615.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e4、从 Jenkins 向需要授权的 docker registry 中推送镜像\n安装 docker-commons 插件，在 系统管理 中，在 docker 部分，添加 docker 镜像仓库的地址，并使用任意有权限的的账户和密码创建 credentials，保存之，即可从 shell 脚本中直接向需要认证的 docker 镜像仓库中推送镜像。\u003c/p\u003e\n\u003ch3 id=\"常见问题及解决\"\u003e常见问题及解决\u003c/h3\u003e\n\u003cp\u003e1、在 GitLab 中某项目的 \u003ccode\u003e设置\u003c/code\u003e -\u0026gt; \u003ccode\u003e集成\u003c/code\u003e 中配置 Jenkins webhook，配置完成后点击 \u003ccode\u003eTest\u003c/code\u003e，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eHook execution failed: URL 'https://jenkins.xdhuxc.com/project/transform' is blocked: Requests to the local network are not allowed\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e解决：在 \u003ccode\u003e管理员区域\u003c/code\u003e 中 \u003ccode\u003e设置\u003c/code\u003e 下，在 \u003ccode\u003eOutbound requests\u003c/code\u003e部分，选择 \u003ccode\u003eAllow requests to the local network from hooks and services\u003c/code\u003e，然后保存之。\u003c/p\u003e\n\u003cp\u003e参考链接：https://gitlab.com/gitlab-org/gitlab-ce/issues/46490\u003c/p\u003e","date":1560729600,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1576281600,"objectID":"89b2492e21d0c2f4de2d6bdbda27afa4","publishdate":1560729600,"relpermalink":"/posts/devops/jenkins/jenkins-gitlab-trigger/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了在 Jenkins 中配置 Gitlab 触发器的过程，从而使得当我们向 gitlab 提交代码时，打上标签，就可以直接触发构建。\u003c/p\u003e","tags":["DevOps","Jenkins","Gitlab"],"title":"在 Jenkins 中配置 gitlab 触发器","url":"https://xdhuxc.github.io/posts/devops/jenkins/jenkins-gitlab-trigger/","wordcount":1274},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了一些使用 GORM 操作 MySQL 数据库时常见的问题及解决方法，可以给其他人遇到同样问题解决时提供参考。\u003c/p\u003e\n\u003ch3 id=\"error-1062-duplicate-entry-viewer-for-key-name\"\u003eError 1062: Duplicate entry 'viewer' for key 'name'\u003c/h3\u003e\n\u003cp\u003e为数据模型中的 name 字段加上了 unique 修饰，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# create the table role\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eCREATE TABLE IF NOT EXISTS \u003cspan class=\"sb\"\u003e`role`\u003c/span\u003e (\n    \u003cspan class=\"sb\"\u003e`id`\u003c/span\u003e int(11) NOT NULL AUTO_INCREMENT,\n    \u003cspan class=\"sb\"\u003e`name`\u003c/span\u003e varchar(50) NOT NULL,\n    \u003cspan class=\"sb\"\u003e`description`\u003c/span\u003e varchar(125) DEFAULT NULL,\n    \u003cspan class=\"sb\"\u003e`create_time`\u003c/span\u003e datetime     NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \u003cspan class=\"sb\"\u003e`update_time`\u003c/span\u003e datetime     NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n    PRIMARY KEY (`id`),\n    UNIQUE KEY \u003cspan class=\"sb\"\u003e`name`\u003c/span\u003e (`name`)\n) ENGINE = InnoDB DEFAULT CHARSET = utf8;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e但是更新该字段的值时，却报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n \u0026#34;code\u0026#34;: 50002,\n \u0026#34;result\u0026#34;: \u0026#34;Error 1062: Duplicate entry \u0026#39;viewer\u0026#39; for key \u0026#39;name\u0026#39;\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e后台代码使用 Golang 编写，数据模型为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etype Role struct {\n\tID          int       \u003cspan class=\"sb\"\u003e`json:\u0026#34;id\u0026#34; gorm:\u0026#34;id\u0026#34;`\u003c/span\u003e\n\tName        string    \u003cspan class=\"sb\"\u003e`json:\u0026#34;name\u0026#34; gorm:\u0026#34;name\u0026#34;`\u003c/span\u003e\n\tDescription string    \u003cspan class=\"sb\"\u003e`json:\u0026#34;description\u0026#34; gorm:\u0026#34;description\u0026#34;`\u003c/span\u003e\n\tCreateTime  time.Time \u003cspan class=\"sb\"\u003e`json:\u0026#34;create_time\u0026#34; gorm:\u0026#34;create_time\u0026#34;`\u003c/span\u003e\n\tUpdateTime  time.Time \u003cspan class=\"sb\"\u003e`json:\u0026#34;update_time\u0026#34; gorm:\u0026#34;update_time\u0026#34;`\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e更新代码的方法为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e// Update updates the information of specified role\nfunc (rs *roleService) Update(role model.Role) (*model.Role, error) {\n\tif err := role.Validate(); err != nil {\n\t\treturn \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003erole, err\n\t}\n\n\trole.UpdateTime = time.Now()\n\n\tif err := rs.db.Model(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003emodels.Role{}).Update(map[string]interface{}{\n\t\t\u0026#34;name\u0026#34;:        role.Name,\n\t\t\u0026#34;description\u0026#34;: role.Description,\n\t\t\u0026#34;update_time\u0026#34;: role.UpdateTime,\n\t}).Error; err != nil {\n\t\treturn \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003erole, err\n\t}\n\n\treturn \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003erole, nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改为如下方式时，却可以更新成功\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e// Update updates the information of specified role\nfunc (rs *roleService) Update(role model.Role) (*model.Role, error) {\n\tif err := role.Validate(); err != nil {\n\t\treturn \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003erole, err\n\t}\n\n\trole.UpdateTime = time.Now()\n\n\tif err := rs.db.Model(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003erole).Update(map[string]interface{}{\n\t\t\u0026#34;name\u0026#34;:        role.Name,\n\t\t\u0026#34;description\u0026#34;: role.Description,\n\t\t\u0026#34;update_time\u0026#34;: role.UpdateTime,\n\t}).Error; err != nil {\n\t\treturn \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003erole, err\n\t}\n\n\treturn \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003erole, nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将 db.Model(value interface{}) 中的接口类型参数由 \u0026amp;models.Role{} 修改为 \u0026amp;role，居然就可以更新成功了。\u003c/p\u003e\n\u003cp\u003e查看该方法的\u003ca href=\"https://github.com/jinzhu/gorm/main.go\"\u003e源代码\u003c/a\u003e，如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e// Model specify the model you would like to run db operations\n//    // update all users\u0026#39;s name to \u003cspan class=\"sb\"\u003e`hello`\u003c/span\u003e\n//    db.Model(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eUser{}).Update(\u0026#34;name\u0026#34;, \u0026#34;hello\u0026#34;)\n//    // if user\u0026#39;s primary key is non-blank, will use it as condition, then will only update the user\u0026#39;s name to \u003cspan class=\"sb\"\u003e`hello`\u003c/span\u003e\n//    db.Model(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003euser).Update(\u0026#34;name\u0026#34;, \u0026#34;hello\u0026#34;)\nfunc (s *DB) Model(value interface{}) *DB {\n\tc := s.clone()\n\tc.Value = value\n\treturn c\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e从该方法的注释来看，如果使用 \u0026amp;User{}，那么将会更新数据库的所有记录的相同字段为同样的值，如果设置某个字段为 unique，那么当记录数超过一条时，肯定会产生重复的字段值从而导致错误。而实际上，我们的目的是第二种，使用 \u0026amp;user，以主键作为条件更新一条记录。所以，使用 GORM 的 Update 方法时，不要传入指向结构体的指针，而应该传入指向结构体变量的指针。\u003c/p\u003e\n\u003ch3 id=\"desc-是-mysql-关键字\"\u003edesc 是 MySQL 关键字\u003c/h3\u003e\n\u003cp\u003e更新数据时，后台 API 返回的错误为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e \u0026#34;result\u0026#34;: \u0026#34;Error 1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \u0026#39;desc = ?, cloud = ?, update_time = ? WHERE id = ?\u0026#39; at line 1\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e实际上使用的 SQL 语句为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eUPDATE \u003cspan class=\"sb\"\u003e`xdhuxc_aksk`\u003c/span\u003e SET iam = ?, desc = ?, cloud = ?, update_time = ? WHERE id = ?\u0026#34;, g.Iam, g.Desc, g.Cloud, g.UpdateTime, g.ID\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e之所以出现上面的错误，是因为 desc 为 MySQL 数据库关键字，导致该 SQL 语句错误。\u003c/p\u003e\n\u003cp\u003e改为如下形式即可：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eUPDATE \u003cspan class=\"sb\"\u003e`xdhuxc_aksk`\u003c/span\u003e SET iam = ?, \u003cspan class=\"sb\"\u003e`desc`\u003c/span\u003e = ?, cloud = ?, update_time = ? WHERE id = ?\u0026#34;, g.Iam, g.Desc, g.Cloud, g.UpdateTime, g.ID\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当然，设计数据库字段名称时，最好不要和 MySQL 数据库关键字冲突，但是如果已经使用了 MySQL 数据库关键字，可以使用反引号将该字段名称括起来，这样也可以操作成功。\u003c/p\u003e\n\u003ch3 id=\"count-方法的使用\"\u003eCount 方法的使用\u003c/h3\u003e\n\u003cp\u003eCount() 方法一般用于分页时统计总记录数，但是和 Where() 方法连用时，情况会有些不同。对于如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif err := rs.db.Model(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003emodels.User{}).\n    Where(\u0026#34;tags-\u0026gt;\u0026#39;$.group\u0026#39; = ?\u0026#34;, group).\n    Count(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003ecount).\n    Offset(page.Offset).\n    Limit(page.PageSize).\n    Order(\u0026#34;update_time desc\u0026#34;).\n    Find(\u003cspan class=\"ni\"\u003e\u0026amp;users).Error;\u003c/span\u003e err != nil {\n        return count, users, err\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e需要注意：\u003c/p\u003e\n\u003cp\u003e1、实际上是运行了两条 sql 语句，并非运行了一条 sql 语句。也因此，考虑到注意事项 2 ，在 Where 条件不复杂的时候，把 Count() 单独出来也可以，代码稍有冗余但更清晰。\u003c/p\u003e\n\u003cp\u003e2、Count() 方法写在 Where() 方法之前，等同于无条件的统计所有记录，如下 sql 日志所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e(/Users/wanghuan/GolandProjects/GoPath/src/gitlab.xdhuxc.me/devops/xdhuxc/src/service/user.go:38) \n[2019-11-12 11:28:26]  [87.37ms]  SELECT count(*) FROM \u003cspan class=\"sb\"\u003e`user`\u003c/span\u003e    \n[0 rows affected or returned ] \n\n(/Users/wanghuan/GolandProjects/GoPath/src/gitlab.xdhuxc.me/devops/xdhuxc/src/service/user.go:43) \n[2019-11-12 11:28:27]  [175.49ms]  SELECT * FROM \u003cspan class=\"sb\"\u003e`user`\u003c/span\u003e  WHERE (tags-\u0026gt;\u0026#39;$.group\u0026#39; = \u0026#39;Math\u0026#39;) ORDER BY update_time desc LIMIT 10 OFFSET 0  \n[4 rows affected or returned ] \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eCount() 方法写在 Where() 方法之前，是在仅附加 where 条件之后的统计记录数，不包含 offset 等，如下图 sql 日志所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e(/Users/wanghuan/GolandProjects/GoPath/src/gitlab.xdhuxc.me/devops/xdhuxc/src/service/user.go:39) \n[2019-11-12 11:26:52]  [179.90ms]  SELECT count(*) FROM \u003cspan class=\"sb\"\u003e`user`\u003c/span\u003e  WHERE (tags-\u0026gt;\u0026#39;$.group\u0026#39; = \u0026#39;Math\u0026#39;)  \n[0 rows affected or returned ] \n\n(/Users/wanghuan/GolandProjects/GoPath/src/gitlab.xdhuxc.me/devops/xdhuxc/src/service/user.go:43)\n[2019-11-12 11:26:53]  [176.48ms]  SELECT * FROM \u003cspan class=\"sb\"\u003e`user`\u003c/span\u003e  WHERE (tags-\u0026gt;\u0026#39;$.group\u0026#39; = \u0026#39;Math\u0026#39;) ORDER BY update_time desc LIMIT 10 OFFSET 0  \n[4 rows affected or returned ] \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"使用-restfulrequestreadentity-方法读取-json-格式数据到结构体中时出现如下错误\"\u003e使用 *restful.Request.ReadEntity 方法读取 JSON 格式数据到结构体中时，出现如下错误：\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-angular2html\" data-lang=\"angular2html\"\u003ejson: cannot unmarshal string into Go struct field Receiver.resolved of type bool\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e原因：输入格式有错误，将 JSON 格式中 bool 值写成了 字符串 true，改为 JSON 格式的 bool 值即可解决该问题。\u003c/p\u003e\n\u003ch3 id=\"range-的数据复制\"\u003erange 的数据复制\u003c/h3\u003e\n\u003cp\u003e对关联的数据模型进行操作时，使用如下代码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evar ug []models.UserGroup\nfor _, user := range ug {\n  var role models.Role\n  if result := ugs.db.Model(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003emodels.Role{}).\n    Where(\u0026#34;id = ?\u0026#34;, user.RoleID).\n    Select([]string{\u0026#34;id\u0026#34;, \u0026#34;name\u0026#34;}).\n    First(\u003cspan class=\"ni\"\u003e\u0026amp;role);\u003c/span\u003e result.Error != nil {\n    continue\n  }\n  user.RoleName = role.Name\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e则对 user.RoleName 的赋值，只在大括号中有效，而使用下面的代码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eugLength := len(ug)\nfor i := 0; i \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003eugLength\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e++\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"na\"\u003evar\u003c/span\u003e \u003cspan class=\"na\"\u003erole\u003c/span\u003e \u003cspan class=\"na\"\u003emodels\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eRole\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eif\u003c/span\u003e \u003cspan class=\"na\"\u003eresult\u003c/span\u003e \u003cspan class=\"na\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003eugs.db.Model(\u0026amp;models.Role{}).\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eWhere\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eid \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e?\u0026#34;,\u003c/span\u003e \u003cspan class=\"na\"\u003eug\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e].\u003c/span\u003e\u003cspan class=\"na\"\u003eRoleID\u003c/span\u003e\u003cspan class=\"err\"\u003e).\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eSelect\u003c/span\u003e\u003cspan class=\"err\"\u003e([]\u003c/span\u003e\u003cspan class=\"na\"\u003estring\u003c/span\u003e\u003cspan class=\"err\"\u003e{\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;}).\u003c/span\u003e\n    \u003cspan class=\"na\"\u003eFirst\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u0026amp;\u003c/span\u003e\u003cspan class=\"na\"\u003erole\u003c/span\u003e\u003cspan class=\"err\"\u003e);\u003c/span\u003e \u003cspan class=\"na\"\u003eresult\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eError\u003c/span\u003e \u003cspan class=\"err\"\u003e!=\u003c/span\u003e \u003cspan class=\"na\"\u003enil\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"na\"\u003econtinue\u003c/span\u003e\n  \u003cspan class=\"err\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"na\"\u003eug\u003c/span\u003e\u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003ei\u003c/span\u003e\u003cspan class=\"err\"\u003e].\u003c/span\u003e\u003cspan class=\"na\"\u003eRoleName \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003erole.Name\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e则对 \u003ccode\u003euser.RoleName\u003c/code\u003e 的赋值在大括号外也有效。\n原因：使用 \u003ccode\u003erange\u003c/code\u003e 循环非指针型数组时，实际上是执行了深拷贝，在遍历复制出来的数据，原来的数据并没有改变。\u003c/p\u003e\n\u003ch3 id=\"gorm-注意事项\"\u003eGORM 注意事项\u003c/h3\u003e\n\u003cp\u003e1、如果数据记录不存在，使用 Delete() 方法删除该记录，result.Error 返回值为 nil。\u003c/p\u003e\n\u003cp\u003e2、GORM 中默认使用 id 为主键进行删除和修改，如果自定义数据库主键名称，可能会导致\u0008删除和修改操作失败。\u003c/p\u003e","date":1560211200,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1560211200,"objectID":"6856e08c2418e3ae14fd25a1778c6f6f","publishdate":1560211200,"relpermalink":"/posts/programming/golang/golang-gorm-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录了一些使用 GORM 操作 MySQL 数据库时常见的问题及解决方法，可以给其他人遇到同样问题解决时提供参考。\u003c/p\u003e","tags":["MySQL","Golang","GORM"],"title":"使用 GORM 操作 MySQL 常见问题及解决","url":"https://xdhuxc.github.io/posts/programming/golang/golang-gorm-questions-and-solutions/","wordcount":1666},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍配置拉取工具 confd 的使用，以备后需。\u003c/p\u003e\n\u003cp\u003econfd 可以从后台数据源拉取数据，以 golang 模板的方式编写配置文件，渲染到本地文件，这对于一些需要动态或定时更改配置文件的程序非常方便。但是，有些数据源具有发布/订阅的特性，可以向 confd 推送数据，另外一些，就只能采用定时拉取的方式了。\u003c/p\u003e\n\u003ch3 id=\"confd-安装\"\u003econfd 安装\u003c/h3\u003e\n\u003cp\u003e下载二进制安装文件并复制到 PATH 目录下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 下载二进制文件\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ewget https://github.com/kelseyhightower/confd/releases/download/v0.16.0/confd-0.16.0-linux-amd64\n\u003cspan class=\"gh\"\u003e# 重命名该文件\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emv confd-0.16.0-linux-amd64 confd\n\u003cspan class=\"gh\"\u003e# 添加执行权限并移动至 PATH 路径下\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003echmod +x confd \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e cp confd /usr/bin/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e也可自行根据 \u003ca href=\"https://github.com/kelseyhightower/confd\"\u003econfd 源码\u003c/a\u003e 构建\u003c/p\u003e\n\u003ch3 id=\"confd-配置及运行\"\u003econfd 配置及运行\u003c/h3\u003e\n\u003cp\u003e1、创建 confdir，用于存放 confd 的配置文件和模板文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 存放 confd 使用的配置文件\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emkdir -p /etc/confd/conf.d    \n\u003cspan class=\"gh\"\u003e# 用于存放模板文件，生成最终的配置文件\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emkdir -p /etc/confd/templates\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、创建模板文件及其 confd 配置文件\u003c/p\u003e\n\u003cp\u003e模板文件 /etc/confd/templates/alertmanager.yaml.tmpl\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eglobal:\n  resolve_timeout: 5m\nroute:\n  group_by: [\u0026#39;alertname\u0026#39;]\n  group_wait: 30s\n  group_interval: 5m\n  repeat_interval: 15m\n  receiver: send_to_dingding_ai\n\n  routes:{{range gets \u0026#34;/alertmanager/routes/*\u0026#34;}}{{$item := json .Value}} # 渲染 JSON 格式数据\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e match_re: {{range $key, $value := json $item.match_re}}\n      {{$key}}: \u0026#34;{{$value}}\u0026#34;{{end}}\n    continue: true  \n    receiver: {{$item.receiver}}{{end}} # {{end}} 写在行尾，处理多余的空行，否则生成的文件中会有多余的空行\n    # continue: true # 注意，continue 写在此处，会将数据渲染完毕后，只有一个 continue\n\ninhibit_rules:\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e source_match:\n    severity: \u0026#39;critical\u0026#39;\n  target_match:\n    severity: \u0026#39;warning\u0026#39;\n  equal: [\u0026#39;alertname\u0026#39;]\n\nreceivers:{{range gets \u0026#34;/alertmanager/receivers/*\u0026#34;}}{{$item := json .Value}}{{ if eq $item.type \u0026#34;dingtalk\u0026#34; }} # 条件判断\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: {{$item.name}}\n  dingtalk_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e send_resolved: {{$item.resolved}}\n    webhook_url: {{$item.url}}{{ else if eq $item.type \u0026#34;email\u0026#34; }}\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: {{$item.name}}\n  email_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e send_resolved: {{$item.resolved}}\n    to: {{$item.url}}{{end}}{{end}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在本地启动 DynamoDB 数据库实例，配置如下环境变量：（confd 需要使用这些环境变量）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport AWS_REGION=ap-southeast-1\nexport DYNAMODB_LOCAL=http://localhost:8000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e存储在 DynamoDB 中的数据格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n  \u0026#34;key\u0026#34;: \u0026#34;/xdhuxc/alertmanager/receivers/10\u0026#34;,\n  \u0026#34;value\u0026#34;: \u0026#34;{\\\u0026#34;name\\\u0026#34;:\\\u0026#34;send_to_dingding_bigdata\\\u0026#34;,\\\u0026#34;resolved\\\u0026#34;:false,\\\u0026#34;type\\\u0026#34;:\\\u0026#34;dingtalk\\\u0026#34;,\\\u0026#34;url\\\u0026#34;:\\\u0026#34;https://oapi.dingtalk.com/robot/send?access_token=238c10a8984980a1f34228cab29cbbdaaaceb80ef82ee125c96e3166628e2c44\\\u0026#34;}\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n  \u0026#34;key\u0026#34;: \u0026#34;/xdhuxc/alertmanager/routes/25\u0026#34;,\n  \u0026#34;value\u0026#34;: \u0026#34;{\\\u0026#34;receiver\\\u0026#34;:\\\u0026#34;send_to_dingding_business\\\u0026#34;,\\\u0026#34;match_re\\\u0026#34;:\\\u0026#34;{\\\\\\\u0026#34;namespace\\\\\\\u0026#34;: \\\\\\\u0026#34;business\\\\\\\u0026#34;}\\\u0026#34;}\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这些数据由页面加入，以结构化数据存储到 mysql 中，再组织成 key-value 格式存储到 DynamoDB 中。\u003c/p\u003e\n\u003cp\u003e此处要特别注意 key 的组成方式和获取值得方式。key 由配置文件中的 tamplate 部分的 prefix + 模板中的前缀路径 + 记录在数据库中的 ID 组成\u003c/p\u003e\n\u003cp\u003e配置文件 /etc/confd/conf.d/alertmanager.yaml.toml\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[template]\nprefix = \u0026#34;/xdhuxc\u0026#34;\nsrc = \u0026#34;alertmanager.yaml.tmpl\u0026#34;\ndest = \u0026#34;/tmp/alertmanager.yaml\u0026#34;\nkeys = [\n    \u0026#34;/alertmanager\u0026#34;  # 需要获取数据的键\n]\nnodes = [\n    \u0026#34;\u0026#34;\n]\n\nreload_cmd = \u0026#34;curl -X POST http://localhost:9093/-/reload\u0026#34; # 更新配置文件后重启进程的命令\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 confd 进程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econfd -onetime -backend dynamodb -node http://localhost:8000 -table xdhuxc --log-level debug\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、最终渲染出来的配置文件内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eglobal:\n  resolve_timeout: 5m\nroute:\n  group_by: [\u0026#39;alertname\u0026#39;]\n  group_wait: 30s\n  group_interval: 5m\n  repeat_interval: 15m\n  receiver: send_to_dingding_ai\n\n  routes:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e match_re:\n      namespace: \u0026#34;business\u0026#34;\n    continue: true\n    receiver: send_to_dingding_business\n\ninhibit_rules:\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e source_match:\n    severity: \u0026#39;critical\u0026#39;\n  target_match:\n    severity: \u0026#39;warning\u0026#39;\n  equal: [\u0026#39;alertname\u0026#39;]\n\nreceivers:\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: send_to_dingding_bigdata\n  dingtalk_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e send_resolved: false\n    webhook_url: https://oapi.dingtalk.com/robot/send?access_token=238c10a8984980a1f34228cab29cbbdaaaceb80ef82ee125c96e3166628e2c44\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"以-linux-系统服务方式运行-confd\"\u003e以 Linux 系统服务方式运行 confd\u003c/h3\u003e\n\u003cp\u003e以 Linux 系统服务方式部署 confd，每 5 分钟拉取一次配置文件，confd.service 文件内容为：（/usr/lib/systemd/system/confd.service）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=confd\nDocumentation=http://www.confd.io/\nAfter=network.target\n\n[Service]\nType=simple\nEnvironment=\u0026#34;AWS_REGION=ap-southeast-1\u0026#34;\nEnvironment=\u0026#34;DYNAMODB_LOCAL=\u0026#34;\nEnvironment=\u0026#34;HOME=/root\u0026#34;\nExecStart=/usr/bin/confd -backend dynamodb -table xdhuxc --interval 300 --profile xdhuxc --log-level debug\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上使用 AWS DynamoDB 数据源作为示例，其他数据源可参考 \u003ca href=\"https://github.com/kelseyhightower/confd/blob/master/docs/configuration-guide.md\"\u003econfd 配置指南\u003c/a\u003e 修改环境变量和启动命令\u003c/p\u003e\n\u003cp\u003e当后端存储为 redis 时，confd.service（/usr/lib/systemd/system/confd.service）文件内容为：：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=confd\nDocumentation=http://www.confd.io/\nAfter=network.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/confd --backend redis --node 8.8.8.8:6379 --client-key qZ2$0bHBL --interval 300 --log-level debug\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当后端存储为 etcd 时，confd.service（/usr/lib/systemd/system/confd.service）文件内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=confd\nDocumentation=http://www.confd.io/\nAfter=network.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/confd --watch -backend etcd --node http://127.0.0.1:2379 --log-level debug\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当后端存储为 consul 时，confd.service（/usr/lib/systemd/system/confd.service）文件内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=confd\nDocumentation=http://www.confd.io/\nAfter=network.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/confd --watch -backend consul --node 127.0.0.1:8500 --log-level debug\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e命令说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e--backend：指明数据源，默认为 etcd；\u003c/li\u003e\n\u003cli\u003e-table：当数据源为 DynamoDB 时，指定 DynamoDB 表，仅用于数据源为 DynamoDB 时；\u003c/li\u003e\n\u003cli\u003e--interval：后台轮询间隔，以秒为单位，默认值为：600；\u003c/li\u003e\n\u003cli\u003e--profile：在使用 DynamoDB 作为数据源时，使用 AWS AccessKey 和 Secret Key 的 profile，防止和其他程序使用的 AccessKey 和 Secret Key 冲突，源代码中没有此选项，此处使用的是改造过的\u003ca href=\"https://github.com/xdhuxc/confd\"\u003e代码\u003c/a\u003e；\u003c/li\u003e\n\u003cli\u003e--log-level：confd 日志级别，默认为： info；\u003c/li\u003e\n\u003cli\u003e--watch：启用 watch 功能，当 etcd 或 consul 中的数据发生变化时，会触发 confd 全量同步数据，近实时同步。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e添加如下 profile 到 ~/.aws/credentials 文件中\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[xdhuxc]\naws_access_key_id = \u0026#39;${AWS_ACCESS_KEY_ID}\u0026#39;\naws_secret_access_key = \u0026#39;${AWS_SECRET_ACCESS_KEY}\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e该 profile 需要有读 AWS DynamoDB 的权限。\u003c/p\u003e\n\u003cp\u003e启动命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload\nsystemctl restart confd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/kelseyhightower/confd\"\u003ehttps://github.com/kelseyhightower/confd\u003c/a\u003e\u003c/p\u003e","date":1559692800,"description":"","fuzzywordcount":1600,"kind":"page","lang":"zh","lastmod":1559692800,"objectID":"ad11c3f562d04967912cfbce9a48035b","publishdate":1559692800,"relpermalink":"/posts/tools/tools-confd/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍配置拉取工具 confd 的使用，以备后需。\u003c/p\u003e","tags":["confd","DynamoDB"],"title":"配置拉取工具 confd 的使用及说明","url":"https://xdhuxc.github.io/posts/tools/tools-confd/","wordcount":1596},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下使用 AWS DynamoDB 过程中用到的一些知识和技术点，以备后需。\u003c/p\u003e\n\u003cp\u003eAmazon DynamoDB 是一个键/值和文档数据库，可以在任何规模的环境中提供个位数的毫秒级性能。它是一个完全托管的多区域多主数据库，具有适用于 Internet 规模的应用程序的内置安全性、备份和恢复和内存缓存。DynamoDB 每天可处理超过 10 万亿个请求，并可支持每秒超过 2000 万个请求的峰值。\u003c/p\u003e\n\u003ch3 id=\"使用-docker-本地部署-dynamodb\"\u003e使用 docker 本地部署 DynamoDB\u003c/h3\u003e\n\u003cp\u003e使用 docker 容器本地部署 DynamoDB 实例\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d -p 8000:8000 amazon/dynamodb-local\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"使用命令行操作-dynamodb\"\u003e使用命令行操作 DynamoDB\u003c/h3\u003e\n\u003cp\u003e执行 aws 命令前，需要在 ~/.aws/credentials 中配置访问 DynamoDB 的 Access Key 和 Secret Key，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[default]\naws_access_key_id = ${aws_access_key_id}\naws_secret_access_key = ${aws_access_key_id}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 ~/.aws/config 中配置区域，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[default]\nregion = ap-southeast-1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果是本地启动的 DynamoDB 实例，只需任意一个合法的 DynamoDB Access Key 和 Secret Key 即可。\u003c/p\u003e\n\u003cp\u003e1、显示所有数据库表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eaws dynamodb list-tables --endpoint-url http://localhost:8000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、显示特定表信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eaws dynamodb describe-table --table-name xdhuxc --endpoint-url http://localhost:8000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、创建表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eaws dynamodb create-table \\\n    --table-name xdhuxc \\\n    --attribute-definitions \\\n        AttributeName=key,AttributeType=S \\\n    --key-schema \\\n        AttributeName=key,KeyType=HASH \\\n    --provisioned-throughput ReadCapacityUnits=10,WriteCapacityUnits=10 \\\n    --endpoint-url http://localhost:8000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、插入 JSON 格式数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eaws dynamodb put-item --table-name xdhuxc \\\n    --item \u0026#39;{ \u0026#34;key\u0026#34;: { \u0026#34;S\u0026#34;: \u0026#34;/myapp/study/hosts/codelieche\u0026#34; }, \u0026#34;value\u0026#34;: {\u0026#34;S\u0026#34;: \u0026#34;{\\\u0026#34;domain\\\u0026#34;: \\\u0026#34;www.codelieche.com\\\u0026#34;, \\\u0026#34;ip\\\u0026#34;: \\\u0026#34;192.168.1.101\\\u0026#34;}\u0026#34; }}\u0026#39; \\\n    --endpoint-url http://localhost:8000\n    \naws dynamodb put-item --table-name xdhuxc \\\n    --item \u0026#39;{ \u0026#34;key\u0026#34;: { \u0026#34;S\u0026#34;: \u0026#34;/myapp/study/hosts/codelieche2\u0026#34; }, \u0026#34;value\u0026#34;: {\u0026#34;S\u0026#34;: \u0026#34;{\\\u0026#34;domain\\\u0026#34;: \\\u0026#34;www.codelieche.com\\\u0026#34;, \\\u0026#34;ip\\\u0026#34;: \\\u0026#34;192.168.1.101\\\u0026#34;}\u0026#34;}}\u0026#39; \\\n    --endpoint-url http://localhost:8000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、查看 dynamodb 数据库中所有数据\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-angular2html\" data-lang=\"angular2html\"\u003eaws dynamodb scan --table-name xdhuxc --endpoint-url http://localhost:8000\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"使用-golang-操作-dynamodb\"\u003e使用 golang 操作 DynamoDB\u003c/h3\u003e\n\u003cp\u003e可以使用 AWS 提供的 golang SDK 来操作 DynamoDB，实现在我们的程序内部对 DynamoDB 的调用。\u003c/p\u003e\n\u003cp\u003e注意，执行批量操作时，有数据量限制，每次只能增删 25 条数据，多余的将会报错（BatchLimit = 25）。\u003c/p\u003e\n\u003cp\u003e1、创建 dynamodb 客户端，对 DynamoDB 的操作都要使用该客户端来进行。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc NewDynamoDBClient(region string, endpoint string, disableSSL bool) (*dynamodb.DynamoDB, error) {\n\tif region == \u0026#34;\u0026#34; {\n\t\tsess, err := session.NewSession()\n\t\tif err != nil {\n\t\t\treturn nil, err\n\t\t}\n\t\tmetadata := ec2metadata.New(sess)\n\t\tec2Region, err := metadata.Region()\n\t\tif err != nil {\n\t\t\treturn nil, fmt.Errorf(\u0026#34;aws DynamoDB requires a region\u0026#34;)\n\t\t}\n\t\tregion = ec2Region\n\t}\n\tvar c *aws.Config\n\t// 使用环境变量中的 AccessKey 和 SecretKey\n\taccessKey := os.Getenv(\u0026#34;AWS_ACCESS_KEY_ID\u0026#34;)\n\tsecretKey := os.Getenv(\u0026#34;AWS_SECRET_ACCESS_KEY\u0026#34;)\n\tif accessKey != \u0026#34;\u0026#34; \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e secretKey != \u0026#34;\u0026#34; {\n\t\tcreds := credentials.NewStaticCredentials(accessKey, secretKey, \u0026#34;\u0026#34;)\n\t\tc = \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eaws.Config{\n\t\t\tRegion:      aws.String(region),\n\t\t\tCredentials: creds,\n\t\t\tEndpoint:    aws.String(endpoint),\n\t\t\tDisableSSL:  aws.Bool(disableSSL),\n\t\t}\n\t} else if accessKey != \u0026#34;\u0026#34; \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e secretKey != \u0026#34;\u0026#34; { // 使用配置文件中的 AccessKey 和 SecretKey\n\t\tcreds := credentials.NewStaticCredentials(accessKey, secretKey, \u0026#34;\u0026#34;)\n\t\tc = \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eaws.Config{\n\t\t\tRegion:      aws.String(region),\n\t\t\tCredentials: creds,\n\t\t\tEndpoint:    aws.String(endpoint),\n\t\t\tDisableSSL:  aws.Bool(disableSSL),\n\t\t}\n\t} else {\n\t\tc = \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eaws.Config{ // 使用 ~/.aws/credentials 文件中的 AccessKey 和 SecretKey 。\n\t\t\tRegion:     aws.String(region),\n\t\t\tEndpoint:   aws.String(endpoint),\n\t\t\tDisableSSL: aws.Bool(disableSSL),\n\t\t}\n\t}\n\n\tsess, err := session.NewSession(c)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\tdb := dynamodb.New(sess)\n\n\treturn db, nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、创建表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc CreateTable(ddb *dynamodb.DynamoDB, tableName string) error {\n\titemInput := \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.CreateTableInput{\n\t\tAttributeDefinitions: []*dynamodb.AttributeDefinition{\n\t\t\t{\n\t\t\t\tAttributeName: aws.String(\u0026#34;key\u0026#34;),\n\t\t\t\tAttributeType: aws.String(\u0026#34;S\u0026#34;),\n\t\t\t},\n\t\t},\n\t\tKeySchema: []*dynamodb.KeySchemaElement{\n\t\t\t{\n\t\t\t\tAttributeName: aws.String(\u0026#34;key\u0026#34;),\n\t\t\t\tKeyType:       aws.String(\u0026#34;HASH\u0026#34;),\n\t\t\t},\n\t\t},\n\t\tProvisionedThroughput: \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.ProvisionedThroughput{\n\t\t\tReadCapacityUnits:  aws.Int64(10),\n\t\t\tWriteCapacityUnits: aws.Int64(10),\n\t\t},\n\t\tTableName: aws.String(tableName),\n\t}\n\t_, err := ddb.CreateTable(itemInput)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\treturn nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、向 dynamodb 表中插入键值对\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc insert2DynamoDB(ddb *dynamodb.DynamoDB, tableName string, key string, value string) error {\n \titemInput := \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.PutItemInput{\n \t\tTableName: aws.String(tableName),\n \t\tItem: map[string]*dynamodb.AttributeValue{\n \t\t\t\u0026#34;key\u0026#34;: {                 // 注意，建表时键名起为 key。\n \t\t\t\tS: aws.String(key),\n \t\t\t},\n \t\t\t\u0026#34;value\u0026#34;: {\n \t\t\t\tS: aws.String(value),\n         \t\t\t},\n \t\t},\n \t}\n\n \tif _, err := ddb.PutItem(itemInput); err != nil {\n \t\treturn err\n \t}\n \treturn nil\n }\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、向 dynamodb 表中批量插入键值数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc batchWrite2DynamoDB(ddb *dynamodb.DynamoDB, tableName string, data map[string]string) error {\n\trequestItems := make(map[string][]*dynamodb.WriteRequest)\n\tlength := len(data)\n\tvar writeRequests []*dynamodb.WriteRequest\n\tcount := 0\n\twriteRequests = []*dynamodb.WriteRequest{}\n\tfor key, value := range data {// 键值数据\n\t\tvar writeRequest *dynamodb.WriteRequest\n\t\twriteRequest = \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.WriteRequest{\n\t\t\tPutRequest: \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.PutRequest{\n\t\t\t\tItem: map[string]*dynamodb.AttributeValue{\n\t\t\t\t\t\u0026#34;key\u0026#34;: {\n\t\t\t\t\t\tS: aws.String(key),\n\t\t\t\t\t},\n\t\t\t\t\t\u0026#34;value\u0026#34;: {\n\t\t\t\t\t\tS: aws.String(value),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t}\n\t\twriteRequests = append(writeRequests, writeRequest)\n\t\tcount = count + 1\n\n\t\tif (count % utils.BatchLimit == 0) || (count \u0026gt;= length) {\n\t\t\trequestItems[tableName] = writeRequests\n\t\t\tbatchInput := \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.BatchWriteItemInput{\n\t\t\t\tRequestItems: requestItems,\n\t\t\t}\n\n\t\t\tif _, err := ddb.BatchWriteItem(batchInput); err != nil {\n\t\t\t\treturn err\n\t\t\t}\n\t\t\twriteRequests = []*dynamodb.WriteRequest{}\n\t\t}\n\t}\n\n\treturn nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、批量删除数据\n此处是通过批量删除的方式删除了全部数据，但是保留了表结构，之所以没有采用删除表的操作，是因为线上环境，权限所限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc BatchDeleteItems(ddb *dynamodb.DynamoDB, tableName string) error {\n\terrc := make(chan error, 1)\n\twg := sync.WaitGroup{}\n\n\tscannedData, err := ddb.Scan(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.ScanInput{TableName: aws.String(tableName)})\n\tif err != nil {\n\t\treturn err\n\t}\n\n\tlength := len(scannedData.Items)\n\twg.Add(int(math.Ceil((float64(length)) / float64(utils.BatchLimit))))\n\n\treq := []*dynamodb.WriteRequest{}\n\tfor i, a := range scannedData.Items {\n\t\treq = append(req, \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.WriteRequest{\n\t\t\tDeleteRequest: \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.DeleteRequest{\n\t\t\t\tKey: map[string]*dynamodb.AttributeValue{\n\t\t\t\t\t\u0026#34;key\u0026#34;: a[\u0026#34;key\u0026#34;],\n\t\t\t\t},\n\t\t\t},\n\t\t})\n\t\tif (i+1) % utils.BatchLimit == 0 || i \u0026gt;= int(*scannedData.Count)-1 {\n\t\t\tgo func(reqChunk []*dynamodb.WriteRequest) {\n\t\t\t\tdefer wg.Done()\n\t\t\t\t_, err := t.DdbClient.BatchWriteItem(\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.BatchWriteItemInput{\n\t\t\t\t\tRequestItems: map[string][]*dynamodb.WriteRequest{\n\t\t\t\t\t\tt.TableName: reqChunk,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tif err != nil {\n\t\t\t\t\terrc \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e-\u003c/span\u003e \u003cspan class=\"na\"\u003eerr\u003c/span\u003e\n\t\t\t\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\t\t\t\u003cspan class=\"err\"\u003e}(\u003c/span\u003e\u003cspan class=\"na\"\u003ereq\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n\t\t\t\u003cspan class=\"na\"\u003ereq \u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e[]*dynamodb.WriteRequest{}\u003c/span\u003e\n\t\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003ego\u003c/span\u003e \u003cspan class=\"na\"\u003efunc\u003c/span\u003e\u003cspan class=\"err\"\u003e()\u003c/span\u003e \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003ewg\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eWait\u003c/span\u003e\u003cspan class=\"err\"\u003e()\u003c/span\u003e\n\t\t\u003cspan class=\"na\"\u003eclose\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003eerrc\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n\t\u003cspan class=\"err\"\u003e}()\u003c/span\u003e\n\t\u003cspan class=\"na\"\u003ereturn\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"na\"\u003e-errc\u003c/span\u003e\n\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、删除数据表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc DeleteTable(ddb *dynamodb.DynamoDB, tableName string) error {\n\titemInput := \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003edynamodb.DeleteTableInput{\n\t\tTableName: aws.String(tableName),\n\t}\n\n\tif _, err := ddb.DeleteTable(itemInput); err != nil {\n\t\treturn err\n\t}\n\treturn nil\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://hub.docker.com/r/amazon/dynamodb-local\"\u003ehttps://hub.docker.com/r/amazon/dynamodb-local\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.aws.amazon.com/zh_cn/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html\"\u003ehttps://docs.aws.amazon.com/zh_cn/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/\"\u003ehttps://docs.aws.amazon.com/sdk-for-go/api/service/dynamodb/\u003c/a\u003e\u003c/p\u003e","date":1559433600,"description":"","fuzzywordcount":1400,"kind":"page","lang":"zh","lastmod":1559433600,"objectID":"eb06c81bba724024ac5ff746cb230c2f","publishdate":1559433600,"relpermalink":"/posts/tools/tools-aws-dynamodb/","section":"posts","summary":"\u003cp\u003e本篇博客记录下使用 AWS DynamoDB 过程中用到的一些知识和技术点，以备后需。\u003c/p\u003e","tags":["AWS"],"title":"AWS DynamoDB 简单使用","url":"https://xdhuxc.github.io/posts/tools/tools-aws-dynamodb/","wordcount":1384},{"categories":"posts","content":"\u003cp\u003e本部分内容记录下 golang 中的单元测试的简单用法。\u003c/p\u003e\n\u003ch3 id=\"单元测试\"\u003e单元测试\u003c/h3\u003e\n\u003cp\u003e单元测试的重点在于测试代码的逻辑、场景等，以便尽可能地测试全面，保证代码质量。\u003c/p\u003e\n\u003ch3 id=\"代码示例\"\u003e代码示例\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e编写简单的代码说明下单元测试的基本使用方法\n编写主程序文件 test/main.go\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport \u0026#34;fmt\u0026#34;\n\nfunc main() {\n\tsum := Add(10, 20)\n\tfmt.Println(sum)\n}\n\nfunc Add(x int, y int) int {\n\treturn x + y\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e编写单元测试文件 test/main_test.go\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage main\n\nimport \u0026#34;testing\u0026#34;\n\nfunc TestAdd(t *testing.T) {\n\tsum := Add(10, 20)\n\tif sum == 30 {\n\t\tt.Log(\u0026#34;ok\u0026#34;)\n\t} else {\n\t\tt.Error(\u0026#34;error\u0026#34;)\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e运行测试命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:test wanghuan$ pwd\n/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/xgoland/test\nwanghuans-MacBook-Pro:test wanghuan$ go test -v\n=== RUN   TestAdd\n--- PASS: TestAdd (0.00s)\n    main_test.go:8: ok\nPASS\nok      github.com/xdhuxc/xgoland/test  0.005s\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"golang-单元测试使用规则\"\u003eGolang 单元测试使用规则\u003c/h3\u003e\n\u003cp\u003e1、含有单元测试代码的 go 文件必须以 \u003ccode\u003e_test.go\u003c/code\u003e 结尾，比如测试 \u003ccode\u003emain.go\u003c/code\u003e 的单元测试文件命名为 \u003ccode\u003emain_test.go\u003c/code\u003e ，Go 语言测试工具只认符合该规则的文件。\u003c/p\u003e\n\u003cp\u003e2、单元测试文件名 \u003ccode\u003e_test.go\u003c/code\u003e 前面的部分最好是被测试的方法所在 go 文件的文件名，比如 \u003ccode\u003emain_test.go\u003c/code\u003e，因为我们要测试的 Add 函数在 \u003ccode\u003emain.go\u003c/code\u003e 文件里\u003c/p\u003e\n\u003cp\u003e3、单元测试的函数名必须以 \u003ccode\u003eTest\u003c/code\u003e 开头，是可导出的公共函数。\u003c/p\u003e\n\u003cp\u003e4、测试函数的签名必须接收一个指向 testing.T 类型的指针，并且不能返回任何值。\u003c/p\u003e\n\u003cp\u003e5、函数名建议命名为 Test 加要测试的方法函数名，表示要测试该函数。\u003c/p\u003e\n\u003ch3 id=\"表组测试\"\u003e表组测试\u003c/h3\u003e\n\u003cp\u003e表组测试指的是一次测试中很多个输入输出场景的测试，例如\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efunc TestAdd(t *testing.T) {\n\tsum := Add(10, 20)\n\tif sum == 30 {\n\t\tt.Log(\u0026#34;ok\u0026#34;)\n\t} else {\n\t\tt.Error(\u0026#34;error\u0026#34;)\n\t}\n\n\tsum = Add(1024, 2048)\n\tif sum == 3072 {\n\t\tt.Log(\u0026#34;ok\u0026#34;)\n\t} else {\n\t\tt.Error(\u0026#34;error\u0026#34;)\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e我们为待测试函数 Add() 准备了两组测试数据 10、20 和 1024、2048，这样就可以测试多个输入场景下的测试效果了。\u003c/p\u003e\n\u003ch3 id=\"模型层数据测试\"\u003e模型层数据测试\u003c/h3\u003e\n\u003cp\u003e将各个测试函数共用的变量定义为全局变量，在 init() 函数中进行初始化，在各个测试函数中进行使用。\u003c/p\u003e\n\u003cp\u003e编写测试代码如下：user_test.go\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport (\n\t\u0026#34;fmt\u0026#34;\n\t\u0026#34;testing\u0026#34;\n\n\t\u0026#34;github.com/jinzhu/gorm\u0026#34;\n\t_ \u0026#34;github.com/jinzhu/gorm/dialects/mysql\u0026#34; # 如果没有导入此句，会报错。\n\n\t\u0026#34;gitlab.xdhuxc.com/golang-user/src/models\u0026#34;\n)\n\nvar db *gorm.DB\nvar us *userService\n\nfunc init() {\n    uri := fmt.Sprintf(\u0026#34;%s:%s@tcp(%s)/%s?charset=utf8\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eparseTime=True\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eloc=Local\u0026#34;,\n    \t\t\u0026#34;root\u0026#34;,\n    \t\t\u0026#34;abcd@#129\u0026#34;,\n    \t\t\u0026#34;127.0.0.9\u0026#34;,\n    \t\t\u0026#34;user\u0026#34;)\n    db, _ := gorm.Open(\u0026#34;mysql\u0026#34;, uri)\n    db.Debug()\n    us := newUserService(db)\n}\n\nfunc Test_UserService_List(t *testing.T) {\n\tcount, users, err := us.List(models.Page{ # List 为分页方法\n\t\tOffset:   0,\n\t\tPageSize: 30,\n\t})\n\tif err != nil {\n\t\tt.Error(err)\n\t} else {\n\t\tt.Log(count)\n\t\tfor _, user := range users {\n\t\t\tfmt.Println(user.String())\n\t\t}\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e跳转至 user_test.go 脚本目录下，执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego test --run Test_UserService_List\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/1adc69468b6f\"\u003ehttps://www.jianshu.com/p/1adc69468b6f\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.flysnow.org/2017/05/16/go-in-action-go-unit-test.html\"\u003ehttps://www.flysnow.org/2017/05/16/go-in-action-go-unit-test.html\u003c/a\u003e\u003c/p\u003e","date":1559433600,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1559433600,"objectID":"c3bae2672f14701f0b80ab04d4ab2d6b","publishdate":1559433600,"relpermalink":"/posts/programming/golang/golang-test/","section":"posts","summary":"\u003cp\u003e本部分内容记录下 golang 中的单元测试的简单用法。\u003c/p\u003e","tags":["Golang","UnitTest"],"title":"Golang 单元测试","url":"https://xdhuxc.github.io/posts/programming/golang/golang-test/","wordcount":803},{"categories":"posts","content":"\u003cp\u003eJavaScript 中的真值和假值经常用于判断语句和条件语句中，但是其真值和假值的确定和其他编程语言大不相同，如果对此理解有误，那么将会导致代码出现问题。\u003c/p\u003e\n\u003ch3 id=\"javascript-中的真值\"\u003eJavaScript 中的真值\u003c/h3\u003e\n\u003cp\u003e在 JavaScript 中，真值指的是在布尔值上下文中转换后的值为真的值。\u003c/p\u003e\n\u003cp\u003e所有值都是真值，除非它们被定义为假值，即被定义为\u003ccode\u003efalse\u003c/code\u003e，\u003ccode\u003e0\u003c/code\u003e，\u003ccode\u003e\u0026quot;\u0026quot;\u003c/code\u003e，\u003ccode\u003enull\u003c/code\u003e，\u003ccode\u003eundefined\u003c/code\u003e，\u003ccode\u003eNaN\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003eJavaScript 在布尔值上下文中使用强制类型转换。\u003c/p\u003e\n\u003cp\u003eJavaScript 中的真值示例如下（将被转换为 true，if后的代码段将被执行）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif (true)\nif ({})\nif ([])\nif (42)\nif (\u0026#34;foo\u0026#34;)\nif (new Date())\nif (-42)\nif (3.14)\nif (-3.14)\nif (Infinity)\nif (-Infinity)  \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"javascript-中的假值\"\u003eJavaScript 中的假值\u003c/h3\u003e\n\u003cp\u003e在 JavaScript 中，假值是在布尔值上下文中已认定可转换为假的值。\u003c/p\u003e\n\u003cp\u003eJavaScript 在需要用到布尔类型值得上下文中使用强制类型转换将值转换为布尔值，比如在条件语句或者循环语句中。\u003c/p\u003e\n\u003cp\u003eJavaScript 中的假值示例如下（通过 if 代码段将 falsy 值转换为 false）：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif (false)\nif (null)\nif (undefined)\nif (0)\nif (NaN)\nif (\u0026#39;\u0026#39;)\nif (\u0026#34;\u0026#34;)\nif (document.all)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003edocument.all 在过去被用于浏览器检测，是 HTML 规范在此定义了故意与 ECMAScript 标准相违背的，以保持与历史代码得兼容性。\u003c/p\u003e\n\u003cp\u003edocument.all 虽然是一个对象，但其转换为布尔值后是 false。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Glossary/Truthy\"\u003ehttps://developer.mozilla.org/zh-CN/docs/Glossary/Truthy\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Glossary/Falsy\"\u003ehttps://developer.mozilla.org/zh-CN/docs/Glossary/Falsy\u003c/a\u003e\u003c/p\u003e","date":1559433600,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1559433600,"objectID":"0893383dfe0f4edd8b9223b2bf3e6f5d","publishdate":1559433600,"relpermalink":"/posts/programming/javascript/javascript-true-false/","section":"posts","summary":"\u003cp\u003eJavaScript 中的真值和假值经常用于判断语句和条件语句中，但是其真值和假值的确定和其他编程语言大不相同，如果对此理解有误，那么将会导致代码出现问题。\u003c/p\u003e","tags":["JavaScript"],"title":"JavaScript 中的真值和假值问题","url":"https://xdhuxc.github.io/posts/programming/javascript/javascript-true-false/","wordcount":457},{"categories":"posts","content":"\u003cp\u003e使用 vue 和 element-ui 开发的前端工程，\u0008进行资源创建时，需要在前端页面对表单进行校验，特此记录，以备后需。\u003c/p\u003e\n\u003ch3 id=\"普通输入框的校验\"\u003e普通输入框的校验\u003c/h3\u003e\n\u003cp\u003e普通输入框的校验，可以直接使用默认的校验器进行校验，示例如下：\u003c/p\u003e\n\u003cp\u003e1）对数据模型添加 rules 规则\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e\u0026lt;template\u0026gt;\n  \u0026lt;div class=\u0026quot;app-container\u0026quot;\u0026gt;\n    \u0026lt;el-dialog\n      :visible.sync=\u0026quot;dialogFormVisible\u0026quot;\n      :title=\u0026quot;$t('business.businessApplicationMonitor')\u0026quot;\n      :show-close=\u0026quot;false\u0026quot;\n      :close-on-click-modal=\u0026quot;false\u0026quot;\n      :close-on-press-escape=\u0026quot;false\u0026quot;\n      width=\u0026quot;620px\u0026quot;\u0026gt;\n      \u0026lt;el-form ref=\u0026quot;businessForm\u0026quot; :model=\u0026quot;temp\u0026quot; :rules=\u0026quot;businessVerifyRules\u0026quot; label-width=\u0026quot;120px\u0026quot; label-position=\u0026quot;left\u0026quot;\u0026gt;\n          \u0026lt;el-form-item :label=\u0026quot;$t('business.regionName')\u0026quot; prop=\u0026quot;region_name\u0026quot;\u0026gt;\n            \u0026lt;el-select v-model=\u0026quot;temp.region_name\u0026quot; :placeholder=\u0026quot;$t('business.placeholder')\u0026quot;\u0026gt;\n              \u0026lt;el-option v-for=\u0026quot;region in regions\u0026quot; :key=\u0026quot;region.value\u0026quot; :label=\u0026quot;region.label\u0026quot; :value=\u0026quot;region.value\u0026quot;\u0026gt;\u0026lt;/el-option\u0026gt;\n            \u0026lt;/el-select\u0026gt;\n          \u0026lt;/el-form-item\u0026gt;\n          \u0026lt;el-form-item :label=\u0026quot;$t('business.name')\u0026quot; prop=\u0026quot;name\u0026quot;\u0026gt;\n            \u0026lt;el-input v-model=\u0026quot;temp.name\u0026quot; :clearable=\u0026quot;true\u0026quot; style=\u0026quot;width: 400px\u0026quot;/\u0026gt;\n          \u0026lt;/el-form-item\u0026gt;\n      \u0026lt;/el-form\u0026gt;\n      \u0026lt;div slot=\u0026quot;footer\u0026quot; class=\u0026quot;dialog-footer\u0026quot;\u0026gt;\n          \u0026lt;el-button @click=\u0026quot;onCancel\u0026quot;\u0026gt; {{ $t('business.cancel') }} \u0026lt;/el-button\u0026gt;\n          \u0026lt;el-button type=\u0026quot;primary\u0026quot; @click=\u0026quot;onSubmit\u0026quot;\u0026gt; {{ $t('business.confirm') }} \u0026lt;/el-button\u0026gt;\n      \u0026lt;/div\u0026gt;\n    \u0026lt;/el-dialog\u0026gt;\n  \u0026lt;/div\u0026gt;\n\u0026lt;/template\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ccode\u003e:rules=\u0026quot;businessVerifyRules\u0026quot;\u003c/code\u003e 为该表单添加验证规则，每一个表单项的 prop 属性将作为表单校验的属性名称，需要指定。\u003c/p\u003e\n\u003cp\u003e2）编写 rules 规则\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eexport default {\n  name: 'Business',\n  data() {\n    return {\n      businessVerifyRules: {\n        region_name: [{\n          required: true, trigger: ['blur', 'change'], message: this.$t('confirm.nullWarning')\n        }],\n        name: [{\n          required: true, trigger: 'blur', message: this.$t('confirm.nullWarning')\n        }]\n      }\n    };\n  }\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在数据部分编写校验规则，name，port等表示被校验属性，需要和表单项中的 prop 属性指定的属性名称保持一致，否则无法完成校验功能。\u003c/p\u003e\n\u003cp\u003e其内置的校验器类型还包括：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003estring：必须是字符串类型，这也是默认的类型。\u003c/li\u003e\n\u003cli\u003enumber：必须是数值类型。\u003c/li\u003e\n\u003cli\u003eboolean：必须是布尔类型。\u003c/li\u003e\n\u003cli\u003emethod：必须是函数类型。\u003c/li\u003e\n\u003cli\u003eregexp: 必须是 RegExp 的实例或者一个可以无异常地创建 RegExp 实例的字符串。\u003c/li\u003e\n\u003cli\u003einteger：必须是数值类型和整数。\u003c/li\u003e\n\u003cli\u003efloat：必须是数值类型和一个浮点数。\u003c/li\u003e\n\u003cli\u003earray：必须是由 Array.isArray 确定的数组。\u003c/li\u003e\n\u003cli\u003eobject：必须是一个对象类型，并且不是 Array.isArray。\u003c/li\u003e\n\u003cli\u003eenum：值必须存在于 enum 中。\u003c/li\u003e\n\u003cli\u003edate：值必须由 Date 确定有效。\u003c/li\u003e\n\u003cli\u003eurl：必须是一个 url 类型。\u003c/li\u003e\n\u003cli\u003ehex：必须是一个 hex 类型。\u003c/li\u003e\n\u003cli\u003eemail：必须是一个 email 类型。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"数值类型的校验\"\u003e数值类型的校验\u003c/h4\u003e\n\u003cp\u003e对于数值类型的校验，可以使用默认的 \u003ccode\u003enumber\u003c/code\u003e 类型校验，但是我们的数值在业务逻辑上有其特殊性，\u0008其实是个\u0008端口号，所以就有以下要求：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e用户必须输入数值，不能提交空字符串。\u003c/li\u003e\n\u003cli\u003e\u0008用户的输入必须是可解析为数值的字符串，不能是其他的字符串。\u003c/li\u003e\n\u003cli\u003e用户输入的数值必须在 1024~65535 之间，不能超出这个范围。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e为了\u0008同时满足以上要求，我们可以编写自定义的校验函数，将校验逻辑写在校验函数中，校验通过则放行，不通过则返回明确的错误提示。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;app-container\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-dialog\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:visible\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esync\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;dialogFormVisible\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:title\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;$t(\u0026#39;business.businessApplicationMonitor\u0026#39;)\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:show-close\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:close-on-click-modal\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:close-on-press-escape\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ewidth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;620px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e \u003cspan class=\"na\"\u003eref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;businessForm\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;temp\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:rules\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;businessVerifyRules\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003elabel-width\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;80px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003e:label\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;$t(\u0026#39;business.port\u0026#39;)\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eprop\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;port\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;temp.port\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 400px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eslot\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;footer\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;dialog-footer\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eonCancel\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e {{ $t(\u0026#39;business.cancel\u0026#39;) }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;primary\u0026#34;\u003c/span\u003e \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eonSubmit\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e {{ $t(\u0026#39;business.confirm\u0026#39;) }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-dialog\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Business\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003evalidatePort\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003erule\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$refs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;businessForm\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003eclearValidate\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003eport\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eparseInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"c1\"\u003e// 判断是否为数字\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eisNaN\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;business.validateNumber\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eport\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1024\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"nx\"\u003eport\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e65535\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;business.validateRange\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;business.nullWarning\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ebusinesses\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003etemp\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003egid\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eprome_id\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eport\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e10106\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ebusinessVerifyRules\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eport\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[{\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003erequired\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;blur\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emessage\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;confirm.nullWarning\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003evalidator\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003evalidatePort\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;blur\u0026#39;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}]\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 businessVerifyRules 中添加自定义校验器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebusinessVerifyRules: {\n    port: [{\n      validator: validatePort, trigger: \u0026#39;blur\u0026#39;\n    }]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e通过 validator 字段指定自定义校验函数 validatePort，触发条件为：blur。\u003c/p\u003e\n\u003ch4 id=\"复杂数据结构的校验\"\u003e复杂数据结构的校验\u003c/h4\u003e\n\u003cp\u003e对于复杂数据结构的校验，采取的方式是编写自定义的校验函数，将校验逻辑封装到校验函数中，校验通过则放行，不通过则返回错误提示，但是需要注意的是，每次执行校验函数时，需要先清除上次的校验结果，否则校验效果就比较滑稽了。\u003c/p\u003e\n\u003cp\u003e比如我们的项目中，需要校验键值对，采用了如下的方式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e89\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e90\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;app-container\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-dialog\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:visible\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esync\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;dialogFormVisible\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:title\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;$t(\u0026#39;business.businessApplicationMonitor\u0026#39;)\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:show-close\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:close-on-click-modal\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003e:close-on-press-escape\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ewidth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;620px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e \u003cspan class=\"na\"\u003eref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;businessForm\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;temp\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:rules\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;businessVerifyRules\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003elabel-width\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;80px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e \u003cspan class=\"na\"\u003e:label\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;$t(\u0026#39;business.label\u0026#39;)\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eprop\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;label\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 400px\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;hidden\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\n          \u003cspan class=\"na\"\u003ev-for\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;(label, index) in temp.labels\u0026#34;\u003c/span\u003e\n          \u003cspan class=\"na\"\u003e:key\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;\u0026#39;label\u0026#39; + index\u0026#34;\u003c/span\u003e\n          \u003cspan class=\"na\"\u003eprop\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;labels\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;label.key\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;label.value\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:clearable\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;width: 199px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-input\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;temp.labels.length !== 1\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;danger\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-delete\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n              \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;removeLabel(index)\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ev-if\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;index === temp.labels.length - 1\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;primary\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mini\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003eicon\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;el-icon-plus\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"na\"\u003ecircle\u003c/span\u003e\n              \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003eprevent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;addLabel\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form-item\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-form\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eslot\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;footer\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;dialog-footer\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eonCancel\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e {{ $t(\u0026#39;business.cancel\u0026#39;) }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;primary\u0026#34;\u003c/span\u003e \u003cspan class=\"ni\"\u003e@click\u003c/span\u003e\u003cspan class=\"err\"\u003e=\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eonSubmit\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e {{ $t(\u0026#39;business.confirm\u0026#39;) }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-button\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-dialog\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Business\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"kr\"\u003econst\u003c/span\u003e \u003cspan class=\"nx\"\u003evalidateLabels\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003erule\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$refs\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;businessForm\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003eclearValidate\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003elet\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003ekey\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e].\u003c/span\u003e\u003cspan class=\"nx\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e===\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;business.validateLabel\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;business.nullWarning\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecallback\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nb\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$t\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;business.nullWarning\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)));\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ebusinesses\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003etemp\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003egid\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eprome_id\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[],\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eport\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e10106\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003elabel\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ekey\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003evalue\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ebusinessVerifyRules\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elabels\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[{\u003c/span\u003e\n          \u003cspan class=\"nx\"\u003evalidator\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003evalidateLabels\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003etrigger\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;blur\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;change\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e}]\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e弹出框中是一个表单，表单中有个标签项，每项均是键值对，需要每项同时都配置键值对，如果没有同时配置，需要在页面给出提示，可以在并列显示的标签后面点击按钮删除当前标签。我们将校验逻辑写在自定义校验函数中，然后加入到校验规则里，就可以起作用了。\u003c/p\u003e\n\u003cp\u003e需要注意的是，每次校验前，需要使用表单的 clearValidate() 函数清理上次的校验结果，如果没有这一步，表单校验的结果就会显得错乱。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/yiminghe/async-validator\"\u003ehttps://github.com/yiminghe/async-validator\u003c/a\u003e\u003c/p\u003e","date":1559433600,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1559433600,"objectID":"449cb60edd129466ce20ef5c0f3ecd27","publishdate":1559433600,"relpermalink":"/posts/vue/vue-element-ui-verify/","section":"posts","summary":"\u003cp\u003e使用 vue 和 element-ui 开发的前端工程，\u0008进行资源创建时，需要在前端页面对表单进行校验，特此记录，以备后需。\u003c/p\u003e","tags":["Vue","表单校验"],"title":"Vue + Element-UI 表单校验功能的总结","url":"https://xdhuxc.github.io/posts/vue/vue-element-ui-verify/","wordcount":1654},{"categories":"posts","content":"\u003cp\u003e最近使用 axios 和 go-restful 分别作为前后端 API 开发时，出了个奇怪的 406 问题，记录下来，以备后需。\u003c/p\u003e\n\u003cp\u003e我们的项目前端使用 vue 和 element-ui 搭建，后台使用 go-restful 来编写 API。以前开发基本顺利，没有出现过奇怪的问题，但是最近突然出现了个莫名其妙的 406 问题，查阅文档，各种尝试，始终没有找到优雅的解决方法，导致开发进度被推迟了两天。目前，该问题已经解决，特此记录。\u003c/p\u003e\n\u003cp\u003e前端使用 axios 编写的接口如下：（src/api/kubernetes/deployment.js）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport request from \u0026#39;@/utils/kubernetesRequest\u0026#39;;\nexport function restartApp(cid, namespace, appName) {\n  return request({\n    url: \u0026#39;/apps/\u0026#39; + namespace + \u0026#39;/\u0026#39; + appName + \u0026#39;/restart\u0026#39;,\n    method: \u0026#39;PUT\u0026#39;,\n    headers: {\n      cid: cid\n    }\n  });\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e其中，axios 实例的定义为：（src/utils/kubernetesRequest.js）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport axios from \u0026#39;axios\u0026#39;;\nimport store from \u0026#39;../store/index\u0026#39;;\nimport Clear from \u0026#39;../store/modules/user\u0026#39;;\nimport { getToken } from \u0026#39;@/utils/auth\u0026#39;;\nimport router from \u0026#39;../router\u0026#39;;\nimport lang from \u0026#39;@/lang\u0026#39;;\n\n// create axios instance\nconst service = axios.create({\n  baseURL: process.env.BASE_API + \u0026#39;/kubernetes\u0026#39;,\n  timeout: 5000, // the timeout of request\n  headers: {\n    \u0026#39;Content-Type\u0026#39;: \u0026#39;application/json\u0026#39;,\n    \u0026#39;Accept\u0026#39;: \u0026#39;application/json\u0026#39;,\n  }\n});\n\n// the request interceptor\nservice.interceptors.request.use(\n  config =\u0026gt; {\n    const token = getToken();\n    if (token) {\n      config.headers[\u0026#39;Authorization\u0026#39;] = \u0026#39;Bearer \u0026#39; + token;\n    } else { // if token is not existed, go to the login page\n      store.dispatch(\u0026#39;Clear\u0026#39;).then(response =\u0026gt; {\n        router.replace({\n          path: \u0026#39;/login\u0026#39;,\n        });\n      }).catch(error =\u0026gt; {\n        console.log(error);\n      });\n    }\n    return config;\n  },\n  error =\u0026gt; {\n    console.log(error);\n    Promise.reject(error);\n  }\n);\n// the response interceptor\nservice.interceptors.response.use(\n  response =\u0026gt; {\n    return response;\n  },error =\u0026gt; {\n    if (error.response) {// in some cases，the error.response is undefined\n      switch (error.response.status) {\n      case 401:\n        store.dispatch(\u0026#39;Clear\u0026#39;).then(response =\u0026gt; {\n          router.replace({\n            path: \u0026#39;/login\u0026#39;,\n          });\n        });\n        break;\n      case 403:\n        error.message = lang.t(\u0026#39;notification.noOperatePrivilege\u0026#39;);\n        return Promise.reject(error);\n      }\n    } else {\n      return Promise.reject(error);\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport default service;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后在组件（src/views/kubernetes/application/deployment/index.vue）中调用该方法\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e\u0026lt;script\u0026gt;\nimport { restartApp } from '@/api/kubernetes/deployment';\nimport { setCurrentCluster, setCurrentApplication } from '@/utils/auth';\nimport { handleScaleError } from '@/utils/utils';\nimport { mapGetters } from 'vuex';\n\nexport default {\n  name: 'Deployment',\n  data() {\n    return {\n      apps: [],\n      currentApp: '',\n      temp: {\n        app: {},\n        revision: '',\n      },    \n    };\n  },\n  computed: {\n    ...mapGetters([\n      'currentGroup',\n      'currentCluster',\n      'currentApplication'\n    ])\n  },\n  created() {\n    \n  },\n  methods: {\n    handleRestart(index, app) {\n      this.$confirm(this.$t('confirm.restart'), this.$t('confirm.title'), {\n        confirmButtonText: this.$t('confirm.confirm'),\n        cancelButtonText: this.$t('confirm.cancel'),\n        type: 'warning'\n      }).then(() =\u0026gt; {\n        restartApp(this.currentCluster.id, app.namespace, app.name).then(response =\u0026gt; {\n          if (response.status === 201) {\n            this.$message({\n              type: 'success',\n              message: this.$t('notification.restartSuccessMessage'),\n              duration: 2000,\n              offset: 40\n            });\n          }\n          this.getAppsData();\n        }).catch(error =\u0026gt; {\n          if (error.response) {\n            if (error.response.status === 403) {\n              this.$message({\n                type: 'error',\n                message: error.message,\n                duration: 2000,\n                offset: 40\n              });\n            } else {\n              this.$message({\n                message: this.$t('notification.restartFailedMessage'),\n                type: 'error',\n                duration: 2000,\n                offset: 40\n              });\n            }\n          } else {\n            this.$message({\n              type: 'error',\n              message: error.message,\n              duration: 2000,\n              offset: 40\n            });\n          }\n        });\n      }).catch(() =\u0026gt; {\n        this.$message({\n          type: 'info',\n          message: this.$t('confirm.cancelRestart'),\n          duration: 2000,\n          offset: 40\n        });\n      });\n    }\n};\n\u0026lt;/script\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e点击重启按钮时，传入当前行的值作为 app 的值，请求后台 API。\u003c/p\u003e\n\u003cp\u003e后台使用 go-restful 开发的 API，主要代码为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etype AppController struct {\n\t*BaseController\n}\n\nfunc newAppController(bc *BaseController) *AppController {\n\ttags := []string{\u0026#34;deployment\u0026#34;}\n\tac := \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003eAppController{}\n\tac.BaseController = bc\n\n    ws.Route(ac.ws.PUT(\u0026#34;/apps/{namespace}/{app}/restart\u0026#34;).To(AppRestart).\n        Doc(\u0026#34;app restart\u0026#34;).\n        Param(ac.ws.PathParameter(\u0026#34;namespace\u0026#34;, \u0026#34;namespace name\u0026#34;).DataType(\u0026#34;string\u0026#34;).Required(true)).\n        Param(ac.ws.PathParameter(\u0026#34;app\u0026#34;, \u0026#34;app name\u0026#34;).DataType(\u0026#34;string\u0026#34;).Required(true)).\n        Param(ac.ws.HeaderParameter(\u0026#34;cid\u0026#34;, \u0026#34;cluster id\u0026#34;).DataType(\u0026#34;integer\u0026#34;).Required(true)).\n        Metadata(restfulspec.KeyOpenAPITags, tags).\n        Returns(http.StatusOK, \u0026#34;OK\u0026#34;, nil).\n        Returns(http.StatusBadRequest, \u0026#34;ERROR\u0026#34;, nil))  \n\n\treturn ac\n}\n    \nfunc AppRestart(req *restful.Request, resp *restful.Response) {\n\tclient, ok := getClusterKClient(req)\n\tif !ok {\n\t\tutil.WriteResonse(resp, util.InvalidCluster, fmt.Errorf(\u0026#34;cannot get cluster client\u0026#34;))\n\t\treturn\n\t}\n\n\tnamespace := req.PathParameter(\u0026#34;namespace\u0026#34;)\n\tif namespace == \u0026#34;\u0026#34; {\n\t\tutil.WriteResonse(resp, util.InvalidParams, fmt.Errorf(\u0026#34;invalid ns name error\u0026#34;))\n\t\treturn\n\t}\n\tnamespace = strings.ToLower(namespace)\n\n\tappName := req.PathParameter(\u0026#34;app\u0026#34;)\n\tif appName == \u0026#34;\u0026#34; {\n\t\tutil.WriteResonse(resp, util.InvalidParams, fmt.Errorf(\u0026#34;invalid app name error\u0026#34;))\n\t\treturn\n\t}\n\n\terr = bs.AppService.AppRestart(appName, namespace, client)\n\tif err != nil {\n\t\tutil.WriteResonse(resp, util.RestartAppError, err)\n\t\treturn\n\t}\n\n\tresp.WriteHeader(http.StatusCreated)\n}      \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 PUT 方法向后台 API 发送请求后，返回的结果为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eGeneral\nRequest URL: http://192.168.1.227:8000/kubernetes/apps/cas//restart\nRequest Method: PUT\nStatus Code: 406 Not Acceptable\nRemote Address: 159.138.87.227:8000\nReferrer Policy: no-referrer-when-downgrade\n\nResponse Headers\naccess-control-allow-origin: http://0.0.0.0:9528\ncontent-length: 19\ncontent-type: text/plain; charset=utf-8\ndate: Wed, 29 May 2019 02:31:13 GMT\nserver: envoy\nx-envoy-upstream-service-time: 0\n\nRequest Headers\nAccept: application/json\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NTkxMjMxNTUsInVzZXIiOiJ3YW5naHVhbnxbMTUgMTddfGFkbWluIn0.VsRlRATa8QYJS8TrF3RrrAI-ZMEdZxIvwszXyH3G880\ncid: 5\nOrigin: http://0.0.0.0:9528\nReferer: http://0.0.0.0:9528/\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查询 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/406\"\u003eMDN\u003c/a\u003e 文档，对 406 解释如下：\u003c/p\u003e\n\u003cp\u003eHTTP 协议中的 406 Not Acceptable 状态码表示客户端错误，指代服务器端无法提供与  \u003ccode\u003eAccept-Charset\u003c/code\u003e 以及 \u003ccode\u003eAccept-Language\u003c/code\u003e 消息头指定的值相匹配的响应。\u003c/p\u003e\n\u003cp\u003e在实际应用中，这个错误状态码极少使用：不是给用户返回一个晦涩难懂（且难以更正）的错误状态码，而是将相关的消息头忽略，同时给用户提供一个看得见摸得着的页面。这种做法基于这样一个假设：即便是不能达到用户十分满意，也强于返回错误状态码。\u003c/p\u003e\n\u003cp\u003e如果服务器返回了这个错误状态码，那么消息体中应该包含所能提供的资源表现形式的列表，允许用户手动进行选择。\u003c/p\u003e\n\u003cp\u003e根据文档的提示，我检查了 axios 请求实例的 \u003ccode\u003eAccept-Charset\u003c/code\u003e 和 \u003ccode\u003eAccept-Language\u003c/code\u003e 消息头的设置。实际上，我并没有显式指定这两个请求头的值，那么在默认情况下，浏览器和服务器之间协商的结果应该是一致的，所以应该不是这两个请求头不一致导致的。\u003c/p\u003e\n\u003cp\u003e由于我们使用了 envoy 来做代理，我就搜索了 envoy 相关的资料，envoy 官方网站对 \u003ca href=\"https://developers.envoy.com/#response-codes\"\u003e响应状态码\u003c/a\u003e 的解释如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eCode\u003c/th\u003e\n\u003cth\u003eName\u003c/th\u003e\n\u003cth\u003eDescription\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e406\u003c/td\u003e\n\u003ctd\u003eNot Acceptable\u003c/td\u003e\n\u003ctd\u003eThe requested resource is only capable of generating content not acceptable according to the Accept headers sent in the request.\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e也就是说，请求的资源只能根据发送的请求头 Accept 生成不可接受的内容。根据此提示，我注意到 响应头中的 \u003ccode\u003eAccept\u003c/code\u003e 为 \u003ccode\u003etext/plain\u003c/code\u003e，而请求头中的 \u003ccode\u003eaccept\u003c/code\u003e 为 \u003ccode\u003eapplication/json\u003c/code\u003e，所以，应该是由 envoy 返回的 406 错误。\u003c/p\u003e\n\u003cp\u003e但是另外的代码使用 PUT 方法发送请求却没有这个问题，于是，我就尝试着改造了一下代码，最终发现，由于我的请求数据全部在请求头和路径参数中，所以请求体没有设置，当我把请求体设置上后，返回结果就正常了，虽然请求体的内容为空。改造后的前端 API 如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport request from \u0026#39;@/utils/kubernetesRequest\u0026#39;;\nexport function restartApp(cid, namespace, appName) {\n  return request({\n    url: \u0026#39;/apps/\u0026#39; + namespace + \u0026#39;/\u0026#39; + appName + \u0026#39;/restart\u0026#39;,\n    method: \u0026#39;PUT\u0026#39;,\n    headers: {\n      cid: cid\n    },\n    data: {}\n  });\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e整个请求和响应就正常了。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://developers.envoy.com/#response-codes\"\u003ehttps://developers.envoy.com/#response-codes\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/406\"\u003ehttps://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/406\u003c/a\u003e\u003c/p\u003e","date":1559347200,"description":"","fuzzywordcount":1800,"kind":"page","lang":"zh","lastmod":1559433600,"objectID":"8ea13160a28a354dccdcde0d66b232bf","publishdate":1559347200,"relpermalink":"/posts/programming/web/http-406-not-acceptable/","section":"posts","summary":"\u003cp\u003e最近使用 axios 和 go-restful 分别作为前后端 API 开发时，出了个奇怪的 406 问题，记录下来，以备后需。\u003c/p\u003e","tags":["HTTP","Web"],"title":"记一次 HTTP PUT/POST 请求 406 错误","url":"https://xdhuxc.github.io/posts/programming/web/http-406-not-acceptable/","wordcount":1764},{"categories":"posts","content":"\u003cp\u003e当我们需要在网页页面中输入不同编程语言代码并高亮显示时，可以使用 CodeMirror 来实现这种需求。\u003c/p\u003e\n\u003ch3 id=\"codemirror-简介\"\u003eCodeMirror 简介\u003c/h3\u003e\n\u003cp\u003eCodeMirror 是一个用于编辑文本框代码高亮的 JavaScript 插件，为各种编程语言实现关键字、函数、变量等代码高亮，丰富的 API 和可扩展功能以及多个主题样式、可以基本满足各种项目的需求。\u003c/p\u003e\n\u003cp\u003eCodeMirror 支持各种编程语言、标记语言的语法高亮，包括 C、C++、Java、PHP、JavaScript、Python、Go、Ruby、SQL等，以及 LaTex、wiki、Markdown等，同时也支持 JSON、YAML、TOML等配置文件常用格式。此外，CodeMirror 还支持代码自动补全、搜索、替换、HTML预览、显示行号、选择/搜索结果高亮等功能。\u003c/p\u003e\n\u003cp\u003eCodeMirror 目前已经被集成进各种应用程序中，例如 Adobe Brackets、Light Table等开发环境，经常被用于各种 SQL、JavaScript、JSON、YAML 等的在线编辑器的基础库来使用。\u003c/p\u003e\n\u003ch3 id=\"原生方式使用-codemirror\"\u003e原生方式使用 CodeMirror\u003c/h3\u003e\n\u003cp\u003e本部分内容介绍如何使用 CodeMirror 插件。\u003c/p\u003e\n\u003cp\u003e1、引入核心文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;lib/codemirror.js\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003elink\u003c/span\u003e \u003cspan class=\"na\"\u003erel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;stylesheet\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;lib/codemirror.css\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;mode/javascript/javascript.js\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ecodemirror.js 和 codemirror.css 是 CodeMirror 插件的核心文件，无论要高亮的代码是何种语言，都需要引入这两个文件。\u003c/p\u003e\n\u003cp\u003e引入 mode/javascript/javascript.js 用于支持对 JavaScript 的语法高亮。\u003c/p\u003e\n\u003cp\u003e2、创建编辑器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etextarea\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;code\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;code\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etextarea\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建 HTML 文本框元素，用于存放需要高亮显示的代码。\u003c/p\u003e\n\u003cp\u003e在 JavaScript 代码中\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eeditor\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eCodeMirror\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003efromTextArea\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;code\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 获取文本框元素\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elineNumbers\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003emode\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;text/x-yaml\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003egutters\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;CodeMirror-lint-markers\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003etheme\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;rubyblue\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e                             \u003cspan class=\"c1\"\u003e//设置选项参数\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用文本框元素和参数对象来创建 CodeMirror 对象，\u003c/p\u003e\n\u003cp\u003e选项参数含义说明如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003elineNumbers：为 true 时在左侧显示行号，为 false 时不显示行号。\u003c/li\u003e\n\u003cli\u003emode：显示模式，也就是需要高亮显示的语言的标示，例如 text/x-yaml 表示将高亮显示 YAML 语言的内容。\u003c/li\u003e\n\u003cli\u003egutters：用来添加额外的 gutter，值为 CSS 名称数组，每一项定义了用于绘制 gutter 背景的宽度。\u003c/li\u003e\n\u003cli\u003etheme：显示的主题，详情可参考：https://codemirror.net/demo/theme.html。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e3、获取及填充值\u003c/p\u003e\n\u003cp\u003e使用如下方法获取 CodeMirror 的值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eeditor.getValue() # 获取经过转义的数据\neditor.getTextArea().value # 获取未经过转义的数据\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下方法为 CodeMirror 赋值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eeditor.setValue(\u0026#34;Hello, World!\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、设置文本框尺寸及选项\u003c/p\u003e\n\u003cp\u003e可通过如下方法设置文本框尺寸\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eeditor.setSize(\u0026#34;600px\u0026#34;, \u0026#34;800px\u0026#34;);\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可在代码中通过如下方式设置 CodeMirror 属性\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eeditor.setOption(\u0026#34;readOnly\u0026#34;, true);\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"vue-中集成-codemirror\"\u003eVue 中集成 CodeMirror\u003c/h3\u003e\n\u003cp\u003e当我们使用 Vue 来做我们的前端项目时，可以使用基于 CodeMirror 的 vue-codemirror 来完成 Web 代码编辑器。\u003c/p\u003e\n\u003cp\u003e1、安装插件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 安装 codemirror 插件\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003enpm install codemirror\n\u003cspan class=\"gh\"\u003e# 安装 vue-codemirror 插件\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003enpm install vue-codemirror\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、挂载 VueCodeMirror，在 main.js 中加入如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport VueCodemirror from \u0026#39;vue-codemirror\u0026#39;;\nimport \u0026#39;codemirror/lib/codemirror.css\u0026#39;;\n\nVue.use(VueCodemirror);\n\nnew Vue({\n  el: \u0026#39;#app\u0026#39;,\n  router,\n  store,\n  i18n,\n  render: h =\u0026gt; h(App),\n});\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、在其他页面中使用该组件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-dialog\u003c/span\u003e\n        \u003cspan class=\"na\"\u003e:visible\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esync\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;dialogViewVisible\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"na\"\u003e:title\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;CodeMirror\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"na\"\u003e:show-close\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"na\"\u003e:close-on-click-modal\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"na\"\u003e:close-on-press-escape\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\n        \u003cspan class=\"na\"\u003ewidth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;620px\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ecodemirror\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;codeMirrorContent\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:options\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;cmOptions\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;json-editor\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ecodemirror\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eel-dialog\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nx\"\u003ecodemirror\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"nx\"\u003efrom\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;vue-codemirror\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;codemirror/addon/lint/lint.css\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;codemirror/lib/codemirror.css\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;codemirror/theme/rubyblue.css\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"nx\"\u003erequire\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;script-loader!jsonlint\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;codemirror/mode/javascript/javascript\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;codemirror/addon/lint/lint\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;codemirror/addon/lint/json-lint\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;CodeMirror\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ecodeMirrorContent\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003edialogViewVisible\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003ecmOptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elineNumbers\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003emode\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;text/x-yaml\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003egutters\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;CodeMirror-lint-markers\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003etheme\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;rubyblue\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elint\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e// 处理点击事件\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"nx\"\u003ehandleView\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eindex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eapp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecodeMirrorContent\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eapp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eyaml\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003edialogViewVisible\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emode 用来指定显示代码的格式，可以是JSON，YAML，SQL等，详情可参考：https://codemirror.net/mode/index.html。\u003c/li\u003e\n\u003cli\u003ecodeMirrorContent 是字符串格式的内容，如果后台传递过来的数据不是字符串格式，需要转换为字符串格式，否则会出错。\u003c/li\u003e\n\u003cli\u003etheme 是显示主题，可以显示不同的背景色，详细可参考：https://codemirror.net/demo/theme.html。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e选项参数含义说明如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003elineNumbers：为 true 时在左侧显示行号，为 false 时不显示行号。\u003c/li\u003e\n\u003cli\u003emode：显示模式，也就是需要高亮显示的语言的标示，例如 text/x-yaml 表示将高亮显示 YAML 语言的内容。\u003c/li\u003e\n\u003cli\u003egutters：用来添加额外的 gutter，值为 CSS 名称数组，每一项定义了用于绘制 gutter 背景的宽度。\u003c/li\u003e\n\u003cli\u003etheme：显示的主题，详情可参考：https://codemirror.net/demo/theme.html。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"常见问题及解决\"\u003e常见问题及解决\u003c/h3\u003e\n\u003cp\u003e1、页面中报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eError: Parse error on line 1:\n\n^\nExpecting \u0026#39;STRING\u0026#39;, \u0026#39;NUMBER\u0026#39;, \u0026#39;NULL\u0026#39;, \u0026#39;TRUE\u0026#39;, \u0026#39;FALSE\u0026#39;, \u0026#39;{\u0026#39;, \u0026#39;[\u0026#39;, got \u0026#39;EOF\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可能的一种情况是：\u003c/p\u003e\n\u003cp\u003e字符串内容为 YAML 格式，但是 mode 却为：\u003ccode\u003etext/x-json\u003c/code\u003e，将其改为：\u003ccode\u003etext/x-yaml\u003c/code\u003e 试下。\u003c/p\u003e\n\u003cp\u003e2、使用多个 CodeMirror 实例时，会发生数据不能及时更新，需要获取到焦点才会更新数据的情况，解决方法如下：\u003c/p\u003e\n\u003cp\u003e引入 refresh 插件，在处理函数中使用定时任务刷新 CodeMirror 组件，代码示例如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n   \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ecodemirror\u003c/span\u003e \u003cspan class=\"na\"\u003eref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;jenkinsFileCode\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ev-model\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;content\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003e:options\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fileOptions\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;json-editor\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ecodemirror\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kr\"\u003eimport\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;codemirror/addon/display/autorefresh.js\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"kr\"\u003eexport\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Pipeline\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003econtent\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"nx\"\u003efileOptions\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elineNumbers\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003emode\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;text/x-yaml\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003egutters\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;CodeMirror-lint-markers\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e],\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003etheme\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;erlang-dark\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elint\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003elineWrapping\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eautoRefresh\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 此属性是 autorefresh 的，需要引入 autorefresh.js\n\u003c/span\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e      \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003emethods\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"nx\"\u003ehandle\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n       \u003cspan class=\"nx\"\u003esetTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e(()\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003e$refs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ejenkinsFileCode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erefresh\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n       \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"mi\"\u003e50\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003ejson-editor\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"kt\"\u003e%\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eCodeMirror\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eborder\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"kt\"\u003epx\u003c/span\u003e \u003cspan class=\"kc\"\u003esolid\u003c/span\u003e \u003cspan class=\"ni\"\u003e#eee\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e950\u003c/span\u003e\u003cspan class=\"kt\"\u003epx\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nc\"\u003eCodeMirror-scroll\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e950\u003c/span\u003e\u003cspan class=\"kt\"\u003epx\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverflow-y\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003ehidden\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eoverflow-x\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003eauto\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003estyle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://codemirror.net/\"\u003ehttps://codemirror.net/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.itread01.com/content/1540634681.html\"\u003ehttps://www.itread01.com/content/1540634681.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/onlyonely/p/4450029.html\"\u003ehttps://www.cnblogs.com/onlyonely/p/4450029.html\u003c/a\u003e\u003c/p\u003e","date":1558656000,"description":"","fuzzywordcount":1900,"kind":"page","lang":"zh","lastmod":1558828800,"objectID":"a1ad0cd87f0baa74a0f99e5a34d5490b","publishdate":1558656000,"relpermalink":"/posts/vue/vue-codemirror/","section":"posts","summary":"\u003cp\u003e当我们需要在网页页面中输入不同编程语言代码并高亮显示时，可以使用 CodeMirror 来实现这种需求。\u003c/p\u003e","tags":["Vue","CodeMirror"],"title":"Vue 集成 CodeMirror","url":"https://xdhuxc.github.io/posts/vue/vue-codemirror/","wordcount":1849},{"categories":"posts","content":"\u003cp\u003e本部分内容记录下使用 golang 的模板时，需要注意的一些小问题。\u003c/p\u003e\n\u003ch3 id=\"if-else-语句\"\u003eif-else 语句\u003c/h3\u003e\n\u003cp\u003e在我们的项目中，需要动态渲染 alertmanager 的配置文件。我们选择了 confd 作为工具来获取后台数据并渲染数据到模板中。\u003c/p\u003e\n\u003cp\u003e在模板渲染中，使用 if-else 语句的时候，当需要判断和某个字符串相等的时候，不能使用常用的 \u003ccode\u003e==\u003c/code\u003e，而是要使用 \u003ccode\u003eeq\u003c/code\u003e 函数，编写模板如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ereceivers:{{range gets \u0026#34;/alertmanager/receivers/*\u0026#34;}}{{$item := json .Value}}\n{{ if eq $item.type \u0026#34;dingtalk\u0026#34; }}\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: {{$item.name}}\n  dingtalk_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e send_resolved: {{$item.resolved}}\n    webhook_url: {{$item.url}}\n{{ else if eq $item.type \u0026#34;email\u0026#34; }}\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: {{$item.name}}\n  email_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e send_resolved: {{$item.resolved}}\n    to: {{$item.url}}{{end}}\n{{end}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e另外，这种写法可读性好，但是渲染后会多出来一些空行，改为如下模板即可：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ereceivers:{{range gets \u0026#34;/alertmanager/receivers/*\u0026#34;}}{{$item := json .Value}}{{ if eq $item.type \u0026#34;dingtalk\u0026#34; }}\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: {{$item.name}}\n  dingtalk_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e send_resolved: {{$item.resolved}}\n    webhook_url: {{$item.url}}{{ else if eq $item.type \u0026#34;email\u0026#34; }}\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: {{$item.name}}\n  email_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e send_resolved: {{$item.resolved}}\n    to: {{$item.url}}{{end}}{{end}}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e数据部分以 JSON 格式向模板传递。\u003c/p\u003e\n\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e1、golang template 对于数组循环输出，空数组（数组长度为 0）不进行渲染\u003c/p\u003e\n\u003cp\u003e2、在 \u003ccode\u003erange-end\u003c/code\u003e 结构内部，如果要使用外部的变量，比如，\u003ccode\u003e.Name\u003c/code\u003e，需要写成 \u003ccode\u003e$.Name\u003c/code\u003e，即在外部变量名称前加 \u003ccode\u003e$\u003c/code\u003e 即可，单独的 \u003ccode\u003e$\u003c/code\u003e 等同于 \u003ccode\u003eglobal\u003c/code\u003e。\u003c/p\u003e","date":1558569600,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1558569600,"objectID":"f5d17c7cc527e9b5d7d7b8f7c4d23e1f","publishdate":1558569600,"relpermalink":"/posts/programming/golang/golang-template/","section":"posts","summary":"\u003cp\u003e本部分内容记录下使用 golang 的模板时，需要注意的一些小问题。\u003c/p\u003e","tags":["Golang","Template"],"title":"Go Template 的使用","url":"https://xdhuxc.github.io/posts/programming/golang/golang-template/","wordcount":386},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍 JavaScript 中的日期时间与Unix时间戳的转换及日期的格式化，都是在前端开发中经常会用到技术。\u003c/p\u003e\n\u003ch3 id=\"日期时间与-unix-时间戳的转换\"\u003e日期时间与 Unix 时间戳的转换\u003c/h3\u003e\n\u003cp\u003e最近项目中使用到了 Prometheus，从前端页面向后端接口发送请求时，传递的参数中有查询 Prometheus 指标的起止时间范围，格式为 Unix 时间戳，这就需要使用 JavaScript 在前端页面获取当前时间，然后转换为 Unix 时间戳。\u003c/p\u003e\n\u003cp\u003e以下方法返回当前时间至 GMT 时间1970年1月1日00时00分00秒对应的毫秒数.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enew Date().getTime()\nDate.parse(new Date())\n(new Date()).valueOf()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e而 Unix 时间戳定义为从 GMT 时间1970年01月01日00时00分00秒起至当前时间的总秒数。因此，给上述代码除以 1000，即可得到其对应的 Unix 时间戳：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e(new Date().getTime()) / 1000\n(Date.parse(new Date())) / 1000\n(new Date()).valueOf() / 1000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这同时也意味着，当我们从后端获取到 Unix 时间戳，再通过 JavaScript 代码格式化为日期时间时，需要给相应时间戳乘 1000，然后再格式化，否则会得到错误的日期。\u003c/p\u003e\n\u003ch3 id=\"日期的格式化\"\u003e日期的格式化\u003c/h3\u003e\n\u003cp\u003eJavaScript 没有提供常用的类似 \u003ccode\u003eyyyy-MM-dd hh:mm:ss\u003c/code\u003e 日期时间格式化函数，仅仅提供了获取年月日、时分秒等函数。\u003c/p\u003e\n\u003cp\u003e借助于 prototype 属性，我们可以为 Date 对象自定义格式化函数。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eDate.prototype.format = function(fmt) {\n  var o = {\n    \u0026#39;M+\u0026#39; : this.getMonth() + 1,                 // 月份\n    \u0026#39;d+\u0026#39; : this.getDate(),                    // 日\n    \u0026#39;h+\u0026#39; : this.getHours(),                   // 小时\n    \u0026#39;m+\u0026#39; : this.getMinutes(),                 // 分\n    \u0026#39;s+\u0026#39; : this.getSeconds(),                 // 秒\n    \u0026#39;q+\u0026#39; : Math.floor((this.getMonth() + 3) / 3), // 季度\n    \u0026#39;S\u0026#39;  : this.getMilliseconds()             // 毫秒\n  };\n  if(/(y+)/.test(fmt)) {\n    fmt = fmt.replace(RegExp.$1, (this.getFullYear() + \u0026#39;\u0026#39;).substr(4 - RegExp.$1.length));\n  }\n  for(var k in o) {\n    if(new RegExp(\u0026#39;(\u0026#39; + k + \u0026#39;)\u0026#39;).test(fmt)) {\n      fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : ((\u0026#39;00\u0026#39; + o[k]).substr((\u0026#39;\u0026#39; + o[k]).length)));\n    }\n  }\n  return fmt;\n};\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这样，我们就可以这样格式化 Date 对象了：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enew Date(metrics_time_unix_stamp_format * 1000).format(\u0026#39;yyyy-MM-dd hh:mm:ss\u0026#39;) # 2019-05-19 15:23:34\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当然也可以这样格式化：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enew Date(metrics_time_unix_stamp_format * 1000).format(\u0026#39;yyyy-MM-dd\u0026#39;) # 2019-05-19\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"golang-时间字符串的格式化\"\u003eGolang 时间字符串的格式化\u003c/h3\u003e\n\u003cp\u003e后台 API 接口使用 golang 开发时，传到前端的时间字符串是这样的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e2019-05-19T15:23:34Z\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e而 JavaScript 没有提供这样的格式化方法，我们可以将其认为是个固定模式的字符串，对其进行字符串操作，以空格代替其中的 \u003ccode\u003eT\u003c/code\u003e 和 \u003ccode\u003eZ\u003c/code\u003e 即可，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecreate_time.replace(\u0026#39;T\u0026#39;, \u0026#39; \u0026#39;).replace(\u0026#39;Z\u0026#39;, \u0026#39; \u0026#39;) # 2019-05-19 15:23:34\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这样就得到我们常用的日期时间字符串了。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://www.w3school.com.cn/jsref/jsref_obj_date.asp\"\u003ehttp://www.w3school.com.cn/jsref/jsref_obj_date.asp\u003c/a\u003e\u003c/p\u003e","date":1558224000,"description":"","fuzzywordcount":800,"kind":"page","lang":"zh","lastmod":1558224000,"objectID":"0b3128f8b4de78cf237f4656ece4b1ab","publishdate":1558224000,"relpermalink":"/posts/programming/javascript/javascript_date_time/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍 JavaScript 中的日期时间与Unix时间戳的转换及日期的格式化，都是在前端开发中经常会用到技术。\u003c/p\u003e","tags":["JavaScript"],"title":"JavaScript 中的日期和时间格式化","url":"https://xdhuxc.github.io/posts/programming/javascript/javascript_date_time/","wordcount":725},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Prometheus 和 AlertManager 配合使用时的配置方式，以备后需。\u003c/p\u003e\n\u003ch3 id=\"prometheus-配置\"\u003eprometheus 配置\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# Prometheus 全局配置项\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eglobal:\n  scrape_interval:     15s # 设置抓取数据的周期，默认为：1min\n  evaluation_interval: 15s # 设置更新 rules 文件的周期，默认为：1min\n  scrape_timeout:      15s # 设置抓取数据的超时时间，默认为：10s\n  external_labels:         # 额外的属性，会添加到拉取的数据并存储到数据库中。\n    monitor: \u0026#39;codelab_monitor\u0026#39; \n  \n\n\u003cspan class=\"gh\"\u003e# Alertmanager 配置\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ealerting:\n  alertmanagers:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#34;localhost:9093\u0026#34;] # 设定 alertmanager 和 prometheus 的交互接口，也就是 alertmanager 监听的 IP 地址和端口。\n\n\u003cspan class=\"gh\"\u003e# rule 配置，首次读取默认加载，之后根据 evaluation_interval 设定的周期加载\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003erule_files:\n  # - \u0026#34;prometheus_rules.yml\u0026#34;\n  # - \u0026#34;alertmanager_rules.yml\u0026#34;\n\n\u003cspan class=\"gh\"\u003e# scape 配置，即提供数据的端点的配置\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003escrape_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;prometheus\u0026#39;            # job_name 默认以 job=\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ejob_name\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e 的形式写入时间序列的标签之中，可以用于查询使用\n    scrape_interval: 15s              # 抓取周期，默认采用全局配置\n    # 指标路径默认为：/metrics \n    # 协议默认为：http \n    static_configs:                   # 静态配置\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;192.168.33.10:9090\u0026#39;] # prometheus 抓取数据的地址，即 instance 实例项\n    \n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;node_exporter\u0026#39;\n    static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;192.168.33.10:9000\u0026#39;]    \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e动态更新 prometheus 的配置，即热更新加载，有如下两种方式：\n1、向 prometheus 进程发送 SIGHUP 信号。\u003c/p\u003e\n\u003cp\u003e2、使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -X POST http://localhost:9090/-/reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e需要启动 prometheus 进程时添加 --web.enable-lifecycle 参数\u003c/p\u003e\n\u003ch3 id=\"alertmanager-配置\"\u003eAlertManager 配置\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# Alertmanager 全局配置项\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eglobal:\n  resolve_timeout: 5m                                    # 处理超时时间，默认为：5min\n  smtp_smarthost: \u0026#39;smtp.163.com:25\u0026#39;                      # 邮箱 SMTP 服务器\n  smtp_from: \u0026#39;abc@163.com\u0026#39;                               # 发件邮箱名称\n  smtp_auth_username: \u0026#39;xdhuxc@163.com\u0026#39;                   # 邮箱名称\n  smtp_auth_password: \u0026#39;Abc@19873\u0026#39;                        # 邮箱密码或授权码\n  wechat_api_url: \u0026#39;https://qyapi.weixin.qq.com/cgi-bin/\u0026#39; # 企业微信地址\n\n\u003cspan class=\"gh\"\u003e# 定义模板\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003etemplates:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e \u0026#39;template/*.tmpl\u0026#39;\n\u003cspan class=\"gh\"\u003e# 定义路由树信息\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eroute:\n  group_by: [\u0026#39;group_name\u0026#39;]     # 报警分组依据\n  group_wait: 10s              # 第一次等待多久时间发送一组警报的通知\n  group_internal: 10s          # 下一次发送新警报前的等待时间\n  repeat_interval: 1m          # 发送重复警报的周期，对于 email 配置中，此项不可以设置过低，否则将会由于邮件发送太过频繁，被 SMTP 服务器拒绝\n  receiver: \u0026#39;email\u0026#39;            # 发送警报的接收者的名称\n  \n\u003cspan class=\"gh\"\u003e# 定义警报接收者的信息\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ereceivers:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: \u0026#39;email\u0026#39;                             # 警报\n    email_configs:                            # 邮箱配置\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e to: \u0026#39;xdhuxc@163.com\u0026#39;                    # 接收警报的 email 配置\n      html: \u0026#39;{{ template \u0026#34;email.html\u0026#34; . }}\u0026#39;   # 设置邮件的内容模板\n      headers: { Subject: \u0026#34;[WARN] 报警邮件\u0026#34; }  # 接收邮件的标题\n      \n    webhook_configs:                          # webhook 配置\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e url: \u0026#39;http://localhost:5001\u0026#39;\n    send_resolved: true\n    \n    wechat_configs:                           # 企业微信报警配置\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e send_resovled: true\n      to_party: \u0026#39;1\u0026#39;                           # 接收组的 ID\n      agent_id: \u0026#39;1022321\u0026#39;                     # 企业微信——》自定义应用——》AgentID\n      corp_id: \u0026#39;skjsdjgldfg\u0026#39;                  # 企业信息（我的企业——》CorpID【在底部】）\n      api_secret: \u0026#39;sfsdgdfgd\u0026#39;                 # 企业微信——》自定义应用——》Secret\n      message: \u0026#39;{{ template \u0026#34;wechat.html\u0026#34; }}\u0026#39; # 发送消息模板的设置\n\n\u003cspan class=\"gh\"\u003e# 覆盖规则\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 一个 inhibit 规则是在与另一组匹配器匹配的警报存在的条件下，使匹配一组匹配器的警报失效的规则，两个警报必须具有一组相同的标签\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einhibit_rules:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e source_match:\n      severity: \u0026#39;critical\u0026#39;\n      target_match:\n        severity: \u0026#39;warning\u0026#39;\n      equal: [\u0026#39;alertname\u0026#39;, \u0026#39;dev\u0026#39;, \u0026#39;instance\u0026#39;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"在-prometheus-模块中定义报警规则\"\u003e在 prometheus 模块中定义报警规则\u003c/h3\u003e\n\u003cp\u003ealertmanager_rules.yml 示例如下：（与 prometheus 同目录下）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egroups:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: alertmanager-rules\n    rules:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e alert: InstanceDown         # 报警名称\n      expr: up == 0               # 报警的判定条件，参考 prometheus 高级查询来设定\n      for: 2m                     # 满足报警条件持续时间多久后，才会发送报警\n      labels:\n        team: node\n      annotations:\n        summary: \u0026#34;{{ $labels.instance }}: has been down.\u0026#34;\n        description: \u0026#34;{{ $labels.instance }}: job {{ $labels.job }} has been down.\u0026#34;\n        value: {{ $value }}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e报警信息生命周期的三种状态\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003einactive：表示当前报警信息既不是 firing 状态，也不是 pending 状态\u003c/li\u003e\n\u003cli\u003epending：表示在设置的阈值时间范围内被激活的\u003c/li\u003e\n\u003cli\u003efiring：表示超过设置的阈值时间被激活的\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在 alertmanager 的配置地址，即可查看所监控到的报警信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://localhost:9093/#/alerts\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e测试 alertmanager.yml 文件格式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./amtool check-config alertmanager.yml\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重新加载 alertmanager 配置文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -X POST http://localhost:9093/-/reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重新加载钉钉配置文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://localhost:8060/reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"promtool-工具\"\u003epromtool 工具\u003c/h3\u003e\n\u003cp\u003epromtool 工具可以用来检测 prometheus 相关的配置文件的格式是否正确\u003c/p\u003e\n\u003cp\u003e1）安装方式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego get github.com/prometheus/prometheus/cmd/promtool\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）检测 rule 文件格式正确性\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epromtool check rules /etc/example.rules.yml\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）检测 prometheus.yml 文件格式正确性\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epromtool check prometheus.yml\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"增加新的-alertmanager-报警方式\"\u003e增加新的 AlertManager 报警方式\u003c/h3\u003e\n\u003cp\u003e1、在 \u003ccode\u003ealertmanager/config/config.go\u003c/code\u003e 文件中的结构体 \u003ccode\u003eGlobalConfig\u003c/code\u003e 中增加新的配置，此结构体对应于 alertmanager.yaml 中的全局配置；在结构体 \u003ccode\u003eReceiver\u003c/code\u003e 中增加具体报警接收者的配置，对应于 alertmanager.yaml 中的 receiver 部分的配置；在 \u003ccode\u003efunc (c *Config) UnmarshalYAML(unmarshal func(interface{}) error) error\u003c/code\u003e 接口中为 Global 部分的配置赋予默认值。\u003c/p\u003e\n\u003cp\u003e2、在 \u003ccode\u003ealertmanager/notify\u003c/code\u003e 目录下创建目录 \u003ccode\u003etelephone\u003c/code\u003e，可参照其他的报警通道，实现 \u003ccode\u003efunc New(c *config.TelephoneConfig, l log.Logger) (*Notifier, error)\u003c/code\u003e函数和 \u003ccode\u003efunc (n *Notifier) Notify(ctx context.Context, as ...*types.Alert) (bool, error)\u003c/code\u003e接口，完成业务代码的开发，\u003c/p\u003e\n\u003cp\u003e3、在 \u003ccode\u003ealertmanager/config/notifiers.go\u003c/code\u003e 文件中增加结构体 \u003ccode\u003eTelephoneConfig\u003c/code\u003e，存储发送报警消息时的通用配置，实现其 \u003ccode\u003efunc (t *TelephoneConfig) UnmarshalYAML(unmarshal func(interface{}) error) error\u003c/code\u003e 接口；在此文件最上方，定义默认的 \u003ccode\u003eDefaultTelephoneConfig\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e4、在 \u003ccode\u003ealertmanager/cmd/alertmanager/main.go\u003c/code\u003e 文件的 \u003ccode\u003efunc buildReceiverIntegrations(nc *config.Receiver, tmpl *template.Template, logger log.Logger) ([]notify.Integration, error)\u003c/code\u003e 方法中，注册我们新编写的报警通知方式。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efor i, c := range nc.TelephoneConfigs {\n\t\tadd(\u0026#34;telephone\u0026#34;, i, c, func(l log.Logger) (notify.Notifier, error) { return telephone.New(c, l) })\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、在 \u003ccode\u003ealertmanager/notify/notify.go\u003c/code\u003e 文件中的 \u003ccode\u003efunc newMetrics(r prometheus.Registerer) *metrics\u003c/code\u003e 函数中注册其指标信息。\u003c/p\u003e","date":1558051200,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1576281600,"objectID":"8e764f7109314257855b06339f4f8d84","publishdate":1558051200,"relpermalink":"/posts/devops/prometheus/prometheus-alertmanager/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Prometheus 和 AlertManager 配合使用时的配置方式，以备后需。\u003c/p\u003e","tags":["DevOps","AlertManager","Prometheus"],"title":"Prometheus 和 AlertManager 配合使用","url":"https://xdhuxc.github.io/posts/devops/prometheus/prometheus-alertmanager/","wordcount":1617},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍了 HAProxy 及其配置的详细含义。\u003c/p\u003e\n\u003ch3 id=\"haproxy\"\u003eHAProxy\u003c/h3\u003e\n\u003cp\u003eHAProxy 提供高可用性、负载均衡以及基于 TCP 和 HTTP 应用的代理，支持虚拟主机，是免费、快速并且可靠的一种解决方案。HAProxy特别适用于那些负载特大的 web 站点，这些站点通常又需要会话保持或七层处理。HAProxy 运行在当前的硬件上，完全可以支持数以万计的并发连接，并且它的运行模式使得它可以很简单、安全地整合进当前的架构中，同时可以保护 web 服务器不被暴露在网络上。\u003c/p\u003e\n\u003ch3 id=\"haproxy-配置\"\u003eHAProxy 配置\u003c/h3\u003e\n\u003ch4 id=\"配置部分\"\u003e配置部分\u003c/h4\u003e\n\u003cp\u003eHAProxy 配置中分成五部分内容，分别如下：\u003c/p\u003e\n\u003cp\u003e1、global：参数是进程级的，通常是和操作系统相关，这些参数一般只配置一次，如果配置无误，就不需要再次进行修改。\u003c/p\u003e\n\u003cp\u003e2、defaults：配置默认参数，这些参数可以被用到 frontend、backend、Listen 组件。\u003c/p\u003e\n\u003cp\u003e3、frontend：接收请求的前端虚拟节点，Frontend 可以更加规则直接指定具体使用后端的 backend。\u003c/p\u003e\n\u003cp\u003e4、backend：后端服务集群的配置，是真实服务器，一个 Backend 对应于一个或者多个实体服务器。\u003c/p\u003e\n\u003cp\u003e5、Listen：Frontend 和 backend 的组合体。\u003c/p\u003e\n\u003ch4 id=\"haproxycfg\"\u003ehaproxy.cfg\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e  1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 89\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 90\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 91\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 92\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 93\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 94\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 95\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 96\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 97\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 98\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 99\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e100\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e101\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e102\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e103\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e104\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e105\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e106\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e107\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e108\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e109\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e110\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gu\"\u003e### 全局配置信息 ###\n\u003c/span\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 参数是进程级的，通常和操作系统有关\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eglobal \n  maxconn 20480         # 默认最大连接数。\n  log 127.0.0.1 local3  # 定义 haproxy 日志级别，可以为：err、warning、info、debug。\n  chroot /var/haproxy   # chroot运行的路径。\n  uid 99                # 运行haproxy进程的用户ID。\n  gid 99                # 运行haproxy进程的用户组ID。\n  daemon                # 以守护进程方式运行haproxy。\n  nbproc 1              # 进程数量，可以设置为多个进程以提高性能。\n  pidfile /var/run/haproxy.pid # haproxy进程的pid存放路径，启动进程的用户必须有权限访问此文件。\n  ulimit -n 65535       # ulimit 的数量限制\n\u003cspan class=\"gu\"\u003e### 默认配置选项 ###\n\u003c/span\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 参数可以被配置到frontend、backend和listen组件。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edefaults\n  log global\n  mode http             # 所处理的类别，七层http，四层tcp。\n  maxconn 20480         # 最大连接数。\n  option httplog        # 日志类别，HTTP日志格式。\n  option httpclose      # 每次请求完毕后主动关闭 http 通道。\n  option dontlognull    # 不记录健康检查的日志信息。\n  option forwardfor     # 如果后端服务器需要获得客户端的真实IP需要配置的参数，可以从 Http Header 中获取客户端IP。\n  option redispatch     # serverId 对应的服务器挂掉后，强制定向到其他健康的服务器。\n  option abortonclose   # 当服务器负载很高的时候，自动结束掉当前队列处理比较久的连接。\n  stats refresh 30      # 统计页面刷新间隔。\n  retries 3             # 3 次连接失败就认为服务不可用，也可以通过 “后面” 设置。\n  balance roundrobin    # 设置默认的负载均衡方式，轮询方式。\n  # balance source      # 设置默认的负载均衡方式，类似于 nginx 的 IP_Hash。\n  # balance leastconn   # 设置默认的负载均衡方式，最小连接方式。\n  contimeout 5000       # 连接超时时间。\n  clitimeout 50000      # 客户端连接超时时间。\n  srvtimeout 50000      # 服务器超时时间。\n  timeout check 2000    # 心跳检测超时。\n  \n\u003cspan class=\"gu\"\u003e### 监控页面设置 ###\n\u003c/span\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003elisten admin_status     # Fronted 和 Backend 的组合体，监控组的名称，按需求自定义名称。\n  bind 0.0.0.0:65535    # 监听端口。\n  mode http             \u003cspan class=\"ni\"\u003e#http\u003c/span\u003e 的七层模式。\n  log 127.0.0.1 local3 err # 错误日志记录。\n  stats refresh 5s      # 每隔5秒自动刷新监控页面。\n  stats uri /admin?stats # 监控页面的url。\n  stats realm xdhuxc\\ xdhuxc # 监控页面显示信息。\n  stats auth admin:admin     # 监控页面的用户名和密码，可以设置多个用户名。\n  stats auth xdhuxc:xdhuxc   # 监控页面的用户名和密码xdhuxc/xdhuxc。\n  stats hide-version         # 隐藏统计页面上的HAproxy版本信息。\n  stats admin if TRUE        # 手工启用/禁用后端服务器（HAproxy-1.4.9以后版本）。\n  \n  errorfile 403 /etc/haproxy/errorfiles/403.http\n  errorfile 500 /etc/haproxy/errorfiles/500.http\n  errorfile 502 /etc/haproxy/errorfiles/502.http\n  errorfile 503 /etc/haproxy/errorfiles/503.http\n  errorfile 504 /etc/haproxy/errorfiles/504.http\n  \n  ### HAProxy 的日志记录内容设置\n  capture request header Host len 40\n  capture request header Content-Length len 10\n  capture request header Referer len 200\n  capture response header Server len 40\n  capture response header Content-Length len 10\n  capture response header Cache-Control len 8\n  \n  ### 网站监测 listen 配置\n  ### 主要是监控 haproxy 后端服务器的监控状态\nlisten site_status\n  bind 0.0.0.0:9090         # 监听端口\n  mode http                 # http 的七层模式\n  log 127.0.0.1 local3 err  # 日志级别\n  monitor-uri /site_status  # 网站健康检查URL，用来检测HAproxy管理的网站是否可用，正常返回200，不正常返回503。\n  acl site_dead nbsrv(server_web) lt 2 # 定义网站down时的策略，当挂在负载均衡上的指定backend中有效机器数小于1台时返回true。\n  acl site_dead nbsrv(server_blog) lt 2\n  acl site_dead nbsrv(server_bbs) lt 2\n  monitor fail if site_dead  # 当满足策略的时候，返回503。\n  monitor-net 192.168.16.2/32 # 来自192.168.16.2的日志信息不会被记录和转发\n  monitor-net 129.168.16.3/32\n  \n  ### frontend 配置\n  ### frontend配置里可定义多个acl进行匹配操作\nfrontend http_web_in\n  bind 0.0.0.0:80  # 监听端口，即haproxy提供web服务的端口，和lvs的VIP端口类似。\n  mode http        # http 的七层模式。\n  log global       # 应用全局的日志配置。\n  option httplog   # 启用http的log。\n  option httpclose # 每次请求完毕后主动关闭http通道，HAProxy不支持keep-alive模式。\n  option forwardfor # 如果后端服务器需要获得客户端的真实IP地址，需要配置此参数，将可以从Http header 中获得客户端IP。\n  \n  ### acl策略配置\n  acl is_a hdr_beg(host) -i www.xdhuxc.org   # 判断域名是不是 www.xdhuxc.org，是则给予 a 服务器集群服务。\n  acl is_b hdr_beg(host) -i www.xdhuxc.ocg # 判断域名是不是 www.xdhuxc.ocg，是则给予 b 服务器集群服务。\n  \n  use_backend a_server if is_a\n  use_backend b_server if is_b\n  \nbackend a_server\n    mode http\n    stats uri /haproxy\n    balance roundrobin\n    cookie JSESSIONID prefix\n    stats hide-version\n    option httpclose\n    server web1 192.168.91.128:80 check\n    server web2 192.168.91.129:80 check\n    \nbackend b_server\n    mode http\n    stats uri /haproxy\n    balance roundrobin\n    cookie JSESSIONID\n    stats hide-version\n    option httpclose\n    server web1 192.168.91.130 check\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://blog.51cto.com/itnihao/915537\"\u003ehttp://blog.51cto.com/itnihao/915537\u003c/a\u003e\u003c/p\u003e","date":1557792000,"description":"","fuzzywordcount":2100,"kind":"page","lang":"zh","lastmod":1578315262,"objectID":"1e7bfdc646346e85ed0d4903a1416880","publishdate":1557792000,"relpermalink":"/posts/mixed/haproxy/haproxy-introduction-and-configuration/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍了 HAProxy 及其配置的详细含义。\u003c/p\u003e","tags":["HAProxy"],"title":"HAProxy 及其配置详解","url":"https://xdhuxc.github.io/posts/mixed/haproxy/haproxy-introduction-and-configuration/","wordcount":2039},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍了使用 Hugo 和 GitHub搭建个人网站的一些高级功能，包括在云端存储图片、评论功能、网站统计、阅读数量统计、文字统计和阅读时长预估等功能。\u003c/p\u003e\n\u003ch3 id=\"图片存储\"\u003e图片存储\u003c/h3\u003e\n\u003cp\u003e随着我们撰写的博客篇数的增多，博客中的图片也可能会相应的增加。本地存储图片对我们而言，不仅占用本地磁盘存储空间，而且还可能因磁盘损坏而丢失。此时，我们可以选择使用云端存储来保存我们博客中使用的图片，将图片上传到云服务商提供的云端存储后，在我们的 markdown 文档中，只需要引入其外部链接即可显示图片。\u003c/p\u003e\n\u003cp\u003e使用 \u003ca href=\"https://portal.qiniu.com/signup?code=3lcz1eyk5rq6q\"\u003e七牛云\u003c/a\u003e 的对象存储来存放我们的图片，然后将图片的外部链接写在 markdown 文档之中，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ecenter\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eimg\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;/image/point.png\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ewidth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;800px\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eheight\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;300px\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n图 1 · 输入中 \u003cspan class=\"sb\"\u003e`·`\u003c/span\u003e 号 （图注）\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ecenter\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e需要注册 \u003ca href=\"https://portal.qiniu.com/signup?code=3lcz1eyk5rq6q\"\u003e七牛云\u003c/a\u003e 账户，并使用身份证信息实名认证。\u003c/p\u003e\n\u003cp\u003e为什么使用 \u003ca href=\"https://portal.qiniu.com/signup?code=3lcz1eyk5rq6q\"\u003e七牛云\u003c/a\u003e的对象存储呢？因为其免费提供 10G 存储空间，足够我们使用了。\u003c/p\u003e\n\u003ch3 id=\"添加评论功能\"\u003e添加评论功能\u003c/h3\u003e\n\u003ch4 id=\"基于-disqus-实现评论功能\"\u003e基于 Disqus 实现评论功能\u003c/h4\u003e\n\u003cp\u003eHugo 默认支持 \u003ca href=\"https://disqus.com/\"\u003eDisqus\u003c/a\u003e 的评论，并且已经在模板中添加好了，需要我们去 Disqus 注册一个账号，然后进行配置\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003econfig.toml\u003c/code\u003e 中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edisqusShortname = \u0026#34;yourdisqusShortname\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eyourdisqusShortname 就是 disqus 个人主页下的 Account 部分的 Username 的值。\u003c/p\u003e\n\u003cp\u003e但是在本地无法测试该功能，需要上线到 github 进行测试。\u003c/p\u003e\n\u003cp\u003e遗憾的是，Disqus 最近似乎出问题了，该功能实际不可用。\u003c/p\u003e\n\u003ch4 id=\"基于-valine-实现评论功能\"\u003e基于 Valine 实现评论功能\u003c/h4\u003e\n\u003cp\u003e有关 Valine 的详细信息，参考 \u003ca href=\"https://valine.js.org/\"\u003eValine 官方网站\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://valine.js.org/\"\u003eValine\u003c/a\u003e 评论系统依赖于 \u003ca href=\"https://leancloud.cn/\"\u003eLeancloud\u003c/a\u003e，需要先在 \u003ca href=\"https://leancloud.cn/\"\u003eLeancloud\u003c/a\u003e 中进行相关的准备工作。\u003c/p\u003e\n\u003cp\u003e① 创建 \u003ccode\u003e开发版应用\u003c/code\u003e HugoComment，点击该应用，点击左侧菜单 \u003ccode\u003e设置\u003c/code\u003e，点击 \u003ccode\u003e应用 Key\u003c/code\u003e，可以看到 \u003ccode\u003eApp ID\u003c/code\u003e 和 \u003ccode\u003eApp Key\u003c/code\u003e，后面需要用到 \u003ccode\u003eApp ID\u003c/code\u003e 和 \u003ccode\u003eApp Key\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e② 创建存储 Class comment，用于储存评论内容。\u003c/p\u003e\n\u003cp\u003e③ 在 \u003ccode\u003e设置\u003c/code\u003e 的 \u003ccode\u003e安全中心\u003c/code\u003e 里，将自己网站的域名保存到 Web 安全域名中。\u003c/p\u003e\n\u003cp\u003e此处假定一个互联网用户可以无障碍地完成上述准备工作。\u003c/p\u003e\n\u003cp\u003e1、在 \u003ccode\u003econfig.toml\u003c/code\u003e 中添加配置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[params]\n  [params.valine]\n    # 控制开启此评论系统\n    enable = true\n    # LeanCloud 的 AppID\n    appId = \u0026#39;the AppID of LeanCloud\u0026#39;\n    # LeanCloud 的 AppKey\n    appKey = \u0026#39;the AppKey of LeanCloud\u0026#39;\n    # 用于控制是否开启邮件通知功能\n    notify = false\n    # 用于控制是否开启评论验证码功能\n    verify = false\n    # 用于配置评论项中用户头像样式，有多种选择：mm, identicon, monsterid, wavatar, retro, hide\n    avatar = \u0026#39;identicon\u0026#39;\n    # 评论框的提示符\n    placeholder = \u0026#39;说点什么吧...\u0026#39;\n    # 控制是否开启文章阅读数的统计功能\n    visitor = true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、创建 \u003ccode\u003elayouts/partials/comment.html\u003c/code\u003e 文件，加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{{ if .Site.Params.valine.enable }}\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;{{ .Permalink | relURL }}\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;leancloud_visitors\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003edata-flag-title\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;{{ .Title }}\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;post-meta-item-text\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e文章阅读量 \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;leancloud-visitors-count\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;vcomments\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;//cdn1.lncld.net/static/js/3.0.4/av-min.js\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;//unpkg.com/valine/dist/Valine.min.js\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003etype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;text/javascript\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eValine\u003c/span\u003e\u003cspan class=\"p\"\u003e({\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eel\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;#vcomments\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eappId\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;{{ .Site.Params.valine.appId }}\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eappKey\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;{{ .Site.Params.valine.appKey }}\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003enotify\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;{{ .Site.Params.valine.notify }}\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003everify\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;{{ .Site.Params.valine.verify }}\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eavatar\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{{ .Site.Params.valine.avatar }}\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003eplaceholder\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;{{ .Site.Params.valine.placeholder }}\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003evisitor\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;{{ .Site.Params.valine.visitor }}\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e});\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n{{ end }}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，不要把 \u003ccode\u003eif\u003c/code\u003e 改成 \u003ccode\u003ewith\u003c/code\u003e，否则会出现解析不了模板的问题。\u003c/p\u003e\n\u003cp\u003e3、在 \u003ccode\u003elayouts/post/single.html\u003c/code\u003e 文件中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;content\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"c\"\u003e\u0026lt;!--\n\u003c/span\u003e\u003cspan class=\"c\"\u003e  {{ partial \u0026#34;disqus.html\u0026#34; . }}\n\u003c/span\u003e\u003cspan class=\"c\"\u003e  --\u0026gt;\u003c/span\u003e\n  {{ partial \u0026#34;comment.html\u0026#34; . }}\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、评论功能效果如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/comment_result.png\" width=\"800px\" height=\"300px\" /\u003e\n图 1 · 评论功能效果\n\u003c/center\u003e\n\u003cp\u003e5、可以在 \u003ca href=\"https://leancloud.cn/\"\u003eLeancloud\u003c/a\u003e 的 \u003ccode\u003eHugoComment\u003c/code\u003e 中的存储 \u003ccode\u003eComment\u003c/code\u003e 中看到提交的评论信息。\u003c/p\u003e\n\u003ch3 id=\"添加网站统计功能\"\u003e添加网站统计功能\u003c/h3\u003e\n\u003cp\u003e我们可以使用 google 统计或者百度统计来统计我们网站相关的数据，比如浏览量、访客数、平均访问时长等。\u003c/p\u003e\n\u003ch4 id=\"google-analytics\"\u003eGoogle Analytics\u003c/h4\u003e\n\u003cp\u003e使用 Google 的网站分析功能，登录 \u003ca href=\"https://marketingplatform.google.com/about/\"\u003eGoogle Analytics\u003c/a\u003e，注册账号，获取 Track ID，填写到 config.toml 中 \u003ccode\u003e[params]\u003c/code\u003e 下 \u003ccode\u003egoogleAnalytics\u003c/code\u003e 的值处。\u003c/p\u003e\n\u003cp\u003eHugo 默认支持 Google Analytics，但是 Google Analytics 有些复杂，后续再研究其使用方法。\u003c/p\u003e\n\u003ch4 id=\"百度统计\"\u003e百度统计\u003c/h4\u003e\n\u003cp\u003e使用百度统计来做网站分析，一则使用方法相对简单，数据可以满足我们的需求，二则不需要考虑翻墙。\u003c/p\u003e\n\u003cp\u003e1、注册 \u003ca href=\"https://tongji.baidu.com/web/welcome/login\"\u003e百度统计\u003c/a\u003e 账号，在 \u003ccode\u003e管理\u003c/code\u003e，\u003ccode\u003e代码管理\u003c/code\u003e，\u003ccode\u003e代码获取\u003c/code\u003e 下获取到如下代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"mi\"\u003e_\u003c/span\u003e\u003cspan class=\"nx\"\u003ehmt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e_\u003c/span\u003e\u003cspan class=\"nx\"\u003ehmt\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ehm\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;script\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n  \u003cspan class=\"nx\"\u003ehm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esrc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;https://hm.baidu.com/hm.js?ad57771d1b8d25cbd18d12f67bc32135\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementsByTagName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;script\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e \n  \u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparentNode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einsertBefore\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehm\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003cspan class=\"p\"\u003e})();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，该代码中包含特殊的字符串 \u003ccode\u003ead57771d1b8d25cbd18d12f67bc32135\u003c/code\u003e，仅供本网站使用，其他网站使用无效。\u003c/p\u003e\n\u003cp\u003e2、在 \u003ccode\u003econfig.toml\u003c/code\u003e 文件中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[params]\n  [params.baidu]\n    enable = true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、在 \u003ccode\u003elayouts/partials/\u003c/code\u003e 目录下创建 \u003ccode\u003ebaidu_analytics.html\u003c/code\u003e 文件，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{{ if .Site.Params.baidu.enable }}\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"mi\"\u003e_\u003c/span\u003e\u003cspan class=\"nx\"\u003ehmt\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e_\u003c/span\u003e\u003cspan class=\"nx\"\u003ehmt\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"p\"\u003e[];\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kd\"\u003efunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ehm\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;script\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003ehm\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esrc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;https://hm.baidu.com/hm.js?ad57771d1b8d25cbd18d12f67bc32135\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003edocument\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003egetElementsByTagName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;script\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n        \u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eparentNode\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003einsertBefore\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehm\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e})();\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n{{ end }}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、在 \u003ccode\u003elayouts/partials/footer.html\u003c/code\u003e 中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{{ if not .Site.IsServer  }}\n    {{ partial \u0026#34;baidu_analytics.html\u0026#34; . }}\n{{ end }}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，为了避免在本地开发时，错误提交和统计，加入了过滤条件。\u003c/p\u003e\n\u003cp\u003e5、百度统计效果图\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/baidu_analytics_result.png\" width=\"800px\" height=\"300px\" /\u003e\n图 2 · 百度统计效果图\n\u003c/center\u003e\n\u003ch3 id=\"添加阅读数量和-pvuv-统计功能\"\u003e添加阅读数量和 PV，UV 统计功能\u003c/h3\u003e\n\u003cp\u003e统计访问网站的 \u003ccode\u003ePV\u003c/code\u003e 和 \u003ccode\u003eUV\u003c/code\u003e 及每篇博客的阅读数也是一件重要的事情，可以直接在页面上看到我们网站的 \u003ccode\u003ePV\u003c/code\u003e 和 \u003ccode\u003eUV\u003c/code\u003e及每篇文章的阅读数，我们使用 \u003ca href=\"http://ibruce.info/2015/04/04/busuanzi/\"\u003e不蒜子\u003c/a\u003e 来实现。\u003c/p\u003e\n\u003cp\u003e使用 \u003ca href=\"http://ibruce.info/2015/04/04/busuanzi/\"\u003e不蒜子\u003c/a\u003e 时，首先需要引用 \u003ca href=\"http://ibruce.info/2015/04/04/busuanzi/\"\u003e不蒜子\u003c/a\u003e 的 \u003ccode\u003eJavaScript\u003c/code\u003e 探针脚本。\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003elayouts/partials/head.html\u003c/code\u003e 中的 \u003ccode\u003ehead\u003c/code\u003e 标签中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"c\"\u003e\u0026lt;!-- Reading Statistics --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e \u003cspan class=\"na\"\u003easync\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escript\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后需要在 \u003ccode\u003eHTML\u003c/code\u003e 代码中加入显示内容的代码。\u003c/p\u003e\n\u003ch4 id=\"pvuv-统计\"\u003ePV，UV 统计\u003c/h4\u003e\n\u003cp\u003e我们将 PV 和 UV 放置在 \u003ccode\u003e版权申明\u003c/code\u003e 部分，在 \u003ccode\u003elayouts/partials/copyright.html\u003c/code\u003e 中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;small-print\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003esmall\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;busuanzi_container_site_pv\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;display:none\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e 访问量 \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;busuanzi_value_site_pv\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e 次\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003esmall\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003esmall\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;busuanzi_container_site_uv\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;display:none\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e 访客数 \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;busuanzi_value_site_uv\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e 人次 \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003esmall\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e    \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，要确保 \u003ccode\u003eid\u003c/code\u003e 是正确的，才能正常计数。\u003c/p\u003e\n\u003cp\u003e另外，本地测试时，显示的 \u003ccode\u003ePV\u003c/code\u003e 和 \u003ccode\u003eUV\u003c/code\u003e 数据非常惊人。加入官方网站提供的 QQ 群后提问该问题，答案是：由于网络上大量用户使用 \u003ca href=\"http://ibruce.info/2015/04/04/busuanzi/\"\u003e不蒜子\u003c/a\u003e，本地主机都是 \u003ccode\u003elocalhost\u003c/code\u003e 和 \u003ccode\u003e127.0.0.1\u003c/code\u003e，本地 JavaScript 可能是以 当前机器 IP 地址或主机名为键，获取 \u003ccode\u003ePV\u003c/code\u003e 和 \u003ccode\u003eUV\u003c/code\u003e 并上传到云端的，也就说，此时的 \u003ccode\u003ePV\u003c/code\u003e 和 \u003ccode\u003eUV\u003c/code\u003e 是使用不蒜子的所有 \u003ccode\u003elocalhost\u003c/code\u003e 的总数。\u003c/p\u003e\n\u003cp\u003e但是不必担心，当网站上传到 GitHub 上之后，统计数据就正常了。\u003c/p\u003e\n\u003ch4 id=\"阅读数量统计\"\u003e阅读数量统计\u003c/h4\u003e\n\u003cp\u003e我们将阅读数量的统计显示在博客详情页面中大标题的下方。\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003elayouts/post/single.html\u003c/code\u003e 中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;header\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e{{ .Title }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eh2\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e{{ .Description }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eh2\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003efont\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;font-family: \u0026#39;STKaiti\u0026#39;;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;busuanzi_container_page_pv\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e 阅读量 \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e \u003cspan class=\"na\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;busuanzi_value_page_pv\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e 次\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003efont\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，要确保 \u003ccode\u003eid\u003c/code\u003e 是正确的。\u003c/p\u003e\n\u003ch3 id=\"博客字数和阅读时长统计\"\u003e博客字数和阅读时长统计\u003c/h3\u003e\n\u003cp\u003eHugo 内置了博客字数统计和阅读时长统计功能，我们将其添加到博客详情页即可。\u003c/p\u003e\n\u003cp\u003e1、在 config.toml 中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehasCJKLanguage = true # 设置为 true，则会在内容中自动检测中文/日文/韩文语言，这将使得 .Summary 和 .WordCount 在 CJK 语言中正常工作。\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在 \u003ccode\u003elayouts/post/single.html\u003c/code\u003e 中加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;header\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e{{ .Title }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eh2\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e{{ .Description }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eh2\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003efont\u003c/span\u003e \u003cspan class=\"na\"\u003estyle\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;font-family: \u0026#39;STKaiti\u0026#39;;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e创建于 {{ .Date.Format \u0026#34;2006-01-02\u0026#34; }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e |\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e修改于 {{ .Lastmod.Format \u0026#34;2006-01-02\u0026#34; }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e |\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e总字数 {{ .WordCount }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e |\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e预估阅读时长 {{ .ReadingTime }} 分钟\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espan\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e |\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003efont\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ediv\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e.Date：数据取自博客顶端的配置 \u003ccode\u003edate\u003c/code\u003e 字段的值，使用 \u003ccode\u003e2006-01-02\u003c/code\u003e 格式进行格式化。\u003c/li\u003e\n\u003cli\u003e.Lastmod：如果在博客顶端的配置中设置 \u003ccode\u003elastmod\u003c/code\u003e 字段，则数据取自 \u003ccode\u003elastmod\u003c/code\u003e 字段的值，使用 \u003ccode\u003e2006-01-02\u003c/code\u003e 格式进行格式化。\u003c/li\u003e\n\u003cli\u003e.WordCount：文章中的字数。\u003c/li\u003e\n\u003cli\u003e.ReadingTime：预估的阅读时长，以分钟为单位。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e3、博客字数和阅读时长统计显示效果如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/word_count.png\" width=\"800px\" height=\"300px\" /\u003e\n图 3 · 博客字数和阅读时长统计显示效果\n\u003c/center\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://ibruce.info/2015/04/04/busuanzi/\"\u003ehttp://ibruce.info/2015/04/04/busuanzi/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://valine.js.org/quickstart.html\"\u003ehttps://valine.js.org/quickstart.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.smslit.top/2018/07/08/hugo-valine/\"\u003ehttps://www.smslit.top/2018/07/08/hugo-valine/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.yangcs.net/posts/hugo-add-busuanzi/\"\u003ehttps://www.yangcs.net/posts/hugo-add-busuanzi/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/xr469786706/article/details/78166227\"\u003ehttps://blog.csdn.net/xr469786706/article/details/78166227\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://note.qidong.name/2017/06/24/hugo-word-count/\"\u003ehttp://note.qidong.name/2017/06/24/hugo-word-count/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gohugo.io/content-management/front-matter/\"\u003ehttps://gohugo.io/content-management/front-matter/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/heartnn/hugo-theme-test\"\u003ehttps://github.com/heartnn/hugo-theme-test\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gohugo.io/getting-started/configuration/\"\u003ehttps://gohugo.io/getting-started/configuration/\u003c/a\u003e\u003c/p\u003e","date":1557792000,"description":"","fuzzywordcount":2600,"kind":"page","lang":"zh","lastmod":1578314914,"objectID":"6abc7d921a10c241e9427d5192e2aa4a","publishdate":1557792000,"relpermalink":"/posts/mixed/github_hugo_2/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍了使用 Hugo 和 GitHub搭建个人网站的一些高级功能，包括在云端存储图片、评论功能、网站统计、阅读数量统计、文字统计和阅读时长预估等功能。\u003c/p\u003e","tags":["GitHub","Hugo"],"title":"基于 Hugo 和 GitHub 搭建个人网站（二）","url":"https://xdhuxc.github.io/posts/mixed/github_hugo_2/","wordcount":2551},{"categories":"posts","content":"\u003cp\u003e摘要：\u003c/p\u003e\n\u003cp\u003e　　本篇博客主要介绍一些电子写作中常用的操作小技巧，或许会在日常写作或者撰写文档时用到。\u003c/p\u003e\n\u003ch3 id=\"在-markdown-中首段缩进两个汉字\"\u003e在 markdown 中首段缩进两个汉字\u003c/h3\u003e\n\u003cp\u003e　　由于 markdown 标记语言是外国人发明的，英文写作首段不空字符，而我们使用 \u003ccode\u003emarkdown\u003c/code\u003e 标记语言进行中文写作时，一般首段都要缩进两个汉字。于是，我们就有了这样一个需求，在使用 \u003ccode\u003emarkdown\u003c/code\u003e 进行中文写作时，在首段缩进两个汉字的长度，但是由于 markdown 本身的特性，直接按空格键是不行的，需要采用特殊的方式才能实现。\u003c/p\u003e\n\u003cp\u003e以下我们介绍两种方法\u003c/p\u003e\n\u003cp\u003e1、使用 \u003ccode\u003e\u0026amp;nbsp;\u003c/code\u003e 来实现，由于 markdown 最终是被转换成 HTML 来显示的，而且其本身也兼容 HTML，所以我们可以使用 HTML 中的 \u003ccode\u003e\u0026amp;nbsp;\u003c/code\u003e 来实现缩进效果，大体上来看，8 个 \u003ccode\u003e\u0026amp;nbsp;\u003c/code\u003e 可以实现两个汉字缩进的效果，如下所示：\u003c/p\u003e\n\u003cp\u003e        乾坤（\u003ccode\u003e乾坤\u003c/code\u003e 前面有 8 个 \u003ccode\u003e\u0026amp;nbsp;\u003c/code\u003e）\u003c/p\u003e\n\u003cp\u003e天人合一（已经左端对齐）\u003c/p\u003e\n\u003cp\u003e这种方法比较麻烦，每段开头都要有　8 个 \u003ccode\u003e\u0026amp;nbsp;\u003c/code\u003e，但是显示效果有保证。\u003c/p\u003e\n\u003cp\u003e2、将输入法切换为　\u003ccode\u003e全角\u003c/code\u003e，然后使用空格键，按两次空格键，可以直接实现两个汉字的缩进效果，注意不要使用　Tab 键进行操作，可自行测试观察效果。这种方法比第一种方法简洁方便，但是有时效果不太理想。\u003c/p\u003e\n\u003ch3 id=\"在句子中插入中--号\"\u003e在句子中插入中 \u003ccode\u003e·\u003c/code\u003e 号\u003c/h3\u003e\n\u003cp\u003e　　在文档中书写外国人名或者书名时，经常会用到中 \u003ccode\u003e·\u003c/code\u003e 号，但是键盘上 \u003ccode\u003e1\u003c/code\u003e 前面的中 \u003ccode\u003e·\u003c/code\u003e 需要使用快捷键配合打出，有时可能无法使用。这时，我们可以在中文输入法下，输入 \u003ccode\u003edian\u003c/code\u003e，如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/point.png\" width=\"800px\" height=\"300px\" /\u003e\n图 1 · 输入中 `·` 号\n\u003c/center\u003e\n\u003cp\u003e然后选择中 \u003ccode\u003e·\u003c/code\u003e 前的数字序号 5，就可以很方便地输入中\u003ccode\u003e·\u003c/code\u003e号了。\u003c/p\u003e","date":1557792000,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1557792000,"objectID":"115ca04578cac9aa47833689ecaf03b0","publishdate":1557792000,"relpermalink":"/posts/mixed/little_tips/","section":"posts","summary":"\u003cp\u003e摘要：\u003c/p\u003e\n\u003cp\u003e　　本篇博客主要介绍一些电子写作中常用的操作小技巧，或许会在日常写作或者撰写文档时用到。\u003c/p\u003e","tags":["Markdown"],"title":"Markdown 写作时输入小技巧","url":"https://xdhuxc.github.io/posts/mixed/little_tips/","wordcount":581},{"categories":"posts","content":"\u003cp\u003e本篇博客分别介绍了使用原生方式和基于 docker 容器方式部署 prometheus 的方法。\u003c/p\u003e\n\u003ch3 id=\"原生方式部署\"\u003e原生方式部署\u003c/h3\u003e\n\u003ch4 id=\"下载安装包\"\u003e下载安装包\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://github.com/prometheus/prometheus/releases/download/v2.5.0/prometheus-2.5.0.linux-amd64.tar.gz\nwget https://github.com/prometheus/node_exporter/releases/download/v0.16.0/node_exporter-0.16.0.linux-amd64.tar.gz\nwget https://github.com/prometheus/alertmanager/releases/download/v0.15.3/alertmanager-0.15.3.linux-amd64.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"启动服务\"\u003e启动服务\u003c/h4\u003e\n\u003cp\u003e1、 启动 prometheus\u003c/p\u003e\n\u003cp\u003eprometheus.yml\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# my global config\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eglobal:\n  scrape_interval:     15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.\n  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.\n  # scrape_timeout is set to the global default (10s).\n\n\u003cspan class=\"gh\"\u003e# Alertmanager configuration\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ealerting:\n  alertmanagers:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets:\n      \u003cspan class=\"k\"\u003e-\u003c/span\u003e alertmanager:9093\n\n\u003cspan class=\"gh\"\u003e# Load rules once and periodically evaluate them according to the global \u0026#39;evaluation_interval\u0026#39;.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003erule_files:\n  # - \u0026#34;first_rules.yml\u0026#34;\n  # - \u0026#34;second_rules.yml\u0026#34;\n\n\u003cspan class=\"gh\"\u003e# A scrape configuration containing exactly one endpoint to scrape:\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# Here it\u0026#39;s Prometheus itself.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003escrape_configs:\n  # The job name is added as a label \u003cspan class=\"sb\"\u003e`job=\u0026lt;job_name\u0026gt;`\u003c/span\u003e to any timeseries scraped from this config.\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;prometheus\u0026#39;\n    # metrics_path defaults to \u0026#39;/metrics\u0026#39;\n    # scheme defaults to \u0026#39;http\u0026#39;.\n\n    static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;192.168.33.10:9090\u0026#39;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 prometheus，默认会加载当前路径下的 prometheus.yaml 文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enohup ./prometheus \u0026gt;\u0026gt; prometheus.log \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后访问如下地址：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp:192.168.33.10:9090\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动 node_exporter\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eohup ./node_exporter \u0026gt;\u0026gt; node_exporter.log \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后访问如下地址：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://192.168.33.10:9100 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://192.168.33.10:9100/metrics\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 prometheus.yml 中加入如下配置，重启 prometheus\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003escrape_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;node_exporter\u0026#39;\n    static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;192.168.33.10:9100\u0026#39;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、部署 grafana\u003c/p\u003e\n\u003cp\u003e安装 grafana\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo yum install https://s3-us-west-2.amazonaws.com/grafana-releases/release/grafana-5.1.4-1.x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 grafana 服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl start grafana-server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后访问如下地址：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://192.168.33.10:3000 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以 \u003ccode\u003eadmin/admin\u003c/code\u003e 登录进去\u003c/p\u003e\n\u003cp\u003e然后添加数据源，将 prometheus 相关信息填写进去。\u003c/p\u003e\n\u003ch4 id=\"容器方式部署\"\u003e容器方式部署\u003c/h4\u003e\n\u003cp\u003e1、启动 prometheus 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d --restart=always --name=prometheus --network=host -v /data/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml prom/prometheus\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e为了便于和其他容器通信，使用 host 网络模式启动 prometheus 容器。\u003c/p\u003e\n\u003cp\u003e2、启动 node_exporter 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d -p 9100:9100 prom/node-exporter\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将如下连接信息写入 prometheus.yml 中，重启 prometheus 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003escrape_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;node_exporter\u0026#39;\n  static_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;192.168.33.10:9100\u0026#39;]\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e job:\n  static_configs:\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 grafana 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d --restart=always --name=grafana -p 3000:3000 grafana/grafana\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、启动 clickhouse 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 启动 clickhouse-server\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edocker run -d -p 8123:8123 -p 9000:9000 -p 9009:9009 --name clickhouse-server --ulimit nofile=262144:262144 yandex/clickhouse-server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、启动 clickhouse_exporter 容器，需要指定 clickhouse 的地址\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d -p 9116:9116 f1yegor/clickhouse-exporter -scrape_uri=http://192.168.33.10:8123/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、以 \u003ccode\u003eadmin/admin\u003c/code\u003e 登录进 grafana，导入 clickhouse 的 dashboard 文件，文件地址为：https://grafana.com/dashboards/882\u003c/p\u003e","date":1557446400,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1575936000,"objectID":"41da0df119f2056fdd8f84f2f6eadacb","publishdate":1557446400,"relpermalink":"/posts/devops/prometheus/prometheus-native-docker-install/","section":"posts","summary":"\u003cp\u003e本篇博客分别介绍了使用原生方式和基于 docker 容器方式部署 prometheus 的方法。\u003c/p\u003e","tags":["DevOps","Prometheus"],"title":"使用原生方式和基于 docker 容器方式部署 prometheus","url":"https://xdhuxc.github.io/posts/devops/prometheus/prometheus-native-docker-install/","wordcount":592},{"categories":"posts","content":"\u003cp\u003e摘要：\n　　本篇文章介绍了基于 GitHub 和 Hugo 搭建个人网站的具体操作过程，其中有诸多的注意事项，另外，对原有的模板和配置进行了一些改动，还附加了很多可以优化的地方。\u003c/p\u003e\n\u003ch3 id=\"hugo-的安装的基本使用\"\u003eHugo 的安装的基本使用\u003c/h3\u003e\n\u003cp\u003e1、准备工作，创建工作目录 \u003ccode\u003eblog\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:~ wanghuan$ mkdir blog\nwanghuans-MacBook-Pro:blog wanghuan$ pwd\n/Users/wanghuan/blog\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、安装 Hugo\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:blog wanghuan$ brew install hugo   # 安装 hugo\nUpdating Homebrew...\n==\u0026gt; Auto-updated Homebrew!\nUpdated 1 tap (homebrew/core).\n==\u0026gt; Updated Formulae\nallure\n\n==\u0026gt; Downloading https://homebrew.bintray.com/bottles/hugo-0.55.5.mojave.bottle.tar.gz\n==\u0026gt; Downloading from https://akamai.bintray.com/2c/2c88f996c36157b5e451274663b867ad4e1c3f6f04c57d1d43cdd8c631a5b209?__gda__=exp=1557368278~hmac=afe54c6d07b0ae0a78089e030533b7dae7\n\u003cspan class=\"gu\"\u003e######################################################################## 100.0%\n\u003c/span\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e==\u0026gt; Pouring hugo-0.55.5.mojave.bottle.tar.gz\n==\u0026gt; Caveats\nBash completion has been installed to:\n  /usr/local/etc/bash_completion.d\n==\u0026gt; Summary\n🍺  /usr/local/Cellar/hugo/0.55.5: 31 files, 40.7MB\n==\u0026gt; \u003cspan class=\"sb\"\u003e`brew cleanup`\u003c/span\u003e has not been run in 30 days, running now...\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/dep--0.5.0.mojave.bottle.tar.gz... (3.2MB)\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/gettext--0.19.8.1.high_sierra.bottle.tar.gz... (7.8MB)\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/libunistring--0.9.10.mojave.bottle.tar.gz... (1.4MB)\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/nginx--1.15.8.mojave.bottle.3.tar.gz... (1.2MB)\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/openssl--1.0.2q.mojave.bottle.tar.gz... (3.7MB)\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/pcre2--10.32.high_sierra.bottle.tar.gz... (1.8MB)\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/telnet--60.mojave.bottle.tar.gz... (52.5KB)\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/tree--1.8.0.high_sierra.bottle.tar.gz... (50.5KB)\nRemoving: /Users/wanghuan/Library/Caches/Homebrew/portable-ruby-2.3.7.leopard_64.bottle.tar.gz... (12.4MB)\nRemoving: /Users/wanghuan/Library/Logs/Homebrew/ucl... (64B)\nRemoving: /Users/wanghuan/Library/Logs/Homebrew/upx... (64B)\nRemoving: /Users/wanghuan/Library/Logs/Homebrew/nginx... (64B)\nRemoving: /Users/wanghuan/Library/Logs/Homebrew/pcre... (64B)\nwanghuans-MacBook-Pro:Blog wanghuan$ hugo version   # 查看 hugo 的版本\nHugo Static Site Generator v0.55.5/extended darwin/amd64 BuildDate: unknown\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、创建网站\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:blog wanghuan$ hugo new site xdhuxc\nCongratulations! Your new Hugo site is created in /Users/wanghuan/blog/xdhuxc.\n\nJust a few more steps and you\u0026#39;re ready to go:\n\n\u003cspan class=\"k\"\u003e1.\u003c/span\u003e Download a theme into the same-named folder.\n   Choose a theme from https://themes.gohugo.io/, or\n   create your own with the \u0026#34;hugo new theme \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eTHEMENAME\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34; command.\n\u003cspan class=\"k\"\u003e2.\u003c/span\u003e Perhaps you want to add some content. You can add single files\n   with \u0026#34;hugo new \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eSECTIONNAME\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e/\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eFILENAME\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eFORMAT\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34;.\n\u003cspan class=\"k\"\u003e3.\u003c/span\u003e Start the built-in live server via \u0026#34;hugo server\u0026#34;.\n\nVisit https://gohugo.io/ for quickstart guide and full documentation.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、安装主题\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:blog wanghuan$ cd xdhuxc/themes/\nwanghuans-MacBook-Pro:themes wanghuan$ git clone https://github.com/yoshiharuyamashita/blackburn.git\nCloning into \u0026#39;blackburn\u0026#39;...\nremote: Enumerating objects: 25, done.\nremote: Counting objects: 100% (25/25), done.\nremote: Compressing objects: 100% (14/14), done.\nremote: Total 908 (delta 14), reused 17 (delta 11), pack-reused 883\nReceiving objects: 100% (908/908), 469.15 KiB | 53.00 KiB/s, done.\nResolving deltas: 100% (563/563), done.\nwanghuans-MacBook-Pro:xdhuxc wanghuan$ pwd\n/Users/wanghuan/blog/xdhuxc\nwanghuans-MacBook-Pro:xdhuxc wanghuan$ ls\narchetypes\tconfig.toml\tcontent\t\tdata\t\tlayouts\t\tstatic\t\tthemes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e目录及文件说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003earchetypes：包括内容类型，在创建新内容时自动生成内容的配置。\u003c/li\u003e\n\u003cli\u003econtent：包括网站内容，全部使用 markdown 格式。\u003c/li\u003e\n\u003cli\u003elayouts：包括了网站的模板，决定内容如何呈现。\u003c/li\u003e\n\u003cli\u003estatic：包括了 css，js，fonts，media 等，决定网站的外观。\u003c/li\u003e\n\u003cli\u003ethemes：保存下载的网站主题。\u003c/li\u003e\n\u003cli\u003econfig.toml：网站的配置文件，包括 baseurl，title，copyright 等网站参数。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在 \u003ccode\u003econfig.toml\u003c/code\u003e 中加入如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebaseurl = \u0026#34;https://xdhuxc.github.io/\u0026#34; # Make sure to end baseurl with a \u0026#39;/\u0026#39;\ntitle = \u0026#34;xdhuxc\u0026#34;\nauthor = \u0026#34;xdhuxc\u0026#34;\n\u003cspan class=\"gh\"\u003e# Shown in the side menu\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecopyright = \u0026#34;\u003cspan class=\"ni\"\u003e\u0026amp;copy;\u003c/span\u003e 2019. xdhuxc All rights reserved.\u0026#34;\ncanonifyurls = true\npaginate = 10\n\n[indexes]\n  tag = \u0026#34;tags\u0026#34;\n  topic = \u0026#34;topics\u0026#34;\n\n[params]\n  # Shown in the home page\n  subtitle = \u0026#34;技术 - 文章\u0026#34;\n  brand = \u0026#34;xdhuxc\u0026#34;\n  googleAnalytics = \u0026#34;Your Google Analytics tracking ID\u0026#34;\n  disqus = \u0026#34;Your Disqus shortname\u0026#34;\n  # CSS name for highlight.js\n  highlightjs = \u0026#34;androidstudio\u0026#34;\n  highlightjs_extra_languages = [\u0026#34;yaml\u0026#34;]\n  dateFormat = \u0026#34;02 Jan 2006, 15:04\u0026#34;\n  # Include any custom CSS and/or JS files\n  # (relative to /static folder)\n  # custom_css = [\u0026#34;css/my.css\u0026#34;]\n  # custom_js = [\u0026#34;js/my.js\u0026#34;]\n\n  [params.piwikAnalytics]\n    siteid = 2\n    piwikroot = \u0026#34;//analytics.example.com/\u0026#34;\n\n[menu]\n  # Shown in the side menu.\n  [[menu.main]]\n    name = \u0026#34;主页\u0026#34;\n    pre = \u0026#34;\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;fa fa-home fa-fw\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34;\n    weight = 1\n    identifier = \u0026#34;home\u0026#34;\n    url = \u0026#34;/\u0026#34;\n  [[menu.main]]\n    name = \u0026#34;博客\u0026#34;\n    pre = \u0026#34;\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;fa fa-list fa-fw\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34;\n    weight = 2\n    identifier = \u0026#34;post\u0026#34;\n    url = \u0026#34;/post/\u0026#34;\n  [[menu.main]]\n    name = \u0026#34;关于\u0026#34;\n    pre = \u0026#34;\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;fa fa-user fa-fw\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34;\n    weight = 3\n    identifier = \u0026#34;about\u0026#34;\n    url = \u0026#34;/about/\u0026#34;\n  [[menu.main]]\n    name = \u0026#34;联系作者\u0026#34;\n    pre = \u0026#34;\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#39;fa fa-phone fa-fw\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34;\n    weight = 4\n    url = \u0026#34;/contact/\u0026#34;\n\n[social]\n  # Link your social networking accounts to the side menu\n  # by entering your username or ID.\n  # Techie\n  github = \u0026#34;xdhuxc\u0026#34;\n  gitlab = \u0026#34;*\u0026#34;\n  bitbucket = \u0026#34;*\u0026#34;\n  stackoverflow = \u0026#34;*\u0026#34;\n  serverfault = \u0026#34;*\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e[social]\u003c/code\u003e 部分的键值将渲染到 \u003ccode\u003elayouts/partials/social.html\u003c/code\u003e 文件中，和各种网站的域名组合起来，作为作者本人在各种网站中的主页的路径；在该文件中删除无用的网站信息，只保留作者自己有效地网站主页。\u003c/p\u003e\n\u003cp\u003e将 \u003ccode\u003ethemes/blackburn\u003c/code\u003e 目录下的 \u003ccode\u003estatic\u003c/code\u003e 和 \u003ccode\u003elayouts\u003c/code\u003e 目录中的内容复制到 \u003ccode\u003exdhuxc\u003c/code\u003e 目录下的同名目录中。\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003econtent/post\u003c/code\u003e 目录中撰写 \u003ccode\u003emarkdown\u003c/code\u003e 格式的文档，在每个 \u003ccode\u003e.md\u003c/code\u003e 文档的最上方加入类似如下内容，用于设置文章属性：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e+++\ntitle = \u0026#34;Ansible 学习之常用模块\u0026#34;     # 文章标题。\nlinktitle = \u0026#34;Ansible 学习之常用模块\u0026#34;\ndate = \u0026#34;2018-05-02\u0026#34;                # 在菜单 \u0026#34;博客\u0026#34; 中，文章按时间顺序排列，会自动增加时间标签，页面上默认显示n篇最新的文章。\ndraft = false                      # 设置为 false 的时候会被编译为 HTML，设置为 true 则不会被编译和发表。\ndescription = \u0026#34;\u0026#34;\ntags = [                           \n    \u0026#34;ansible\u0026#34;,\n    \u0026#34;DevOps\u0026#34;,\n    \u0026#34;IT\u0026#34;\n]                                  # 文章的标签，可以设置多个，用逗号分隔开，Hugo 会自动在博客主页下生成标签的子 URL，通过这个 URL，可以看到所有具有该标签的文章。\ncategories = [\n    \u0026#34;ansible\u0026#34;,\n    \u0026#34;DevOps\u0026#34;,\n]                                  # 文章分类。\n+++\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ebaseurl 的值在本地测试时无关紧要，但是当部署到 GitHub 上时，需要将其配置为 xdhuxc.github.io 这样的域名。另外，如果使用自有域名，还需要在 GitHub 上进行关联，具体方法可参考：https://help.github.com/en/articles/using-a-custom-domain-with-github-pages\u003c/p\u003e\n\u003cp\u003e5、启动网站\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehugo server --buildDrafts -w\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-w：监视文件内容的变化，如果此后修改了网站的内容，会直接显示在浏览器的页面上，不需要重新启动 hugo 进程，方便我们进行修改，但是不能监测 config.toml 文件中的参数变化。\u003c/li\u003e\n\u003cli\u003e--buildDrafts：生成被标记为草稿的页面。\u003c/li\u003e\n\u003cli\u003e-t hyde：使用 hyde 主题。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"使用-github-pages-托管网站\"\u003e使用 GitHub Pages 托管网站\u003c/h3\u003e\n\u003cp\u003e1、在 GitHub 上创建代码仓库，托管 Hugo 的输入文件，将 blog 目录下的所有文件存储到该仓库中，在 \u003ccode\u003e.gitignore\u003c/code\u003e 文件中写入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e.idea\n.DS_Store\npublic/*\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在 GitHub 上创建代码仓库，用于托管 public 目录，此处仓库的名称一定要用自己的用户名，例如 xdhuxc.github.io，只有这样，才会被 GitHub 当做是个人主页。\u003c/p\u003e\n\u003cp\u003e3、编译 blog 工程，生成 public 目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MBP:blog wanghuan$ pwd\n/Users/wanghuan/WebstormProjects/blog\nwanghuans-MBP:blog wanghuan$ ls\nREADME.md       config.toml     data            layouts         resources       themes\narchetypes      content         images          public          static\nwanghuans-MBP:blog wanghuan$ hugo\n\n                   | EN  \n+------------------+----+\n  Pages            | 40  \n  Paginator pages  |  0  \n  Non-page files   |  0  \n  Static files     |  8  \n  Processed images |  0  \n  Aliases          |  1  \n  Sitemaps         |  1  \n  Cleaned          |  0  \n\nTotal in 98 ms\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、将 \u003ccode\u003epublic\u003c/code\u003e 目录添加为子模块，与 \u003ccode\u003exdhuxc.github.io\u003c/code\u003e 同步\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MBP:blog wanghuan$ rm -rf public/\nwanghuans-MBP:blog wanghuan$ git submodule add git@github.com:xdhuxc/xdhuxc.github.io.git public\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、编译并推送至仓库 xdhuxc.github.io\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e82\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MBP:blog wanghuan$ hugo\n\n                   | EN  \n+------------------+----+\n  Pages            | 40  \n  Paginator pages  |  0  \n  Non-page files   |  0  \n  Static files     |  8  \n  Processed images |  0  \n  Aliases          |  1  \n  Sitemaps         |  1  \n  Cleaned          |  0  \n\nTotal in 33 ms\nwanghuans-MBP:blog wanghuan$ cd public/\nwanghuans-MBP:public wanghuan$ ls\nREADME.md       css             index.html      js              page            sitemap.xml     topics\ncontact         img             index.xml       media           post            tags\nwanghuans-MBP:public wanghuan$ git add -A\nwanghuans-MBP:public wanghuan$ git commit -m \u0026#34;initial the xdhuxc website\u0026#34;\n[master a3a6a28] initial the xdhuxc website\n 49 files changed, 9972 insertions(+)\n create mode 100644 contact/index.html\n create mode 100644 css/blackburn.css\n create mode 100644 css/side-menu-old-ie.css\n create mode 100644 css/side-menu.css\n create mode 100644 img/favicon.ico\n create mode 100644 index.html\n create mode 100644 index.xml\n create mode 100644 js/menus.js\n create mode 100644 js/ui.js\n create mode 100644 media/disqus.png\n create mode 100644 page/1/index.html\n create mode 100644 post/ansible-common-model/index.html\n create mode 100644 post/ansible-simple-use/index.html\n create mode 100644 post/centos7-install-mongodb/index.html\n create mode 100644 post/github_hugo/index.html\n create mode 100644 post/index.html\n create mode 100644 post/index.xml\n create mode 100644 post/linux-shell-execute/index.html\n create mode 100644 post/mongodb-simple-use/index.html\n create mode 100644 post/springboot-jmx/index.html\n create mode 100644 sitemap.xml\n create mode 100644 tags/ansible/index.html\n create mode 100644 tags/ansible/index.xml\n create mode 100644 tags/centos7/index.html\n create mode 100644 tags/centos7/index.xml\n create mode 100644 tags/database/index.html\n create mode 100644 tags/database/index.xml\n create mode 100644 tags/devops/index.html\n create mode 100644 tags/devops/index.xml\n create mode 100644 tags/github/index.html\n create mode 100644 tags/github/index.xml\n create mode 100644 tags/hugo/index.html\n create mode 100644 tags/hugo/index.xml\n create mode 100644 tags/index.html\n create mode 100644 tags/index.xml\n create mode 100644 tags/it/index.html\n create mode 100644 tags/it/index.xml\n create mode 100644 tags/jmx/index.html\n create mode 100644 tags/jmx/index.xml\n create mode 100644 tags/linux/index.html\n create mode 100644 tags/linux/index.xml\n create mode 100644 tags/mongodb/index.html\n create mode 100644 tags/mongodb/index.xml\n create mode 100644 tags/shell/index.html\n create mode 100644 tags/shell/index.xml\n create mode 100644 tags/springboot/index.html\n create mode 100644 tags/springboot/index.xml\n create mode 100644 topics/index.html\n create mode 100644 topics/index.xml\nwanghuans-MBP:public wanghuan$ git push origin master\nEnumerating objects: 81, done.\nCounting objects: 100% (81/81), done.\nDelta compression using up to 4 threads\nCompressing objects: 100% (68/68), done.\nWriting objects: 100% (80/80), 179.84 KiB | 396.00 KiB/s, done.\nTotal 80 (delta 34), reused 0 (delta 0)\nremote: Resolving deltas: 100% (34/34), done.\nTo github.com:xdhuxc/xdhuxc.github.io.git\n   07acdac..a3a6a28  master -\u0026gt; master\nwanghuans-MBP:public wanghuan$ \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、此时，访问 \u003ccode\u003ehttps://xdhuxc.github.io/\u003c/code\u003e，即可看到我们的网站。\u003c/p\u003e\n\u003ch3 id=\"优化\"\u003e优化\u003c/h3\u003e\n\u003ch4 id=\"菜单栏图标修改\"\u003e菜单栏图标修改\u003c/h4\u003e\n\u003cp\u003e我们在左侧菜单部分去除了默认含有的 Twitter，Facebook等，新加了微信和简书，但是其使用的图标却不是图片，而是使用 CSS 渲染出来的。在 \u003ca href=\"https://fontawesome.com/\"\u003ehttps://fontawesome.com/\u003c/a\u003e 上搜索图标，找到微信的图标所对应的 CSS class，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fab fa-weixin\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将其修改至 \u003ccode\u003elayouts/partials/social.html\u003c/code\u003e 中如下部分：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{{ with .Site.Social.wechat }}\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eli\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;pure-menu-item\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ea\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;pure-menu-link\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;https://github.com/{{ . }}\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003erel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;me\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003etarget\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;_blank\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e \u003cspan class=\"na\"\u003eclass\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;fa fa-weixin fa-fw\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e微信\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eli\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n{{ end }}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e该网站上没有简书的图标，可以随便找一个图标填充之。\u003c/p\u003e\n\u003ch4 id=\"博客的时间格式优化\"\u003e博客的时间格式优化，\u003c/h4\u003e\n\u003cp\u003e1、默认情况下，首页中博客的时间格式是这样的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e25 Oct 2018, 00:00\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e包含英文，不易为国人识别，我们可以将其改造为常用的日期格式，修改 \u003ccode\u003elayouts/partials/post_meta.html\u003c/code\u003e 文件中如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e{{ with .Site.Params.dateFormat }}{{ $.Date.Format . }}{{ else }}{{ .Date.Format \u0026#34;02 Jan 2006, 15:04\u0026#34; }}{{ end }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e改为\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e{{ with .Site.Params.dateFormat }}{{ $.Date.Format \u0026#34;2006-01-02\u0026#34; }}{{ else }}{{ .Date.Format \u0026#34;2006-01-02\u0026#34; }}{{ end }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果需要时分秒，可以改为如下格式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e{{ with .Site.Params.dateFormat }}{{ $.Date.Format \u0026#34;2006-01-02 15:04:05\u0026#34; }}{{ else }}{{ .Date.Format \u0026#34;2006-01-02 15:04:05\u0026#34; }}{{ end }}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、菜单 \u003ccode\u003e博客\u003c/code\u003e 中的博客列表中的时间默认情况下的格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e25 Oct 2018, 00:00\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 config.toml 中将 \u003ccode\u003edateFormat\u003c/code\u003e 的值由 \u003ccode\u003e02 Jan 2006, 15:04\u003c/code\u003e 修改为：\u003ccode\u003e2006-01-02\u003c/code\u003e，则其日期显示就变为：\u003ccode\u003e2019-05-09\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e3、如果想在 \u003ccode\u003e博客\u003c/code\u003e 菜单中按照月份显示自己的博客列表，可以对 \u003ccode\u003elayouts/post/post.html\u003c/code\u003e 进行修改，将\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{{ range .Data.Pages.GroupByDate \u0026#34;2006\u0026#34; }}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e改为\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{{ range .Data.Pages.GroupByDate \u0026#34;2006-01\u0026#34; }}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"自动化部署\"\u003e自动化部署\u003c/h4\u003e\n\u003cp\u003e编写脚本 \u003ccode\u003edeploy.sh\u003c/code\u003e（需要给脚本添加执行权限） 部署我们的网站，脚本内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eecho -e \u0026#34;\\033[0;32mDeploying updates to GitHub...\\033[0m\u0026#34;\n\n\u003cspan class=\"gh\"\u003e# Commit changes.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emsg=\u0026#34;change the website\u0026#39;s domain when it compiling\u0026#34;\nif [[ \u0026#34;$#\u0026#34; -eq 1 ]]; then\n    msg=\u0026#34;$1\u0026#34;\nfi\n\n\u003cspan class=\"gh\"\u003e# Push Hugo content\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003egit add -A\ngit commit -m \u0026#34;$msg\u0026#34;\ngit push origin master\n\n\n\u003cspan class=\"gh\"\u003e# Build the project.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ehugo # if using a theme, replace with \u003cspan class=\"sb\"\u003e`hugo -t \u0026lt;YOURTHEME\u0026gt;`\u003c/span\u003e\n\n\u003cspan class=\"gh\"\u003e# Go To Public folder\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecd public\n\u003cspan class=\"gh\"\u003e# Add changes to git.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003egit add .\n\n\ngit commit -m \u0026#34;$msg\u0026#34;\n\n\u003cspan class=\"gh\"\u003e# Push source and build repos.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003egit push origin master\n\n\u003cspan class=\"gh\"\u003e# Come Back up to the Project Root\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecd ..\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e本地编写 markdown 文件完成后，执行 \u003ccode\u003e./deploy.sh\u003c/code\u003e 脚本即可完成部署工作。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://nanshu.wang/post/2015-01-31/\"\u003ehttp://nanshu.wang/post/2015-01-31/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://jimmysong.io/posts/building-github-pages-with-hugo/\"\u003ehttps://jimmysong.io/posts/building-github-pages-with-hugo/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/e68fba58f75c\"\u003ehttps://www.jianshu.com/p/e68fba58f75c\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gohugo.io/hosting-and-deployment/hosting-on-github/\"\u003ehttps://gohugo.io/hosting-and-deployment/hosting-on-github/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gohugo.io/templates/internal/#google-analytics\"\u003ehttps://gohugo.io/templates/internal/#google-analytics\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.olowolo.com/post/hugo-quick-start/\"\u003ehttps://blog.olowolo.com/post/hugo-quick-start/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.pytool.com/language/golang/hugo/hugo/\"\u003ehttps://blog.pytool.com/language/golang/hugo/hugo/\u003c/a\u003e\u003c/p\u003e","date":1557360000,"description":"","fuzzywordcount":3100,"kind":"page","lang":"zh","lastmod":1557360000,"objectID":"836d4c747ba9049e0f3ca055ddfcc31d","publishdate":1557360000,"relpermalink":"/posts/mixed/github_hugo_1/","section":"posts","summary":"\u003cp\u003e摘要：\n　　本篇文章介绍了基于 GitHub 和 Hugo 搭建个人网站的具体操作过程，其中有诸多的注意事项，另外，对原有的模板和配置进行了一些改动，还附加了很多可以优化的地方。\u003c/p\u003e","tags":["GitHub","Hugo"],"title":"基于 Hugo 和 GitHub 搭建个人网站（一）","url":"https://xdhuxc.github.io/posts/mixed/github_hugo_1/","wordcount":3098},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下 golang 中常用的命令，在开发过程经常会用到。\u003c/p\u003e\n\u003ch3 id=\"交叉编译\"\u003e交叉编译\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build hello.go\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCGO_ENABLED：是否使用 C 语言版本的 GO 编译器，设置为 0 表示关闭 C 语言版本的编译器。如果在 GO 当中使用了 C 的库，默认使用 go build 的时候就会启用 CGO 编译器。\u003c/li\u003e\n\u003cli\u003eGOOS：目标操作系统。\u003c/li\u003e\n\u003cli\u003eGOARCH：目标操作系统的架构。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"常用命令\"\u003e常用命令\u003c/h3\u003e\n\u003cp\u003e1）\u003ccode\u003erun\u003c/code\u003e 用于编译并运行 go 文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego run main.go\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）安装 gocode，godef，guru\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego get -u github.com/nsf/gocode       # 安装 gocode，自动补全守护程序\ngo get -u github.com/rogpeppe/godef   # 安装 dodef\ngo get -u golang.org/x/tools/cmd/guru # 安装 guru\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）\u003ccode\u003ego mod\u003c/code\u003e 命令提供了访问模块的操作，使用方式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego mod \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e [\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003earguments\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e命令包括：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003einit：在当前目录下初始化新的模块，会生成 go.mod 文件。\u003c/li\u003e\n\u003cli\u003etidy：增加缺失或删除不用的模块。\u003c/li\u003e\n\u003cli\u003evendor：将依赖包复制到项目下的 vendor 目录下。\u003c/li\u003e\n\u003cli\u003edownload：下载模块到本地缓存。\u003c/li\u003e\n\u003cli\u003eedit：从工具或脚本来编辑 go.mod。\u003c/li\u003e\n\u003cli\u003egraph：打印模块依赖图。\u003c/li\u003e\n\u003cli\u003everify：验证依赖项具有预期的内容。\u003c/li\u003e\n\u003cli\u003ewhy：解释需要该包或者模块的原因。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e4）\u003ccode\u003eenv\u003c/code\u003e 用于修改 go 内置的环境变量，不能用于修改其他环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego env -w GOPRIVATE=\u0026#34;gitlab.xdhuxc.com\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e除 \u003ccode\u003eGOPATH\u003c/code\u003e 外，go 内置的环境变量不能使用 \u003ccode\u003eexport\u003c/code\u003e 来进行修改\u003c/p\u003e\n\u003ch3 id=\"基于-make-编译-go-工程\"\u003e基于 make 编译 go 工程\u003c/h3\u003e\n\u003cp\u003e1、进入 GOPATH 目录下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego env\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在 src 目录下的 github.com 目录下创建用户的目录，然后拉取代码，进行编译。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir f1yegor\ngit clone https://github.com/f1yegor/clickhouse_exporter.git\ncd clickhouse_exporter/\nmake build\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"govendor-的使用\"\u003egovendor 的使用\u003c/h3\u003e\n\u003cp\u003e1、安装 govendor\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego get -u -v github.com/kardianos/govendor\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、进入项目路径下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuan$ pwd\n/mtransformd\nwanghuan$ ls\nMakefile        conf.prod.yml   src\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、初始化 vendor 目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egovendor init\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、添加本工程使用到的依赖包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egovendor add +external\n或\ngovendor add +e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e添加指定包至 vendor 目录下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egovendor add github.com/jinzhu/gorm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003evendor.json：govendor 配置文件，记录依赖包列表\u003c/p\u003e\n\u003ch3 id=\"环境变量\"\u003e环境变量\u003c/h3\u003e\n\u003cp\u003egolang 环境变量\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eGOPRIVATE：指定不可公开获取的模块的路径，用作较低级别的 GONOPROXY 和 GONOSUMDB 变量的默认值，它们对通过代理获取并使用校验和数据库进行验证的模块提供了更细粒度的控制。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGOPROXY：可以设置为以逗号分隔的代理 URL 列表或特殊令牌 \u003ccode\u003edirect\u003c/code\u003e，默认值为：\u003ccode\u003ehttps://proxy.golang.org,direct\u003c/code\u003e，当解析一个包路径到它所包含的模块时，go 命令将顺序尝试列表中每个代理上的所有候选的模块路径。除 \u003ccode\u003e404\u003c/code\u003e 和 \u003ccode\u003e410\u003c/code\u003e 之外的不可访问代理或 HTTP 状态码将终止搜索，而不会再向其他代理搜索。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGOSUMDB：用于标识数据库的名称，以及可选的公用密钥和服务器URL，以查询尚未在主模块的 \u003ccode\u003ego.sum\u003c/code\u003e 文件中列出的模块的校验和。 如果 \u003ccode\u003eGOSUMDB\u003c/code\u003e 不包含显式 \u003ccode\u003eURL\u003c/code\u003e，则通过探测指示支持校验和数据库的端点的 \u003ccode\u003eGOPROXY URL\u003c/code\u003e 来选择 \u003ccode\u003eURL\u003c/code\u003e，如果任何代理均不支持直接连接到命名数据库，则选择 \u003ccode\u003eURL\u003c/code\u003e。 如果将 \u003ccode\u003eGOSUMDB\u003c/code\u003e 设置为 \u003ccode\u003eoff\u003c/code\u003e，则不查询校验和数据库，仅验证 \u003ccode\u003ego.sum\u003c/code\u003e 文件中现有的校验和。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e无法访问默认代理和校验数据库（例如，由于防火墙或沙河配置）的用户，可以通过将 GOPROXY 设置为 direct 和（或）将 GOSUMDB 设置为 off 来禁止其使用。\u003c/p\u003e\n\u003ch3 id=\"引用本地-gitlab-中的包\"\u003e引用本地 gitlab 中的包\u003c/h3\u003e\n\u003cp\u003e在最开始搭建项目的时候，将公司内部的一些公用包放到了 github 上，项目中引用 github 上的公共包，现在需要改造为引用公司内部 gitlab 上的。\u003c/p\u003e\n\u003cp\u003e经过一番探索，总结出步骤如下：\u003c/p\u003e\n\u003cp\u003e1、修改 \u003ccode\u003ego\u003c/code\u003e 环境变量：\u003ccode\u003ego env -w GOPRIVATE=\u0026quot;gitlab.ushareit.me\u0026quot;\u003c/code\u003e（\u003ccode\u003eGOPRIVATE\u003c/code\u003e 指定不可公开获取的模块的路径）\u003c/p\u003e\n\u003cp\u003e2、在代码中使用 \u003ccode\u003egitlab.xdhuxc.com/xdhuxc/xdhuxc-common\u003c/code\u003e 全文替换 \u003ccode\u003egithub.com/xdhuxc/xdhuxc-common\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e3、删除 \u003ccode\u003ego.mod\u003c/code\u003e 文件，重新生成之，依次执行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ego mod init\ngo mod tidy\ngo mod vendor\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、使用 \u003ccode\u003emake build\u003c/code\u003e 命令进行测试\u003c/p\u003e","date":1556496000,"description":"","fuzzywordcount":1400,"kind":"page","lang":"zh","lastmod":1567036800,"objectID":"223cdaee0fab4f2369bcdfc0d976c1bd","publishdate":1556496000,"relpermalink":"/posts/programming/golang/golang-command-and-operation/","section":"posts","summary":"\u003cp\u003e本篇博客记录下 golang 中常用的命令，在开发过程经常会用到。\u003c/p\u003e","tags":["Golang"],"title":"Golang 常用命令和操作总结","url":"https://xdhuxc.github.io/posts/programming/golang/golang-command-and-operation/","wordcount":1344},{"categories":"posts","content":"\u003cp\u003e摘要：\u003c/p\u003e\n\u003cp\u003e　　本篇文章是对最近社会讨论的 996.icu 问题的扩展，如果该问题继续被讨论下去，可能会涉及到这些问题。\u003c/p\u003e\n\u003cp\u003e        996.icu 问题应该被继续讨论下去。那么，也许就可能会讨论到下面这些问题吧。\u003c/p\u003e\n\u003cp\u003e　　如果法治思想，也就是说依靠法律的精神、思想、原则和条款来管理整个中国社会，不能够深入到每个中国人的思想深处，那么，马老师们和刘兄弟们的财产依靠什么来保护呢？所以，为了解决这个问题，马老师们和刘兄弟们最好是推动包括《中华人民共和国宪法》、《中华人民共和国劳动法》等法律的修改，为他们占据理论的至高点，这样其他人反对996或者007就没有绝对依据了。通过动用他们在政商学文娱等所谓“精英阶层”的力量，想必是不难办到的。至于理由嘛，在新零售、新技术等“五新”之外再增加两新，“新阶层”和“新生产方式”，然后让代言人渲染和论证现行法律不适应新的“七新”形势，就可以了。也许是因为共和国法律敛财有余、维稳过剩、治世无用，所以有司对996.icu问题从未正面回应，包括有赞年会直接挑战《中华人民共和国劳动法》。在法治社会，不是都供养了一大批专业的人来维护法律的尊严吗，工资及福利待遇是白给的吗？\u003c/p\u003e\n\u003cp\u003e　　再讨论下去，这个问题也许就变成了这样。\u003c/p\u003e\n\u003cp\u003e　　今年是中华人民共和国建国 70 周年。70 年来，共和国的发展取得了巨大的成功，整个中国社会已经拥有了巨量的社会财富，那么问题来了，这巨量的社会财富是怎么来的呢？从而它究竟属于谁？在整个中国社会内部应该怎么分配呢？也许在马老师们和刘兄弟们看来，这巨量的社会财富，肯定是他们政商学文娱等精英阶层在西方精英的指导下，创新和奋斗出来的呀，还有其他可能性吗？。接下来，让他们的代言人以各种方式去论证、扩展和渲染这种思想，然后就可以很方便地应对社会舆论了。阿里巴巴 2018 财年净利润为 614.12 亿元，这些利润应该都是归属于股东们的吧，它们是从哪里来的呢？不知道阿里巴巴的员工加班有没有加班费。\u003c/p\u003e\n\u003cp\u003e　　再讨论下去，这个问题就可能变成了这样。\u003c/p\u003e\n\u003cp\u003e　　共和国政府在整个中国社会中的价值导向问题，我们这个社会究竟应该崇尚什么，反对什么？价值观这种东西，当且仅当其作为资源和利益分配的依据的时候，才可能深入每个组织成员的内心，否则就只能给领导演讲时使用了。一方面将实实在在的资源和利益给权力和资本，另一方面，给广大劳动者讲情怀，鼓励大家修福报，这难道不是在侮辱这些996.icu们的智商吗？从中央电视台毕福剑事件，到2018年秋季的开学第一课，共和国政府在整个社会倡导什么样的价值观？如果一个时刻把劳动人民放在心上，始终为人民服务的人被整个社会踩在脚底下，被那些乱七八糟的人调侃，这些人还被称为“老师”，那只能说明996和007对中国人来说，还不够刺激，不够酸爽，这福报修的太少了。\u003c/p\u003e\n\u003cp\u003e　　再讨论下去，这个问题就可能变成了这样。\u003c/p\u003e\n\u003cp\u003e　　如果权力、资本和劳动的收益分配不能从顶层设计上合理地解决，不能让三方都基本满意，类似于996.icu的问题讨论就会继续下去，并且杂音会越来越多。在实践层面上，就是权力和资本必须向劳动让利，至于权力和资本之间的利益分配问题，则是另外的问题。如果问题不能得到实际解决，那么，产业升级、中国制造、以及中国梦依靠谁来实现呢，难道要让这些真的成为中国的梦吗？如果政府在这场讨论中缺席，或者给不出让大家满意的解释和解决方法，政府的公信力和社会地位就会继续降低。为什么有司对这个问题一直不发声，不表态呢？恐怕因为他们清楚这个问题的本质，也清楚从 github 上烧起来的这把火最终将不可避免地要烧向他们。权力和资本 与广大普通劳动人民之间的矛盾，由谁来解释和解决呢？\u003c/p\u003e\n\u003cp\u003e　　问题讨论到这里，基本就可以结束了。如果解决到这里，也就可以结束了。但是也可以有后记。\u003c/p\u003e\n\u003cp\u003e　　再讨论下去，这个问题就可能会变成这样。\u003c/p\u003e\n\u003cp\u003e　　同样是不懂资本主义，有些人依靠体制和组织的保障，高枕无忧；而有些人，已经离开了我们，有些人可能下一秒离开我们，不管他们是小孩、是老年人，还是其他人群，大体都是普通的中国老百姓。这些年来发生的很多恶性事件，无一不隐藏着权力和资本对广大普通中国人尊严、生命和财产的肆意蹂躏和践踏，但是很多人还是礼貌客气地声明自己不懂资本主义，其实他们的立场已经很明确了。稍微了解下美国人对于阿尔斯通、中兴及空客的手段，然后理解国家权力服务于资本的增殖，就很容易了，捎带着感悟下“响水爆炸事故”及假疫苗等等事件。现在及未来，有很多人将离开我们，而且是群体性的，人为的原因导致了这些结果，这是一定会发生的，其实他们本可以活得好好的。这并不是说，知道了资本主义，就可以避免这种事情的发生，我们还走在探寻原因和解决问题的路上。\u003c/p\u003e\n\u003cp\u003e　　再讨论下去，这个问题就可能变成了这样。\u003c/p\u003e\n\u003cp\u003e　　压迫和被压迫，剥削和被剥削，这种事情来源于什么？也就是《论人类不平等的起源和基础》，过程是怎样的呢？论述资本的产生及运动过程的《资本论》给出了描述，解决问题的理论和方法是什么？马克思主义和共产主义，但是现在似乎没多少人愿意相信了。似乎，人类为解决这个问题所进行的政治实践都凉凉了。毕竟，对于绝大多数政治人物来说，“我死后，哪管他洪水滔天”。从欧美的完全私有制，到苏联及共和国的完全公有制，再到今天世界范围内的的混合所有制，这种努力和探索的逻辑非常自然，依然在继续，但问题从来没有少过，而且还遇到了跨越国界和加速社会运行（从而也加速财富流动和转移）的互联网，问题更加复杂了。不知道这个世界上还有没有知识分子为这个问题而思考和努力？毫无疑问，依附于权力和资本赚钱来得更实在和容易些。\u003c/p\u003e\n\u003cp\u003e　　再讨论下去，这个问题就可能变成了这样。\u003c/p\u003e\n\u003cp\u003e　　权力、资本、技术和人的关系问题。从抽象逻辑上来讲，作为人的逻辑联合体的人类创造了前三者，却为这个联合体中的极少数群体占有，绝大多数人却处于压迫之下，甚至连最基本的生活都不能保障，家庭都不能建立和维持，也包括以互联网为代表的新兴技术更加温柔地残害了许多个体的人和社会，这是个可笑的事实。在古老的权力和人的力量体系中，加入资本，诞生了近现代的西方民主和法治（但从美国和乌克兰选举出毫无从政经验的总统来看，这种制度现在遇到了理论和实践上的麻烦），再加入技术，诞生了 google，facebook 等超越国家的互联网霸权，整个人类社会的力量体系和力量对比都在发生新的变化，总体上社会资源和利益是在向着更为普通人可接触和获得的方向发展，但是仍然不能令大家满意。应该是存在某种理论上的和实际上的解决方法，我们还没有找到或者客观条件还不具备！也可能，根本就不存在彻底解决该问题的方法，人类社会只能是在和这些东西的斗争中不断向前发展。\u003c/p\u003e\n\u003cp\u003e　　再讨论下去，这个问题可能就变成了这样。\u003c/p\u003e\n\u003cp\u003e　　人类消失之后，这颗星球会怎样，终于可以展开想象力自由地尽情想象推演了！\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://996.icu\"\u003ehttps://996.icu\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mp.weixin.qq.com/s/vPlFuB3wa1CW_uEXOOvExA\"\u003ehttps://mp.weixin.qq.com/s/vPlFuB3wa1CW_uEXOOvExA\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/996icu/996.ICU/blob/master/README_CN.md\"\u003ehttps://github.com/996icu/996.ICU/blob/master/README_CN.md\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://news.cnblogs.com/n/624092/\"\u003ehttps://news.cnblogs.com/n/624092/\u003c/a\u003e\u003c/p\u003e","date":1555113600,"description":"","fuzzywordcount":2700,"kind":"page","lang":"zh","lastmod":1555372800,"objectID":"7ae21dac67739e341afd7468e6d2383b","publishdate":1555113600,"relpermalink":"/posts/human/human-world-mixed-three/","section":"posts","summary":"\u003cp\u003e摘要：\u003c/p\u003e\n\u003cp\u003e　　本篇文章是对最近社会讨论的 996.icu 问题的扩展，如果该问题继续被讨论下去，可能会涉及到这些问题。\u003c/p\u003e","tags":["人间世"],"title":"人间世·杂三","url":"https://xdhuxc.github.io/posts/human/human-world-mixed-three/","wordcount":2696},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下在 Web 开发过程中常用的存储客户端数据的 SessionStorage，LocalStorage 和 Cookie 的异同，对于我们存储客户端数据时的选型很有帮助。\u003c/p\u003e\n\u003ch3 id=\"sessionstorage-localstorage-和-cookie-的异同\"\u003esessionStorage, localStorage 和 cookie 的异同\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e特性\u003c/th\u003e\n\u003cth\u003eCookie\u003c/th\u003e\n\u003cth\u003elocalStorage\u003c/th\u003e\n\u003cth\u003esessionStorage\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e数据的生命周期\u003c/td\u003e\n\u003ctd\u003e一般由服务器生成，可设置失效时间。如果在浏览器端生成 Cookie，默认是关闭浏览器后失效。\u003c/td\u003e\n\u003ctd\u003e除非被清除，否则永久保存。\u003c/td\u003e\n\u003ctd\u003e仅在当前会话下有效，关闭页面或浏览器后被清除，刷新页面数据依旧存在。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e存放数据大小\u003c/td\u003e\n\u003ctd\u003e4K左右\u003c/td\u003e\n\u003ctd\u003e一般为5MB\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e与服务器端通信\u003c/td\u003e\n\u003ctd\u003e每次都会携带在 HTTP 头中，如果使用 Cookie 保存过多数据会带来性能问题\u003c/td\u003e\n\u003ctd\u003e仅在客户端（即浏览器）中保存，不参与和服务器的通信\u003c/td\u003e\n\u003ctd\u003esdgsd\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e易用性\u003c/td\u003e\n\u003ctd\u003e需要程序员自己封装，原生的 Cookie 接口不友好\u003c/td\u003e\n\u003ctd\u003e原生接口可以接受，亦可再次封装对 Object 和 Array 有更好的支持\u003c/td\u003e\n\u003ctd\u003edsgd\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003elocalStorage 和 sessionStorage 是 HTML5 才应用的新特性，可能有些浏览器并不支持，需要注意：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e特性\u003c/th\u003e\n\u003cth\u003eChrome\u003c/th\u003e\n\u003cth\u003eFireFox\u003c/th\u003e\n\u003cth\u003eIE\u003c/th\u003e\n\u003cth\u003eOpera\u003c/th\u003e\n\u003cth\u003eSafari\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003elocalStorage\u003c/td\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003e3.5\u003c/td\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003e10.50\u003c/td\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003esessionStorage\u003c/td\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003e10.50\u003c/td\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://juejin.im/post/5a191c47f265da43111fe859\"\u003ehttps://juejin.im/post/5a191c47f265da43111fe859\u003c/a\u003e\u003c/p\u003e","date":1554076800,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1559433600,"objectID":"f5d30a8ffc46b665f7de3666a9c2f246","publishdate":1554076800,"relpermalink":"/posts/programming/web/sessionstorage-localstorage-cookie/","section":"posts","summary":"\u003cp\u003e本篇博客记录下在 Web 开发过程中常用的存储客户端数据的 SessionStorage，LocalStorage 和 Cookie 的异同，对于我们存储客户端数据时的选型很有帮助。\u003c/p\u003e","tags":["Web","SessionStorage","LocalStorage","Cookie"],"title":"sessionStorage，localStorage 和 Cookie 的异同","url":"https://xdhuxc.github.io/posts/programming/web/sessionstorage-localstorage-cookie/","wordcount":369},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了使用 prometheus 监控 etcd 的配置方法，还包括在 grafana 中显示 etcd 指标图标，以及基于 AlertManager 的报警配置。\u003c/p\u003e\n\u003ch3 id=\"使用-prometheus-监控-etcd-及报警\"\u003e使用 prometheus 监控 etcd 及报警\u003c/h3\u003e\n\u003ch4 id=\"前提条件\"\u003e前提条件\u003c/h4\u003e\n\u003cp\u003e1、已经部署好 etcd 环境（单节点或集群）\u003c/p\u003e\n\u003cp\u003e2、已经部署好 prometheus\u003c/p\u003e\n\u003cp\u003e3、已经部署好 grafana 并配置了数据源，数据源类型为：Prometheus，数据源名称为：prometheus\u003c/p\u003e\n\u003ch4 id=\"监控-etcd\"\u003e监控 etcd\u003c/h4\u003e\n\u003cp\u003egrafana dashboard 配置：\u003c/p\u003e\n\u003cp\u003e使用 \u003ca href=\"https://grafana.com/api/dashboards/3070/revisions/3/download\"\u003eetcd_rev3.json\u003c/a\u003e文件，修改其中的 datasource 为 Prometheus 数据源的名称，在 grafana 中导入该文件，可以将该 dashboard 命名为：etcd-monitor\u003c/p\u003e\n\u003cp\u003e在 etcd 中未配置证书的情况下，在 prometheus.yml 文件中增加如下配置内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eglobal:\n  scrape_interval:     15s\n  evaluation_interval: 15s\nscrape_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;prometheus\u0026#39;\n    static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;127.0.0.1:9090\u0026#39;]\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;etcd\u0026#39;\n    scheme: \u0026#39;http\u0026#39;    # 默认为：http，所以此处可省略\n    static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;172.27.126.226:2379\u0026#39;, \u0026#39;172.27.126.227:2379\u0026#39;, \u0026#39;172.27.126.228:2379\u0026#39;] # 以 YAML 数组方式填写 etcd 端点\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 prometheus\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003eetcd\u003c/code\u003e 中 配置证书的情况下，在 \u003ccode\u003eprometheus.yml\u003c/code\u003e 文件中增加如下配置内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eglobal:\n  scrape_interval:     15s\n  evaluation_interval: 15s\nscrape_configs:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;prometheus\u0026#39;\n    static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;127.0.0.1:9090\u0026#39;]\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e job_name: \u0026#39;etcd\u0026#39;\n    scheme: \u0026#39;https\u0026#39;   # 由于使用了证书，所以此处必须配置为：https\n    tls_config:\n      ca_file: \u0026#39;/etc/ssl/etcd/ca.pem\u0026#39;          # 这几处放置 etcd 证书文件路径，不能直接放置文件内容\n      cert_file: \u0026#39;/etc/ssl/etcd/client.pem\u0026#39;\n      key_file: \u0026#39;/etc/ssl/etcd/client-key.pem\u0026#39;\n    static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#39;172.27.126.226:2379\u0026#39;, \u0026#39;172.27.126.227:2379\u0026#39;, \u0026#39;172.27.126.228:2379\u0026#39;] # 以 YAML 数组方式填写 etcd 端点\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 prometheus\u003c/p\u003e\n\u003ch4 id=\"etcd-报警配置\"\u003eetcd 报警配置\u003c/h4\u003e\n\u003cp\u003e在 prometheus.yml 中添加 \u003ca href=\"https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/etcd3_alert.rules.yml\"\u003eetcd3_alert.yml\u003c/a\u003e 文件路径\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ealerting:\n  alertmanagers:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e static_configs:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e targets: [\u0026#34;127.0.0.1:9093\u0026#34;]\nrule_files:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e \u0026#39;/data/prometheus/etcd3_alert.yml\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1552348800,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1568073600,"objectID":"18774a48c5a1252ad0a23ebafb8ecfc4","publishdate":1552348800,"relpermalink":"/posts/devops/prometheus/prometheus-monitor-etcd/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了使用 prometheus 监控 etcd 的配置方法，还包括在 grafana 中显示 etcd 指标图标，以及基于 AlertManager 的报警配置。\u003c/p\u003e","tags":["etcd","prometheus"],"title":"使用 prometheus 监控 etcd","url":"https://xdhuxc.github.io/posts/devops/prometheus/prometheus-monitor-etcd/","wordcount":466},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 ElasticSearch API 的详细使用方法。\u003c/p\u003e\n\u003ch4 id=\"rest-api-用途\"\u003eREST API 用途\u003c/h4\u003e\n\u003cp\u003eelasticsearch 提供了很多全面的API，大致可以分为如下几种：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e检查集群、节点、索引的健康状况。\u003c/li\u003e\n\u003cli\u003e管理集群、节点、索引数据、元数据。\u003c/li\u003e\n\u003cli\u003e执行CRUD，创建、读取、更新、删除以及查询索引和索引模板等。\u003c/li\u003e\n\u003cli\u003e执行高级的查询操作、比如分页、排序、脚本和聚合等。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"常用命令\"\u003e常用命令\u003c/h4\u003e\n\u003cp\u003e1、查看集群健康状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl http://172.20.17.4:9200/_cat/health?v\nepoch      timestamp cluster               status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent \n1531817234 08:47:14  elasticsearch-cluster yellow          1         1    290 290    0    0      180             0                  -                 61.7% \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到集群的名字是：elasticsearch-cluster，集群的状态为：yellow。\u003c/p\u003e\n\u003cp\u003eelasticsearch 集群的颜色及含义：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e绿色：最健康的状态，代表所有的分片包括备份都可用。\u003c/li\u003e\n\u003cli\u003e黄色：基本的分片可用，但是备份不可用，也可能是没有备份。\u003c/li\u003e\n\u003cli\u003e红色：部分的分片可用，表明分片有一部分损坏，此时执行查询部分数据仍然可以查到，遇到这种情况，需要尽快解决。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2、查询节点列表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl http://172.20.17.4:9200/_cat/nodes?v\nhost        ip          heap.percent ram.percent load node.role master name                 \n172.20.17.4 172.20.17.4           17          99 5.06 d         *      elasticsearch-master \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查询所有索引\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl http://172.20.17.4:9200/_cat/indices?v\nhealth status index                               pri rep docs.count docs.deleted store.size pri.store.size \nyellow open   zipkin-2018-07-14                     5   1        180            0    182.4kb        182.4kb \nyellow open   yycloud-basedoc-mw-servmeta-private   5   1       2553          246     28.9mb         28.9mb \nred    open   zipkin-2018-07-17                     5   1  255069327            0     15.4gb         15.4gb \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e上面的结果中，zipkin-2018-07-14索引的状态是yellow，这是因为此时虽然有5个主分片和一个备份。但是由于只是单个节点，分片还在运行中，无法动态地修改。因此当有其他的节点加入到集群中时，备份的节点会被复制到另外一个节点中，状态就会变成 green。\u003c/p\u003e\n\u003cp\u003e4、删除索引\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl -XDELETE http://172.20.17.4:9200/zipkin-2018-07-14       # zipkin-2018-07-14为索引名称\n{\n    \u0026#34;acknowledged\u0026#34;:true\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、创建索引\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -u esadmin:esadmin -H \u0026#34;Content-Type: application/json\u0026#34; -XPOST http://${DCEE_IP}:9200/xdhuxc_custom -T ./xdhuxc_custom.json \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"索引模板\"\u003e索引模板\u003c/h4\u003e\n\u003cp\u003e1、查询 elasticsearch 索引模板\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -u esadmin:esadmin http://172.20.15.36:9200/_template?pretty # 返回所有索引模板，pretty 参数仅仅是指定Elasticsearch返回JSON格式结果\ncurl -XGET http://172.20.15.36:9200/_template/my_template \u003cspan class=\"ni\"\u003e#查询索引模板my_template\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、创建 elasticsearch 索引模板\u003c/p\u003e\n\u003cp\u003e创建一个名为my_template的模板,匹配所有my_index开头的索引,匹配成功后会按照settings和mappings创建一个新的索引.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -XPUT http://172.20.15.36:9200/_template/my_template -d\u0026#39;    \n{    \n        \u0026#34;template\u0026#34;: \u0026#34;my_index*\u0026#34;, //匹配所有my_index开头的索引    \n        \u0026#34;order\u0026#34;:0,//当存在多个索引模板时并且某个索引两者都匹配时,使用order来确定模板合并顺序  \n        \u0026#34;settings\u0026#34;: {...},    \n        \u0026#34;mappings\u0026#34; :{...}    \n}\u0026#39;\n或\ncurl -u esadmin:esadmin -XPUT http://172.20.15.36:9200/_template/developer_docker* -T ./developer_docker.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、删除 elasticsearch 索引模板\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -XDELETE http://172.20.15.36:9200/_template/my_template\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-node ~]# curl -v -H \u0026#34;Content-Type:application/json\u0026#34; http://10.10.24.75:9200/_cat/indices?v | python -m json.tool\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e About to connect() to 10.10.24.75 port 9200 (#0)\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e   Trying 10.10.24.75...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Connected to 10.10.24.75 (10.10.24.75) port 9200 (#0)\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eGET /_cat/indices?v HTTP/1.1\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eUser-Agent: curl/7.29.0\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eHost: 10.10.24.75:9200\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eAccept: */*\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eContent-Type:application/json\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u0026gt; \n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e \u003cspan class=\"na\"\u003e200\u003c/span\u003e \u003cspan class=\"na\"\u003eOK\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eContent-Type:\u003c/span\u003e \u003cspan class=\"na\"\u003eapplication\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003ejson\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003eUTF-8\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"na\"\u003eContent-Length:\u003c/span\u003e \u003cspan class=\"na\"\u003e337\u003c/span\u003e\n\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \n\u003cspan class=\"err\"\u003e{\u003c/span\u003e \u003cspan class=\"err\"\u003e[\u003c/span\u003e\u003cspan class=\"na\"\u003edata\u003c/span\u003e \u003cspan class=\"na\"\u003enot\u003c/span\u003e \u003cspan class=\"na\"\u003eshown\u003c/span\u003e\u003cspan class=\"err\"\u003e]\u003c/span\u003e\n\u003cspan class=\"na\"\u003e100\u003c/span\u003e   \u003cspan class=\"na\"\u003e337\u003c/span\u003e  \u003cspan class=\"na\"\u003e100\u003c/span\u003e   \u003cspan class=\"na\"\u003e337\u003c/span\u003e    \u003cspan class=\"na\"\u003e0\u003c/span\u003e     \u003cspan class=\"na\"\u003e0\u003c/span\u003e  \u003cspan class=\"na\"\u003e36050\u003c/span\u003e      \u003cspan class=\"na\"\u003e0\u003c/span\u003e \u003cspan class=\"na\"\u003e--:--:--\u003c/span\u003e \u003cspan class=\"na\"\u003e--:--:--\u003c/span\u003e \u003cspan class=\"na\"\u003e--:--:--\u003c/span\u003e \u003cspan class=\"na\"\u003e42125\u003c/span\u003e\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e \u003cspan class=\"na\"\u003eConnection\u003c/span\u003e \u003cspan class=\"ni\"\u003e#0\u003c/span\u003e \u003cspan class=\"na\"\u003eto\u003c/span\u003e \u003cspan class=\"na\"\u003ehost\u003c/span\u003e \u003cspan class=\"na\"\u003e10\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e10\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e24\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e75\u003c/span\u003e \u003cspan class=\"na\"\u003eleft\u003c/span\u003e \u003cspan class=\"na\"\u003eintact\u003c/span\u003e\n\u003cspan class=\"err\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003edocs\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecount\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003edocs\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edeleted\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003ehealth\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eyellow\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eindex\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003exdhuxc-app_2018-07-20\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003epri\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e5\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003epri\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003estore\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e795b\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003erep\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003estatus\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eopen\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003estore\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e795b\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e},\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003edocs\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecount\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003edocs\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003edeleted\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003ehealth\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eyellow\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eindex\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003exdhuxc-app_2018-07-19\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003epri\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e5\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003epri\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003estore\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e795b\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003erep\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003estatus\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eopen\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003estore\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esize\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e:\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003e795b\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\n    \u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003cspan class=\"err\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://blog.csdn.net/opensure/article/details/50824821\"\u003ehttp://blog.csdn.net/opensure/article/details/50824821\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://blog.sina.com.cn/s/blog_17943a64f0102x8x0.html\"\u003ehttp://blog.sina.com.cn/s/blog_17943a64f0102x8x0.html\u003c/a\u003e\u003c/p\u003e","date":1547078400,"description":"","fuzzywordcount":1200,"kind":"page","lang":"zh","lastmod":1550793600,"objectID":"a2e47b1499c6825186807fb44bafdc9c","publishdate":1547078400,"relpermalink":"/posts/storage/elasticsearch/elasticsearch-restful-api/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 ElasticSearch API 的详细使用方法。\u003c/p\u003e","tags":["ElasticSearch","数据库"],"title":"ElasticSearch REST API 的使用","url":"https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-restful-api/","wordcount":1110},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在使用 ElasticSearch 的过程中常见的问题及解决方法。\u003c/p\u003e\n\u003cp\u003e1、启动 elasticsearch 容器时，直接映射文件或目录时，报权限错误\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[2018-11-11T10:36:18,442][INFO ][o.e.n.Node               ] [] initializing ...\n[2018-11-11T10:36:18,462][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [] uncaught exception in thread [main]\nCaused by: java.nio.file.AccessDeniedException: /usr/share/elasticsearch/data/nodes\n        at sun.nio.fs.UnixException.translateToIOException(UnixException.java:84) ~[?:?]\n        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102) ~[?:?]\n        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107) ~[?:?]\n        at sun.nio.fs.UnixFileSystemProvider.createDirectory(UnixFileSystemProvider.java:384) ~[?:?]\n        at java.nio.file.Files.createDirectory(Files.java:674) ~[?:1.8.0_92-internal]\n        at java.nio.file.Files.createAndCheckIsDirectory(Files.java:781) ~[?:1.8.0_92-internal]\n        at java.nio.file.Files.createDirectories(Files.java:767) ~[?:1.8.0_92-internal]\n        at org.elasticsearch.env.NodeEnvironment.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e(NodeEnvironment.java:220) ~[elasticsearch-5.0.0.jar:5.0.0]\n        at org.elasticsearch.node.Node.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e(Node.java:240) ~[elasticsearch-5.0.0.jar:5.0.0]\n        at org.elasticsearch.node.Node.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e(Node.java:220) ~[elasticsearch-5.0.0.jar:5.0.0]\n        at org.elasticsearch.bootstrap.Bootstrap$5.\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e(Bootstrap.java:191) ~[elasticsearch-5.0.0.jar:5.0.0]\n        at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:191) ~[elasticsearch-5.0.0.jar:5.0.0]\n        at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:286) ~[elasticsearch-5.0.0.jar:5.0.0]\n        at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:112) ~[elasticsearch-5.0.0.jar:5.0.0]\n        ... 6 more\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e问题原因说明：https://discuss.elastic.co/t/elastic-elasticsearch-docker-not-assigning-permissions-to-data-directory-on-run/65812/4\u003c/p\u003e\n\u003cp\u003e解决：先创建一个卷，然后再挂载该目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker volume create --opt device=/root/es/data --name=xdhuxc\ndocker run -p 9200:9200 -v xdhuxc:/usr/share/elasticsearch/data docker.elastic.co/elasticsearch/elasticsearch:6.5.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果仍然出现错误，创建 elasticsearch 用户，给目录赋予权限，然后启动容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egroupadd -g 1000 elasticsearch\nuseradd -u 1000 -g 1000 elasticsearch\nchown -R 1000 es\nchgrp -r 1000 es\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、创建索引时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:~ wanghuan$ curl -H \u0026#34;Content-Type: application/json\u0026#34; -XPUT http://localhost:9200/xdhuxc_a -T ./a.json\n{\n    \u0026#34;error\u0026#34;:{\n        \u0026#34;root_cause\u0026#34;:[\n            {\n                \u0026#34;type\u0026#34;:\u0026#34;illegal_argument_exception\u0026#34;,\n                \u0026#34;reason\u0026#34;:\u0026#34;unknown setting [index.as] please check that any required plugins are installed, or check the breaking changes documentation for removed settings\u0026#34;\n            }\n        ],\n        \u0026#34;type\u0026#34;:\u0026#34;illegal_argument_exception\u0026#34;,\n        \u0026#34;reason\u0026#34;:\u0026#34;unknown setting [index.as] please check that any required plugins are installed, or check the breaking changes documentation for removed settings\u0026#34;,\n        \u0026#34;suppressed\u0026#34;:[\n            {\n                \u0026#34;type\u0026#34;:\u0026#34;illegal_argument_exception\u0026#34;,\n                \u0026#34;reason\u0026#34;:\u0026#34;unknown setting [index.sdfsdg] please check that any required plugins are installed, or check the breaking changes documentation for removed settings\u0026#34;\n            }\n        ]\n    },\n    \u0026#34;status\u0026#34;:400\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ea.json 的内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n    \u0026#34;container_id\u0026#34; : \u0026#34;30855c6b7ea297a3e8ed2d62b7bc489d9712cd57e70d90b1d229e5c6932987a6\u0026#34;,\n    \u0026#34;container_name\u0026#34; : \u0026#34;/is-live.1.yyk840n4mkd4x9fr53wt0tqh0\u0026#34;,\n    \u0026#34;source\u0026#34; : \u0026#34;stdout\u0026#34;,\n    \u0026#34;log\u0026#34; : \u0026#34;2019-05-14 19:42:24.028 ERROR 1 --- [io-2062-exec-88] c.k.i.l.c.websocket.BarrageWebSocket     : BarrageWebSocket error\u0026#34;,\n    \u0026#34;timestamp\u0026#34; : \u0026#34;2019-05-14T19:42:24.028000000+08:00\u0026#34;,\n    \u0026#34;tag\u0026#34; : \u0026#34;docker.is-live\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因：创建索引时丢失了 document type 和 document id，创建索引的格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ePOST index_name/document_type/document_id -T abc.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e必须提供 document type 和 document id，文档 ID 在此处是可选的，如果不提供文档 ID，那么 elasticsearch 将会为其创建一个字母数字 ID。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:~ wanghuan$ curl -H \u0026#34;Content-Type: application/json\u0026#34; -XPUT http://localhost:9200/yztc/xdhuxc/1 -T ./1.json\n{\n    \u0026#34;_index\u0026#34;:\u0026#34;yztc\u0026#34;,\n    \u0026#34;_type\u0026#34;:\u0026#34;xdhuxc\u0026#34;,\n    \u0026#34;_id\u0026#34;:\u0026#34;1\u0026#34;,\n    \u0026#34;_version\u0026#34;:1,\n    \u0026#34;result\u0026#34;:\u0026#34;created\u0026#34;,\n    \u0026#34;_shards\u0026#34;:{\n        \u0026#34;total\u0026#34;:2,\n        \u0026#34;successful\u0026#34;:1,\n        \u0026#34;failed\u0026#34;:0\n    },\n    \u0026#34;_seq_no\u0026#34;:0,\n    \u0026#34;_primary_term\u0026#34;:1\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e其他几种方法创建一个索引：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ePOST index_name/document_type -T abc.json\nPUT index_name/document_type/document_id -T abc.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、ElasticSearch启动时报错，错误如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[2017-06-20T09:57:45,307][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [node-1] uncaught exception in thread [main]\norg.elasticsearch.bootstrap.StartupException: java.lang.RuntimeException: can not run elasticsearch as root\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e出于安全考虑，ElasticSearch不让使用root用户启动，解决方法：\u003c/p\u003e\n\u003cp\u003e1）在启动命令中加入参数，在使用命令行启动ElasticSearch时，加入额外的参数启动，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/bin/elasticsearch -Des.insecure.allow.root=true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）创建新用户，以新用户身份启动之\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egroupadd -g 700 elasticsearch                                                       # 创建elasticsearch用户组\nuseradd -u 701 -g 700 elasticsearch                                                 # 创建用户elasticsearch\npasswd elasticsearch                                                                # 为用户elasticsearch设置密码\ngpasswd -a elasticsearch elasticsearch                                              # 将用户elasticsearch添加到用户组elasticsearch中，第一个参数表示用户名，第二个参数表示用户组名\nchown -R elasticsearch:elasticsearch /middleware/elasticsearch-2.4.1 # 为用户组elasticsearch和用户elasticsearch赋予权限\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、Elasticsearch 启动时报错，错误如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[2]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行如下命令解决：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esysctl -w vm.max_map_count=262144\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho \u0026#34;vm.max_map_count=262144\u0026#34; \u0026gt;\u0026gt; /etc/sysctl.conf\nsysctl -p\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、ElasticSearch 启动后，使用 \u003ccode\u003ecurl http://localhost:9200\u003c/code\u003e 访问，控制台有内容输出，但是 \u003ccode\u003ecurl http://ip_address:9200\u003c/code\u003e 控制台无内容输出，在浏览器中使用 \u003ccode\u003ehttp://ip_address:9200\u003c/code\u003e 也无法访问。\u003c/p\u003e\n\u003cp\u003e修改 \u003ccode\u003eelasticsearch.yml\u003c/code\u003e 文件，修改 \u003ccode\u003enetwork.host\u003c/code\u003e 的值为：\u003ccode\u003e0.0.0.0\u003c/code\u003e，然后重新启动之，外网即可进行访问.\u003c/p\u003e\n\u003cp\u003e6、elasticsearch状态为红色，原因为磁盘不足，腾出磁盘空间后，还是红色，执行如下命令：\u003c/p\u003e\n\u003cp\u003eElasticsearch 提供了专门的 \u003ccode\u003ereroute API\u003c/code\u003e 用于手工进行 \u003ccode\u003eshard\u003c/code\u003e 的移动、分配以及取消指令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ePOST /_cluster/reroute\n{\n  \u0026#34;commands\u0026#34;: [\n    {\n      \u0026#34;move\u0026#34;: {\n        \u0026#34;index\u0026#34;: \u0026#34;xdhuxc-basedoc-ta_mysql-a0f921217f6d4a6aa348415411db6f7e\u0026#34;,\n        \u0026#34;shard\u0026#34;: 0,\n        \u0026#34;from_node\u0026#34;: \u0026#34;singlenode\u0026#34;,\n        \u0026#34;to_node\u0026#34;: \u0026#34;singlenode\u0026#34;\n      }\n    }\n  ]\n}\nPOST /_cluster/reroute\n{\n  \u0026#34;commands\u0026#34;: [\n    {\n      \u0026#34;allocate\u0026#34;: {\n        \u0026#34;index\u0026#34;: \u0026#34;xdhuxc-basedoc-ta_mysql-a0f921217f6d4a6aa348415411db6f7e\u0026#34;,\n        \u0026#34;shard\u0026#34;: 0,\n        \u0026#34;node\u0026#34;: \u0026#34;singlenode\u0026#34;,\n        \u0026#34;allow_primary\u0026#34;:true\n      }\n    }\n  ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1547078400,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1550793600,"objectID":"0695767e25cb90ce7a4ceddd387cc87d","publishdate":1547078400,"relpermalink":"/posts/storage/elasticsearch/elasticsearch-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在使用 ElasticSearch 的过程中常见的问题及解决方法。\u003c/p\u003e","tags":["ElasticSearch","数据库"],"title":"ElasticSearch 常见问题及解决","url":"https://xdhuxc.github.io/posts/storage/elasticsearch/elasticsearch-questions-and-solutions/","wordcount":1287},{"categories":"posts","content":"\u003cp\u003e        已经有很长一段时间了，我的头脑中再也没有出现过新的东西了，这是一件令人沮丧和感到害怕的事情！\u003c/p\u003e\n\u003cp\u003e　　我注意到，很多人的头脑和意识都在固化甚至僵化，每当谈起一些事情时，有些人总会先入为主地以自己曾经的经历、认识或类比的方式去认识当前事情，这其实本来是没有多大问题的，但是他们却忽略了外部环境的变化和事情本身成因的不同，陷入了经验主义的怪圈。一旦陷入进去，大体上以后的人生就是在不断地重复和强化这个思维过程，再也跳脱不出来，直到哪天有勇气和决心扔掉自己曾经的认知！\u003c/p\u003e\n\u003cp\u003e　　我发现，我的思想和思维也已经在固化和僵化。在过去的三四年中，我的头脑中总是在重复一些乱七八糟的东西，它们不停地在头脑中重复，严重地阻碍了我学习和认识新的事物。所以，我准备把这些东西记录下来，将头脑中的垃圾清理下。这些东西没有什么特别的地方，仅仅是个人头脑中的一些想法、认识、判断和推测等。它们将会以人间世为前缀，后面以标题一、二、三等一直排序下去，如果是随便写的内容，则会以杂一、杂二等为标题，并同时发布到个人网站和微信公众号上。\u003c/p\u003e\n\u003cp\u003e　　往后余生，面向未来，学习新的知识和技能，不断向前走！\u003c/p\u003e\n\u003cp\u003e　　在这里，不允许有任何犹豫！\u003c/p\u003e\n\u003cp\u003e　　在这里，不允许有任何怯懦！\u003c/p\u003e\n\u003cp\u003e　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　2019年1月1日\u003c/p\u003e","date":1546300800,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1565136000,"objectID":"b62269db0aab6e925ea6095e2f9b50b7","publishdate":1546300800,"relpermalink":"/posts/human/human-world-preface/","section":"posts","summary":"","tags":["人间世"],"title":"人间世·前言","url":"https://xdhuxc.github.io/posts/human/human-world-preface/","wordcount":502},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Pinpoint 的部署和使用。\u003c/p\u003e\n\u003ch1 id=\"部署-pinpoint\"\u003e部署 Pinpoint\u003c/h1\u003e\n\u003ch3 id=\"前提条件\"\u003e前提条件\u003c/h3\u003e\n\u003cp\u003e1、安装 JAVA，并配置 JAVA_HOME\u003c/p\u003e\n\u003cp\u003e2、下载 pinpoint 安装包（https://github.com/naver/pinpoint/releases）\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epinpoint-agent-1.8.0.tar.gz\u003c/li\u003e\n\u003cli\u003epinpoint-web-1.8.0.war\u003c/li\u003e\n\u003cli\u003epinpoint-collector-1.8.0.war\u003c/li\u003e\n\u003cli\u003epinpoint-master.zip\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e3、下载 hbase（http://apache.mirror.cdnetworks.com/hbase/stable/）\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ehbase-1.4.7-bin.tar.gz\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e4、下载 tomcat\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eapache-tomcat-9.0.12.tar.gz\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e5、机器配置：\n8C-16G-500G\u003c/p\u003e\n\u003ch3 id=\"部署-pinpoint-组件\"\u003e部署 Pinpoint 组件\u003c/h3\u003e\n\u003ch4 id=\"部署-hbase\"\u003e部署 hbase\u003c/h4\u003e\n\u003cp\u003e1）启动 hbase 并检查启动状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc bin]# pwd\n/root/pinpoint/hbase-1.4.7/bin\n[root@xdhuxc bin]# ls\ndraining_servers.rb   hbase-cleanup.sh  hbase-config.sh   hirb.rb                 region_mover.rb   rolling-restart.sh        stop-hbase.cmd  zookeepers.sh\nget-active-master.rb  hbase.cmd         hbase-daemon.sh   local-master-backup.sh  regionservers.sh  shutdown_regionserver.rb  stop-hbase.sh\ngraceful_stop.sh      hbase-common.sh   hbase-daemons.sh  local-regionservers.sh  region_status.rb  start-hbase.cmd           test\nhbase                 hbase-config.cmd  hbase-jruby       master-backup.sh        replication       start-hbase.sh            thread-pool.rb\n[root@xdhuxc bin]# ./start-hbase.sh \nrunning master, logging to /root/pinpoint/hbase-1.4.7/bin/../logs/hbase-root-master-xdhuxc.out\nJava HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=128m; support was removed in 8.0\nJava HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=128m; support was removed in 8.0\n[root@xdhuxc bin]# jps  # 使用 jps 命令查看 hbase 是否启动成功，如果看到 ‘HMaster’ 的进程，则表明 hbase 启动成功。\n7926 HMaster\n7974 Jps\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）初始化 pinpoint 所需的表（https://github.com/naver/pinpoint/blob/master/hbase/scripts/hbase-create.hbase）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc bin]# pwd\n/root/pinpoint/hbase-1.4.7/bin\n[root@xdhuxc bin]# ls\ndraining_servers.rb   hbase-cleanup.sh  hbase-config.sh     hbase-jruby             master-backup.sh  replication               start-hbase.sh  thread-pool.rb\nget-active-master.rb  hbase.cmd         hbase-create.hbase  hirb.rb                 region_mover.rb   rolling-restart.sh        stop-hbase.cmd  zookeepers.sh\ngraceful_stop.sh      hbase-common.sh   hbase-daemon.sh     local-master-backup.sh  regionservers.sh  shutdown_regionserver.rb  stop-hbase.sh\nhbase                 hbase-config.cmd  hbase-daemons.sh    local-regionservers.sh  region_status.rb  start-hbase.cmd           test\n[root@xdhuxc bin]# ./hbase shell hbase-create.hbase \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用命令查看导入的表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./hbase shell\nstatus \u0026#39;detailed\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"部署-pinpoint-collector\"\u003e部署 Pinpoint-collector\u003c/h4\u003e\n\u003cp\u003e1）将 pinpoint-collector-1.8.0.war 复制到 apache-tomcat-9.0.12/webapps/ 目录下，修改 pinpoint-collector-1.8.0/WEB-INF/classes 目录下的文件 hbase.properties，\n修改如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehbase.client.host=localhost\nhbase.client.port=2181\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e指向 zookeeper 的地址和端口。如果是本机，localhost建议改为本地外网IP地址，端口默认，则这里无需更改。\u003c/p\u003e\n\u003ch4 id=\"部署-pinpoint-web\"\u003e部署 Pinpoint-web\u003c/h4\u003e\n\u003cp\u003e1）将 pinpoint-web-1.8.0.war 复制到 apache-tomcat-9.0.12/webapps/ 目录下，修改 pinpoint-web-1.8.0/WEB-INF/classes 目录下的文件 hbase.properties，\n修改如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehbase.client.host=localhost\nhbase.client.port=2181\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e指向 zookeeper 的地址和端口。如果是本机，localhost建议改为本机外网IP地址，端口默认，则这里无需更改。\u003c/p\u003e\n\u003ch4 id=\"部署-pinpoint-agent\"\u003e部署 Pinpoint-Agent\u003c/h4\u003e\n\u003cp\u003e1）创建目录 pinpoint-agent 并解压 pinpoint-agent-1.8.0.tar.gz 到该目录下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir pinpoint-agent \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e tar -zxf pinpoint-agent-1.8.0.tar.gz -C pinpoint-agent\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）配置 pinpoint.config\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eprofiler.collector.ip=127.0.0.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这是指 pinpoint-collector 的地址，如果是同一服务器，可保持默认，建议修改为本机外网IP地址。\u003c/p\u003e\n\u003cp\u003e3）安装 pinpoint-collector 启动后，自动就开启了9994，9995，9996的端口了，这里默认即可。\n如果有端口需求，要去 pinpoint-collector 的配置文件 pinpoint-collector-1.8.0/WEB-INF/classes/pinpoint-collector.properties 中，修改这些端口。\u003c/p\u003e\n\u003ch3 id=\"部署测试应用\"\u003e部署测试应用\u003c/h3\u003e\n\u003cp\u003e1）修改 tomcat 的 catalina.sh 文件，加入如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCATALINA_OPTS=\u0026#34;$CATALINA_OPTS -javaagent:/root/pinpoint/pinpoint-agent/pinpoint-bootstrap-1.8.0.jar\u0026#34;\nCATALINA_OPTS=\u0026#34;$CATALINA_OPTS -Dpinpoint.agentId=xdhuxc\u0026#34;\nCATALINA_OPTS=\u0026#34;$CATALINA_OPTS -Dpinpoint.applicationName=XdhuxcAPP\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e第一行，指定 pinpoint-bootstrap-1.8.0.jar 的位置。\u003c/p\u003e\n\u003cp\u003e第二行，指定 agentId，必须唯一，用于标志一个 JVM。\u003c/p\u003e\n\u003cp\u003e第三行，指定 applicationName，表示同一种应用，同一个应用的不同实例应用使用不同的 agentId，相同的 applicationName。\u003c/p\u003e\n\u003cp\u003e此时，apache-tomcat-9.0.12/webapps 目录结构如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc webapps]# pwd\n/root/pinpoint/apache-tomcat-9.0.12/webapps\n[root@xdhuxc webapps]# ls\ndocs  examples  host-manager  jenkins  jenkins.war  manager  pinpoint-collector  pinpoint-web  ROOT\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"部署-spring-boot-项目\"\u003e部署 spring boot 项目\u003c/h4\u003e\n\u003cp\u003e如果是以 jar 包方式部署 spring boot 项目，直接在启动命令中添加启动参数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enohup java -javaagent:/root/pinpoint/pinpoint-agent/pinpoint-bootstrap-1.8.0.jar -Dpinpoint.agentId=xdhuxc -Dpinpoint.applicationName=XdhuxcAPP -jar xdhuxc.jar \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 apache-tomcat-9.0.12/webapps 目录下放置要监控的应用程序 war 包，然后启动 tomcat。\u003c/p\u003e\n\u003ch4 id=\"访问-pinpoint-管理页面\"\u003e访问 Pinpoint 管理页面\u003c/h4\u003e\n\u003cp\u003e访问如下路径：\u003c/p\u003e\n\u003cp\u003ehttp://172.20.26.149:8080/pinpoint-web\u003c/p\u003e\n\u003cp\u003e如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/mixed/pinpoint/pinpoint.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/heyeqingquan/article/details/74456591\"\u003ehttps://blog.csdn.net/heyeqingquan/article/details/74456591\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://naver.github.io/pinpoint/1.8.0/main.html\"\u003ehttp://naver.github.io/pinpoint/1.8.0/main.html\u003c/a\u003e\u003c/p\u003e","date":1546041600,"description":"","fuzzywordcount":1200,"kind":"page","lang":"zh","lastmod":1546041600,"objectID":"602ab0dd8c93016b1afda2a27304b185","publishdate":1546041600,"relpermalink":"/posts/mixed/pinpoint/pinpoint-install-and-basic-usage/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Pinpoint 的部署和使用。\u003c/p\u003e","tags":["Pinpoint"],"title":"Pinpoint 的部署和使用","url":"https://xdhuxc.github.io/posts/mixed/pinpoint/pinpoint-install-and-basic-usage/","wordcount":1126},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了基于 binlog 的 MySQL 主从复制集群的搭建过程，留作后查。\u003c/p\u003e\n\u003ch2 id=\"mysql-主从复制集群\"\u003emysql 主从复制集群\u003c/h2\u003e\n\u003cp\u003eMySQL 主从复制与读写分离\u003c/p\u003e\n\u003cp\u003eMySQL作为目前世界上使用最广泛的免费数据库，在实际的生产环境中，由单台 MySQL 作为独立的数据库是完全不能满足实际需求的，无论是在安全性、高可用性及高并发等各个方面。\u003c/p\u003e\n\u003cp\u003e因此，一般来说都是通过主从复制（Master-Slave）的方式来同步数据，再通过读写分离（MySQL-Proxy）来提升数据库的并发负载能力，这样的方案来进行部署与实施。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-salve-proxy.jpg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003ch3 id=\"复制功能\"\u003e复制功能\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e数据分布\u003c/li\u003e\n\u003cli\u003e负载均衡，针对数据读取\u003c/li\u003e\n\u003cli\u003e数据备份\u003c/li\u003e\n\u003cli\u003e高可用和故障切换\u003c/li\u003e\n\u003cli\u003eMySQL 升级测试\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"复制方式\"\u003e复制方式\u003c/h3\u003e\n\u003cp\u003e1、 主-从复制\u003c/p\u003e\n\u003cp\u003e2、 主-主复制\u003c/p\u003e\n\u003cp\u003e3、半同步复制\u003c/p\u003e\n\u003ch3 id=\"复制原理\"\u003e复制原理\u003c/h3\u003e\n\u003cp\u003eMySQL 中有一种日志叫做 bin 日志（二进制日志），这个日志会记录下所有修改了数据库的 SQL 语句（insert， update， delete，alter，grant等），主从复制的原理就是把主数据库服务器上的 bin 日志复制到从数据库服务器上执行一遍，这样从数据库服务器上的数据就和主数据库服务器上的数据相同了。\u003c/p\u003e\n\u003ch3 id=\"复制流程图\"\u003e复制流程图\u003c/h3\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/master-slave-copy.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003ch3 id=\"复制过程\"\u003e复制过程\u003c/h3\u003e\n\u003cp\u003e1、主节点必须启用二进制日志，记录任何修改数据库数据的事件。\u003c/p\u003e\n\u003cp\u003e2、从节点开启一个线程（I/O Thread）把自己扮演成 mysql 的客户端，通过 mysql 协议，请求主节点的二进制日志文件中的事件。\u003c/p\u003e\n\u003cp\u003e3、主节点启动一个线程（dump Thread），检查自己二进制日志中的事件，跟对方请求的位置对比，如果不带请求位置参数，则主节点就会从第一个日志文件中的第一个事件一个一个发送给从节点。\u003c/p\u003e\n\u003cp\u003e4、从节点接收到主节点发送过来的数据，把它放置到中继日志（relay log）文件中，并记录该次请求到主节点的具体哪个二进制日志文件的哪个位置。\u003c/p\u003e\n\u003cp\u003e5、从节点启动另外一个线程（sql Thread），把中继日志中的事件读取出来，并在本地再执行一次。\u003c/p\u003e\n\u003ch3 id=\"复制过程中线程的作用\"\u003e复制过程中线程的作用\u003c/h3\u003e\n\u003ch4 id=\"主节点\"\u003e主节点\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003edump Thread：为每个从节点的 I/O Thread 启动一个 dump 线程，用于向从节点发送二进制事件。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"从节点\"\u003e从节点\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eI/O Thread：从主节点请求二进制日志事件，并保存在中继日志中。\u003c/li\u003e\n\u003cli\u003esql Thread：从中继日志中读取日志事件，在本地完成执行。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e从节点需要建立二进制日志文件吗？\n视情况而定，如果从节点需要作为其他节点的主节点时，是需要开启二进制日志文件的，这种情况称之为级联复制。如果只是作为从节点，则不需要建立二进制文件。\u003c/p\u003e\n\u003ch3 id=\"mysql-复制特点\"\u003eMySQL 复制特点\u003c/h3\u003e\n\u003cp\u003e1、复制异步：主节点中一个用户请求一个写操作时，主节点不需要把写的数据在本地操作完成，并同时发送给从服务器并等待从服务器反馈写入完成，再响应用户。但是，从节点中的数据有可能会落后于主节点，可以使用一些软件来检查是否落后。\u003c/p\u003e\n\u003cp\u003e2、主从数据不一致。\u003c/p\u003e\n\u003ch3 id=\"主从复制配置过程\"\u003e主从复制配置过程\u003c/h3\u003e\n\u003ch4 id=\"主节点-1\"\u003e主节点\u003c/h4\u003e\n\u003cp\u003e1、启用二进制日志。\u003c/p\u003e\n\u003cp\u003e2、为当前节点设置一个全局唯一的 server_id。\u003c/p\u003e\n\u003cp\u003e3、创建具有复制权限的用户账号：replication slave，replication client。\u003c/p\u003e\n\u003ch4 id=\"从节点-1\"\u003e从节点\u003c/h4\u003e\n\u003cp\u003e1、启动中继日志。\u003c/p\u003e\n\u003cp\u003e2、为当前节点设置一个全局唯一的 server_id。\u003c/p\u003e\n\u003cp\u003e3、使用具有复制权限的用户账号连接至主节点，并启动复制线程。\u003c/p\u003e\n\u003ch4 id=\"主节点配置\"\u003e主节点配置\u003c/h4\u003e\n\u003cp\u003e1、启用二进制日志文件，在 /etc/my.cnf 中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[mysqld]\nlog-bin=mysql-bin\nserver-id=1\ninnodb-file-per-table=ON\nskip_name_resolve=ON\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 mysqld 服务。\u003c/p\u003e\n\u003cp\u003e2、查看二进制日志是否开启\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show global variables like \u0026#39;%log%\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-copy-1.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e3、查看主节点二进制日志列表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show master logs;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-copy-2.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e4、查看主节点的 server id\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show global variables like \u0026#39;%server%\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-copy-3.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e5、在主节点上创建具有复制权限的用户，并刷新权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egrant replication slave, replication client on \u003cspan class=\"ge\"\u003e*.*\u003c/span\u003e to \u0026#39;replxdhuxc\u0026#39;@\u0026#39;%\u0026#39; identified by \u0026#39;Repl@163\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-copy-4.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003ch4 id=\"从节点-2\"\u003e从节点\u003c/h4\u003e\n\u003cp\u003e1、开启中继日志，在 /etc/my.cnf 中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erelay-log=relay-log\nrelay-log-index=relay-log.index\nserver-id=2\ninnodb_file_per_table=ON\nskip_name_resolve=ON\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 mysqld 服务。\u003c/p\u003e\n\u003cp\u003e2、查看中继日志是否开启\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show global variables like \u0026#39;%log%\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-copy-5.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e3、查看从节点 server 相关信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show global variables like \u0026#39;%server%\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-copy-6.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e4、在从节点配置访问主节点的参数信息，添加主节点主机、访问主节点的用户名和密码，主节点二进制文件信息。\u003c/p\u003e\n\u003cp\u003e注意：主节点的二进制文件一定要是二进制列表中的最后一个二进制文件。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-to-slave-7.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003echange master to master_host=\u0026#39;172.20.26.149\u0026#39;, master_user=\u0026#39;replxdhuxc\u0026#39;, master_password=\u0026#39;Repl@163\u0026#39;, master_log_file=\u0026#39;mysql-bin.000001\u0026#39;, master_log_pos=1076;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-to-slave-8.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e5、查看从节点的状态信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show slave status \\G;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-to-slave-9.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e由于没有启动从节点的复制线程，I/O 线程和 SQL 线程都为：No\u003c/p\u003e\n\u003cp\u003e6、启动复制线程，并再次查看从节点状态信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; start slave;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003estart slave\u003c/code\u003e 可以指定线程类型：IO_THREAD、SQL_THREAD，如果没有指定，则两个都启动。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-to-slave-10.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e到此，mysql 主从复制配置完成。\u003c/p\u003e\n\u003ch4 id=\"测试\"\u003e测试\u003c/h4\u003e\n\u003cp\u003e1、在主节点创建数据库 xdhuxc，并查看主节点二进制日志信息\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-to-slave-11.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e2、在从节点查看数据库 xdhuxc，并查找二进制日志信息\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-to-slave-12.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003ch4 id=\"主从复制架构中应该注意的问题\"\u003e主从复制架构中应该注意的问题\u003c/h4\u003e\n\u003cp\u003e从节点要设置某些限定使得它不能进行写操作，才能保证复制当中的数据一致。\u003c/p\u003e\n\u003cp\u003e1、限制从服务器为只读，在从服务器上设置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eread_only=ON   # 设置从服务器为只读，但是此限制对拥有 super 权限的用户均无效。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e限制所有用户\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; flush tables with read lock;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、保证主从复制时的事务安全\u003c/p\u003e\n\u003cp\u003e1）在主节点\u003c/p\u003e\n\u003cp\u003e设置参数如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esync_binlog=1 # 当每进行1次事务提交之后，MySQL将进行一次fsync之类的磁盘同步指令来将binlog_cache中的数据强制写入磁盘。\ninnodb_flush_logs_at_trx_commit=ON # 在事务提交时，要将内存中跟事务相关的数据立即刷新到事务日志中去。\ninnodb_support_xa=ON # 分布式事务，基于它来做两段式提交功能\nsync_master_info=1 # 每次给从节点 dump 一些事件信息之后，主节点的 master.info 信息会立即同步到到磁盘上，让从服务器中的 master.info 及时更新。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）在每个从节点上\u003c/p\u003e\n\u003cp\u003e设置参数如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eskip_slave_start=ON # 跳过自动启动，使用手动启动。\nsync_relay_log=1    # 每次 sync_relay_log 事件都会刷新到磁盘。 \nsync_relay_log_info=1 # 每间隔多少事务刷新 relay-log.info，如果是table（innodb）设置无效，每个事务都会更新。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）其他\n在从节点上，master.info 文件中记录着主节点的信息，包括master IP地址，账户名和密码，端口，复制位置等信息\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-to-slave-12.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在从节点上，relay-log.info 文件中记录着从节点将来到主节点的哪一个二进制文件中的哪一个位置复制日志，及保存到本地哪一个中继日志的哪一个位置。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/storage/mysql/mysql-master-to-slave-13.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e","date":1545436800,"description":"","fuzzywordcount":2300,"kind":"page","lang":"zh","lastmod":1546041600,"objectID":"e5eaabd4de816cc624608d3dcdcc0bbc","publishdate":1545436800,"relpermalink":"/posts/storage/mysql/mysql-master-slave-binlog/","section":"posts","summary":"\u003cp\u003e本篇博客记录了基于 binlog 的 MySQL 主从复制集群的搭建过程，留作后查。\u003c/p\u003e","tags":["MySQL","数据库"],"title":"基于 binlog 的 MySQL 主从复制","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-master-slave-binlog/","wordcount":2286},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 calico 的架构和网络通信模型。\u003c/p\u003e\n\u003ch3 id=\"calico-介绍\"\u003ecalico 介绍\u003c/h3\u003e\n\u003cp\u003eCalico 是一个纯三层的数据中心网络方案，能够提供可控的虚拟机、容器、裸机之间的IP通信。\u003c/p\u003e\n\u003cp\u003e通过将整个互联网的可扩展网络原则压缩到数据中心级别，calico在每一个计算节点利用Linux内核实现了一个高效的vRouter来负责数据转发，而每个vRouter通过BGP协议负责把自己上运行的workload的路由信息向整个calcio网络内广播。小规模部署时各计算节点可以直接互联，大规模部署时可通过指定的BGP route reflector来完成。\n这样保证最终所有的workload之间的数据流量都是通过IP路由的方式完成互联的。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/mixed/calico/calico流量流程图.png\" width=\"800px\" height=\"300px\" /\u003e\n图 1 · calico 流量流程\n\u003c/center\u003e\n\u003cp\u003ecalico 节点组网可以直接利用数据中心的网络结构（无论是L2或者L3），不需要额外的NAT、隧道或者overlay网络\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/mixed/calico/calico封包图.png\" width=\"800px\" height=\"300px\" /\u003e\n图 2 · calico 封包\n\u003c/center\u003e\n\u003cp\u003e如上图所示，这样保证这个方案的简单可控，而且没有封包解包，节约CPU计算资源的同时，提高了整个网络的性能。\u003c/p\u003e\n\u003cp\u003e此外，calcio基于iptables还提供了丰富而灵活的网络策略，保证通过各个节点上的ACL2来提供计算节点的多租户隔离、安全组以及其他可达性限制等功能。\u003c/p\u003e\n\u003ch3 id=\"calico-架构\"\u003ecalico 架构\u003c/h3\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/mixed/calico/calico架构图.png\" width=\"800px\" height=\"300px\" /\u003e\n图 3 · calico 架构\n\u003c/center\u003e\n\u003cul\u003e\n\u003cli\u003eFelix：是calico agent，运行在每台需要运行workload的节点上，主要负责配置路由及ACL2等信息来确保Endpoint的连通状态。\u003c/li\u003e\n\u003cli\u003eetcd：分布式键值存储，主要负责网络元数据一致性，确保calico网络状态的准确性。\u003c/li\u003e\n\u003cli\u003eBGP Client（BIRD）：主要负责把 Felix 写入 Linux 内核的路由信息分发到当前calico网络，确保workload间通信的有效性。\u003c/li\u003e\n\u003cli\u003eBGP Route Reflector（BIRD）：大规模部署时使用，摒弃所有节点互联的网格模式，通过一个或者多个BGP Route Reflector来完成集中式的路由分发。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"calico-网络通信模型\"\u003ecalico 网络通信模型\u003c/h3\u003e\n\u003cp\u003e在主机网络拓扑的组织上，calcio是在主机上启动虚拟机路由器，将每个主机作为路由器使用，组成互联互通的网络拓扑。\u003c/p\u003e\n\u003cp\u003e每个主机上都部署了 calico node 作为虚拟路由器，并且可以通过 calico 将宿主机组织成任意的拓扑集群。当集群中的容器需要与外界通信时，就可以通过BGP协议将网关物理路由器加入到集群中，使外界可以直接访问容器IP，而不需要做任何NAT之类的复杂操作。\n当容器通过 calico 进行跨主机通信时，其网络通信模型如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/mixed/calico/calico网络通信模型.png\" width=\"800px\" height=\"300px\" /\u003e\n图 4 · calico 网络通信模型\n\u003c/center\u003e\n\u003cp\u003e从上图可以看出，当创建容器时，calcio 为容器生成 veth pair，一端作为容器网卡加入到容器的网络命名空间，并设置IP地址和子网掩码，一端直接暴露在宿主机上，并通过设置路由规则，将容器IP暴露到宿主机的通信路由上。与此同时，calico为每个主机分配了一段子网作为容器可分配的IP范围，这样就可以根据子网的CIDR为每个主机生成比较固定的路由规则。\u003c/p\u003e\n\u003cp\u003e当容器需要跨主机通信时，主要经过以下步骤：\u003c/p\u003e\n\u003cp\u003e1）容器流量通过 veth pair 到达宿主机的网络命名空间上。\u003c/p\u003e\n\u003cp\u003e2）根据容器要访问的 IP 所在的子网 CIDR 和主机上的路由规则，找到下一跳要到达的宿主机 IP。\u003c/p\u003e\n\u003cp\u003e3）流量到达下一跳的宿主机后，根据当前宿主机上的路由规则，直接到达对端容器的 veth pair 插在宿主机的一端，最终进入容器。\u003c/p\u003e\n\u003cp\u003e从上面的通信过程来看，跨主机通信时，整个通信路径完全没有使用 NAT 或者 UDP 封装，性能上的损耗确实比较低。\u003c/p\u003e\n\u003cp\u003e由于calcio的通信机制是完全基于三层的，这种机制也带来了一些缺陷，例如：\u003c/p\u003e\n\u003cp\u003e1）calcio 目前只支持 TCP、UDP、ICMP、ICMPv6协议，如果使用其他四层协议（例如NetBIOS协议），建议使用weave、原生overlay等其他overlay网络实现。\u003c/p\u003e\n\u003cp\u003e2）基于三层实现通信，在二层上没有任何加密包装，因此只能在私有的可靠网络上使用。\u003c/p\u003e\n\u003cp\u003e3）流量隔离基于iptables实现，并且从etcd中获取需要生成的隔离规则，有一些性能上的隐患。\u003c/p\u003e\n\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e1、部署 calcio workload 的各节点机的 hostname 最好全部不同，否则会导致写入 etcd 的数据发生覆盖，但是可以通过在启动 calcio node 时，指明 calico node 的名称来避免。\u003c/p\u003e\n\u003cp\u003e2、calcio workload 的各节点机的 eth0 网卡的 IP 段和 calcio 的网段必须不同，可通过修改 calcio 网段解决。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.goodrain.com/docs/stable/operation-manual/network/calico.html#calico\"\u003ehttps://www.goodrain.com/docs/stable/operation-manual/network/calico.html#calico\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://blog.51cto.com/dengaosky/2069666\"\u003ehttp://blog.51cto.com/dengaosky/2069666\u003c/a\u003e\u003c/p\u003e","date":1545264000,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1546041600,"objectID":"dae14dab0896683c49bfb2bbe93c2837","publishdate":1545264000,"relpermalink":"/posts/mixed/calico/calico-theory-and-architecture/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 calico 的架构和网络通信模型。\u003c/p\u003e","tags":["calico"],"title":"calico 架构和网络通信模型介绍","url":"https://xdhuxc.github.io/posts/mixed/calico/calico-theory-and-architecture/","wordcount":1652},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了使用 \u003ccode\u003eVirtual Box\u003c/code\u003e 或 \u003ccode\u003eVMware Work station\u003c/code\u003e 创建虚拟机时的网络连接方式。\u003c/p\u003e\n\u003cp\u003eVirtualBox中有四种网络连接方式：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNAT 网络地址转换模式\u003c/li\u003e\n\u003cli\u003eBridged Adapter 桥接模式\u003c/li\u003e\n\u003cli\u003eIntenal 内部网络模式\u003c/li\u003e\n\u003cli\u003eHost-Only Adapter 主机模式\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eVMWare 中有五种网络连接方式：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNAT 模式\u003c/li\u003e\n\u003cli\u003e桥接模式\u003c/li\u003e\n\u003cli\u003e仅主机模式\u003c/li\u003e\n\u003cli\u003e自定义（特定虚拟网络）\u003c/li\u003e\n\u003cli\u003eLAN区段\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e不同的虚拟交换机应用在不同的联网模式下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eVMnet0：这是VMware用于虚拟桥接网络下的虚拟交换机；\u003c/li\u003e\n\u003cli\u003eVMnet1：这是VMware用于虚拟Host-Only网络下的虚拟交换机；\u003c/li\u003e\n\u003cli\u003eVMnet8：这是VMware用于虚拟NAT网络下的虚拟交换机；\u003c/li\u003e\n\u003cli\u003eVMnet2~VMnet7及VMnet9：是VMware用于虚拟自定义custom网络下的虚拟交换机；\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eVirtualBox中四种网络连接方式之间的区别：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e方向\u003c/th\u003e\n\u003cth\u003eNAT\u003c/th\u003e\n\u003cth\u003eBridged Adapter\u003c/th\u003e\n\u003cth\u003eInternal\u003c/th\u003e\n\u003cth\u003eHost-only Adapter\u003c/th\u003e\n\u003cth\u003e\u003c/th\u003e\n\u003cth\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e虚拟机-\u0026gt;主机\u003c/td\u003e\n\u003ctd\u003eV\u003c/td\u003e\n\u003ctd\u003eV\u003c/td\u003e\n\u003ctd\u003eX\u003c/td\u003e\n\u003ctd\u003e默认不能，需配置\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e主机-\u0026gt;虚拟机\u003c/td\u003e\n\u003ctd\u003eX\u003c/td\u003e\n\u003ctd\u003eV\u003c/td\u003e\n\u003ctd\u003eX\u003c/td\u003e\n\u003ctd\u003e默认不能，需配置\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e虚拟机-\u0026gt;其他主机\u003c/td\u003e\n\u003ctd\u003eV\u003c/td\u003e\n\u003ctd\u003eV\u003c/td\u003e\n\u003ctd\u003eX\u003c/td\u003e\n\u003ctd\u003e默认不能，需配置\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e其他主机-\u0026gt;虚拟机\u003c/td\u003e\n\u003ctd\u003eX\u003c/td\u003e\n\u003ctd\u003eV\u003c/td\u003e\n\u003ctd\u003eX\u003c/td\u003e\n\u003ctd\u003e默认不能，需配置\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e虚拟机之间\u003c/td\u003e\n\u003ctd\u003eX\u003c/td\u003e\n\u003ctd\u003eV\u003c/td\u003e\n\u003ctd\u003e同网络名下可以\u003c/td\u003e\n\u003ctd\u003eV\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/carolzhang8406/article/details/19042569\"\u003ehttps://blog.csdn.net/carolzhang8406/article/details/19042569\u003c/a\u003e\u003c/p\u003e","date":1544313600,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1562630400,"objectID":"244d575a490ae0d9563fe479a90125db","publishdate":1544313600,"relpermalink":"/posts/mixed/virtual-machine-network-mode/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了使用 \u003ccode\u003eVirtual Box\u003c/code\u003e 或 \u003ccode\u003eVMware Work station\u003c/code\u003e 创建虚拟机时的网络连接方式。\u003c/p\u003e","tags":["VirtualBox","VMware"],"title":"虚拟机的几种网络连接方式","url":"https://xdhuxc.github.io/posts/mixed/virtual-machine-network-mode/","wordcount":431},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了基于 GTID 的 MySQL 主从复制的过程，留作后查。\u003c/p\u003e\n\u003ch3 id=\"配置-gtid-主从复制\"\u003e配置 GTID 主从复制\u003c/h3\u003e\n\u003cp\u003e使用 docker 方式部署 MySQL 主从节点\u003c/p\u003e\n\u003cp\u003e1、创建如下目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecd /data\nmkdir mysql/master mysql/slave\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"master-配置\"\u003emaster 配置\u003c/h4\u003e\n\u003cp\u003e在 /data/mysql/master 目录下创建文件 mysql.cnf:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[mysqld]\n\u003cspan class=\"gu\"\u003e############# basic settings #############\n\u003c/span\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003eserver_id = 1\nport = 3307\nbind_address = 0.0.0.0\nmax_binlog_size = 100M\n\n\u003cspan class=\"gu\"\u003e############# log settings #############\n\u003c/span\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003elog_bin = ON\nexpire_logs_days = 30\nbinlog_format = row\nsync_binlog = 1\nbinlog_rows_query_log_events = 1\n\n\u003cspan class=\"gu\"\u003e############# replication #############\n\u003c/span\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003egtid_mode = ON\nenforce_gtid_consistency = ON\nlog_slave_updates = ON\nmaster_info_repository = table\nrelay_log_info_repository = table\nslave_parallel_workers = 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 MySQL 5.6 版本时，基于 GTID 的复制中 log-slave-updates 选项是必须的，但是其增大了从服务器的 IO 负载，而在 MySQL 5.7 中该选项已经不是必须项。\u003c/p\u003e\n\u003cp\u003emysql master 容器启动命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --restart=always \\\n    --name=mysql-master \\\n    -p 3307:3307 \\\n    -v /data/mysql/master/mysql.cnf:/etc/mysql/conf.d/mysql.cnf \\\n    -v /data/mysql/master/data:/var/lib/mysql \\\n    -e MYSQL_ROOT_PASSWORD=1qaz1QAZ \\\n    mysql:5.7.24\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动之后进入容器查看效果：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show global variables like \u0026#34;%gtid%\u0026#34;;\n+----------------------------------+-------+\n| Variable_name                    | Value |\n+----------------------------------+-------+\n| binlog_gtid_simple_recovery      | ON    |\n| enforce_gtid_consistency         | ON    |\n| gtid_executed                    |       |\n| gtid_executed_compression_period | 1000  |\n| gtid_mode                        | ON    |\n| gtid_owned                       |       |\n| gtid_purged                      |       |\n| session_track_gtids              | OFF   |\n+----------------------------------+-------+\n8 rows in set (0.00 sec)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到，GTID 模式已经开启了。\u003c/p\u003e\n\u003cp\u003e创建复制用户\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecreate user \u0026#39;xdhuxc\u0026#39;@\u0026#39;%\u0026#39; identified by \u0026#39;1qaz1QAZ\u0026#39;;\ngrant replication slave on \u003cspan class=\"ge\"\u003e*.*\u003c/span\u003e to \u0026#39;xdhuxc\u0026#39;@\u0026#39;%\u0026#39;;\nflush privileges;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"slave-配置\"\u003eslave 配置\u003c/h4\u003e\n\u003cp\u003e在 /data/mysql/slave 目录下创建 mysql.cnf 文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[mysqld]\nserver_id = 3\n\ngtid_mode = ON\nenforce_gtid_consistency = ON\nlog_slave_updates = ON\nread_only = ON\nexpire_logs_days = 30\nmax_binlog_size = 100M\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 mysql salve 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --restart=always \\\n    --name=mysql-slave \\\n    -p 3308:3306 \\\n    -v /data/mysql/slave/mysql.cnf:/etc/mysql/conf.d/mysql.cnf \\\n    -v /data/mysql/slave/data:/var/lib/mysql \\\n    -e MYSQL_ROOT_PASSWORD=1qaz1QAZ \\\n    mysql:5.7.24\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eslave 连接至 master\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003echange master to master_host=\u0026#39;172.27.126.226\u0026#39;, master_port=3307, master_user=\u0026#39;xdhuxc\u0026#39;, master_password=\u0026#39;1qaz1QAZ\u0026#39;, master_auto_position=1;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动复制线程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003estart slave;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"验证主从复制\"\u003e验证主从复制\u003c/h4\u003e\n\u003cp\u003e1、在 mysql-master 容器内\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show slave hosts;\n+-----------+------+------+-----------+--------------------------------------+\n| Server_id | Host | Port | Master_id | Slave_UUID                           |\n+-----------+------+------+-----------+--------------------------------------+\n|         3 |      | 3306 |         1 | ab2050d7-1244-11e9-bfa7-0242ac110005 |\n+-----------+------+------+-----------+--------------------------------------+\n1 row in set (0.00 sec)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在 mysql-slave 容器内\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show slave status \\G\n\u003cspan class=\"ge\"\u003e**\u003c/span\u003e************************* 1. row \u003cspan class=\"ge\"\u003e**\u003c/span\u003e*************************\n               Slave_IO_State: Waiting for master to send event\n                  Master_Host: 172.27.126.226\n                  Master_User: xdhuxc\n                  Master_Port: 3307\n                Connect_Retry: 60\n              Master_Log_File: ON.000004\n          Read_Master_Log_Pos: 791\n               Relay_Log_File: c81fccb3bd9c-relay-bin.000004\n                Relay_Log_Pos: 990\n        Relay_Master_Log_File: ON.000004\n             Slave_IO_Running: Yes\n            Slave_SQL_Running: Yes\n              Replicate_Do_DB:\n          Replicate_Ignore_DB:\n           Replicate_Do_Table:\n       Replicate_Ignore_Table:\n      Replicate_Wild_Do_Table:\n  Replicate_Wild_Ignore_Table:\n                   Last_Errno: 0\n                   Last_Error:\n                 Skip_Counter: 0\n          Exec_Master_Log_Pos: 791\n              Relay_Log_Space: 1443\n              Until_Condition: None\n               Until_Log_File:\n                Until_Log_Pos: 0\n           Master_SSL_Allowed: No\n           Master_SSL_CA_File:\n           Master_SSL_CA_Path:\n              Master_SSL_Cert:\n            Master_SSL_Cipher:\n               Master_SSL_Key:\n        Seconds_Behind_Master: 0\nMaster_SSL_Verify_Server_Cert: No\n                Last_IO_Errno: 0\n                Last_IO_Error:\n               Last_SQL_Errno: 0\n               Last_SQL_Error:\n  Replicate_Ignore_Server_Ids:\n             Master_Server_Id: 1\n                  Master_UUID: d1623ded-124a-11e9-b46d-0242ac110004\n             Master_Info_File: /var/lib/mysql/master.info\n                    SQL_Delay: 0\n          SQL_Remaining_Delay: NULL\n      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates\n           Master_Retry_Count: 86400\n                  Master_Bind:\n      Last_IO_Error_Timestamp:\n     Last_SQL_Error_Timestamp:\n               Master_SSL_Crl:\n           Master_SSL_Crlpath:\n           Retrieved_Gtid_Set: d1623ded-124a-11e9-b46d-0242ac110004:1-8\n            Executed_Gtid_Set: d1623ded-124a-11e9-b46d-0242ac110004:1-8\n                Auto_Position: 1\n         Replicate_Rewrite_DB:\n                 Channel_Name:\n           Master_TLS_Version:\n1 row in set (0.00 sec)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到 IO 和 SQL 线程的状态都为：YES，Retrieved_Gtid_Set 接收了 8 个事务，Executed_Gtid_Set 执行了 8 个事务。\u003c/p\u003e\n\u003cp\u003e在 mysql-master 容器中创建数据库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; create database blog;\nQuery OK, 1 row affected (0.00 sec)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecreate table \u003cspan class=\"sb\"\u003e`test`\u003c/span\u003e (\n    \u003cspan class=\"sb\"\u003e`id`\u003c/span\u003e int(11),\n    \u003cspan class=\"sb\"\u003e`name`\u003c/span\u003e varchar(32),\n);\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 mysql-slave 中查看\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| blog               |\n| mysql              |\n| performance_schema |\n| sys                |\n+--------------------+\n5 rows in set (0.00 sec)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.hi-linux.com/posts/47176.html\"\u003ehttps://www.hi-linux.com/posts/47176.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.ywnds.com/?p=3898\"\u003ehttp://www.ywnds.com/?p=3898\u003c/a\u003e\u003c/p\u003e","date":1544140800,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1546041600,"objectID":"1e5e21ea2d84264ea1831a43355b38be","publishdate":1544140800,"relpermalink":"/posts/storage/mysql/mysql-master-slave-gtid/","section":"posts","summary":"\u003cp\u003e本篇博客记录了基于 GTID 的 MySQL 主从复制的过程，留作后查。\u003c/p\u003e","tags":["MySQL","数据库"],"title":"基于 GTID 的 MySQL 主从复制","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-master-slave-gtid/","wordcount":868},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下 Bind 的安装和配置，以备后查。\u003c/p\u003e\n\u003ch3 id=\"bind\"\u003eBIND\u003c/h3\u003e\n\u003cp\u003eBIND 是 Berkeley Internet Name Domain 的首字母简写，是一款开源的 DNS 软件，可以使用 BIND 在内网中部署自己的 DNS。\u003c/p\u003e\n\u003ch4 id=\"安装部署\"\u003e安装部署\u003c/h4\u003e\n\u003cp\u003e1、使用如下命令安装 BIND\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y bind \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动 BIND\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart named\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"配置\"\u003e配置\u003c/h4\u003e\n\u003cp\u003ebind 的主配置文件位置：\u003ccode\u003e/etc/named.conf\u003c/code\u003e，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e//\n// named.conf\n//\n// Provided by Red Hat bind package to configure the ISC BIND named(8) DNS\n// server as a caching only nameserver (as a localhost DNS resolver only).\n//\n// See /usr/share/doc/bind*/sample/ for example named configuration files.\n//\n// See the BIND Administrator\u0026#39;s Reference Manual (ARM) for details about the\n// configuration located in /usr/share/doc/bind-{version}/Bv9ARM.html\n\noptions {\n\tlisten-on port 53 { 127.0.0.1; };\n\tlisten-on-v6 port 53 { ::1; };\n\tdirectory \t\u0026#34;/var/named\u0026#34;;\n\tdump-file \t\u0026#34;/var/named/data/cache_dump.db\u0026#34;;\n\tstatistics-file \u0026#34;/var/named/data/named_stats.txt\u0026#34;;\n\tmemstatistics-file \u0026#34;/var/named/data/named_mem_stats.txt\u0026#34;;\n\tallow-query     { localhost; };\n\n\t/* \n\t \u003cspan class=\"k\"\u003e-\u003c/span\u003e If you are building an AUTHORITATIVE DNS server, do NOT enable recursion.\n\t \u003cspan class=\"k\"\u003e-\u003c/span\u003e If you are building a RECURSIVE (caching) DNS server, you need to enable \n\t   recursion. \n\t \u003cspan class=\"k\"\u003e-\u003c/span\u003e If your recursive DNS server has a public IP address, you MUST enable access \n\t   control to limit queries to your legitimate users. Failing to do so will\n\t   cause your server to become part of large scale DNS amplification \n\t   attacks. Implementing BCP38 within your network would greatly\n\t   reduce such attack surface \n\t*/\n\trecursion yes;\n\n\tdnssec-enable yes;\n\tdnssec-validation yes;\n\n\t/* Path to ISC DLV key */\n\tbindkeys-file \u0026#34;/etc/named.iscdlv.key\u0026#34;;\n\n\tmanaged-keys-directory \u0026#34;/var/named/dynamic\u0026#34;;\n\n\tpid-file \u0026#34;/run/named/named.pid\u0026#34;;\n\tsession-keyfile \u0026#34;/run/named/session.key\u0026#34;;\n};\n\nlogging {\n        channel default_debug {\n                file \u0026#34;data/named.run\u0026#34;;\n                severity dynamic;\n        };\n};\n\nzone \u0026#34;.\u0026#34; IN {\n\ttype hint;\n\tfile \u0026#34;named.ca\u0026#34;;\n};\n\ninclude \u0026#34;/etc/named.rfc1912.zones\u0026#34;;\ninclude \u0026#34;/etc/named.root.key\u0026#34;;\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e选项含义：\u003c/p\u003e\n\u003cp\u003e全局配置段：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eoptions {\n    # 在启动 DNS 服务时，named 进程所监听的套接字\n    listen-on port 53 {127.0.0.1; 10.10.24.32;};\n    \n    # 定义解析库（区域数据库文件）的根目录，在主配置文件中添加此配置语句之后，可以在后面定义区域数据库时使用相对路径\n    directory \u0026#34;/var/named\u0026#34;;\n    \n    # 访问控制语句，意思是允许本服务器处理那些主机发送来的解析查询请求，默认是localhost，即只允许本机以127.0.0.1发送查询请求\n    allow-query {localhost};\n    \n    # 允许本服务器为所有查询请求做递归查询\n    recursion yes;\n    \n    # 访问控制指令，允许这些客户端做递归查询\n    allow-recursion {172.16.1.74/16;};\n    \n    # 定义存放主进程 pid 文件的路径\n    pid-file \u0026#34;/run/named/named.pid\u0026#34;;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e区域配置段：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 声明一个区域名称，此名称要使用 FQDN 来表示，例如 xdhuxc.com\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ezone \u0026#34;FQDN\u0026#34; IN {\n    # 区域的类型\n    type master;   # 主区域\n    type slave;    # 辅助区域\n    type hint;     # 提示区域，仅能在根域上设置\n    type forward;  # 转发区域 \n    \n    # 存放于该域有关的解析信息的数据库文件的路径；如果是相对路径，则相对于在主配置文件的全局配置端中的 “directory” 指令所定义的目录而言。\n    # 注意：文件的所有权和权限设置必须能够让 named 用户有读取权限。\n    file \u0026#34;named.localhost\u0026#34;;\n    \n    # 访问控制指令，允许这些客户端对数据库内容进行动态更新，主要用于 DDNS\n    allow-update {none;};\n    \n    # 访问控制指令，允许这些主机能够从当前服务器进行区域传送 \n    allow-transfer {172.16.0.0/16;};\n    \n    # 访问控制指令，允许这些客户端做递归查询 \n    allow-recursion {172.16.1.74/16;};\n    \n    # 访问控制指令，允许这些主机进行区域内的解析查询 \n    allow-query { address_match_element;...};\n    \n    # 访问控制指令，允许这些主机向当前服务器发送区域变更通知 \n    allow-update { address_match_element;...};\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在修改完 bind 的配置文件之后，需要使用 named-checkconf 来检测文件的书写格式是否正确。\u003c/p\u003e\n\u003cp\u003e在检测完后，配置文件的内容并不会立即生效，因此我们需要重新读取 named 程序，可以使用 systemctl 命令，也可以使用 rndc reload 来读取。\u003c/p\u003e\n\u003cp\u003e区域配置文件示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ezone \u0026#34;FQDN\u0026#34; IN {\n    type master;\n    file \u0026#34;FQDN.zone\u0026#34;;\n    allow-update {none;};\n    allow-transfer {none;};\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当区域配置文件配置完成之后，我们需要在其数据库 /var/named/named.localhost 中添加记录，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$TTL 1D\n@\tIN SOA\t@ rname.invalid. (\n\t\t\t\t\t0\t    ; serial\n\t\t\t\t\t1D\t    ; refresh\n\t\t\t\t\t1H\t    ; retry\n\t\t\t\t\t1W\t    ; expire\n\t\t\t\t\t3H )\t; minimum\n\tNS\t@\n\tA\t127.0.0.1\n\tAAAA\t::1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在数据库中，有各种记录书写的格式，简要介绍各种记录的书写格式：\u003c/p\u003e\n\u003ch5 id=\"soa\"\u003eSOA\u003c/h5\u003e\n\u003cp\u003eDN|FQDN：当前域的域名，例如 xdhuxc.com，或者使用 @ 代替域名，@ 符号会使用主配置文件中定义的域名来代替\nVALUE：由以下几个部分组成：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e当前域中的主域名服务器的 FQDN\u003c/li\u003e\n\u003cli\u003e当前域的数据库管理员的邮箱地址，需要使用 . 来替代 @ ：root.xdhuxc.com\u003c/li\u003e\n\u003cli\u003e主域名服务器进行区域传送的相关时间参数的定义：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e(Serial Refresh Retry Expeir TTL)\n（\n    Serial;\n    Refresh;\n    Retry;\n    Expeir;\n    TTL;\n）\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"ns-记录\"\u003eNS 记录\u003c/h5\u003e\n\u003cp\u003ename：当前域的域名，可以写完全合格域名 FQDN，可以写 @ 占位，还可以省略不写，如果省略不写，则意味着该资源记录的名称与其上一条资源记录的名称相同。\nvalue：当前区域内被授权的域名服务器的 FQDN。\u003c/p\u003e\n\u003cp\u003e注意：\n1、一个域中有多少台域名服务器，就需要写多少个 NS 资源记录。\u003c/p\u003e\n\u003cp\u003e2、每个 NS 资源记录都必须要有一个 A 记录与之对应。\u003c/p\u003e\n\u003ch5 id=\"mx-记录\"\u003eMX 记录\u003c/h5\u003e\n\u003cp\u003ename：当前域的域名，可以写完全合格域名 FQDN，可以写 @ 占位，还可以省略不写，如果省略不写，则意味着该资源记录的名称与其上一条资源记录的名称相同。\nRR_TYPE：MS Priority\nvalue：当前域中有效的邮件服务器的 FQDN。\u003c/p\u003e\n\u003cp\u003e注意：\n1、一个域中，可以有多条 MX 资源记录，通过优先级的大小决定被使用的次序。\u003c/p\u003e\n\u003cp\u003e2、每个 MX 资源记录都必须对应一条 A 记录。\u003c/p\u003e\n\u003ch5 id=\"a-记录\"\u003eA 记录\u003c/h5\u003e\n\u003cp\u003ename：域中指定主机的 FQDN。\nvalue：该主机上真实有效的 IPV4 地址。\u003c/p\u003e\n\u003cp\u003e例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewww.xdhuxc.com 43200 IN A 192.168.1.1\nwww            43200 IN A 192.168.1.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e泛域名：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e*.xdhuxc.com 43200 IN A 192.168.1.1\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e            43200 IN A 192.168.1.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e直接域名解析：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003exdhuxc.com 43200 IN A 192.168.1.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e通常，泛域名或直接域名都是为了防止用户写错域名而导致无法给出正确的解析结果。\u003c/p\u003e\n\u003ch5 id=\"cname-记录\"\u003eCNAME 记录\u003c/h5\u003e\n\u003cp\u003ename：域中指定主机的别名。\nvalue：真正的主机的 FQDN。\u003c/p\u003e\n\u003cp\u003e例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eftp.xdhuxc.com [86400] IN CNAME www.xdhuxc.com\nftp [86400] IN CNAME www\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"ptr-记录\"\u003ePTR 记录：\u003c/h5\u003e\n\u003cp\u003ename：\n将 IP 地址的四个八位组反过来，将 IP 地址中的主机部分加上反向域的域名后缀\u003c/p\u003e\n\u003cp\u003e如果 IP 地址是：172.16.1.100/16，其对应的域名的写法为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e100.1 IN PTR www.xdhuxc.com \n100.1.16.172.in-addr.arpa. IN PTR www.xdhuxc.com \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"参考资料\"\u003e参考资料\u003c/h4\u003e\n\u003cp\u003e1、queryperf 性能测试工具\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/zhu_tianwei/article/details/45202899\"\u003ehttps://blog.csdn.net/zhu_tianwei/article/details/45202899\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e2、BIND 配置文件详解\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://blog.51cto.com/liujingyu/2102858\"\u003ehttp://blog.51cto.com/liujingyu/2102858\u003c/a\u003e\u003c/p\u003e","date":1543708800,"description":"","fuzzywordcount":2100,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"5eab2826f670807484b72263aa10030f","publishdate":1543708800,"relpermalink":"/posts/common/dns/dns-bind/","section":"posts","summary":"\u003cp\u003e本篇博客记录下 Bind 的安装和配置，以备后查。\u003c/p\u003e","tags":["Bind","DNS"],"title":"BIND 的安装和配置","url":"https://xdhuxc.github.io/posts/common/dns/dns-bind/","wordcount":2006},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了些计算机科学和技术中常见的概念的差别，属于基础知识。\u003c/p\u003e\n\u003ch3 id=\"uriurl和urn的区别\"\u003eURI，URL和URN的区别\u003c/h3\u003e\n\u003cp\u003e1）URI\u003c/p\u003e\n\u003cp\u003eURI 是 uniform resource identifier 的首字母大写，即统一资源标识符，用来唯一地标识一个资源。\u003c/p\u003e\n\u003cp\u003e2）URL\u003c/p\u003e\n\u003cp\u003eURL 是 uniform resource locator 的首字母大写，即统一资源定位符，是一种具体的 URI，即 URL 不仅可以用来标识一个资源，还指明了如何获取这个资源。\u003c/p\u003e\n\u003cp\u003e3）URN\u003c/p\u003e\n\u003cp\u003eURN 是 uniform resource name 的首字母大写，即统一资源命名，是通过名字来标识资源，比如mailto:java-net@java.sun.com。\u003c/p\u003e\n\u003cp\u003e也就是说，URI 是以一种抽象的、高层次概念定义统一资源标识，而URL和URN则是具体的资源标识方式，URL 和 URN 都是一种 URI。\u003c/p\u003e\n\u003cp\u003e在 Java 的 URI 中，一个 URI 实例可以代表绝对的，也可以是相对的，只要其符合 URI 的语法规则。\u003c/p\u003e\n\u003cp\u003e而 URL 类则不仅符合语义，还包含了定位该资源的信息，因此它不能是相对的，schema 必须被指定。\u003c/p\u003e\n\u003ch3 id=\"web-服务器和应用服务器\"\u003eWeb 服务器和应用服务器\u003c/h3\u003e\n\u003cp\u003e1）Web服务器\u003c/p\u003e\n\u003cp\u003eWeb服务器的基本功能就是提供Web信息浏览服务。它只需支持HTTP协议、HTML文档格式及URL，与客户端的网络浏览器配合，只能发送静态页面的内容。因为Web服务器主要支持的协议就是HTTP，所以通常情况下HTTP服务器和WEB服务器是相等的。Web服务器包括Nginx，Apache，IIS等\u003c/p\u003e\n\u003cp\u003e2）应用服务器\u003c/p\u003e\n\u003cp\u003e应用程序服务器让多个用户可以同时使用应用程序，通常是客户创建的应用程序。应用服务器包括WebLogic，JBoss，Tomcat，websphere等。\u003c/p\u003e\n\u003ch3 id=\"127001-和-localhost\"\u003e127.0.0.1 和 localhost\u003c/h3\u003e\n\u003cp\u003e1、含义不同：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003elocalhost\u003c/code\u003e 也叫 \u003ccode\u003elocal\u003c/code\u003e ，是一个域名，可以调用 gethostname() 解析出对应的 IP 地址，其值为：\u003ccode\u003ehosts\u003c/code\u003e 文件中的值，正确的解释是: 本地服务器\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e127.0.0.1\u003c/code\u003e，是一个 IPv4 的地址， 在 \u003ccode\u003ewindows\u003c/code\u003e 等系统的正确解释是: 本机地址(本机服务器)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2、与防火墙和网卡的关系\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003elocalhost\u003c/code\u003e 是不经网卡传输！这点很重要，它不受网络防火墙和网卡相关的的限制。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e127.0.0.1\u003c/code\u003e 是通过网卡传输，依赖网卡，并受到网络防火墙和网卡相关的限制。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"用户态和内核态\"\u003e用户态和内核态\u003c/h3\u003e\n\u003cp\u003e操作系统需要两种CPU状态：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e内核态（Kernel Mode）：运行操作系统程序。\u003c/li\u003e\n\u003cli\u003e用户态（User Mode）：运行用户程序。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e指令划分：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e特权指令：只能由操作系统使用，用户程序不能使用的指令。例如，启动I/O，内存清零，修改程序状态字，设置时钟，允许/禁止终端，停机。\u003c/li\u003e\n\u003cli\u003e非特权指令：用户程序可以使用的指令，例如，控制转移，算术运算，取数指令，访管指令（使用户程序从用户态进入内核态）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e特权级别：\u003c/p\u003e\n\u003cp\u003e特权环：R0，R1，R2，R3。\u003c/p\u003e\n\u003cp\u003eR0相当于内核态，R3相当于用户态。\u003c/p\u003e\n\u003cp\u003e不同级别能够运行不同的指令集合。\u003c/p\u003e\n\u003cp\u003eCPU 状态之间的转换：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e用户态 ——\u0026gt; 内核态：唯一途径是通过中断、异常、陷入机制（访管指令）\u003c/li\u003e\n\u003cli\u003e内核态 ——\u0026gt; 用户态：设置程序状态字PSW。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e内核态与用户态的区别：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e内核态与用户态是操作系统的两种运行级别，当程序运行在3级特权级上之时，就可以称之为运行在用户态。因为这是最低特权级，是普通的用户进程运行的特权级，大部分用户直接面对的程序都是运行在用户态。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e当程序运行在0级特权级上时，就可以称之为运行在内核态。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e运行在用户态下的程序不能直接访问操作系统内核数据结构和程序。当我们在系统中执行一个程序时，大部分时间是运行在用户态下的，在其需要操作系统帮助完成某些它没有权力和能力完成的工作时就会切换到内核态。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e这两种状态的主要差别是：\n1、处于用户态执行时，进程所能访问的内存空间和对象受到限制，其所处于占有的处理机是可以被抢占的。\u003c/p\u003e\n\u003cp\u003e2、处于内核态执行中的进程，则能访问所有的内存空间和对象，且所占有的处理机是不允许被抢占的。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e通常来说，以下三种情况会导致用户态到内核态的切换：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e系统调用，这是用户态进程主动请求切换到内核态的一种方式，用户态进程通过系统调用申请使用操作系统提供的服务程序完成工作。比如，fork() 函数实际上就是执行了一个创建新进程的系统调用。而系统调用的机制其核心还是使用了操作系统为用户特别开放的一个中断来实现，例如 Linux 的 int 80h 中断。\u003c/li\u003e\n\u003cli\u003e异常，当 CPU 在执行运行在用户态下的程序时，发生了某些事先不可知的异常，这时会触发由当前运行进程切换到处理此异常的内核相关程序中，也就转到了内核态，比如缺页异常。\u003c/li\u003e\n\u003cli\u003e外围设备的中断，当外围设备完成用户请求的操作后，会向 CPU 发出相应的中断信号，这时CPU会暂停执行下一条即将要执行的指令，转而去执行与中断信号对应的处理程序。如果先前执行的指令是用户态下的程序，那么这个转换的过程自然也就发生了由用户态到内核态的切换。比如硬盘读写操作完成，系统会切换到硬盘读写的中断处理程序中执行后续操作等。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e这三种方式是系统在运行时由用户态转到内核态的最主要方式，其中系统调用可以认为是用户进程主动发起的，异常和外围设备中断则是被动的。\u003c/p\u003e\n\u003ch3 id=\"进程与线程\"\u003e进程与线程\u003c/h3\u003e\n\u003ch4 id=\"定义\"\u003e定义\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e进程：具有一定独立功能的程序关于某个数据集合上的一次执行活动，是系统进行资源分配和调度的一个独立单位。\u003c/li\u003e\n\u003cli\u003e线程：是进程的一个实体，是CPU调度和分派的基本单位，是比进程更小的能独立运行的基本单位。线程本身基本上不拥有系统资源，只拥有一点在运行中必不可少的资源（例如，程序计数器、一组寄存器和栈等），但是它可以与同属于一个进程的其他线程共享进程所拥有的全部资源。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"关系\"\u003e关系\u003c/h4\u003e\n\u003cp\u003e一个进程可以创建和撤销一个线程；同一个进程中的多个线程之间可以并发执行。\u003c/p\u003e\n\u003cp\u003e相对于进程而言，线程是一个更加接近于执行体的概念，可以与同进程中的其他线程共享全局变量、静态变量等数据，但拥有自己的栈空间，拥有独立的执行序列。\u003c/p\u003e\n\u003ch4 id=\"区别\"\u003e区别\u003c/h4\u003e\n\u003cp\u003e进程和线程的主要差别在于它们是不同的操作系统资源管理方式。\u003c/p\u003e\n\u003cp\u003e进程有独立的地址空间，一个进程崩溃后，在保护模式下不会对其它进程产生影响；而线程只是一个进程中的不同执行路径。\u003c/p\u003e\n\u003cp\u003e线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，资源耗费较大，效率要差一些。\u003c/p\u003e\n\u003cp\u003e但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。\u003c/p\u003e\n\u003cp\u003e总结：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e一个程序至少有一个进程，一个进程至少有一个线程。\u003c/li\u003e\n\u003cli\u003e线程的划分尺度小于进程，使得多线程程序的并发性高。\u003c/li\u003e\n\u003cli\u003e进程在执行过程中拥有独立的内存单元，而同一个进程中的多个线程共享内存，从而极大地提高了程序的运行效率。\u003c/li\u003e\n\u003cli\u003e线程在执行过程中与进程还是有区别的。每个独立的线程有一个程序运行的入口、顺序执行序列和程序的出口，但是线程不能够独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制。\u003c/li\u003e\n\u003cli\u003e从逻辑角度来看，多线程的意义在于在一个应用程序中，有多个执行部分可以并发执行。但是操作系统并没有将多个线程看做多个独立的应用来实现进程的调度和管理以及资源分配，这是进程和线程的重要区别。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"优缺点\"\u003e优缺点\u003c/h4\u003e\n\u003cp\u003e线程和进程在使用上各有优缺点：\n线程执行开销小，但不利于资源的管理和保护；而进程则正好相反。\n另外，线程适合于在SMP机器上运行，而进程则可以跨机器迁移。\u003c/p\u003e\n\u003ch3 id=\"ab-测试\"\u003eAB 测试\u003c/h3\u003e\n\u003cp\u003eAB测试是为Web或App界面或流程制作A/B两个版本，在同一时间维度，分别让组成成分相同（相似）的访客群组随机的访问这些版本，收集各群组的用户体验数据和业务数据，最后分析评估出最好版本正式采用。\u003c/p\u003e\n\u003cp\u003e在App和Web开发阶段，程序中添加用于制作A/B版本和采集数据的代码由此引起的开发和QA的工作量很大，ROI（return on investment）很低。AB测试的场景受到限制，App和Web发布后，无法再增加和更改AB测试场景。额外的A/B测试代码，增加了App和Web后期维护成本。\u003c/p\u003e\n\u003ch3 id=\"持续集成持续部署持续交付\"\u003e持续集成/持续部署/持续交付\u003c/h3\u003e\n\u003cp\u003e持续集成是指软件个人研发的部分向软件整体部分交付，频繁进行集成以便更快地发现其中的错误。\u003c/p\u003e\n\u003cp\u003e持续部署是指当交付的代码通过评审之后，自动部署到生产环境，这意味着所有通过了一系列的自动化测试的改动都将自动部署到生产环境。\u003c/p\u003e\n\u003cp\u003e持续交付涵盖了软件交付端到端的整个周期，其覆盖面不仅仅包括编码，还包括：设计、测试、部署、运维、运营等等。\u003c/p\u003e","date":1543708800,"description":"","fuzzywordcount":3200,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"f408d5612cc3f3d21fdae944ba2bc3d2","publishdate":1543708800,"relpermalink":"/posts/common/common-knowledge/","section":"posts","summary":"\u003cp\u003e本篇博客记录了些计算机科学和技术中常见的概念的差别，属于基础知识。\u003c/p\u003e","tags":["Java"],"title":"一些计算机科学和技术中的概念区分","url":"https://xdhuxc.github.io/posts/common/common-knowledge/","wordcount":3194},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了使用 maven 时的一些常用的配置。\u003c/p\u003e\n\u003ch3 id=\"配置-maven-仓库\"\u003e配置 maven 仓库\u003c/h3\u003e\n\u003cp\u003e配置阿里云的 \u003ccode\u003emaven\u003c/code\u003e 仓库，在 \u003ccode\u003ewindows\u003c/code\u003e 系统中，在 \u003ccode\u003eapache-maven-3.5.2/conf/settings.xml\u003c/code\u003e 中配置如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emirrors\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emirror\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ealimaven\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ealiyun maven\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ehttp://maven.aliyun.com/nexus/content/groups/public/\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emirrorOf\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ecentral\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003emirrorOf\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e        \n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003emirror\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003emirrors\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者在 \u003ccode\u003epom.xml\u003c/code\u003e 的 \u003ccode\u003erepositories\u003c/code\u003e 中添加如下配置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003erepositories\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003erepository\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ealiyunmaven\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ehttp://maven.aliyun.com/nexus/content/groups/public/\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003erepository\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003erepositories\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"properties-的配置\"\u003eProperties 的配置\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eproject.build.sourceEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eUTF-8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eproject.build.sourceEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eproject.reporting.outputEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eUTF-8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eproject.reporting.outputEncoding\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ejava.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ejava.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"设置-maven-工程使用的-java-版本\"\u003e设置 maven 工程使用的 Java 版本\u003c/h3\u003e\n\u003ch4 id=\"全局配置\"\u003e全局配置\u003c/h4\u003e\n\u003cp\u003e在 \u003ccode\u003emaven\u003c/code\u003e 的安装目录下，\u003ccode\u003eapache-maven-3.5.2/conf\u003c/code\u003e 目录下的 \u003ccode\u003esettings.xml\u003c/code\u003e 文件中，在 \u003ccode\u003e\u0026lt;profiles\u0026gt;\u0026lt;/profiles\u0026gt;\u003c/code\u003e 之间添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ejdk18\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eactivation\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eactiveByDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etrue\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eactiveByDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ejdk\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ejdk\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eactivation\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emaven.compiler.source\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003emaven.compiler.source\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emaven.compiler.target\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003emaven.compiler.target\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emaven.compiler.compilerVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003emaven.compiler.compilerVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e   \n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"局部配置\"\u003e局部配置\u003c/h4\u003e\n\u003cp\u003e在该工程的pom文件中，添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebuild\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.apache.maven.plugins\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003emaven-compiler-plugin\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n                \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003esource\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n                \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etarget\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etarget\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n            \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ebuild\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1543104000,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1543104000,"objectID":"19b0cb8488f7b5e32f719d960688dbb5","publishdate":-62135596800,"relpermalink":"/posts/programming/java/java-maven-configuration/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了使用 maven 时的一些常用的配置。\u003c/p\u003e","tags":["Maven","Java"],"title":"Maven 常用配置","url":"https://xdhuxc.github.io/posts/programming/java/java-maven-configuration/","wordcount":243},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了些在 Java 开发过程中常见的问题及解决方法，以备后查。\u003c/p\u003e\n\u003ch3 id=\"linux-下验证码无法显示问题\"\u003eLinux 下验证码无法显示问题\u003c/h3\u003e\n\u003cp\u003e现象：\u003c/p\u003e\n\u003cp\u003eweb 应用在 windows 和 开发 Linux 服务器验证码显示正常，部署到新的生产 Linux 服务器上，验证码无法显示\u003c/p\u003e\n\u003cp\u003e异常日志：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCan\u0026#39;t connect to X11 window server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e问题原因：\u003c/p\u003e\n\u003cp\u003eJava 在图形处理时调用了本地的图形处理库。在利用 Java 做图形处理（比如，图片缩放、图片签名、生成报表），如果运行在 windows 上不会出问题。如果将程序移植到 Linux/Unix 上，有可能出现图形不能显示的错误，这是由于 Linux 的图形处理需要一个 X server 服务器。\u003c/p\u003e\n\u003cp\u003e问题解决方法：\u003c/p\u003e\n\u003cp\u003e1、检查 JDK 版本，不能使用 OpenJDK。\u003c/p\u003e\n\u003cp\u003e2、在 Tomcat 中，修改 catalina.sh，加入如下行：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eJAVA_OPTS=\u0026#34;-Djava.awt.headless=True\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果名字为 java.awt.headless 的系统属性被设置为 True，那么 headless 工具包就会被使用。应用程序可以执行如下操作：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e创建轻量级组件。\u003c/li\u003e\n\u003cli\u003e收集关于可用的字体、字体指标和字体设置的信息。\u003c/li\u003e\n\u003cli\u003e设置颜色来渲染准备图片。\u003c/li\u003e\n\u003cli\u003e创造和获取图像，为渲染准备图片。\u003c/li\u003e\n\u003cli\u003e使用 java.awt.PrintJob，java.awt.print.* 和 javax.print.* 类里的打印方法。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e3、在 Jetty 中，修改 jetty.sh 中 JAVA_OPTIONS 参数，加入如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eJAVA_OPTIONS+=(\u0026#34;-Djava.awt.headless=True\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、终极解决\n一般是在程序开始激活 headless 模式，告诉程序，现在要工作在 Headless 模式下，就不要指望硬件帮忙了，得依靠系统的计算能力模拟出这些特性来\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epublic void init(ServletConfig config) throws ServletException {\n    super.init(config);\n    height = Integer.parseInt(getServletConfig().getInitParameter(\u0026#34;height\u0026#34;));\n    width = Integer.parseInt(getServletConfig().getInitParameter(\u0026#34;width\u0026#34;));\n    System.setProperty(\u0026#34;java.awt.headless\u0026#34;, \u0026#34;True\u0026#34;);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"webxml-is-missing-and-failonmissingwebxml-is-set-to-true\"\u003eweb.xml is missing and \u003cfailOnMissingWebXml\u003e is set to true\u003c/h3\u003e\n\u003cp\u003e使用 \u003ccode\u003emaven\u003c/code\u003e 构建工程时，\u003ccode\u003epom.xml\u003c/code\u003e 报错如下，提示如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eweb.xml is missing and \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003efailOnMissingWebXml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e is set to true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003epom.xml\u003c/code\u003e 文件中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebuild\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.apache.maven.plugins\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003emaven-war-plugin\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e3.2.0\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003efailOnMissingWebXml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003efalse\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003efailOnMissingWebXml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ebuild\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"slf4j-failed-to-load-class-orgslf4jimplstaticloggerbinder\"\u003eSLF4J: Failed to load class \u0026quot;org.slf4j.impl.StaticLoggerBinder\u0026quot;.\u003c/h3\u003e\n\u003cp\u003e运行程序时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eSLF4J: Failed to load class \u0026#34;org.slf4j.impl.StaticLoggerBinder\u0026#34;.\nSLF4J: Defaulting to no-operation (NOP) logger implementation\nSLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因：\u003ccode\u003elog4j\u003c/code\u003e 和 \u003ccode\u003esl4j\u003c/code\u003e 的版本不匹配，或是缺少 \u003ccode\u003ejar\u003c/code\u003e 包，使用下面这组：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eslf4j-log4j12.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.7.25\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eslf4j-log4j12.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eslf4j-api.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.7.25\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eslf4j-api.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003elog4j.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.2.17\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003elog4j.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eslf4j-nop.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.7.25\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eslf4j-nop.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eslf4j-simple.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.7.5\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eslf4j-simple.version\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e\u0026lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-log4j12 --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.slf4j\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eslf4j-log4j12\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e${slf4j-log4j12.version}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escope\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etest\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escope\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e\u0026lt;!-- https://mvnrepository.com/artifact/log4j/log4j --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003elog4j\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003elog4j\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e${log4j.version}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e\u0026lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-api --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.slf4j\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eslf4j-api\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e${slf4j-api.version}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e\u0026lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-nop --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.slf4j\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eslf4j-nop\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e${slf4j-nop.version}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escope\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etest\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escope\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.slf4j\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eslf4j-simple\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e${slf4j-simple.version}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"caused-by-javaniocharsetmalformedinputexception-input-length--1\"\u003eCaused by: java.nio.charset.MalformedInputException: Input length = 1\u003c/h3\u003e\n\u003cp\u003e程序运行时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCaused by: java.nio.charset.MalformedInputException: Input length = 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因：当输入字节序列对于给定 \u003ccode\u003echarset\u003c/code\u003e 来说是不合法的，或者输入字符序列不是合法的 \u003ccode\u003e16\u003c/code\u003e 位 \u003ccode\u003eUnicode\u003c/code\u003e 序列时，抛出此经过检查的异常。\u003c/p\u003e\n\u003cp\u003e解决：将当前配置文件的编码设置为 \u003ccode\u003eUTF-8\u003c/code\u003e。\u003c/p\u003e","date":1542844800,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"055c6da812f35e541d21bedf6ba2eac1","publishdate":1542844800,"relpermalink":"/posts/programming/java/java-questions-and-solution/","section":"posts","summary":"\u003cp\u003e本篇博客记录了些在 Java 开发过程中常见的问题及解决方法，以备后查。\u003c/p\u003e","tags":["Java"],"title":"Java 常见问题及解决","url":"https://xdhuxc.github.io/posts/programming/java/java-questions-and-solution/","wordcount":862},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 JVM 的一些参数，在 JVM 调优时需要用到。\u003c/p\u003e\n\u003ch3 id=\"堆大小设置\"\u003e堆大小设置\u003c/h3\u003e\n\u003cp\u003eJVM中最大堆大小有三方面限制：\u003c/p\u003e\n\u003cp\u003e1、相关操作系统的数据模型（32位机器还是64位机器）限制，32位系统下，一般限制在1.5G~2G，64位操作系统对内存无限制。\n2、系统的可用虚拟内存限制。\n3、系统的可用物理内存限制。\u003c/p\u003e\n\u003ch3 id=\"配置含义\"\u003e配置含义\u003c/h3\u003e\n\u003cp\u003e-server：服务器模式\u003c/p\u003e\n\u003cp\u003e-Xms1024M 为 JVM 启动时分配的堆内存，一般和Xmx配置成一样，以避免每次GC后JVM重新分配内存。比如，-Xms200M，表示分配200M\u003c/p\u003e\n\u003cp\u003e-Xmx1024 为 JVM 运行过程中分配的最大堆内存，按需分配。比如，-Xmx1024M，表示 JVM 进程最多只能够占用 1024M 内存。\u003c/p\u003e\n\u003cp\u003e-Xss256K 为 JVM 启动的每个线程分配的堆栈内存大小，默认JDK1.4中是256K，JDK1.5+中是1M。\u003c/p\u003e\n\u003cp\u003e-XX:+DisableExplicitGC：忽略手动调用GC，System.gc()的调用就会变成一个空调用，不会触发GC。\u003c/p\u003e\n\u003ch3 id=\"jvm参数\"\u003eJVM参数\u003c/h3\u003e\n\u003cp\u003e-XX 参数被称为不稳定参数，此类参数的设置很容易引起JVM性能上的差异\u003c/p\u003e\n\u003cp\u003e不稳定参数语法规则：\u003c/p\u003e\n\u003cp\u003e1、布尔类型\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e-XX:+\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u0026#34;+\u0026#34;表示启用该选项\n-XX:+\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u0026#34;-\u0026#34;表示关闭该选项\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、数字类型\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e-XX:\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e=\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003enumber\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e # 可跟随单位，例如，“m”或“M”表示兆字节，“k”或“K”表示千字节，“g”或“G”表示千兆字节。32K与32768是相同大小的。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、字符串类型\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e-XX:\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eoption\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e=\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e # 通常用于指定一个文件、路径或一系列命令列表，例如：-XX:HeapDumpPath=./dump.core\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"远程调试\"\u003e远程调试\u003c/h3\u003e\n\u003cp\u003e远程调试时，添加如下JVM参数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e-Xdebug -Xrunjdwp:transport:dt_socket,address=8899,server=y,suspend=n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003etransport：debugee 与 debuger 调试时之间的通讯数据传输方式。\u003c/li\u003e\n\u003cli\u003eserver：是否监听 debuger 的调试请求。\u003c/li\u003e\n\u003cli\u003esuspend：是否等待启动，也即，设置是否在 debuger 调试连接建立后才启动 debugee JVM。\u003c/li\u003e\n\u003cli\u003eaddress：debugee的地址，用于 debuger 建立调试连接。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e远程调试时，JAVA_OPTS 设置示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eJAVA_OPTS=-server -Xms1400m -Xmx1400m -Xss4096K -XX:PermSize=128m -XX:MaxPermSize=256m -Duser.timezone=GMT+08 -Dfile.encoding=UTF8 -Dsun.jnu.encoding=UTF8 -Djava.awt.headless=true -XX:+DisableExplicitGC -Xdebug -Xrunjdwp:transport=dt_socket,address=8899,server=y,suspend=n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1542844800,"description":"","fuzzywordcount":800,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"8dc0c9e5d39be67a0a6c291ade416f0a","publishdate":1542844800,"relpermalink":"/posts/programming/java/java-jvm-parameter/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 JVM 的一些参数，在 JVM 调优时需要用到。\u003c/p\u003e","tags":["Java"],"title":"JVM 参数详解","url":"https://xdhuxc.github.io/posts/programming/java/java-jvm-parameter/","wordcount":791},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了安装 \u003ccode\u003emaven\u003c/code\u003e 的步骤。\u003c/p\u003e\n\u003ch3 id=\"安装-maven\"\u003e安装 maven\u003c/h3\u003e\n\u003cp\u003e1、下载 \u003ccode\u003emaven\u003c/code\u003e 安装包，下载地址为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://maven.apache.org/download.cgi\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e下载并解压之。\u003c/p\u003e\n\u003cp\u003e2、检查并配置 \u003ccode\u003eJAVA_HOME\u003c/code\u003e，\u003ccode\u003eMAVEN_HOME\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e（1）查找 \u003ccode\u003ejava\u003c/code\u003e 安装目录，并配置 \u003ccode\u003eJAVA_HOME\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc apache-maven-3.5.4]# find / -name java\n/usr/bin/java\n/usr/share/java\n/usr/lib/gcc/x86_64-redhat-linux/4.8.2/plugin/include/java\n/usr/lib/java\n/usr/java\n/usr/java/jdk1.8.0_171-amd64/bin/java     # 安装的官方 Java\n/usr/java/jdk1.8.0_171-amd64/jre/bin/java\n/var/lib/alternatives/java\n/var/lib/docker/overlay2/7f36ad36ff79b7cef239f31a147541b66652a320d05bc77737b797bba1d2c411/merged/usr/share/java\n/var/lib/docker/overlay2/0ccde8693a9840f6948d05e6d41238e8d0d993b6c15567f485e43038b09baa03/diff/usr/share/java\n/etc/alternatives/java\n/etc/pki/ca-trust/extracted/java\n/etc/pki/java\n/etc/java\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003e/etc/profile\u003c/code\u003e 中配置 \u003ccode\u003eJAVA_HOME\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport JAVA_HOME=/usr/java/jdk1.8.0_171-amd64\nexport PATH=${JAVA_HOME}/bin:$PATH\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行 \u003ccode\u003e. /etc/profile\u003c/code\u003e 或 \u003ccode\u003esource /etc/profile\u003c/code\u003e 使配置生效。\u003c/p\u003e\n\u003cp\u003e执行测试命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# java -version\njava version \u0026#34;1.8.0_171\u0026#34;\nJava(TM) SE Runtime Environment (build 1.8.0_171-b11)\nJava HotSpot(TM) 64-Bit Server VM (build 25.171-b11, mixed mode)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e（2）配置 \u003ccode\u003eMAVEN_HOME\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003emaven\u003c/code\u003e 的安装目录为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc apache-maven-3.5.4]# pwd\n/root/xdhuxc/apache-maven-3.5.4\n[root@xdhuxc apache-maven-3.5.4]# ls\nbin  boot  conf  lib  LICENSE  NOTICE  README.txt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003e/etc/profile\u003c/code\u003e 中配置 \u003ccode\u003eMAVEN_HOME\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport MAVEN_HOME=/root/xdhuxc/apache-maven-3.5.4\nexport PATH=${JAVA_HOME}/bin:${MAVEN_HOME}/bin:$PATH\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行 \u003ccode\u003e. /etc/profile\u003c/code\u003e 或 \u003ccode\u003esource /etc/profile\u003c/code\u003e 使配置生效。\u003c/p\u003e\n\u003cp\u003e执行测试命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# mvn -v\nApache Maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-18T02:33:14+08:00)\nMaven home: /root/xdhuxc/apache-maven-3.5.4\nJava version: 1.8.0_171, vendor: Oracle Corporation, runtime: /usr/java/jdk1.8.0_171-amd64/jre\nDefault locale: en_US, platform encoding: UTF-8\nOS name: \u0026#34;linux\u0026#34;, version: \u0026#34;3.10.0-327.28.3.el7.x86_64\u0026#34;, arch: \u0026#34;amd64\u0026#34;, family: \u0026#34;unix\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1542844800,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"b66f5aa0f6d9ff5f78ef083171bf06da","publishdate":1542844800,"relpermalink":"/posts/programming/java/java-install-maven/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了安装 \u003ccode\u003emaven\u003c/code\u003e 的步骤。\u003c/p\u003e","tags":["Java","Maven"],"title":"安装 Maven","url":"https://xdhuxc.github.io/posts/programming/java/java-install-maven/","wordcount":287},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在使用 Kubernetes 的过程中常见的问题及解决方法。\u003c/p\u003e\n\u003cp\u003e1、使用 kubectl 命令时，要求输入用户名和密码\u003c/p\u003e\n\u003cp\u003e解决：删除 ~/.kube 目录下的 config 文件。\u003c/p\u003e\n\u003cp\u003e2、kubernetes 禁用 Swap 的原因\u003c/p\u003e\n\u003cp\u003e当前的 QOS 策略都是假定主机不启用内存 Swap。如果主机启用了 Swap，那么 QOS 策略可能会失效。\u003c/p\u003e\n\u003cp\u003e例如，两个 Pod 都刚好达到了内存限制上限，由于内存 Swap 机制，它们还可以继续申请使用更多内存，如果 Swap 空间不足，那么最终这两个 Pod 中的进程可能会被杀掉。\u003c/p\u003e\n\u003cp\u003e目前 Kubernetes 和 Docker 尚不支持内存 Swap 空间的隔离机制。\u003c/p\u003e\n\u003cp\u003e3、在 \u003ccode\u003enode\u003c/code\u003e 节点上使用 \u003ccode\u003ekubectl\u003c/code\u003e 命令时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-172 ~]# kubectl get nodes\nThe connection to the server localhost:8080 was refused - did you specify the right host or port?\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e由提示可知，kubectl找不到master节点，所以，需要设置参数，让它找到master。\u003c/p\u003e\n\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e1）在node节点的/etc/profile文件中加入如下环境变量：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport KUBERNETES_MASTER=http://192.168.91.128:8080\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后执行 \u003ccode\u003esource /etc/profile\u003c/code\u003e 或 \u003ccode\u003e. /etc/profile\u003c/code\u003e 命令使配置生效。\u003c/p\u003e\n\u003cp\u003e192.168.91.128为kubernetes集群master节点的IP地址。\u003c/p\u003e\n\u003cp\u003e2）在执行kubectl命令时，在命令中指定master的IP地址，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-172 ~]# kubectl -s http://172.20.27.207:8080 get nodes\nNAME                STATUS    ROLES     AGE       VERSION\nk8s-172.20.27.208   Ready     ingress   5h        v1.8.4\nk8s-master          Ready     master    1d        v1.8.4\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）在 ~/.kube/config 中配置 kubectl 访问 API server 的地址\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir ~/.kube/ \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \\cp -f /etc/kubernetes/admin.conf ~/.kube/config\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4）在 /etc/kubernetes/admin.conf 中配置 kubectl 访问 API server 的地址\u003c/p\u003e\n\u003cp\u003e4、删除 pod 后，pod 一直处于 Terminating 状态，可以使用如下方法删除\u003c/p\u003e\n\u003cp\u003e1）强制删除该 pod\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl delete pod aym91ga9-5c7c8ccc94-lfrfb -n c87e2267-1001-4c70-bb2a-ab41f3b81aa3 --grace-period=0 --force\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）删除该 pod 所在的 namespace\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl delete namespace c87e2267-1001-4c70-bb2a-ab41f3b81aa3\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、删除 namespace 后，提示删除成功，但是却一直处于 Terminating 状态，\n强制删除该 namespace 下的所有 pod，然后该 namespace 将会被系统自动删除。\u003c/p\u003e\n\u003cp\u003e6、应用部署完毕后，状态全部正常，但是访问却 504，\u003c/p\u003e\n\u003cp\u003e注意，不要使虚拟机的 IP 地址和 calico 的子网 IP 地址一样。如果有冲突，需要进行修改 calico.yaml 中环境变量 CALICO_IPV4POOL_CIDR 的值，修改为新的子网地址，然后删除原有的 calico，ingress 和 kube-dns，依次重新创建 calico，ingress，kube-dns\u003c/p\u003e\n\u003cp\u003e7、应用开发完毕后，本地启动没有问题，可以正常运行，但部署到 kubernetes 上后，web 服务总是启动不起来，进入 pod 中使用 netstat 查看后，发现有个需要连接的 IP 地址的状态为：syn_wait\u003c/p\u003e\n\u003cp\u003e解决：当下游服务连接不通时，往往会导致 web 服务器启动不起来。经过运维同事打开安全组，服务终于正常运行了。\u003c/p\u003e","date":1542412800,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1542499200,"objectID":"9e63d6d0fe02c19778353986f6e100f9","publishdate":1542412800,"relpermalink":"/posts/kubernetes/kubernetes-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在使用 Kubernetes 的过程中常见的问题及解决方法。\u003c/p\u003e","tags":["Kubernetes"],"title":"Kubernetes 常见问题及解决","url":"https://xdhuxc.github.io/posts/kubernetes/kubernetes-questions-and-solutions/","wordcount":891},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下 calico 常用的命令。\u003c/p\u003e\n\u003ch3 id=\"calico-命令\"\u003ecalico 命令\u003c/h3\u003e\n\u003cp\u003e1、查看节点状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecalicoctl node status # 查看节点状态 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，该命令不显示当前节点状态。\u003c/p\u003e\n\u003cp\u003e2、查看IP池\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecalicoctl get ippool -o wide\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1542240000,"description":"","fuzzywordcount":100,"kind":"page","lang":"zh","lastmod":1543276800,"objectID":"a24fb1387927408aed7eddc31664b1e5","publishdate":1542240000,"relpermalink":"/posts/mixed/calico/calico-command/","section":"posts","summary":"\u003cp\u003e本篇博客记录下 calico 常用的命令。\u003c/p\u003e","tags":["calico"],"title":"Calico 常用命令","url":"https://xdhuxc.github.io/posts/mixed/calico/calico-command/","wordcount":65},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在 Kubernetes 中常用的命令，以备后需。\u003c/p\u003e\n\u003ch2 id=\"常用命令\"\u003e常用命令\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e以下操作均假设在含 kubelet 的节点上执行命令\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"集群信息\"\u003e集群信息\u003c/h3\u003e\n\u003cp\u003e1、查看集群信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master ~]# kubectl cluster-info\nKubernetes master is running at https://172.20.26.150:6443\nKubeDNS is running at https://172.20.26.150:6443/api/v1/namespaces/kube-system/services/kube-dns/proxy\n\nTo further debug and diagnose cluster problems, use \u0026#39;kubectl cluster-info dump\u0026#39;.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看当前上下文\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master ~]# kubectl config current-context\nkubernetes-admin@kubernetes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查看各组件状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl -s http://192.168.8.8:8080 get componentstatuses\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、获取 kubectl 版本信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl version\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、获取集群信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl cluster-info\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"标签操作\"\u003e标签操作\u003c/h3\u003e\n\u003cp\u003e1、给 master 节点打标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl label nodes xxxxxx node-role.kubernetes.io/master=\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、给 ingress 节点打标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl label nodes k8s-172.20.27.215 node-role.kubernetes.io/ingress=\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"资源操作\"\u003e资源操作\u003c/h3\u003e\n\u003cp\u003e1、查看所有的 deployment\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get deployment --all-namespaces\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看所有的命名空间\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl -s http://172.20.27.207:8080 get pods --all-namespaces\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查看当前节点状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get nodes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当 节点的 STATUS 为 ready 时，说明情况正常。\u003c/p\u003e\n\u003cp\u003e4、查看所有 pod 信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get pod --all-namespaces\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当 pod 的 STATUS 为 running 时，说明情况正常。\u003c/p\u003e\n\u003cp\u003e5、查看指定命令空间下的pod\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get pod -n kube-system # 通过 -n 参数指定待查命名空间。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、查看 pod 的详细情况\n假定pod的名称为：ai2yzbme-8f7c9f77f-66cwv，所属命名空间为：kube-system\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl describe pod ai2yzbme-8f7c9f77f-66cwv -n kube-system\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、查看 node 的情况\n假设node的名称为：k8s-master\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl describe node k8s-master\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、查看 ConfigMap\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get configMap -n kube-system\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e9、查看指定的 ConfigMap\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get configMap calico-config  -n kube-system -o yaml\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e10、创建资源对象\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl create -f ./xdhuxc.yaml\nkubectl create -f ./xdhuxc.yaml -f ./zabuqk.yaml\nkubectl create -f ./xdhuxc\nkubectl create -f http://xdhuxc/xdhuxc.yaml\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e11、显示带有标签 env=production 的所有 pod\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get pods -l env=production\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e12、列出所有的服务，并通过名称排序\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get services --sort-by=.metadata.name\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e13、给 pod 打标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl label pods xdhuxc-message new-label=xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e14、给 pod 添加注解\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl annotate pods xdhuxc-message icon-url=http://xdhuxc.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e15、扩容及缩容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl scale --replicas=3 deployment nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e16、在已有 pod 里面运行命令，pod 中含有多个容器的情况下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl exec xdhuxc-message -c xdhuxc-message -- ls /\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e17、在已运行的 pod 里面运行命令，仅有一个容器的情况下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl exec -it xdhuxc-message -n kube-admin bash\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e18、将服务转发到端口\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl port-forward xdhuxc-message 8080\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e19、将 Pod 的端口转发到本地机器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl port-forward web-port 8080\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e20、以交互式 shell 运行 pod\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl run -i --tty busybox --image=busybox -- sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e21、连接到运行着的容器里\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl attach -i xdhuxc-message\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e22、 DNS 查找\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl exec busybox -- nslookup kubernetes\nkubectl exec busybox -- nslookup kubernetes.default\nkubectl exec busybox -- nslookup kubernetes.default.svc.cluster.local\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e23、暴露服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl expose deployment nginx --port=80 --type=LoadBalancer\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e24、查看指定ServiceAccount的token\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master dashboard]# kubectl get ServiceAccount kubernetes-dashboard -n kube-system -o jsonpath=\u0026#34;{.secrets[].name}\u0026#34;\nkubernetes-dashboard-token-ncx5g\n[root@k8s-master dashboard]# kubectl get secret kubernetes-dashboard-token-ncx5g -o jsonpath=\u0026#34;{.data.token}\u0026#34;  -n kube-system  | base64 -d\neyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJrdWJlcm5ldGVzLWRhc2hib2FyZC10b2tlbi1uY3g1ZyIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjgxMTZmNDE3LTlkNDctMTFlOC04NDVlLTA2MjY2ODAwMWYxNSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlLXN5c3RlbTprdWJlcm5ldGVzLWRhc2hib2FyZCJ9.OnhxsBYnuC47R9j411bq8d2NZDRWGMqUysC9rpITIy3r-4eTKNFL6Hf9jMQzIHME29re3PpKZ6EvV4n-VPTtL-PYbatXu5pegyX4jewQwCHn6VMzqJFaBN-hwK9wbY-1Mp63vZGEYZdRQYqB832SRyWwPoGGX8YSDa5dwk7hOJUJUBl4iBYpNt2nxxSTHgkqeh2QhzpaGZhgBx7c5UhfdNFRZVeQYns-k7f10c_36TuPmT98X3WSe7UEyAV1AhFu0b0z7WqUAAEJvRwxxEI0aYze3UWWGO9wr0sqzt7ZkhPy1GIQsLWOLO_g1vnviVaQcqhLiQU8ZNNjX2UqitF_eQ\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e25、强制删除 pod\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl delete pod kubernetes-dashboard-55556f66c5-4zc77 -n kube-system --grace-period=0 --force\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e该命令也可以用于强制删除其他 kubernetes 资源。\u003c/p\u003e\n\u003ch3 id=\"日志查看\"\u003e日志查看\u003c/h3\u003e\n\u003cp\u003e1）查看指定行数的日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl logs --tail=5 dingtalk-callback-5ff4757745-g448n -n xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）查看指定时间段的日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl logs --since=1h dingtalk-callback-5ff4757745-g448n -n xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"组合命令\"\u003e组合命令\u003c/h2\u003e\n\u003cp\u003e1）删除状态为 Error 的 Pod\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl get pods -n xdhuxc | grep Error | awk \u0026#39;{ print $1 }\u0026#39;| xargs kubectl delete pod -n xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1542153600,"description":"","fuzzywordcount":1000,"kind":"page","lang":"zh","lastmod":1542412800,"objectID":"9c2803ae0f815ac4746def2948fcc16f","publishdate":1542153600,"relpermalink":"/posts/kubernetes/kubernetes-common-command/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在 Kubernetes 中常用的命令，以备后需。\u003c/p\u003e","tags":["Kubernetes"],"title":"Kubernetes 常用命令总结","url":"https://xdhuxc.github.io/posts/kubernetes/kubernetes-common-command/","wordcount":908},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了几种常用的部署 etcd 的方法。\u003c/p\u003e\n\u003ch3 id=\"基于-docker-方式部署-etcd\"\u003e基于 docker 方式部署 etcd\u003c/h3\u003e\n\u003cp\u003e1、拉取 etcd 镜像\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-angular2html\" data-lang=\"angular2html\"\u003edocker pull gcr.io/etcd-development/etcd:v3.2.25\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、启动 etcd 容器\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-angular2html\" data-lang=\"angular2html\"\u003edocker run -d \\\n    --restart=always \\\n    --name=etcd \\\n    -p 3379:2379 \\\n    -p 3380:2380 \\\n    -v /data/etcd/data:/etcd-data \\\n    gcr.io/etcd-development/etcd:v3.2.25 \\\n    /usr/local/bin/etcd \\\n    --name etcd1 \\\n    --data-dir /etcd-data \\\n    --listen-client-urls http://0.0.0.0:2379 \\\n    --advertise-client-urls http://0.0.0.0:2379 \\\n    --listen-peer-urls http://0.0.0.0:2380 \\\n    --initial-advertise-peer-urls http://0.0.0.0:2380 \\\n    --initial-cluster etcd1=http://0.0.0.0:2380 \\\n    --initial-cluster-token tkn \\\n    --initial-cluster-state new\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"使用-yum-安装-etcd\"\u003e使用 yum 安装 etcd\u003c/h3\u003e\n\u003cp\u003e1、使用 yum 直接安装 etcd\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install etcd -y\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动 etcd\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart etcd \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查看状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl status etcd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"集群方式部署-etcd\"\u003e集群方式部署 etcd\u003c/h3\u003e\n\u003cp\u003e三台机器的基本信息\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e名称\u003c/th\u003e\n\u003cth\u003eIP地址\u003c/th\u003e\n\u003cth\u003e主机名\u003c/th\u003e\n\u003cth\u003eOS\u003c/th\u003e\n\u003cth\u003eetcd_version\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eetcd0\u003c/td\u003e\n\u003ctd\u003e192.168.91.128\u003c/td\u003e\n\u003ctd\u003eetcd0.xdhuxc.com\u003c/td\u003e\n\u003ctd\u003eCentOS 7.3.1611\u003c/td\u003e\n\u003ctd\u003eetcd-v3.2.10\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eetcd1\u003c/td\u003e\n\u003ctd\u003e192.168.91.129\u003c/td\u003e\n\u003ctd\u003eetcd1.xdhuxc.com\u003c/td\u003e\n\u003ctd\u003eCentOS 7.3.1611\u003c/td\u003e\n\u003ctd\u003eetcd-v3.2.10\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eetcd2\u003c/td\u003e\n\u003ctd\u003e192.168.91.130\u003c/td\u003e\n\u003ctd\u003eetcd2.xdhuxc.com\u003c/td\u003e\n\u003ctd\u003eCentOS 7.3.1611\u003c/td\u003e\n\u003ctd\u003eetcd-v3.2.10\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e均安装 iptables 并开放所需端口2379，2380\u003c/p\u003e\n\u003cp\u003e在每一台机器上，添加如下环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eETCD_VERSION=v3.3\nTOKEN=etcd-cluster-token\nCLUSTER_STATE=new\nNODE_1=etcd-node-0\nNODE_2=etcd-node-1\nNODE_3=etcd-node-2\nHOST_1_IP=192.168.91.128\nHOST_2_IP=192.168.91.129\nHOST_3_IP=192.168.91.130\nCLUSTER=${NODE_1}=http://${HOST_1_IP}:2380,${NODE_2}=http://${HOST_2_IP}:2380,${NODE_3}=http://${HOST_3_IP}:2380\nDATA_DIR=/home/xdhuxc/etcd/data\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在节点1上，执行如下命令\u003c/p\u003e\n\u003cp\u003e添加如下环境变量：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTHIS_NAME=${NODE_1}\nTHIS_IP=${HOST_1_IP}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run \\\n    -p 2379:2379 \\\n    -p 2380:2380 \\\n    -v ${DATA_DIR}:/etcd-data \\\n    --name etcd-1\n    quay.io/coreos/etcd:v3.3 \\\n    /usr/local/bin/etcd \\\n    --data-dir=/etcd-data \\\n    --name ${THIS_NAME} \\\n    --initial-advertise-peer-urls http://${THIS_IP}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在节点2上，执行如下命令\u003c/p\u003e\n\u003cp\u003e添加如下环境变量：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTHIS_NAME=${NODE_2}\nTHIS_IP=${HOST_2_IP}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run \\\n    -p 2379:2379 \\\n    -p 2380:2380 \\\n    -v ${DATA_DIR}:/etcd-data \\\n    --name etcd-2\n    quay.io/coreos/etcd:v3.3 \\\n    /usr/local/bin/etcd \\\n    --data-dir=/etcd-data \\\n    --name ${THIS_NAME} \\\n    --initial-advertise-peer-urls http://${THIS_IP}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在节点3上，执行如下命令\u003c/p\u003e\n\u003cp\u003e添加如下环境变量：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTHIS_NAME=${NODE_3}\nTHIS_IP=${HOST_3_IP}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run \\\n    -p 2379:2379 \\\n    -p 2380:2380 \\\n    -v ${DATA_DIR}:/etcd-data \\\n    --name etcd-3\n    quay.io/coreos/etcd:v3.3 \\\n    /usr/local/bin/etcd \\\n    --data-dir=/etcd-data \\\n    --name ${THIS_NAME} \\\n    --initial-advertise-peer-urls http://${THIS_IP}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003eGithub \u003ca href=\"https://github.com/etcd-io/etcd/releases\"\u003ehttps://github.com/etcd-io/etcd/releases\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e镜像下载地址 \u003ca href=\"https://quay.io/repository/coreos/etcd?tag=latest\u0026amp;tab=tags\"\u003ehttps://quay.io/repository/coreos/etcd?tag=latest\u0026amp;tab=tags\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e镜像使用地址 \u003ca href=\"https://github.com/coreos/etcd/blob/master/Documentation/op-guide/container.md#docker\"\u003ehttps://github.com/coreos/etcd/blob/master/Documentation/op-guide/container.md#docker\u003c/a\u003e\u003c/p\u003e","date":1541894400,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1547078400,"objectID":"eccc812d10283f3123cf0482178a8216","publishdate":1541894400,"relpermalink":"/posts/storage/etcd/etcd-deployment/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了几种常用的部署 etcd 的方法。\u003c/p\u003e","tags":["etcd","docker"],"title":"部署 etcd 的常用方法","url":"https://xdhuxc.github.io/posts/storage/etcd/etcd-deployment/","wordcount":446},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下在使用 calico 的过程中常见的问题及解决方法。\u003c/p\u003e\n\u003cp\u003e1）已经部署好的 calico，需要修改其网段，修改后，连接不通\n执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e#重新安装calico (cnm)\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 修改calico地址后，需要删除原来的tunl0等\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nip link set tunl0 down\nifconfig|grep \u0026#34;cali\\|cni\\|flannel\u0026#34;|awk \u0026#39;{printf(\u0026#34;ip link delete %s\\n\u0026#34;, $1)}\u0026#39;|sh\nrm -rf /etc/cni/\nrm -rf /opt/cni\nrm -rf /var/lib/cni\nmkdir -p /opt/cni/bin/\niptables -F\nsystemctl restart iptables\nexport ETCD_AUTHORITY=10.3.15.189:2379\ncalicoctl node run --ip=\n\u003cspan class=\"gh\"\u003e#安装完后可以docker run -it --net=net1 busybox sh 测试一下ip的ping通性\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1541808000,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1542412800,"objectID":"b7d67d9b127dd3a8f77e17e55d2a00f3","publishdate":1541808000,"relpermalink":"/posts/mixed/calico/calico-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录下在使用 calico 的过程中常见的问题及解决方法。\u003c/p\u003e","tags":["calico"],"title":"Calico 常见问题及解决","url":"https://xdhuxc.github.io/posts/mixed/calico/calico-questions-and-solutions/","wordcount":185},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 dnsmasq 的配置和使用。\u003c/p\u003e\n\u003ch3 id=\"简介\"\u003e简介\u003c/h3\u003e\n\u003cp\u003ednsmasq 是一个小巧且方便地用于配置 DNS 和 DHCP 的工具，适用于小型网络，相比于 bind 和 dhcpd，配置起来更简单。dnsmasq 能够提供本地解析和外部 DNS 服务器代理，通常将其作为一个 DNS 中继代理。\u003c/p\u003e\n\u003ch3 id=\"安装\"\u003e安装\u003c/h3\u003e\n\u003cp\u003e可以通过 yum 命令直接安装 dnsmasq，命令如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y dnsmasq\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e安装完成后，可以通过 \u003ccode\u003ednsmasq --help\u003c/code\u003e 或者 \u003ccode\u003eman dnsmasq\u003c/code\u003e 查看支持的配置。\u003c/p\u003e\n\u003ch3 id=\"配置\"\u003e配置\u003c/h3\u003e\n\u003cp\u003e配置文件位置为：\u003ccode\u003e/etc/dnsmasq.conf\u003c/code\u003e，默认情况下，dnsmasq.conf 中只开启了最后的 include 项，可以在 /etc/dnsmasq.d 中编写任意名称的配置文件。\u003c/p\u003e\n\u003cp\u003ednsmasq.conf 文件内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 监听的端口，DNS 默认为 53 端口，如果设置为 0，则完全禁止 DNS 功能。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eport=53\n\u003cspan class=\"gh\"\u003e# 监听地址\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003elisten-address=10.10.24.32\n\n\u003cspan class=\"gh\"\u003e# 正确的域名格式才转发\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edomain-needed\n\n\u003cspan class=\"gh\"\u003e# 设置本地域扩展，相当于域简写，例如 hosts 配置 www 会自动加上 www.xdhuxc.com \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eexpand-hosts \nlocal=/xdhuxc.com/\n\n\u003cspan class=\"gh\"\u003e# 配置上游的 nameserver 解析文件 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e#resolv-file=/etc/dnsmasq.resolv.conf\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 当 /etc/resolv.conf 或 resolv-file 文件变化时，不重新加载。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eno-poll \n\u003cspan class=\"gh\"\u003e# 不使用上游 nameserver 配置文件（/etc/resolv.conf 和 resolv-file）\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eno-resolv \n\n\u003cspan class=\"gh\"\u003e# 配置本地解析的 hosts\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eaddn-hosts=/etc/dnsmasq.hosts\n\u003cspan class=\"gh\"\u003e# 不使用 /etc/hosts，开启后 expand-hosts 不生效 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# no-hosts \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 按配置顺序查询上级 nameserver 服务器\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003estrict-order \n\n\u003cspan class=\"gh\"\u003e# 记录日志，如果打开日志，要及时清理 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003elog-queries\nlog-facility=/var/log/dnsmasq.log \n\u003cspan class=\"gh\"\u003e# 启用异步日志记录，缓解阻塞，提高性能。默认队列长度为：5，合理值为：5~25，最大限制为：100\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003elog-async=20\n\n\u003cspan class=\"gh\"\u003e# 缓存地址数量，提高查询速度\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecache-size=10000\n\u003cspan class=\"gh\"\u003e# 自动加载配置文件目录 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003econf-dir=/etc/dnsmasq.d \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 /etc/dnsmasq.d 目录下配置自定义项 server.conf\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 指定 dnsmasq 默认查询的上游域名服务器  \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eserver=8.8.8.8 \nserver=114.114.114.114\n\u003cspan class=\"gh\"\u003e# 可以将特定的域名指定解析它的域名服务器，一般是其他的内部域名服务器。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eserver=/baidu.com/61.135.165.235\n\u003cspan class=\"gh\"\u003e# 指定反向 DNS 192.168.1/24 网段到 192.168.2.1 DNS 查询 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# server=/192.168.1.in-addr.arpa/192.168.2.1\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 给 *.apple.com 和 taobao.com 使用专用的 DNS\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eserver=/taobo.com/223.5.5.5\nserver=/.apple.com/223.5.5.5\n\n\u003cspan class=\"gh\"\u003e# 把 www.hi-linux.com 解析到特定的 IP\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eaddress=/www.hi-linux.com/192.168.101.107 \n\n\u003cspan class=\"gh\"\u003e# 把所有 .cn 的域名全部通过 114.114.114.114 这台国内 DNS 服务器来解析 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eserver=/cn/114.114.114.114\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eaddress.conf 配置自定义域名服务器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 指定 domain 解析地址 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eaddress=/www.test.com/127.0.0.1\n\u003cspan class=\"gh\"\u003e# *.xdhuxc.com 匹配 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eaddress=/xdhuxc.com/127.0.0.1\naddress=/.abc.com/1.1.1.1 \naddress=/ipv6.xdhuxc.com/fe80::4d7:a0ff:fe00:f9b\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"启动服务\"\u003e启动服务\u003c/h3\u003e\n\u003cp\u003e启动 dnsmasq 服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart dnsmasq\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 dig 命令查询解析是否正确，例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc etc]# dig \u003cspan class=\"ni\"\u003e@10\u003c/span\u003e.10.24.32 www.xdhuxc.com\n\n; \u003cspan class=\"err\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e\u0026gt;\u0026gt; DiG 9.9.4-RedHat-9.9.4-61.el7_5.1 \u003cspan class=\"err\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e\u0026gt;\u0026gt; \u003cspan class=\"ni\"\u003e@10\u003c/span\u003e.10.24.32 www.xdhuxc.com\n; (1 server found)\n;; global options: +cmd\n;; Got answer:\n;; -\u0026gt;\u0026gt;HEADER\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e-\u003c/span\u003e \u003cspan class=\"na\"\u003eopcode:\u003c/span\u003e \u003cspan class=\"na\"\u003eQUERY\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003estatus:\u003c/span\u003e \u003cspan class=\"na\"\u003eNOERROR\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eid:\u003c/span\u003e \u003cspan class=\"na\"\u003e4987\u003c/span\u003e\n\u003cspan class=\"err\"\u003e;;\u003c/span\u003e \u003cspan class=\"na\"\u003eflags:\u003c/span\u003e \u003cspan class=\"na\"\u003eqr\u003c/span\u003e \u003cspan class=\"na\"\u003eaa\u003c/span\u003e \u003cspan class=\"na\"\u003erd\u003c/span\u003e \u003cspan class=\"na\"\u003era\u003c/span\u003e \u003cspan class=\"na\"\u003ead\u003c/span\u003e\u003cspan class=\"err\"\u003e;\u003c/span\u003e \u003cspan class=\"na\"\u003eQUERY:\u003c/span\u003e \u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eANSWER:\u003c/span\u003e \u003cspan class=\"na\"\u003e1\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eAUTHORITY:\u003c/span\u003e \u003cspan class=\"na\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003eADDITIONAL:\u003c/span\u003e \u003cspan class=\"na\"\u003e0\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e;;\u003c/span\u003e \u003cspan class=\"na\"\u003eQUESTION\u003c/span\u003e \u003cspan class=\"na\"\u003eSECTION:\u003c/span\u003e\n\u003cspan class=\"err\"\u003e;\u003c/span\u003e\u003cspan class=\"na\"\u003ewww\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003exdhuxc\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecom\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\t\t\t\u003cspan class=\"na\"\u003eIN\u003c/span\u003e\t\u003cspan class=\"na\"\u003eA\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e;;\u003c/span\u003e \u003cspan class=\"na\"\u003eANSWER\u003c/span\u003e \u003cspan class=\"na\"\u003eSECTION:\u003c/span\u003e\n\u003cspan class=\"na\"\u003ewww\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003exdhuxc\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecom\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\t\t\u003cspan class=\"na\"\u003e0\u003c/span\u003e\t\u003cspan class=\"na\"\u003eIN\u003c/span\u003e\t\u003cspan class=\"na\"\u003eA\u003c/span\u003e\t\u003cspan class=\"na\"\u003e127\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e0\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"err\"\u003e;;\u003c/span\u003e \u003cspan class=\"na\"\u003eQuery\u003c/span\u003e \u003cspan class=\"na\"\u003etime:\u003c/span\u003e \u003cspan class=\"na\"\u003e0\u003c/span\u003e \u003cspan class=\"na\"\u003emsec\u003c/span\u003e\n\u003cspan class=\"err\"\u003e;;\u003c/span\u003e \u003cspan class=\"na\"\u003eSERVER:\u003c/span\u003e \u003cspan class=\"na\"\u003e10\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e10\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e24\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e32\u003c/span\u003e\u003cspan class=\"err\"\u003e#\u003c/span\u003e\u003cspan class=\"na\"\u003e53\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003e10\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e10\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e24\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003e32\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n\u003cspan class=\"err\"\u003e;;\u003c/span\u003e \u003cspan class=\"na\"\u003eWHEN:\u003c/span\u003e \u003cspan class=\"na\"\u003eMon\u003c/span\u003e \u003cspan class=\"na\"\u003eOct\u003c/span\u003e \u003cspan class=\"na\"\u003e15\u003c/span\u003e \u003cspan class=\"na\"\u003e14:53:28\u003c/span\u003e \u003cspan class=\"na\"\u003eCST\u003c/span\u003e \u003cspan class=\"na\"\u003e2018\u003c/span\u003e\n\u003cspan class=\"err\"\u003e;;\u003c/span\u003e \u003cspan class=\"na\"\u003eMSG\u003c/span\u003e \u003cspan class=\"na\"\u003eSIZE\u003c/span\u003e  \u003cspan class=\"na\"\u003ercvd:\u003c/span\u003e \u003cspan class=\"na\"\u003e48\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"修改-iptables-配置\"\u003e修改 iptables 配置\u003c/h3\u003e\n\u003cp\u003e1、允许本机的 53 端口可对外访问\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -A INPUT -p udp -m udp --dport 53 -j ACCEPT\niptables -A INPUT -p tcp -m tcp --dport 53 -j ACCEPT \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、转发 DNS 请求\u003c/p\u003e\n\u003cp\u003e开启流量转发功能\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho \u0026#39;1\u0026#39; \u0026gt; /proc/sys/net/ipv4/ip_forward\necho \u0026#39;1\u0026#39; \u0026gt; /proc/sys/net/ipv6/ip_forward\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e添加流量转发规则，将外部到 53 的端口的请求映射到 dnsmasq 服务器的 53 端口\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -t nat -A PREROUTING -p udp --dport 53 -j REDIRECT --to-port 53\niptables -t nat -A PREROUTING -p tcp --dport 53 -j REDIRECT --to-port 53\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果要限制只允许内网的请求，规则如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -t nat -A PREROUTING -i eth0 -p udp --dport 53 -j REDIRECT --to-port 53\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、使用如下命令保存 iptables 规则并重启 iptables 服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eservice iptables save      # 保存 iptables 规则  \nsystemctl restart iptables\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"dnsmasq-优化\"\u003ednsmasq 优化\u003c/h3\u003e\n\u003ch4 id=\"选择最快的上游-dns-服务器\"\u003e选择最快的上游 DNS 服务器\u003c/h4\u003e\n\u003cp\u003e经常会有这样的情形，dnsmasq 服务器配置了很多上游域名服务器，转发本地的 DNS 请求，但 dnsmasq 实际上是只挑选了一个上游 DNS 服务器来查询并转发结果，这样如果选错服务器的话就会导致 DNS 响应变慢。\n解决方法：\n修改 dnsmasq.conf 的配置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eall-servers\nserver=8.8.8.8\nserver=114.114.114.114\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eall-servers 表示对以下设置的所有 server 发起查询，选择回应最快的一条作为查询结果返回。上面设置了两个域名服务器，会同时查询这两个域名服务器，询问 DNS 地址，谁返回快，就采用谁的结果。\u003c/p\u003e\n\u003ch4 id=\"dnsmasq-china-list-项目\"\u003ednsmasq-china-list 项目\u003c/h4\u003e\n\u003cp\u003ednsmasq-china-list 项目维护了一张国内常用但是通过国外 DNS 会解析错误的网站域名的列表，保证列表中的国内域名全部走国内 DNS 服务器解析。\u003c/p\u003e\n\u003cp\u003e项目地址：https://github.com/felixonmars/dnsmasq-china-list\u003c/p\u003e\n\u003cp\u003e操作步骤：\u003c/p\u003e\n\u003cp\u003e1、取消 dnsmasq.conf 中 conf-dir=/etc/dnsmasq.d 这一行的注释\u003c/p\u003e\n\u003cp\u003e2、获取项目文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit clone https://github.com/felixonmars/dnsmasq-china-list.git\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、将 \u003ccode\u003eaccelerated-domains.china.conf\u003c/code\u003e, \u003ccode\u003ebogus-nxdomain.china.conf,google.china.conf\u003c/code\u003e （可选）放到 /etc/dnsmasq.d/ 目录下\u003c/p\u003e\n\u003cp\u003e4、将 \u003ccode\u003ednsmasq-update-china-list\u003c/code\u003e 放到 \u003ccode\u003e/usr/bin/\u003c/code\u003e 目录下，这是一个批量修改 DNS 服务器的工具。\u003c/p\u003e\n\u003ch4 id=\"dnsmasq-性能优化\"\u003ednsmasq 性能优化\u003c/h4\u003e\n\u003cp\u003ebind 在不配合数据库的情况下，经常需要重新载入并读取配置文件，这是造成性能低下的原因。因此，我们可以考虑不读取 /etc/hosts 文件，而是另外指定一个在共享内存里的文件，比如 /dev/shm/dnsrecord.txt，这样就可以提高 DNS 解析速度了。又由于内存是易失性的存储器，重启后就会消失，可以定期同步硬盘上的某个文件内容到内存中。\u003c/p\u003e\n\u003cp\u003e操作步骤：\n1、配置 /etc/dnsmasq.conf\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eno-hosts\naddn-hosts=/dev/shm/dnsrecord.txt \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、解决同步问题\u003c/p\u003e\n\u003cp\u003e开机启动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho \u0026#34;cat /etc/hosts \u0026gt; /dev/shm/dnsrecord.txt\u0026#34; \u0026gt;\u0026gt; /etc/rc.local \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e定时同步内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecrontab -e \n\u003cspan class=\"ge\"\u003e*/10 *\u003c/span\u003e \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e * cat /etc/hosts \u0026gt; /dev/shm/dnsrecord.txt \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://chuansong.me/n/471642951828\"\u003ehttp://chuansong.me/n/471642951828\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/zhu_tianwei/article/details/72632078\"\u003ehttps://blog.csdn.net/zhu_tianwei/article/details/72632078\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/xiaogan/p/5954678.html\"\u003ehttps://www.cnblogs.com/xiaogan/p/5954678.html\u003c/a\u003e\u003c/p\u003e","date":1541808000,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"8f3b12fe7f45c14386024aa65bf6a474","publishdate":1541808000,"relpermalink":"/posts/common/dns/dns-dnsmasq/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 dnsmasq 的配置和使用。\u003c/p\u003e","tags":["dnsmasq","DNS"],"title":"dnsmasq 的配置和使用","url":"https://xdhuxc.github.io/posts/common/dns/dns-dnsmasq/","wordcount":1694},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 docker 的存储驱动 overlay 和 overlay2，对于理解 docker 的文件系统非常有帮助。\u003c/p\u003e\n\u003ch3 id=\"overlay-和-overlay2\"\u003eoverlay 和 overlay2\u003c/h3\u003e\n\u003cp\u003eOverlayFS 是一个类似于 AUFS 的联合文件系统，更快，实现更简单。OverlayFS 是内核提供的文件系统，overlay 和overlay2 是 docker 的存储驱动方式。\u003c/p\u003e\n\u003cp\u003e修改 docker 的存储驱动为 \u003ccode\u003eoverlay2\u003c/code\u003e，创建 \u003ccode\u003e/etc/docker/daemon.json\u003c/code\u003e，添加如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n    \u0026#34;storage-driver\u0026#34;: \u0026#34;overlay2\u0026#34;   \n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果是 \u003ccode\u003eCentOS7\u003c/code\u003e 或者 \u003ccode\u003eRedHat7\u003c/code\u003e 内核在 \u003ccode\u003e3.10.0-693\u003c/code\u003e 以下的，则添加如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n    \u0026#34;storage-driver\u0026#34;:\u0026#34;overlay2\u0026#34;,\n    \u0026#34;storage-opts\u0026#34;:[\n        \u0026#34;overlay2.override_kernel_check=true\u0026#34;\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"overlay-原理\"\u003eoverlay 原理\u003c/h3\u003e\n\u003cp\u003eOverlayFS与AUFS相似，也是一种联合文件系统。与AUFS相比，OverlayFS设计更简单，可能更快，也已经被加入Linux内核。\u003c/p\u003e\n\u003ch4 id=\"overlayfs-中镜像的分层和共享\"\u003eOverlayFS 中镜像的分层和共享\u003c/h4\u003e\n\u003cp\u003eOverlayFS将一个Linux主机中的两个目录组合起来，一个在上，一个在下，对外提供统一的视图。这两个目录就是层layer，将两个层组合在一起的技术被称为联合挂载（union mount）。在OverlayFS中，上层的目录被称为upperdir，下层的目录被称为lowerdir，对外提供的统一视图被称为merged。\u003c/p\u003e\n\u003cp\u003e下图展示了容器和镜像的层与 \u003ccode\u003eOverlayFS\u003c/code\u003e 的 \u003ccode\u003eupperdir\u003c/code\u003e，\u003ccode\u003elowerdir\u003c/code\u003e 以及 \u003ccode\u003emerged\u003c/code\u003e 之间的对应关系：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/docker/storage-drive/WechatIMG695.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n图1 · OverlayFS 存储架构\n\u003c/center\u003e\n\u003cp\u003e由上图可以看出，在一个容器中，容器层（container layer）也就是读写层对应于 OverlayFS 的 upperdir，容器使用的对象镜像对应于 OverlayFS 的 lowerdir，容器文件系统的挂载点对应merged。\u003c/p\u003e\n\u003cp\u003e注意，镜像层和容器层可以有相同的文件，在这种情况下，upperdir 中的文件覆盖 lowerdir 中的文件\u003c/p\u003e\n\u003cp\u003eOverlayFS 仅有两层，也就是说镜像中的每一层并不对应 OverlayFS中的层，而是镜像中的每一层对应 \u003ccode\u003e/var/lib/docker/overlay\u003c/code\u003e 中的一个目录，目录以该层的UUID命名。然后使用硬链接将下面层的文件引用到上层。这在一定程度上节省了磁盘空间。这样，OverlayFS中的lowerdir就对应镜像层的最上层，并且是只读的。在创建容器时，docker会新建一个目录作为OverlayFS的upperdir，它是可写的。\u003c/p\u003e\n\u003cp\u003eOverlayFS 中容器的读写操作\u003c/p\u003e\n\u003cp\u003e读：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e如果该文件在容器层不存在，即文件不存在upperdir中，则从lowerdir中读取。\u003c/li\u003e\n\u003cli\u003e如果该文件只在容器层存在，即文件只存在于upperdir中，则直接从容器中读取该文件。\u003c/li\u003e\n\u003cli\u003e如果文件同时存在于容器层和镜像层，容器层upperdir中的同名文件会覆盖镜像层lowerdir中的文件。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e修改：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e首次写入：第一次修改时，容器层中不存在该文件，在overlay和overlay2中，overlay驱动执行copy-up操作，将文件从loweridr复制到upperdir中，然后对文件的副本做出修改。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e需要说明的是，overlay的copy-up操作工作在文件层面，不是块层面，这意味着对文件的修改需要将整个文件复制到upperdir中，不过下面这两点使这一操作的开销很小：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ecopy-up操作仅发生在文件第一次被修改时，此后对文件的读写都直接在upperdir中进行。\u003c/li\u003e\n\u003cli\u003eOverlayFS中仅有两层，这使得文件的查找效率很高（相对于AUFS）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e删除文件和目录\u003c/p\u003e\n\u003cp\u003e当文件在容器内被删除时，在容器层（upperdir）创建whiteout文件，镜像层的文件是不会被删除的，因为它们是只读的，但whiteout文件会阻止它们展现。\u003c/p\u003e\n\u003cp\u003e当目录在容器内被删除时，在容器层（upperdir）中创建一个不透明的目录，和上面的whiteout一样，阻止用户继续访问，即使镜像层仍然存在。\u003c/p\u003e\n\u003ch4 id=\"性能对比\"\u003e性能对比\u003c/h4\u003e\n\u003cp\u003e使用 overlay 和 overlay2 驱动性能好于 aufs 和 devicemapper，在实际生产环境，overlay2的性能高于btrfs，但是还需要注意以下细节：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e页缓存：OverlayFS支持页缓存共享，也就是说如果多个容器访问同一个文件，可以共享同一个页缓存。这使得Overlay/Overlay2驱动高效地利用了内存。\u003c/li\u003e\n\u003cli\u003ecopy_up：overlay的复制操作工作在文件层面上，也就是对文件的第一次修改需要复制文件整个文件，这会带来一些性能开销，在修改大文件时尤其如此。但是overlay的复制操作比AUFS还是快一点，因为AUFS有很多层，而overlay只有两层，所以overlay在文件的搜索方面相对于AUFS具有优势。\u003c/li\u003e\n\u003cli\u003einode限制：使用overlay存储驱动可能导致inode过度消耗，特别是当容器和镜像很多的情况下，所以推荐使用overlay2。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eoverlay和overlay2的本质区别是镜像层之间共享数据的方法不同，overlay共享数据的方式是通过硬链接，而overlay2则是通过每层的lower文件。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/vchy_zhao/article/details/70238690\"\u003ehttps://blog.csdn.net/vchy_zhao/article/details/70238690\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/vchy_zhao/article/details/70238690\"\u003ehttps://blog.csdn.net/vchy_zhao/article/details/70238690\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/zhonglinzhang/article/details/80970411\"\u003ehttps://blog.csdn.net/zhonglinzhang/article/details/80970411\u003c/a\u003e\u003c/p\u003e","date":1541808000,"description":"","fuzzywordcount":1900,"kind":"page","lang":"zh","lastmod":1503187200,"objectID":"36ef1656618aa48b3da3d1195b4c0c66","publishdate":1541808000,"relpermalink":"/posts/docker/docker-storage-drive/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 docker 的存储驱动 overlay 和 overlay2，对于理解 docker 的文件系统非常有帮助。\u003c/p\u003e","tags":["Docker"],"title":"Docker 存储驱动 overlay 和 overlay2 介绍","url":"https://xdhuxc.github.io/posts/docker/docker-storage-drive/","wordcount":1869},{"categories":"posts","content":"\u003cp\u003e本篇博客简单介绍下消息中间件，其特点及消息传递模型。\u003c/p\u003e\n\u003ch3 id=\"消息中间件\"\u003e消息中间件\u003c/h3\u003e\n\u003cp\u003e消息中间件是在消息的传输过程中保存消息的容器。消息中间件在将消息从消息生产者传输到消息消费者的过程中充当中间人的角色。队列的主要目的是提供路由并保证消息的传送；如果发送消息时接收者不可用，消息队列会保存消息，直到可以成功地传递它为止。当然，消息队列保存消息也是有期限的。\u003c/p\u003e\n\u003ch3 id=\"消息中间件特点\"\u003e消息中间件特点\u003c/h3\u003e\n\u003ch4 id=\"采用异步处理模式\"\u003e采用异步处理模式\u003c/h4\u003e\n\u003cp\u003e消息发送者可以发送一个消息而无须等待响应。消息发送者将消息发送到一条虚拟的通道（主题或者队列）上，消息接收者则订阅或者监听该通道。一条消息可能最终转发给一个或者多个消息接收者，这些接收者都无需对消息发送者做出同步回应。整个过程是异步的。\u003c/p\u003e\n\u003cp\u003e例如，用户注册账号，注册完成后发送邮件或者短信\u003c/p\u003e\n\u003ch4 id=\"应用程序和应用程序调用关系为松耦合关系\"\u003e应用程序和应用程序调用关系为松耦合关系\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e发送者和接收者不必要了解对方，只需要确认消息。\u003c/li\u003e\n\u003cli\u003e发送者和接收者不必同时在线。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e比如，在线交易系统为了保证数据的最终一致，在支付系统处理完成后会把支付结果放到消息中间件里通知订单系统修改订单支付状态。两个系统通过消息中间件解耦。\u003c/p\u003e\n\u003ch3 id=\"消息中间件的传递模型\"\u003e消息中间件的传递模型\u003c/h3\u003e\n\u003ch4 id=\"点对点模型ptp\"\u003e点对点模型（PTP）\u003c/h4\u003e\n\u003cp\u003e点对点模型用于消息生产者和消息消费者之间点对点的通信。消息生产者将消息发送到由某个名称标识的特定消费者。这个名称实际上对应于消费服务中的一个队列，在消息传递给消费者之前，它会被存储在这个队列中。消息队列可以放在内存中，也可以是持久的，以保证在消息服务出现故障时仍然能够传递消息。\u003c/p\u003e\n\u003cp\u003e点对点模型特性：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e每个消息只有一个消费者；\u003c/li\u003e\n\u003cli\u003e发送者和接收者没有时间依赖；\u003c/li\u003e\n\u003cli\u003e接收者确认消息接收和处理成功；\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"F:/Visio/message-queue/point-to-point.jpg\" alt=\"image\"\u003e\u003c/p\u003e\n\u003ch4 id=\"发布订阅模型pubsub\"\u003e发布/订阅模型（Pub/Sub）\u003c/h4\u003e\n\u003cp\u003e发布者/订阅者模型支持向一个特定的消息主题生产消息。0或多个订阅者可能对接收来自特定消息主题的消息感兴趣。在这种模型下，发布者和订阅者彼此不知道对方。这种模式好比是匿名公告板。这种模式被概括为：多个消费者可以获得消息。在发布者和订阅者之间存在时间依赖性。发布者需要建立一个订阅，以便能够让消费者订阅。订阅者必须保持持续的活动状态以接收消息，除非订阅者建立了持久地订阅，在这种情况下，在订阅者未连接时发布的消息将在订阅者重新连接时重新发布。\u003c/p\u003e\n\u003cp\u003e其实，消息中间件，像MySQL也可以作为消息中间件，只要把消息中间件的原理搞清楚，就会发现目前所有的存储，包括NoSQL，只要支持顺序性的东西，就可以作为一个消息中间件。就看我们如何去使用它，比如redis中的队列list，就可以作为一个消息队列。\u003c/p\u003e\n\u003cp\u003e发布-订阅模型特性：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e每个消息可以有多个订阅者；\u003c/li\u003e\n\u003cli\u003e客户端只有订阅后才能接收到消息；\u003c/li\u003e\n\u003cli\u003e持久订阅和非持久订阅；\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"F:/Visio/message-queue/pub-sub.jpg\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e（1）发布者和订阅者有时间依赖，接收者和发布者只有在建立订阅关系后，接收者才能收到消息。\u003c/p\u003e\n\u003cp\u003e（2）持久订阅，订阅关系建立后，消息就不会消失，不管订阅者是否在线。\u003c/p\u003e\n\u003cp\u003e（3）非持久订阅，订阅者为了接收消息，必须一直在线，当只有一个订阅者时，约等于点对点模式。\u003c/p\u003e\n\u003cp\u003e大部分情况下会使用持久订阅。\u003c/p\u003e\n\u003cp\u003e常用的消息队列有：Kafka、RabbitMQ、ActiveMQ、Metaq。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/zhaojiankai/p/7181910.html?utm_source=itdadao\u0026amp;utm_medium=referral\"\u003ehttps://www.cnblogs.com/zhaojiankai/p/7181910.html?utm_source=itdadao\u0026amp;utm_medium=referral\u003c/a\u003e\u003c/p\u003e","date":1541808000,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1542412800,"objectID":"a6c4866bf5b90c0fc6c915ac38984ad5","publishdate":1541808000,"relpermalink":"/posts/message/message-queue-model/","section":"posts","summary":"\u003cp\u003e本篇博客简单介绍下消息中间件，其特点及消息传递模型。\u003c/p\u003e","tags":["消息队列"],"title":"消息队列简介","url":"https://xdhuxc.github.io/posts/message/message-queue-model/","wordcount":1250},{"categories":"posts","content":"\u003cp\u003e本篇博客主要记录下 GoTTY 的简单使用方式，或许以后可以在项目中用到。\u003c/p\u003e\n\u003ch3 id=\"gotty-简介\"\u003eGoTTY 简介\u003c/h3\u003e\n\u003cp\u003eGoTTY 是一个简单的命令行工具，可以将 CLI 工具转换为 Web 应用程序，经常被用来实现 Web 终端。\u003c/p\u003e\n\u003ch3 id=\"gotty-部署\"\u003eGoTTY 部署\u003c/h3\u003e\n\u003cp\u003e1、下载稳定版 gotty 二进制安装文件\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/yudai/gotty\"\u003eGotty - GitHub\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e2、解压安装包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etar -zxf gotty_2.0.0-alpha.3_linux_amd64.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 gotty\npod 启动方式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enohup ./gotty -w -p 9988 --permit-arguments --reconnect kubectl exec -it \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e容器启动方式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enohup ./gotty -w -p 8888 --permit-arguments --reconnect docker exec -it \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e主机启动方式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e nohup ./gotty -w -p 8899 --permit-arguments --reconnect sh \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、在浏览器中访问\n命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubectl exec -it nginx-567d57d4c4-5spp9 -n default bash\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e浏览器中访问 pod 的 url\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.26.150:8899/?arg=nginx-567d57d4c4-5spp9\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003earg=-n\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003earg=default\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003earg=bash\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker exec -it b96f8e834f51 bash\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e浏览器中访问 docker 容器 url\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.26.150:8899/?arg=b96f8e834f51\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003earg=bash\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e浏览器中访问宿主机的 url\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.26.150:8899/?\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e需要在每一台机器上都运行一个探针，在一个 gotty 容器中启动三个 gotty 进程，分别在不同的端口监听容器、pod和宿主机的控制台请求。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/cj2580/article/details/79318726\"\u003ehttps://blog.csdn.net/cj2580/article/details/79318726\u003c/a\u003e\u003c/p\u003e","date":1541721600,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1541721600,"objectID":"1422d8857d4f3b9fe315d94c6d6055b1","publishdate":1541721600,"relpermalink":"/posts/tools/tools-gotty/","section":"posts","summary":"\u003cp\u003e本篇博客主要记录下 GoTTY 的简单使用方式，或许以后可以在项目中用到。\u003c/p\u003e","tags":["GoTTY"],"title":"GoTTY 的简单使用","url":"https://xdhuxc.github.io/posts/tools/tools-gotty/","wordcount":295},{"categories":"posts","content":"\u003cp\u003e本篇博客主要记录下 vagrant 常用的命令。\u003c/p\u003e\n\u003ch3 id=\"vagrant-简介\"\u003evagrant 简介\u003c/h3\u003e\n\u003cp\u003eVagrant 是一个用于在单个工作流中构建和管理虚拟机环境的工具。凭借着易于使用的工作流和专注于自动化，Vagrant 缩短了开发环境的设置时间，提高了生产效率，并使 \u003ccode\u003e在我的机器上正常工作\u003c/code\u003e 成为了过去的遗物。\u003c/p\u003e\n\u003ch3 id=\"vagrant-命令\"\u003evagrant 命令\u003c/h3\u003e\n\u003cp\u003e1、初始化 vagrant 工程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant init xdhuxc centos/7\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动虚拟机\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant up --provider virtualbox\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、登录虚拟机\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant ssh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、关闭虚拟机\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant halt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、删除虚拟机\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant destroy\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003evagrant destroy\u003c/code\u003e 只会删除虚拟机本身，也即你在 \u003ccode\u003eVirtualBox\u003c/code\u003e 将看不到该虚拟机，但是不会删除该虚拟机所使用的 \u003ccode\u003ebox\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e6、打包镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant xdhuxc # 会在当前目录下生成 xdhuxc.box 文件，后续可直接使用该文件恢复环境。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、导入 box\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant box add box_name box_uri\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evagrant box add centos7.4 E:/boxes/CentOS-7.4-x86_64-minimal.box\n或\nvagrant box add centos7.4 https://vagrantcloud.com/centos/boxes/7/versions/1710.01/providers/virtualbox.box \u003cspan class=\"ni\"\u003e#会从远程下载相应的box文件\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e1、虚拟机的配置信息在 vagrantfile 中，使用 \u003ccode\u003evagrant up\u003c/code\u003e 启动的虚拟机会重新创建网络等配置，因此最好在 vagrantfile 中指定这些信息。\u003c/p\u003e\n\u003cp\u003e2、由于 \u003ccode\u003evagrant\u003c/code\u003e 默认不显示虚机启动界面，在 \u003ccode\u003eVagrantfile\u003c/code\u003e 配置中增加 \u003ccode\u003evb.gui = true\u003c/code\u003e 选项，就可以查看虚机的启动过程。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e学习资料 \u003ca href=\"https://www.cnblogs.com/davenkin/p/vagrant-virtualbox.html\"\u003ehttps://www.cnblogs.com/davenkin/p/vagrant-virtualbox.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eVagrantfile \u003ca href=\"https://blog.csdn.net/u011781521/article/details/80291765\"\u003ehttps://blog.csdn.net/u011781521/article/details/80291765\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ebox 下载地址 \u003ca href=\"https://app.vagrantup.com/centos/boxes/7\"\u003ehttps://app.vagrantup.com/centos/boxes/7\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ebox下载地址 \u003ca href=\"https://github.com/CommanderK5/packer-centos-template/releases\"\u003ehttps://github.com/CommanderK5/packer-centos-template/releases\u003c/a\u003e\u003c/p\u003e","date":1541548800,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1541548800,"objectID":"15bc26a7bbfc73c89df4ff816e55a7c9","publishdate":1541548800,"relpermalink":"/posts/tools/tools-vagrant/","section":"posts","summary":"\u003cp\u003e本篇博客主要记录下 vagrant 常用的命令。\u003c/p\u003e","tags":["Vagrant"],"title":"Vagrant 常用命令和资料","url":"https://xdhuxc.github.io/posts/tools/tools-vagrant/","wordcount":418},{"categories":"posts","content":"\u003cp\u003e本篇文章介绍了使用 \u003ccode\u003eSpring Boot\u003c/code\u003e 过程中遇到的一个错误及最终的解决方法，控制台输出的主要错误信息为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eAnnotationMBeanExporter : Unregistering JMX-exposed beans on shutdown\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 \u003ccode\u003eSpring Boot\u003c/code\u003e 编写的Java 程序，其 \u003ccode\u003epom.xml\u003c/code\u003e文件内容为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e\t\u0026lt;parent\u0026gt;\n\t\t\u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt;\n\t\t\u0026lt;artifactId\u0026gt;spring-boot-starter-parent\u0026lt;/artifactId\u0026gt;\n\t\t\u0026lt;version\u0026gt;1.5.13.RELEASE\u0026lt;/version\u0026gt;\n\t\u0026lt;/parent\u0026gt;\n\t\u0026lt;dependencies\u0026gt;\n\t\t\u0026lt;dependency\u0026gt;\n\t\t\t\u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt;\n\t\t\t\u0026lt;artifactId\u0026gt;spring-boot-starter-web\u0026lt;/artifactId\u0026gt;\n\t\t\u0026lt;/dependency\u0026gt;\n\t\t\u0026lt;dependency\u0026gt;\n\t\t\t\u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt;\n\t\t\t\u0026lt;artifactId\u0026gt;spring-boot-starter-data-mongodb\u0026lt;/artifactId\u0026gt;\n\t\t\u0026lt;/dependency\u0026gt;\n\t\u0026lt;/dependencies\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e运行该程序时，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e  .   ____          _            __ _ _\n /\\\\ / ___'_ __ _ _(_)_ __  __ _ \\ \\ \\ \\\n( ( )\\___ | '_ | '_| | '_ \\/ _` | \\ \\ \\ \\\n \\\\/  ___)| |_)| | | | | || (_| |  ) ) ) )\n  '  |____| .__|_| |_|_| |_\\__, | / / / /\n =========|_|==============|___/=/_/_/_/\n :: Spring Boot ::       (v1.5.13.RELEASE)\n\n2018-05-19 16:34:04.386  INFO 3332 --- [           main] com.xdhuxc.cloud.MongodbApp              : Starting MongodbApp on DESKTOP-OC6TL9S with PID 3332 (E:\\eclipse-workspace\\xdhuxc-mongodb\\target\\classes started by wanghuan in E:\\eclipse-workspace\\xdhuxc-mongodb)\n2018-05-19 16:34:04.389  INFO 3332 --- [           main] com.xdhuxc.cloud.MongodbApp              : No active profile set, falling back to default profiles: default\n2018-05-19 16:34:04.430  INFO 3332 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@7b227d8d: startup date [Sat May 19 16:34:04 CST 2018]; root of context hierarchy\n2018-05-19 16:34:06.069  INFO 3332 --- [           main] org.mongodb.driver.cluster               : Cluster created with settings {hosts=[192.168.91.128:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms', maxWaitQueueSize=500}\n2018-05-19 16:34:06.536  INFO 3332 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup\n2018-05-19 16:34:06.545  INFO 3332 --- [           main] com.xdhuxc.cloud.MongodbApp              : Started MongodbApp in 2.436 seconds (JVM running for 2.755)\n2018-05-19 16:34:06.545  INFO 3332 --- [       Thread-2] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@7b227d8d: startup date [Sat May 19 16:34:04 CST 2018]; root of context hierarchy\n2018-05-19 16:34:06.546  INFO 3332 --- [       Thread-2] o.s.j.e.a.AnnotationMBeanExporter        : Unregistering JMX-exposed beans on shutdown\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e使用搜索引擎搜索 \u003ccode\u003eUnregistering JMX-exposed beans on shutdown\u003c/code\u003e，\n提出的方案基本都是显式添加 \u003ccode\u003etomcat\u003c/code\u003e 的依赖，向 \u003ccode\u003epom.xml\u003c/code\u003e 文件中加入如下内容：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e\u0026lt;dependency\u0026gt;\n\t\u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt;\n\t\u0026lt;artifactId\u0026gt;spring-boot-starter-tomcat\u0026lt;/artifactId\u0026gt;\n\u0026lt;/dependency\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e但是很遗憾，并没有起多大作用，还是报同样的错误。\n最后，尝试着修改了一下 \u003ccode\u003eSpring Boot\u003c/code\u003e 的版本，降级试试，于是，修改 \u003ccode\u003epom.xml\u003c/code\u003e 文件为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e\u0026lt;parent\u0026gt;\n\t\u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt;\n\t\u0026lt;artifactId\u0026gt;spring-boot-starter-parent\u0026lt;/artifactId\u0026gt;\n\t\u0026lt;version\u0026gt;1.5.12.RELEASE\u0026lt;/version\u0026gt;\n\u0026lt;/parent\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e终于可以正常启动 \u003ccode\u003eSpring Boot\u003c/code\u003e 程序了！\u003c/p\u003e\n\u003cp\u003e这应该是 \u003ccode\u003eSpring Boot\u003c/code\u003e \u003ccode\u003e1.5.12.RELEASE\u003c/code\u003e 的一个bug。\u003c/p\u003e","date":1540425600,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1540425600,"objectID":"ef8f08b890d74d7beac7754b3117efb0","publishdate":1540425600,"relpermalink":"/posts/programming/java/java-springboot-jmx/","section":"posts","summary":"\u003cp\u003e本篇文章介绍了使用 \u003ccode\u003eSpring Boot\u003c/code\u003e 过程中遇到的一个错误及最终的解决方法，控制台输出的主要错误信息为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eAnnotationMBeanExporter : Unregistering JMX-exposed beans on shutdown\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","tags":["SpringBoot","Java"],"title":"SpringBoot 应用启动报错，Unregistering JMX-exposed beans on shutdown","url":"https://xdhuxc.github.io/posts/programming/java/java-springboot-jmx/","wordcount":470},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Linux 下 服务管理工具 systemd 的使用。\u003c/p\u003e\n\u003ch3 id=\"systemd-service\"\u003esystemd service\u003c/h3\u003e\n\u003cp\u003e一种以 \u003ccode\u003e.service\u003c/code\u003e 结尾的单元（unit）配置文件，用于控制由systemd控制或监视的进程。简单来说，用于在后台以守护进程的方式运行程序。\u003c/p\u003e\n\u003cp\u003e其基本特征有：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e支持并行化任务\u003c/li\u003e\n\u003cli\u003e同时采用 \u003ccode\u003esocket\u003c/code\u003e 式与 \u003ccode\u003eD-Bus\u003c/code\u003e 总线式激活服务\u003c/li\u003e\n\u003cli\u003e按需启动守护进程（daemon）\u003c/li\u003e\n\u003cli\u003e利用 \u003ccode\u003elinux\u003c/code\u003e 的 \u003ccode\u003ecgroups\u003c/code\u003e 监视进程\u003c/li\u003e\n\u003cli\u003e支持快照和系统恢复\u003c/li\u003e\n\u003cli\u003e维护挂载点和自动挂载点\u003c/li\u003e\n\u003cli\u003e各服务间基于依赖关系进行精密控制\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"systemd\"\u003esystemd\u003c/h3\u003e\n\u003ch4 id=\"基本结构\"\u003e基本结构\u003c/h4\u003e\n\u003cp\u003esystemd 服务的主要内容分为三个部分：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e控制单元的定义\u003c/li\u003e\n\u003cli\u003e服务的定义\u003c/li\u003e\n\u003cli\u003e安装部分\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"说明\"\u003e说明\u003c/h4\u003e\n\u003cp\u003e1、\u003ccode\u003esystemd\u003c/code\u003e 单元文件中的以 \u003ccode\u003e#\u003c/code\u003e 开头的行后面的内容会被认为是注释。\u003c/p\u003e\n\u003cp\u003e2、\u003ccode\u003esystemd\u003c/code\u003e 下的布尔值：\u003ccode\u003e1\u003c/code\u003e、\u003ccode\u003eyes\u003c/code\u003e、\u003ccode\u003eon\u003c/code\u003e、\u003ccode\u003erue\u003c/code\u003e 都是开启；\u003ccode\u003e0\u003c/code\u003e、\u003ccode\u003eno\u003c/code\u003e、\u003ccode\u003eoff\u003c/code\u003e、\u003ccode\u003efalse\u003c/code\u003e 都是关闭，仅限于 \u003ccode\u003esystemd\u003c/code\u003e 文件，不适用于该文件中嵌入的 \u003ccode\u003eshell\u003c/code\u003e 语句。\u003c/p\u003e\n\u003cp\u003e3、\u003ccode\u003esystemd\u003c/code\u003e 下的时间单位默认是秒，因此，使用毫秒，分钟时要显式说明。\u003c/p\u003e\n\u003ch4 id=\"示例说明\"\u003e示例说明\u003c/h4\u003e\n\u003cp\u003e以如下service文件为示例进行语法说明\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=Network Manager\nAfter=syslog.target\nWants=remote-fs.target network.target\n\n[Service]\nType=dbus\nBusName=org.freedesktop.NetworkManager\nExecStart=/usr/sbin/NetworkManager --no-daemon\nEnvironmentFile=/etc/sysconfig/network/config\nExecStartPre=/usr/bin/test \u0026#34;x${NETWORKMANAGER}\u0026#34; = xyes\n\u003cspan class=\"gh\"\u003e# Suppress stderr to eliminate duplicated messages in syslog. NM calls openlog()\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# with LOG_PERROR when run in foreground. But systemd redirects stderr to\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# syslog by default, which results in logging each message twice.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eStandardError=null\n\n[Install]\nWantedBy=multi-user.target\nAlso=NetworkManager-wait-online.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"定义控制单元\"\u003e定义控制单元\u003c/h4\u003e\n\u003cp\u003e在 \u003ccode\u003esystemd\u003c/code\u003e 中，所有引导过程中 \u003ccode\u003esystemd\u003c/code\u003e 要控制的东西都是一个单元。\u003ccode\u003esystemd\u003c/code\u003e 的单元类型有：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e系统服务（.service）\u003c/li\u003e\n\u003cli\u003e套接字（.sockets）\u003c/li\u003e\n\u003cli\u003e设备（.device）\u003c/li\u003e\n\u003cli\u003e挂载点（.mount）\u003c/li\u003e\n\u003cli\u003e自动挂载点（）\u003c/li\u003e\n\u003cli\u003e交换分区（.swap）\u003c/li\u003e\n\u003cli\u003e分区（）\u003c/li\u003e\n\u003cli\u003e启动对象（.target）\u003c/li\u003e\n\u003cli\u003e文件系统路径（.path）\u003c/li\u003e\n\u003cli\u003e定时器（）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e单元名即 \u003ccode\u003e.service\u003c/code\u003e 文件的名称。但不只有 \u003ccode\u003e.service\u003c/code\u003e 后缀的文件才可以是一个 单元，单元还可以有 \u003ccode\u003e.target\u003c/code\u003e, \u003ccode\u003e.path\u003c/code\u003e等后缀，具体可以在 \u003ccode\u003e/usr/lib/systemd/system\u003c/code\u003e 下了解。但这些后缀要么由 systemd 上游开发者写好随 systemd 软件包分发，要么由 Base:system 团队添加，一般用户是不太需要写其它后缀的控制单元的。\u003c/p\u003e\n\u003cp\u003e单元文件可以从两个地方进行加载，优先级从低到高分别是：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e/usr/lib/systemd/system/ ：软件包安装的单元\u003c/li\u003e\n\u003cli\u003e/etc/systemd/system/ ：系统管理员安装的单元\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e1）声明我们在定义控制单元，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）添加单元描述，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=Daemon to start He.net IPv6\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）systemd对各个单元之间关系的控制：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=Daemon to start He.net IPv6\nWants=network-online.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eRequires，当前单元启动了，那么它所需要的单元也会被启动；当前单元需要的单元被停止了，那么它自己也活不了。但是请注意，这个设定并不能控制某单元与其所需要的单元的启动顺序（启动顺序是另外控制的），即 systemd 不是先启动本单元所需要的单元，再启动本单元，而是在本单元被激活时，并行启动两者，因此会产生争分夺秒的问题。如果当前单元所需要的单元先启动成功，那么皆大欢喜; 如果当前单元所需要的单元启动得慢，那么本单元就会启动失败（systemd 没有自动重试）。因此，为了系统的健壮性，不建议使用这个标记，而建议使用 Wants 标记。可以使用多个 Requires。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRequiresOverridable：跟 Requires 很像。但是如果这条服务是由用户手动启 动的，那么 RequiresOverridable 后面的服务即使启动不成功也不报错。跟 Requires 比增加了一定的容错性，但是你要确定你的服务是有等待功能的。另外，如果不由用户手动启动而是随系统开机启动，那么依然会有 Requires 面临的问题.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRequisite：强势版本的Requires，要是这里需要的服务启动不成功，那本单元文件不管能不能检测，等不能等待都会立刻就失败。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eWants：推荐使用。本单元启动了，它所需要的单元也会被启动，如果启动不成功，对本单元没有影响。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eConflicts：一个单元的启动会停止与它冲突的单元，反之亦然。注意这里和后面的启动顺序是“正交”的：\n两个相互冲突的单元被同时启动，要么两个都启动不了（两者都是第三个单元的 Requires），要么启动一个（有一个是第三个单元的Requires，另一个不是），不是 Requires 的那个会被停止。要是两者都不是任何一个单元的Requires，那么 Conflicts 别的那个单元优先启动，被Conflicts的后启动，要是互相写了，那么两个都启动不了。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOnFailure：很明显，如果本单元启动失败了，那么启动什么单元作为折衷。\n我们的单元，Ipv6 隧道，应该想要什么呢？很显然是一个连通着的网络。有一个 systemd 默认提供的对象叫做 network-online.target（默认的 target 列表可见 \u003ca href=\"https://www.freedesktop.org/software/systemd/man/systemd.special.html\"\u003esystemd.special\u003c/a\u003e，因为你大多数时候Wants的都是一个固定的系统状态而不是其它 systemd服务），正好能够提供我们需要的环境。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e4）定义服务启动顺序\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=Daemon to start He.net IPv6\nWants=network-online.target\nAfter=network.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003esystemd 服务启动顺序主要使用以下两个标记定义的：\u003c/p\u003e\n\u003cp\u003eBefore/After：要是一个服务在另一个服务之前启动，那么在并行启动时（systemd 总是用进程 0 并行启动所有东西，然后通过这两个标记来二次等待排序），另一个服务这时就会等这个服务先启动并返回状态，注意是先启动，而不是先启动成功，因为失败也是一种状态，一定要成功才启动另一个服务是通过依赖关系定义的。反之 After 亦然。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e关机\u003c/code\u003e（可以是挂起，这时候有些服务依然在运行，比如网络唤醒等）时候的顺序：如果两个服务都是要关掉的，Before 是先停止自己，After 是先停止别人； 但如果一个服务要停止，而另一个服务要启动，那么不管 Before/After 如何写，总是优先关闭而不是开始。也就是比如服务 A Before 服务 B，但是服务 B 是在关，而服务 A 是在 restart，那么服务 B 的顺序在服务 A 的前面。\u003c/p\u003e\n\u003cp\u003e我们的单元应该在什么服务的前后启动呢？它不需要一定在什么服务前面跑起来，这不像 ifup 和 dhcp，网络起不来获取 ip 肯定没用。我们只需要有网就可以了。\u003ccode\u003e有网\u003c/code\u003e 在 systemd 中也是由一个默认 \u003ccode\u003etarget：network.target\u003c/code\u003e 提供的，\u003c/p\u003e\n\u003ch4 id=\"定义服务本体\"\u003e定义服务本体\u003c/h4\u003e\n\u003cp\u003e1）声明服务本体，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Service]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）声明服务的类型，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Service]\nType=\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003esystemd 支持的服务类型有以下几类：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003esimple， 默认服务类型，最简单的服务类型。就是说启动的程序就是主体程序，该程序要是退出，那么一切皆休。这在图形界面里非常好理解，用户打开一个窗口，退出它就没有了。但是命令行中的大部分程序都不会这样设计，因为命令行程序的一个最基本的原则就是：一个好的程序不能独占命令行窗口。因此，输入命令，回车，接着马上返回提示符，但程序已经执行了。在这种类型下，如果主程序是要响应其它程序的，那么你的通信频道应该在启动本服务前就设好（套接字等），因此这种类型的服务，Systemd 运行它后会立刻就运行下面的服务（需要它的服务），这时没有套接字后面的服务会失败，写 After 也没用，因为 simple 类型不存在主进程退出的情况，也就不存在有返回状态的情况，所以它一旦启动就认为是成功的，除非没起来。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eforking，标准 Unix Daemon 使用的启动方式。启动程序后会调用 fork() 函数，把必要的通信频道都设置好之后父进程退出，留下守护进程的子进程。使用这种方式，最好也指定下 PIDFILE=，不要让 systemd 去猜，非要猜也可以，把 GuessMainPID 设为 yes。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e判断是 forking 还是 simple 类型非常简单，命令行里运行下程序，持续占用命令行要按 Ctrl + C 才可以的，就不会是 forking 类型。\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e创建 PIDFILE 是为它写服务的程序的任务，而不是 systemd 的功能，甚至也不是 SysV init 脚本的功能。因此，如果你的程序确实是 forking 类型，但没有实现创建 PIDFILE 的功能，那么建议使用 ExecStartPost= 结合 shell 命令来手动抓取进程编号并写到 /var/run/xxx.pid文件中。\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eoneshot，一次性的，这种服务类型就是启动，完成，没进程了。常见的，比如设置网络，ifup eth0 up，就是一次性的，不存在 ifup 的子进程，也不存在主进程，运行完成后便了无痕迹。由于这类服务运行完就没有进程了，我们经常会需要 \u003ccode\u003eRemainAfterExit=yes\u003c/code\u003e。后面配置的意思是说，即使没进程了, systemd 也认为该服务是存在并成功了。所以如果你有一个这样的服务，服务启动后，你再去 ifup eth0 up，这时你再看服务，依然显示是 running 的。因为只要在执行那条一次性命令的时候没出错，那么它就永远认为它是成功并一直存在的，直到你关闭服务。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003edbus，程序启动时需要获取一块 DBus 空间，所以需要和 BusName= 一起使用。只有它成功获得了 DBus 空间，依赖它的程序才会被启动。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e一般情况下，只能用到上面四个，还有两种少见的类型：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003enotify， 程序在启动完成后会通过 sd_notify 发送一个通知消息。所以还需要配合 NotifyAccess 来让 systemd 接收消息，后者有三个级别：none，所有消息都忽略掉; main，只接受程序的主进程发过去的消息; all，程序的所有进程发过去的消息都算。NotifyAccess 要是不写的话，默认是 main。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eidle，程序要等它里面调度的全部其它东西都运行完才会运行它自己。比如你 ExecStart 的是个 shell 脚本，里面可能运行了一些别的东西，如果不这样的话，那很可能别的东西的控制台输出里会多一个“启动成功”这样的 systemd 消息。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e由于 He.net 的 IPv6 是用 iproute2 的 ip 命令来弄的，所以是一个 oneshot 一次性服务。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Service]\nType=oneshot\nRemainAfterExit=yes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e接下来要设置 ExecStart, ExecStop。如果程序支持的话，还可以去设置 ExecReload，Restart 等。注意，这里设置的是它们 Reload/Restart 的方式，但并不代表没有它们， systemd 就不能完成比如 \u003ccode\u003esystemctl restart xxx.service\u003c/code\u003e 这样的任务，程序有支持自然最好，程序不支持那就先 stop 再 start。同样，有特殊要求的时候也可以去设置比如 ExecStartPre，ExecStartPost，RestartSec，TimeoutSec 等其它东西。\u003c/p\u003e\n\u003cp\u003e这里要特殊讲一下 ExecStart：\u003c/p\u003e\n\u003cp\u003e如果你服务的类型不是 \u003ccode\u003eoneshot\u003c/code\u003e ，那么它只可以接受一个命令，参数不限，比如你先 \u003ccode\u003eip tunnel create\u003c/code\u003e 再 \u003ccode\u003eip tunnel0 up\u003c/code\u003e，那是两个 ip 命令，如果不是 \u003ccode\u003eoneshot\u003c/code\u003e 类型这样是不行的。\n如果有多条命令（oneshot 类型），命令之间以分号 \u003ccode\u003e;\u003c/code\u003e 分隔，跨行可用反斜杠 \u003ccode\u003e\\\u003c/code\u003e。除非你的服务类型是 \u003ccode\u003eforking\u003c/code\u003e ，否则在这里输入的命令都会被认为是主进程，不管它是不是。\u003c/p\u003e\n\u003ch4 id=\"安装服务\"\u003e安装服务\u003c/h4\u003e\n\u003cp\u003e这里说的 \u003ccode\u003e安装\u003c/code\u003e 是一种内部状态，默认放对service文件位置，显示的是 disabled，unloaded，因此要在 systemd 内部对它进行加载，没人需要的东西是不需要安装的，所以要告诉 systemd 它是有人需要的，被谁需要。一般都是被需要的（\u003ccode\u003emulti-user.target\u003c/code\u003e 表示多用户系统，简单理解就是你可以登入了）。这样在 \u003ccode\u003emulti-user.target\u003c/code\u003e 启用时，我们的服务也就会被启用了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e[Install] 部分下除了 WantedBy 还有两种属性，分别是：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eAlias=\u003c/code\u003e ，别名，这样 \u003ccode\u003esystemctl command xxx.service\u003c/code\u003e 的时候就可以不输入完整的单元名称。比如你给 \u003ccode\u003eNetworkManager\u003c/code\u003e 取一个别名叫 \u003ccode\u003eAlias=nm\u003c/code\u003e，那就可以 \u003ccode\u003esystemctl status nm.service\u003c/code\u003e 查看实际是 \u003ccode\u003eNetworkManager.service\u003c/code\u003e 的服务了。\n\u003ccode\u003eAlso=\u003c/code\u003e ，安装本服务的时候还要安装别的什么服务。比如我们的 He.net 脚本按理应该需要一个 \u003ccode\u003eiproute2.service\u003c/code\u003e 作为 also，但是 iproute2 实际上不需要 systemd 控制，所以就没写。它和 [Unit] 定义里面的依赖关系相比，它管理的不是运行时依赖，而是安装时。安装好了之后启动谁先谁后，谁依赖谁，和 \u003ccode\u003eAlso=\u003c/code\u003e 都没有关系。\u003c/p\u003e\n\u003ch3 id=\"systemd-常用命令\"\u003esystemd 常用命令\u003c/h3\u003e\n\u003cp\u003e1、检查docker服务环境变量是否加载\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl show docker --property Environment\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、异步启动服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl --no-block start etcd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1540252800,"description":"","fuzzywordcount":4300,"kind":"page","lang":"zh","lastmod":1544313600,"objectID":"035805b46a50a5a4d2bfe4cbf472505c","publishdate":1540252800,"relpermalink":"/posts/linux/linux-systemd/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Linux 下 服务管理工具 systemd 的使用。\u003c/p\u003e","tags":["Linux","systemd"],"title":"Linux 中 systemd 的使用","url":"https://xdhuxc.github.io/posts/linux/linux-systemd/","wordcount":4257},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 etcd 中常用的命令和 API 的用法。\u003c/p\u003e\n\u003ch3 id=\"常用命令\"\u003e常用命令\u003c/h3\u003e\n\u003cp\u003e1、设置键值对\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eetcdctl set xdhuxc adobe\n或\netcdctl set /xdhuxc adobe\n或\ncurl -X PUT http://10.10.24.75:2379/v2/keys/xdhuxc -d value=\u0026#34;adobe\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、获取所有的key\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -s http://10.10.24.75:2379/v2/keys | python -m json.tool\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、获取键值对\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eetcdctl get xdhuxc\n或\netcdctl get /xdhuxc\n或\ncurl -s http://10.10.24.75:2379/v2/keys/xdhuxc | python -m json.tool\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、删除键值对\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eetcdctl rm xdhuxc\n或\netcdctl rm /xdhuxc\n或\ncurl -X –s DELETE http://127.0.0.1:2379/v2/keys/xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、查看当前集群中的节点和leader节点\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eetcdctl member list\n或\ncurl -s http://172.20.26.149:2379/v2/members|python -m json.tool\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者使用 debug 模式查看\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eetcdctl --debug member list\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、查看etcd节点状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eetcdctl cluster-health\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"常用-api\"\u003e常用 API\u003c/h3\u003e\n\u003cp\u003e1、查看 etcd 版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/version\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看所有的键\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/keys \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、创建键值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/keys/xdhuxc-key -XPUT -d value=\u0026#34;xdhuxc-value\u0026#34; # 创建键值对 xdhuxc-key=xdhuxc-value\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e对于 put 方法，如果 key 之前存在，则默认会先删除，再新建一个 key。\u003c/p\u003e\n\u003cp\u003e如果想要直接 update，则追加 -d prevExist=true，但是加了这个参数，如果 key 之前不存在，则会报错。\u003c/p\u003e\n\u003cp\u003e4、创建目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/keys/xdhuxc-dir -XPUT -d dir=true # 创建目录 xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、创建带 TTL 的键值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/keys/xdhuxc-ttl-key -XPUT -d value=\u0026#34;xdhuxc-ttl-value\u0026#34; -d ttl=10 # 单位为秒\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、创建有序键值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/keys/xdhuxc-seq -XPOST -d value=\u0026#34;seqone\u0026#34;\ncurl http://10.10.24.28:2379/v2/keys/xdhuxc-seq -XPOST -d value=\u0026#34;seqtwo\u0026#34;\ncurl http://10.10.24.28:2379/v2/keys/xdhuxc-seq -XPOST -d value=\u0026#34;seqthree\u0026#34;\ncurl http://10.10.24.28:2379/v2/keys/xdhuxc-seq\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、删除指定的键\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/keys/xdhuxc-key -XDELETE # 删除键 xdhuxc-key\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、列出所有集群成员\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/members\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e9、查看 leader\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/stats/leader\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e10、节点自身信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/stats/self\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e11、查看集群运行状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://10.10.24.28:2379/v2/stats/store\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1539561600,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1542672000,"objectID":"849a8ff140a24f3a40779d23b349361e","publishdate":1539561600,"relpermalink":"/posts/storage/etcd/etcd-command/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 etcd 中常用的命令和 API 的用法。\u003c/p\u003e","tags":["etcd"],"title":"etcd 常用命令和 API 总结","url":"https://xdhuxc.github.io/posts/storage/etcd/etcd-command/","wordcount":447},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Linux 下 RPM 包管理工具的使用。\u003c/p\u003e\n\u003ch3 id=\"rpm\"\u003erpm\u003c/h3\u003e\n\u003cp\u003erpm 命令是 RPM 软件包的管理工具。rpm 原本是 Red Hat Linux 发行版专门用来管理 Linux 各项套件的程序，由于它遵循GPL规则且功能强大方便，因而广受欢迎。逐渐受到其他发行版的采用。RPM 套件管理方式的出现，让 Linux 易于安装，升级，间接提升了 Linux 的适用度。\u003c/p\u003e\n\u003ch4 id=\"rpm包管理的用途\"\u003erpm包管理的用途\u003c/h4\u003e\n\u003cp\u003e1、可以安装、删除、升级和管理软件，当然也支持在线安装和升级软件；\u003c/p\u003e\n\u003cp\u003e2、通过RPM包管理能知道软件包包含哪些文件，也能知道系统中的某个文件属于哪个软件包；\u003c/p\u003e\n\u003cp\u003e3、可以在查询系统中的软件包是否安装以及其版本；\u003c/p\u003e\n\u003cp\u003e4、作为开发者可以把自己的程序打包为RPM 包发布；\u003c/p\u003e\n\u003cp\u003e5、软件包签名GPG和MD5的导入、验证和签名发布；\u003c/p\u003e\n\u003cp\u003e6、依赖性的检查，查看是否有软件包由于不兼容而扰乱了系统；\u003c/p\u003e\n\u003ch4 id=\"rpm-的使用权限\"\u003erpm 的使用权限\u003c/h4\u003e\n\u003cp\u003eRPM软件的安装、删除、更新只有 root 权限才能使用；\u003c/p\u003e\n\u003cp\u003e对于查询功能任何用户都可以操作；\u003c/p\u003e\n\u003cp\u003e如果普通用户拥有安装目录的权限，也可以进行安装；\u003c/p\u003e\n\u003ch4 id=\"rpm命令\"\u003erpm命令\u003c/h4\u003e\n\u003ch5 id=\"初始化-rpm-数据库\"\u003e初始化 rpm 数据库\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm --initdb\nrpm --rebuilddb\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"软件包的安装升级和删除等\"\u003e软件包的安装、升级和删除等\u003c/h5\u003e\n\u003cp\u003e1、安装 docker 包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -vih docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n或\nrpm -ivh docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm --nodeps --force # 安装软件包时不检查依赖关系\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、升级 docker 包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -Uvh docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、删除软件包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -e docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"rpm-软件包管理的查询功能\"\u003erpm 软件包管理的查询功能\u003c/h5\u003e\n\u003cp\u003e1、查询系统已经安装的软件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -q docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n或\nrpm --query docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看系统中所有已经安装的软件包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -qa\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查询一个已经安装的文件属于哪个软件包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -qf file_absolute_path\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、查询已安装软件包的安装位置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -ql docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n或\nrpm rpmquery -ql docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、查询一个已安装软件包的信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -qi docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、查看已安装软件包的配置文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -qc docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、查看某个rpm包的依赖关系\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -qpR docker-ce-17.12.1.ce-1.el7.centos.x86_64.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"rpm-包命名规则\"\u003erpm 包命名规则\u003c/h4\u003e\n\u003cp\u003e1、RPM包的一般格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ename-version-arch.rpm\nname-version-arch.src.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e（1）name，如：httpd，是软件的名称\u003c/p\u003e\n\u003cp\u003e（2）version，如:2.2.3 ,是软件的版本号。版本号的格式通常为“主版本号.次版本号.修正号”\n29，是发布版本号，表示这个RPM包是第几次编译生成的\u003c/p\u003e\n\u003cp\u003e（3）arch,如:i386,表示包的适用的硬件平台，目前RPM支持的平台有：i386、i586、i686、sparc、alpha\u003c/p\u003e\n\u003cp\u003e（4）.rpm或.src.rpm,是RPM包类型的后缀，.rpm是编译好的二进制包，可用rpm命令直接安装；.src.rpm表示是源代码包，需要安装源码包生成源码，并对源码编译生成.rpm格式的RPM包，就可以对这个RPM包进行安装了\u003c/p\u003e\n\u003cp\u003e2、特殊名称\u003c/p\u003e\n\u003cp\u003e（1）el*  表示这个软件包的发行商版本,el5表示这个软件包是在RHEL 5.x/CentOS 5.x下使用。\u003c/p\u003e\n\u003cp\u003e（2）devel：表示这个RPM包是软件的开发包。\u003c/p\u003e\n\u003cp\u003e（3）noarch：说明这样的软件包可以在任何平台上安装，不需要特定的硬件平台。在任何硬件平台上都可以运行。\u003c/p\u003e\n\u003cp\u003e（4）manual 手册文档\u003c/p\u003e\n\u003ch3 id=\"yum\"\u003eyum\u003c/h3\u003e\n\u003cp\u003e全称为 \u003ccode\u003eYellow dog Updater, Modified\u003c/code\u003e，是一个在\u003ccode\u003eFedora\u003c/code\u003e和\u003ccode\u003eRedHat\u003c/code\u003e以及\u003ccode\u003eSUSE\u003c/code\u003e中的\u003ccode\u003eShell前端软件包管理器\u003c/code\u003e。基于RPM包管理，能够从指定的服务器自动下载RPM包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软体包，无须繁琐地一次次下载、安装。\u003c/p\u003e\n\u003cp\u003eyum提供了查找、安装、删除某一个、一组甚至全部软件包的命令，而且命令简洁而又好记。\u003c/p\u003e\n\u003cp\u003eyum的宗旨是自动化地升级，安装/移除rpm包，收集rpm包的相关信息，检查依赖性并自动提示用户解决\u003c/p\u003e\n\u003cp\u003eyum的关键之处是要有可靠的仓库，这是软件的仓库，它可以是http或ftp站点， 也可以是本地软件池，但必须包含rpm的header， header包括了rpm包的各种信息，包括描述，功能，提供的文件，依赖性等.正是收集了这些 header并加以分析，才能自动化地完成余下的任务。\u003c/p\u003e\n\u003ch4 id=\"yum-的特点\"\u003eyum 的特点\u003c/h4\u003e\n\u003cp\u003e1、可以同时配置多个资源库(Repository)\u003c/p\u003e\n\u003cp\u003e2、简洁的配置文件(/etc/yum.conf)\u003c/p\u003e\n\u003cp\u003e3、自动解决增加或删除rpm包时遇到的倚赖性问题\u003c/p\u003e\n\u003cp\u003e4、使用方便\u003c/p\u003e\n\u003cp\u003e5、保持与RPM数据库的一致性\u003c/p\u003e\n\u003ch4 id=\"yum-的配置文件\"\u003eyum 的配置文件\u003c/h4\u003e\n\u003cp\u003eyum 的配置文件分为两部分：main 和repository：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emain 部分定义了全局配置选项，整个yum 配置文件应该只有一个main。常位于/etc/yum.conf 中。\u003c/li\u003e\n\u003cli\u003erepository 部分定义了每个源/服务器的具体配置，可以有一到多个。常位于/etc/yum.repo.d 目录下的各文件中。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eyum.conf 文件一般位于/etc目录下，一般其中只包含main部分的配置选项。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[main]\ncachedir=/var/cache/yum     \u003cspan class=\"ni\"\u003e#yum缓存的目录\u003c/span\u003e，yum在此存储下载的rpm包和数据库，默认设置为：/var/cache/yum。\n\nkeepcache=0                 \u003cspan class=\"ni\"\u003e#安装完成后是否保留软件包\u003c/span\u003e，0为不保留，1为保留，默认为0。\n\ndebuglevel=2                \u003cspan class=\"ni\"\u003e#Debug\u003c/span\u003e 信息输出等级，范围为：0──10，默认为2。\n\nlogfile=/var/log/yum.log    \u003cspan class=\"ni\"\u003e#yum的日志文件\u003c/span\u003e，默认为：/var/log/yum.log。\n\npkgpolicy=newest            \u003cspan class=\"ni\"\u003e#包的策略\u003c/span\u003e。一共有两个选项，newest和last，这个作用是如果你设置了多个repository，而同一软件在不同的repository中同时存在，yum应该安装哪一个，如果是newest，则yum会安装最新的那个版本。如果是last，则yum会将服务器id以字母表排序，并选择最后的那个服务器上的软件安装。一般都是选newest。\n\ndistroverpkg=redhat-release \u003cspan class=\"ni\"\u003e#指定一个软件包\u003c/span\u003e，yum会根据这个包判断你的发行版本，默认是redhat-release，也可以是安装的任何针对自己发行版的rpm包。\n\ntolerant=1                  \u003cspan class=\"ni\"\u003e#有1和0两个选项\u003c/span\u003e，表示yum是否容忍命令行发生与软件包有关的错误，比如你要安装1,2,3三个包，而其中3此前已经安装了，如果你设为1,则yum 不会出现错误信息。默认是0。\n　　\nexactarch=1                 \u003cspan class=\"ni\"\u003e#有两个选项1和0\u003c/span\u003e，设置为1，则yum只会安装和系统架构匹配的软件包，例如，yum不会将i686的软件包安装在适合i386的系统中。默认为1。\n\nretries=6                   \u003cspan class=\"ni\"\u003e#网络连接发生错误后的重试次数\u003c/span\u003e，如果设为0，则会无限重试。默认值为6。\n\nobsoletes=1                 \u003cspan class=\"ni\"\u003e#这是一个update\u003c/span\u003e 的参数，相当于upgrade，允许更新陈旧的RPM包。\n\nplugins=1                   \u003cspan class=\"ni\"\u003e#是否启用插件\u003c/span\u003e，默认1为允许，0表示不允许。我们一般会用yum-fastestmirror这个插件。\n\nexclude=selinux*            \u003cspan class=\"ni\"\u003e#排除某些软件在升级名单之外\u003c/span\u003e，可以用通配符，列表中各个项目要用空格隔开，\n\ngpgcheck=1                  \u003cspan class=\"ni\"\u003e#有1和0两个选择\u003c/span\u003e，分别代表是否是否进行gpg(GNU Private Guard)校验，以确定rpm包的来源是有效和安全的。这个选项如果设置在[main]部分，则对每个repository 都有效。默认值为0。\n\nmetadata_expire=1800\n\n\n\u003cspan class=\"gh\"\u003e# PUT YOUR REPOS HERE OR IN separate files named file.repo\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# in /etc/yum.repos.d\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"yum-命令\"\u003eyum 命令\u003c/h4\u003e\n\u003cp\u003eyum命令的一般形式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum [options] [command] [package...]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eoptions 是可选的，选项包括：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e-h：显示帮助信息。\n-y：当安装过程中提示选择时，全部为“yes”。\n-q：不显示安装的过程。\n-c：指定配置文件。\n-v：详细模式。\n-d：设置调试等级（0-10）。\n-e：设置错误等级（0-10）。\n-R：设置yum处理一个命令的最大等待时间。\n-C：完全从缓存中运行，而不去下载或者更新任何头文件。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ecommand 为所要进行的操作\u003c/p\u003e\n\u003cp\u003epackage 是操作的对象\u003c/p\u003e\n\u003cp\u003e常用的命令包括：\u003c/p\u003e\n\u003cp\u003e1、自动搜索最快镜像插件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install yum-fastestmirror\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、安装 yum 图形窗口插件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install yumex\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查看可能批量安装的列表：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum grouplist\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"yum-命令详解\"\u003eyum 命令详解\u003c/h4\u003e\n\u003cp\u003e1、全部安装\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、安装指定的软件包 nginx\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install nginx -y\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、安装程序组 kubernetes\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum groupinstall kubernetes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、安装指定版本的软件包 kubernetes\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum list kubernetes\n\u003cspan class=\"gh\"\u003e# 根据输出的软件包全名称进行安装\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eyum install -y kubernetes-1.20.12.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、全部更新\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum update\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、更新指定的程序包 nginx\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum update nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、检查可更新的程序\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum check-update\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、升级指定软件包 nginx\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum upgrade nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e9、升级指定程序组 kubernetes\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum groupupdate kubernetes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e10、显示安装包 nginx 的信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum info nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e11、显示所有已经安装和可以安装的软件包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum list\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e12、显示指定程序包 nginx 的安装情况\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum list nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e13、显示程序组 kubernetes 的信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum groupinfo kubernetes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e14、根据关键字 keyword 查找安装包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum search keyword\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e15、删除软件包 nginx\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum remove nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e16、删除程序包组 kubernetes\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum groupremove kubernetes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e17、查看软件包 nginx 的依赖情况\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum deplist nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e18、清除缓存目录下的软件包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum clean nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e19、清除缓存目录下的headers\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum clean headers\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e20、清除缓存目录下旧的 headers\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum clean oldheaders\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e21、清除缓存目录下的软件包及旧的 headers\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum clean packages,yum clean oldheaders\n等价于\nyum clean,yum clean all\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e22、查看系统默认安装的 yum\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -qa|grep yum\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e23、查看 yum 的某一条命令属于哪一个软件包，然后就可以安装这个软件包了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum provides lssubsys \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1539561600,"description":"","fuzzywordcount":3300,"kind":"page","lang":"zh","lastmod":1544140800,"objectID":"6462798b271cf35787b2978970576d40","publishdate":1539561600,"relpermalink":"/posts/linux/linux-rpm-yum/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Linux 下 RPM 包管理工具的使用。\u003c/p\u003e","tags":["Linux","RPM","YUM"],"title":"Linux 下 RPM 和 YUM 的使用","url":"https://xdhuxc.github.io/posts/linux/linux-rpm-yum/","wordcount":3241},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了给在 VMware 中创建的虚拟机设置静态 IP 的步骤。\u003c/p\u003e\n\u003cp\u003e1）在 \u003ccode\u003eVMware\u003c/code\u003e 中，\u003ccode\u003e编辑\u003c/code\u003e -\u0026gt; \u003ccode\u003e虚拟网络编辑器\u003c/code\u003e -\u0026gt; \u003ccode\u003e添加网络\u003c/code\u003e，选择合适的网络名称，例如 \u003ccode\u003eVMnet10\u003c/code\u003e，点击 \u003ccode\u003e确定\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e2）点击 \u003ccode\u003eVMnet10\u003c/code\u003e，选择 \u003ccode\u003e仅主机模式\u003c/code\u003e，填写子网和子网掩码，例如子网为：\u003ccode\u003e172.16.56.0\u003c/code\u003e，子网掩码为：\u003ccode\u003e255.255.255.0\u003c/code\u003e，点击 \u003ccode\u003e应用\u003c/code\u003e。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/vmware-static-ip/WechatIMG623.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e3）选择要修改 \u003ccode\u003eIP\u003c/code\u003e 地址的虚拟机，点击 \u003ccode\u003e编辑虚拟机设置\u003c/code\u003e，点击 \u003ccode\u003e网络适配器\u003c/code\u003e，在 \u003ccode\u003e网络连接\u003c/code\u003e 中选择 \u003ccode\u003e自定义\u003c/code\u003e，再选择 \u003ccode\u003eVMnet10 仅主机模式\u003c/code\u003e，点击 \u003ccode\u003e确定\u003c/code\u003e。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/vmware-static-ip/WechatIMG624.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e4）登录虚拟机，修改 \u003ccode\u003e/etc/sysconfig/network-scripts\u003c/code\u003e 目录下 \u003ccode\u003eifcfg-ens33\u003c/code\u003e，修改如下内容，修改 \u003ccode\u003eBOOTPROTO\u003c/code\u003e 为 \u003ccode\u003estatic\u003c/code\u003e，\u003ccode\u003eIPADDR\u003c/code\u003e 为指定的 \u003ccode\u003eIP\u003c/code\u003e 地址，例如 \u003ccode\u003e172.16.56.58\u003c/code\u003e，子网 \u003ccode\u003eNETWORK\u003c/code\u003e 为 \u003ccode\u003e172.16.56.0\u003c/code\u003e，子网掩码 \u003ccode\u003eNETMASK\u003c/code\u003e 为：\u003ccode\u003e255.255.255.0\u003c/code\u003e，网关 \u003ccode\u003eGATEWAY\u003c/code\u003e 为：\u003ccode\u003e172.16.56.1\u003c/code\u003e。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/vmware-static-ip/WechatIMG625.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n使用 `systemctl restart network` 命令重新启动网络。","date":1539388800,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1539734400,"objectID":"e09d26241367d9b7f77d406f48414d59","publishdate":1539388800,"relpermalink":"/posts/linux/linux-vmware-static-ip/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了给在 VMware 中创建的虚拟机设置静态 IP 的步骤。\u003c/p\u003e","tags":["VMware"],"title":"给 VMware 中创建的虚拟机设置静态 IP","url":"https://xdhuxc.github.io/posts/linux/linux-vmware-static-ip/","wordcount":348},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了 FastDFS 的安装和其配合 Nginx 使用的步骤。\u003c/p\u003e\n\u003ch3 id=\"环境信息\"\u003e环境信息\u003c/h3\u003e\n\u003cp\u003e服务器信息：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eip\u003c/th\u003e\n\u003cth\u003eos\u003c/th\u003e\n\u003cth\u003erole\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e172.20.15.73\u003c/td\u003e\n\u003ctd\u003eCentos 7\u003c/td\u003e\n\u003ctd\u003etracker\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e172.20.15.75\u003c/td\u003e\n\u003ctd\u003eCentos 7\u003c/td\u003e\n\u003ctd\u003estorage\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e软件相关信息：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003esoft\u003c/th\u003e\n\u003cth\u003eversion\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003efastdfs\u003c/td\u003e\n\u003ctd\u003e5.11\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003elibfastcommon\u003c/td\u003e\n\u003ctd\u003e1.0.39\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003enginx\u003c/td\u003e\n\u003ctd\u003e1.12.2\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003efastdfs-nginx-module\u003c/td\u003e\n\u003ctd\u003e1.20\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"部署-fastdfs\"\u003e部署 FastDFS\u003c/h3\u003e\n\u003cp\u003e1、拷贝安装包，并解压\u003c/p\u003e\n\u003cp\u003e将安装包考本到两台服务器的 \u003ccode\u003e/usr/local/src\u003c/code\u003e，并进入该目录，解压安装包：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecd /usr/local/src \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e unzip fastdfs.zip -d /usr/local/src\ncd /usr/local/src/fastdfs\nls | grep \u0026#39;tar.gz\u0026#39; | xargs -I {} tar -xzvf {} -C /usr/local/src/fastdfs\ncd /usr/local/src/fastdfs/nginx/\nls | grep \u0026#39;tar.gz\u0026#39; | xargs -I {} tar -xzvf {} -C /usr/local/src/fastdfs/nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、安装相关依赖\u003c/p\u003e\n\u003cp\u003e分别进入两台服务器的 \u003ccode\u003e/usr/local/src/fastdfs/fastdfs-lib\u003c/code\u003e 目录，安装相关依赖：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -ivh --force /usr/local/src/fastdfs/fastdfs-lib/*\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、安装 libfastcommon\u003c/p\u003e\n\u003cp\u003e通过如下命令，在两台服务器上安装 \u003ccode\u003elibfastcommon\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecd /usr/local/src/fastdfs/libfastcommon-1.0.39/\n./make.sh \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ./make.sh install\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e看到如下信息，说明安装成功：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif [ ! -e /usr/lib/libfastcommon.so ]; then ln -s /usr/lib64/libfastcommon.so /usr/lib/libfastcommon.so; fi\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e安装完毕之后，设置软连接：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eln -s /usr/lib64/libfastcommon.so /usr/local/lib/libfastcommon.so\nln -s /usr/lib64/libfastcommon.so /usr/lib/libfastcommon.so\nln -s /usr/lib64/libfdfsclient.so /usr/local/lib/libfdfsclient.so\nln -s /usr/lib64/libfdfsclient.so /usr/lib/libfdfsclient.so\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e4、安装 FastDFS\u003c/p\u003e\n\u003cp\u003e使用如下命令，在两台服务器上安装 fastdfs：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecd /usr/local/src/fastdfs/fastdfs-5.11\n./make.sh \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ./make.sh install\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e看到如下信息，则说明安装成功：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif [ ! -f /etc/fdfs/client.conf.sample ]; then cp -f ../conf/client.conf /etc/fdfs/client.conf.sample; fi\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e拷贝配置文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp /etc/fdfs/client.conf.sample /etc/fdfs/client.conf\ncp /etc/fdfs/storage.conf.sample /etc/fdfs/storage.conf\ncp /etc/fdfs/tracker.conf.sample /etc/fdfs/tracker.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、配置 tracker 服务器（172.20.15.73）\u003c/p\u003e\n\u003cp\u003e创建文件夹，用于存放 Tracker 服务器的相关文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /data/fastdfs/tracker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 tracker 的配置文件 \u003ccode\u003e/etc/fdfs/tracker.conf\u003c/code\u003e，修改如下部分：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edisabled=false\nport=22122\nbase_path=/data/fastdfs/tracker\nhttp.server_port=6666\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e拷贝 tracker 的 systemd 文件至 \u003ccode\u003e/usr/lib/systemd/system/\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp /usr/local/src/fastdfs/conf/systemd/fdfs_trackerd.service /usr/lib/systemd/system/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e因为 \u003ccode\u003efdfs_trackerd\u003c/code\u003e 等命令在 \u003ccode\u003e/usr/local/bin\u003c/code\u003e 中并没有，而是在 \u003ccode\u003e/usr/bin\u003c/code\u003e 路径下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eln -s /usr/bin/fdfs_trackerd /usr/local/bin\nln -s /usr/bin/stop.sh /usr/local/bin\nln -s /usr/bin/restart.sh /usr/local/bin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 systemd\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 tracker：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart fdfs_trackerd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e设置开机启动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl enable fdfs_trackerd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、配置 \u003ccode\u003estorage\u003c/code\u003e 服务器（172.20.15.75）\u003c/p\u003e\n\u003cp\u003e首先是创建 \u003ccode\u003estorage\u003c/code\u003e 服务器的文件目录，需要注意的是多建了一个目录，因为 \u003ccode\u003estorage\u003c/code\u003e 还需要一个文件存储路径，用于存放接收的文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /data/fastdfs/storage\nmkdir -p /data/fastdfs/storage_data\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 \u003ccode\u003estorage\u003c/code\u003e 的配置文件 \u003ccode\u003e/etc/fdfs/storage.conf\u003c/code\u003e，修改如下部分：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edisabled=false\ngroup_name=group1\nport=23000\nbase_path=/data/fastdfs/storage\nstore_path_count=1\nstore_path0=/data/fastdfs/storage_data\ntracker_server=172.20.15.73:22122\nhttp.server_port=8888\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e拷贝 \u003ccode\u003etracker\u003c/code\u003e 的 \u003ccode\u003esystemd\u003c/code\u003e 文件至 \u003ccode\u003e/usr/lib/systemd/system/\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp /usr/local/src/fastdfs/conf/systemd/fdfs_storaged.service /usr/lib/systemd/system/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e配置完成后同样要为 \u003ccode\u003estorage\u003c/code\u003e 服务器的启动脚本设置软引用：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eln -s /usr/bin/fdfs_storaged /usr/local/bin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 \u003ccode\u003esystemd\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 \u003ccode\u003etracker\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart fdfs_storaged\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e设置开机启动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl enable fdfs_storaged\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看 \u003ccode\u003estorage\u003c/code\u003e 服务器是否已经登记到 \u003ccode\u003etracker\u003c/code\u003e 服务器（也可以理解为 \u003ccode\u003etracker\u003c/code\u003e 与 \u003ccode\u003estorage\u003c/code\u003e 是否整合成功），运行以下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/usr/bin/fdfs_monitor /etc/fdfs/storage.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e看到 \u003ccode\u003etracker server is 172.20.15.73:22122\u003c/code\u003e，tracker 服务器正常启动。\u003c/p\u003e\n\u003cp\u003e看到 \u003ccode\u003e172.20.15.75 ACTIVE\u003c/code\u003e 字样即可说明 \u003ccode\u003estorage\u003c/code\u003e 服务器已经成功注册到了 \u003ccode\u003etracker\u003c/code\u003e 服务器。\u003c/p\u003e\n\u003ch3 id=\"安装并配置-nginx\"\u003e安装并配置 Nginx\u003c/h3\u003e\n\u003ch4 id=\"安装配置-tracker-的-nginx\"\u003e安装配置 tracker 的 nginx\u003c/h4\u003e\n\u003cp\u003e安装 \u003ccode\u003enginx\u003c/code\u003e 依赖包，并安装 \u003ccode\u003enginx\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -ivh --force /usr/local/src/fastdfs/nginx/nginx-lib/*\nrpm -ivh --force /usr/local/src/fastdfs/nginx/nginx-rpm/*\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将 \u003ccode\u003etracker\u003c/code\u003e 的 \u003ccode\u003enginx\u003c/code\u003e 的配置文件拷贝到 \u003ccode\u003e/etc/nginx\u003c/code\u003e，端口为 \u003ccode\u003e9988\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp -r /usr/local/src/fastdfs/conf/nginx-tracker.conf /etc/nginx/nginx.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将 \u003ccode\u003e/usr/local/src/fastdfs/fastdfs-5.11/conf\u003c/code\u003e 中的 \u003ccode\u003ehttp.conf\u003c/code\u003e 和 \u003ccode\u003emime.types\u003c/code\u003e 拷贝到 \u003ccode\u003e/etc/fdfs\u003c/code\u003e 目录下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp -r /usr/local/src/fastdfs/fastdfs-5.11/conf/http.conf /etc/fdfs/\ncp -r /usr/local/src/fastdfs/fastdfs-5.11/conf/mime.types /etc/fdfs/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建 \u003ccode\u003e/var/lib/nginx/tmp\u003c/code\u003e 以及日志文件夹：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /var/lib/nginx/tmp /data/log/nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e拷贝 \u003ccode\u003enginx\u003c/code\u003e 的 \u003ccode\u003esystemd\u003c/code\u003e 文件至 \u003ccode\u003e/usr/lib/systemd/system/\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp /usr/local/src/fastdfs/conf/systemd/nginx.service /usr/lib/systemd/system/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 \u003ccode\u003esystemd\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 \u003ccode\u003enginx\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl start nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e设置开机启动：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl enable nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"安装并配置-storage-的-nginx\"\u003e安装并配置 storage 的 nginx\u003c/h4\u003e\n\u003cp\u003e安装 \u003ccode\u003enginx\u003c/code\u003e 依赖包：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -ivh --force /usr/local/src/fastdfs/nginx/nginx-lib/*\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 \u003ccode\u003e/usr/local/src/fastdfs/nginx/fastdfs-nginx-module-1.20/src/config\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003engx_addon_name=ngx_http_fastdfs_module\n\nif test -n \u0026#34;${ngx_module_link}\u0026#34;; then\n    ngx_module_type=HTTP\n    ngx_module_name=$ngx_addon_name\n    ngx_module_incs=\u0026#34;/usr/include/fastdfs /usr/include/fastcommon/\u0026#34;\n    ngx_module_libs=\u0026#34;-lfastcommon -lfdfsclient\u0026#34;\n    ngx_module_srcs=\u0026#34;$ngx_addon_dir/ngx_http_fastdfs_module.c\u0026#34;\n    ngx_module_deps=\n    CFLAGS=\u0026#34;$CFLAGS -D_FILE_OFFSET_BITS=64 -DFDFS_OUTPUT_CHUNK_SIZE=\u0026#39;256*1024\u0026#39; -DFDFS_MOD_CONF_FILENAME=\u0026#39;\\\u0026#34;/etc/fdfs/mod_fastdfs.conf\\\u0026#34;\u0026#39;\u0026#34;\n    . auto/module\nelse\n    HTTP_MODULES=\u0026#34;$HTTP_MODULES ngx_http_fastdfs_module\u0026#34;\n    NGX_ADDON_SRCS=\u0026#34;$NGX_ADDON_SRCS $ngx_addon_dir/ngx_http_fastdfs_module.c\u0026#34;\n    CORE_INCS=\u0026#34;$CORE_INCS /usr/include/fastdfs /usr/include/fastcommon/\u0026#34;\n    CORE_LIBS=\u0026#34;$CORE_LIBS -L/usr/lib -lfastcommon -lfdfsclient\u0026#34;\n    CFLAGS=\u0026#34;$CFLAGS -D_FILE_OFFSET_BITS=64 -DFDFS_OUTPUT_CHUNK_SIZE=\u0026#39;256*1024\u0026#39; -DFDFS_MOD_CONF_FILENAME=\u0026#39;\\\u0026#34;/etc/fdfs/mod_fastdfs.conf\\\u0026#34;\u0026#39;\u0026#34;\nfi\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e增加依赖包并安装 \u003ccode\u003enginx\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecd /usr/local/src/fastdfs/nginx/nginx-1.12.2\n\n./configure --prefix=/usr/share/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib64/nginx/modules --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --user=root --add-module=/usr/local/src/fastdfs/nginx/fastdfs-nginx-module-1.20/src\n\nmake \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make install\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将 \u003ccode\u003enginx\u003c/code\u003e 的配置文件拷贝到 \u003ccode\u003e/etc/nginx\u003c/code\u003e，端口为 \u003ccode\u003e9999\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp -r /usr/local/src/fastdfs/conf/nginx-storage.conf /etc/nginx/nginx.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将 \u003ccode\u003e/usr/local/src/fastdfs/fastdfs-5.11/conf\u003c/code\u003e 中的 \u003ccode\u003ehttp.conf\u003c/code\u003e 和 \u003ccode\u003emime.types\u003c/code\u003e 拷贝到 \u003ccode\u003e/etc/fdfs\u003c/code\u003e 目录下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp -r /usr/local/src/fastdfs/fastdfs-5.11/conf/http.conf /etc/fdfs/\ncp -r /usr/local/src/fastdfs/fastdfs-5.11/conf/mime.types /etc/fdfs/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e把 \u003ccode\u003e/usr/local/src/fastdfs/nginx/fastdfs-nginx-module-1.20/src\u003c/code\u003e 安装目录下的 \u003ccode\u003emod_fastdfs.conf\u003c/code\u003e 也拷贝到 /etc/fdfs` 目录下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp -r /usr/local/src/fastdfs/nginx/fastdfs-nginx-module-1.20/src/mod_fastdfs.conf /etc/fdfs/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 \u003ccode\u003e/etc/fdfs/mod_fastdfs.conf\u003c/code\u003e 下面的部分：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebase_path=/data/fastdfs/storage\ntracker_server=172.20.15.73:22122\nstorage_server_port=23000\nurl_have_group_name = true\nstore_path0=/data/fastdfs/storage_data\ngroup_count = 3\n\n[group1]\ngroup_name=group1\nstorage_server_port=23000\nstore_path_count=1\nstore_path0=/data/fastdfs/storage_data\n\n[group2]\ngroup_name=group2\nstorage_server_port=23000\nstore_path_count=1\nstore_path0=/data/fastdfs/storage_data\n\n[group3]\ngroup_name=group3\nstorage_server_port=23000\nstore_path_count=1\nstore_path0=/data/fastdfs/storage_data\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e建立 \u003ccode\u003eM00\u003c/code\u003e 至存储目录的符号连接：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eln -s /data/fastdfs/storage_data/data /data/fastdfs/storage_data/data/M00\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建 \u003ccode\u003e/var/lib/nginx/tmp\u003c/code\u003e 以及日志文件夹：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /var/lib/nginx/tmp /data/log/nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e拷贝 nginx 的 systemd 文件至 \u003ccode\u003e/usr/lib/systemd/system/\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp /usr/local/src/fastdfs/conf/systemd/nginx.service /usr/lib/systemd/system/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 systemd：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 nginx：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl start nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e设置开机启动：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl enable nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"以-172201523-作为-client-进行测试\"\u003e以 172.20.15.23 作为 client 进行测试\u003c/h4\u003e\n\u003cp\u003e创建 \u003ccode\u003e/data/fastdfs/client\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /data/fastdfs/client\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 \u003ccode\u003e/etc/fdfs/client.conf\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebase_path=/data/fastdfs/client\ntracker_server=172.20.15.73:22122\nhttp.tracker_server_port=6666\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e上传文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/usr/bin/fdfs_test /etc/fdfs/client.conf upload /usr/local/src/fastdfs/test/test.jpeg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e得到如下结果，说明上传成功：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eThis is FastDFS client test program v5.11\n\nCopyright (C) 2008, Happy Fish / YuQing\n\nFastDFS may be copied only under the terms of the GNU General\nPublic License V3, which may be found in the FastDFS source kit.\nPlease visit the FastDFS Home Page http://www.csource.org/\nfor more detail.\n\n[2018-09-06 20:30:37] DEBUG - base_path=/data/fastdfs/client, connect_timeout=30, network_timeout=60, tracker_server_count=1, anti_steal_token=0, anti_steal_secret_key length=0, use_connection_pool=0, g_connection_pool_max_idle_time=3600s, use_storage_id=0, storage server id count: 0\n\ntracker_query_storage_store_list_without_group:\n\tserver 1. group_name=, ip_addr=172.20.15.75, port=23000\n\ngroup_name=group1, ip_addr=172.20.15.75, port=23000\nstorage_upload_by_filename\ngroup_name=group1, remote_filename=M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15.jpeg\nsource ip address: 172.20.15.75\nfile timestamp=2018-09-06 20:30:37\nfile size=46193\nfile crc32=3080419236\nexample file url: http://172.20.15.75:6666/group1/M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15.jpeg\nstorage_upload_slave_by_filename\ngroup_name=group1, remote_filename=M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15_big.jpeg\nsource ip address: 172.20.15.75\nfile timestamp=2018-09-06 20:30:37\nfile size=46193\nfile crc32=3080419236\nexample file url: http://172.20.15.75:6666/group1/M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15_big.jpeg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e根据 \u003ccode\u003e/group1/M00/00/00/rBQPS1uP4OOAGfVuAAC0cbebd6Q04_big.jpeg\u003c/code\u003e，在浏览器上查看已经上传的图片：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.15.73:9988/group1/M00/00/00/rBQPS1uRHe2AKqfAAAC0cbebd6Q15_big.jpeg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/wlwlwlwl015/article/details/52619851\"\u003ehttps://blog.csdn.net/wlwlwlwl015/article/details/52619851\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/jeikerxiao/article/details/79861850\"\u003ehttps://blog.csdn.net/jeikerxiao/article/details/79861850\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://my.oschina.net/wangmengjun/blog/1142982\"\u003ehttps://my.oschina.net/wangmengjun/blog/1142982\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/e55702bdb2fe\"\u003ehttps://www.jianshu.com/p/e55702bdb2fe\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://naturalwill.github.io/2017/09/25/add-rtmp-module-to-nginx-by-yum/\"\u003ehttps://naturalwill.github.io/2017/09/25/add-rtmp-module-to-nginx-by-yum/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://anyof.me/articles/236\"\u003ehttps://anyof.me/articles/236\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://blog.51cto.com/wangfeng7399/1711589\"\u003ehttp://blog.51cto.com/wangfeng7399/1711589\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/00a5961e0bca\"\u003ehttps://www.jianshu.com/p/00a5961e0bca\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/xuchaovip/article/details/60480557\"\u003ehttps://blog.csdn.net/xuchaovip/article/details/60480557\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/name_is_wl/article/details/52979208\"\u003ehttps://blog.csdn.net/name_is_wl/article/details/52979208\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.ityouknow.com/fastdfs/2017/10/10/cluster-building-fastdfs.html\"\u003ehttp://www.ityouknow.com/fastdfs/2017/10/10/cluster-building-fastdfs.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.jianshu.com/p/a88c76caf317\"\u003ehttps://www.jianshu.com/p/a88c76caf317\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/tangwan/p/5425153.html\"\u003ehttps://www.cnblogs.com/tangwan/p/5425153.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.ityouknow.com/fastdfs/2017/10/10/cluster-building-fastdfs.html\"\u003ehttp://www.ityouknow.com/fastdfs/2017/10/10/cluster-building-fastdfs.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/xyang81/article/details/52928230\"\u003ehttps://blog.csdn.net/xyang81/article/details/52928230\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/u012453843/article/details/68957209\"\u003ehttps://blog.csdn.net/u012453843/article/details/68957209\u003c/a\u003e\u003c/p\u003e","date":1537401600,"description":"","fuzzywordcount":1900,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"4cb9b9a7c441f6abd12a7f16773e6baa","publishdate":1537401600,"relpermalink":"/posts/storage/fastdfs/fastdfs-deployment-and-nginx/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了 FastDFS 的安装和其配合 Nginx 使用的步骤。\u003c/p\u003e","tags":["FastDFS","Nginx","数据库"],"title":"FastDFS 安装和 Nginx 代理的使用","url":"https://xdhuxc.github.io/posts/storage/fastdfs/fastdfs-deployment-and-nginx/","wordcount":1864},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了基于 docker 容器方式和原生方式部署 MySQL 的配置和方式。\u003c/p\u003e\n\u003ch3 id=\"启动-mysql-容器\"\u003e启动 MySQL 容器\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --restart=always \\\n    --privileged=true \\\n    -p 3306:3306 \\\n    -e MYSQL_ROOT_PASSWORD=Xdhuxc123 \\\n    -v /data/mysql_data:/var/lib/mysql \\\n    -v /data/disc/script/sql:/docker-entrypoint-initdb.d \\\n    --name mysql \\\n    mysql:5.7.21\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e该启动命令包括初始化 \u003ccode\u003eroot\u003c/code\u003e 用户、初始化数据库（将待导入的 \u003ccode\u003esql\u003c/code\u003e 文件放入 \u003ccode\u003e/data/disc/script/sql\u003c/code\u003e 目录下）和持久化数据目录。\u003c/p\u003e\n\u003ch3 id=\"使用本地配置文件启动-mysql-容器\"\u003e使用本地配置文件启动 MySQL 容器\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --net host \\\n    -v /mysql/conf:/etc/mysql/conf.d \\\n    -v /mysql/data:/var/lib/mysql \\\n    -e MYSQL_ROOT_PASSWORD=123456 \\\n    --name mysql \\\n    mysql:latest\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e/mysql/conf\u003c/code\u003e：本地主机 \u003ccode\u003eMySQL\u003c/code\u003e 配置文件 \u003ccode\u003emy.cnf\u003c/code\u003e 存放路径，该路径下存放 \u003ccode\u003eMySQL\u003c/code\u003e 的配置文件 \u003ccode\u003emy.cnf\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eMYSQL_ROOT_PASSWORD\u003c/code\u003e：容器中 \u003ccode\u003eMySQL\u003c/code\u003e 数据库的 \u003ccode\u003eroot\u003c/code\u003e 用户密码\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/mysql/data\u003c/code\u003e：本地主机上存放 \u003ccode\u003eMySQL\u003c/code\u003e 数据文件的目录\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"mysql-容器启动时初始化数据库\"\u003emysql 容器启动时初始化数据库\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003esql文件存放的目录，只能有一个sql文件，必须内含创建数据库和选择数据库命令\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -p 3306:3306 \\\n    -e MYSQL_ROOT_PASSWORD=123456 \\\n    -v /home/xdhuxc/mysql/config:/etc/mysql/conf.d \\\n    -v /home/xdhuxc/mysql/data:/var/lib/mysql \\\n    -v /home/xdhuxc/mysql/sql:/docker-entrypoint-initdb.d \\\n    --name mysql \\\n    mysql:5.7.21\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看 MySQL 官方镜像的 \u003ca href=\"https://github.com/docker-library/mysql/blob/883703dfb30d9c197e0059a669c4bb64d55f6e0d/5.7/Dockerfile\"\u003edockerFile\u003c/a\u003e ，在容器启动时，会执行脚本 \u003ccode\u003edocker-entrypoint.sh\u003c/code\u003e，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCOPY docker-entrypoint.sh /usr/local/bin/\nRUN ln -s usr/local/bin/docker-entrypoint.sh /entrypoint.sh # backwards compat\nENTRYPOINT [\u0026#34;docker-entrypoint.sh\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e而在该脚本中，会遍历 \u003ccode\u003e/docker-entrypoint-initdb.d\u003c/code\u003e 目录下所有的 \u003ccode\u003e.sh\u003c/code\u003e 和 \u003ccode\u003e.sql\u003c/code\u003e 后缀的文件，然后执行。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho\nfor f in /docker-entrypoint-initdb.d/*; do\n\tcase \u0026#34;$f\u0026#34; in\n\t\t*.sh)     echo \u0026#34;$0: running $f\u0026#34;; . \u0026#34;$f\u0026#34; ;;\n\t\t*.sql)    echo \u0026#34;$0: running $f\u0026#34;; \u0026#34;${mysql[@]}\u0026#34; \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e \u0026#34;$f\u0026#34;; echo ;; # mysql=( mysql --protocol=socket -uroot -hlocalhost --socket=\u0026#34;${SOCKET}\u0026#34; )\n\t\t*.sql.gz) echo \u0026#34;$0: running $f\u0026#34;; gunzip -c \u0026#34;$f\u0026#34; | \u0026#34;${mysql[@]}\u0026#34;; echo ;;\n\t\t*)        echo \u0026#34;$0: ignoring $f\u0026#34; ;;\n\tesac\n\techo\ndone\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"在-centos-下安装-mysql\"\u003e在 CentOS 下安装 mysql\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCentOS Linux release 7.3.1611 (Core)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、下载 \u003ccode\u003emysql57-community-release-el7-10.noarch.rpm\u003c/code\u003e 到本地虚拟机，下载地址为：\n\u003ca href=\"http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql57-community-release-el7-10.noarch.rpm\"\u003ehttp://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql57-community-release-el7-10.noarch.rpm\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget http://repo.mysql.com/yum/mysql-5.7-community/el/7/x86_64/mysql57-community-release-el7-10.noarch.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、安装 \u003ccode\u003emysql57-community-release-el7-10.noarch.rpm\u003c/code\u003e，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -ivh mysql57-community-release-el7-10.noarch.rpm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e安装后，会在 \u003ccode\u003e/etc/yum.repos.d\u003c/code\u003e 目录下生成 \u003ccode\u003emysql-community.repo\u003c/code\u003e，\u003ccode\u003emysql-community-source.repo\u003c/code\u003e两个yum仓库配置文件。\u003c/p\u003e\n\u003cp\u003e3、安装 \u003ccode\u003eMySQL Community\u003c/code\u003e，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y mysql-community-server.x86_64\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e安装过程中，会自动安装 \u003ccode\u003emysql-community-server\u003c/code\u003e，\u003ccode\u003emysql-community-client\u003c/code\u003e，\u003ccode\u003emysql-community-common\u003c/code\u003e，\u003ccode\u003emysql-community-libs\u003c/code\u003e，\u003ccode\u003enet-tools\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e4、启动并查看 MySQL 服务\u003c/p\u003e\n\u003cp\u003e启动MySQL服务，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo service mysqld start\n或\nsudo systemctl start mysqld.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看MySQL服务，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo service mysqld status\n或\nsudo systemctl status mysqld.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、查看 MySQL root 用户的初始密码\u003c/p\u003e\n\u003cp\u003e使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo grep \u0026#39;temporary password\u0026#39; /var/log/mysqld.log\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、使用MySQL自动生成的密码登录MySQL客户端，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql -uroot -pyiw,x4po6EsO\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下命令更改密码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ealter user \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; identified by \u0026#39;286X326_h\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysqli_real_connect(): (HY000/1130): Host \u0026#39;172.17.0.2\u0026#39; is not allowed to connect to this MySQL server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、给远程连接的机器授权\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eGRANT ALL PRIVILEGES ON \\*.\\* TO \u0026#39;root\u0026#39;@\u0026#39;192.168.1.8\u0026#39; IDENTIFIED BY \u0026#39;www.linuxidc.com\u0026#39; WITH GRANT OPTION;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"设置简单密码\"\u003e设置简单密码\u003c/h4\u003e\n\u003cp\u003e在 \u003ccode\u003eLinux\u003c/code\u003e 下，安装完 \u003ccode\u003eMySQL\u003c/code\u003e 并启动后，首先使用临时 \u003ccode\u003eroot\u003c/code\u003e 用户密码登录进去；\u003c/p\u003e\n\u003cp\u003e接着，使用 \u003ccode\u003ealter\u003c/code\u003e 语句修改 \u003ccode\u003eroot\u003c/code\u003e 用户密码；\u003c/p\u003e\n\u003cp\u003e然后，查看 \u003ccode\u003evalidate_password_policy\u003c/code\u003e 的值。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003evalidate_password_policy\u003c/code\u003e 有以下取值：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003ePolicy\u003c/th\u003e\n\u003cth\u003eTests Performed\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e0 or LOW\u003c/td\u003e\n\u003ctd\u003eLength\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1 or MEDIUM\u003c/td\u003e\n\u003ctd\u003eLength; numeric, lowercase/uppercase, and special characters\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2 or STRONG\u003c/td\u003e\n\u003ctd\u003eLength; numeric, lowercase/uppercase, and special characters; dictionary file\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e默认是 \u003ccode\u003e1\u003c/code\u003e，即 \u003ccode\u003eMEDIUM\u003c/code\u003e，所以刚开始设置的密码必须符合长度，且必须含有数字，小写或大写字母，特殊字符。\u003c/p\u003e\n\u003cp\u003e为了设置简单的密码，需要修改两个全局参数：\u003c/p\u003e\n\u003cp\u003e1、修改 \u003ccode\u003evalidate_password_policy\u003c/code\u003e 参数的值，设置为 \u003ccode\u003e0\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e2、修改 \u003ccode\u003evalidate_password_length=1\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e3、刷新权限\u003c/p\u003e","date":1537315200,"description":"","fuzzywordcount":1200,"kind":"page","lang":"zh","lastmod":1540166400,"objectID":"0e07111a936a00f56c24e063f25279f9","publishdate":1537315200,"relpermalink":"/posts/storage/mysql/mysql-docker-and-original-deployment/","section":"posts","summary":"\u003cp\u003e本篇博客记录了基于 docker 容器方式和原生方式部署 MySQL 的配置和方式。\u003c/p\u003e","tags":["MySQL","Docker"],"title":"基于 docker 和原生方式部署 MySQL","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-docker-and-original-deployment/","wordcount":1180},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 MySQL 配置文件中各个参数的含义，留作后查。\u003c/p\u003e\n\u003cp\u003eLinux系统下，配置文件位于：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/etc/my.cnf 或 /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e配置文件内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e  1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 89\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 90\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 91\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 92\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 93\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 94\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 95\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 96\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 97\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 98\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 99\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e100\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e101\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e102\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e103\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e104\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e105\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e106\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e107\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e108\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e109\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e110\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e111\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e112\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e113\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e114\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e115\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e116\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e117\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e118\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e119\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e120\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e121\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e122\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e123\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e124\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e125\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e126\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e127\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e128\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e129\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e130\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e131\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e132\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e133\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e134\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e135\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e136\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e137\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e138\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e139\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e140\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e141\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e142\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e143\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e144\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e145\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e146\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e147\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e148\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e149\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e150\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e151\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e152\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e153\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e154\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e155\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e156\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e157\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e158\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e159\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e160\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e161\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e162\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e163\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e164\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e165\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e166\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e167\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e168\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e169\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e170\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e171\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e172\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e173\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e174\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e175\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e176\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e177\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e178\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e179\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e180\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e181\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e182\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e183\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e184\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e185\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e186\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e187\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e188\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e189\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e190\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e191\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e192\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e193\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e194\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e195\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e196\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e197\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e198\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e199\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e200\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e201\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e202\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e203\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e204\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e205\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e206\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e207\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e208\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e209\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e210\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e211\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e212\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e213\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e214\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e215\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e216\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e217\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e218\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e219\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e220\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e221\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e222\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e223\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e224\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e225\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e226\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e227\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e228\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e229\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e230\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e231\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e232\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e233\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e234\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e235\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e236\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e237\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e238\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e239\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e240\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e241\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e242\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e243\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e244\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e245\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e246\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e247\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e248\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e249\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e250\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e251\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e252\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e253\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e254\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e255\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e256\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e257\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e258\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[client]\n\n\u003cspan class=\"gh\"\u003e# 设置 mysql 客户端连接服务端时默认使用的端口。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eport = 3306\nsocket = /usr/local/mysql/mysql.sock \n\u003cspan class=\"gh\"\u003e# 设置 mysql 客户端默认字符集。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edefault-character-set = utf8\n\n[mysql]\nno-auto-rehash\n\n[mysqld]\n\n\u003cspan class=\"gh\"\u003e# 设置 mysqld 服务端默认监听的 TCP/IP 端口。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eport = 3306\n\n\u003cspan class=\"gh\"\u003e# 设置 mysql 服务器默认字符集。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edefault-character-set = utf8\n\n\u003cspan class=\"gh\"\u003e# mysql 的时区默认是服务器的时区，设置 mysql 时区为东八区\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edefault-time_zone = \u0026#39;+8:00\u0026#39;\n\n\u003cspan class=\"gh\"\u003e# 基准路径，其他路径都相对于这个路径。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ebasedir = /usr/local/mysql \n\n\u003cspan class=\"gh\"\u003e# mysql 数据库文件所在目录。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edatadir = /data/\n\nlog_bin = mysql-bin \nbinlog_format = mixed\n\u003cspan class=\"gh\"\u003e# 超过 30 天的 binlog 自动删除。 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eexpire_logs_days = 30 \n\u003cspan class=\"gh\"\u003e# 错误日志路径\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003elog_error = /logs/mysql-error.log\n\nslow_query_log = 1\n\u003cspan class=\"gh\"\u003e# 慢查询时间，超过 1秒 则为慢查询。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003elong_query_time = 1 \n\u003cspan class=\"gh\"\u003e# 慢查询日志\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eslow_query_log_file = /logs/mysql-slow.log \n\nperformance_schema = 0\nexplicit_defaults_for_timestamp\n\n\u003cspan class=\"gh\"\u003e# 不区分大小写\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# lower_case_table_names = 1\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 创建新表时使用的默认存储引擎。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edefault-storage-engine = INNODB\n\n\u003cspan class=\"gh\"\u003e# mysql 服务器支持的最大并发连接数，默认值为：150，但总会预留其中一个连接给管理员使用 super 权限登录，即使连接数目达到最大限制。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果服务器的并发连接请求量比较大，建议提高该值，以增加并发连接数量。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 当然这是建立在机器资源能够支撑的情况下，mysql 会为每个连接提供连接缓冲区，那么连接数越多，内存开销就会越大，因此要适当调整该值。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emax_connections = 500\n\n\u003cspan class=\"gh\"\u003e# 对于同一主机，如果有超出该值个数的中断错误连接，则该主机将被禁止连接。如需对该主机进行解禁，需要执行 flush host 命令。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emax_connect_errors = 6000\n\n\u003cspan class=\"gh\"\u003e# 服务器关闭交互式连接前等待活动的秒数。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 交互式客户端定义为在 mysql_real_connect() 中使用 CLIENT_INTERACTIVE 选项的客户端，默认值为：28800秒，即8小时。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einteractive_timeout = 28800\n\n\u003cspan class=\"gh\"\u003e# 服务器关闭非交互式连接之前等待活动的秒数。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 在线程启动时，根据全局 wait_timeout 的值或全局 interactive_timeout 的值初始化 wait_timeout 的值。 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 取决于客户端类型，由 mysql_real_connect() 的连接选项 CLIENT_INTERACTIVE 定义，参数的默认值为：28800。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# mysql 服务器所支持的最大连接数是有上限的，因为每个连接的建立都会消耗内存，因此，我们希望客户端在连接到 mysql 服务器处理完相应的操作后，应该断开连接并释放占用的内存。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果 mysql 服务器有大量的闲置连接，它们不仅会白白消耗内存，而且如果连接一直在累加而不断开，最终肯定会达到 mysql 服务器的连接上限数，这会报“too many connections” 错误。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 对于 wait_timeout 的值的设定，应该根据系统的运行情况来判断。在系统运行一段时间后，可以通过 show processlist 命令查看当前系统的连接状态。 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果发现有大量的 sleep 状态的连接进程，则说明该参数设置得过大，可以适当地调小些，要同时设置 interactive_timeout 和 wait_timeout 才会生效。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ewait_timeout = 28800\n\n\u003cspan class=\"gh\"\u003e# mysql 能够打开的文件描述符限制，默认最小为：1024。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 当 open_files_limit 没有被设置的时候，比较 max_connections*5 和 ulimit -n 的值，哪个大用那个。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 当 open_files_limit 被配置的时候，比较 open_files_limit 和 max_connections*5 的值，哪个大用那个。 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eopen_files_limit = 65535\n\n\u003cspan class=\"gh\"\u003e# 指定 mysql 查询缓冲区的大小，可以通过在 mysql 控制台观察。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 使用查询缓冲， mysql 将 select 语句和查询结果存放在缓冲区中，今后对于同样的 select 语句（区分大小写），将直接从缓冲区中读取结果。根据 MySQL 用户手册，使用查询缓冲最多可以提高 238% 的效率。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果 Qcache_lowmem_prunes 的值非常大，则表明经常出现缓冲不够的情况；\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果 Qcache_hits 的值非常大，则表明查询缓冲使用非常频繁；如果该值较小反而会影响效率，那么可以考虑不用查询缓冲。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果 Qcache_free_blocks 的值非常大，则表明缓冲区中碎片很多。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 此外，在 select 语句中加入 SQL_NO_CACHE 可以明确表示不使用查询缓冲。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003equery_cache_size = 50M\n\n\u003cspan class=\"gh\"\u003e# 指定单个查询能够使用的缓冲区大小，默认为：1M。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003equery_cache_limit = 2M\n\n\u003cspan class=\"gh\"\u003e# 用于设置 table 高速缓存的数量。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 由于每个客户端连接都会至少访问一个表，因此此参数的值与 max_connections 有关。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 当某一连接访问一个表时，mysql 会检查当前已缓存的表的数量。如果该表已经在缓存中打开，则会直接访问缓存中的表以加快查询速度；如果该表未被缓存，则会将当前的表添加进缓存并进行查询。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 在执行缓存操作之前，table_cache 用于限制缓存表的最大数目，如果当前已经缓存的表未达到 table_cache 所设定的值，则会将新表添加进来；若已经达到此值，mysql 将根据缓存表的最后查询时间、查询率等规则释放之前的缓存。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003etable_open_cache = 512\n\n\u003cspan class=\"gh\"\u003e# 内存中的每个临时表允许的最大大小。如果临时表大小超过该值，临时表将自动转为基于磁盘的表。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e# \ntmp_table_size = 64M\n\n\u003cspan class=\"gh\"\u003e# 缓存的最大线程数，表示可以重新利用保存在缓存中的线程的数量。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 当客户端连接断开时，如果客户端总连接数小于该值，即缓存中还有空间，则处理客户端任务的线程放回缓存。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果线程被重新请求，那么请求将从缓存中读取；如果缓存中是空的或者是新的请求，那么这个线程将被重新创建。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 在高并发情况下，如果该值设置得太小，就会有很多线程频繁创建，线程创建的开销会变大，查询效率也会下降。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 一般来说，如果在应用程序中有良好的多线程处理，这个参数对性能不会有太大的提高。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 根据物理内存设置规则如下：\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 1G -\u0026gt; 8\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 2G -\u0026gt; 16\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 3G -\u0026gt; 32\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 大于 3G -\u0026gt; 64\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ethread_cache_size = 8\n\n\u003cspan class=\"gh\"\u003e# 避免 mysql 的外部锁定，减少出错几率，增强稳定性，该选项默认开启。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eskip-external-locking\n\n\u003cspan class=\"gh\"\u003e# 禁止 mysql 对外部连接进行 DNS 解析，使用这一选项可以消除 mysql 进行 DNS 解析的时间。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 但是需要注意，如果开启该选项，则所有远程主机连接授权都要使用 IP 地址方式，否则 mysql 将无法正常处理连接请求。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eskip-name-resolve\n\n\u003cspan class=\"gh\"\u003e# 指定在 mysql 暂时停止响应新请求之前的短时间内多少个请求可以被存放到堆栈中。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果系统在一个短时间内有很多连接，则需要增大该参数的值，该值指定到来的的TCP/IP连接的监听队列的大小。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 不同的操作系统在这个队列大小上有它自己的限制，试图设置 back_log 的值高于操作系统的限制将是无效的，\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 默认值为：80，对于 Linux 系统，推荐设置为小于 512 的整数。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eback_log = 150\n\n\u003cspan class=\"gh\"\u003e# 接收的数据包大小，增加该变量的值十分安全，这是因为仅当需要时才会分配额外的内存。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 例如，仅当发出长查询或 mysqld 必须返回大的结果集时 mysqld 才会分配更多内存。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 该变量之所以取较小的默认值是一种预防措施，以捕获客户端和服务器之间的错误信息包，并确保不会因偶然使用大的信息包而导致内存溢出。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emax_allowed_packet = 32M\n\n\u003cspan class=\"gh\"\u003e# 一个事务在没有提交的时候产生的日志会记录到 cache 中，等到事务需要提交的时候，则把日志持久化到磁盘。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# binlog_cache_size 的默认大小为：32K。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ebinlog_cache_size = 1M\n\n\u003cspan class=\"gh\"\u003e# 定义了用户可以创建的内存表的大小。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 该值用来计算内存表的最大行数值，支持动态改变。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emax_heap_table_size = 8M\n\n\u003cspan class=\"gh\"\u003e# mysql 读入缓冲区大小。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 对表进行顺序扫描的请求将分配一个读入缓冲区，mysql 会为它分配一段内存缓冲区，此变量控制这一缓冲区的大小。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果对表的顺序扫描请求非常频繁，并且频繁扫描进行得太慢，可以通过增加此变量的值及内存缓冲区的大小提高其性能。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eread_buffer_size = 2M\n\n\u003cspan class=\"gh\"\u003e# mysql 随机读缓冲区大小。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 当按任意顺序读取行时（例如，按照排序顺序），mysql 将分配一个随机读缓冲区。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 在进行排序查询时，mysql 会首先扫描一遍该缓冲区，以避免在磁盘上搜索，提高查询速度。如果需要排序大量数据，可适当调高此值。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 当 mysql 会为每个客户端连接分配该缓冲空间，所以应尽量适当设置该值，以避免内存开销过大。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eread_rnd_buffer_size = 8M\n\n\u003cspan class=\"gh\"\u003e# mysql 执行排序时使用的缓冲区大小。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果想要增加 order by 的速度，首先看是否可以让 mysql 使用索引而不是额外的排序阶段，如果不能，可以尝试增加 sort_buffer_size 值的大小。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esort_buffer_size = 8M\n\n\u003cspan class=\"gh\"\u003e# 联合查询操作所能使用的缓冲区大小。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 和 sort_buffer_size 一样，此参数分配的内存也是每个连接独享的，即连接级参数。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ejoin_buffer_size = 8M\n\n\u003cspan class=\"gh\"\u003e# 指定用于索引的缓冲区大小，增加它可得到更好处理的索引（对所有读和多重写），直到机器所能负担得起。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 如果此参数值太大，系统将开始换页，并变慢。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 对于内存在 4GB 左右的服务器，该参数可以设置为：384M 或 512M。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 通过检查状态值 key_read_request 和 key_reads，可以知道 key_buffer_size 设置是否合理。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 比例 key_reads / key_read_requests 应该尽可能的低，至少是 1:100，1:1000 更好，上述状态值可以使用 show status like \u0026#39;key_read%\u0026#39; 获得。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 注意，该参数值设置得过大反而会使服务器整体效率降低。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ekey_buffer_size = 4M\n\n\u003cspan class=\"gh\"\u003e# 分词词汇的最小长度，默认为：4。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eft_min_word_len = 4\n\n\u003cspan class=\"gh\"\u003e# mysql 支持四种事物隔离级别，分别是：READ-UNCOMMITTED，READ-COMMITTED，REPEATABLE-READ，SERIALIZABLE，如果没有指定，mysql 默认采用的是：REPEATABLE-READ。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# oracle 默认的事物隔离级别是：READ-COMMITTED。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003etransaction_isolation = REPEATABLE-READ \n\n\u003cspan class=\"gh\"\u003e# innodb 引擎配置\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\ninnodb_file_per_table = 1\n\n\u003cspan class=\"gh\"\u003e# 限制 InnoDB 同时能打开的表数据文件的最大值，如果数据库中的表特别多，需要增大此参数的值。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 此参数的值默认为：300，最小值为：10。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_open_files = 500\n\n\u003cspan class=\"gh\"\u003e# InnoDB 使用一个缓冲池来保存索引和原始数据，此处设置的值越大，在存取表里面数据时所需要的磁盘 I/O 越少。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 在一个独立使用的数据库服务器上，可以设置这个变量到服务器物理内存大小的 80%。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 不要设置过大，否则由于物理内存的竞争，可能会导致操作系统的换页颠簸。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 注意，在 32 位系统上，每个进程可能被限制在 2~3.5G 用户层面内存限制，因此，不要设置得太高。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_buffer_pool_size = 64M\n\n\u003cspan class=\"gh\"\u003e# innodb 使用后台线程处理数据页上的读写 I/O 请求，根据机器的 CPU 核数来修改，默认为：4。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 注意，这两个参数不支持动态改变，需要将该参数写入 my.cnf 文件中，修改完成后重启 mysql 服务，允许值的范围为：1~64。 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_write_io_threads = 4\ninnodb_read_io_threads = 4\n\n\u003cspan class=\"gh\"\u003e# 默认设置为：0，表示不限制并发数，也推荐设置为：0，更好地发挥多核 CPU 的处理能力，提高并发量。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_thread_concurrency = 0\n\n\u003cspan class=\"gh\"\u003e# InnoDB 中的清除操作是一类定期回收无用数据的操作。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 在之前的几个版本中，清除操作是主线程的一部分，这意味着运行时它可能会堵塞其他的数据库操作。 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 从 mysql 5.5.X 版本开始，该操作运行于独立的线程中，并支持更多的并发数。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 用户可通过设置 innodb_purge_threads 参数来选择清除操作是否使用单独线程。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 默认情况下，参数设置为：0，表示不使用单独线程；设置为：1 时，表示使用单独的清除线程，建议设置为：1.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_purge_threads = 1\n\n\u003cspan class=\"gh\"\u003e# 0：如果 innodb_flush_log_at_trx_commit 的值为 0，日志缓冲区就会每秒刷写日志文件到磁盘，提交事务的时候不做任何操作。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 执行是由 mysql 的 master thread 线程来执行的，主线程中每秒会将重做日志缓冲写入磁盘的重做日志文件中，不论事务是否已经提交，默认的日志文件是：ib_logfile0，ib_logfile1。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 1：当设置为默认值 1 的时候，每次提交事务的时候，都会将日志缓冲区刷写到日志。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 2：如果 innodb_flush_log_at_trx_commit 的值为 2，每次提交事务都会写日志，但并不会执行刷的操作，每秒定时会刷到日志文件。要注意的是，并不能保证 100% 每秒一定都会刷到磁盘，这要取决于进程的调度。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 每次事务提交的时候将数据写入事务日志，而这里的写入仅是调用了文件系统的写入操作，文件系统是有缓存的，所以这个写入并不能保证数据已经写入到物理磁盘。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 默认值 1 是为了保证完整的 ACID，当然，可以将这个配置项设为 1 以外的值来换取更高的性能，但是在系统崩溃的时候，将会失去 1 秒的数据。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 设为 0 的话，mysqld 进程崩溃的时候，会丢失最后 1 秒的事务。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 设为 2 的话，只有在操作系统崩溃或者断电的时候才会丢失最后 1 秒的数据，InnoDB在做恢复的时候会忽略这个值。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 结论：设为 1 当然是最安全的，但性能页是最差的，相对于其他两个而言，但不是不能接受。如果对数据一致性和完整性要求不高，完全可以设置为：2。如果只追求性能，例如高并发写的日志服务器，设为 0 来获得更高性能。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_flush_log_at_trx_commit = 1\n\n\u003cspan class=\"gh\"\u003e# 设置日志缓冲区的大小，以 M 为单位，缓冲区更大能提高性能，但意外的故障将会丢失数据。MySQL 开发人员建议设置为：1M~8M 之间。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_log_buffer_size = 2M\n\n\u003cspan class=\"gh\"\u003e# 设置数据日志文件的大小，更大的值可以提高性能，但也会增加恢复故障数据库所需的时间。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_log_file_size = 32M\n\n\u003cspan class=\"gh\"\u003e# 为提高性能，mysql 可以以循环方式将日志文件写到多个文件，推荐设置为：3。 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_log_files_in_group = 3\n\n\u003cspan class=\"gh\"\u003e# InnoDB 主线程刷新缓存池中的数据，使脏数据比例小于 90%。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_max_dirty_pages_pct = 90\n\n\u003cspan class=\"gh\"\u003e# InnoDB 事务在被回滚之前可以等待一个锁定的超时秒数，默认值为：50秒。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# InnoDB 在它自己的锁定表中自动检测事务死锁并且回滚事务。InnoDB 用 LOCK TABLES 语句锁定表，\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003einnodb_lock_wait_timeout = 120\n\n\u003cspan class=\"gh\"\u003e# MyISAM 引擎配置 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 批量插入缓存大小，该参数是针对 MyISAM 存储引擎来说的，适用于在一次性插入100~1000+条记录时，提高效率。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 默认值为：8M，可以针对数据量的大小，翻倍增加。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ebulk_insert_buffer_size = 8M\n\n\u003cspan class=\"gh\"\u003e# MyISAM 设置恢复表之时使用的缓冲区的大小，当在 REPAIR TABLE 或用 CREATE INDEX 创建索引或 ALTER TABLE 过程中排序， MyISAM索引分配的缓冲区。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emyisam_sort_buffer_size = 8M\n\n\u003cspan class=\"gh\"\u003e# 此参数以字节的形式给出，如果临时文件会变得超过索引，不要使用快速排序索引方法来创建一个索引。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emyisam_max_sort_file_size = 10G\n\n\u003cspan class=\"gh\"\u003e# 如果该值大于 1，在 Repair by sorting 过程中并行创建 MyISAM 表索引（每个索引在自己的线程内）\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emyisam_repair_threads = 1\n\n\u003cspan class=\"gh\"\u003e# sync_binlog 参数控制 mysql 的二进制日志同步到磁盘的频率，取值为：0~n\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# sync_binlog=0：当事务提交之后，MySQL不做fsync之类的磁盘同步指令刷新binlog_cache中的信息到磁盘，而让Filesystem自行决定什么时候来做同步，或者cache满了之后才同步到磁盘。这个是性能最好的。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# sync_binlog=1：当每进行1次事务提交之后，MySQL将进行一次fsync之类的磁盘同步指令来将binlog_cache中的数据强制写入磁盘。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# sync_binlog=n：当每进行n次事务提交之后，MySQL将进行一次fsync之类的磁盘同步指令来将binlog_cache中的数据强制写入磁盘。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 大多数情况下，对数据的一致性并没有很严格的要求，所以并不会把 sync_binlog 配置成 1. 为了追求高并发，提升性能，可以设置为 100 或直接用 0。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esync_binlog=1\n\n[mysqldump]\nquick\n\n\u003cspan class=\"gh\"\u003e# 服务器发送和接收的最大包长度\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emax_allowed_packet = 32M \n\n[myisamchk]\nkey_buffer_size = 8M\nsort_buffer_size = 8M\nread_buffer = 4M\nwrite_buffer = 4M\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1536710400,"description":"","fuzzywordcount":5500,"kind":"page","lang":"zh","lastmod":1539216000,"objectID":"e305c5bcf8dd2fc11d1867adebb8d87a","publishdate":1536710400,"relpermalink":"/posts/storage/mysql/mysql-configuration/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 MySQL 配置文件中各个参数的含义，留作后查。\u003c/p\u003e","tags":["MySQL","数据库"],"title":"MySQL 配置文件详解","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-configuration/","wordcount":5474},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下在一些 Linux 发行版中安装工具包的命令，在 docker 容器中排查问题时会有用。\u003c/p\u003e\n\u003ch3 id=\"ubuntu\"\u003eubuntu\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e使用 apt-get 命令来安装软件包\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1）安装 ps 命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt-get install procps\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"alpine\"\u003ealpine\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e使用 apk 命令来安装软件包\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1）安装 telnet 命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapk add busybox-extras\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）安装 make 命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapk add make\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）安装 ps 命令\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eapk add procps\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"debain\"\u003edebain\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e使用 apt 命令来安装工具包\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"apt-命令的使用\"\u003eapt 命令的使用\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e安装软件包\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt install pandoc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"2\"\u003e\n\u003cli\u003e清理缓存\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt clean\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"3\"\u003e\n\u003cli\u003e更新软件包索引数据库\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt update\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"4\"\u003e\n\u003cli\u003e只升级某个软件包\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt --only-upgrade install nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"一些常用软件包的安装方式\"\u003e一些常用软件包的安装方式\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e安装 nc 命令\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt update \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e install netcat\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"2\"\u003e\n\u003cli\u003e安装 ps 命令\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt update \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt install procps\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"3\"\u003e\n\u003cli\u003e安装 curl 命令\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt update \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt install curl\n或者\napt update \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt install net-tools\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"4\"\u003e\n\u003cli\u003e安装 pandoc\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eapt install pandoc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e安装完成后，使用 \u003ccode\u003epandoc --version\u003c/code\u003e 来验证工具是否安装成功\u003c/p\u003e","date":1536710400,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1536796800,"objectID":"f7968c529cd66cadf4a21738da8598f2","publishdate":1536710400,"relpermalink":"/posts/linux/linux-alpine_tips/","section":"posts","summary":"\u003cp\u003e本篇博客记录下在一些 Linux 发行版中安装工具包的命令，在 docker 容器中排查问题时会有用。\u003c/p\u003e","tags":["Linux","apt"],"title":"在 Linux 发行版中安装工具包","url":"https://xdhuxc.github.io/posts/linux/linux-alpine_tips/","wordcount":250},{"categories":"posts","content":"\u003cp\u003e本篇博客整理了一些 Linux 系统中常用的高级命令，在一些复杂的运维工作中会用到。\u003c/p\u003e\n\u003ch3 id=\"netstat\"\u003enetstat\u003c/h3\u003e\n\u003cp\u003enetstat 是一个监控 TCP/IP 网络的工具，可以显示路由表、实际的网络连接以及每一个网络接口设备的状态信息。其语法格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enetstat [options]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-a 或 --all：显示所有的 socket，包括已建立（CONNECTED）的连接，也包括监听连接请求（LISTENING）的那些连接。\u003c/li\u003e\n\u003cli\u003e-c 或 --continuous：持续显示 socket 连接状态。\u003c/li\u003e\n\u003cli\u003e-l 或 --listening：显示处于监听状态的服务器 socket。\u003c/li\u003e\n\u003cli\u003e-t 或 --tcp：显示 TCP 协议的连接状况。\u003c/li\u003e\n\u003cli\u003e-u 或 --udp：显示 UDP 协议的连接状况。\u003c/li\u003e\n\u003cli\u003e-n 或 --numeric：直接使用 IP 地址，而不通过域名服务器。\u003c/li\u003e\n\u003cli\u003e-p 或 --programs：显示正在使用 socket 的进程ID/程序名称。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如果使用时不带参数，netstat 显示活动的 TCP 连接。\u003c/p\u003e\n\u003cp\u003e1、列出所有的端口，包括监听的和未监听的\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enetstat -a   # 列出所有的端口\nnetstat -au  # 列出所有的 TCP 端口\nnetstat -at  # 列出所有的 UDP 端口\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、列出所有处于监听状态的 Socket\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enetstat -l   # 只列出监听（即State 状态为 LISTENING）状况的端口，\nnetstat -lt  # 只列出所有监听的 TCP 端口\nnetstat -lu  # 只列出所有监听的 UDP 端口\nnetstat -lx  # 只列出所有监听 UNIX 的\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、显示 pid 和进程名称\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enetstat -p\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"journalctl\"\u003ejournalctl\u003c/h3\u003e\n\u003cp\u003esystemd 统一管理所有 Unit 的启动日志。带来的好处就是，可以只使用 journalctl 一个命令，查看所有的日志，包括内核日志和应用日志。\u003c/p\u003e\n\u003cp\u003e日志的配置文件为：/etc/systemd/journald.conf\u003c/p\u003e\n\u003cp\u003e1）查看所有日志，默认情况下，只保存本次启动的日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）查看内核日志，不显示应用日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl -k\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"查看指定时间的日志\"\u003e查看指定时间的日志\u003c/h4\u003e\n\u003cp\u003e可以使用 --since 和 --until 选项过滤任意时间限制，这些限制分别显示给定时间之前或之后的记录。\u003c/p\u003e\n\u003cp\u003ejournalctl 还能理解部分相对值及命名简写。例如，可以使用 yesterday，today，tomorrow 或 now 等表达。另外，我们也可以使用“-”或者“+”设定相对值，或者使用“ago”的表达。\u003c/p\u003e\n\u003cp\u003e1、显示 2018年07月11日，16点43分30秒到当前时间之间的所有日志信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl --since=\u0026#34;2018-07-11 16:43:30\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、获取昨天的日志信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl --since yesterday\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、获取某一个时间段到当前时间的前一个小时的日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl --since 12:00 --until \u0026#34;1 hour ago\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、获取当前时间的前20分钟的日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl --since \u0026#34;20 min ago\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、获取某一天到某一个时间段的日志信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl --since \u0026#34;2018-07-11\u0026#34; --until \u0026#34;2018-07-12 17:00:00\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、查看 httpd 服务的日志信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl -u httpd --since today # -u 选项指定待查看的单元\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、按照进程ID查看日志信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl _PID=1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、按日志级别显示日志条目\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl -p err # -p 选项显示特定优先级的信息，从而过滤掉优先级较低的信息。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这将只显示被标记为错误、严重、警告或者紧急级别的信息。我们也可以使用优先级名称或者其相关量化值，以下各数字为由最高到最低优先级：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e0:emerg\n1:alert\n2:crit\n3:err\n4:warning\n5:notice\n6:info\n7:debug\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e9、显示近期的日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl -n200  # 使用 -n 选项指定显示特定数量的记录，默认情况下只显示最后发生的10条日志记录。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e10、追踪日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl -f # 表示主动追踪当前正在输出的日志，只要不终止，会一直监控。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e11、查看当前日志占用磁盘的空间的总大小\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl --disk-usage\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e12、指定日志文件最大空间\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl --vacuum-size=1G\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e13、指定日志文件保存时间\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl --vacuum-time=1years\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参考资料：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/itxdm/p/Systemd_log_system_journalctl.html\"\u003ehttps://www.cnblogs.com/itxdm/p/Systemd_log_system_journalctl.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://blog.51cto.com/13598893/2072212\"\u003ehttp://blog.51cto.com/13598893/2072212\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"nslookup\"\u003enslookup\u003c/h3\u003e\n\u003cp\u003enslookup 是常用的域名查询工具，就是查询 DNS 信息用的命令。\u003c/p\u003e\n\u003cp\u003enslookup 有两种工作模式：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e交互模式：在该模式下，用户可以向域名服务器查询各类主机、域名的信息，或者输出域名中的主机列表。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e进入交互模式，直接输入 nslookup 命令，不加任何参数，则直接进入交互模式，此时 nslookup 会连接到默认的域名服务器（即\u003ccode\u003e/etc/resolv.conf\u003c/code\u003e的第一个 DNS 地址）\u003c/p\u003e\n\u003cp\u003e或者输入 \u003ccode\u003enslookup -nameserver/ip\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e非交互模式：在“非交互模式”下，用户可以针对一个主机或域名仅仅获取特定的名称或所需信息。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e进入非交互模式，就直接输入 \u003ccode\u003enslookup domainname\u003c/code\u003e 即可。\u003c/p\u003e\n\u003ch4 id=\"示例\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、使用默认的域名服务器，根据域名查找 IP 地址\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# nslookup www.baidu.com\nServer:\t\t10.10.24.11\nAddress:\t10.10.24.11#53\n\nNon-authoritative answer:\nwww.baidu.com\tcanonical name = www.a.shifen.com.\nName:\twww.a.shifen.com\nAddress: 61.135.169.121\nName:\twww.a.shifen.com\nAddress: 61.135.169.125\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、使用默认的域名服务器，根据 IP 地址查找域名\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# nslookup 10.10.24.11\nServer:\t\t10.10.24.11\nAddress:\t10.10.24.11#53\n\n11.24.10.10.in-addr.arpa\tname = r-29792-VM.cs1cloud.internal.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者是这样\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# nslookup www.taobao.com\nServer:\t\t10.10.24.11\nAddress:\t10.10.24.11#53\n\nNon-authoritative answer:\nwww.taobao.com\tcanonical name = www.taobao.com.danuoyi.tbcache.com.\nName:\twww.taobao.com.danuoyi.tbcache.com\nAddress: 123.129.215.222\nName:\twww.taobao.com.danuoyi.tbcache.com\nAddress: 123.129.215.178\n\n[root@xdhuxc xdhuxc]# nslookup 123.129.215.178\nServer:\t\t10.10.24.11\nAddress:\t10.10.24.11#53\n\n\u003cspan class=\"ge\"\u003e**\u003c/span\u003e server can\u0026#39;t find 178.215.129.123.in-addr.arpa.: NXDOMAIN\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、列出当前设置的默认选项\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# nslookup\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eset all\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eDefault server: 10.10.24.11\nAddress: 10.10.24.11#53\nDefault server: 202.106.0.20\nAddress: 202.106.0.20#53\nDefault server: 114.114.114.114\nAddress: 114.114.114.114#53\n\nSet options:\n  novc\t\t\tnodebug\t\tnod2\n  search\t\trecurse\n  timeout = 0\t\tretry = 3\tport = 53\n  querytype = A       \tclass = IN\n  srchlist = cs1cloud.internal\n\u0026gt; \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e相对而言，ping 命令只是一个检查网络连通情况的命令，虽然在输入的参数是域名的情况下会通过 DNS 进行查询，但是它只能查询 A 类型和 CNAME 类型的记录，而且只会告诉域名是否存在，不提供其他信息。\u003c/p\u003e\n\u003ch3 id=\"systemctl\"\u003esystemctl\u003c/h3\u003e\n\u003cp\u003esystemctl 命令是系统服务管理器指令，实际上将 service 和 chkconfig 这两个命令组合到一起\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth style=\"text-align:left\"\u003e任务\u003c/th\u003e\n\u003cth style=\"text-align:left\"\u003e旧指令\u003c/th\u003e\n\u003cth style=\"text-align:left\"\u003e新指令\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003e使某服务自动启动\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003echkconfig --level 3 httpd on\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003esystemctl enable httpd.service\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003e使某服务不自动启动\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003echkconfig --level 3 httpd off\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003esystemctl disable httpd.service\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003e检查服务状态\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003eservice httpd status\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003esystemctl status httpd.service(显示服务详细信息)systemctl is-active httpd.service(仅显示是否Active)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003e显示所有已启动的服务\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003echkconfig --list\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003esystemctl list-units --type=service\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003e启动某服务\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003eservice httpd start\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003esystemctl start httpd.service\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003e停止某服务\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003eservice httpd stop\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003esystemctl stop httpd.service\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd style=\"text-align:left\"\u003e重启某服务\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003eservice httpd restart\u003c/td\u003e\n\u003ctd style=\"text-align:left\"\u003esystemctl restart httpd.service\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e1、启动nfs服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl start nfs-server.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、设置开机自启动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl enable nfs-server.server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、停止开机启动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl disable nfs-server.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、查看服务当前状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl status nfs-server.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、重新启动某服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart nfs-server.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、查看所有已启动的服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl list -units --type=service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"top-命令\"\u003etop 命令\u003c/h3\u003e\n\u003cp\u003etop 命令是linux下常用的性能分析工具，能够实时显示系统中各个进程的资源占用状况。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etop - 08:50:33 up 4 days, 17:17,  4 users,  load average: 3.02, 2.95, 2.36\nTasks: 106 total,   1 running, 105 sleeping,   0 stopped,   0 zombie\n%Cpu(s):  0.0 us,  0.1 sy,  0.0 ni, 99.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem :  8010904 total,  3164800 free,  1467176 used,  3378928 buff/cache\nKiB Swap:  2096124 total,  2096124 free,        0 used.  6235608 avail Mem \n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                               \n    1 root      20   0   57504   3376   2260 S   0.0  0.0   1:34.67 systemd                                                                                               \n    2 root      20   0       0      0      0 S   0.0  0.0   0:00.09 kthreadd                                                                                              \n    3 root      20   0       0      0      0 S   0.0  0.0   0:00.03 ksoftirqd/0                                                                                           \n    5 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/0:0H                                                                                          \n    6 root      20   0       0      0      0 S   0.0  0.0   0:08.34 kworker/u8:0                                                                                          \n    7 root      rt   0       0      0      0 S   0.0  0.0   0:00.12 migration/0                                                                                           \n    8 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcu_bh                                                                                                \n    9 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcuob/0                                                                                               \n   10 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcuob/1                                                                                               \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e统计信息区前五行是系统整体的统计信息\u003c/p\u003e\n\u003cp\u003e第一行是任务队列信息，同uptime命令的执行结果，其内容分别描述如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e信息\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e08:50:33\u003c/td\u003e\n\u003ctd\u003e当前时间\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eup 4 days, 17:17\u003c/td\u003e\n\u003ctd\u003e系统运行时间，格式为：小时:分钟\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4 users\u003c/td\u003e\n\u003ctd\u003e当前登录用户数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eload average: 3.02, 2.95, 2.36\u003c/td\u003e\n\u003ctd\u003e系统负载，即任务队列的平均长度，三个数值分别为1分钟，5分钟，15分钟前到现在的平均值。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e第二，三行为进程和CPU的信息，当有多个CPU时，这些内容可能会超过两行，内容如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e信息\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eTasks: 106 total\u003c/td\u003e\n\u003ctd\u003e进程总数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1 running\u003c/td\u003e\n\u003ctd\u003e正在运行的进程数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e105 sleeping\u003c/td\u003e\n\u003ctd\u003e睡眠的进程数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0 stopped\u003c/td\u003e\n\u003ctd\u003e停止的进程数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0 zombie\u003c/td\u003e\n\u003ctd\u003e僵尸进程数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%Cpu(s):  0.0 us（user）\u003c/td\u003e\n\u003ctd\u003e用户空间占用CPU百分比\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0.1 sy（system）\u003c/td\u003e\n\u003ctd\u003e内核空间占用CPU百分比\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0.0 ni（nice）\u003c/td\u003e\n\u003ctd\u003e用户进程空间内改变过优先级的进程占用CPU百分比\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e99.9 id（idle）\u003c/td\u003e\n\u003ctd\u003e空闲CPU百分比\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0.0 wa （IO-wait）\u003c/td\u003e\n\u003ctd\u003e等待输入输出的CPU时间百分比\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0.0 hi（hardware interrupt）\u003c/td\u003e\n\u003ctd\u003eCPU服务于硬中断所耗费的时间总额\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0.0 si （software intrerupt）\u003c/td\u003e\n\u003ctd\u003eCPU服务于软中断所耗费的时间总额\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0.0 st\u003c/td\u003e\n\u003ctd\u003e当前虚拟机中被虚拟化偷走的时间\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e最后两行为内存信息，内容如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e信息\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eKiB Mem :  8010904 total\u003c/td\u003e\n\u003ctd\u003e物理内存总量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3164800 free\u003c/td\u003e\n\u003ctd\u003e空闲内存总量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1467176 used\u003c/td\u003e\n\u003ctd\u003e使用的物理内存总量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3378928 buff/cache\u003c/td\u003e\n\u003ctd\u003e用作内核缓存的内存量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eKiB Swap:  2096124 total\u003c/td\u003e\n\u003ctd\u003e交换区总量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2096124 free\u003c/td\u003e\n\u003ctd\u003e空闲交换区总量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e0 used\u003c/td\u003e\n\u003ctd\u003e使用的交换区总量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6235608 avail Mem\u003c/td\u003e\n\u003ctd\u003e可用内存，\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e列名及含义\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e列明\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ePID\u003c/td\u003e\n\u003ctd\u003e进程ID\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePPID\u003c/td\u003e\n\u003ctd\u003e父进程ID\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUID\u003c/td\u003e\n\u003ctd\u003e进程所有者的用户ID\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUSER\u003c/td\u003e\n\u003ctd\u003e进程所有者的用户名\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTTY\u003c/td\u003e\n\u003ctd\u003e启动进程的终端名称，不是从终端启动的进程则显示为？\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePR\u003c/td\u003e\n\u003ctd\u003e进程优先级\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNI\u003c/td\u003e\n\u003ctd\u003enice值，负值表示高优先级，正值表示低优先级\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%CPU\u003c/td\u003e\n\u003ctd\u003e上次更新到现在的CPU时间占用百分比\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTIME\u003c/td\u003e\n\u003ctd\u003e进程使用的CPU时间总计，单位：秒\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTIME+\u003c/td\u003e\n\u003ctd\u003e进程使用的CPU时间总计，单位：1/100秒\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%MEM\u003c/td\u003e\n\u003ctd\u003e进程使用的物理内存百分比\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eVIRT\u003c/td\u003e\n\u003ctd\u003e进程使用的虚拟内存总量，单位：KB，VIRT=SWAP+RES\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSWAP\u003c/td\u003e\n\u003ctd\u003e进程使用的虚拟内存中，被换出的大小，单位：KB\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eRES\u003c/td\u003e\n\u003ctd\u003e进程使用的，未被换出的物理内存大小，单位：KB，RES=CODE+DATA\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCODE（the Text Resident Set size or TRS）\u003c/td\u003e\n\u003ctd\u003e可执行代码占用的物理内存大小，单位为：KB\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eDATA （the Data Resident Set size or DRS）\u003c/td\u003e\n\u003ctd\u003e可执行代码以外的部分（数据段+栈）占用的物理内存大小，单位：KB\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSHR\u003c/td\u003e\n\u003ctd\u003e共享内存大小，单位：KB\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eS\u003c/td\u003e\n\u003ctd\u003e进程状态：\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eD：不可中断的睡眠状态\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eR：运行，该进程目前正在运行，或者说可以被运行\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eS：睡眠，该进程目前正在睡眠当中，可被某些信号唤醒\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eT：跟踪或停止，该进程目前正在侦测或被停止了\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eZ：僵尸进程，该进程应该已经被终止，但其父进程却无法正常终止它，造成僵尸状态\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCOMMAND\u003c/td\u003e\n\u003ctd\u003e命令名或命令行\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e执行 \u003ccode\u003etop\u003c/code\u003e 命令后，默认显示CPU整体情况，按左上角 \u003ccode\u003e1\u003c/code\u003e 键，显示每个 \u003ccode\u003eCPU\u003c/code\u003e 的负载情况\u003c/p\u003e\n\u003cp\u003e输入 top 命令，快捷键使用如下：\u003c/p\u003e\n\u003cp\u003e按 ‘X’ 键，再按 ‘B’ 键，默认按 CPU 使用率降序排列\u003c/p\u003e\n\u003cp\u003e按住 ‘Shift’ 键，再按 ‘P’ 键，是按 CPU使用率 降序排列。\u003c/p\u003e\n\u003cp\u003e按住 ‘Shift’ 键，再按 ‘M’ 键，是按 内存使用率 降序排列。\u003c/p\u003e\n\u003cp\u003e按住 ‘Shift’ 键，再按 ‘T’ 键，是按 进程运行时间 降序排列。\u003c/p\u003e\n\u003cp\u003e按 ‘F’ 键，进入字段管理页面，使用上下键控制光标移动，使用光标选中某字段，按 ‘D’ 或者空格，取消该列的显示，按 ‘q’ 或 ‘Esc’ 再次进入 top 命令页面，可以看到刚才选中的列已经不显示了。\u003c/p\u003e\n\u003cp\u003e在字段管理页面，使用光标选中某字段后，按 ‘S’ 键，可将该字段设置为排序字段，然后按 ‘Esc’ 或 ‘Q’ 键退出，默认按降序排列。若要改为升序排列，按住 ‘Shift’ 键，然后按 ‘R’ 键，即可按照排序字段升序排列。\u003c/p\u003e\n\u003ch3 id=\"uniq-命令\"\u003euniq 命令\u003c/h3\u003e\n\u003cp\u003euniq 命令用于报告或忽略文件中的重复行，一般与sort命令结合使用\u003c/p\u003e\n\u003cp\u003e选项如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-c，--count：在每列前面显示该行重复出现的次数。\u003c/li\u003e\n\u003cli\u003e-u，--unique：仅显示出现一次的行。\u003c/li\u003e\n\u003cli\u003e-d，--repeated：仅显示重复出现的行，与uniq的区别是：uniq显示所有出现的行，包括出现一次的，而-d选项去除了只出现一次的。\u003c/li\u003e\n\u003cli\u003e-i，--ignore-case：不区分大小写。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"sort-命令\"\u003esort 命令\u003c/h3\u003e\n\u003cp\u003esort 命令将文件内容进行排序，并将排序结果标准输出，默认为字符排序和升序排列。\u003c/p\u003e\n\u003cp\u003e选项如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-n：依照数值的大小排序。\u003c/li\u003e\n\u003cli\u003e-k：指定需要排序的栏位。\u003c/li\u003e\n\u003cli\u003e-h：以人类可读的形式显示。\u003c/li\u003e\n\u003cli\u003e-r：以相反的顺序来排序，即降序排列。\u003c/li\u003e\n\u003cli\u003e-t：指定栏位分隔符\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e1、查看nginx日志中出现地IP数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecat access.log | awk -F \u0026#39;|\u0026#39; \u0026#39;{print $1}\u0026#39; | sort | uniq -c | sort -k1nr | head -n 10\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e示例如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost nginx]# cat xdhuxc.log | awk -F \u0026#39;|\u0026#39; \u0026#39;{print $1}\u0026#39; | sort | uniq -c | sort -k1nr| head -n 5\n   5522 172.20.26.127\n   4873 172.20.13.111\n   2426 172.20.26.128\n    876 172.20.17.6\n    806 172.20.17.8\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"ps-命令\"\u003eps 命令\u003c/h3\u003e\n\u003cp\u003e1、查看进程下的线程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eps -T -p 4561          # 2561 为进程 ID。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看进程树，并输出指定属性\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master kubepods]# ps xf -o pid,ppid,stat,args\n  PID  PPID STAT COMMAND\nps xf -o pid,ppid,stat,args\n22013     1 Ssl  /usr/bin/dockerd --exec-opt native.cgroupdriver=cgroupfs --storage-driver=devicemapper --insecure-registry 0.0.0.0/0 --registry-mirror http://172.20.2\n22023 22013 Ssl   \\_ docker-containerd -l unix:///var/run/docker/libcontainerd/docker-containerd.sock --metrics-interval=0 --start-timeout 2m --state-dir /var/run/dock\n22324 22023 Sl        \\_ docker-containerd-shim 0df7c0ad8b966b62944775ceeab92f337565ae5230176e63e9a835f611fd6618 /var/run/docker/libcontainerd/0df7c0ad8b966b62944775ce\n22350 22324 Ss        |   \\_ /pause\n22424 22023 Sl        \\_ docker-containerd-shim 1b46c083a0c1b8220985830a21ceb47aba66bba19e8c502c3a962cc8e4610c23 /var/run/docker/libcontainerd/1b46c083a0c1b8220985830a\n22446 22424 Ss        |   \\_ /pause\n22555 22023 Sl        \\_ docker-containerd-shim b6600a35e42def755b300f470e09982644026cb4bcff47425b67dd29deb6c279 /var/run/docker/libcontainerd/b6600a35e42def755b300f47\n22575 22555 Ss        |   \\_ /pause\n22615 22023 Sl        \\_ docker-containerd-shim aab94460ba50336a123ef79874be9a57d48b8a9ca5df0440034be804be21dd46 /var/run/docker/libcontainerd/aab94460ba50336a123ef798\n22640 22615 Ss        |   \\_ /pause\n22717 22023 Sl        \\_ docker-containerd-shim 055666c9918be5042a0e8450e68fd716698f74db8d17ed31a477a65df5f5f61c /var/run/docker/libcontainerd/055666c9918be5042a0e8450\n22746 22717 Ss        |   \\_ /pause\n22823 22023 Sl        \\_ docker-containerd-shim fc6644e7c274a6695291afb927705a60de34dc232afdcb32f4cbe71ced2bde1c /var/run/docker/libcontainerd/fc6644e7c274a6695291afb9\n22843 22823 Ssl       |   \\_ /usr/bin/kube-controllers\n22926 22023 Sl        \\_ docker-containerd-shim fc115ec286f1f90ef9ba3a30f93e8636fec97ff32394dc067642b98695399c2a /var/run/docker/libcontainerd/fc115ec286f1f90ef9ba3a30\n22967 22926 Ss        |   \\_ /pause\n22992 22023 Sl        \\_ docker-containerd-shim 5335322da47f532e81bd49ce19047d7dce9de3772201e165d417b4c3a2f3061f /var/run/docker/libcontainerd/5335322da47f532e81bd49ce\n23033 22992 Ss        |   \\_ /pause\n23091 22023 Sl        \\_ docker-containerd-shim 558e3570397e4b178d1e03828bc4094b8544f5e8021192692509502ed6c41f62 /var/run/docker/libcontainerd/558e3570397e4b178d1e0382\n23114 23091 Ss        |   \\_ /pause\n23178 22023 Sl        \\_ docker-containerd-shim 630bb2f866da362faee80b00ff771f4c3900e442d0efc730470e9ebd5c89ef5c /var/run/docker/libcontainerd/630bb2f866da362faee80b00\n23201 23178 Ss        |   \\_ /pause\n23269 22023 Sl        \\_ docker-containerd-shim 4fe2e9adc614057e37aa9e6f1428fe244e8e79720b36f1044d2fdffe0627a151 /var/run/docker/libcontainerd/4fe2e9adc614057e37aa9e6f\n23290 23269 Ss        |   \\_ /usr/bin/dumb-init /nginx-ingress-controller --default-backend-service=ingress-nginx/default-http-backend --configmap=ingress-nginx/nginx-\n23313 23290 Ssl       |       \\_ /nginx-ingress-controller --default-backend-service=ingress-nginx/default-http-backend --configmap=ingress-nginx/nginx-configuration -\n23655 23313 S         |           \\_ nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf\n23356 22023 Sl        \\_ docker-containerd-shim d24b9bd89b0614770bab8e4022f9c478bbf1f95961ae03733ea4ba089b2d1c2d /var/run/docker/libcontainerd/d24b9bd89b0614770bab8e40\n23376 23356 Ss        |   \\_ /sbin/runsvdir -P /etc/service/enabled\n24256 23376 Ss        |       \\_ runsv felix\n24267 24256 Sl        |       |   \\_ calico-felix\n24257 23376 Ss        |       \\_ runsv bird\n24268 24257 S         |       |   \\_ bird -R -s /var/run/calico/bird.ctl -d -c /etc/calico/confd/config/bird.cfg\n24258 23376 Ss        |       \\_ runsv bird6\n24262 24258 S         |       |   \\_ bird6 -R -s /var/run/calico/bird6.ctl -d -c /etc/calico/confd/config/bird6.cfg\n24259 23376 Ss        |       \\_ runsv confd\n24263 24259 Sl        |           \\_ confd -confdir=/etc/calico/confd -interval=5 -watch --log-level=info -node=http://172.20.26.150:2379 -client-key= -client-cert= -c\n23475 22023 Sl        \\_ docker-containerd-shim d5582f7b927c731966c6e75d0619f16fec661c1d8b287e7b47020c13f4f29879 /var/run/docker/libcontainerd/d5582f7b927c731966c6e75d\n23503 23475 Ss        |   \\_ /pause\n23583 22023 Sl        \\_ docker-containerd-shim 9b680676ec0fd4434fef03a614e32908849947f7d87be73894304745909ae308 /var/run/docker/libcontainerd/9b680676ec0fd4434fef03a6\n23604 23583 Ssl       |   \\_ /usr/bin/kube-controllers\n23720 22023 Sl        \\_ docker-containerd-shim 95054e9ec8211a283e5b5e2fe271687cbc8a6febc28b6a58811871c9c70abf26 /var/run/docker/libcontainerd/95054e9ec8211a283e5b5e2f\n23749 23720 Ssl       |   \\_ /usr/local/bin/etcd -data-dir /var/etcd/data -listen-client-urls http://127.0.0.1:2379,http://127.0.0.1:4001 -advertise-client-urls http:/\n24159 22023 Sl        \\_ docker-containerd-shim cacf746cbac262377a3925c9c47bd36e5a06a2de688d8257949b4cedfdf0e552 /var/run/docker/libcontainerd/cacf746cbac262377a3925c9\n24180 24159 Ssl       |   \\_ /usr/bin/kube-controllers\n24215 22023 Sl        \\_ docker-containerd-shim 4c294ff5706f5f45ece29911d508d94513c1728f900cc808653377c5d92b9a0d /var/run/docker/libcontainerd/4c294ff5706f5f45ece29911\n24239 24215 Ssl       |   \\_ /usr/bin/kube-controllers\n24404 22023 Sl        \\_ docker-containerd-shim c260f89fc132757701cf374ffa3c336ea09561c0ec2fdb62a7b955c5086ec635 /var/run/docker/libcontainerd/c260f89fc132757701cf374f\n24422 24404 Ss        |   \\_ /bin/sh -c /run.sh $FLUENTD_ARGS\n24457 24422 S         |       \\_ /bin/sh /run.sh --no-supervisor\n24459 24457 Sl        |           \\_ /usr/bin/ruby2.3 /usr/local/bin/fluentd --no-supervisor\n24499 22023 Sl        \\_ docker-containerd-shim 23be602627713a4d4a8f6022c0149e7ed12ded42d8b6821b778412fe879d3349 /var/run/docker/libcontainerd/23be602627713a4d4a8f6022\n24521 24499 Ss        |   \\_ /bin/sh /install-cni.sh\n 2160 24521 S         |       \\_ sleep 10\n24539 22023 Sl        \\_ docker-containerd-shim a0b332204da15546ae376fae91bd93488a54e19ad15bcb4074f4e4d6c703d007 /var/run/docker/libcontainerd/a0b332204da15546ae376fae\n24566 24539 Ssl       |   \\_ /usr/bin/kube-controllers\n24683 22023 Sl        \\_ docker-containerd-shim 45538bf87293a303e784c1f2b4c9d05613dc26e284a9ff714e0a4ab78952d903 /var/run/docker/libcontainerd/45538bf87293a303e784c1f2\n24712 24683 Ssl       |   \\_ /kube2sky -domain=kube.local\n24746 22023 Sl        \\_ docker-containerd-shim 8d1012c2cfebea10d9f250aa803c523860f6213ba057d85611385ce55de01639 /var/run/docker/libcontainerd/8d1012c2cfebea10d9f250aa\n24909 22023 Sl        \\_ docker-containerd-shim 5381a8ce1f7fdf31aa0b87a4d6b63469bd99b3a814ce0f38c3e2dddfbb13cc68 /var/run/docker/libcontainerd/5381a8ce1f7fdf31aa0b87a4\n24928 24909 Ssl       |   \\_ /skydns -machines=http://localhost:4001 -addr=0.0.0.0:53 -domain=kube.local\n24992 22023 Sl        \\_ docker-containerd-shim 1cc405561a9ed15554658b1237339273b57ae5e68c85f4497741fa0b16248e7e /var/run/docker/libcontainerd/1cc405561a9ed15554658b12\n25010 24992 Ssl       |   \\_ /exechealthz -cmd=nslookup kubernetes.default.svc.kube.local localhost \u0026gt;/dev/null -port=8080\n31505 22023 Sl        \\_ docker-containerd-shim 39fd7f660d705e6406d6e5bedeb3082e384370f0557c7c0b8edc91e97e1a945f /var/run/docker/libcontainerd/39fd7f660d705e6406d6e5be\n31523 31505 Ss        |   \\_ /pause\n31636 22023 Sl        \\_ docker-containerd-shim 2b4014ca44a5752cd827734f49fcbd58724c5373a90dd06ffeef33a5f627d953 /var/run/docker/libcontainerd/2b4014ca44a5752cd827734f\n31653 31636 Ssl           \\_ /dashboard --insecure-bind-address=0.0.0.0 --bind-address=0.0.0.0 --auto-generate-certificates\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"tree-命令\"\u003etree 命令\u003c/h3\u003e\n\u003cp\u003e1、查看当前目录下的目录及文件详情\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etree -a # 显示当前目录下的所有文件及目录\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看当前目录三级以内的文件及目录详情\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# -L：指定目录深度。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003etree -L 3 # 显示当前目录三级以内的文件及目录详情\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查看当前目录三级以内的文件及目录详情及文件和目录的大小，并以可读的方式显示\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etree -L --du -h # 显示当前目录三级以内的文件及目录详情，并以可读方式显示目录和文件的大小。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"w-命令\"\u003ew 命令\u003c/h3\u003e\n\u003cp\u003ew 命令用于显示已经登录系统的用户列表，并显示用户正在执行的命令。执行此命令可以知道目前登录进系统的用户以及他们正在执行的程序，还包括他们登录的 IP 地址。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# w\n 16:04:06 up 27 days, 23 min,  2 users,  load average: 0.00, 0.01, 0.05\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nroot     pts/1    10.6.198.249     Mon10   24:15m  0.13s  0.13s -bash\nroot     pts/4    10.4.100.45      09:32    6.00s  0.01s  0.00s w\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"cut-命令\"\u003ecut 命令\u003c/h3\u003e\n\u003cp\u003e指定分隔符截取文件内容，而不是默认的tab\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecat /etc/passwd | cut -d \u0026#34;:\u0026#34; -f 1 # 查询linux系统中的所有用户 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1536624000,"description":"","fuzzywordcount":5100,"kind":"page","lang":"zh","lastmod":1536624000,"objectID":"8d30d6e4f06f4422f3b38b8dc1f13703","publishdate":1536624000,"relpermalink":"/posts/linux/linux-advanced-command/","section":"posts","summary":"\u003cp\u003e本篇博客整理了一些 Linux 系统中常用的高级命令，在一些复杂的运维工作中会用到。\u003c/p\u003e","tags":["linux"],"title":"Linux 部分高级命令总结","url":"https://xdhuxc.github.io/posts/linux/linux-advanced-command/","wordcount":5043},{"categories":"posts","content":"\u003cp\u003e我们有时需要用到定时任务来备份数据或者发送邮件，此时，一般会使用 Linux 系统中的 crontab 来实现。其他各种系统的定时任务使用的定时策略描述方式与 Linux 系统的 crontab 基本一样。\u003c/p\u003e\n\u003ch3 id=\"定时任务\"\u003e定时任务\u003c/h3\u003e\n\u003cp\u003e1、命令格式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecrontab [-u user] file crontab [-u user] [-e | -l | -r | -i]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-u user：设定指定用户的 crontab 服务；\u003c/li\u003e\n\u003cli\u003efile：命令文件的名字，表示将 file 作为 crontab 的任务列表文件并载入 crontab。如果在命令行中没有指定这个文件，crontab 命令将接收标准输入上输入的命令，并将它们载入 crontab；\u003c/li\u003e\n\u003cli\u003e-e：编辑 crontab 文件内容；\u003c/li\u003e\n\u003cli\u003e-l：显示 crontab 文件内容；\u003c/li\u003e\n\u003cli\u003e-r：从 /var/spool/cron 目录中删除 crontab 文件；\u003c/li\u003e\n\u003cli\u003e-i：在删除 crontab 文件时给确认提示\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2、crontab 文件格式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# ┌───────────── minute (0 - 59)\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# │ ┌───────────── hour (0 - 23)\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# │ │ ┌───────────── day of the month (1 - 31)\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# │ │ │ ┌───────────── month (1 - 12)\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# │ │ │ │ ┌───────────── day of the week (0 - 6) (Sunday to Saturday;\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# │ │ │ │ │                                   7 is also Sunday on some systems)\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# │ │ │ │ │\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# │ │ │ │ │\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# * * * * * command to execute\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e依次分别是：分钟 小时 日 月份 星期 运行命令，分别使用空格分隔。\u003c/p\u003e\n\u003cp\u003e特殊字符含义：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e*：表示任何时刻都能接受；\u003c/li\u003e\n\u003cli\u003e,：表示分隔时段，例如：\u003ccode\u003e30 10,17 * * * command\u003c/code\u003e 表示上午九点半和下午五点半分别执行 command；\u003c/li\u003e\n\u003cli\u003e-：表示一段时间范围，例如：\u003ccode\u003e30 7-10 * * * command\u003c/code\u003e 表示从七点到十点的每个小时的30分钟都执行 command；\u003c/li\u003e\n\u003cli\u003e/n：n 代表数字，表示每个 n 单位间隔，例如：\u003ccode\u003e*/5 * * * * command\u003c/code\u003e 表示每隔 5 分钟执行一次 command；\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"示例\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、每周一至周五早上10点和下午5点各执行一次\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e0 10,17 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e 0-5 command\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、每小时的第21分钟和第37分钟执行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e21,37 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e command\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、在上午7点到10点的每小时的第11和第47分钟执行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e11,47 7-10 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e * command\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、每晚 10:30 执行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e30 22 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e * command\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、每周六、周日的12点30分执行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e30 12 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e 6,0 command\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、每隔 60 分钟执行一次\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e*/60 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e command\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、整点执行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e0 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e command # 将在每个整点执行 command\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、每分钟向 \u003ccode\u003e/home/xdhuxc.txt\u003c/code\u003e 中输出 \u003ccode\u003eHello World\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecrontab -e \n\u003cspan class=\"ge\"\u003e*/1 *\u003c/span\u003e \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e * echo \u0026#34;\u0026#34; \u0026gt; /home/xdhuxc.txt\nsystemctl restart crond\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"注意事项\"\u003e注意事项\u003c/h3\u003e\n\u003cp\u003e1、脚本中涉及文件路径时需要绝对路径；\u003c/p\u003e\n\u003cp\u003e2、脚本执行时要用到环境变量时，通过 source 命令引入环境变量；\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esource /etc/profile\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、当手动执行脚本可以正确执行，但是 crontab 却不执行时，很可能是没有配置环境变量导致的，可在 crontab 中直接引入环境变量解决问题\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e0 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e source /etc/profile \u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e /bin/sh /home/xdhuxc/abc.sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、新创建的 cron job，不会马上执行，至少要过2分钟才执行，但是如果重启 crond，则马上执行；\u003c/p\u003e\n\u003cp\u003e5、清理系统用户的邮件日志，每条任务调度完毕，系统都会将任务输出信息通过电子邮件的形式发送给当前系统用户，这样日积月累，日志信息会非常大，可能会影响系统的正常运行。因此，将每条任务进行重定向处理非常重要，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e0 \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e \u003cspan class=\"ge\"\u003e* *\u003c/span\u003e /bin/sh /home/xdhuxc/abc.sh \u0026gt;/dev/null 2\u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html\"\u003ehttps://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://code.kpman.cc/2015/02/11/%E5%88%A9%E7%94%A8-crontab-%E4%BE%86%E5%81%9A-Linux-%E5%9B%BA%E5%AE%9A%E6%8E%92%E7%A8%8B/\"\u003ehttps://code.kpman.cc/2015/02/11/%E5%88%A9%E7%94%A8-crontab-%E4%BE%86%E5%81%9A-Linux-%E5%9B%BA%E5%AE%9A%E6%8E%92%E7%A8%8B/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Cron\"\u003ehttps://en.wikipedia.org/wiki/Cron\u003c/a\u003e\u003c/p\u003e","date":1536278400,"description":"","fuzzywordcount":1200,"kind":"page","lang":"zh","lastmod":1536278400,"objectID":"7c871215fb9f8c89eef22b556a2ad994","publishdate":1536278400,"relpermalink":"/posts/linux/linux-cronjob/","section":"posts","summary":"\u003cp\u003e我们有时需要用到定时任务来备份数据或者发送邮件，此时，一般会使用 Linux 系统中的 crontab 来实现。其他各种系统的定时任务使用的定时策略描述方式与 Linux 系统的 crontab 基本一样。\u003c/p\u003e","tags":["Linux","Shell"],"title":"Linux 中 crontab 的使用","url":"https://xdhuxc.github.io/posts/linux/linux-cronjob/","wordcount":1119},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了基于 docker 容器方式部署 influxdb 的详细过程。\u003c/p\u003e\n\u003ch3 id=\"拉取-docker-镜像\"\u003e拉取 docker 镜像\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull influxdb:latest\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"启动-influxdb-容器\"\u003e启动 influxDB 容器\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n      --restart=always \\\n      --name=influxdb \\\n      -p 8086:8086 \\\n      -p 8083:8083 \\\n      -e INFLUXDB_DB=db0 -e INFLUXDB_ADMIN_ENABLED=true \\\n      -e INFLUXDB_ADMIN_USER=admin -e INFLUXDB_ADMIN_PASSWORD=Admin321 \\\n      -e INFLUXDB_USER=texadg -e INFLUXDB_USER_PASSWORD=Texadg123 \\\n      -v /data/influxdb:/var/lib/influxdb \\\n      influxdb\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"测试数据的读写\"\u003e测试数据的读写\u003c/h3\u003e\n\u003cp\u003e1）创建数据库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e-bash-4.2# curl -i -XPOST http://localhost:8086/query --data-urlencode \u0026#34;q=CREATE DATABASE xdb\u0026#34;\nHTTP/1.1 200 OK\nContent-Type: application/json\nRequest-Id: 338ce607-147a-11e9-8002-0242ac110008\nX-Influxdb-Build: OSS\nX-Influxdb-Version: 1.7.2\nX-Request-Id: 338ce607-147a-11e9-8002-0242ac110008\nDate: Thu, 10 Jan 2019 01:51:09 GMT\nTransfer-Encoding: chunked\n\n{\u0026#34;results\u0026#34;:[{\u0026#34;statement_id\u0026#34;:0}]}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）插入数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e-bash-4.2# curl -i -XPOST \u0026#39;http://localhost:8086/write?db=xdb\u0026#39; --data-binary \u0026#39;cpu_load_short,host=server01,region=us-west value=0.64 1434055562000000000\u0026#39;\nHTTP/1.1 204 No Content\nContent-Type: application/json\nRequest-Id: 6f10117d-147a-11e9-8003-0242ac110008\nX-Influxdb-Build: OSS\nX-Influxdb-Version: 1.7.2\nX-Request-Id: 6f10117d-147a-11e9-8003-0242ac110008\nDate: Thu, 10 Jan 2019 01:52:49 GMT\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）查询数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e-bash-4.2# curl -G \u0026#39;http://localhost:8086/query?pretty=true\u0026#39; --data-urlencode \u0026#34;db=xdb\u0026#34; --data-urlencode \u0026#34;q=SELECT \\\u0026#34;value\\\u0026#34; FROM \\\u0026#34;cpu_load_short\\\u0026#34; WHERE \\\u0026#34;region\\\u0026#34;=\u0026#39;us-west\u0026#39;\u0026#34;\n{\n    \u0026#34;results\u0026#34;: [\n        {\n            \u0026#34;statement_id\u0026#34;: 0,\n            \u0026#34;series\u0026#34;: [\n                {\n                    \u0026#34;name\u0026#34;: \u0026#34;cpu_load_short\u0026#34;,\n                    \u0026#34;columns\u0026#34;: [\n                        \u0026#34;time\u0026#34;,\n                        \u0026#34;value\u0026#34;\n                    ],\n                    \u0026#34;values\u0026#34;: [\n                        [\n                            \u0026#34;2015-06-11T20:46:02Z\u0026#34;,\n                            0.64\n                        ]\n                    ]\n                }\n            ]\n        }\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"参考资料\"\u003e参考资料\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://hub.docker.com/_/influxdb/?tab=description\"\u003ehttps://hub.docker.com/_/influxdb/?tab=description\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.influxdata.com/influxdb/v1.7/guides/writing_data/\"\u003ehttps://docs.influxdata.com/influxdb/v1.7/guides/writing_data/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.influxdata.com/influxdb/v1.7/guides/querying_data/\"\u003ehttps://docs.influxdata.com/influxdb/v1.7/guides/querying_data/\u003c/a\u003e\u003c/p\u003e","date":1535500800,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1548720000,"objectID":"1fe1172b441020f65a0be5541141b766","publishdate":1535500800,"relpermalink":"/posts/storage/influxdb/influxdb-install-with-docker/","section":"posts","summary":"\u003cp\u003e本篇博客记录了基于 docker 容器方式部署 influxdb 的详细过程。\u003c/p\u003e","tags":["InfluxDB","数据库"],"title":"基于 docker 方式部署 infludb","url":"https://xdhuxc.github.io/posts/storage/influxdb/influxdb-install-with-docker/","wordcount":258},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 Java 中常用的命令。\u003c/p\u003e\n\u003ch3 id=\"java-命令\"\u003ejava 命令\u003c/h3\u003e\n\u003cp\u003e命令行直接运行可执行的 jar 包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejava -jar jar_name.jar\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"jps-命令\"\u003ejps 命令\u003c/h3\u003e\n\u003cp\u003ejps（Java Virtual Machine Process Status Tool）是一个显示当前所有 java 进程 pid 的命令，显示当前系统的  Java 进程情况及进程 id。\u003c/p\u003e\n\u003cp\u003e常用命令：\u003c/p\u003e\n\u003cp\u003e1、jps\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# jps\n18785 Bootstrap\n19941 Jps\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、jps -m\u003c/p\u003e\n\u003cp\u003e-m：输出传递给 main 方法的参数，在嵌入式 JVM 上可能是 null。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# jps -m\n18785 Bootstrap start\n19965 Jps -m\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、jps -l\u003c/p\u003e\n\u003cp\u003e-l：输出应用程序 main class 的完整包名或者应用程序的 jar 文件完整路径名。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# jps -l\n18785 org.apache.catalina.startup.Bootstrap\n19997 sun.tools.jps.Jps\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、jps -v\n-v：输出传递给 JVM 的参数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# jps -v\n20224 Jps -Dapplication.home=/usr/java/jdk1.8.0_171-amd64 -Xms8m\n18785 Bootstrap -Djava.util.logging.config.file=/root/xdhuxc/apache-tomcat-9.0.8/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dorg.apache.catalina.security.SecurityListener.UMASK=0027 -Dignore.endorsed.dirs= -Dcatalina.base=/root/xdhuxc/apache-tomcat-9.0.8 -Dcatalina.home=/root/xdhuxc/apache-tomcat-9.0.8 -Djava.io.tmpdir=/root/xdhuxc/apache-tomcat-9.0.8/temp\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1535068800,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1535068800,"objectID":"a984045a42068abfe7e32a38941316aa","publishdate":1535068800,"relpermalink":"/posts/programming/java/java-command/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 Java 中常用的命令。\u003c/p\u003e","tags":["Java"],"title":"Java 常用命令介绍","url":"https://xdhuxc.github.io/posts/programming/java/java-command/","wordcount":247},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在 Eclipse 中部署基于 Maven 构建的 Java Web 项目的过程。\u003c/p\u003e\n\u003ch3 id=\"使用-tomcat-部署-web-应用\"\u003e使用 Tomcat 部署 Web 应用\u003c/h3\u003e\n\u003ch4 id=\"tomcat部分\"\u003eTomcat部分\u003c/h4\u003e\n\u003cp\u003e下载解压 \u003ccode\u003eapache-tomcat-8.0.47\u003c/code\u003e，在Eclipse中添加 Tomcat 服务器（\u003ccode\u003eWindow\u003c/code\u003e-\u0026gt;\u003ccode\u003ePreferences\u003c/code\u003e-\u0026gt;\u003ccode\u003eServer\u003c/code\u003e-\u0026gt;\u003ccode\u003eRuntime Environments\u003c/code\u003e-\u0026gt;\u003ccode\u003eAdd\u003c/code\u003e-\u0026gt;\u003ccode\u003eApache\u003c/code\u003e-\u0026gt;\u003ccode\u003eApache Tomcat v8.0\u003c/code\u003e-\u0026gt;\u003ccode\u003eNext\u003c/code\u003e-\u0026gt;\u003ccode\u003eBrowse\u003c/code\u003e-\u0026gt;\u003ccode\u003eapache-tomcat-8.0.47所在目录\u003c/code\u003e-\u0026gt;\u003ccode\u003eFinish\u003c/code\u003e）。\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003eapache-tomcat-8.0.47/conf/tomcat-users.xml\u003c/code\u003e中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003erole\u003c/span\u003e \u003cspan class=\"na\"\u003erolename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;admin-gui\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003erole\u003c/span\u003e \u003cspan class=\"na\"\u003erolename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;admin-script\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003erole\u003c/span\u003e \u003cspan class=\"na\"\u003erolename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;manager-gui\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003erole\u003c/span\u003e \u003cspan class=\"na\"\u003erolename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;manager-script\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003erole\u003c/span\u003e \u003cspan class=\"na\"\u003erolename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;manager-jmx\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003erole\u003c/span\u003e \u003cspan class=\"na\"\u003erolename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;manager-status\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 用户信息\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003euser\u003c/span\u003e \u003cspan class=\"na\"\u003eusername\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;admin\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003epassword\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;admin123\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eroles\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;admin-gui,admin-script,manager-gui,manager-script,manager-jmx,manager-status\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"maven部分\"\u003eMaven部分\u003c/h4\u003e\n\u003cp\u003e下载解压 \u003ccode\u003eapache-maven-3.5.2\u003c/code\u003e，在Eclipse中添加Maven（\u003ccode\u003eWindow\u003c/code\u003e-\u0026gt;\u003ccode\u003ePreferences\u003c/code\u003e-\u0026gt;\u003ccode\u003eMaven\u003c/code\u003e-\u0026gt;\u003ccode\u003eInstallations\u003c/code\u003e-\u0026gt;\u003ccode\u003eAdd\u003c/code\u003e-\u0026gt;\u003ccode\u003eDirectory\u003c/code\u003e-\u0026gt;\u003ccode\u003eapache-maven-3.5.2所在目录\u003c/code\u003e-\u0026gt;\u003ccode\u003e选中自己添加的Maven\u003c/code\u003e-\u0026gt;\u003ccode\u003eFinish\u003c/code\u003e），\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003eapache-maven-3.5.2/conf/settings.xml\u003c/code\u003e中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eservers\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etomcat\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"ni\"\u003e#随意起\u003c/span\u003e，没有特殊要求\n      # username和password的与tomcat-users.xml中保持一致\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eadmin\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eadmin123\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eservers\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003epom.xml\u003c/code\u003e 文件中加入如下内容：（也适用于Tomcat 8）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebuild\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.apache.tomcat.maven\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etomcat6-maven-plugin\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e2.2\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ehttp://localhost:8080/manager/text\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \t# server与settings.xml中的server保持一致\n          \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etomcat\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \t# username和password的与tomcat-users.xml中保持一致\n          \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eadmin\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eadmin123\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.apache.tomcat.maven\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etomcat7-maven-plugin\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e2.2\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ehttp://localhost:8080/manager/text\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etomcat\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eadmin\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eusername\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eadmin123\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003epassword\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n          \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugins\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ebuild\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"运行访问\"\u003e运行访问\u003c/h4\u003e\n\u003cp\u003e在Eclipse中，右键点击项目名-\u0026gt;\u003ccode\u003eRun as\u003c/code\u003e-\u0026gt;\u003ccode\u003eMaven Build\u003c/code\u003e-\u0026gt; 在Goals中输入：\u003ccode\u003etomcat7:run\u003c/code\u003e，点击\u003ccode\u003eRun\u003c/code\u003e启动Tomcat服务器。\u003c/p\u003e\n\u003cp\u003e常用的Goal\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003etomcat:deploy\u003c/td\u003e\n\u003ctd\u003e部署一个web war包\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etomcat:reload\u003c/td\u003e\n\u003ctd\u003e重新加载web war包\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etomcat:start\u003c/td\u003e\n\u003ctd\u003e启动tomcat\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etomcat:stop\u003c/td\u003e\n\u003ctd\u003e停止tomcat\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etomcat:undeploy\u003c/td\u003e\n\u003ctd\u003e停止一个war包\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etomcat:run\u003c/td\u003e\n\u003ctd\u003e启动嵌入式tomcat ，并运行当前项目\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"使用-jetty-部署-web-应用\"\u003e使用 Jetty 部署 Web 应用\u003c/h3\u003e\n\u003cp\u003e1、在Eclipse中安装Jetty插件\u003c/p\u003e\n\u003cp\u003e打开 Eclipse，\u003ccode\u003eHelp\u003c/code\u003e-\u0026gt;\u003ccode\u003eInstall New Software...\u003c/code\u003e-\u0026gt;在\u003ccode\u003eWork with\u003c/code\u003e后的输入框中输入\u003ccode\u003ehttp://eclipse-jetty.github.io/update/\u003c/code\u003e-\u0026gt;遇Next则Next，遇Accept则Accept-\u0026gt;重启Eclipse\u003c/p\u003e\n\u003cp\u003e2、在pom.xml中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"ni\"\u003e#定义变量\u003c/span\u003e，常用于定义框架、jar包等的版本号和项目相关的名称\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ejavaVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.8\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ejavaVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003espringVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e5.0.1.RELEASE\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003espringVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ejettyVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e9.4.7.v20170914\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ejettyVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  \n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.eclipse.jetty\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ejetty-maven-plugin\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e${jettyVersion}\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escanIntervalSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e10\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escanIntervalSeconds\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ewebApp\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t      \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003econtextPath\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e/demonstrate\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003econtextPath\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ewebApp\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehttpConnector\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e8090\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"ni\"\u003e#项目发布的端口号\u003c/span\u003e，访问时即访问该端口\n        \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehttpConnector\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eplugin\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动项目\u003c/p\u003e\n\u003cp\u003e在Eclipse中，右键点击项目名-\u0026gt;\u003ccode\u003eRun as\u003c/code\u003e-\u0026gt;\u003ccode\u003eMaven Build\u003c/code\u003e-\u0026gt;在\u003ccode\u003eGoals\u003c/code\u003e中输入\u003ccode\u003ejetty:run\u003c/code\u003e-\u0026gt;\u003ccode\u003eRun\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e4、访问项目\u003c/p\u003e\n\u003cp\u003e在浏览器中，输入\u003ccode\u003ehttp://localhost:8090/demonstrate\u003c/code\u003e，回车后可访问首页。\u003c/p\u003e","date":1535068800,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1535068800,"objectID":"e3f6eb487b13ebe108f361307545f546","publishdate":1535068800,"relpermalink":"/posts/programming/java/java-eclipse-maven-web/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在 Eclipse 中部署基于 Maven 构建的 Java Web 项目的过程。\u003c/p\u003e","tags":["Java","Maven"],"title":"在 Eclipse 中部署基于 Maven 构建的 Java Web 项目","url":"https://xdhuxc.github.io/posts/programming/java/java-eclipse-maven-web/","wordcount":1270},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在使用 Kubernetes 的 Ingress 时，应用的访问链路，这可以为应用访问不通时排查问题提供帮助。\u003c/p\u003e\n\u003ch3 id=\"部署应用及-ingress\"\u003e部署应用及 Ingress\u003c/h3\u003e\n\u003cp\u003e使用如下所示的 YAML 文件部署 nginx 及其 Service 和 Ingress\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekind: Deployment\napiVersion: extensions/v1beta1\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n        version: v1\n    spec:\n      containers:\n      \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: nginx\n        image: nginx:latest\n        imagePullPolicy: IfNotPresent\n        ports:\n        \u003cspan class=\"k\"\u003e-\u003c/span\u003e containerPort: 80\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 80\n          initialDelaySeconds: 30\n          timeoutSeconds: 30\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 80\n          initialDelaySeconds: 30\n          timeoutSeconds: 30\n\n---\nkind: Service\napiVersion: v1\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  ports:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e port: 80\n    targetPort: 80\n    name: http\n  selector:\n    app: nginx\n\n---\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: nginx\n  annotations:\n    ingress.kubernetes.io/rewrite-target: /\nspec:\n  rules:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e http:\n      paths:\n      \u003cspan class=\"k\"\u003e-\u003c/span\u003e path: /\n        backend:\n          serviceName: nginx\n          servicePort: 80\n    host: xdhuxc.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e访问测试\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -Lv --resolve xdhuxc.com:80:${ingress-node-ip} xdhuxc.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -Lv --resolve xdhuxc.com:80:172.31.40.84 xdhuxc.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"访问链路\"\u003e访问链路\u003c/h3\u003e\n\u003cp\u003e域名           主机                    ingress         service         pod/容器\u003cbr\u003e\nxdhuxc.com -\u0026gt; 172.20.26.150:80 -\u0026gt; ingress-controller -\u0026gt; [service] -\u0026gt; 192.168.235.231:80\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/cj2580/article/details/80017904#comments\"\u003ehttps://blog.csdn.net/cj2580/article/details/80017904#comments\u003c/a\u003e\u003c/p\u003e","date":1534464000,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1534550400,"objectID":"299607a5aceb667611f0b8f5ec8e1ca5","publishdate":1534464000,"relpermalink":"/posts/kubernetes/kubernetes-ingress-access/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在使用 Kubernetes 的 Ingress 时，应用的访问链路，这可以为应用访问不通时排查问题提供帮助。\u003c/p\u003e","tags":["Kubernetes"],"title":"Kubernetes 中使用 Ingress 时的访问链路","url":"https://xdhuxc.github.io/posts/kubernetes/kubernetes-ingress-access/","wordcount":292},{"categories":"posts","content":"\u003cp\u003e在 Linux 系统中，Shell 脚本的执行其实还有几种不同的方式，知道这些不同的执行方式对于我们学习脚本和编写脚本很有帮助。\u003c/p\u003e\n\u003cp\u003e在 Linux 系统中，Shell 脚本的执行方式通常有如下三种：\u003c/p\u003e\n\u003ch4 id=\"通过解释器-bash-或-sh-执行\"\u003e通过解释器 \u003ccode\u003ebash\u003c/code\u003e 或 \u003ccode\u003esh\u003c/code\u003e 执行\u003c/h4\u003e\n\u003cp\u003e通过解释器时的命令格式为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ebash shell-script-name  # 通过 bash 解释器来执行 shell 脚本。\n或\nsh shell-script-name    # 通过 sh 解释器来执行 shell 脚本。\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e当脚本文件本身没有可执行权限（即文件权限属性 \u003ccode\u003ex\u003c/code\u003e 位为：“-”）时经常使用的方式；或者脚本文件开头没有指定解释器时，需要使用这种方法。使用起来比较方便，操作时节省了为文件添加执行权限的步骤。当然，也可以选择其他类型的解释器，比如ksh，csh，zsh等。\u003c/p\u003e\n\u003cp\u003e（1）创建文件abc.sh\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# touch abc.sh\n[root@xdhuxc ~]# ls\nabc.sh\n[root@xdhuxc ~]#\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e（2）写入要执行的命令：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# cat \u0026gt;\u0026gt; abc.sh \u0026lt;\u0026lt; EOF           # 向 abc.sh 中追加内容。\n\u0026gt; #!/usr/bin/env bash\n\u0026gt; echo \u0026quot;Hello Shell.\u0026quot;\n\u0026gt; EOF\n[root@xdhuxc ~]# cat abc.sh                     # 显示 abc.sh 文件中的内容。\n#!/usr/bin/env bash\necho \u0026quot;Hello Shell.\u0026quot;\n[root@xdhuxc ~]# ll\ntotal 8\n-rw-r--r-- 1 root root  40 Jun  3 10:12 abc.sh  # abc.sh 没有可执行权限。\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e（3）执行该脚本\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# bash abc.sh\nHello Shell.\n[root@xdhuxc ~]# sh abc.sh\nHello Shell.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e可以看出，命令已经成功执行。\u003c/p\u003e\n\u003ch4 id=\"指定路径执行\"\u003e指定路径执行\u003c/h4\u003e\n\u003cp\u003e指定路径执行 shell 脚本时的命令格式如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eabsolute-path/shell-script-name  # 通过指定绝对路径来执行 shell 脚本。\n或\n./shell-script-name              # 通过指定相对路径来执行 shell 脚本，根据当前路径指定要执行的脚本的路径。\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在当前路径下执行脚本，需要脚本有执行权限，将脚本文件的的权限改为可执行（即文件权限属性 \u003ccode\u003ex\u003c/code\u003e 位为：“x”），使用的命令为：\u003ccode\u003echmod +x shell-script-name\u003c/code\u003e，然后就可以通过绝对路径或者相对路径来执行脚本了。\u003c/p\u003e\n\u003cp\u003e（1）给 \u003ccode\u003eabc.sh\u003c/code\u003e 添加执行权限\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# chmod +x abc.sh                # 为 abc.sh 添加执行权限。\n[root@xdhuxc ~]# ll\ntotal 8\n-rwxr-xr-x 1 root root  40 Jun  3 10:12 abc.sh  # abc.sh 已经有了可执行权限。\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e（2）以绝对路径方式执行 abc.sh\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# pwd\n/root\n[root@xdhuxc ~]# ls\nabc.sh\n[root@xdhuxc ~]# /root/abc.sh\nHello Shell.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e（3）以相对路径方式执行 abc.sh\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ls\nabc.sh\n[root@xdhuxc ~]# ./abc.sh\nHello Shell.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e可以看出，两种方式都能正确执行脚本。在实际脚本的编写过程中，一般都是使用相对路径来执行脚本，这样写成的脚本作为一个整体的程序，可以复制到其他目录或者机器上直接运行，而不必担心脚本内部调用的路径问题。因此，一般要先给脚本添加执行权限，然后使用相对路径的方式来执行。\u003c/p\u003e\n\u003ch4 id=\"source-或者--执行脚本\"\u003esource 或者 \u0026quot;.\u0026quot; 执行脚本\u003c/h4\u003e\n\u003cp\u003esource 或者 \u0026quot;.\u0026quot; 执行 shell 脚本时的命令格式为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esource shell-script-name\n或\n. shell-script-name\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003esource 或者 “.” 命令的功能是：读入shell脚本并执行脚本，即在当前 shell 中执行 source 或 “.”加载并执行相关脚本文件中的命令及语句。\u003c/p\u003e\n\u003cp\u003e（1）使用 source 和 “.” 命令执行 abc.sh\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ls\nabc.sh\n[root@xdhuxc ~]# . abc.sh            # 以 “.” 命令方式执行 abc.sh。\nHello Shell.\n[root@xdhuxc ~]# source abc.sh       # 以 source 方式执行 abc.sh。\nHello Shell.\n[root@xdhuxc ~]#\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e这种方式是在当前 shell 中加载并执行脚本中的命令及语句，而不是产生一个子 shell 来执行脚本文件中的命令，这是与其他几种方式最大的不同。因此，在脚本中定义的变量，在终端中可以直接使用。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ls\nabc.sh\n[root@xdhuxc ~]# echo \u0026quot;password=123\u0026quot; \u0026gt;\u0026gt; abc.sh  # 向 abc.sh 中追加字符串 password=123。\n[root@xdhuxc ~]# cat abc.sh                     # 查看 abc.sh 文件的内容。\n#!/usr/bin/env bash\necho \u0026quot;Hello Shell.\u0026quot;\npassword=123\n[root@xdhuxc ~]# source abc.sh                  # 以 source 方式执行 abc.sh。\nHello Shell.\n[root@xdhuxc ~]# echo ${password}               # 在终端输出 abc.sh 中定义的变量。\n123\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e前两种方式是产生了一个子进程 shell 来执行脚本，因此，脚本中的变量在终端中是获取不到的，因为终端中的操作还在父 shell 中。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# echo \u0026quot;username=root\u0026quot; \u0026gt;\u0026gt; abc.sh\n[root@xdhuxc ~]# ./abc.sh\nHello Shell.\n[root@xdhuxc ~]# echo ${username}\n\n[root@xdhuxc ~]#\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e可以看到，获取不到 username 的值，因为以相对路径执行脚本是在子 shell 进程中的，而获取  username 值的命令是在父 shell 中执行的。\u003c/p\u003e","date":1534118400,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1536278400,"objectID":"98f390ef9bcb85fdeb49c7766144114c","publishdate":1534118400,"relpermalink":"/posts/linux/linux-shell-execute/","section":"posts","summary":"\u003cp\u003e在 Linux 系统中，Shell 脚本的执行其实还有几种不同的方式，知道这些不同的执行方式对于我们学习脚本和编写脚本很有帮助。\u003c/p\u003e","tags":["Linux","Shell"],"title":"Linux 中 Shell 脚本执行的三种方式","url":"https://xdhuxc.github.io/posts/linux/linux-shell-execute/","wordcount":1270},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了一些使用 MySQL 时经常会用到的操作，留作后查。\u003c/p\u003e\n\u003ch3 id=\"赋权操作\"\u003e赋权操作\u003c/h3\u003e\n\u003cp\u003e1、创建只读账户\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; grant select on \u003cspan class=\"ge\"\u003e*.*\u003c/span\u003e to \u0026#39;xdhuxc\u0026#39;@\u0026#39;%\u0026#39; identified by \u0026#39;Xdhuxc163\u0026#39;;  # 创建只读账户xdhuxc，密码为：Xdhuxc63\nmysql\u0026gt; flush privileges;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看其权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show grants for \u0026#39;xdhuxc\u0026#39;@\u0026#39;%\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、授予权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egrant select, insert, update, delete on user.* to \u0026#39;xdhuxc\u0026#39;@\u0026#39;%\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、授予所有权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eGRANT ALL PRIVILEGES ON \u003cspan class=\"ge\"\u003e*.*\u003c/span\u003e TO \u0026#39;root\u0026#39;@\u0026#39;*\u0026#39; IDENTIFIED BY \u0026#39;Xdhuxc123\u0026#39; WITH GRANT OPTION;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e通过此命令也可以修改 MySQL 用户的密码\u003c/p\u003e\n\u003cp\u003e4、创建用户再授权\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecreate user \u0026#39;sonarqube\u0026#39; identified by \u0026#39;Shareit@2020\u0026#39;;\n\ngrant select, insert, update, delete on sonarqube.* to \u0026#39;sonarqube\u0026#39;@\u0026#39;%\u0026#39;;\n\nshow grants for \u0026#39;sonarqube\u0026#39;@\u0026#39;%\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"忘记密码修改密码\"\u003e忘记密码修改密码\u003c/h3\u003e\n\u003ch4 id=\"linux-系统\"\u003eLinux 系统\u003c/h4\u003e\n\u003cp\u003e1、停止数据库服务。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl stop mysqld\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、向 /etc/my.cnf 中添加如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[mysqld]\nskip-grant-tables\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、重启 mysql 服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart mysqld\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、修改密码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; use mysql;\nmysql\u0026gt; update user set authentication_string=password(\u0026#39;Xdhuxc163\u0026#39;) where user=\u0026#39;root\u0026#39;;\nmysql\u0026gt; flush privileges;\nmysql\u0026gt; quit\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、注释掉 skip-grant-tables，重启 mysqld 服务。\u003c/p\u003e\n\u003ch4 id=\"windows-系统\"\u003eWindows 系统\u003c/h4\u003e\n\u003cp\u003e1、关闭 MySQL 服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enet stop mysql57\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、进入 MySQL 的 bin 目录下，执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysqld --default-file=\u0026#34;E:\\Work\\MySQL\\MySQL Server 5.7 Data\\my.ini\u0026#34; --console --skip-grant-tables\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e--default-file：启动 MySQL 服务时的配置文件；\u003c/li\u003e\n\u003cli\u003e--skip-grant-tables：启动 MySQL 服务的时候跳过权限表认证；\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e3、新打开 DOS 窗口，进入 MySQL 的 bin 目录下，执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql -uroot -p # 回车后，让输入密码，直接回车\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、更改root用户密码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# MySQL 5.7以前\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eupdate mysql.user\nset password=password(\u0026#39;123456\u0026#39;)\n where user=\u0026#39;root\u0026#39;;\n\u003cspan class=\"gh\"\u003e# MySQL 5.7\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eupdate mysql.user\nset authentication_string=password(\u0026#39;123456\u0026#39;)\n where user=\u0026#39;root\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、更新权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eflush privileges;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、退出当前MySQL回话并启动MySQL服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enet start mysql57\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"修改默认时区\"\u003e修改默认时区\u003c/h3\u003e\n\u003ch4 id=\"方法一\"\u003e方法一\u003c/h4\u003e\n\u003cp\u003e1、查看 mysql 系统时间\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; show variables like \u0026#39;%time_zone%\u0026#39;;\n+------------------+--------+\n| Variable_name    | Value  |\n+------------------+--------+\n| system_time_zone | UTC    |\n| time_zone        | +08:00 |\n+------------------+--------+\n2 rows in set\n\nmysql\u0026gt; select now();\n+---------------------+\n| now()               |\n+---------------------+\n| 2018-07-09 13:59:16 |\n+---------------------+\n1 row in set\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003emysql 的系统时区已经是东八区，系统时间也是当前时间了，\u003c/p\u003e\n\u003cp\u003e2、设置时区为东八区\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eset global time_zone = \u0026#39;+8:00\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、刷新权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eflush privileges;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"方法二\"\u003e方法二\u003c/h4\u003e\n\u003cp\u003e或者直接在 my.cnf 文件中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[mysqld]\ndefault-time_zone = \u0026#39;+8:00\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后重启 mysql 服务\u003c/p\u003e","date":1533772800,"description":"","fuzzywordcount":700,"kind":"page","lang":"zh","lastmod":1552953600,"objectID":"043e4e5b596e508737daac6b7cdde0c1","publishdate":1533772800,"relpermalink":"/posts/storage/mysql/mysql-common-operations/","section":"posts","summary":"\u003cp\u003e本篇博客记录了一些使用 MySQL 时经常会用到的操作，留作后查。\u003c/p\u003e","tags":["MySQL","数据库"],"title":"MySQL 常用操作","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-common-operations/","wordcount":671},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍些 Python 常用的基础知识。\u003c/p\u003e\n\u003ch3 id=\"生成器和迭代器\"\u003e生成器和迭代器\u003c/h3\u003e\n\u003ch4 id=\"生成器\"\u003e生成器\u003c/h4\u003e\n\u003cp\u003e带有yield关键字的函数在python中被称为generator（生成器）。python解释器会将带有yield关键字的函数视为一个生成器来处理。一个函数或者子程序都只能return一次，但是一个生成器能暂停执行并返回一个中间的结果，这是yield语句的功能：返回一个中间值给调用者并暂停执行。\u003c/p\u003e\n\u003ch4 id=\"优点\"\u003e优点\u003c/h4\u003e\n\u003cp\u003e生成器的一个优点是它不要求事先准备好整个迭代过程中所有的元素，即无须将对象的所有元素都存入内存之后，才开始进行操作。生成器仅在迭代至某个元素时才会将该元素放入内存，而在这之前或之后，元素可以不存在或者被销毁。这个特点使得它特别适合用于遍历一些巨大的或者无限的类序列对象，例如大文件、大集合、大字典或者斐波那契数列等。这个特点被称为延迟计算或者惰性求值，可以有效地节省内存。惰性求值实际上是实现了协同程序的思想。\u003c/p\u003e\n\u003cp\u003e协同程序：是一个可以独立运行的函数调用，该调用可以被暂停或者挂起，之后还能够从程序流挂起的地方继续或重新开始。当协同程序被挂起时，Python就能够从该协同程序中获取一个处于中间状态的属性的返回值（由yield返回），当调用next()方法使得程序流回到协同程序中时，能够为其传入额外的或者是被改变了的参数，并且从上次挂起的下一条语句继续执行。这是一种类似于进程中断的函数调用方式。\u003c/p\u003e\n\u003cp\u003e这种挂起函数调用并在返回属性中间值后，仍然能够多次继续执行的协同程序被称之为生成器。\u003c/p\u003e\n\u003cp\u003e使用场景：当需要以迭代的方式去处理一个巨大的数据集合，比如一个巨大的文件或者一个复杂的数据库查询时，就需要使用生成器。\u003c/p\u003e\n\u003ch3 id=\"迭代器\"\u003e迭代器\u003c/h3\u003e\n\u003cp\u003e任何实现了__iter__()和__next__()（python 2中实现next()）方法的对象都是迭代器，__iter__返回迭代器本身，__next__返回容器中的下一个值，如果容器中没有更多元素了，则抛出StopIteration异常。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e容器是一系列元素的集合，string、list、set、dict、file、socket对象都可以看做容器，容器都可以被迭代（用在for、while等语句中），因此他们被称为可迭代对象。\u003c/li\u003e\n\u003cli\u003e可迭代对象实现了__iter__()方法，该方法返回一个迭代器对象。\u003c/li\u003e\n\u003cli\u003e迭代器持有一个内部状态的字段，用于记录下次迭代返回值，实现了__next__()和__iter__()方法，迭代器不会一次性把所有元素加载到内存，而是需要的时候才生成返回结果。\u003c/li\u003e\n\u003cli\u003e生成器是一种特殊的迭代器，它的返回值不是通过return，而是用yield。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e容器是一种把多个元素组织在一起的数据结构，容器中的元素可以逐个地迭代获取，可以用in, not in关键字判断元素是否包含在容器中。通常这类数据结构把所有的元素存储在内存中（也有一些特例，并不是所有的元素都放在内存，比如迭代器和生成器对象）。\u003c/p\u003e\n\u003cp\u003e凡是可以返回一个迭代器的对象都可称之为可迭代对象，\u003c/p\u003e\n\u003ch3 id=\"下划线问题\"\u003e下划线问题\u003c/h3\u003e\n\u003ch4 id=\"单下划线开头\"\u003e单下划线开头\u003c/h4\u003e\n\u003cp\u003ePython 中没有真正的私有属性或方法，可以在声明为私有的方法和属性前加上单下划线，以提示该属性和方法不应在外部调用。如果真的调用了，也不会出错，但不符合规范。\u003c/p\u003e\n\u003cp\u003e带有单下划线的特性不会被 from module_name import *导入。\u003c/p\u003e\n\u003ch4 id=\"双下划线开头\"\u003e双下划线开头\u003c/h4\u003e\n\u003cp\u003e双下划线开头，是为了不让子类重写该属性方法，通过类的实例化时自动转换，在类中的双下划线开头的属性方法前加上 _类名 实现\u003c/p\u003e\n\u003ch4 id=\"双下划线开头和双下划线结尾\"\u003e双下划线开头和双下划线结尾\u003c/h4\u003e\n\u003cp\u003e此种写法为 python内建属性方法，最好不要在外部调用。\u003c/p\u003e\n\u003cp\u003e以单下划线开头 _foo 的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用 from xxx import * 而导入；\u003c/p\u003e\n\u003cp\u003e以双下划线开头的 __foo 代表类的私有成员；\u003c/p\u003e\n\u003cp\u003e以双下划线开头和结尾的 \u003cstrong\u003efoo\u003c/strong\u003e 代表 Python 里特殊方法专用的标识，如 \u003cstrong\u003einit\u003c/strong\u003e() 代表类的构造函数。\u003c/p\u003e\n\u003ch3 id=\"args-与-kwargs\"\u003e\u003ccode\u003e*args\u003c/code\u003e 与 \u003ccode\u003e**kwargs\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e*args\u003c/code\u003e 表示非键值对的不确定个数的变量列表，其中args可以换成别的合法变量名，比如*vars，但是那个 * 是必须的。\u003c/p\u003e\n\u003cp\u003e**kwargs 表示带键值对的不确定个数的参数列表，同样，kwargs也可以换成别的合法变量名。\u003c/p\u003e\n\u003cp\u003e当不知道函数中传递参数的个数时，就可以使用这两个参数。\u003c/p\u003e\n\u003ch3 id=\"对象销毁垃圾回收\"\u003e对象销毁(垃圾回收)\u003c/h3\u003e\n\u003cp\u003ePython 使用了引用计数这一简单技术来跟踪和回收垃圾。 在 Python 内部记录着所有使用中的对象各有多少引用。 一个内部跟踪变量，称为一个引用计数器。 当对象被创建时， 就创建了一个引用计数， 当这个对象不再需要时， 也就是说， 这个对象的引用计数变为0 时， 它被垃圾回收。但是回收不是\u0026quot;立即\u0026quot;的， 由解释器在适当的时机，将垃圾对象占用的内存空间回收。\u003c/p\u003e\n\u003cp\u003e垃圾回收机制不仅针对引用计数为0的对象，同样也可以处理循环引用的情况。循环引用指的是，两个对象相互引用，但是没有其他变量引用他们。这种情况下，仅使用引用计数是不够的。Python 的垃圾收集器实际上是一个引用计数器和一个循环垃圾收集器。作为引用计数的补充， 循环垃圾收集器也会留心被分配的总量很大（及未通过引用计数销毁的那些）的对象。 在这种情况下， 解释器会暂停下来， 试图清理所有未引用的循环。\u003c/p\u003e\n\u003cp\u003e析构函数 del ，__del__在对象销毁的时候被调用，当对象不再被使用时，__del__方法运行。\u003c/p\u003e\n\u003ch3 id=\"is-与--的区别\"\u003eis 与 == 的区别\u003c/h3\u003e\n\u003cp\u003ePython 中的对象包含三个要素：id，type，value\n其中，id 用来唯一标识一个对象，type标识对象的类型，value是对象的值。\u003c/p\u003e\n\u003cp\u003eis 判断的是 a 对象是否就是 b 对象，是通过 id 来判断的。\u003c/p\u003e\n\u003cp\u003e== 判断的是 a 对象的值是否和 b 对象的值相等，是通过 value 来判断的。\u003c/p\u003e\n\u003ch3 id=\"with-的一般执行过程\"\u003ewith 的一般执行过程\u003c/h3\u003e\n\u003cp\u003e一段基本的 with 表达式，其结构是这样的：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewith expression as variable:\n    code_block\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e其中，expression可以是任意表达式，as variable 是可选的，其一般的执行过程是这样的：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e计算 expression，并获取一个上下文管理器。\u003c/li\u003e\n\u003cli\u003e上下文管理器的__exit()__方法被保存起来用于之后的调用。\u003c/li\u003e\n\u003cli\u003e调用上下文管理器的__enter()__方法。\u003c/li\u003e\n\u003cli\u003e如果 with 表达式包含 as variable，那么 expression 的返回值被赋值给 variable。\u003c/li\u003e\n\u003cli\u003e执行 code_block 中的表达式。\u003c/li\u003e\n\u003cli\u003e调用上下文管理器的__exit()__方法。如果code block的执行过程中发生了一个异常导致程序退出，那么异常的type、value和traceback（即sys.exc_info()的返回值）将作为参数传递给__exit()__方法，否则，将传递三个None。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e注意：\u003c/p\u003e\n\u003cp\u003e如果上下文管理器中没有 \u003cstrong\u003eenter()\u003c/strong\u003e 或者 \u003cstrong\u003eexit()\u003c/strong\u003e 中的任意一个方法，那么解释器会抛出一个 AttributeError 。\u003c/p\u003e\n\u003cp\u003e在 code_block 中发生异常后，如果 \u003cstrong\u003eexit()\u003c/strong\u003e 方法返回一个可被看成是 True 的值，那么这个异常就不会被抛出，后面的代码会继续执行。\u003c/p\u003e","date":1533686400,"description":"","fuzzywordcount":2600,"kind":"page","lang":"zh","lastmod":1533686400,"objectID":"df1fb52ffc98113e634309aae44635d4","publishdate":1533686400,"relpermalink":"/posts/programming/python/python-basic-knowledge/","section":"posts","summary":"\u003cp\u003e本篇博客介绍些 Python 常用的基础知识。\u003c/p\u003e","tags":["Python"],"title":"Python 常用基础知识","url":"https://xdhuxc.github.io/posts/programming/python/python-basic-knowledge/","wordcount":2599},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了使用 RabbitMQ 的过程中常见的问题及解决方法。\u003c/p\u003e\n\u003cp\u003e1、在虚拟机中启动 \u003ccode\u003erabbitmq\u003c/code\u003e 及管理插件后，使用 \u003ccode\u003eguest/guest\u003c/code\u003e 在浏览器中访问时，页面报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eUser can only log in via localhost \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e进入 \u003ccode\u003e/var/log/rabbitmq\u003c/code\u003e 中查看日志，日志中含有如下信息：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e2018-05-08 07:59:19.561 [warning] \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e0.681.0\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e HTTP access denied: user \u0026#39;guest\u0026#39; - User can only log in via localhost\n2018-05-08 07:59:27.904 [warning] \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e0.684.0\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e HTTP access denied: user \u0026#39;guest\u0026#39; - User can only log in via localhost\n2018-05-08 08:00:11.502 [warning] \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e0.709.0\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e HTTP access denied: user \u0026#39;guest\u0026#39; - User can only log in via localhost\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003erabbitmq从3.3.0\u003c/code\u003e 开始禁止使用 \u003ccode\u003eguest/guest\u003c/code\u003e 权限通过除 \u003ccode\u003elocalhost\u003c/code\u003e 外的访问。如果想使用 \u003ccode\u003eguest/guest\u003c/code\u003e 通过远程机器访问，\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003e/etc/rabbitmq\u003c/code\u003e 目录下创建 \u003ccode\u003erabbitmq.conf \u003c/code\u003e文件，添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eloopback_users = none # 表示允许默认用户 guest 在远程连接 rabbitmq-server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在 \u003ccode\u003eVMware workstation\u003c/code\u003e 中创建虚拟机，使用 \u003ccode\u003erpm\u003c/code\u003e 包方式安装 \u003ccode\u003eerlang\u003c/code\u003e 和 \u003ccode\u003erabbitmq-server\u003c/code\u003e ，在浏览器中使用net网卡IP地址访问时，只出现了部分界面，\u003c/p\u003e\n\u003cp\u003e没有显示全正常 \u003ccode\u003erabbitmq\u003c/code\u003e 管理界面；同时，使用 \u003ccode\u003ejava\u003c/code\u003e 编写的连接程序总是报错。\u003c/p\u003e\n\u003cp\u003e解决：关闭 \u003ccode\u003ewindows\u003c/code\u003e 防火墙，使用桥接网卡的 \u003ccode\u003eIP\u003c/code\u003e 地址访问 \u003ccode\u003erabbitmq\u003c/code\u003e 管理页面，显示正常。\u003c/p\u003e","date":1533513600,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1539734400,"objectID":"ed1af3ae075e1e34370dbe0ef51b9cec","publishdate":1533513600,"relpermalink":"/posts/message/rabbitmq/rabbitmq-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了使用 RabbitMQ 的过程中常见的问题及解决方法。\u003c/p\u003e","tags":["RabbitMQ"],"title":"RabbitMQ 常见问题及解决","url":"https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-questions-and-solutions/","wordcount":347},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了使用 docker 容器方式部署 RabbitMQ 的方法。\u003c/p\u003e\n\u003ch3 id=\"使用-docker-容器方式部署-rabbitmq\"\u003e使用 docker 容器方式部署 RabbitMQ\u003c/h3\u003e\n\u003cp\u003e1、拉取 rabbitmq 镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull rabbitmq:3.7.0\n或\ndocker pull rabbitmq:3.7.0-management # 附带管理界面\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动 rabbitmq 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -p 4369:4369 \\\n    -p 5671:5671 \\\n    -p 5672:5672 \\\n    -p 25672:25672 \\\n    --net host \\\n    --name rabbitmq \\\n    -v /home/xdhuxc/rabbitmq/data:/var/lib/rabbitmq \\\n    rabbitmq:3.7.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或 启动附带管理界面的 RabbitMQ 容器，修改默认的用户名和密码（guest/guest）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -p 4369:4369 \\\n    -p 5671:5671 \\\n    -p 5672:5672 \\\n    -p 15672:15672 \\\n    -p 25672:25672 \\\n    --net host \\\n    --name rabbitmq \\\n    -e RABBITMQ_DEFAULT_USER=xdhuxc \\\n    -e RABBITMQ_DEFAULT_PASS=123456 \\\n    -v /home/xdhuxc/rabbitmq/data:/var/lib/rabbitmq \\\n    rabbitmq:3.7.0-management\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --net host \\\n    --name rabbitmq \\\n    -e RABBITMQ_DEFAULT_USER=xdhuxc \\\n    -e RABBITMQ_DEFAULT_PASS=123456 \\\n    -v /home/xdhuxc/rabbitmq/data:/var/lib/rabbitmq \\\n    rabbitmq:3.7.4-management\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"使用-java-访问-rabbitmq\"\u003e使用 Java 访问 RabbitMQ\u003c/h3\u003e\n\u003cp\u003e测试代码如下：\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003epom.xml\u003c/code\u003e 中添加如下依赖：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edependencies\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"c\"\u003e\u0026lt;!-- https://mvnrepository.com/artifact/com.rabbitmq/amqp-client --\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ecom.rabbitmq\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eamqp-client\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e5.2.0\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"c\"\u003e\u0026lt;!-- https://mvnrepository.com/artifact/org.slf4j/slf4j-log4j12 --\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eorg.slf4j\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003egroupId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eslf4j-log4j12\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eartifactId\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e1.7.25\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eversion\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\t\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003escope\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003etest\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003escope\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\t\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edependency\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003edependencies\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e生产者代码示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage com.xdhuxc.cloud.app;\n\nimport java.io.IOException;\nimport java.util.concurrent.TimeoutException;\n\nimport com.rabbitmq.client.Channel;\nimport com.rabbitmq.client.Connection;\nimport com.rabbitmq.client.ConnectionFactory;\n\npublic class Producer {\n\t\n\tprivate final static String QUEUE_NAME = \u0026#34;xdhuxc\u0026#34;;\n\n\t/**\n\t \u003cspan class=\"k\"\u003e*\u003c/span\u003e \u003cspan class=\"ni\"\u003e@param\u003c/span\u003e args\n\t */\n\tpublic static void main(String[] args) {\n\t\t\n\t\tConnectionFactory factory = new ConnectionFactory();\n\t\tfactory.setHost(\u0026#34;192.168.91.128\u0026#34;);\n\t\tfactory.setPort(5672);\n\t\tfactory.setUsername(\u0026#34;guest\u0026#34;);\n\t\tfactory.setPassword(\u0026#34;guest\u0026#34;);\n\t\tfactory.setConnectionTimeout(50000);\n\t\tfactory.setRequestedHeartbeat(60);\n\t\tfactory.setVirtualHost(\u0026#34;/\u0026#34;);\n\t\tConnection conn = null;\n\t\tChannel channel = null;\n\t\t\n\t\ttry {\n\t\t\tconn = factory.newConnection();\n\t\t\tchannel = conn.createChannel();\n\t\t\tchannel.queueDeclare(QUEUE_NAME, false, false, false, null);\n\t\t\tString message = \u0026#34;Hello World!\u0026#34;;\n\t\t\tchannel.basicPublish(\u0026#34;\u0026#34;, QUEUE_NAME, null, message.getBytes());\n\t\t\tSystem.out.println(\u0026#34;Sent \u0026#34; + message);\n\t\t} catch (IOException | TimeoutException e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\ttry {\n\t\t\t\tif (conn != null) {\n\t\t\t\t\tconn.close();\n\t\t\t\t}\n\t\t\t\tif (channel != null) {\n\t\t\t\t\tchannel.close();\n\t\t\t\t}\n\t\t\t} catch (IOException | TimeoutException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e消费者示例代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epackage com.xdhuxc.cloud.app;\n\nimport java.io.IOException;\nimport java.util.concurrent.TimeoutException;\n\nimport com.rabbitmq.client.Channel;\nimport com.rabbitmq.client.Connection;\nimport com.rabbitmq.client.ConnectionFactory;\nimport com.rabbitmq.client.Consumer;\nimport com.rabbitmq.client.DefaultConsumer;\nimport com.rabbitmq.client.Envelope;\nimport com.rabbitmq.client.AMQP.BasicProperties;\n\npublic class Receiver {\n\n\tprivate final static String QUEUE_NAME = \u0026#34;xdhuxc\u0026#34;;\n\t\n\t/**\n\t \u003cspan class=\"k\"\u003e*\u003c/span\u003e \u003cspan class=\"ni\"\u003e@param\u003c/span\u003e args\n\t */\n\tpublic static void main(String[] args) {\n\t\tConnectionFactory factory = new ConnectionFactory();\n\t\tfactory.setHost(\u0026#34;192.168.91.128\u0026#34;);\n\t\tfactory.setPort(5672);\n\t\tfactory.setUsername(\u0026#34;guest\u0026#34;);\n\t\tfactory.setPassword(\u0026#34;guest\u0026#34;);\n\t\tConnection conn = null;\n\t\tChannel channel = null;\n\t\ttry {\n\t\t\tconn = factory.newConnection();\n\t\t\tchannel = conn.createChannel();\n\t\t\tchannel.queueDeclare(QUEUE_NAME, false, false, false, null);\n\t\t\tSystem.out.println(\u0026#34;正在等待接收消息！\u0026#34;);\n\t\t\tConsumer consumenr = new DefaultConsumer(channel) {\n\t\t\t\t\u003cspan class=\"ni\"\u003e@Override\u003c/span\u003e\n\t\t\t\tpublic void handleDelivery(String consumerTag, Envelope envelope, BasicProperties properties,\n\t\t\t\t\t\tbyte[] body) throws IOException {\n\t\t\t\t\tString message = new String(body, \u0026#34;UTF-8\u0026#34;);\n\t\t\t\t\tSystem.out.println(\u0026#34;Received \u0026#34; + message);\n\t\t\t\t}\n\t\t\t};\n\t\t\tchannel.basicConsume(QUEUE_NAME, true, consumenr);\n\t\t} catch (IOException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t} catch (TimeoutException e) {\n\t\t\t// TODO Auto-generated catch block\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\ttry {\n\t\t\t\tif (conn != null) {\n\t\t\t\t\tconn.close();\n\t\t\t\t}\n\t\t\t\tif (channel != null) {\n\t\t\t\t\tchannel.close();\n\t\t\t\t}\n\t\t\t} catch (IOException | TimeoutException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t}\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"相关问题\"\u003e相关问题\u003c/h3\u003e\n\u003cp\u003e1、启动 \u003ccode\u003erabbitmq\u003c/code\u003e 容器时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eError: Failed to initialize erlang distribution: \n{\n\t{\n\t\tshutdown,\n\t\t{\n\t\t\tfailed_to_start_child,\n\t\t\tnet_kernel,\n\t\t\t{\n\t\t\t\t\u0026#39;EXIT\u0026#39;,\n\t\t\t\tnodistribution\n\t\t\t}\n\t\t}\n\t},\n    {\n\t\tchild,\n\t\tundefined,\n\t\tnet_sup_dynamic,\n\t\t{\t\n\t\t\terl_distribution,\n\t\t\tstart_link,\n\t\t\t[\n\t\t\t\t[\u0026#39;rabbitmq-cli-24\u0026#39;,shortnames],\n\t\t\t\tfalse\n\t\t\t]\n\t\t},\n\t\tpermanent,\n\t\t1000,\n\t\tsupervisor,\n\t\t[erl_distribution]\n\t}\n}\nepmd_close\nProtocol \u0026#39;inet_tcp\u0026#39;: register/listen error:\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：安装 \u003ccode\u003eiptables\u003c/code\u003e 和 \u003ccode\u003eiptables.service\u003c/code\u003e，然后关闭 \u003ccode\u003eiptables\u003c/code\u003e，重新启动 \u003ccode\u003erabbitmq\u003c/code\u003e 容器即可。\u003c/p\u003e","date":1533513600,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1539734400,"objectID":"f636e016f0873d3e2b3aa5686b9124f3","publishdate":1533513600,"relpermalink":"/posts/message/rabbitmq/rabbitmq-docker-deployment/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了使用 docker 容器方式部署 RabbitMQ 的方法。\u003c/p\u003e","tags":["RabbitMQ","Docker"],"title":"使用 docker 容器方式部署 RabbitMQ","url":"https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-docker-deployment/","wordcount":866},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍了 Redis 的其他知识和技术，包括HyperLogLog、发布/订阅、事务等。\u003c/p\u003e\n\u003ch3 id=\"hyperloglog\"\u003eHyperLogLog\u003c/h3\u003e\n\u003ch4 id=\"hyperloglog-简介\"\u003eHyperLogLog 简介\u003c/h4\u003e\n\u003cp\u003eRedis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定的，并且是很小的。\u003c/p\u003e\n\u003cp\u003e在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基 数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。\u003c/p\u003e\n\u003cp\u003e但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。\u003c/p\u003e\n\u003cp\u003e基数的概念：\u003c/p\u003e\n\u003cp\u003e比如数据集 {1, 3, 5, 7, 5, 7, 8}， 那么这个数据集的基数集为 {1, 3, 5 ,7, 8}, 基数(不重复元素的个数)为 5。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e基数估计就是在误差可接受的范围内，快速计算基数。\u003c/code\u003e\u003c/p\u003e\n\u003ch4 id=\"hyperloglog命令\"\u003eHyperLogLog命令\u003c/h4\u003e\n\u003cp\u003eRedis HyperLogLog 的基本命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003epfadd key_name element_1 [element_2...]\u003c/td\u003e\n\u003ctd\u003e添加指定元素到 HyperLogLog 中\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003epfcount key_name_1 [key_name_2...]\u003c/td\u003e\n\u003ctd\u003e返回给定 HyperLogLog 的基数估算值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003epfmerge destination_key source_key [source_key...]\u003c/td\u003e\n\u003ctd\u003e将多个 HyperLogLog 合并为一个 HyperLogLog\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"redis发布订阅\"\u003eRedis发布/订阅\u003c/h3\u003e\n\u003ch4 id=\"发布订阅简介\"\u003e发布/订阅简介\u003c/h4\u003e\n\u003cp\u003eRedis 发布/订阅（publish/subscribe）是一种消息通信模式：发送者（publish）发送消息，订阅者（subscribe）接收消息。\u003c/p\u003e\n\u003cp\u003eRedis 发布/订阅（publish/subscribe）实现了消息系统，发送者(在redis术语中称为发布者)在接收者(订阅者)接收消息时发送消息。传送消息的链路称为信道。\u003c/p\u003e\n\u003cp\u003e在 Redis 中，客户端可以订阅任意数量的信道。\u003c/p\u003e\n\u003ch4 id=\"redis-发布订阅命令\"\u003eRedis 发布/订阅命令\u003c/h4\u003e\n\u003cp\u003eRedis 发布/订阅的基本命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003epsubscribe pattern_1 [pattern_2...]\u003c/td\u003e\n\u003ctd\u003e订阅一个或多个符合给定模式的频道\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003epubsub subcommand [argument_1 [argument_2...]]\u003c/td\u003e\n\u003ctd\u003e查看订阅与发布系统状态\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003epublish channel message\u003c/td\u003e\n\u003ctd\u003e将信息发送到指定的频道\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003epunsubscribe [pattern_1 [pattern_2...]]\u003c/td\u003e\n\u003ctd\u003e退订所有给定模式的频道\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003esubscribe channel_1 [channel_2...]\u003c/td\u003e\n\u003ctd\u003e订阅给定的一个或多个频道的信息\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003eunsubscribe [channel_1 [channel...]]\u003c/td\u003e\n\u003ctd\u003e退订给定的频道\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"redis-事务\"\u003eRedis 事务\u003c/h3\u003e\n\u003ch4 id=\"redis-事务简介\"\u003eRedis 事务简介\u003c/h4\u003e\n\u003cp\u003eRedis 事务可以一次执行多个命令， 并且带有以下两个重要的保证：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。\u003c/li\u003e\n\u003cli\u003e事务是一个原子操作：事务中的命令要么全部被执行，要么全部都不执行。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e一个事务从开始到执行会经历以下三个阶段：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e开始事务\u003c/li\u003e\n\u003cli\u003e命令入队\u003c/li\u003e\n\u003cli\u003e执行事务\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e一个事务先以 MULTI 开始一个事务， 然后将多个命令入队到事务中， 最后由 EXEC 命令触发事务， 一并执行事务中的所有命令。\u003c/p\u003e\n\u003ch4 id=\"redis-事务命令\"\u003eRedis 事务命令\u003c/h4\u003e\n\u003cp\u003eRedis 事务的基本命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003ediscard\u003c/td\u003e\n\u003ctd\u003e取消事务，放弃执行事务块内的所有命令\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003eexec\u003c/td\u003e\n\u003ctd\u003e执行所有事务块内的命令\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003emulti\u003c/td\u003e\n\u003ctd\u003e标记一个事务块的开始\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003eunwatch\u003c/td\u003e\n\u003ctd\u003e取消 WATCH 命令对所有键的监视\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003ewatch key_name_1 [key_name_2]\u003c/td\u003e\n\u003ctd\u003e监视一个或多个键  ，如果在事务执行之前这个(或这些) 键被其他命令所改动，那么事务将被打断\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"redis-连接\"\u003eRedis 连接\u003c/h3\u003e\n\u003cp\u003eRedis 连接命令主要用于连接 Redis 服务\u003c/p\u003e\n\u003cp\u003eRedis 连接的基本命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003eauth password\u003c/td\u003e\n\u003ctd\u003e验证密码是否正确\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003eecho message\u003c/td\u003e\n\u003ctd\u003e打印字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003eping\u003c/td\u003e\n\u003ctd\u003e查看服务是否运行\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003equit\u003c/td\u003e\n\u003ctd\u003e关闭当前连接\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003eselect index\u003c/td\u003e\n\u003ctd\u003e切换到指定的数据库\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"redis-服务器\"\u003eRedis 服务器\u003c/h3\u003e\n\u003cp\u003eRedis 服务器命令主要用于管理 Redis 服务，获取 Redis 服务器的统计信息：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e89\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e90\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e91\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e92\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e127.0.0.1:6379\u0026gt; info\n\u003cspan class=\"gh\"\u003e# Server\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eredis_version:3.0.503\nredis_git_sha1:00000000\nredis_git_dirty:0\nredis_build_id:d14575c6134f877\nredis_mode:standalone\nos:Windows\narch_bits:64\nmultiplexing_api:WinSock_IOCP\nprocess_id:7976\nrun_id:4ffccfe63ec3aae1b57ce8770582bd97a43651fb\ntcp_port:6379\nuptime_in_seconds:39\nuptime_in_days:0\nhz:10\nlru_clock:8298611\nconfig_file:\n\n\u003cspan class=\"gh\"\u003e# Clients\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003econnected_clients:1\nclient_longest_output_list:0\nclient_biggest_input_buf:0\nblocked_clients:0\n\n\u003cspan class=\"gh\"\u003e# Memory\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eused_memory:693000\nused_memory_human:676.76K\nused_memory_rss:655344\nused_memory_peak:693000\nused_memory_peak_human:676.76K\nused_memory_lua:36864\nmem_fragmentation_ratio:0.95\nmem_allocator:jemalloc-3.6.0\n\n\u003cspan class=\"gh\"\u003e# Persistence\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eloading:0\nrdb_changes_since_last_save:0\nrdb_bgsave_in_progress:0\nrdb_last_save_time:1501470796\nrdb_last_bgsave_status:ok\nrdb_last_bgsave_time_sec:-1\nrdb_current_bgsave_time_sec:-1\naof_enabled:0\naof_rewrite_in_progress:0\naof_rewrite_scheduled:0\naof_last_rewrite_time_sec:-1\naof_current_rewrite_time_sec:-1\naof_last_bgrewrite_status:ok\naof_last_write_status:ok\n\n\u003cspan class=\"gh\"\u003e# Stats\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003etotal_connections_received:1\ntotal_commands_processed:0\ninstantaneous_ops_per_sec:0\ntotal_net_input_bytes:14\ntotal_net_output_bytes:0\ninstantaneous_input_kbps:0.00\ninstantaneous_output_kbps:0.00\nrejected_connections:0\nsync_full:0\nsync_partial_ok:0\nsync_partial_err:0\nexpired_keys:0\nevicted_keys:0\nkeyspace_hits:0\nkeyspace_misses:0\npubsub_channels:0\npubsub_patterns:0\nlatest_fork_usec:0\nmigrate_cached_sockets:0\n\n\u003cspan class=\"gh\"\u003e# Replication\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003erole:master\nconnected_slaves:0\nmaster_repl_offset:0\nrepl_backlog_active:0\nrepl_backlog_size:1048576\nrepl_backlog_first_byte_offset:0\nrepl_backlog_histlen:0\n\n\u003cspan class=\"gh\"\u003e# CPU\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eused_cpu_sys:0.05\nused_cpu_user:0.06\nused_cpu_sys_children:0.00\nused_cpu_user_children:0.00\n\n\u003cspan class=\"gh\"\u003e# Cluster\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecluster_enabled:0\n\n\u003cspan class=\"gh\"\u003e# Keyspace\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb0:keys=1,expires=0,avg_ttl=0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"redis-服务器命令\"\u003eRedis 服务器命令\u003c/h4\u003e\n\u003cp\u003eRedis 服务器的相关命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003ebgrewriteaof\u003c/td\u003e\n\u003ctd\u003e异步执行一个 AOF（AppendOnly File） 文件重写操作\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003ebgsave\u003c/td\u003e\n\u003ctd\u003e在后台异步保存当前数据库的数据到磁盘\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003eclient kill [ip:port][ID client-id]\u003c/td\u003e\n\u003ctd\u003e关闭客户端连接\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003eclient list\u003c/td\u003e\n\u003ctd\u003e获取连接到服务器的客户端连接列表\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003eclient getname\u003c/td\u003e\n\u003ctd\u003e获取连接的名称\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003eclient pause timeout\u003c/td\u003e\n\u003ctd\u003e在指定时间内终止运行来自客户端的命令\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003eclient setname connection-name\u003c/td\u003e\n\u003ctd\u003e设置当前连接的名称\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003ecluster slots\u003c/td\u003e\n\u003ctd\u003e获取集群节点的映射数组\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003ecommand\u003c/td\u003e\n\u003ctd\u003e获取 Redis 命令详情数组\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003ecommand count\u003c/td\u003e\n\u003ctd\u003e获取 Redis 命令总数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003ecommand getkeys\u003c/td\u003e\n\u003ctd\u003e获取给定命令的所有键\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003etime\u003c/td\u003e\n\u003ctd\u003e返回当前服务器时间\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003ecommand info command-name [command-name...]\u003c/td\u003e\n\u003ctd\u003e获取指定 Redis 命令描述的数组\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e14\u003c/td\u003e\n\u003ctd\u003econfig get parameter\u003c/td\u003e\n\u003ctd\u003e获取指定配置参数的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e15\u003c/td\u003e\n\u003ctd\u003econfig rewrite\u003c/td\u003e\n\u003ctd\u003e对启动 Redis 服务器时所指定的 redis.conf 配置文件进行改写\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003econfig set parameter value\u003c/td\u003e\n\u003ctd\u003e修改 redis 配置参数，无需重启\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e17\u003c/td\u003e\n\u003ctd\u003econfig resetstat\u003c/td\u003e\n\u003ctd\u003e重置 INFO 命令中的某些统计数据\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e18\u003c/td\u003e\n\u003ctd\u003edbsize\u003c/td\u003e\n\u003ctd\u003e返回当前数据库的键的数量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e19\u003c/td\u003e\n\u003ctd\u003edebug object key_name\u003c/td\u003e\n\u003ctd\u003e获取key_name的调试信息\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e20\u003c/td\u003e\n\u003ctd\u003edebug segfault\u003c/td\u003e\n\u003ctd\u003e让 Redis 服务崩溃\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e21\u003c/td\u003e\n\u003ctd\u003eflushall\u003c/td\u003e\n\u003ctd\u003e删除所有数据库的所有键\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e22\u003c/td\u003e\n\u003ctd\u003eflushdb\u003c/td\u003e\n\u003ctd\u003e删除当前数据库的所有键\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e23\u003c/td\u003e\n\u003ctd\u003einfo [section]\u003c/td\u003e\n\u003ctd\u003e获取 Redis 服务器的各种信息和统计数值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e24\u003c/td\u003e\n\u003ctd\u003elastsave\u003c/td\u003e\n\u003ctd\u003e返回最近一次 Redis 成功将数据保存到磁盘上的时间，以 UNIX 时间戳格式表示\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e25\u003c/td\u003e\n\u003ctd\u003emonitor\u003c/td\u003e\n\u003ctd\u003e实时打印出 Redis 服务器接收到的命令，调试用\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e26\u003c/td\u003e\n\u003ctd\u003erole\u003c/td\u003e\n\u003ctd\u003e返回主从实例所属的角色\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e27\u003c/td\u003e\n\u003ctd\u003esave\u003c/td\u003e\n\u003ctd\u003e异步保存数据到硬盘\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e28\u003c/td\u003e\n\u003ctd\u003eshutdown [nosave][save]\u003c/td\u003e\n\u003ctd\u003e异步保存数据到硬盘，并关闭服务器\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e29\u003c/td\u003e\n\u003ctd\u003eslaveof hostname port\u003c/td\u003e\n\u003ctd\u003e将当前服务器转变为指定服务器的从属服务器(slave server)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e30\u003c/td\u003e\n\u003ctd\u003eslowlog subcommand [argument]\u003c/td\u003e\n\u003ctd\u003e管理 redis 的慢日志\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e31\u003c/td\u003e\n\u003ctd\u003esync\u003c/td\u003e\n\u003ctd\u003e用于复制功能(replication)的内部命令\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e","date":1533340800,"description":"","fuzzywordcount":1900,"kind":"page","lang":"zh","lastmod":1538006400,"objectID":"dae86787c77f4fc82e710affe1bc92e2","publishdate":1533340800,"relpermalink":"/posts/storage/redis/redis-others/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍了 Redis 的其他知识和技术，包括HyperLogLog、发布/订阅、事务等。\u003c/p\u003e","tags":["Redis","数据库"],"title":"Redis 其他知识和技术","url":"https://xdhuxc.github.io/posts/storage/redis/redis-others/","wordcount":1887},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍了 Redis 的安装和配置参数的详细含义。\u003c/p\u003e\n\u003ch3 id=\"在-linux-中安装-redis\"\u003e在 Linux 中安装 Redis\u003c/h3\u003e\n\u003cp\u003e1、使用如下命令下载并解压Redis安装包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ wget http://download.redis.io/releases/redis-4.0.1.tar.gz\n$ tar -zxf redis-4.0.1.tar.gz\n$ cd redis-4.0.1\n$ make\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 make 时，出现如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost redis-4.0.1]# make\ncd src \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make all\nmake[1]: Entering directory \u003cspan class=\"sb\"\u003e`/home/application/redis-4.0.1/src\u0026#39;\n\u003c/span\u003e\u003cspan class=\"sb\"\u003e    CC adlist.o\n\u003c/span\u003e\u003cspan class=\"sb\"\u003eIn file included from adlist.c:34:0:\n\u003c/span\u003e\u003cspan class=\"sb\"\u003ezmalloc.h:50:31: fatal error: jemalloc/jemalloc.h: No such file or directory\n\u003c/span\u003e\u003cspan class=\"sb\"\u003e #include \u0026lt;jemalloc/jemalloc.h\u0026gt;\n\u003c/span\u003e\u003cspan class=\"sb\"\u003e                               ^\n\u003c/span\u003e\u003cspan class=\"sb\"\u003ecompilation terminated.\n\u003c/span\u003e\u003cspan class=\"sb\"\u003emake[1]: *** [adlist.o] Error 1\n\u003c/span\u003e\u003cspan class=\"sb\"\u003emake[1]: Leaving directory `\u003c/span\u003e/home/application/redis-4.0.1/src\u0026#39;\nmake: \u003cspan class=\"ge\"\u003e**\u003c/span\u003e* [all] Error 2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eAllocator  \n---------  \n \nSelecting a non-default memory allocator when building Redis is done by setting  \nthe \u003cspan class=\"sb\"\u003e`MALLOC`\u003c/span\u003e environment variable. Redis is compiled and linked against libc  \nmalloc by default, with the exception of jemalloc being the default on Linux  \nsystems. This default was picked because jemalloc has proven to have fewer  \nfragmentation problems than libc malloc.  \n \nTo force compiling against libc malloc, use:  \n \n    % make MALLOC=libc  \n \nTo compile against jemalloc on Mac OS X systems, use:  \n \n    % make MALLOC=jemalloc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e使用如下命令进行make操作\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emake MALLOC=libc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e之后在 make 的时候提示如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecc: error: ../deps/hiredis/libhiredis.a: No such file or directory\ncc: error: ../deps/lua/src/liblua.a: No such file or directory\nmake[1]: \u003cspan class=\"ge\"\u003e**\u003c/span\u003e* [redis-server] Error 1\nmake[1]: Leaving directory `/home/application/redis-4.0.1/src\u0026#39;\nmake: \u003cspan class=\"ge\"\u003e**\u003c/span\u003e* [all] Error 2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e进入Redis安装目录下的deps目录下，执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emake lua hiredis linenoise\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003emake之后，可以运行测试，确认Redis的功能是否正常，使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emake test\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e出现如下报错：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost redis-4.0.1]# make test\ncd src \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make test\nmake[1]: Entering directory \u003cspan class=\"sb\"\u003e`/home/application/redis-4.0.1/src\u0026#39;\n\u003c/span\u003e\u003cspan class=\"sb\"\u003e    CC Makefile.dep\n\u003c/span\u003e\u003cspan class=\"sb\"\u003emake[1]: Leaving directory `\u003c/span\u003e/home/application/redis-4.0.1/src\u0026#39;\nmake[1]: Entering directory \u003cspan class=\"sb\"\u003e`/home/application/redis-4.0.1/src\u0026#39;\n\u003c/span\u003e\u003cspan class=\"sb\"\u003eYou need tcl 8.5 or newer in order to run the Redis test\n\u003c/span\u003e\u003cspan class=\"sb\"\u003emake[1]: *** [test] Error 1\n\u003c/span\u003e\u003cspan class=\"sb\"\u003emake[1]: Leaving directory `\u003c/span\u003e/home/application/redis-4.0.1/src\u0026#39;\nmake: \u003cspan class=\"ge\"\u003e**\u003c/span\u003e* [test] Error 2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e根据提示安装tcl 8.5及以上版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget http://downloads.sourceforge.net/tcl/tcl8.6.1-src.tar.gz\ntar -zxf tcl8.6.1-src.tar.gz\ncd /home/application/tcl8.6.1/unix/\nsudo ./configure\nsudo make\nsudo make install\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、make 完后，redis-2.8.17 目录下会出现编译后的 redis 服务程序 \u003ccode\u003eredis-server\u003c/code\u003e，还有用于测试的客户端程序\u003ccode\u003eredis-cli\u003c/code\u003e，两个程序位于安装目录\u003ccode\u003esrc\u003c/code\u003e目录下，\n启动redis服务：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ cd src\n$ ./redis-server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这种方式启动redis使用的是默认配置。也可以通过启动参数告诉redis使用指定配置文件使用下面命令启动。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ cd src\n$ ./redis-server redis.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eredis.conf 是一个默认的配置文件，可以根据需要使用自己的配置文件。\u003c/p\u003e\n\u003cp\u003e3、启动 redis 服务进程后，就可以使用测试客户端程序 redis-cli 和 redis 服务交互了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ cd src\n$ ./redis-cli\nredis\u0026gt; set abc def\nOK\nredis\u0026gt; get abc\n\u0026#34;def\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"在-windows-下安装-redis\"\u003e在 Windows 下安装 Redis\u003c/h3\u003e\n\u003cp\u003e1、Redis 支持 32 位和 64 位。这个需要根据你系统平台的实际情况选择，这里我们下载 \u003ccode\u003eRedis-x64-xxx.zip\u003c/code\u003e 压缩包到C盘，解压后，将文件夹重新命名为 redis。\n\u003cimg src=\"http://www.runoob.com/wp-content/uploads/2014/11/3B8D633F-14CE-42E3-B174-FCCD48B11FF3.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e2、打开一个 cmd 窗口 使用 cd 命令切换目录到 \u003ccode\u003eC:\\redis\u003c/code\u003e 运行 \u003ccode\u003eredis-server.exe redis.windows.conf\u003c/code\u003e。如果想方便的话，可以把 redis 的路径加到系统的环境变量里，这样就省得再输路径了，后面的那个 \u003ccode\u003eredis.windows.conf\u003c/code\u003e 可以省略，如果省略，会启用默认的。输入之后，会显示如下界面：\n\u003cimg src=\"http://www.runoob.com/wp-content/uploads/2014/11/redis-install1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e3、此时另启一个 cmd 窗口，原来的不要关闭，否则就无法访问服务端了。\n切换到 redis 目录下运行 \u003ccode\u003eredis-cli.exe -h 127.0.0.1 -p 6379\u003c/code\u003e。\n\u003cimg src=\"http://www.runoob.com/wp-content/uploads/2014/11/redis-install2.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch3 id=\"在命令行中查询配置-redis-参数\"\u003e在命令行中查询配置 Redis 参数\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eRedis 的配置文件位于 Redis 安装目录下，文件名为 redis.conf。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、可以使用 \u003ccode\u003econfig\u003c/code\u003e 命令查看或者设置配置项，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis 127.0.0.1:6379\u0026gt; config get loglevel\n1) \u0026#34;loglevel\u0026#34;\n2) \u0026#34;notice\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、使用\u003ccode\u003e*\u003c/code\u003e获取所有配置项\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e  1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 89\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 90\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 91\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 92\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 93\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 94\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 95\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 96\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 97\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 98\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 99\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e100\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e101\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e102\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e103\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e104\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e105\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e106\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e107\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e108\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e109\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e110\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e111\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e112\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e113\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e114\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e115\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e116\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e117\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e118\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e119\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e120\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e121\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e122\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e123\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e124\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e125\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e126\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e127\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e128\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e129\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e130\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e131\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e127.0.0.1:6379\u0026gt; config get *\n  1) \u0026#34;dbfilename\u0026#34;\n  2) \u0026#34;dump.rdb\u0026#34;\n  3) \u0026#34;requirepass\u0026#34;\n  4) \u0026#34;\u0026#34;\n  5) \u0026#34;masterauth\u0026#34;\n  6) \u0026#34;\u0026#34;\n  7) \u0026#34;unixsocket\u0026#34;\n  8) \u0026#34;\u0026#34;\n  9) \u0026#34;logfile\u0026#34;\n 10) \u0026#34;\u0026#34;\n 11) \u0026#34;pidfile\u0026#34;\n 12) \u0026#34;/var/run/redis.pid\u0026#34;\n 13) \u0026#34;maxmemory\u0026#34;\n 14) \u0026#34;0\u0026#34;\n 15) \u0026#34;maxmemory-samples\u0026#34;\n 16) \u0026#34;5\u0026#34;\n 17) \u0026#34;timeout\u0026#34;\n 18) \u0026#34;0\u0026#34;\n 19) \u0026#34;tcp-keepalive\u0026#34;\n 20) \u0026#34;0\u0026#34;\n 21) \u0026#34;auto-aof-rewrite-percentage\u0026#34;\n 22) \u0026#34;100\u0026#34;\n 23) \u0026#34;auto-aof-rewrite-min-size\u0026#34;\n 24) \u0026#34;67108864\u0026#34;\n 25) \u0026#34;hash-max-ziplist-entries\u0026#34;\n 26) \u0026#34;512\u0026#34;\n 27) \u0026#34;hash-max-ziplist-value\u0026#34;\n 28) \u0026#34;64\u0026#34;\n 29) \u0026#34;list-max-ziplist-entries\u0026#34;\n 30) \u0026#34;512\u0026#34;\n 31) \u0026#34;list-max-ziplist-value\u0026#34;\n 32) \u0026#34;64\u0026#34;\n 33) \u0026#34;set-max-intset-entries\u0026#34;\n 34) \u0026#34;512\u0026#34;\n 35) \u0026#34;zset-max-ziplist-entries\u0026#34;\n 36) \u0026#34;128\u0026#34;\n 37) \u0026#34;zset-max-ziplist-value\u0026#34;\n 38) \u0026#34;64\u0026#34;\n 39) \u0026#34;hll-sparse-max-bytes\u0026#34;\n 40) \u0026#34;3000\u0026#34;\n 41) \u0026#34;lua-time-limit\u0026#34;\n 42) \u0026#34;5000\u0026#34;\n 43) \u0026#34;slowlog-log-slower-than\u0026#34;\n 44) \u0026#34;10000\u0026#34;\n 45) \u0026#34;latency-monitor-threshold\u0026#34;\n 46) \u0026#34;0\u0026#34;\n 47) \u0026#34;slowlog-max-len\u0026#34;\n 48) \u0026#34;128\u0026#34;\n 49) \u0026#34;port\u0026#34;\n 50) \u0026#34;6379\u0026#34;\n 51) \u0026#34;tcp-backlog\u0026#34;\n 52) \u0026#34;511\u0026#34;\n 53) \u0026#34;databases\u0026#34;\n 54) \u0026#34;16\u0026#34;\n 55) \u0026#34;repl-ping-slave-period\u0026#34;\n 56) \u0026#34;10\u0026#34;\n 57) \u0026#34;repl-timeout\u0026#34;\n 58) \u0026#34;60\u0026#34;\n 59) \u0026#34;repl-backlog-size\u0026#34;\n 60) \u0026#34;1048576\u0026#34;\n 61) \u0026#34;repl-backlog-ttl\u0026#34;\n 62) \u0026#34;3600\u0026#34;\n 63) \u0026#34;maxclients\u0026#34;\n 64) \u0026#34;10000\u0026#34;\n 65) \u0026#34;watchdog-period\u0026#34;\n 66) \u0026#34;0\u0026#34;\n 67) \u0026#34;slave-priority\u0026#34;\n 68) \u0026#34;100\u0026#34;\n 69) \u0026#34;min-slaves-to-write\u0026#34;\n 70) \u0026#34;0\u0026#34;\n 71) \u0026#34;min-slaves-max-lag\u0026#34;\n 72) \u0026#34;10\u0026#34;\n 73) \u0026#34;hz\u0026#34;\n 74) \u0026#34;10\u0026#34;\n 75) \u0026#34;cluster-node-timeout\u0026#34;\n 76) \u0026#34;15000\u0026#34;\n 77) \u0026#34;cluster-migration-barrier\u0026#34;\n 78) \u0026#34;1\u0026#34;\n 79) \u0026#34;cluster-slave-validity-factor\u0026#34;\n 80) \u0026#34;10\u0026#34;\n 81) \u0026#34;repl-diskless-sync-delay\u0026#34;\n 82) \u0026#34;5\u0026#34;\n 83) \u0026#34;cluster-require-full-coverage\u0026#34;\n 84) \u0026#34;yes\u0026#34;\n 85) \u0026#34;no-appendfsync-on-rewrite\u0026#34;\n 86) \u0026#34;no\u0026#34;\n 87) \u0026#34;slave-serve-stale-data\u0026#34;\n 88) \u0026#34;yes\u0026#34;\n 89) \u0026#34;slave-read-only\u0026#34;\n 90) \u0026#34;yes\u0026#34;\n 91) \u0026#34;stop-writes-on-bgsave-error\u0026#34;\n 92) \u0026#34;yes\u0026#34;\n 93) \u0026#34;daemonize\u0026#34;\n 94) \u0026#34;no\u0026#34;\n 95) \u0026#34;rdbcompression\u0026#34;\n 96) \u0026#34;yes\u0026#34;\n 97) \u0026#34;rdbchecksum\u0026#34;\n 98) \u0026#34;yes\u0026#34;\n 99) \u0026#34;activerehashing\u0026#34;\n100) \u0026#34;yes\u0026#34;\n101) \u0026#34;repl-disable-tcp-nodelay\u0026#34;\n102) \u0026#34;no\u0026#34;\n103) \u0026#34;repl-diskless-sync\u0026#34;\n104) \u0026#34;no\u0026#34;\n105) \u0026#34;aof-rewrite-incremental-fsync\u0026#34;\n106) \u0026#34;yes\u0026#34;\n107) \u0026#34;aof-load-truncated\u0026#34;\n108) \u0026#34;yes\u0026#34;\n109) \u0026#34;appendonly\u0026#34;\n110) \u0026#34;no\u0026#34;\n111) \u0026#34;dir\u0026#34;\n112) \u0026#34;C:\\\\redis\u0026#34;\n113) \u0026#34;maxmemory-policy\u0026#34;\n114) \u0026#34;noeviction\u0026#34;\n115) \u0026#34;appendfsync\u0026#34;\n116) \u0026#34;everysec\u0026#34;\n117) \u0026#34;save\u0026#34;\n118) \u0026#34;jd 900 jd 300 jd 60\u0026#34;\n119) \u0026#34;loglevel\u0026#34;\n120) \u0026#34;notice\u0026#34;\n121) \u0026#34;client-output-buffer-limit\u0026#34;\n122) \u0026#34;normal 0 0 0 slave 268435456 67108864 60 pubsub 33554432 8388608 60\u0026#34;\n123) \u0026#34;unixsocketperm\u0026#34;\n124) \u0026#34;0\u0026#34;\n125) \u0026#34;slaveof\u0026#34;\n126) \u0026#34;\u0026#34;\n127) \u0026#34;notify-keyspace-events\u0026#34;\n128) \u0026#34;\u0026#34;\n129) \u0026#34;bind\u0026#34;\n130) \u0026#34;\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、可以通过修改\u003ccode\u003eredis.conf\u003c/code\u003e或者\u003ccode\u003econfig set\u003c/code\u003e命令来修改配置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis 127.0.0.1:6379\u0026gt; config set loglevel \u0026#34;notice\u0026#34;\nOK\nredis 127.0.0.1:6379\u0026gt; config get loglevel\n1) \u0026#34;loglevel\u0026#34;\n2) \u0026#34;notice\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch1 id=\"四redis参数说明httpwwwrunoobcomredisredis-confhtml\"\u003e四、\u003ca href=\"http://www.runoob.com/redis/redis-conf.html\"\u003eRedis参数说明\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eredis.conf配置项说明如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edaemonize no：Redis 默认不是以守护进程的方式运行，可以通过该配置项修改，使用 yes 启用守护进程\u003c/li\u003e\n\u003cli\u003epidfile /var/run/redis.pid：当Redis以守护进程方式运行时，Redis 默认会把 pid 写入 /var/run/redis.pid 文件，可以通过 pidfile 指定\u003c/li\u003e\n\u003cli\u003eport 6379：指定Redis监听端口，默认端口为6379。\u003c/li\u003e\n\u003cli\u003ebind 127.0.0.1：绑定的主机地址\u003c/li\u003e\n\u003cli\u003etimeout 300：当客户端闲置多长时间后关闭连接，如果指定为0，表示关闭该功能\u003c/li\u003e\n\u003cli\u003eloglevel verbose：指定日志记录级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为verbose\u003c/li\u003e\n\u003cli\u003elogfile stdout：日志记录方式，默认为标准输出，如果配置Redis为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给/dev/null\u003c/li\u003e\n\u003cli\u003edatabases 16：设置数据库的数量，默认数据库为0，可以使用SELECT \u003cdbid\u003e命令在连接上指定数据库id\u003c/li\u003e\n\u003cli\u003esave \u003cseconds\u003e \u003cchanges\u003e：指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合，Redis默认配置文件中提供了三个条件：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esave 900 1\nsave 300 10\nsave 60 10000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e分别表示900秒（15分钟）内有1个更改，300秒（5分钟）内有10个更改以及60秒内有10000个更改。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003erdbcompression yes：指定存储至本地数据库时是否压缩数据，默认为yes，Redis采用LZF压缩，如果为了节省CPU时间，可以关闭该选项，但会导致数据库文件变的巨大\u003c/li\u003e\n\u003cli\u003edbfilename dump.rdb：指定本地数据库文件名，默认值为dump.rdb。dump.rdb是由Redis服务器自动生成的 默认情况下 每隔一段时间redis服务器程序会自动对数据库做一次遍历，把内存快照写在一个叫做“dump.rdb”的文件里，这个持久化机制叫做SNAPSHOT。有了SNAPSHOT后，如果服务器宕机，重新启动redis服务器程序时redis会自动加载dump.rdb，将数据库状态恢复到上一次做SNAPSHOT时的状态。\u003c/li\u003e\n\u003cli\u003edir ./：指定本地数据库存放目录\u003c/li\u003e\n\u003cli\u003eslaveof \u003cmasterip\u003e \u003cmasterport\u003e：设置当本机为slav服务时，设置master服务的IP地址及端口，在Redis启动时，它会自动从master进行数据同步\u003c/li\u003e\n\u003cli\u003emasterauth \u003cmaster-password\u003e：当master服务设置了密码保护时，slave服务连接master的密码\u003c/li\u003e\n\u003cli\u003erequirepass foobared：设置Redis连接密码，如果配置了连接密码，客户端在连接Redis时需要通过AUTH \u003cpassword\u003e命令提供密码，默认关闭\u003c/li\u003e\n\u003cli\u003emaxclients 128：设置同一时间最大客户端连接数，默认无限制，Redis可以同时打开的客户端连接数为Redis进程可以打开的最大文件描述符数，如果设置 maxclients 0，表示不作限制。当客户端连接数到达限制时，Redis会关闭新的连接并向客户端返回max number of clients reached错误信息。\u003c/li\u003e\n\u003cli\u003emaxmemory \u003cbytes\u003e：指定Redis最大内存限制，Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis新的vm机制，会把Key存放内存，Value会存放在swap区。\u003c/li\u003e\n\u003cli\u003eappendonly no：指定是否在每次更新操作后进行日志记录，Redis在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为 redis本身同步数据文件是按上面save条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为no\u003c/li\u003e\n\u003cli\u003eappendfilename appendonly.aof：指定更新日志文件名，默认为appendonly.aof\u003c/li\u003e\n\u003cli\u003eappendfsync everysec：指定更新日志条件，共有3个可选值：\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e1、no：表示等操作系统进行数据缓存同步到磁盘（快） \n2、always：表示每次更新操作后手动调用fsync()将数据写到磁盘（慢，安全） \n3、everysec：表示每秒同步一次（折衷，默认值）\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cul\u003e\n\u003cli\u003evm-enabled no：指定是否启用虚拟内存机制，默认值为no，VM机制将数据分页存放，由Redis将访问量较少的页即冷数据swap到磁盘上，访问多的页面由磁盘自动换出到内存中。\u003c/li\u003e\n\u003cli\u003evm-swap-file /tmp/redis.swap：虚拟内存文件路径，默认值为/tmp/redis.swap，不可多个Redis实例共享\u003c/li\u003e\n\u003cli\u003evm-max-memory 0：将所有大于vm-max-memory的数据存入虚拟内存,无论vm-max-memory设置多小,所有索引数据都是内存存储的(Redis的索引数据就是keys),也就是说,当vm-max-memory设置为0的时候,其实是所有value都存在于磁盘。默认值为0。\u003c/li\u003e\n\u003cli\u003evm-page-size 32：Redis swap文件分成了很多的页，一个对象可以保存在多个页上面，但一个页上不能被多个对象共享，vm-page-size是要根据存储的数据大小来设定的，如果存储很多小对象，页的大小最好设置为32字节或者64字节；如果存储很大的大对象，则可以使用更大的页，如果不确定，就使用默认值。\u003c/li\u003e\n\u003cli\u003evm-pages 134217728：设置swap文件中的页的数量，由于页表（一种表示页面空闲或使用的bitmap）是在放在内存中的，在磁盘上每8个页将消耗1字节的内存。\u003c/li\u003e\n\u003cli\u003evm-max-threads 4：设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为0,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4\u003c/li\u003e\n\u003cli\u003eglueoutputbuf yes：设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启\u003c/li\u003e\n\u003cli\u003e指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehash-max-zipmap-entries 64\nhash-max-zipmap-value 512\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eactiverehashing yes：指定是否激活重置哈希，默认为开启\u003c/li\u003e\n\u003cli\u003einclude /path/to/local.conf：指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件\u003c/li\u003e\n\u003c/ul\u003e","date":1533340800,"description":"","fuzzywordcount":3900,"kind":"page","lang":"zh","lastmod":1538006400,"objectID":"cef9f0e35ad33c71ffe7a7e9e9e83dcb","publishdate":1533340800,"relpermalink":"/posts/storage/redis/redis-install-and-configuration/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍了 Redis 的安装和配置参数的详细含义。\u003c/p\u003e","tags":["Redis","数据库"],"title":"Redis 安装和配置详解","url":"https://xdhuxc.github.io/posts/storage/redis/redis-install-and-configuration/","wordcount":3855},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍了 Redis 的部分高级技术，包括数据备份和恢复、安全、性能测试、分区等。\u003c/p\u003e\n\u003ch3 id=\"redis-数据备份与恢复\"\u003eRedis 数据备份与恢复\u003c/h3\u003e\n\u003ch4 id=\"redis-数据备份\"\u003eRedis 数据备份\u003c/h4\u003e\n\u003cp\u003eRedis 的 save 命令用于创建当前数据库的备份\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003eredis save\u003c/code\u003e 命令来备份 redis 数据：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis 127.0.0.1:6379\u0026gt; save\nOK\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e该命令将在 \u003ccode\u003eredis\u003c/code\u003e 安装目录中创建 \u003ccode\u003edump.rdb\u003c/code\u003e 文件\u003c/p\u003e\n\u003cp\u003e创建 redis 备份文件也可以使用命令 bgsave，该命令在后台执行。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e127.0.0.1:6379\u0026gt; bgsave\nBackground saving started\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"redis-数据恢复\"\u003eRedis 数据恢复\u003c/h4\u003e\n\u003cp\u003e如果需要恢复数据，只需将备份文件 \u003ccode\u003edump.rdb\u003c/code\u003e 移动到 redis 安装目录并启动服务即可。\u003c/p\u003e\n\u003cp\u003e获取 \u003ccode\u003eredis\u003c/code\u003e 目录可以使用 \u003ccode\u003econfig\u003c/code\u003e 命令，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis 127.0.0.1:6379\u0026gt; config get dir\n1) \u0026#34;dir\u0026#34;\n2) \u0026#34;/usr/local/redis/bin\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003econfig get dir\u003c/code\u003e 输出的 \u003ccode\u003eredis\u003c/code\u003e 安装目录为：\u003ccode\u003e/usr/local/redis/bin\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"redis-安全\"\u003eRedis 安全\u003c/h3\u003e\n\u003cp\u003e可以通过 redis 的配置文件设置密码参数，这样客户端连接到 redis 服务就需要密码验证，这样可以让 redis 服务更安全。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e127.0.0.1:6379\u0026gt; config get requirepass\n1) \u0026#34;require\u0026#34;\n2) \u0026#34;\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e默认情况下 requirepass 参数是空的，这就意味着无需通过密码验证就可以连接到 redis 服务。\n可以通过以下命令来修改该参数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e127.0.0.1:6379\u0026gt; config set requirepass \u0026#34;abcdef\u0026#34;\nOK\n127.0.0.1:6379\u0026gt; config get requirepass\n1) \u0026#34;requirepass\u0026#34;\n2) \u0026#34;abcdef\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e设置密码后，客户端连接 redis 服务就需要密码验证，否则无法执行命令。\u003c/p\u003e\n\u003cp\u003eauth 命令基本语法格式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e127.0.0.1:6379\u0026gt; auth password\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e示例\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e127.0.0.1:6379\u0026gt; auth \u0026#34;abcdef\u0026#34;\nOK\n127.0.0.1:6379\u0026gt; set xkey \u0026#34;MyValue\u0026#34;\nOK\n127.0.0.1:6379\u0026gt; get xkey\n\u0026#34;MyValue\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"redis-性能测试\"\u003eRedis 性能测试\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eRedis 性能测试是通过同时执行多个命令实现的。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eredis 性能测试的基本命令如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis-benchmark [option] [option value]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e同时执行 10000 个请求来检测性能\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis-benchmark -n 10000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eRedis 性能测试工具可选参数如下所示：\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e选项\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003cth\u003e默认值\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003e-h\u003c/td\u003e\n\u003ctd\u003e指定服务器主机名\u003c/td\u003e\n\u003ctd\u003e127.0.0.1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003e-p\u003c/td\u003e\n\u003ctd\u003e指定服务器端口\u003c/td\u003e\n\u003ctd\u003e6379\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003e-s\u003c/td\u003e\n\u003ctd\u003e指定服务器 socket\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003e-c\u003c/td\u003e\n\u003ctd\u003e指定并发连接数\u003c/td\u003e\n\u003ctd\u003e50\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003e-n\u003c/td\u003e\n\u003ctd\u003e指定请求数\u003c/td\u003e\n\u003ctd\u003e10000\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003e-d\u003c/td\u003e\n\u003ctd\u003e以字节的形式指定 SET/GET 值的数据大小\u003c/td\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003e-k\u003c/td\u003e\n\u003ctd\u003e1=keep alive 0=reconnect\u003c/td\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003e-r\u003c/td\u003e\n\u003ctd\u003eSET/GET/INCR 使用随机 key, SADD 使用随机值\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003e-P\u003c/td\u003e\n\u003ctd\u003e通过管道传输 \u003cnumreq\u003e 请求\u003c/td\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003e-q\u003c/td\u003e\n\u003ctd\u003e强制退出 redis。仅显示 query/sec 值\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003e--csv\u003c/td\u003e\n\u003ctd\u003e以 CSV 格式输出\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003e-l\u003c/td\u003e\n\u003ctd\u003e生成循环，永久执行测试\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003e-t\u003c/td\u003e\n\u003ctd\u003e仅运行以逗号分隔的测试命令列表\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e14\u003c/td\u003e\n\u003ctd\u003e-L\u003c/td\u003e\n\u003ctd\u003eIdle 模式。仅打开 N 个 idle 连接并等待\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e使用多个参数来测试 redis 的性能\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis-benchmark -h 127.0.0.1 -p 6379 -t set,lpush -n 10000 -q\nSET: 2131.74 requests per second\nLPUSH: 2257.34 requests per second\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"redis-客户端连接\"\u003eRedis 客户端连接\u003c/h3\u003e\n\u003cp\u003eRedis 通过监听一个 TCP 端口或者 Unix socket 的方式来接收来自客户端的连接，当一个连接建立后，Redis 内部会进行以下一些操作：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e首先，客户端 socket 会被设置为非阻塞模式，因为 Redis 在网络事件处理上采用的是非阻塞多路复用模型。\u003c/li\u003e\n\u003cli\u003e然后为这个 socket 设置 TCP_NODELAY 属性，禁用 Nagle 算法\u003c/li\u003e\n\u003cli\u003e然后创建一个可读的文件事件用于监听这个客户端 socket 的数据发送\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e最大连接数 maxclients 的默认值是 10000，也可以在 redis.conf 中进行设置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econfig get maxclients \n1) \u0026#34;maxclients\u0026#34;\n2) \u0026#34;10000\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在服务启动时设置最大连接数为 100000\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis-server --maxclients 10000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e客户端命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003eclient list\u003c/td\u003e\n\u003ctd\u003e返回连接到 redis 服务的客户端列表\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003eclient setname\u003c/td\u003e\n\u003ctd\u003e设置当前连接的名称\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003eclient getname\u003c/td\u003e\n\u003ctd\u003e获取通过 CLIENT SETNAME 命令设置的服务名称\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003eclient pause\u003c/td\u003e\n\u003ctd\u003e挂起客户端连接，指定挂起的时间以毫秒计\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003eclient kill\u003c/td\u003e\n\u003ctd\u003e关闭客户端连接\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"redis-管道技术\"\u003eRedis 管道技术\u003c/h3\u003e\n\u003cp\u003eRedis 是一种基于客户端-服务端模型以及请求/响应协议的 TCP 服务，这意味着通常情况下一个请求会遵循以下步骤：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e客户端向服务端发送一个查询请求，并监听 socket 返回，通常是以阻塞模式，等待服务端响应。\u003c/li\u003e\n\u003cli\u003e服务端处理命令，并将结果返回给客户端。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eRedis 管道技术可以在服务端未响应时，客户端可以继续向服务端发送请求，并最终一次性读取所有服务端的响应。\u003c/p\u003e\n\u003cp\u003e示例\n查看 redis 管道，只需要启动 redis 实例并输入以下命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$(echo -en \u0026#34;ping\\r\\n SET x_key redis\\r\\nGET runoobkey\\r\\nINCR visitor\\r\\nINCR visitor\\r\\nINCR visitor\\r\\n\u0026#34;; sleep 10) | nc localhost 6379\n\n+PONG\n+OK\nredis\n:1\n:2\n:3\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上示例中，通过使用 ping 命令查看redis服务是否可用，之后设置了 x_key 的值为 redis，然后获取 x_key 的值并使得 visitor 自增 3 次。\n在返回的结果中，可以看到这些命令一次性向 redis 服务提交，并最终一次性读取所有服务端的响应\u003c/p\u003e\n\u003cp\u003e管道技术最显著的优势是提高了 redis 服务的性能。\u003c/p\u003e\n\u003ch3 id=\"redis-分区\"\u003eRedis 分区\u003c/h3\u003e\n\u003cp\u003e分区是分割数据到多个 Redis 实例的处理过程，因此每个实例只保存 key 的一个子集。\u003c/p\u003e\n\u003ch4 id=\"分区的优势和不足\"\u003e分区的优势和不足\u003c/h4\u003e\n\u003cp\u003e1、分区的优势\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e通过利用多台计算机内存的和值，允许我们构造更大的数据库。\u003c/li\u003e\n\u003cli\u003e通过多核和多台计算机，允许我们扩展计算能力\u003c/li\u003e\n\u003cli\u003e通过多台计算机和网络适配器，允许我们扩展网络带宽。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2、分区的不足\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eredis的一些特性在分区方面表现的不是很好：\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e涉及多个 key 的操作通常是不被支持的。举例来说，当两个 set 映射到不同的 redis 实例上时，你就不能对这两个 set 执行交集操作\u003c/li\u003e\n\u003cli\u003e涉及多个 key 的 redis 事务不能使用\u003c/li\u003e\n\u003cli\u003e当使用分区时，数据处理较为复杂，比如你需要处理多个 rdb/aof 文件，并且从多个实例和主机备份持久化文件\u003c/li\u003e\n\u003cli\u003e增加或删除容量也比较复杂。redis 集群大多数支持在运行时增加、删除节点的透明数据平衡的能力，但是类似于客户端分区、代理等其他系统则不支持这项特性。然而，一种叫做 presharding 的技术对此是有帮助的\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"分区类型\"\u003e分区类型\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003eRedis 有两种类型分区。 假设有4个Redis实例 R0，R1，R2，R3，和类似user:1，user:2这样的表示用户的多个key，对既定的key有多种不同方式来选择这个key存放在哪个实例中。也就是说，有不同的系统来映射某个key到某个Redis服务。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、范围分区\u003c/p\u003e\n\u003cp\u003e最简单的分区方式是按范围分区，就是映射一定范围的对象到特定的Redis实例。\u003c/p\u003e\n\u003cp\u003e比如，ID 从 0 到 10000 的用户会保存到实例 R0，ID 从 10001 到 20000 的用户会保存到 R1，以此类推。\u003c/p\u003e\n\u003cp\u003e这种方式是可行的，并且在实际中使用，不足就是要有一个区间范围到实例的映射表。这个表要被管理，同时还需要各 种对象的映射表，通常对Redis来说并非是好的方法。\u003c/p\u003e\n\u003cp\u003e2、哈希分区\u003c/p\u003e\n\u003cp\u003ehash分区，这对任何key都适用，也无需是object_name:这种形式，描述如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e用一个hash函数将key转换为一个数字，比如使用 \u003ccode\u003ecrc32\u003c/code\u003e hash函数。对key foobar执行crc32(foobar)会输出类似93024922的整数。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e对这个整数取模，将其转化为0-3之间的数字，就可以将这个整数映射到4个Redis实例中的一个了。93024922 % 4 = 2，就是说key foobar应该被存到R2实例中。注意：取模操作是取除的余数，通常在多种编程语言中用%操作符实现。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","date":1533340800,"description":"","fuzzywordcount":2300,"kind":"page","lang":"zh","lastmod":1538006400,"objectID":"f019b9d883f02264f32577beecb75772","publishdate":1533340800,"relpermalink":"/posts/storage/redis/redis-advanced/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍了 Redis 的部分高级技术，包括数据备份和恢复、安全、性能测试、分区等。\u003c/p\u003e","tags":["Redis","数据库"],"title":"Redis 进阶知识及操作","url":"https://xdhuxc.github.io/posts/storage/redis/redis-advanced/","wordcount":2258},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍了 Redis 的集群部署。\u003c/p\u003e\n\u003ch3 id=\"redis-集群的搭建一\"\u003eRedis 集群的搭建（一）\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e在一台 CentOS 7 虚拟机中搭建三个节点的 Redis 集群，该节点IP地址为：192.168.244.129\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、根据 \u003ccode\u003e在 Linux 中安装 Redis\u003c/code\u003e 安装 Redis 并成功启动单个实例\u003c/p\u003e\n\u003cp\u003e2、在 \u003ccode\u003e/home/application/redis-4.0.1\u003c/code\u003e 目录下创建 redis-cluster 目录，在该目录下分别创建 redis-1、redis-2、redis-3目录，复制redis.conf到redis-1、redis-2、redis-3目录下并分别创建log目录\u003c/p\u003e\n\u003cp\u003e3、修改redis-1、redis-2、redis-3目录下的redis.conf，修改内容如下所示：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e节点\u003c/th\u003e\n\u003cth\u003eredis_1\u003c/th\u003e\n\u003cth\u003eredis_2\u003c/th\u003e\n\u003cth\u003eredis_3\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eIP\u003c/td\u003e\n\u003ctd\u003e192.168.244.129\u003c/td\u003e\n\u003ctd\u003e192.168.244.129\u003c/td\u003e\n\u003ctd\u003e192.168.244.129\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e端口\u003c/td\u003e\n\u003ctd\u003e8001\u003c/td\u003e\n\u003ctd\u003e8002\u003c/td\u003e\n\u003ctd\u003e8003\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003edaemonize\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003epidfile\u003c/td\u003e\n\u003ctd\u003e/var/run/redis_8001.pid\u003c/td\u003e\n\u003ctd\u003e/var/run/redis_8002.pid\u003c/td\u003e\n\u003ctd\u003e/var/run/redis_8003.pid\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecluster-enabled\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecluster-config-file\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8001.conf\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8002.conf\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8003.conf\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecluster-node-timeout\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eappendonly\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003elogfile\u003c/td\u003e\n\u003ctd\u003e/home/application/redis-4.0.1/redis_cluster/redis_1/log/\u003c/td\u003e\n\u003ctd\u003e/home/application/redis-4.0.1/redis_cluster/redis_2/log/\u003c/td\u003e\n\u003ctd\u003e/home/application/redis-4.0.1/redis_cluster/redis_3/log/\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e4、将 redis-trib.rb 复制到 /usr/local/bin 目录下，使用 redis-trib.rb 工具启动集群。\n报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost src]# redis-trib.rb create --replicas 1 192.168.244.129:8001 192.168.244.129:8002 192.168.244.129:8003 192.168.244.133:8004 192.168.244.133:8005 192.168.244.133:8006\n/usr/share/rubygems/rubygems/core_ext/kernel_require.rb:55:in \u003cspan class=\"sb\"\u003e`require\u0026#39;: cannot load such file -- redis (LoadError)\n\u003c/span\u003e\u003cspan class=\"sb\"\u003e\tfrom /usr/share/rubygems/rubygems/core_ext/kernel_require.rb:55:in `\u003c/span\u003erequire\u0026#39;\n\tfrom /usr/local/bin/redis-trib.rb:25:in `\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e使用 gem 安装 Redis，使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost src]# gem install redis\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost src]# gem install redis\nERROR:  Could not find a valid gem \u0026#39;redis\u0026#39; (\u0026gt;= 0), here is why:\n          Unable to download data from https://rubygems.org/ - Errno::ECONNREFUSED: Connection refused - connect(2) (https://rubygems.org/latest_specs.4.8.gz)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost application]# gem install redis\nERROR:  Error installing redis:\n\tredis requires Ruby version \u0026gt;= 2.2.2.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e显示ruby版本须高于2.2.2，查看yum安装的ruby版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eruby -version\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"安装指定版本的-ruby\"\u003e安装指定版本的 ruby\u003c/h3\u003e\n\u003cp\u003e1）安装 curl，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo yum install curl\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）安装RVM，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -L get.rvm.io | bash -s table\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）执行下面命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esource /usr/local/rvm/scripts/rvm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4）查看rvm库中已知的ruby版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ervm list known\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5）安装一个ruby版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ervm install 2.3.3\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6）使用一个ruby版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ervm use 2.3.3\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7）卸载指定版本的ruby\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ervm remove 2.0.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8）查看ruby版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eruby --version\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e安装完成后，查看安装的ruby版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# ruby -version\nruby 2.4.1p111 (2017-03-22 revision 58053) [x86_64-linux]\n-e:1:in \u003cspan class=\"sb\"\u003e`\u0026lt;main\u0026gt;\u0026#39;: undefined local variable or method `\u003c/span\u003ersion\u0026#39; for main:Object (NameError)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、使用gem安装redis\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egem install redis\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、在 \u003ccode\u003e192.168.244.129\u003c/code\u003e 上启动三个 Redis 实例，搭建伪分布式集群\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost redis-4.0.1]# redis-trib.rb create --replicas 0 192.168.244.129:8001 192.168.244.129:8002 192.168.244.129:8003 \n\u0026gt;\u0026gt;\u0026gt; Creating cluster\n\u0026gt;\u0026gt;\u0026gt; Performing hash slots allocation on 3 nodes...\nUsing 3 masters:\n192.168.244.129:8001\n192.168.244.129:8002\n192.168.244.129:8003\nM: f55b5ad14335b51c58922d60ba55990cf303fd54 192.168.244.129:8001\n   slots:0-5460 (5461 slots) master\nM: 6ea0f62a8dcae5fa94ae778aff06764c4dbe0674 192.168.244.129:8002\n   slots:5461-10922 (5462 slots) master\nM: af341ce9fda618a5905c3a7d542f649abba5c8a5 192.168.244.129:8003\n   slots:10923-16383 (5461 slots) master\nCan I set the above configuration? (type \u0026#39;yes\u0026#39; to accept): yes\n\u0026gt;\u0026gt;\u0026gt; Nodes configuration updated\n\u0026gt;\u0026gt;\u0026gt; Assign a different config epoch to each node\n\u0026gt;\u0026gt;\u0026gt; Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join..\n\u0026gt;\u0026gt;\u0026gt; Performing Cluster Check (using node 192.168.244.129:8001)\nM: f55b5ad14335b51c58922d60ba55990cf303fd54 192.168.244.129:8001\n   slots:0-5460 (5461 slots) master\n   0 additional replica(s)\nM: af341ce9fda618a5905c3a7d542f649abba5c8a5 192.168.244.129:8003\n   slots:10923-16383 (5461 slots) master\n   0 additional replica(s)\nM: 6ea0f62a8dcae5fa94ae778aff06764c4dbe0674 192.168.244.129:8002\n   slots:5461-10922 (5462 slots) master\n   0 additional replica(s)\n[OK] All nodes agree about slots configuration.\n\u0026gt;\u0026gt;\u0026gt; Check for open slots...\n\u0026gt;\u0026gt;\u0026gt; Check slots coverage...\n[OK] All 16384 slots covered.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e已经搭建成功Redis集群。\u003c/p\u003e\n\u003ch3 id=\"搭建-redis-集群二\"\u003e搭建 Redis 集群（二）\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e在两台CentOS 7 虚拟机上搭建六个节点的Redis集群，IP地址分别为：192.168.244.129和192.168.244.133\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、下载Redis安装包，使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget http://download.redis.io/releases/redis-4.0.1.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、解压redis-4.0.1.tar.gz文件，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etar -zxf redis-4.0.1.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、进入redis-4.0.1目录下，编译Redis源程序，使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emake \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e编译完成后，使用如下命令测试：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emake test\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果出现如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e!!! WARNING The following tests failed:\n\u003cspan class=\"ge\"\u003e**\u003c/span\u003e* [err]: Slave should be able to synchronize with the master in tests/integration/replication-psync.tcl\n\nReplication not started.\n\nCleanup: may take some time... OK\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e虚拟机中安装的时候，机器性能不够的话，很容易出现上述错误。换机器或者更换参数，以及在机器不忙的时候进行编译安装，会顺利通过。\u003c/p\u003e\n\u003cp\u003e4、将 src 目录下的 redis-trib.rb 复制到 /usr/local/bin 目录下，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp -f src/redis-trib.rb /usr/local/bin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、在 redis-4.0.1 目录下创建 redis_cluster、data 和 config 目录，在 redis_cluster 目录下创建redis_4，redis_5，redis_6目录，复制redis.conf文件至各目录下，并在各目录下创建log目录。\u003c/p\u003e\n\u003cp\u003e6、修改各目录下的redis.conf文件\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e节点\u003c/th\u003e\n\u003cth\u003eredis_1\u003c/th\u003e\n\u003cth\u003eredis_2\u003c/th\u003e\n\u003cth\u003eredis_3\u003c/th\u003e\n\u003cth\u003eredis_4\u003c/th\u003e\n\u003cth\u003eredis_5\u003c/th\u003e\n\u003cth\u003eredis_6\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eIP\u003c/td\u003e\n\u003ctd\u003e192.168.244.129\u003c/td\u003e\n\u003ctd\u003e192.168.244.129\u003c/td\u003e\n\u003ctd\u003e192.168.244.129\u003c/td\u003e\n\u003ctd\u003e192.168.244.133\u003c/td\u003e\n\u003ctd\u003e192.168.244.133\u003c/td\u003e\n\u003ctd\u003e192.168.244.133\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e端口\u003c/td\u003e\n\u003ctd\u003e8001\u003c/td\u003e\n\u003ctd\u003e8002\u003c/td\u003e\n\u003ctd\u003e8003\u003c/td\u003e\n\u003ctd\u003e8004\u003c/td\u003e\n\u003ctd\u003e8005\u003c/td\u003e\n\u003ctd\u003e8006\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003edaemonize\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003epidfile\u003c/td\u003e\n\u003ctd\u003e/var/run/redis_8001.pid\u003c/td\u003e\n\u003ctd\u003e/var/run/redis_8002.pid\u003c/td\u003e\n\u003ctd\u003e/var/run/redis_8003.pid\u003c/td\u003e\n\u003ctd\u003e/var/run/redis_8004.pid\u003c/td\u003e\n\u003ctd\u003e/var/run/redis_8005.pid\u003c/td\u003e\n\u003ctd\u003e/var/run/redis800_6.pid\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecluster-enabled\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecluster-config-file\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8001.conf\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8002.conf\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8003.conf\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8004.conf\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8005.conf\u003c/td\u003e\n\u003ctd\u003e./config/nodes_8006.conf\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecluster-node-timeout\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003ctd\u003e15000\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eappendonly\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003ctd\u003eyes\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003elogfile\u003c/td\u003e\n\u003ctd\u003e./redis_cluster/redis_1/log/\u003c/td\u003e\n\u003ctd\u003e./redis_cluster/redis_2/log/\u003c/td\u003e\n\u003ctd\u003e./redis_cluster/redis_3/log/\u003c/td\u003e\n\u003ctd\u003e./redis_cluster/redis_4/log/\u003c/td\u003e\n\u003ctd\u003e./redis_cluster/redis_5/log/\u003c/td\u003e\n\u003ctd\u003e./redis_cluster/redis_6/log/\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e将 \u003ccode\u003edump.rdb\u003c/code\u003e 和 \u003ccode\u003eappendonly.aof\u003c/code\u003e 文件的目录修改至 \u003ccode\u003e./data\u003c/code\u003e 目录下\u003c/p\u003e\n\u003cp\u003e7、在 \u003ccode\u003e192.168.244.129\u003c/code\u003e 和 \u003ccode\u003e192.168.244.133\u003c/code\u003e 上各启动三个Redis实例，搭建含有六个节点的跨主机集群，在 \u003ccode\u003e192.168.244.129\u003c/code\u003e 上执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis-trib.rb create --replicas 1 192.168.244.129:8001 192.168.244.129:8002 192.168.244.129:8003 192.168.244.133:8004 192.168.244.133:8005 192.168.244.133:8006\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行后，报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026gt;\u0026gt;\u0026gt; Creating cluster\n[ERR] Sorry, can\u0026#39;t connect to node 192.168.244.133:8004\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可能是因为192.168.244.133上的相应端口未开放\n解决：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCentOS 7 使用firewalld代替了iptables\n在 \u003ccode\u003e192.168.244.133\u003c/code\u003e 上开启防火墙端口8004、8005、8006，使用命令为：\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efirewall-cmd --zone=public --add-port=8004/tcp --permanent # --zone \u003cspan class=\"ni\"\u003e#作用域\u003c/span\u003e --add-port=80/tcp  \u003cspan class=\"ni\"\u003e#添加端口\u003c/span\u003e，格式为：端口/通讯协议 --permanent  \u003cspan class=\"ni\"\u003e#永久生效\u003c/span\u003e，没有此参数重启后失效\nfirewall-cmd --reload # 重启防火墙\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e之后重新启动集群，出现如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost redis-4.0.1]# redis-trib.rb create --replicas 1 192.168.244.129:8001 192.168.244.129:8002 192.168.244.129:8003 192.168.244.133:8004 192.168.244.133:8005 192.168.244.133:8006\n\u0026gt;\u0026gt;\u0026gt; Creating cluster\n[ERR] Node 192.168.244.129:8001 is not empty. Either the node already knows other nodes (check with CLUSTER NODES) or contains some key in database 0.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\n清理掉 \u003ccode\u003eredis-4.0.1\u003c/code\u003e 目录下的 appendonly.aof dump.rdb nodes-*.conf 文件，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erm -f appendonly.aof dump.rdb nodes-*.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重新启动六个Redis实例，出现如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026gt;\u0026gt;\u0026gt; Assign a different config epoch to each node\n\u0026gt;\u0026gt;\u0026gt; Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join.............................................................................................................................................................................\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eEvery Redis Cluster node requires two TCP connections open. The\nnormal Redis TCP port used to serve clients, for example 6379, plus\nthe port obtained by adding 10000 to the data port, so 16379 in the\nexample. This second high port is used for the Cluster bus, that is\na node-to-node communication channel using a binary protocol. The\nCluster bus is used by nodes for failure detection, configuration\nupdate, failover authorization and so forth. Clients should never\ntry to communicate with the cluster bus port, but always with the\nnormal Redis command port, however make sure you open both ports in\nyour firewall, otherwise Redis cluster nodes will be not able to\ncommunicate. The command port and cluster bus port offset is fixed\nand is always 10000. Note that for a Redis Cluster to work properly\nyou need, for each node: The normal client communication port\n(usually 6379) used to communicate with clients to be open to all\nthe clients that need to reach the cluster, plus all the other\ncluster nodes (that use the client port for keys migrations). The\ncluster bus port (the client port + 10000) must be reachable from\nall the other cluster nodes. If you don\u0026#39;t open both TCP ports, your\ncluster will not work as expected. The cluster bus uses a\ndifferent, binary protocol, for node to node data exchange, which\nis more suited to exchange information between nodes using little\nbandwidth and processing time. i use AWS, due to don\u0026#39;t open 16379\n16380 port, cause this issue\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\n在 \u003ccode\u003e192.168.244.133\u003c/code\u003e 上开放 \u003ccode\u003e18004\u003c/code\u003e、\u003ccode\u003e18005\u003c/code\u003e 和 \u003ccode\u003e18006\u003c/code\u003e 端口以供 \u003ccode\u003eredis\u003c/code\u003e 集群数据通讯。\u003c/p\u003e\n\u003cp\u003e在搭建过程中，可以使用redis-trib.rb测试各个节点的连接情况：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost redis-3.2.10]# redis-trib.rb check 192.168.244.133:8007\n\u0026gt;\u0026gt;\u0026gt; Performing Cluster Check (using node 192.168.244.133:8007)\nM: 2c6977dce48d9abd038d066c37c91306ffd32ca2 192.168.244.133:8007\n   slots: (0 slots) master\n   0 additional replica(s)\n[OK] All nodes agree about slots configuration.\n\u0026gt;\u0026gt;\u0026gt; Check for open slots...\n\u0026gt;\u0026gt;\u0026gt; Check slots coverage...\n[ERR] Not all 16384 slots are covered by nodes.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、登录redis集群节点机，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost redis-4.0.1]# redis-cli -h 192.168.244.129 -p 8003 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e若要停止Redis服务，可以使用命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost redis-4.0.1]# redis-cli -h 192.168.244.129 -p 8003 shutdown\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1533340800,"description":"","fuzzywordcount":2300,"kind":"page","lang":"zh","lastmod":1538006400,"objectID":"40da6b109251f4d88f18362eb982d55d","publishdate":1533340800,"relpermalink":"/posts/storage/redis/redis-cluster/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍了 Redis 的集群部署。\u003c/p\u003e","tags":["Redis","数据库"],"title":"Redis 集群部署","url":"https://xdhuxc.github.io/posts/storage/redis/redis-cluster/","wordcount":2227},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了些 Linux 系统的常用知识。\u003c/p\u003e\n\u003ch3 id=\"文件和目录权限\"\u003e文件和目录权限\u003c/h3\u003e\n\u003cp\u003eroot 默认对所有文件具有读写权限，但默认没有执行权限。\u003c/p\u003e\n\u003ch4 id=\"目录权限知识\"\u003e目录权限知识\u003c/h4\u003e\n\u003cp\u003e对于目录来说，\nr 查看目录中的内容\nw 可以在目录中创建、删除、修改、重命名文件。\nx 表示是否可以进入到目录中，是否能查看或修改目录中文件的属性信息。\u003c/p\u003e\n\u003cp\u003e目录的 r 权限，需要 x 权限配合。\n目录的 w 权限，需要 x 权限配合。\n单独的 x 权限没有用。\u003c/p\u003e\n\u003ch3 id=\"ulimit\"\u003eulimit\u003c/h3\u003e\n\u003cp\u003e设置当前shell以及由它启动的进程的资源限制。\u003c/p\u003e\n\u003cp\u003elinux 对于每个用户，系统限制其最大进程数。为提高性能，可以根据设备资源情况，设置各linux 用户的最大进程数。\u003c/p\u003e\n\u003cp\u003e可以用 \u003ccode\u003eulimit -a\u003c/code\u003e 来显示当前的各种用户进程限制。\u003c/p\u003e\n\u003cp\u003e可以通过 \u003ccode\u003eulimit -n 4096\u003c/code\u003e 将每个进程可以打开的文件数目加大到4096，缺省为1024。\n其他建议设置成无限制（unlimited）的一些重要设置是：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e数据段长度：ulimit -d unlimited\n最大内存大小：ulimit -m unlimited\n堆栈大小：ulimit -s unlimited\nCPU 时间：ulimit -t unlimited\n虚拟内存：ulimit -v unlimited\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e暂时地，适用于通过 ulimit 命令登录 shell 会话期间。\n永久地，通过将一个相应的 ulimit 语句添加到由登录 shell 读取的文件中， 即特定于 shell 的用户资源文件。\u003c/p\u003e\n\u003ch4 id=\"ulimit-的硬限制和软限制\"\u003eulimit 的硬限制和软限制\u003c/h4\u003e\n\u003cp\u003e硬限制使用 -H 参数，软限制使用 -S 参数。\u003c/p\u003e\n\u003cp\u003eulimit -a 看到的是软限制，可以通过 ulimit -a -H 查看其硬限制。\u003c/p\u003e\n\u003cp\u003e如果 ulimit 不限定使用 -H 或 -S，此时它会同时把两类限制都改掉的。\u003c/p\u003e\n\u003cp\u003e软限制可以限制用户/组对资源的使用，硬限制的作用是控制软限制。\u003c/p\u003e\n\u003cp\u003e超级用户和普通用户都可以扩大硬限制，但是超级用户可以缩小硬限制，普通用户则不能缩小硬限制。\u003c/p\u003e\n\u003cp\u003e硬限制设定后，设定软限制时只能是小于或者等于硬限制。\u003c/p\u003e\n\u003ch4 id=\"解除资源限制\"\u003e解除资源限制\u003c/h4\u003e\n\u003cp\u003e1、解除 Linux 系统的最大进程数和最大文件打开数限制：\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003e/etc/security/limits.conf\u003c/code\u003e 中添加如下行：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e*\u003c/span\u003e soft noproc 11000\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e hard noproc 11000\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e soft nofile 4100\n\u003cspan class=\"k\"\u003e*\u003c/span\u003e hard nofile 4100\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e说明：* 代表针对所有用户，\u003ccode\u003enoproc\u003c/code\u003e 是代表最大进程数，\u003ccode\u003enofile\u003c/code\u003e 是代表最大文件打开数。\u003c/p\u003e\n\u003cp\u003e2、修改所有Linux用户的环境变量文件：\u003c/p\u003e\n\u003cp\u003e在\u003ccode\u003e/etc/profile\u003c/code\u003e中添加如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eulimit -u 10000\nulimit -n 4096\nulimit -d unlimited\nulimit -m unlimited\nulimit -s unlimited\nulimit -t unlimited\nulimit -v unlimited\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e保存后运行\u003ccode\u003esource /etc/profile\u003c/code\u003e 使其生效。\u003c/p\u003e\n\u003ch4 id=\"参考资料\"\u003e参考资料\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/csq_year/article/details/49304895\"\u003ehttps://blog.csdn.net/csq_year/article/details/49304895\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/fengspg/article/details/39646337\"\u003ehttps://blog.csdn.net/fengspg/article/details/39646337\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"僵尸进程和孤儿进程\"\u003e僵尸进程和孤儿进程\u003c/h3\u003e\n\u003cp\u003e在unix/linux中，正常情况下，子进程是通过父进程创建的，子进程在创建新的进程。子进程的结束和父进程的运行是一个异步过程,即父进程永远无法预测子进程 到底什么时候结束。 当一个 进程完成它的工作终止之后，它的父进程需要调用wait()或者waitpid()系统调用取得子进程的终止状态。\n\t孤儿进程：一个父进程退出，而它的一个或多个子进程还在运行，那么那些子进程将成为孤儿进程。孤儿进程将被init进程(进程号为1)所收养，并由init进程对它们完成状态收集工作。\n\t僵尸进程：一个进程使用fork创建子进程，如果子进程退出，而父进程并没有调用 wait 函数或 waitpid 函数获取子进程的状态信息，那么子进程的进程描述符仍然保存在系统中。这种进程称之为僵死进程。\u003c/p\u003e\n\u003cp\u003eunix提供了一种机制可以保证只要父进程想知道子进程结束时的状态信息， 就可以得到。这种机制就是: 在每个进程退出的时候,内核释放该进程所有的资源,包括打开的文件,占用的内存等。 但是仍然为其保留一定的信息(包括进程号，退出状态，运行时间等)。直到父进程通过wait / waitpid来取时才释放。 但这样就导致了问题，如果父进程不调用wait / waitpid的话， 那么保留的那段信息就不会释放，其进程号就会一直被占用，但是系统所能使用的进程号是有限的，如果大量的产生僵死进程，将因为没有可用的进程号而导致系统不能产生新的进程. 此即为僵尸进程的危害，应当避免。\u003c/p\u003e\n\u003cp\u003e孤儿进程是没有父进程的进程，孤儿进程这个重任就落到了init进程身上，init进程就好像是一个民政局，专门负责处理孤儿进程的善后工作。每当出现一个孤儿进程的时候，内核就把孤 儿进程的父进程设置为init，而init进程会循环地wait()它的已经退出的子进程。这样，当一个孤儿进程凄凉地结束了其生命周期的时候，init进程就会出面处理它的一切善后工作。因此孤儿进程并不会有什么危害。\u003c/p\u003e\n\u003cp\u003e任何一个子进程(init除外)在exit()之后，并非马上就消失掉，而是留下一个称为僵尸进程(Zombie)的数据结构，等待父进程处理。这是每个 子进程在结束时都要经过的阶段。如果子进程在exit()之后，父进程没有来得及处理，这时用ps命令就能看到子进程的状态是“Z”。如果父进程能及时 处理，可能用ps命令就来不及看到子进程的僵尸状态，但这并不等于子进程不经过僵尸状态。  如果父进程在子进程结束之前退出，则子进程将由init接管。init将会以父进程的身份对僵尸状态的子进程进行处理。\u003c/p\u003e\n\u003cp\u003e解决方法：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e通过信号机制，子进程退出时向父进程发送 \u003ccode\u003eSIGCHILD\u003c/code\u003e 信号，父进程处理 \u003ccode\u003eSIGCHILD\u003c/code\u003e 信号。在信号处理函数中调用wait进行处理僵尸进程。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFork两次，原理是将子进程成为孤儿进程，从而其的父进程变为init进程，通过init进程可以处理僵尸进程。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"守护进程\"\u003e守护进程\u003c/h3\u003e\n\u003cp\u003e守护进程（Daemon Process），是Linux中的后台服务进程，是一个生存期较长的进程，通常独立于控制终端并且周期性地执行某种任务或等待处理某些发生的事件。\u003c/p\u003e\n\u003cp\u003e守护进程是个特殊的孤儿进程，这种进程脱离终端，为什么要脱离终端呢？之所以脱离于终端是为了避免进程被任何终端所产生的信息所打断，其在执行过程中的信息也不在任何终端上显示。由于在 linux 中，每一个系统与用户进行交流的界面称为终端，每一个从此终端开始运行的进程都会依附于这个终端，这个终端就称为这些进程的控制终端，当控制终端被关闭时，相应的进程都会自动关闭。\u003c/p\u003e\n\u003cp\u003eLinux 的大多数服务器就是用守护进程实现的。比如，Internet 服务器 inetd，Web 服务器 httpd 等。\u003c/p\u003e\n\u003ch3 id=\"系统平均负载\"\u003e系统平均负载\u003c/h3\u003e\n\u003cp\u003e系统平均负载被定义为在特定时间间隔内运行队列中的平均进程数。如果一个进程满足以下条件，则其就会位于运行队列中：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e没有在等待I/O操作的结果。\u003c/li\u003e\n\u003cli\u003e没有主动进入等待状态（也就是没有调用wait）。\u003c/li\u003e\n\u003cli\u003e没有被停止。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# uptime\n 04:10:38 up 19 days,  4:56,  3 users,  load average: 0.90, 0.52, 0.42\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e命令输出的最后内容表示在过去的1、5、15分钟内运行队列中的平均进程数量。\u003c/p\u003e\n\u003cp\u003e一般来说只要每个CPU的当前活动进程数不大于3那么系统的性能就是良好的，如果每个CPU的任务数大于5，那么就表示这台机器的性能有严重问题。对于 上面的例子来说，假设系统有两个CPU，那么其每个CPU的当前任务数为：0.90/2=0.45。这表示该系统的性能是良好的。\u003c/p\u003e\n\u003ch3 id=\"vmswappiness\"\u003evm.swappiness\u003c/h3\u003e\n\u003cp\u003eLinux 会使用硬盘的一部分作为 Swap 分区，用来进行进程的调度。如果内存够大，应当告诉 Linux 不必太多地使用 Swap 分区，可以通过修改 swappiness 的数值实现。\u003c/p\u003e\n\u003cp\u003eswappiness=0 的时候表示最大限度地使用物理内存，然后才是 swap 空间；\u003c/p\u003e\n\u003cp\u003eswappiness=100 的时候表示积极地使用 swap 分区，并且把内存上的数据及时地搬运到 swap 空间里面。\u003c/p\u003e\n\u003cp\u003e在 Linux 中，swappiness 的默认值为：60\u003c/p\u003e\n\u003ch3 id=\"procstat-文件-内容含义\"\u003e/proc/stat 文件 内容含义\u003c/h3\u003e\n\u003cp\u003e文件内容为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecpu  38612618 56617 34286154 1463872231 372072760 0 957390 9312034 0 0\ncpu0 10354076 16022 9826771 452299838 4246512 0 72999 2704956 0 0\ncpu1 9711715 13481 9043388 455113973 3912957 0 57785 2331301 0 0\ncpu2 9036808 12888 8220419 101656754 360163130 0 47335 1991839 0 0\ncpu3 9510018 14225 7195574 454801665 3750159 0 779269 2283936 0 0\nintr 8888957117 132 9 0 0 0 0 3 0 0 0 0 24 126 0 0 4364057 0 0 0 0 0 0 0 0 0 0 557138249 2 5427 0 5427157 0 3141694 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\nctxt 15656962072\nbtime 1528977806\nprocesses 17976269\nprocs_running 2\nprocs_blocked 1\nsoftirq 3416731289 3 1574245130 526818 783196686 2384220 0 202 386807575 0 669570655\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e表示的是CPU总的使用情况，从左向右分别表示user，nice，system，idle，iowait，irq和softirq\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003euser：处于用户态的运行时间，不包含nice值为负的进程。\u003c/li\u003e\n\u003cli\u003enice：nice值为负的进程所占用的CPU时间。\u003c/li\u003e\n\u003cli\u003esystem：处于内核态的运行时间。\u003c/li\u003e\n\u003cli\u003eidle：除IO等待时间以外的其他等待时间。\u003c/li\u003e\n\u003cli\u003eiowait：io等待时间\u003c/li\u003e\n\u003cli\u003eirq：硬中断时间\u003c/li\u003e\n\u003cli\u003esoftirq：软中断时间\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e以上所有时间均是从系统启动开始累计到当前时刻，单位为：jiffies（jiffies是内核中的一个全局变量，用来记录自系统启动以来产生的节拍数。在linux中，一个节拍大致可以理解为操作系统进程调度的最小时间片，不同的linux内核，值可能不同，通常在1ms~10ms之间）\u003c/p\u003e\n\u003ch3 id=\"-和--的区别\"\u003e~ 和 / 的区别\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e/\u003c/code\u003e 是目录层的分隔、表示符。只有一个 \u003ccode\u003e/\u003c/code\u003e 表明是根目录， \u003ccode\u003e/etc/\u003c/code\u003e 表明是根目录下面的 \u003ccode\u003eetc\u003c/code\u003e 目录。当然目录最后不需要 \u003ccode\u003e/\u003c/code\u003e ，但有 \u003ccode\u003e/\u003c/code\u003e 直接表明他是目录，没有末尾的 \u003ccode\u003e/\u003c/code\u003e ，那么 \u003ccode\u003e/etc\u003c/code\u003e 需要检测一下确定是目录还是文件，虽然习惯上 \u003ccode\u003e/etc\u003c/code\u003e 绝对是目录。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e~\u003c/code\u003e 是一个代位符，表明的是个人目录的地址，因为每个用户都有自己的个人目录地址，所以用 \u003ccode\u003e~\u003c/code\u003e 作为统一替代这个根据用户不同而不同但有规可循的地址，来保证某些情况下的兼容问题。\u003c/p\u003e\n\u003ch3 id=\"单引号双引号反引号\"\u003e单引号、双引号、反引号\u003c/h3\u003e\n\u003cp\u003e1、由单引号括起来的字符都作为普通字符出现。特殊字符用单引号括起来以后，也会失去原有意义，而只作为普通字符解释。\u003c/p\u003e\n\u003cp\u003e2、由双引号括起来的字符，除$（美元符号）、\\（反斜杠）、’（单引号）、和”（双引号）这几个字符仍是特殊字符并保留其特殊功能外，其余字符仍作为普通字符对待。对于“$”来说，就是用其后指定的变量的值来代替这个变量和$；对于“\\”而言，是转义字符，它告诉shell不要对其后面的那个字符进行特殊处理，只当作普通字符即可。可以想见，在双引号中需要在前面加上“\\”的只有四个字符$，\\，’和”本身。而对”号，若其前面没有加“\\”，则Shell会将它同前一个”号匹配。\u003c/p\u003e\n\u003cp\u003e把双引号内的内容输出出来，如果内容中有命令、变量等，会先把变量、命令解析出结果，然后再输出最终的内容来。\u003c/p\u003e\n\u003cp\u003e3、反引号（`）这个字符所对应的键一般位于键盘的左上角，不要将其同单引号（’）混淆。反引号括起来的字符串被shell解释为命令行，在执行时，shell首先执行该命令行，并以它的标准输出结果取代整个反引号（包括两个反引号）部分。\u003c/p\u003e\n\u003cp\u003e4、反引号还可以嵌套使用。但需注意，嵌套使用时内层的反引号必须用反斜杠（\\）将其转义。\u003c/p\u003e\n\u003cp\u003e5、在反引号之间的命令行中也可以使用shell的特殊字符。Shell为得到\u003ccode\u003e中命令的结果，它实际上要去执行\u003c/code\u003e中指定的命令。执行时，命令中的特殊字符，如$，”，?等又将具有特殊含义，并且``所包含的可以是任何一个合法的Shell命令。\u003c/p\u003e\n\u003ch3 id=\"带双引号和不带双引号的区别\"\u003e带双引号和不带双引号的区别：\u003c/h3\u003e\n\u003cp\u003e把双引号内的内容输出出来，如果内容中有命令、变量等，会先把变量、命令解析出结果，然后再输出最终的内容来。\u003c/p\u003e\n\u003cp\u003e对于 bash 来说\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho $1\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e看上去是 打印第一个参数，其实是 把第一个参数按照空格、制表符、换行符等符号来分割开，然后把这些分割后的每一项再按 glob 模式展开，最后把这些值，再用一个空格重新连接起来并打印出来。\u003c/p\u003e\n\u003cp\u003e如果 第一个参数 碰巧就是 用一个空格连接的，且没有包含这些 glob 模式，那看上去就是原样输出，其实是转换以后没有发生变化。\u003c/p\u003e\n\u003ch3 id=\"字符串相关操作\"\u003e字符串相关操作\u003c/h3\u003e\n\u003cp\u003e判断读取字符串值\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e表达式\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var}\u003c/td\u003e\n\u003ctd\u003e变量var的值, 与$var相同\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var-DEFAULT}\u003c/td\u003e\n\u003ctd\u003e如果var没有被声明, 那么就以$DEFAULT作为其值 *\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var:-DEFAULT}\u003c/td\u003e\n\u003ctd\u003e如果var没有被声明, 或者其值为空, 那么就以$DEFAULT作为其值 *\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var=DEFAULT}\u003c/td\u003e\n\u003ctd\u003e如果var没有被声明, 那么就以$DEFAULT作为其值 *\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var:=DEFAULT}\u003c/td\u003e\n\u003ctd\u003e如果var没有被声明, 或者其值为空, 那么就以$DEFAULT作为其值 *\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var+OTHER}\u003c/td\u003e\n\u003ctd\u003e如果var声明了, 那么其值就是$OTHER, 否则就为null字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var:+OTHER}\u003c/td\u003e\n\u003ctd\u003e如果var被设置了, 那么其值就是$OTHER, 否则就为null字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var?ERR_MSG}\u003c/td\u003e\n\u003ctd\u003e如果var没被声明, 那么就打印$ERR_MSG *\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${var:?ERR_MSG}\u003c/td\u003e\n\u003ctd\u003e如果var没被设置, 那么就打印$ERR_MSG *\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e字符串操作\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e表达式\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e${#string}\u003c/td\u003e\n\u003ctd\u003e$string的长度\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string:position}\u003c/td\u003e\n\u003ctd\u003e在$string中, 从位置$position开始提取子串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string:position:length}\u003c/td\u003e\n\u003ctd\u003e在$string中, 从位置$position开始提取长度为$length的子串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string#substring}\u003c/td\u003e\n\u003ctd\u003e从变量$string的开头, 删除最短匹配$substring的子串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string##substring}\u003c/td\u003e\n\u003ctd\u003e从变量$string的开头, 删除最长匹配$substring的子串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string%substring}\u003c/td\u003e\n\u003ctd\u003e从变量$string的结尾, 删除最短匹配$substring的子串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string%%substring}\u003c/td\u003e\n\u003ctd\u003e从变量$string的结尾, 删除最长匹配$substring的子串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string/substring/replacement}\u003c/td\u003e\n\u003ctd\u003e使用$replacement, 来代替第一个匹配的$substring\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string//substring/replacement}\u003c/td\u003e\n\u003ctd\u003e使用$replacement, 代替所有匹配的$substring\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string/#substring/replacement}\u003c/td\u003e\n\u003ctd\u003e如果$string的前缀匹配$substring, 那么就用$replacement来代替匹配到的$substring\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${string/%substring/replacement}\u003c/td\u003e\n\u003ctd\u003e如果$string的后缀匹配$substring, 那么就用$replacement来代替匹配到的$substring\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${varible##*string}\u003c/td\u003e\n\u003ctd\u003e从左向右截取最后一个string后的字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${varible#*string}\u003c/td\u003e\n\u003ctd\u003e从左向右截取第一个string后的字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${varible%%string*}\u003c/td\u003e\n\u003ctd\u003e从右向左截取最后一个string后的字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e${varible%string*}\u003c/td\u003e\n\u003ctd\u003e从右向左截取第一个string后的字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e例如，对于str=10.10.24.171:5000/xdhuxc/nginx\u003c/p\u003e\n\u003cp\u003e${str##*/} ==\u0026gt; nginx\u003c/p\u003e\n\u003cp\u003e${str#*/} ==\u0026gt; xdhuxc/nginx\u003c/p\u003e\n\u003cp\u003e${str//10.10.24.171/192.168.244.128} ==\u0026gt; 192.168.244.128:5000/xdhuxc/nginx\u003c/p\u003e\n\u003ch3 id=\"cp\"\u003e\\cp\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ecp\u003c/code\u003e 命令默认是不会提示 \u003ccode\u003eoverwrite?\u003c/code\u003e 的，但是 \u003ccode\u003ecp\u003c/code\u003e 的 \u003ccode\u003e-i\u003c/code\u003e 选项会提示，而一般 \u003ccode\u003eLinux\u003c/code\u003e 的启动文件 \u003ccode\u003e~/.bashrc\u003c/code\u003e 中会把 \u003ccode\u003ecp\u003c/code\u003e 命名成\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ealias cp=\u0026#39;cp -i\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这样在 \u003ccode\u003eLinux\u003c/code\u003e 下输入 \u003ccode\u003ecp\u003c/code\u003e 命令实际上运行的是 \u003ccode\u003ecp -i\u003c/code\u003e，加上一个 \u003ccode\u003e\\\u003c/code\u003e 符号就是让此次的 \u003ccode\u003ecp\u003c/code\u003e 命令不使用别名 \u003ccode\u003ecp -i\u003c/code\u003e 运行，就不会有 \u003ccode\u003eoverwrite?\u003c/code\u003e 的提示了\u003c/p\u003e\n\u003ch3 id=\"文件测试运算符\"\u003e文件测试运算符\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e文件测试运算符用于检测Unix文件的各种属性\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e操作符\u003c/th\u003e\n\u003cth\u003e说明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e-b file\u003c/td\u003e\n\u003ctd\u003e检测文件是否是块设备文件，如果是，则返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-c file\u003c/td\u003e\n\u003ctd\u003e检测文件是否是字符设备文件，如果是，则返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-d file\u003c/td\u003e\n\u003ctd\u003e检测文件是否是目录，如果是，则返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-f file\u003c/td\u003e\n\u003ctd\u003e检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-w file\u003c/td\u003e\n\u003ctd\u003e检测文件是否可写，如果是，则返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-x file\u003c/td\u003e\n\u003ctd\u003e检测文件是否可执行，如果是，则返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-r file\u003c/td\u003e\n\u003ctd\u003e检测文件是否可读，如果是，则返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-s file\u003c/td\u003e\n\u003ctd\u003e检测文件是否为空（文件大小是否大于0），不为空返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-e file\u003c/td\u003e\n\u003ctd\u003e检测文件（包括目录）是否存在，如果是，则返回 true\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"文件颜色的含义\"\u003e文件颜色的含义\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e在Linux命令行中，文件和目录的颜色有特殊的含义\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、白色，表示普通文件\u003c/p\u003e\n\u003cp\u003e2、蓝色，表示目录\u003c/p\u003e\n\u003cp\u003e3、绿色，表示可执行文件\u003c/p\u003e\n\u003cp\u003e4、红色，表示压缩文件\u003c/p\u003e\n\u003cp\u003e5、浅蓝色，表示链接文件\u003c/p\u003e\n\u003cp\u003e6、黄色，表示设备文件\u003c/p\u003e\n\u003cp\u003e7、灰色，表示其他文件\u003c/p\u003e\n\u003cp\u003e8、红色闪烁，表示链接的文件有问题\u003c/p\u003e","date":1533254400,"description":"","fuzzywordcount":6000,"kind":"page","lang":"zh","lastmod":1534636800,"objectID":"0465eb57c6e868d2aac9ea6f4e3de4a5","publishdate":1533254400,"relpermalink":"/posts/linux/linux-common-knowledge/","section":"posts","summary":"\u003cp\u003e本篇博客记录了些 Linux 系统的常用知识。\u003c/p\u003e","tags":["Linux"],"title":"Linux 常用知识总结","url":"https://xdhuxc.github.io/posts/linux/linux-common-knowledge/","wordcount":5942},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了一些使用 MySQL 过程中常见的问题及解决方式，留作后查。\u003c/p\u003e\n\u003ch3 id=\"常见问题及解决\"\u003e常见问题及解决\u003c/h3\u003e\n\u003cp\u003e1、能看到数据库和表，但是select时报不存在\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; select * from sys_prompt limit 5;\nERROR 1146 (42S02): Table \u0026#39;xdhuxc.sys_prompt\u0026#39; doesn\u0026#39;t exist\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql\u0026gt; drop database yhtdb;\nERROR 1010 (HY000): Error dropping database (can\u0026#39;t rmdir \u0026#39;./yhtdb\u0026#39;, errno: 39)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：在\u003ccode\u003e/var/lib/mysql\u003c/code\u003e下，删除该数据库对应的目录，重新导入sql文件。\u003c/p\u003e\n\u003cp\u003e2、 mysql 服务启动失败\n可能原因：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e1、可能是端口号被占用。\n2、可能是 mysql 配置文件修改错误，导致某些配置参数名称错误。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、向数据库表中插入数据时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e(1265, \u0026#34;Data truncated for column \u0026#39;income\u0026#39; at row 1\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e数据库表定义时，定义的字段 income 长度太短，更改该数据类型，增大其长度。\u003c/p\u003e\n\u003cp\u003e4、在 Mac 上安装的 MySQL 8.0.1，使用 DbVisualizer 连接时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eProduct: DbVisualizer Free 10.0.17 [Build \u003cspan class=\"ni\"\u003e#2882\u003c/span\u003e]\nOS: Mac OS X\nOS Version: 10.14.3\nOS Arch: x86_64\nJava Version: 1.8.0_191\nJava VM: Java HotSpot(TM) 64-Bit Server VM\nJava Vendor: Oracle Corporation\nJava Home: /Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home\nDbVis Home: /Applications/DbVisualizer.app/Contents/Resources/app\nUser Home: /Users/wanghuan\nPrefsDir: /Users/wanghuan/.dbvis\nSessionId: 112\nBindDir: null\n\nAn error occurred while establishing the connection:\n\nLong Message:\nUnable to load authentication plugin \u0026#39;caching_sha2_password\u0026#39;.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：使用 root 用户登录进去，执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER USER \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED WITH mysql_native_password BY \u0026#39;root@20190322\u0026#39;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、连接 MySQL 时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eLong Message:\nAccess denied for user \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; (using password: YES)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：可能是 mysql 密码配置错误，重新修改 mysql 密码。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003euse mysql;\nALTER USER \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED WITH mysql_native_password BY \u0026#39;wh19940423\u0026#39;;\nflush privileges;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、更新数据时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eError 1062: Duplicate entry \u0026#39;23viewer12fgdfdsgsd\u0026#39; for key \u0026#39;name\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e检查数据库，确实没有重复的名称，删除数据库表，重新创建表结构。\u003c/p\u003e\n\u003cp\u003e7、使用 GORM 框架时，插入含时间戳类型的结构体字段时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eError 1292: Incorrect datetime value: \u0026#39;0000-00-00\u0026#39; for column \u0026#39;create_time\u0026#39; at row 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因：时间戳类型字段 CreateTime，UpdateTime 没有赋值，导致类型为 datetime类型，从而报错。\u003c/p\u003e\n\u003cp\u003e8、使用用户名和密码连接 MySQL 时，可能会报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eUnable to load authentication plugin \u0026#39;caching_sha2_password\u0026#39;.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这是 mysql 5.x 和 8.x 的区别，5.x 版本的认证插件是：default_authentication_plugin=mysql_native_password，8.x 的认证插件是：default_authentication_plugin=caching_sha2_password。\u003c/p\u003e\n\u003cp\u003emysql 驱动已经更新适配了caching_sha2_password 的密码规则，升级到最新版本即可。\u003c/p\u003e\n\u003cp\u003e9、使用用户名和密码连接 MySQL 时，可能会报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epublic key retrieval is not allowed\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在连接 MySQL 的参数中，设置 \u003ccode\u003eallowPublicKeyRetrieval=true\u003c/code\u003e，如果用户使用了 sha256_password 认证，密码在传输过程中必须使用 TLS 协议保护，但是如果 RSA 公钥不可用，可以使用服务器提供的公钥；可以在连接中通过 ServerRSAPublicKeyFile 指定服务器的 RSA 公钥，或者AllowPublicKeyRetrieval=True参数以允许客户端从服务器获取公钥；但是需要注意的是 AllowPublicKeyRetrieval=True可能会导致恶意的代理通过中间人攻击(MITM)获取到明文密码，所以默认是关闭的，必须显式开启。\u003c/p\u003e\n\u003cp\u003e参考：https://mysqlconnector.net/connection-options/\u003c/p\u003e\n\u003cp\u003e10、我们在一个 for 循环中，对于每一个元素，启动一个 golang 协程去操作数据库，日志中报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[2020-08-08 11:12:28]  [0.13ms]  DELETE FROM \u003cspan class=\"sb\"\u003e`messages`\u003c/span\u003e  WHERE (isCurrentUpdate = false)  \n[0 rows affected or returned ] \n[mysql] 2020/08/08 11:12:28 packets.go:446: busy buffer\n[mysql] 2020/08/08 11:12:28 packets.go:427: busy buffer\n\n(/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/xdhuxc-message/src/service/message.go:246) \n[2020-08-08 11:12:28]  driver: bad connection \nERRO[2020-08-08 11:12:28]/Users/wanghuan/GolandProjects/GoPath/src/github.com/xdhuxc/xdhuxc-message/src/service/message.go:247 github.com/xdhuxc/xdhuxc-message/src/service.(*messageService).message() 删除数据时出错，错误为：driver: bad connection \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这是由于程序执行太快，可用连接不足导致的，增大程序可以打开的最大连接数，适当减慢程序运行。\u003c/p\u003e\n\u003cp\u003e具体代码实现如下：\n1、将程序可以打开的连接数增大\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edb.DB().SetMaxOpenConns(5000)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、减慢程序运行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efor _, stock := range stocks {\t\n\ttime.Sleep(50*time.Millisecond)\n\n\tgo func(user model.User) {}\t\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1533081600,"description":"","fuzzywordcount":1400,"kind":"page","lang":"zh","lastmod":1564358400,"objectID":"e849aa7d61d2a0d1544a0eab36401f08","publishdate":1533081600,"relpermalink":"/posts/storage/mysql/mysql-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录了一些使用 MySQL 过程中常见的问题及解决方式，留作后查。\u003c/p\u003e","tags":["MySQL","数据库"],"title":"MySQL 常见问题及解决","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-questions-and-solutions/","wordcount":1347},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了一些 MySQL 常用命令，方便查找。\u003c/p\u003e\n\u003ch3 id=\"数据库管理命令\"\u003e数据库管理命令\u003c/h3\u003e\n\u003cp\u003e1、显示当前 MySQL 的连接数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eshow processlist\n或\nshow full processlist\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、显示 MySQL 的环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eshow variables\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查找最大连接数或服务器响应的最大连接数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eshow variables like \u0026#34;%conn%\u0026#34;\n或\nshow global status like \u0026#39;Max_used_connections\u0026#39; # 查询服务器响应的最大连接数\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、临时设置最大连接数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eset global max_connections=200  # 在 mysql 终端中临时设置最大连接数为：200\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者在 /etc/my.cnf 中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[mysqld]\nmax_connections=200\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、查询缓存的参数说明\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eshow global variables like \u0026#34;query_cache%\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、查询 MySQL 运行产生的状态值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eshow global status like \u0026#39;qcache%\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、采用直接重置 autoIncrement 值的方法重置 auto_increment\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ealter table marathon auto_increment = 1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、查询数据库权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eshow grants for \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"字段操作\"\u003e字段操作\u003c/h3\u003e\n\u003cp\u003e1、修改字段类型\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e MODIFY COLUMN name varchar(30)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、修改字段类型\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e CHANGE COLUME name SET DEFAULT NULL\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、修改字段的数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eUPDATE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e SET name=\u0026#39;wangxin\u0026#39;, age=24 WHERE user_id=13\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、增加新字段\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e ADD \u003cspan class=\"sb\"\u003e`country`\u003c/span\u003e varchar(20) NOT NULL\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、删除字段\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e DROP COLUMN \u003cspan class=\"sb\"\u003e`country`\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"键操作\"\u003e键操作\u003c/h3\u003e\n\u003cp\u003e1、查询某张表中存在的键\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eSELECT * FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE t WHERE t.TABLE_NAME =\u0026#39;users\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、添加唯一键\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e ADD UNIQUE KEY \u003cspan class=\"sb\"\u003e`name`\u003c/span\u003e (`name`)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、删除唯一键\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e DROP INDEX \u003cspan class=\"sb\"\u003e`name`\u003c/span\u003e\nALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e ADD UNIQUE INDEX iam_cloud_uk (`name`, \u003cspan class=\"sb\"\u003e`display_name`\u003c/span\u003e) # 注意，主键名中不能包含中划线\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、添加主键\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e ADD PRIMARY KEY \u003cspan class=\"sb\"\u003e`id`\u003c/span\u003e (`id`)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、删除主键\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eALTER TABLE \u003cspan class=\"sb\"\u003e`users`\u003c/span\u003e DROP PRIMARY KEY\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"数据导出命令\"\u003e数据导出命令\u003c/h3\u003e\n\u003cp\u003e1、导出数据库中的数据表结构及数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysqldump -uroot -pAdmin369 xdhuxc \u0026gt; /tmp/xdhuxc.sql\n或\nmysqldump -uroot -p xdhuxc \u0026gt; /tmp/xdhuxc.sql，敲回车后，会提示输入密码\n或\nmysqldump -uroot xdhuxc \u0026gt; /tmp/xdhuxc.sql，敲回车后，会提示输入密码\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、导出数据库表结构\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e-d，--no-data，不导出表数据，只导出表结构。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysqldump -uroot -pAdmin369 -d xdhuxc \u0026gt; /tmp/xdhuxc.sql\n或\nmysqldump -uroot -p -d xdhuxc \u0026gt; /tmp/xdhuxc.sql，敲回车后，会提示输入密码\n或\nmysqldump -uroot -d xdhuxc \u0026gt; /tmp/xdhuxc.sql\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、导出数据库表数据\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e-t，--no-create-info，不包含创建表的信息，只导出表数据\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysqldump -uroot -pAdmin369 -t xdhuxc \u0026gt; /tmp/xdhuxc.sql\n或\nmysqldump -uroot -p -t xdhuxc \u0026gt; /tmp/xdhuxc.sql，敲回车后，会提示输入密码\n或\nmysqldump -uroot -t xdhuxc \u0026gt; /tmp/xdhuxc.sql\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、导出指定表的数据或信息\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e参考上面的命令，在数据库名称后面加上表名称即可。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysqldump -uroot -pAdmin369  -t xdhuxc users \u0026gt; /tmp/xdhuxc_users.sql\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"数据导入命令\"\u003e数据导入命令\u003c/h3\u003e\n\u003cp\u003e1、在命令行 \u003ccode\u003emysql\u0026gt; \u003c/code\u003e 中使用命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esource mysql_script_path\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、将sql脚本导入MySQL数据库\u003c/p\u003e\n\u003cp\u003e1）创建一个空数据库，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecreate database xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）将表结构和数据导入数据库\u003c/p\u003e\n\u003cp\u003e方式一：使用 \u003ccode\u003esource\u003c/code\u003e 命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003euse database_name             # 选择数据库\nset names utf8                # 设置数据库编码\nsource /tmp/database_name.sql # 导入数据库表结构和数据\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e方式二：直接使用命令实现，使用命令为：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e使用–default-character-set = utf8指定编码以避免出现乱码。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emysql -u user_name -p password database_name \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e /tmp/database_name.sql –default-character-set = utf8\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"查询命令\"\u003e查询命令\u003c/h3\u003e\n\u003cp\u003e1、排除某些字符开头的数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e  select * from users where left(email, 6) \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u0026gt; \u0026#34;intern\u0026#34; and is_deleted=false and left(email, 6) \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u0026gt; \u0026#34;nomail\u0026#34;;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 left(args1, args2) 函数来实现，args1 表示数据库表字段，args2 表示从该字段起几个字符\u003c/p\u003e","date":1532822400,"description":"","fuzzywordcount":1100,"kind":"page","lang":"zh","lastmod":1564358400,"objectID":"68fecff370b49039acd6ac4d06fa1a67","publishdate":1532822400,"relpermalink":"/posts/storage/mysql/mysql-common-command/","section":"posts","summary":"\u003cp\u003e本篇博客记录了一些 MySQL 常用命令，方便查找。\u003c/p\u003e","tags":["MySQL","数据库"],"title":"MySQL 常用命令","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-common-command/","wordcount":1048},{"categories":"posts","content":"\u003cp\u003e安装好 MongoDB 数据库后，接下来我们演示下通过命令行来操纵 MongoDB 数据库。\u003c/p\u003e\n\u003ch3 id=\"配置文件参数修改\"\u003e配置文件参数修改\u003c/h3\u003e\n\u003cp\u003eMongoDB 数据库的配置文件为：\u003ccode\u003e/etc/mongod.conf\u003c/code\u003e。\n为了使外部应用能够连接本机（使用 VMware Workstation 创建的虚拟机）安装的 MongoDB 数据库，需要修改 \u003ccode\u003e/etc/mongod.conf\u003c/code\u003e 文件中的 \u003ccode\u003e127.0.0.1\u003c/code\u003e 为本机IP地址。比如，修改\u003ccode\u003e127.0.0.1\u003c/code\u003e 为本虚拟机IP地址 \u003ccode\u003e192.168.91.128\u003c/code\u003e，连接端口保持默认的 \u003ccode\u003e27017\u003c/code\u003e 即可，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# network interfaces\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003enet:\n  port: 27017\n  bindIp: 192.168.91.128  # Enter 0.0.0.0,:: to bind to all IPv4 and IPv6 addresses or, alternatively, use the net.bindIpAll setting.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"使用-mongodb-shell-操作数据库\"\u003e使用 MongoDB shell 操作数据库\u003c/h3\u003e\n\u003ch5 id=\"连接-mongodb-数据库\"\u003e连接 MongoDB 数据库\u003c/h5\u003e\n\u003cp\u003e使用的命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emongo --host 192.168.91.128 --port 27017\n或者\nmongo --host 192.168.91.128 # 由于使用 mongodb的默认端口，可以省略对端口的指定。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# mongo --host 192.168.91.128 -p 27017\nMongoDB shell version v3.7.9-27-g793e59f\nconnecting to: mongodb://192.168.91.128:27017/\nMongoDB server version: 3.7.9-27-g793e59f\nServer has startup warnings:\n2018-05-30T21:51:01.053+0800 I CONTROL  [initandlisten]\n2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e NOTE: This is a development version (3.7.9-27-g793e59f) of MongoDB.\n2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e       Not recommended for production.\n2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten]\n2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e WARNING: Access control is not enabled for the database.\n2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e          Read and write access to data and configuration is unrestricted.\n2018-05-30T21:51:01.069+0800 I CONTROL  [initandlisten]\n2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten]\n2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e WARNING: /sys/kernel/mm/transparent_hugepage/enabled is \u0026#39;always\u0026#39;.\n2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e        We suggest setting it to \u0026#39;never\u0026#39;\n2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten]\n2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e WARNING: /sys/kernel/mm/transparent_hugepage/defrag is \u0026#39;always\u0026#39;.\n2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e        We suggest setting it to \u0026#39;never\u0026#39;\n2018-05-30T21:51:01.092+0800 I CONTROL  [initandlisten]\n\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"创建数据库\"\u003e创建数据库\u003c/h5\u003e\n\u003cp\u003e使用如下命令创建数据库：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003euse database_name\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e具体操作如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eshow dbs       # 显示数据库列表。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eadmin   0.000GB\nconfig  0.000GB\nlocal   0.000GB\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003euse xdhuxc     # 创建数据库并切换至该数据库。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eswitched to db xdhuxc\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eshow dbs       # 再次显示数据库列表，却发现创建的数据库 xdhuxc 不在列表中。要显示新建的数据库，需要至少插入一个文档，空的数据库是不显示出来的。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eadmin   0.000GB\nconfig  0.000GB\nlocal   0.000GB\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb             # 显示当前数据库。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003exdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 MongoDB 中，默认的数据库是 \u003ccode\u003etest\u003c/code\u003e，如果没有创建任何数据库，那么创建的集合和文档将存储在 \u003ccode\u003etest\u003c/code\u003e 数据库中。\u003c/p\u003e\n\u003ch5 id=\"创建集合\"\u003e创建集合\u003c/h5\u003e\n\u003cp\u003e在创建的 \u003ccode\u003exdhuxc\u003c/code\u003e 数据库中创建 \u003ccode\u003eperson\u003c/code\u003e 集合，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003euse xdhuxc\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eswitched to db xdhuxc\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb                            # 显示当前数据库。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003exdhuxc\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.createCollection(\u0026#34;person\u0026#34;) # 在数据库 xdhuxc 中创建集合 person。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e{ \u0026#34;ok\u0026#34; : 1 }\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eshow collections              # 显示当前数据库中的集合。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eperson\n\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"插入数据\"\u003e插入数据\u003c/h5\u003e\n\u003cp\u003e要将数据插入到 MongoDB 集合中，可以使用 MongoDB 的 \u003ccode\u003einsert()\u003c/code\u003e 方法，其基本语法如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edb.collection_name.insert(document)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e向 \u003ccode\u003exdhuxc\u003c/code\u003e 数据库的 \u003ccode\u003eperson\u003c/code\u003e 集合中插入数据，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.person.insert({              # 插入一条记录，文档以json的格式定义。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e     name : \u0026#34;xiaoming\u0026#34;,\n     age : \u0026#34;24\u0026#34;,\n     company : \u0026#34;xdhuxc company\u0026#34;\n})\nWriteResult({ \u0026#34;nInserted\u0026#34; : 1 })\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003eperson\u003c/code\u003e 为集合的名称，如果集合中不存在 \u003ccode\u003eperson\u003c/code\u003e 集合，那么 MongoDB 将创建该集合，然后将文档插入该集合中。\n在插入的文档中，如果不指定_id参数，那么MongoDB会为此文档分配一个唯一的ObjectId。_id为集合中每个文档唯一的12个字节的十六进制数，12个字节划分如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e_id: ObjectId(4 bytes timestamp, 3 bytes machine id, 2 bytes process id,\n   3 bytes incrementer)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查询所有文档，将以非结构化方式显示所有文档。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.person.find()\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e{ \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5b0f384f244fc0152ed71f5f\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;xiaoming\u0026#34;, \u0026#34;age\u0026#34; : \u0026#34;24\u0026#34;, \u0026#34;company\u0026#34; : \u0026#34;xdhuxc company\u0026#34; }\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e再插入一条数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.person.insert({\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e     name : \u0026#34;dalong\u0026#34;,\n     age : \u0026#34;29\u0026#34;,\n     company : \u0026#34;Apple company\u0026#34;\n})\nWriteResult({ \u0026#34;nInserted\u0026#34; : 1 })\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.person.find()\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e{ \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5b0f384f244fc0152ed71f5f\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;xiaoming\u0026#34;, \u0026#34;age\u0026#34; : \u0026#34;24\u0026#34;, \u0026#34;company\u0026#34; : \u0026#34;xdhuxc company\u0026#34; }\n{ \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5b0f3aa0244fc0152ed71f60\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;dalong\u0026#34;, \u0026#34;age\u0026#34; : \u0026#34;29\u0026#34;, \u0026#34;company\u0026#34; : \u0026#34;Apple company\u0026#34; }\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e接下来，插入一条结构不相同的数据\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.person.insert({\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e     name : \u0026#34;dalong\u0026#34;,\n     age : \u0026#34;29\u0026#34;,\n     company : \u0026#34;Apple company\u0026#34;,\n     address : \u0026#34;Beijing\u0026#34;\n})\nWriteResult({ \u0026#34;nInserted\u0026#34; : 1 })\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.person.find()\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e{ \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5b0f384f244fc0152ed71f5f\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;xiaoming\u0026#34;, \u0026#34;age\u0026#34; : \u0026#34;24\u0026#34;, \u0026#34;company\u0026#34; : \u0026#34;xdhuxc company\u0026#34; }\n{ \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5b0f3aa0244fc0152ed71f60\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;dalong\u0026#34;, \u0026#34;age\u0026#34; : \u0026#34;29\u0026#34;, \u0026#34;company\u0026#34; : \u0026#34;Apple company\u0026#34; }\n{ \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5b0f3aeb244fc0152ed71f61\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;dalong\u0026#34;, \u0026#34;age\u0026#34; : \u0026#34;29\u0026#34;, \u0026#34;company\u0026#34; : \u0026#34;Apple company\u0026#34;, \u0026#34;address\u0026#34; : \u0026#34;Beijing\u0026#34; }\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看出，在 MongoDB 中，是以文档的形式来组织非结构化数据的，文档的结构可由使用者自己定义，和 关系型数据库有很大的区别。\u003c/p\u003e\n\u003ch5 id=\"删除文档\"\u003e删除文档\u003c/h5\u003e\n\u003cp\u003e使用如下命令删除文档：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.person.remove({})            # 删除集合 person 中的所有文档\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eWriteResult({ \u0026#34;nRemoved\u0026#34; : 3 })\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.person.find()                # 再次查询所有文档，已经在上一步全部删除了，所以没有结果返回。\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"删除数据库\"\u003e删除数据库\u003c/h5\u003e\n\u003cp\u003e① 切换到待删除数据库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eshow dbs\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eadmin   0.000GB\nconfig  0.000GB\nlocal   0.000GB\nxdhuxc  0.000GB\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003euse xdhuxc\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eswitched to db xdhuxc\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003exdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e② 删除当前数据库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003edb.dropDatabase()\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e{ \u0026#34;dropped\u0026#34; : \u0026#34;xdhuxc\u0026#34;, \u0026#34;ok\u0026#34; : 1 }\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e③ 查看删除结果\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003eshow dbs\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003eadmin   0.000GB\nconfig  0.000GB\nlocal   0.000GB\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到，数据库 xdhuxc 已经被删除。\u003c/p\u003e\n\u003ch3 id=\"官方文档\"\u003e官方文档\u003c/h3\u003e\n\u003cp\u003eMongoDB 的官方文档网址：http://www.mongoing.com/docs/mongo.html\u003c/p\u003e\n\u003cp\u003e更多详细的有关 MongoDB的知识，大家可以去 MongoDB 的官方网站学习。\u003c/p\u003e\n","date":1532044800,"description":"","fuzzywordcount":1500,"kind":"page","lang":"zh","lastmod":1557964800,"objectID":"4f2cc8762b50242f9f4ba9e2f8f2eec8","publishdate":1532044800,"relpermalink":"/posts/storage/mongodb/mongodb-simple-use/","section":"posts","summary":"安装好 MongoDB 数据库后，接下来我们演示下通过命令行来操纵 MongoDB 数据库。 配置文件参数修改 MongoDB 数据库的配置文件为：/etc/mongod.conf。 为了使外部应用能够连接本机（使用 VMware Workstation 创建的虚拟机）安装的 MongoDB 数据库，需要修改 /etc/mongod.conf 文件中的 127.0.0.1 为本机IP地址。比如，修改127.0.0.1 为本虚拟机IP地址 192.168.91","tags":["数据库","MongoDB"],"title":"MongoDB 数据库初步使用","url":"https://xdhuxc.github.io/posts/storage/mongodb/mongodb-simple-use/","wordcount":1498},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了使用 docker 容器方式部署 FastDFS 的方法。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e在 \u003ccode\u003e/home/xdhuxc/fastdfs/\u003c/code\u003e 目录下创建 \u003ccode\u003etracker\u003c/code\u003e，\u003ccode\u003econf\u003c/code\u003e，\u003ccode\u003estorage/data\u003c/code\u003e，\u003ccode\u003estore_path\u003c/code\u003e 目录。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、拉取 fastdfs 镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull season/fastdfs:1.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动 tracker 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    -p 22122:22122 \\\n    --net host \\\n    -v /home/xdhuxc/fastdfs/tracker:/fastdfs/tracker/data \\\n    -v /home/xdhuxc/fastdfs/conf:/fdfs_conf \\\n    --name fastdfs-tracker \\\n    season/fastdfs:1.2 tracker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 storage 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --net host \\\n    -v /home/xdhuxc/fastdfs/storage/data:/fastdfs/storage \\\n    -v /home/xdhuxc/fastdfs/store_path:/fastdfs/store_path \\\n    -e TRACKER_SERVER=192.168.244.128:22122 \\\n    --name fastdfs-storage \\\n    season/fastdfs:1.2 storage\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e容器内配置文件目录为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/fdfs_conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、测试程序见 \u003ca href=\"mailto:git@github.com\"\u003egit@github.com\u003c/a\u003e:xdhuxc/integration.git\u003c/p\u003e","date":1532044800,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1517097600,"objectID":"f659bd30ab6e45db01d0ae33a0516338","publishdate":1532044800,"relpermalink":"/posts/storage/fastdfs/fastdfs-docker/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了使用 docker 容器方式部署 FastDFS 的方法。\u003c/p\u003e","tags":["FastDFS","Docker","数据库"],"title":"使用 docker 容器方式部署 FastDFS","url":"https://xdhuxc.github.io/posts/storage/fastdfs/fastdfs-docker/","wordcount":169},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了使用 GitLab 时遇到的若干问题及解决方法，以备后需。\u003c/p\u003e\n\u003ch3 id=\"使用指南\"\u003e使用指南\u003c/h3\u003e\n\u003cp\u003e1、在 \u003ccode\u003eJenkins\u003c/code\u003e 中编写 \u003ccode\u003eshell\u003c/code\u003e 脚本拉取公司 \u003ccode\u003eGitLab\u003c/code\u003e 中的代码，会缺少拉取权限，由管理员操作，点击 \u003ccode\u003e设置\u003c/code\u003e -\u0026gt; \u003ccode\u003e仓库\u003c/code\u003e -\u0026gt; \u003ccode\u003e部署秘钥\u003c/code\u003e -\u0026gt; \u003ccode\u003e展开\u003c/code\u003e，使用 Jenkins 所在机器的 SSH 公钥创建一个 \u003ccode\u003e部署秘钥\u003c/code\u003e，然后在各工程中启用之，即可获得拉取代码得权限。\u003c/p\u003e\n\u003ch3 id=\"常见问题及解决\"\u003e常见问题及解决\u003c/h3\u003e\n\u003cp\u003e1、在 \u003ccode\u003eGitLab\u003c/code\u003e 中某项目的 \u003ccode\u003e设置\u003c/code\u003e -\u0026gt; \u003ccode\u003e集成\u003c/code\u003e 中配置 \u003ccode\u003eJenkins webhook\u003c/code\u003e，配置完成后点击 \u003ccode\u003eTest\u003c/code\u003e，报错如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eHook execution failed: URL 'https://jenkins.xdhuxc.me/project/xdhuxc' is blocked: Requests to the local network are not allowed\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e解决：在 \u003ccode\u003e管理员区域\u003c/code\u003e 中 \u003ccode\u003e设置\u003c/code\u003e 下，在 \u003ccode\u003eOutbound requests\u003c/code\u003e部分，选择 \u003ccode\u003eAllow requests to the local network from hooks and services\u003c/code\u003e，然后保存之。\u003c/p\u003e\n\u003cp\u003e参考链接：https://gitlab.com/gitlab-org/gitlab-ce/issues/46490\u003c/p\u003e","date":1531958400,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1534636800,"objectID":"c18939ab46dcd77838bbd8ff6539f9e8","publishdate":1531958400,"relpermalink":"/posts/mixed/git/git-gitlab/","section":"posts","summary":"\u003cp\u003e本篇博客记录了使用 GitLab 时遇到的若干问题及解决方法，以备后需。\u003c/p\u003e","tags":["Git","GitLab"],"title":"GitLab 常见问题及解决","url":"https://xdhuxc.github.io/posts/mixed/git/git-gitlab/","wordcount":302},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 MySQL 的常用基础知识，可用于日常学习。\u003c/p\u003e\n\u003ch3 id=\"mysql-主机-127001-与-localhost-的区别\"\u003eMySQL 主机 127.0.0.1 与 localhost 的区别\u003c/h3\u003e\n\u003cp\u003e1、\u003ccode\u003emysql -h 127.0.0.1\u003c/code\u003e 的时候，使用 \u003ccode\u003eTCP/IP\u003c/code\u003e 连接，\u003ccode\u003emysql\u003c/code\u003e 服务器认为该连接来自于 \u003ccode\u003e127.0.0.1\u003c/code\u003e 或者是 \u003ccode\u003elocalhost.localdomain\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e2、\u003ccode\u003emysql -h localhost\u003c/code\u003e 的时候，使用 \u003ccode\u003eUnix Socket\u003c/code\u003e 连接，不是使用 \u003ccode\u003eTCP/IP\u003c/code\u003e 连接，不受网络防火墙和网卡相关的的限制，此时，\u003ccode\u003emysql\u003c/code\u003e 服务器认为该客户端是来自 \u003ccode\u003elocalhost\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e3、mysql 权限管理中的 \u003ccode\u003elocalhost\u003c/code\u003e 有特定含义。\u003c/p\u003e\n\u003cp\u003e虽然两者连接方式有所区别，但当 \u003ccode\u003elocalhost\u003c/code\u003e 为默认的 \u003ccode\u003e127.0.0.1\u003c/code\u003e 时，两种连接方式使用的权限记录都是以下的1.row的记录（因为记录在前，先被匹配）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e*************************** 1. row \u003cspan class=\"ge\"\u003e**\u003c/span\u003e*************************\n                Host: localhost\n                User: root\n......\n\n\u003cspan class=\"ge\"\u003e**\u003c/span\u003e************************* 2. row \u003cspan class=\"ge\"\u003e**\u003c/span\u003e*************************\n                Host: 127.0.0.1\n                User: root\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"innodb-引擎\"\u003eInnoDB 引擎\u003c/h4\u003e\n\u003cp\u003eInnoDB 引擎为独立表空间模式，每个数据库的每个表都会生成一个数据空间。\u003c/p\u003e\n\u003cp\u003e独立表空间的优点：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e每个表都有自己独立的表空间。\u003c/li\u003e\n\u003cli\u003e每个表的数据和索引都会存在自己的表空间中。\u003c/li\u003e\n\u003cli\u003e可以实现单表在不同的数据库中移动。\u003c/li\u003e\n\u003cli\u003e空间可以回收（除 drop table 操作外，表空间不能自己回收）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e独立表空间的缺点：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e单表增加过大，如超过100G。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e结论：\u003c/p\u003e\n\u003cp\u003e共享表空间在 insert 操作上稍有优势，其他都没独立表空间表现好。当启用独立表空间时，需要合理调整 innodb_open_files 参数的值。\u003c/p\u003e","date":1531958400,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1540166400,"objectID":"7080ba566b68dbe9b3de3ad681ecd373","publishdate":1531958400,"relpermalink":"/posts/storage/mysql/mysql-knowledge/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 MySQL 的常用基础知识，可用于日常学习。\u003c/p\u003e","tags":["MySQL"],"title":"MySQL 基础知识总结","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-knowledge/","wordcount":443},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了些 Linux 系统中的常用操作，以备后需。\u003c/p\u003e\n\u003ch3 id=\"清理过大的-cache-内存\"\u003e清理过大的 cache 内存\u003c/h3\u003e\n\u003cp\u003e清理过大的cache内存，系统中运行大量容器，cache过大\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/cache-1.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e/proc是一个虚拟文件系统，可以通过对它的读写操作，做为与kernel实体间进行通信的一种手段。也就是说，可以通过修改/proc中的文件，来对当前kernel的行为做出调整。我们可以通过调整/proc/sys/vm/drop_caches来释放内存。\u003c/p\u003e\n\u003cp\u003e1）查看 \u003ccode\u003e/proc/sys/vm/drop_caches\u003c/code\u003e 的值，默认为 \u003ccode\u003e0\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/cache-2.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e2）执行sync命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esync\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003esync 命令运行 sync 子命令。如果必须停止系统，则运行 sync 命令以确保文件系统的完整性。sync 命令将所有未写的系统缓冲区写到磁盘中，包含已修改的 i-node、已延迟的块 I/O 和读写映射文件。\u003c/p\u003e\n\u003cp\u003e3）将/proc/sys/vm/drop_caches的值设置为3\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho 3 \u0026gt; /proc/sys/vm/drop_caches\n\u003cspan class=\"gh\"\u003e#查看/proc/sys/vm/drop_caches的当前值\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecat /proc/sys/vm/drop_caches\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/cache-3.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003edrop_caches 数值的含义：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eecho 1 \u0026gt; /proc/sys/vm/drop_caches #仅清除页面缓存\u003c/li\u003e\n\u003cli\u003eecho 2 \u0026gt; /proc/sys/vm/drop_caches #清除目录项和inode\u003c/li\u003e\n\u003cli\u003eecho 3 \u0026gt; /proc/sys/vm/drop_caches #清除页面缓存，目录项和inode\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"挂载磁盘\"\u003e挂载磁盘\u003c/h3\u003e\n\u003cp\u003e1、使用 \u003ccode\u003efdisk –l\u003c/code\u003e（查看当前系统所有硬盘及分区情况）， 找到待挂载的磁盘。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/disk.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e2、创建分区待挂载的目录，例如 \u003ccode\u003e/xdhuxc\u003c/code\u003e，必须是空目录。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir /xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、格式化新建的磁盘分区。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkfs.ext4 /dev/vdb\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、修改 /etc/fstab，添加如下内容，将分区信息写进去。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/dev/vdb  /xdhuxc      ext4    defaults        0 0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、执行如下命令，加载所有在fstab中记录的文件系统。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emount –a\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"打包时的文件格式转换和赋权\"\u003e打包时的文件格式转换和赋权\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efind ./ -regex \u0026#39;.*\\.sh$\u0026#39; -or -regex \u0026#39;.*\\.exp$\u0026#39; | xargs chmod 755 \u0026gt; /dev/null\nfind ./ -regex \u0026#39;.*\\.sh$\u0026#39; -or -regex \u0026#39;.*\\.exp$\u0026#39; | xargs dos2unix -q\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"使用curl不产生输出\"\u003e使用curl不产生输出\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -s http://www.baidu.com 2\u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e1 \u0026gt; /dev/null\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"调整进程优先级\"\u003e调整进程优先级\u003c/h3\u003e\n\u003ch4 id=\"nice-命令\"\u003enice 命令\u003c/h4\u003e\n\u003cp\u003enice 命令可以修改进程的优先级，进而调整进程的调度。nice 命令是在进程启动时调整进程的优先级。nice 值的范围为：[-20, 19]，-20 表示进程的最高优先级，19 表示进程的最低优先级。Linux 进程的默认 nice 值为：0。使用 nice 可调整进程的优先级，这样调度器就会依据进程优先级为其分配 CPU 资源。\u003c/p\u003e\n\u003cp\u003e1、执行命令 \u003ccode\u003esleep 300 \u0026amp;\u003c/code\u003e，然后查看该进程\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/nice-1.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e没有 nice 命令，进程优先级数值为 0，进程优先级 NI 默认值为：0\u003c/p\u003e\n\u003cp\u003e2、执行命令 \u003ccode\u003enice sleep 300 \u0026amp;\u003c/code\u003e，然后查看该进程\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/nice-2.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e使用 nice 命令后，优先级 NI 的数值为 10，nice 命令将 NI 默认调整为 10，降低了该进程的优先级。\u003c/p\u003e\n\u003cp\u003e3、执行命令 \u003ccode\u003enice -n 15 sleep 300 \u0026amp;\u003c/code\u003e，然后查看该进程\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/nice-3.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在默认值 0 的基础上加 15，非管理员可以将 NI 值调整为 0~19 之间的任意值，降低了进程的优先级。\u003c/p\u003e\n\u003cp\u003e4、执行命令 \u003ccode\u003enice -n -15 sleep 300 \u0026amp;\u003c/code\u003e，然后查看该进程\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/nice-4.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e仅管理员可以在默认值的基础上 -n，调高进程的优先级，普通用户无权调高进程优先级。\u003c/p\u003e\n\u003cp\u003e在实际应用中，如果要运行一个 CPU 密集型程序，就可以通过 nice 命令来启动它，这样可以保证其进程获得更高的优先级，即使服务器或者台式机在负载很重的情况下，也可以快速响应。\u003c/p\u003e\n\u003ch4 id=\"renice-命令\"\u003erenice 命令\u003c/h4\u003e\n\u003cp\u003erenice 命令可以重新调整进程执行的优先级，可以指定群组或者用户名调整进程优先级等级，并修改隶属于该群组或用户的所有程序优先级。等级范围为：[-20, 19]，同样，只有管理员可以调高优先级，用于调整运行中的进程的优先级。\u003c/p\u003e\n\u003cp\u003e使用方法和 nice 相同\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/common-operations/renice.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e一个紧急进程，需要更多的 CPU 资源时，可以调高运行中的该进程。\u003c/p\u003e\n\u003ch3 id=\"配置-centos-但需要不更新-dns\"\u003e配置 CentOS 但需要不更新 DNS\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e配置CentOS不更新DNS，即不刷新/etc/resolv.conf文件\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e修改配置 \u003ccode\u003e/etc/NetworkManager/NetworkManager.conf\u003c/code\u003e，添加 \u003ccode\u003edns=none\u003c/code\u003e，修改完成后，使用 \u003ccode\u003esystemctl restart NetworkManager\u003c/code\u003e 命令重启 \u003ccode\u003eNetworkManager\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"升级-linux-内核\"\u003e升级 Linux 内核\u003c/h3\u003e\n\u003cp\u003e1、导入ELRepo\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org (external link)\nrpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm (external link)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、列出可用的内核软件包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@wanghuan-private-test-5 yum.repos.d]# yum --disablerepo=\u0026#34;*\u0026#34; --enablerepo=\u0026#34;elrepo-kernel\u0026#34; list available\nLoaded plugins: fastestmirror\nelrepo-kernel                                                                                                                                   | 2.9 kB  00:00:00     \nelrepo-kernel/primary_db                                                                                                                        | 1.8 MB  00:00:13     \nLoading mirror speeds from cached hostfile\n \u003cspan class=\"k\"\u003e*\u003c/span\u003e elrepo-kernel: mirrors.tuna.tsinghua.edu.cn\nAvailable Packages\nkernel-lt.x86_64                                                                   4.4.142-1.el7.elrepo                                                   elrepo-kernel\nkernel-lt-devel.x86_64                                                             4.4.142-1.el7.elrepo                                                   elrepo-kernel\nkernel-lt-doc.noarch                                                               4.4.142-1.el7.elrepo                                                   elrepo-kernel\nkernel-lt-headers.x86_64                                                           4.4.142-1.el7.elrepo                                                   elrepo-kernel\nkernel-lt-tools.x86_64                                                             4.4.142-1.el7.elrepo                                                   elrepo-kernel\nkernel-lt-tools-libs.x86_64                                                        4.4.142-1.el7.elrepo                                                   elrepo-kernel\nkernel-lt-tools-libs-devel.x86_64                                                  4.4.142-1.el7.elrepo                                                   elrepo-kernel\nkernel-ml.x86_64                                                                   4.17.8-1.el7.elrepo                                                    elrepo-kernel\nkernel-ml-devel.x86_64                                                             4.17.8-1.el7.elrepo                                                    elrepo-kernel\nkernel-ml-doc.noarch                                                               4.17.8-1.el7.elrepo                                                    elrepo-kernel\nkernel-ml-headers.x86_64                                                           4.17.8-1.el7.elrepo                                                    elrepo-kernel\nkernel-ml-tools.x86_64                                                             4.17.8-1.el7.elrepo                                                    elrepo-kernel\nkernel-ml-tools-libs.x86_64                                                        4.17.8-1.el7.elrepo                                                    elrepo-kernel\nkernel-ml-tools-libs-devel.x86_64                                                  4.17.8-1.el7.elrepo                                                    elrepo-kernel\nperf.x86_64                                                                        4.17.8-1.el7.elrepo                                                    elrepo-kernel\npython-perf.x86_64                                                                 4.17.8-1.el7.elrepo                                                    elrepo-kernel\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、安装最新的主线稳定内核\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum --enablerepo=elrepo-kernel install kernel-ml\nyum install -y kernel-ml.x86_64 --enablerepo=elrepo-kernel\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、设置GRUB默认的内核版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egrub2-set-default 0 # 设置GRUB初始化页面的第一个内核将作为默认内核。\ngrub2-mkconfig -o /boot/grub2/grub.cfg # 重新创建内核配置。\nreboot  # 重新启动机器才能使新内核生效。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1531440000,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1534636800,"objectID":"8fe8ea78ba71d7c6e8a9ae95d1a9efc9","publishdate":1531440000,"relpermalink":"/posts/linux/linux-common-operations/","section":"posts","summary":"\u003cp\u003e本篇博客记录了些 Linux 系统中的常用操作，以备后需。\u003c/p\u003e","tags":["Linux"],"title":"Linux 常用操作总结","url":"https://xdhuxc.github.io/posts/linux/linux-common-operations/","wordcount":1626},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 HTTP 协议中的长连接和短连接，算是 HTTP 协议中进阶的内容。\u003c/p\u003e\n\u003ch4 id=\"http-协议与-tcpip-协议的关系\"\u003eHTTP 协议与 TCP/IP 协议的关系\u003c/h4\u003e\n\u003cp\u003eHTTP 的长连接和短连接本质上是 TCP 的长连接和短连接。HTTP 协议属于应用层协议，在传输层使用 TCP 协议，在网络层使用 IP 协议。IP 协议主要解决网络路由和寻址问题，TCP 协议主要解决如何在 IP 层之上可靠地传输数据包，使在网络上的另一端收到发送端发出的所有包，并且接收顺序与发送顺序一致，TCP 有可靠、面向连接的特点。\u003c/p\u003e\n\u003ch4 id=\"http-协议是无状态的\"\u003eHTTP 协议是无状态的\u003c/h4\u003e\n\u003cp\u003eHTTP 协议是无状态的，指的是协议对于事务的处理没有记忆能力，服务端不知道客户端是什么状态。也就是说，打开一个服务器上的网页和之前打开这个服务器上的同一网页之间没有任何联系。HTTP 是一个无状态的面向连接的协议，无状态不代表 HTTP 不能保持 TCP 连接，更不能代表 HTTP 使用的是 UDP 协议（无连接的协议）\u003c/p\u003e\n\u003ch4 id=\"长连接短连接\"\u003e长连接，短连接\u003c/h4\u003e\n\u003cp\u003e在 HTTP/1.0 中，默认使用的是短连接。也就是说，\u003ccode\u003e浏览器和服务器每进行一次 HTTP操作，就建立一次连接，但任务结束就中断连接\u003c/code\u003e。如果客户端浏览器访问的某个 HTML 或其他类型的 Web 页中包含有其他的 Web 资源，如 JavaScript文件、图像文件、CSS文件等；当浏览器每遇到这样一个 Web 资源，就会建立一个 HTTP 会话。\u003c/p\u003e\n\u003cp\u003e但从 HTTP/1.1 起，默认使用长连接，用以保持连接特性。使用长连接的 HTTP 协议，会在响应头有加入这行代码：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eConnection:keep-alive\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输 HTTP 数据的 TCP 连接不会关闭。如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的连接。Keep-Alive 不会永久保持连接，它有一个保持时间，可以在不同的服务器软件中设定这个时间。实现长连接要客户端和服务端都支持长连接。\u003c/p\u003e\n\u003cp\u003eHTTP 协议的长连接和短连接，实质上是 TCP 协议的长连接和短连接。\u003c/p\u003e\n\u003ch3 id=\"tcp-连接\"\u003eTCP 连接\u003c/h3\u003e\n\u003cp\u003e当网络通信采用TCP协议时，在真正的读写操作之前，服务器与客户端之间必须建立一个连接，当读写操作完成后，双方不再需要这个连接时，它们可以释放这个连接，连接的建立是需要三次握手的，而释放则需要四次挥手，所以说每个连接的建立都是需要资源消耗和时间消耗的。\u003c/p\u003e\n\u003cp\u003e经典的三次握手示意图：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"C:/Users/wanghuan/Desktop/%E7%94%B5%E5%AD%90%E4%B9%A6/three_times.jpg\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003e经典的四次挥手示意图：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"C:/Users/wanghuan/Desktop/%E7%94%B5%E5%AD%90%E4%B9%A6/four_times.jpg\" alt=\"image\"\u003e\u003c/p\u003e\n\u003ch4 id=\"tcp-短连接\"\u003eTCP 短连接\u003c/h4\u003e\n\u003cp\u003eTCP短连接的情况，客户端向服务器发起连接请求，服务器接收到请求，然后双方建立连接。客户端向服务器发送消息，服务器回应客户端，然后一次读写操作就完成了。\u003c/p\u003e\n\u003cp\u003e这时候双方任何一个都可以发起close操作，不过一般都是客户端先发起close操作，因为一般的服务器不会响应完客户端后立即关闭连接的，当然不排除有特殊的情况。所以，短连接一般只会在客户端/服务器之间传递一次读写操作。\u003c/p\u003e\n\u003cp\u003e短连接的优点是：管理起来比较简单，存在的连接都是有用的连接，不需要额外的控制手段。\u003c/p\u003e\n\u003ch3 id=\"tcp-长连接\"\u003eTCP 长连接\u003c/h3\u003e\n\u003cp\u003eTCP 长连接的情况，客户端向服务端发起连接请求，服务端接收到客户端的连接请求，双方建立连接。客户端与服务端完成一次读写之后，他们之间的连接并不会主动关闭，后续的读写操作会继续使用这个连接。\u003c/p\u003e\n\u003cp\u003eTCP的保活功能，保活功能主要为服务器应用提供，服务器应用希望知道客户主机是否崩溃，从而可以代表客户端使用资源。如果客户端已经消失，使得服务器上保留着一个半开放的连接，而服务器又在等待来自客户端的数据，则服务器将永远等待客户端的数据。保活功能就是试图在服务器端检测到这种半开放的连接。\u003c/p\u003e\n\u003cp\u003e如果一个给定的连接在两个小时内没有任何的动作，则服务器就向客户端发一个探测报文段，客户端必须处于以下四个状态之一：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e客户端依然正常运行，并从服务器可达。客户端的TCP响应正常，而服务器也知道对方是正常的，服务器在两个小时后将保活定时器复位。\u003c/li\u003e\n\u003cli\u003e客户端已经崩溃，并且关闭或者正在重新启动。在任何一种情况下，客户端的TCP都没有响应。服务端将不能收到对探测的响应，并在75秒后超时。服务器总共发送10个这样的探测，每个间隔75秒。如果服务器没有收到一个响应，它就认为客户端已经关闭并终止连接。\u003c/li\u003e\n\u003cli\u003e客户端崩溃并已经重新启动。服务器将收到一个对其保活探测的响应，这个响应是一个复位，使得服务器终止这个连接。\u003c/li\u003e\n\u003cli\u003e客户端正常运行，但是服务器不可达，这种情况与第二种情况类似，TCP能发现的就是没有收到探查的响应。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"长连接和短连接的操作过程\"\u003e长连接和短连接的操作过程\u003c/h3\u003e\n\u003cp\u003e短连接的操作步骤是：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e建立连接-\u0026gt;数据传输-\u0026gt;关闭连接...建立连接-\u0026gt;数据传输-\u0026gt;关闭连接\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e长连接的操作步骤是：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e建立连接-\u0026gt;数据传输...(保持连接)...数据传输-\u0026gt;关闭连接\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"长连接和短连接的优点和缺点\"\u003e长连接和短连接的优点和缺点\u003c/h3\u003e\n\u003cp\u003e长连接可以省去较多的TCP建立和关闭操作，减少浪费，节约时间。对于频繁请求资源的客户来说，比较适用长连接。不过这里存在一个问题，存活功能的探测周期太长，还有就是它只是探测TCP连接的存活，属于比较斯文的做法。遇到恶意的连接时，保活功能就不够使了。在长连接的应用场景下，客户端一般不会主动关闭它们之间的连接，客户端与服务器之间的连接如果一直不关闭的话，会存在一个问题，随着客户端连接越来越多，服务器早晚有扛不住的时候，这时候服务器需要采取一些策略，如关闭一些长时间没有读写事件发生的连接，这样可以避免一些恶意连接导致服务端服务受损；如果条件再允许的话，就可以以客户端机器为颗粒度，限制每个客户端的最大长连接数，这样可以完全避免某个客户端连累后端服务。\u003c/p\u003e\n\u003cp\u003e短连接对于服务器来说管理较为简单，存在的连接都是有用的连接，不需要额外的控制手段。但如果客户端请求频繁，将在TCP的建立和关闭操作上浪费时间和带宽。\u003c/p\u003e\n\u003cp\u003e长连接和短连接的产生在于客户端和服务器采取的关闭策略，具体的应用场景采用具体的策略，没有十全十美的选择，只有合适的选择。\u003c/p\u003e\n\u003ch3 id=\"长连接和短连接的使用场景\"\u003e长连接和短连接的使用场景\u003c/h3\u003e\n\u003cp\u003e长连接多用于操作频繁、点对点的通讯，而且连接数不能太多的情况。每个TCP连接都需要三次握手，这需要时间。如果每个操作都是先连接，再操作的话，那么处理速度会降低很多，所以每个操作完后都不断开，再次处理时直接发送数据包就行，不用建立TCP连接。例如，数据库的连接使用长连接，如果用短连接频繁地通信会造成socket错误，而且频繁的socket创建也是对资源的浪费。\u003c/p\u003e\n\u003cp\u003e而像Web网站的HTTP服务一般都用短连接，因为长连接对于服务器来说会耗费一定的资源，而像Web网站这么频繁的成千上万甚至上亿客户端的连接用短连接会更省一些资源，如果使用长连接，而且同时有成千上万的用户，如果每个用户都占用一个连接的话，那么服务器端肯定承受不了。所以，并发量大，但每个用户无需频繁操作的情况下，使用短连接较好。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://maimai.cn/article/detail?fid=469286418\"\u003ehttps://maimai.cn/article/detail?fid=469286418\u003c/a\u003e\u003c/p\u003e","date":1531353600,"description":"","fuzzywordcount":2700,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"652e8704c9ebd5f223812f988517b64d","publishdate":1531353600,"relpermalink":"/posts/common/http/http-long-and-short-connection/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 HTTP 协议中的长连接和短连接，算是 HTTP 协议中进阶的内容。\u003c/p\u003e","tags":["HTTP"],"title":"HTTP 的长连接和短连接","url":"https://xdhuxc.github.io/posts/common/http/http-long-and-short-connection/","wordcount":2621},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Linux Shell 脚本编写中常用的语法知识。\u003c/p\u003e\n\u003ch3 id=\"shell简介\"\u003eShell简介\u003c/h3\u003e\n\u003cp\u003eShell 是顺序执行的命令列表\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ebash shell\u003c/code\u003e 的命令分为两类：外部命令和内部命令。外部命令是通过系统调用或独立的程序实现的，如sed、awk等等。内部命令是由特殊的文件格式（.def）所实现，如cd、history、exec等等。\u003c/p\u003e\n\u003ch3 id=\"binbash的含义\"\u003e#!/bin/bash的含义\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e#!/bin/bash\u003c/code\u003e 指此脚本使用 \u003ccode\u003e/bin/bash\u003c/code\u003e 来解释执行，\u003ccode\u003e#!\u003c/code\u003e 是特殊的表示符，其后跟的是解释执行此脚本的 \u003ccode\u003eshell\u003c/code\u003e 的路径。\u003c/p\u003e\n\u003ch3 id=\"参数的含义\"\u003e$参数的含义\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e$$  是脚本运行的当前进程ID号\u003c/li\u003e\n\u003cli\u003e$#  表示传递给脚本的参数个数\u003c/li\u003e\n\u003cli\u003e$!  是最后执行的后台命令的PID\u003c/li\u003e\n\u003cli\u003e$0  是脚本本身的名字\u003c/li\u003e\n\u003cli\u003e$1  是传递给该Shell脚本或函数的第一个参数\u003c/li\u003e\n\u003cli\u003e$2  是传递给该Shell脚本或函数的第二个参数\u003c/li\u003e\n\u003cli\u003e$n  是传递给该Shell脚本或函数的第n个参数\u003c/li\u003e\n\u003cli\u003e$?  显示最后命令的退出状态，0表示没有错误，其他表示有错误\u003c/li\u003e\n\u003cli\u003e$@  表示传递给该脚本或函数的所有参数的列表\u003c/li\u003e\n\u003cli\u003e$*  是以一个单字符串显示所有向脚本传递的参数，与位置变量不同，参数可超过九个。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e关于 \u003ccode\u003e@\u003c/code\u003e 和 \u003ccode\u003e*\u003c/code\u003e 的异同：\u003c/p\u003e\n\u003cp\u003e相同点：都是引用所有参数\u003c/p\u003e\n\u003cp\u003e不同点：只有在双引号中体现出来。假设在脚本运行时写了三个参数，分别存储在1、2、3，则“@”等价于“1”、“2”、“3”（传递了三个参数）；而“*”表示“123”（传递了一个参数）\u003c/p\u003e\n\u003ch3 id=\"getopts-命令\"\u003egetopts 命令\u003c/h3\u003e\n\u003cp\u003e内部命令 getopts可以很方便地处理命令行参数，其一般格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egetopts options variable\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003egetopts 的设计目标是在循环中运行，每次执行循环，getopts就检查下一个命令行参数，并判断它是否合法，即检查参数是否以“-”开头，后面跟一个包含在options中的字母。如果是，就把匹配的选项字母存储在指定的变量variable中，并返回退出状态0；如果“-”后面的字母没有包含在options中，就在variable中存入一个“？”，并返回退出状态0；如果命令行中已经没有参数，或者下一个参数不以“-”开头，就返回不为0的退出状态。\u003c/p\u003e\n\u003cp\u003e注意以下几点：\u003c/p\u003e\n\u003cp\u003e1、getopts允许把选项堆叠在一起（如-ms）。\u003c/p\u003e\n\u003cp\u003e2、如果要带参数，须在对应选项后加“:”（如h后需要加参数h:ms），此时选项和参数之间至少有一个空白字符分隔，这样的选项不能堆叠。\u003c/p\u003e\n\u003cp\u003e3、如果在需要参数的选项之后没有找到参数，它就在给定的变量中存入“?”，并向标准错误输出中写入错误信息；否则将实际参数写入特殊变量：OPTARG。\u003c/p\u003e\n\u003cp\u003e4、另外一个特殊变量：OPTIND，反映下一个要处理的参数索引，初值是1，每次执行getopts时都会更新。\u003c/p\u003e\n\u003ch3 id=\"local\"\u003elocal\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e一般用于局部变量声明，多在函数内部使用。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、Shell脚本中定义的变量是全局变量，其作用域从被定义的地方开始，到Shell脚本结束或被显式删除处为止。\u003c/p\u003e\n\u003cp\u003e2、Shell函数定义的变量默认是全局变量，其作用域从函数被调用时执行变量定义的地方开始，到Shell脚本结束或被显式删除处为止。函数定义的变量可以被显式定义成局部的，其作用域局限于函数内。但请注意，函数的参数是局部的。\u003c/p\u003e\n\u003cp\u003e3、如果同名，Shell函数定义的局部变量会屏蔽脚本定义的全局变量。\u003c/p\u003e\n\u003ch3 id=\"shift\"\u003eshift\u003c/h3\u003e\n\u003cp\u003eshift 命令用于对参数的移动（左移），通常用于在不知道传入参数个数的情况下依次遍历每个参数，然后进行相应处理，常见于Linux中各种程序的启动脚本。\u003c/p\u003e\n\u003ch3 id=\"-devnull-21\"\u003e\u0026gt; /dev/null 2\u0026gt;\u0026amp;1\u003c/h3\u003e\n\u003cp\u003eLinux 中的标准输入和输出包括：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e0，表示标准输入（stdin），即键盘输入。\u003c/li\u003e\n\u003cli\u003e1，表示标准输出（stdout），即屏幕输出，系统默认是1。\u003c/li\u003e\n\u003cli\u003e2，表示标准错误输出（stderr），即屏幕输出。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enohup command \u0026gt; /dev/null 2\u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e等价于\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enohup command 1 \u0026gt; /dev/null 2\u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e1）nohup：表示当前用户和系统的会话下的进程忽略响应hup消息，从而不挂断地运行命令。\u003c/p\u003e\n\u003cp\u003e2）command：表示Shell命令或者为一个可执行的程序。\u003c/p\u003e\n\u003cp\u003e3）\u0026gt;：表示重定向到哪里。\u003c/p\u003e\n\u003cp\u003e4）/dev/null：表示Linux的空设备文件。\u003c/p\u003e\n\u003cp\u003e5）2：表示标准错误输出\u003c/p\u003e\n\u003cp\u003e6）\u0026amp;1：\u0026amp;表示等同于的意思，2\u0026gt;\u0026amp;1，表示把标准错误输出定向到前一个（\u0026amp;的作用）打开的文件中去。\u003c/p\u003e\n\u003cp\u003e7）\u0026amp;：命令最后面加一个\u0026amp;，表示后台执行，即这条指令在后台运行。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e1 \u0026gt; /dev/null\u003c/code\u003e，表示标准输出重定向到空设备文件，也就是不输出任何信息到终端，不显示任何信息。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e2 \u0026gt; \u0026amp;1\u003c/code\u003e，表示标准错误输出重定向等同于标准输出，因为之前标准输出已经重定向到了空设备文件，所以标准错误输出也重定向到空设备文件。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\u0026gt;  /dev/null 2\u0026gt;\u0026amp;1\u003c/code\u003e，常用来避免shell命令或程序等运行中有内容输出。\u003c/p\u003e\n\u003ch3 id=\"命令组\"\u003e命令组\u003c/h3\u003e\n\u003cp\u003e命令组是在括号中的命令列表，将会作为一个子shell来运行，一般格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e(cmd1,cmd2,cmd3)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"命令执行控制\"\u003e命令执行控制\u003c/h4\u003e\n\u003cp\u003e1、\u003ccode\u003e\u0026amp;\u0026amp;\u003c/code\u003e 表示命令之间的关系为：与，格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecmd_1 \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e cmd_2 # 如果命令cmd_1执行成功，则执行cmd_2，否则cmd_2不执行。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、\u003ccode\u003e||\u003c/code\u003e 表示命令之间的关系为：或，格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecmd_1 || cmd_2 # 如果命令cmd_1执行成功，则不执行命令cmd_2，否则执行cmd_2。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、\u003ccode\u003e;\u003c/code\u003e 表示命令之间的关系为：顺序，格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecmd_1 ; cmd_2 # 无论cmd_1是否执行成功，都会执行cmd_2。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"-与--\"\u003e$() 与 ` `\u003c/h3\u003e\n\u003cp\u003e在 bash 中，$() 与 ` `（反引号） 都是用来作命令替换的，先完成引号里面的命令，然后将其结果替换出来，再重组成新的命令。\u003c/p\u003e\n\u003cp\u003e在操作上，这两者都能达到相应的效果，但是建议使用 $()\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e` ` 很容易与''（单引号）搞混乱，惹来无端麻烦。\u003c/li\u003e\n\u003cli\u003e在多层次的复合替换中，` ` 必须要做额外的转义处理，而 $() 比较直观。\u003c/li\u003e\n\u003cli\u003e$() 的弊端是，并不是所有的类 unix 系统都支持这种方式，但是反引号是肯定支持的。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e$var 和 ${var}\u003c/p\u003e\n\u003cp\u003e一般情况下，$var 和 ${var} 是没有区别的，但是用 ${}会比较精确地界定变量名称的范围。\u003c/p\u003e\n\u003ch3 id=\"退出状态码\"\u003e退出状态码\u003c/h3\u003e\n\u003cp\u003eshell 中运行的每个命令都使用退出状态码来告诉 shell 它完成了处理。退出状态码是一个 0~255 之间的整数值，在命令执行结束时由命令返回给 shell。\u003c/p\u003e\n\u003cp\u003e典型的退出状态码及其意义：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e0：命令运行成功\u003c/li\u003e\n\u003cli\u003e1：通知未知错误\u003c/li\u003e\n\u003cli\u003e2：误用 shell 命令\u003c/li\u003e\n\u003cli\u003e126：命令不可执行\u003c/li\u003e\n\u003cli\u003e127：没有找到命令\u003c/li\u003e\n\u003cli\u003e128：无效退出参数\u003c/li\u003e\n\u003cli\u003e130：命令通过 Ctrl + C 终止\u003c/li\u003e\n\u003cli\u003e255：退出状态码越界\u003c/li\u003e\n\u003cli\u003e137：OOMKilld，内存溢出错误。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eexit 命令用于在 shell 脚本中指定退出状态码，退出状态码最大只能到 255，若其大于 255，则返回模除 256 后的余数。\u003c/p\u003e\n\u003ch3 id=\"shell脚本调试\"\u003eShell脚本调试\u003c/h3\u003e\n\u003cp\u003e脚本调试的主要工作就是发现引发脚本错误的原因以及脚本源代码中定位错误。\u003c/p\u003e\n\u003ch4 id=\"通过-echo-方式\"\u003e通过 echo 方式\u003c/h4\u003e\n\u003cp\u003e功能描述：最简单也是最常用的调试方式，在任何怀疑出错的地方用 echo 打印变量\u003c/p\u003e\n\u003cp\u003e使用场景：所有怀疑可能有问题的地方\u003c/p\u003e\n\u003cp\u003e示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho $xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"通过选项方式\"\u003e通过选项方式\u003c/h4\u003e\n\u003ch5 id=\"-n\"\u003e-n\u003c/h5\u003e\n\u003cp\u003e功能描述：读取 shell 脚本，但不实际执行。\u003c/p\u003e\n\u003cp\u003e使用场景：用于测试 shell 脚本中是否存在语法错误。\u003c/p\u003e\n\u003cp\u003e示例：\u003ccode\u003ebash -n xdhuxc.sh\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003exdhuxc.sh内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efunction xdhuxc() {\n    echo \u0026#34;bash function is called\u0026#34;\n}\necho \u0026#34;xdhuxc start\u0026#34;\nxdhuxc\necho \u0026#34;xdhuxc end\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"-c\"\u003e-c\u003c/h5\u003e\n\u003cp\u003e功能描述：使 shell 解释器从字符串而非文件中读取并执行命令。\u003c/p\u003e\n\u003cp\u003e使用场景：当需要调试一小段脚本的执行结果时，非常方便。\u003c/p\u003e\n\u003cp\u003e示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebash -c \u0026#39;a=2;b=3;let c=a+b;echo c=$c\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"-v\"\u003e-v\u003c/h5\u003e\n\u003cp\u003e功能描述：区别于 -x 参数，该选项打印命令行的原始内容，-x 参数打印出经过替换后的命令行的内容。\u003c/p\u003e\n\u003cp\u003e使用场景：仅想显示命令行的原始内容。\u003c/p\u003e\n\u003cp\u003e示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebash -v xdhuxc.sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"-x\"\u003e-x\u003c/h5\u003e\n\u003cp\u003e功能描述：提供跟踪执行信息，在执行脚本的过程中，把实际执行的每个命令显示出来，行首显示 +，+ 后面显示经过替换之后的命令行内容，有助于分析实际执行的是什么命令\u003c/p\u003e\n\u003cp\u003e使用场景：是调试 shell 脚本的强有力工具，shell 脚本调试的首选手段。\u003c/p\u003e\n\u003cp\u003e示例：\u003c/p\u003e\n\u003cp\u003e1、在命令行提供参数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$sh -x xdhuxc.sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、脚本开头提供参数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env bash -x\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、在脚本中用 \u003ccode\u003eset\u003c/code\u003e 命令启用或禁用参数：其中 \u003ccode\u003eset -x\u003c/code\u003e 表示启用；\u003ccode\u003eset +x\u003c/code\u003e 表示禁用。\u003c/p\u003e\n\u003ch4 id=\"通过-test-的方式返回值为-0则为真返回值为1则为假\"\u003e通过 test 的方式，返回值为 0，则为真；返回值为1，则为假。\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etest -f /etc/hosts\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"通过-trap-来调试\"\u003e通过 trap 来调试\u003c/h4\u003e\n\u003cp\u003e功能描述：用于捕获指定的信号并执行预定义的命令\u003c/p\u003e\n\u003cp\u003e语法格式：\u003ccode\u003etrap cmd signal\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e说明：\nsignal 是要捕获的信号\u003c/p\u003e\n\u003cp\u003ecmd 是捕获到指定的信号，所要执行的命令，可以用 kill -l 命令查看系统中全部可用的信号名。捕获信号后所执行的命令，可以是一条或多条合法的 shell 语句，也可以是一个函数名。shell 脚本执行时，会产生三个伪信号（之所以称为伪信号，是因为这是 shell 自己产生的，而非操作系统产生的），通过使用 trap 捕获这三个伪信号并输出信息对调试有很大的帮助。\u003c/p\u003e\n\u003cp\u003eshell 的三个伪信号：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEXIT：从一个函数中退出或整个脚本执行完毕。\u003c/li\u003e\n\u003cli\u003eERR：当一个命令执行不成功，返回非 0 状态时。\u003c/li\u003e\n\u003cli\u003eDEBUG：脚本中每一条命令执行之前。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nerrorTrap() {\n    echo \u0026#34;[LINE : $1] Error: Command or function exited with status $?\u0026#34;\n}\n\nhello() {\n    return 1;\n}\ntrap $(errorTrap $LINENO) ERR\nxdhuxc\nhello\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行 xdhuxc.sh 脚本：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebash xdhuxc.sh\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"使用调试工具-bashdb\"\u003e使用调试工具 bashdb\u003c/h4\u003e\n\u003cp\u003e使用 shell 调试器 bashdb，可以实现对 shell 脚本的断点设置、单步执行和变量观察等许多功能。\u003c/p\u003e\n\u003cp\u003e使用方式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebashdb -c xdhuxc.sh\n或者\nbashdb xdhuxc.sh\n或者\nbashdb --debug xdhuxc.sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"bash--x-xdhuxcsh\"\u003ebash -x xdhuxc.sh\u003c/h4\u003e\n\u003cp\u003e使用命令 \u003ccode\u003ebash -x xdhuxc.sh\u003c/code\u003e 调试脚本xdhuxc.sh，示例输出如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e++ cd ../..\n++ pwd\n+ DCE_HOME=/yonyou/developercenter_enterprise\n+ DCE_IP=192.168.244.133\n+ echo -e /yonyou/developercenter_enterprise\n/yonyou/developercenter_enterprise\n+ echo -e 192.168.244.133\n192.168.244.133\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u0026quot;+\u0026quot; 号后面显示的是经过了变量替换之后的命令行的内容，有助于分析实际执行的是什么命令\u003c/p\u003e\n\u003cp\u003e带加号表示该条语句是Shell执行的。\u003c/p\u003e\n\u003cp\u003e不带加号表示该语句是Shell产生的输出。\u003c/p\u003e\n\u003ch4 id=\"set--e\"\u003eset -e\u003c/h4\u003e\n\u003cp\u003eset -e 语句告诉 bash 如果任何语句的执行结果不是 true，则应该退出。这样做的好处是防止错误像滚雪球般变大而导致一个致命的错误，而这些错误本应该在之前就被处理掉。\u003c/p\u003e\n\u003ch3 id=\"字符串比较\"\u003e字符串比较\u003c/h3\u003e\n\u003cp\u003e字符串比较的作用：测试字符串是否相等，长度是否为零，字符串是否为NULL等\n常用的字符串比较符号如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e比较符\u003c/th\u003e\n\u003cth\u003e说明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e=\u003c/td\u003e\n\u003ctd\u003e比较两个字符串是否相同，相同则为“是”\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e!=\u003c/td\u003e\n\u003ctd\u003e比较两个字符串是否不同，不同则为“是”\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-n\u003c/td\u003e\n\u003ctd\u003e比较字符串的长度是否大于0，如果大于0则为“是”\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-z\u003c/td\u003e\n\u003ctd\u003e比较字符串的长度是否等于0，如果等于0则为“是”\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"数字比较\"\u003e数字比较\u003c/h3\u003e\n\u003cp\u003e常用的数字比较符如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e比较符\u003c/th\u003e\n\u003cth\u003e说明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e-eq\u003c/td\u003e\n\u003ctd\u003e等于\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-ge\u003c/td\u003e\n\u003ctd\u003e大于等于\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-le\u003c/td\u003e\n\u003ctd\u003e小于等于\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-ne\u003c/td\u003e\n\u003ctd\u003e不等于\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-gt\u003c/td\u003e\n\u003ctd\u003e大于\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-lt\u003c/td\u003e\n\u003ctd\u003e小于\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"字符串测试\"\u003e字符串测试\u003c/h3\u003e\n\u003cp\u003e在编写 Shell 脚本时，经常需要进行判断，以下是一些测试字符串的方法：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e[ -z abc ] abc的值的长度为零则为真\u003c/li\u003e\n\u003cli\u003e[ -n abc ] 如果字符串的长度不为零，则为真\u003c/li\u003e\n\u003cli\u003e[ -a file_name ] 如果file_name存在，则为真\u003c/li\u003e\n\u003c/ul\u003e","date":1531267200,"description":"","fuzzywordcount":4000,"kind":"page","lang":"zh","lastmod":1536278400,"objectID":"896d661c9e73a5a049d7dbc0d76a29c9","publishdate":1531267200,"relpermalink":"/posts/linux/linux-shell-script/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Linux Shell 脚本编写中常用的语法知识。\u003c/p\u003e","tags":["Linux","Shell"],"title":"Linux 中 Shell 脚本基础知识","url":"https://xdhuxc.github.io/posts/linux/linux-shell-script/","wordcount":3921},{"categories":"posts","content":"\u003ch3 id=\"mongodb-简介\"\u003eMongoDB 简介\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eMongoDB\u003c/code\u003e 是一个基于分布式文件存储的数据库。由 \u003ccode\u003eC++\u003c/code\u003e 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eMongoDB\u003c/code\u003e 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。\u003c/p\u003e\n\u003ch3 id=\"准备工作\"\u003e准备工作\u003c/h3\u003e\n\u003cp\u003e（1）在 \u003ccode\u003e/etc/yum.repos.d\u003c/code\u003e 目录下创建文件 \u003ccode\u003emongodb-org-4.0.repo\u003c/code\u003e，内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[mongodb-org-4.0]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/development/x86_64/\ngpgcheck=1\nenabled=1\ngpgkey=https://www.mongodb.org/static/pgp/server-3.8.asc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e（2）关闭SELinux\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esetenforce 0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"安装mongodb\"\u003e安装MongoDB\u003c/h3\u003e\n\u003cp\u003e执行如下命令安装MongoDB\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y mongodb-org-unstable.x86_64\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eMongoDB的配置文件路径为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/etc/mongod.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在该文件中配置有MongoDB的日志文件路径和数据文件路径\n日志文件路径为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/var/log/mongodb\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e数据文件路径为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/var/lib/mongo\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果使用其他用户启动 \u003ccode\u003eMongoDB\u003c/code\u003e 进程，需要确保该用户对 \u003ccode\u003e/var/log/mongodb\u003c/code\u003e  和\u003ccode\u003e/var/lib/mongo\u003c/code\u003e 有访问权限。\u003c/p\u003e\n\u003ch3 id=\"mongodb进程管理命令\"\u003eMongoDB进程管理命令\u003c/h3\u003e\n\u003cp\u003e1、查看 \u003ccode\u003eMongoDB\u003c/code\u003e 的启动状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl status mongod\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、停止 \u003ccode\u003eMongoDB\u003c/code\u003e 进程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl stop mongod\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、重启 \u003ccode\u003eMongoDB\u003c/code\u003e 进程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart mongod\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、启动 \u003ccode\u003eMongoDB\u003c/code\u003e shell\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emongo --host 127.0.0.1:27017\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、卸载 \u003ccode\u003eMongoDB\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e① 停止 \u003ccode\u003eMongoDB\u003c/code\u003e 进程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl stop mongod\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e② 删除 \u003ccode\u003eMongoDB\u003c/code\u003e 的安装包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum erase $(rpm -qa | grep mongodb-org)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e③ 删除 \u003ccode\u003eMongoDB\u003c/code\u003e 数据和日志目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erm -f /var/log/mongodb\nrm -f /var/lib/mongo\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003eRedhat\u003c/code\u003e 或者 \u003ccode\u003eCentOS\u003c/code\u003e 上安装 \u003ccode\u003eMongoDB\u003c/code\u003e 的官方文档地址：\n\u003ca href=\"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/\"\u003ehttps://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/\u003c/a\u003e\u003c/p\u003e\n","date":1530835200,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1530835200,"objectID":"cdfe7f531a675d878fd76ee0eea55ee6","publishdate":1530835200,"relpermalink":"/posts/storage/mongodb/centos7-install-mongodb/","section":"posts","summary":"MongoDB 简介 MongoDB 是一个基于分布式文件存储的数据库。由 C++ 语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。 MongoDB 是一个介于关系数据库和非关系数据库之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。 准备工作 （1）在 /etc/yum.repos.d 目录下创建文件 mongodb-org-4.0.repo，内容为： 1 2 3 4 5 6 [mongodb-org-4.0] name=MongoDB Repository","tags":["CentOS7","数据库","MongoDB"],"title":"在 CentOS 7 上安装 MongoDB 数据库","url":"https://xdhuxc.github.io/posts/storage/mongodb/centos7-install-mongodb/","wordcount":436},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了些 HTTP 协议的基本知识，可用于复习 HTTP 协议的基础知识。\u003c/p\u003e\n\u003ch3 id=\"http-简介\"\u003eHTTP 简介\u003c/h3\u003e\n\u003cp\u003eHTTP协议是Hyper Text Transfer Protocol（超文本传输协议）的缩写，用于从万维网服务器传输超文本到本地浏览器的传送协议。\u003c/p\u003e\n\u003cp\u003eHTTP 是一个基于TCP/IP协议来传输数据（HTML文件、图片文件等）的协议\u003c/p\u003e\n\u003ch3 id=\"http-工作原理\"\u003eHTTP 工作原理\u003c/h3\u003e\n\u003cp\u003eHTTP 协议工作于客户端-服务器架构上，浏览器作为HTTP客户端通过URL向HTTP服务端发送所有请求，HTTP服务器根据接收到的请求，向客户端发送响应信息。\u003c/p\u003e\n\u003cp\u003e一次 HTTP 操作称为一个事务，其工作过程可分为四步：\u003c/p\u003e\n\u003cp\u003e1）首先，客户端与服务器需要建立连接，只要用户点击某个超链接，HTTP的工作就开始。\u003c/p\u003e\n\u003cp\u003e2）建立连接后，客户端发送一个请求给服务器，请求方法的格式为：统一资源标识符（URL）、协议版本号，后边是MIME信息，包括请求修饰符、客户端信息和可能的内容。\u003c/p\u003e\n\u003cp\u003e3）服务器接收到请求后，给予相应的响应信息，其格式为：一个状态行，包括信息的协议版本号、一个成功或错误的代码，后边是MIME信息，包括服务器信息、实体信息和可能的内容。\u003c/p\u003e\n\u003cp\u003e4）客户端接收到服务器所返回的信息，通过浏览器显示在用户的显示屏上，然后客户端与服务器断开连接。\u003c/p\u003e\n\u003cp\u003e如果在以上过程中的某一步出现错误，那么产生错误的信息将返回到客户端，由显示屏输出。\u003c/p\u003e\n\u003ch3 id=\"http-特点\"\u003eHTTP 特点\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eHTTP是无连接的\n无连接的含义是限制每次连接只处理一个请求，服务器处理完客户的请求，并收到客户的应答后，即断开连接，采用这种方式可以节省传输时间。\u003c/li\u003e\n\u003cli\u003eHTTP是媒体独立的\n这意味着，只要客户端和服务器知道如何处理数据内容，任何类型的数据都可以通过HTTP发送，客户端以及服务器指定使用适合的MIME-TYPE内容类型。\u003c/li\u003e\n\u003cli\u003eHTTP是无状态的\n无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"请求消息request\"\u003e请求消息Request\u003c/h3\u003e\n\u003cp\u003e客户端发送一个HTTP请求到服务器的请求消息包括以下格式：\n请求行，请求头，空行和请求数据四个部分组成\n\u003cimg src=\"C:/Users/wanghuan/Desktop/%E7%94%B5%E5%AD%90%E4%B9%A6/http-request.png\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e请求行，用来说明请求类型，要访问的资源以及所使用的HTTP协议版本。\u003c/li\u003e\n\u003cli\u003e请求头部，紧接着请求行（即第一行）之后的部分，用来说明服务器要使用的附加信息。\u003c/li\u003e\n\u003cli\u003e空行，请求头部后面的空行是必须的，即使第四部分的请求数据为空，也必须有空行。\u003c/li\u003e\n\u003cli\u003e主体，即请求数据，可以添加任意的其他数据。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"响应消息response\"\u003e响应消息Response\u003c/h3\u003e\n\u003cp\u003e一般情况下，服务器接收并处理客户端发过来的请求后会返回一个HTTP的响应消息。\nHTTP 响应也由四个部分组成，分别是：状态行、消息报头、空行和响应正文。\n\u003cimg src=\"C:/Users/wanghuan/Desktop/%E7%94%B5%E5%AD%90%E4%B9%A6/http-response.jpg\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e状态行，由HTTP协议版本号、状态码和状态消息三部分组成。\u003c/li\u003e\n\u003cli\u003e响应头部，用来说明客户端要使用的一些附加信息。\u003c/li\u003e\n\u003cli\u003e空行，消息报头后面的空行是必须的。\u003c/li\u003e\n\u003cli\u003e响应正文，服务器返回给客户端的文本信息。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"http-请求方法\"\u003eHTTP 请求方法\u003c/h3\u003e\n\u003cp\u003e根据HTTP标准，HTTP请求可以使用多种请求方法。\nHTTP 1.0 定义了三种请求方法：GET，POST和HEAD方法。\nHTTP 1.1 新增了五种请求方法：OPTIONS，PUT，DELETE，TRACE 和 CONNECT 方法。\u003c/p\u003e\n\u003cp\u003e在 HTTP/1.0 中，默认使用短连接，也就是说，浏览器和服务器每进行一次 HTTP操作，就建立一次连接，但任务结束就中断连接。\u003c/p\u003e\n\u003cp\u003e在 HTTP/1.1 中，默认使用长连接，用以保持连接特性。在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输 HTTP 数据的 TCP 连接不会关闭。如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的连接。Keep-Alive 不会永久保持连接，它有一个保持时间，可以在不同的服务器软件中设定这个时间。实现长连接要客户端和服务端都支持长连接。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGET：请求指定的页面信息，并返回实体主体。\u003c/li\u003e\n\u003cli\u003eHEAD：类似于GET请求，只不过返回的响应中没有具体的内容，用于获取报头。\u003c/li\u003e\n\u003cli\u003ePOST：向指定资源提交数据进行处理请求（例如提交表单或上传文件）。数据被包含在请求体中，POST请求可能会导致新的资源的建立或已有资源的修改。\u003c/li\u003e\n\u003cli\u003ePUT：从客户端向服务器传送的数据取代指定的文档内容。\u003c/li\u003e\n\u003cli\u003eDELETE：请求服务器删除指定的页面。\u003c/li\u003e\n\u003cli\u003eCONNECT：HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器。\u003c/li\u003e\n\u003cli\u003eOPTIONS：允许客户端查看服务器的性能。\u003c/li\u003e\n\u003cli\u003eTRACE：回显服务器收到的请求，主要用于测试或诊断。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"get-请求和-post-请求的区别\"\u003eGET 请求和 POST 请求的区别\u003c/h3\u003e\n\u003ch4 id=\"请求数据\"\u003e请求数据\u003c/h4\u003e\n\u003cp\u003eGET请求，请求的数据会附在URL之后，即把数据放置在HTTP协议头中，以?分隔URL和传输数据，多个参数使用\u0026amp;连接。\u003c/p\u003e\n\u003cp\u003ePOST请求，把提交的数据放置在HTTP包的包体中。\u003c/p\u003e\n\u003cp\u003e因此，GET提交的数据会在浏览器地址栏中显示出来，而POST方式提交数据时，浏览器地址栏不会改变。\u003c/p\u003e\n\u003ch4 id=\"传输数据大小\"\u003e传输数据大小\u003c/h4\u003e\n\u003cp\u003e首先，HTTP协议没有对传输的数据大小进行限制，HTTP协议规范也没有对URL长度进行限制。\u003c/p\u003e\n\u003cp\u003e但在实际开发过程中，对于GET请求，特定的浏览器和服务器对URL的长度有限制，因此，在使用GET请求时，传输数据会受到URL长度的限制。\u003c/p\u003e\n\u003cp\u003e对于POST请求，由于不是URL传值，理论上是不会受限制的，但是实际上各个服务器会规定对POST提交数据大小进行限制，Apache，IIS都有各自的配置。\u003c/p\u003e\n\u003ch4 id=\"安全性\"\u003e安全性\u003c/h4\u003e\n\u003cp\u003ePOST的安全性比GET的高。这里的安全是指真正的安全，而不同于上面GET提到的安全方法中的安全，上面提到的安全仅仅是不修改服务器的数据。比如，在进行登录操作，通过GET请求，用户名和密码都会暴露再URL上，因为登录页面有可能被浏览器缓存以及其他人查看浏览器的历史记录的原因，此时的用户名和密码就很容易被他人拿到了。除此之外，GET请求提交的数据还可能会造成Cross-site request frogery攻击\u003c/p\u003e\n\u003cp\u003eGET请求和POST请求本质上都是TCP连接，并无差别，但是由于HTTP的规定和浏览器/服务器的限制，导致它们在应用过程中体现出一些不同。\u003c/p\u003e\n\u003cp\u003eGET请求产生一个TCP数据包，POST请求产生两个TCP数据包。具体来讲，对于GET请求，浏览器会把HTTP请求头部和请求数据一起发送出去，服务器端响应200，返回数据。\u003c/p\u003e\n\u003cp\u003e对于POST请求，浏览器先发送请求头部，服务器响应100，continue，浏览器再发送数据，服务器端响应200，返回数据。\u003c/p\u003e\n\u003cp\u003e根据研究，在网络环境好的情况下，发一次包的时间和发两次包的时间差别基本可以无视。而在网络环境差的情况下，两次包的TCP在验证数据包完整性上，有非常大的优点。\u003c/p\u003e\n\u003ch3 id=\"状态码含义\"\u003e状态码含义\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e100：Continue，服务器仅接收到部分请求，但是一旦服务器并没有拒绝该请求，客户端应该继续发送其余的请求。\u003c/li\u003e\n\u003cli\u003e200：OK，请求成功，一般用于GET和POST请求\u003c/li\u003e\n\u003cli\u003e301：Moved Permanently，永久移动，请求的资源已被永久地移动到新的URI，返回信息会包含新的URI，浏览器会自动重定向到新的URI，今后任何新的请求都应使用新的URI代替。\u003c/li\u003e\n\u003cli\u003e302：Found，临时移动，与301类似，但是资源只是临时被移动，客户端应继续使用原来的URI。\u003c/li\u003e\n\u003cli\u003e400：Bad Request，客户端请求的语法错误，服务器无法理解。\u003c/li\u003e\n\u003cli\u003e403：Forbidden，服务器理解请求客户端的请求，但是拒绝执行此请求。\u003c/li\u003e\n\u003cli\u003e404：Not Found，服务器无法根据客户端的请求找到资源。\u003c/li\u003e\n\u003cli\u003e500：Internal Server Error，服务器内部错误，无法完成请求。\u003c/li\u003e\n\u003cli\u003e502：Bad Gateway，充当网关或代理的服务器，从远端服务器接收到了一个无效的请求。\u003c/li\u003e\n\u003cli\u003e503：Service Unavailable，由于超载或系统维护，服务器暂时无法处理客户端的请求。\u003c/li\u003e\n\u003cli\u003e504：Gateway Time-out，充当网关或代理的服务器，未及时从远端服务器获取请求。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"curl\"\u003ecurl\u003c/h3\u003e\n\u003cp\u003e使用 curl 发送 POST 请求\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecurl -v -H \u0026quot;Content-Type:application/json\u0026quot; -H \u0026quot;Host:www.baidu.com\u0026quot; -X POST --data ./xdhuxc.json www.baidu.com\n\u003c/code\u003e\u003c/pre\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# curl -v -H \u0026quot;Content-Type:application/json\u0026quot; -H \u0026quot;Host:www.baidu.com\u0026quot; -X POST --data ./xdhuxc.json www.baidu.com\n* About to connect() to www.baidu.com port 80 (#0)\n*   Trying 14.215.177.38...\n* Connected to www.baidu.com (14.215.177.38) port 80 (#0)\n\u0026gt; POST / HTTP/1.1                       # 请求行\n\u0026gt; User-Agent: curl/7.29.0               # 请求头部\n\u0026gt; Accept: */*                           # 请求头部\n\u0026gt; Content-Type:application/json         # 请求头部\n\u0026gt; Host:www.baidu.com                    # 请求头部\n\u0026gt; Content-Length: 13                    # 请求头部\n\u0026gt;                                       # 空行\n* upload completely sent off: 13 out of 13 bytes\n\u0026lt; HTTP/1.1 302 Found                    # 状态行\n\u0026lt; Connection: Keep-Alive                # 响应头部\n\u0026lt; Content-Length: 17931                 # 响应头部\n\u0026lt; Content-Type: text/html               # 响应头部\n\u0026lt; Date: Sat, 21 Jul 2018 02:54:33 GMT   # 响应头部\n\u0026lt; Etag: \u0026quot;54d9748e-460b\u0026quot;                 # 响应头部 \n\u0026lt; Server: bfe/1.0.8.18                  # 响应头部\n\u0026lt;                                       # 空行\n\u0026lt;html\u0026gt;                                  # 以下为响应体\n\u0026lt;head\u0026gt;\n* Connection #0 to host www.baidu.com left intact  # 响应体\n\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e注意：\n-H，--header：设置头部信息Content-Type为application/json。\n-d，--data：添加发送的数据。\n-X：指定HTTP请求的方法，如果使用了-d，默认使用POST方法，可以省略-X参数。\u003c/p\u003e\n\u003cp\u003e使用curl发送GET请求\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecurl -G -d \u0026quot;name=xdhuxc\u0026amp;password=Xdhuxc163\u0026quot; -F \u0026quot;file=@/Users/fungleo/Downloads/401.png\u0026quot; http://www.baidu.com\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"http-请求头\"\u003eHTTP 请求头\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e请求头\u003c/th\u003e\n\u003cth\u003e说明\u003c/th\u003e\n\u003cth\u003e示例\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eAccept\u003c/td\u003e\n\u003ctd\u003e客户端可接受的响应内容类型（Content-Type）\u003c/td\u003e\n\u003ctd\u003eAccept: text/plain\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAccept-Charset\u003c/td\u003e\n\u003ctd\u003e客户端可接受的字符集\u003c/td\u003e\n\u003ctd\u003eAccept-Charset: utf-8\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eHost\u003c/td\u003e\n\u003ctd\u003e表示服务器的域名以及服务器所监听的端口号。如果所请求的端口是对应的服务的标准端口（80），则端口号可以省略\u003c/td\u003e\n\u003ctd\u003eHost:www.baidu.com或Host:www.baidu.com:80\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eReferer\u003c/td\u003e\n\u003ctd\u003e表示浏览器所访问的前一个页面，可以认为是之前访问页面的链接将浏览器带到了当前页面。Referer其实是Referrer这个单词，但RFC制作标准时给拼错了，后来也就将错就错使用Referer了。\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eConnection\u003c/td\u003e\n\u003ctd\u003e客户端浏览器想要优先使用的连接类型\u003c/td\u003e\n\u003ctd\u003eConnection: keep-alive;Connection:Upgrade\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eContent-Type\u003c/td\u003e\n\u003ctd\u003e请求体的MIME类型（用于POST和PUT请求中）\u003c/td\u003e\n\u003ctd\u003eContent-Type: application/x-www-from-urlencoded\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAccept-Encoding\u003c/td\u003e\n\u003ctd\u003e客户端可接受的响应内容的编码方式\u003c/td\u003e\n\u003ctd\u003eAccept-Encoding: gzip,deflate\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAccept-Language\u003c/td\u003e\n\u003ctd\u003e客户端可接受的响应内容语言列表\u003c/td\u003e\n\u003ctd\u003eAccept-Language:zh-CN,en-US\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCache-Control\u003c/td\u003e\n\u003ctd\u003e用来指定当前的请求/响应中，是否使用缓存机制\u003c/td\u003e\n\u003ctd\u003eCache-Control: no-cache\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eContent-Length\u003c/td\u003e\n\u003ctd\u003e以八进制表示的请求体长度\u003c/td\u003e\n\u003ctd\u003eContent-Length: 348\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUser-Agent\u003c/td\u003e\n\u003ctd\u003e浏览器的身份标识字符串\u003c/td\u003e\n\u003ctd\u003eUser-Agent：Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUpgrade\u003c/td\u003e\n\u003ctd\u003e要求服务器升级到一个高版本协议\u003c/td\u003e\n\u003ctd\u003eUpgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/qq_30553235/article/details/79282113\"\u003ehttps://blog.csdn.net/qq_30553235/article/details/79282113\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"http-响应头\"\u003eHTTP 响应头\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e响应头\u003c/th\u003e\n\u003cth\u003e说明\u003c/th\u003e\n\u003cth\u003e示例\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eStatus\u003c/td\u003e\n\u003ctd\u003e通用网关接口的响应头字段，用来说明当前HTTP连接的响应状态\u003c/td\u003e\n\u003ctd\u003eStatus: 200 OK\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eServer\u003c/td\u003e\n\u003ctd\u003e服务器的名称\u003c/td\u003e\n\u003ctd\u003eServer: nginx/1.6.3\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eETag\u003c/td\u003e\n\u003ctd\u003e一个代表响应服务端资源（如页面）版本的报文头属性，如果某个服务端资源发生变化了，这个ETag就会相应发生变化。它是Cache-Control的有益补充，可以让客户端更智能地处理什么时候需要从服务端获取资源，什么时候可以直接从缓存中返回响应。对于服务器端某个资源的某个特定版本的一个标识符，通常是一个 消息散列\u003c/td\u003e\n\u003ctd\u003eETag: \u0026quot;737060cd8c284d8af7ad3082f209582d\u0026quot;\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAge\u003c/td\u003e\n\u003ctd\u003e响应对象在代理缓存中存在的时间，以秒为单位\u003c/td\u003e\n\u003ctd\u003eAge: 12\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAllow\u003c/td\u003e\n\u003ctd\u003e对于特定资源的有效动作\u003c/td\u003e\n\u003ctd\u003eAllow: GET, HEAD\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCache-Control\u003c/td\u003e\n\u003ctd\u003e通知从服务器到客户端内的所有缓存机制，表示它们是否可以缓存这个对象及缓存有效时间，单位为秒\u003c/td\u003e\n\u003ctd\u003eCache-Control: max-age=3600\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eConnection\u003c/td\u003e\n\u003ctd\u003e针对该连接所预期的选项\u003c/td\u003e\n\u003ctd\u003eConnection: close\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eContent-Encoding\u003c/td\u003e\n\u003ctd\u003e服务器端响应资源所使用的编码类型\u003c/td\u003e\n\u003ctd\u003eContent-Encoding: gzip\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eContent-Language\u003c/td\u003e\n\u003ctd\u003e服务器端响应资源所使用的语言\u003c/td\u003e\n\u003ctd\u003eContent-Language: zh-cn\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eContent-Length\u003c/td\u003e\n\u003ctd\u003e服务端响应消息体的长度，用八进制字节表示\u003c/td\u003e\n\u003ctd\u003eContent-Length: 348\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eContent-Type\u003c/td\u003e\n\u003ctd\u003e当前内容的MIME类型\u003c/td\u003e\n\u003ctd\u003eContent-Type: text/html; charset=utf-8\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eExpires\u003c/td\u003e\n\u003ctd\u003e指定一个日期/时间，超过该时间则认为此回应已经过期\u003c/td\u003e\n\u003ctd\u003eExpires: Thu, 01 Dec 1994 16:00:00 GMT\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eRefresh\u003c/td\u003e\n\u003ctd\u003e用于重定向，或者当一个新的资源被创建时，默认会在5秒后刷新重定向\u003c/td\u003e\n\u003ctd\u003eRefresh: 5; url=http://itbilu.com\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/u012361288/article/details/54425689\"\u003ehttps://blog.csdn.net/u012361288/article/details/54425689\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/wangning528/p/6388464.html\"\u003ehttps://www.cnblogs.com/wangning528/p/6388464.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.runoob.com/http/http-status-codes.html\"\u003ehttp://www.runoob.com/http/http-status-codes.html\u003c/a\u003e\u003c/p\u003e","date":1530489600,"description":"","fuzzywordcount":4400,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"89b4adced74970f5d6e3461a5fb39314","publishdate":1530489600,"relpermalink":"/posts/common/http/http-basic-knowledge/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了些 HTTP 协议的基本知识，可用于复习 HTTP 协议的基础知识。\u003c/p\u003e","tags":["HTTP"],"title":"HTTP 协议基础知识","url":"https://xdhuxc.github.io/posts/common/http/http-basic-knowledge/","wordcount":4332},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在 python 开发过程中，经常需要配置 pip 源，以加快依赖包的下载速度，在构建 docker 镜像时，最好也指定 pip 源。\u003c/p\u003e\n\u003ch3 id=\"配置-pip-源\"\u003e配置 pip 源\u003c/h3\u003e\n\u003cp\u003e在当前目录下建立~/.pip/pip.conf文件，添加如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[global]\nindex-url = http://mirrors.aliyun.com/pypi/simple/\n\n[install]\ntrusted-host=mirrors.aliyun.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003eWindows\u003c/code\u003e 系统中，在 \u003ccode\u003eC:\\Users\\wanghuan\\AppData\\Local\\pip\u003c/code\u003e 目录下创建 \u003ccode\u003epip.ini\u003c/code\u003e 文件，写入以上内容并保存即可。\u003c/p\u003e\n\u003ch3 id=\"使用-python-的-requirementstxt\"\u003e使用 Python 的 requirements.txt\u003c/h3\u003e\n\u003cp\u003e使用 pip 命令时，通过 \u003ccode\u003e-i\u003c/code\u003e 参数指定 pip 源\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1530230400,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1524787200,"objectID":"ee4016abba07617c57ea5db5edf61b3f","publishdate":1530230400,"relpermalink":"/posts/programming/python/python-pip/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在 python 开发过程中，经常需要配置 pip 源，以加快依赖包的下载速度，在构建 docker 镜像时，最好也指定 pip 源。\u003c/p\u003e","tags":["Python"],"title":"Python 配置 pip 源","url":"https://xdhuxc.github.io/posts/programming/python/python-pip/","wordcount":156},{"categories":"posts","content":"\u003cp\u003e本篇博客记录下使用 redis 的过程中出现的问题及解决。\u003c/p\u003e\n\u003cp\u003e1、使用 go-redis 连接 redis，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:xdhuxc wanghuan$ ./main --config conf.test.yaml\nF0910 14:17:00.304868    2673 router.go:50] ERR SELECT is not allowed in cluster mode\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在单机模式下，redis.conf 配置文件中默认的数据库数量是 16 个；但在集群模式下，redis 不支持多数据库，只有一个数据库，默认是 select 0。集群从节点默认是不支持读写操作的，但是在执行过 readonly 命令后可以执行读操作。\u003c/p\u003e\n\u003cp\u003e所以，将指定 db 的地方指定为 0 即可解决此问题。\u003c/p\u003e\n\u003cp\u003e2、增大 redis 的客户端连接数\u003c/p\u003e\n\u003cp\u003e1）redis.conf 中 maxClients 参数的限制，默认为：10000，设置为 0 表示不作限制，但是优先受到 redis 进程能打开的最大文件描述符的限制，为该值减去 32，因为 redis 内部也需要一些文件描述符。\u003c/p\u003e\n\u003cp\u003e2）如果需要支持更高的连接数，还需要更改系统的相关配置，比如 ulimit 数目\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eulimit -n 65536 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）更改网络的并发连接数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enet.ipv4.netfilter.ip_conntrack_max\nnet.nf_conntrack_max\nnet.netfilter.nf_conntrack_max\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1530144000,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"788f256ce536b6476b6b2be803aa86ec","publishdate":1530144000,"relpermalink":"/posts/storage/redis/redis-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录下使用 redis 的过程中出现的问题及解决。\u003c/p\u003e","tags":["Redis","数据库"],"title":"Redis 常见问题及解决","url":"https://xdhuxc.github.io/posts/storage/redis/redis-questions-and-solutions/","wordcount":342},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了使用 Tomcat 的过程中经常出现的问题及其解决方法。\u003c/p\u003e\n\u003cp\u003e1、tomcat 部署项目后，war 包是否可以删除？\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ewar 包不能在 tomcat 运行时删除，否则会删除自动解压的工程。\u003c/li\u003e\n\u003cli\u003e可以停掉 tomcat 后，再删除 war 包，解压后的工程还会保留着。\u003c/li\u003e\n\u003cli\u003e当重新部署的时候，如果有与 war 文件相同的目录，就不会重新部署。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e因为 tomcat 在运行期间会监控 webapps 目录下的 war 文件，如果有新增 war 文件，就解压；有删除 war 文件，就连同项目一起删除。\u003c/p\u003e\n\u003cp\u003e2、tomcat 下 war 包和同名已解压项目，如何加载？\u003c/p\u003e\n\u003cp\u003e当 tomcat 启动的时候，会去查看 webapps 目录下的所有 war 包，同时查看是否有该 war 包对应的已解压文件，如果已经存在，就不会再解压，也不会将已经修改的 jsp 覆盖掉。只有当删除 war 包对应的同名目录后，启动 tomcat 时才会再解压 war 文件。\u003c/p\u003e\n\u003cp\u003e3、部署在 tomcat 中的应用，输出的日志是乱码\u003c/p\u003e\n\u003cp\u003e中文乱码原因：\u003c/p\u003e\n\u003cp\u003eTomcat 默认是按 \u003ccode\u003eISO-8859-1\u003c/code\u003e 进行 \u003ccode\u003eURL\u003c/code\u003e 解码，\u003ccode\u003eISO-8859-1\u003c/code\u003e 并未包括中文字符，中文字符不能被正确解析导致产生乱码。\u003c/p\u003e\n\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e1、在 \u003ccode\u003eserver.xml\u003c/code\u003e 文件，添加如下配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eConnector\u003c/span\u003e \u003cspan class=\"na\"\u003eexecutor\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;tomcatThreadPool\u0026#34;\u003c/span\u003e\n               \u003cspan class=\"na\"\u003eport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;8080\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eprotocol\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;HTTP/1.1\u0026#34;\u003c/span\u003e\n               \u003cspan class=\"na\"\u003econnectionTimeout\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;20000\u0026#34;\u003c/span\u003e\n               \u003cspan class=\"na\"\u003eredirectPort\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;8443\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eURIEncoding\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;UTF-8\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e指定了用于解码 \u003ccode\u003eURI\u003c/code\u003e 的字符编码为 \u003ccode\u003eUTF-8\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e2、设置当前系统编码，在 \u003ccode\u003e/etc/profile\u003c/code\u003e 文件中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport LANG=zh_CN.utf8\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1530144000,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"3da8aa6c7b7ab35c7e3cf7808c3ed778","publishdate":1530144000,"relpermalink":"/posts/devops/tomcat/tomcat-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录了使用 Tomcat 的过程中经常出现的问题及其解决方法。\u003c/p\u003e","tags":["Tomcat","DevOps"],"title":"Tomcat 常见问题及解决","url":"https://xdhuxc.github.io/posts/devops/tomcat/tomcat-questions-and-solutions/","wordcount":455},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍以 docker 容器方式部署 Redis 的操作。\u003c/p\u003e\n\u003cp\u003e1、最简单的 Redis 容器启动方式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d --name redis redis:latest \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、以持久化存储方式启动 Redis 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d --name redis redis:latest redis-server --appendonly yes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、某个应用连接 Redis\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d --name some-app --link \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、使用自定义配置文件启动 Redis 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -v /home/xdhuxc/redis/redis_master.conf:/usr/local/etc/redis/redis.conf \\\n    -v /home/xdhuxc/redis/log/redis_master.log:/var/log/redis/redis_master.log \\\n    -v /home/xdhuxc/redis/data:/data \\\n    --name redis \\\n    redis:latest \\\n    redis-server /usr/local/etc/redis/redis.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --network host \\\n    -v /xdhuxc/docker-compose/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf \\\n    --name redis \\\n    redis:4.0.9 \\\n    redis-server /usr/local/etc/redis/redis.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"redis主从复制集群\"\u003eRedis主从复制集群\u003c/h3\u003e\n\u003cp\u003e1、安装并启动 Docker，执行如下命令安装 docker\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y docker\nsystemctl enable docker\nsystemctl start docker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、直接从 dockerhub 官网拉取 Redis镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull redis\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、准备配置文件，从官方下载的Redis镜像中没有redis.conf配置文件，因此需要提前准备配置文件。\n从 \u003ca href=\"https://redis.io/\"\u003eRedis官网\u003c/a\u003e 下载最新稳定版 Redis，目前为：redis-4.0.2，下载redis-4.0.2.tar.gz，解压该软件包，获取redis.conf 配置文件\u003c/p\u003e\n\u003cp\u003e4、启动 Redis 主节点\u003c/p\u003e\n\u003cp\u003e1）修改配置文件\u003c/p\u003e\n\u003cp\u003e注释掉 bind 127.0.0.1 所在行\n注释掉 protected-mode yes所在行\n注释掉 daemonize no  或者设置为 no 所在行（否则容器启动，加载配置文件后就退出，没有其他提示），报错为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store ~]# docker logs redis\n1:C 10 Nov 00:59:40.915 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo\n1:C 10 Nov 00:59:40.916 # Redis version=4.0.2, bits=64, commit=00000000, modified=0, pid=1, just started\n1:C 10 Nov 00:59:40.916 # Configuration loaded\n[root@store ~]# docker ps -a\nCONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS                          PORTS               NAMES\nf5ba4eeb8a53        redis:latest        \u0026#34;docker-entrypoint.sh\u0026#34;   About a minute ago   Exited (0) About a minute ago                       redis\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）启动 Redis Master 容器\n启动命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -v /home/xdhuxc/redis/conf/redis_master.conf:/usr/local/etc/redis/redis.conf \\\n    --name redis-master \\\n    redis:latest \\\n    redis-server /usr/local/etc/redis/redis.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store ~]# docker logs redis-master\n1:C 10 Nov 00:03:25.961 # Fatal error, can\u0026#39;t open config file \u0026#39;/usr/local/etc/redis/redis.conf\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：在启动命令中加入 \u003ccode\u003e--privileged=true\u003c/code\u003e 参数\u003c/p\u003e\n\u003cp\u003e对于挂载的文件，要提前建立好空文件，否则会以文件名为目录名创建目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -v /home/xdhuxc/redis/redis-master.conf:/usr/local/etc/redis/redis.conf \\\n    -v /home/xdhuxc/redis/data:/data\n    -v /hoem/xdhuxc/redis/log/redis-master.log:/var/log/redis/redis-master.log \\ \u003cspan class=\"ni\"\u003e#由redis\u003c/span\u003e.conf中logfile指定\n    --name redis-master \\\n    redis:latest \\\n    redis-server /usr/local/etc/redis/redis.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e正确的启动命令：（取消logfile参数）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -v /home/xdhuxc/redis/conf/redis-master.conf:/usr/local/etc/redis/redis.conf \\\n    -v /home/xdhuxc/redis/data:/data \\\n    --name redis-master \\\n    redis:4.0.2 \\\n    redis-server /usr/local/etc/redis/redis.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e测试 Redis Master 容器，可以正常使用。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@centos_1 conf]# docker exec -it redis-master /bin/bash\nroot@1cc216ffcba8:/data# redis-cli                                                                                        \n127.0.0.1:6379\u0026gt; set aaa aaa\nOK\n127.0.0.1:6379\u0026gt; get aaa\n\u0026#34;aaa\u0026#34;\n127.0.0.1:6379\u0026gt; set 123 abc\nOK\n127.0.0.1:6379\u0026gt; get 123\n\u0026#34;abc\u0026#34;\n127.0.0.1:6379\u0026gt; \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、Redis Slave 配置文件和启动（使用同一个 redis-slave.conf）\n复制 redis-master.conf 为 redis-slave.conf，并修改如下配置项：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#slaveof \u0026lt;masterip\u0026gt; \u0026lt;masterport\u0026gt; \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e修改为：\nslaveof master 6379\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 redis-slave-one 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -v /home/xdhuxc/redis/conf/redis-slave.conf:/usr/local/etc/redis/redis.conf \\\n    --name redis-slave-one \\\n    --link redis-master:master \\\n    redis:4.0.2 \\\n    redis-server /usr/local/etc/redis/redis.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 redis-slave-two 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -v /home/xdhuxc/redis/conf/redis-slave.conf:/usr/local/etc/redis/redis.conf \\\n    --name redis-slave-two \\\n    --link redis-master:master \\\n    redis:4.0.2 \\\n    redis-server /usr/local/etc/redis/redis.conf\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1530144000,"description":"","fuzzywordcount":1000,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"7e20433f181c0fbb417f57dbd4165886","publishdate":1530144000,"relpermalink":"/posts/storage/redis/redis-docker/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍以 docker 容器方式部署 Redis 的操作。\u003c/p\u003e","tags":["Redis","Docker","数据库"],"title":"使用 Docker 容器方式部署 Redis","url":"https://xdhuxc.github.io/posts/storage/redis/redis-docker/","wordcount":900},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了使用 docker 容器方式部署 zookeeper 的方法。\u003c/p\u003e\n\u003ch3 id=\"启动-zookeeper-容器\"\u003e启动 zookeeper 容器\u003c/h3\u003e\n\u003cp\u003e使用如下命令启动 zookeeper 容器：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --restart=always \\\n    -p 2181:2181 \\\n    --hostname=zookeeper \\\n    -e ZOO_MY_ID=1 \\\n    -e ZOO_SERVERS=server.1=zookeeper:2888:3888 \\\n    -v /home/xdhuxc/zookeeper/log:/datalog \\\n    -v /home/xdhuxc/zookeeper/data:/data \\\n    --name zookeeper \\\n    docker.io/zookeeper:3.4.10\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1530144000,"description":"","fuzzywordcount":100,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"436ef7089d36e31571d3aecad6886f6d","publishdate":1530144000,"relpermalink":"/posts/devops/zookeeper/zookeeper-docker/","section":"posts","summary":"\u003cp\u003e本篇博客记录了使用 docker 容器方式部署 zookeeper 的方法。\u003c/p\u003e","tags":["Zookeeper","Docker","DevOps"],"title":"使用 docker 容器方式部署 zookeeper","url":"https://xdhuxc.github.io/posts/devops/zookeeper/zookeeper-docker/","wordcount":78},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了使用 docker 部署 tomcat 的方法。\u003c/p\u003e\n\u003ch3 id=\"启动tomcat容器\"\u003e启动Tomcat容器\u003c/h3\u003e\n\u003cp\u003e使用如下命令启动 \u003ccode\u003eTomcat\u003c/code\u003e 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --restart=always \\\n    -p 8080:8080 \\\n    --name=tomcat \\\n    tomcat:9.0.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在浏览器地址栏中输入：\u003ccode\u003ehttp://192.168.244.128:8080\u003c/code\u003e，可访问到 \u003ccode\u003eTomcat\u003c/code\u003e 的首页\u003c/p\u003e\n\u003ch3 id=\"挂载配置文件和-war-包方式启动tomcat容器\"\u003e挂载配置文件和 War 包方式启动Tomcat容器\u003c/h3\u003e\n\u003cp\u003e根目录为：\u003ccode\u003e/usr/local/tomcat/\u003c/code\u003e，\u003ccode\u003econf\u003c/code\u003e、\u003ccode\u003ewebapps\u003c/code\u003e、\u003ccode\u003ebin\u003c/code\u003e 等目录均在该目录下\u003c/p\u003e\n\u003cp\u003e创建 \u003ccode\u003e/home/xdhuxc/tomcat\u003c/code\u003e 目录，在其下创建 \u003ccode\u003econf\u003c/code\u003e 和 \u003ccode\u003ewebapps\u003c/code\u003e 目录，\u003c/p\u003e\n\u003cp\u003e使用如下命令启动 \u003ccode\u003etomcat\u003c/code\u003e 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --restart=always \\\n    -p 8080:8080 \\\n    -v /home/xdhuxc/tomcat/webapps:/usr/local/tomcat/webapps \\\n    -v /home/xdhuxc/tomcat/conf:/usr/local/tomcat/conf \\\n    --name=tomcat \\\n    tomcat:9.0.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1530144000,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"dab9ac98dea764464e6ce7d8be9c3e5e","publishdate":1530144000,"relpermalink":"/posts/devops/tomcat/tomcat-docker/","section":"posts","summary":"\u003cp\u003e本篇博客记录了使用 docker 部署 tomcat 的方法。\u003c/p\u003e","tags":["Tomcat","DevOps","Docker"],"title":"使用 docker 容器部署 Tomcat","url":"https://xdhuxc.github.io/posts/devops/tomcat/tomcat-docker/","wordcount":231},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 部署 zookeeper 集群的方法。\u003c/p\u003e\n\u003ch3 id=\"zookeeper集群搭建\"\u003eZookeeper集群搭建\u003c/h3\u003e\n\u003cp\u003e三台虚拟机情况如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e虚拟机名称\u003c/th\u003e\n\u003cth\u003eIP地址\u003c/th\u003e\n\u003cth\u003e其他\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ecentos_3\u003c/td\u003e\n\u003ctd\u003e192.168.244.129\u003c/td\u003e\n\u003ctd\u003ezk_master\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecentos_4\u003c/td\u003e\n\u003ctd\u003e192.168.244.135\u003c/td\u003e\n\u003ctd\u003ezk_slave1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ecentos_6\u003c/td\u003e\n\u003ctd\u003e192.168.244.136\u003c/td\u003e\n\u003ctd\u003ezk_slave2\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e均已经安装了java 1.8.0_144\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e1、在 zk_master 机器上下载 \u003ccode\u003ezookeeper-3.4.10.tar.gz\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、解压 \u003ccode\u003ezookeeper-3.4.10.tar.gz\u003c/code\u003e 文件，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etar -zxf zookeeper-3.4.10.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、创建所需文件和目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir /data\nmkidr -p /data/zookpeer\nmkdir -p /data/zookeper/data\nmkdir -p /data/zookeeper/log\ntouch /data/zookeeper/data/myid\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、进入 \u003ccode\u003ezookeeper-3.4.10/conf\u003c/code\u003e 目录下，复制配置文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp zoo_sample.cfg zoo.cfg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、修改以下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etickTime=2000 # 单位毫秒，服务器之间或者客户端与服务器之间的心跳间隔\ninitLimit=10  # 初始化Follower最长时间：10 * 2000 ms\nsyncLimit=5   # Leader与Follower之间发送消息请求和应答时间长度：5 * 2000 ms\ndataDir=/data/zookeeper/data # 日志存储路径\ndataLogDir=/data/zookeeper/log # 事务日志存储路径\nclientPort=52181 # 客户端端口\nserver.1=192.168.244.129:12888:13888    \nserver.2=192.168.244.135:12888:13888    \nserver.3=192.168.244.136:12888:13888  \n\nautopurge.snapRetainCount=15 # 每次清除日志后保留的文件数目\nautopurge.purgeInterval=1 # 清除日志频率，单位小时\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eserver.A=B:C:D\nA 是一个数字,表示这个是第几号服务器,\nB 是这个服务器的ip地址\nC 第一个端口用来集群成员的信息交换,表示的是这个服务器与集群中的Leader服务器交换信息的端口\nD 是在leader挂掉时专门用来进行选举leader所用\u003c/p\u003e\n\u003cp\u003e6、向 \u003ccode\u003e/data/zookeeper/data/myid\u003c/code\u003e 中写入服务标识\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho \u0026#34;1\u0026#34; \u0026gt; /data/zookeeper/data/myid\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、将 zk_master 中的 zookeeper-3.4.10 复制到 zk_slave1 和 zk_slave2 机器上\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003escp -r /home/application/zookeeper-3.4.10 root@192.168.244.135:/home/application/\nscp -r /home/application/zookeeper-3.4.10 root@192.168.244.136:/home/application/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、在 zk_slave1 和 zk_slave2 上创建 myid 文件并写入内容\n在 zk_slave1 上\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etouch /data/zookeeper/data/myid\necho \u0026#34;2\u0026#34; \u0026gt; /data/zookeeper/data/myid\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 zk_slave2 上\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etouch /data/zookeeper/data/myid\necho \u0026#34;3\u0026#34; \u0026gt; /data/zookeeper/data/myid\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e9、在三台机器上都开放防火墙端口\u003ccode\u003e52181\u003c/code\u003e，\u003ccode\u003e12888\u003c/code\u003e，\u003ccode\u003e13888\u003c/code\u003e，并重新启动防火墙。\u003c/p\u003e\n\u003cp\u003e10、在三台机器上分别启动Zookeeper\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@centos_3 bin]# cd /home/application/zookeeper-3.4.10/bin\n[root@centos_3 bin]# ./zkServer.sh start\n\n[root@centos_4 bin]# cd /home/application/zookeeper-3.4.10/bin\n[root@centos_4 bin]# ./zkServer.sh start\n\n[root@centos_6 bin]# cd /home/application/zookeeper-3.4.10/bin\n[root@centos_6 bin]# ./zkServer.sh start\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e11、查看 zookeeper 的启动状态\n在 zk_master 上\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@centos_3 bin]# ./zkServer.sh status\nZooKeeper JMX enabled by default\nUsing config: /home/application/zookeeper-3.4.10/bin/../conf/zoo.cfg\nMode: follower\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 zk_slave1 上\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@centos_4 bin]# ./zkServer.sh status\nZooKeeper JMX enabled by default\nUsing config: /home/application/zookeeper-3.4.10/bin/../conf/zoo.cfg\nMode: leader\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 zk_slave2 上\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@centos_6 bin]# ./zkServer.sh status\nZooKeeper JMX enabled by default\nUsing config: /home/application/zookeeper-3.4.10/bin/../conf/zoo.cfg\nMode: follower\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"相关问题及解决\"\u003e相关问题及解决\u003c/h3\u003e\n\u003cp\u003e1、启动 zookeeper 节点后出现如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@centos_6 bin]# ./zkServer.sh status\nZooKeeper JMX enabled by default\nUsing config: /home/application/zookeeper-3.4.10/bin/../conf/zoo.cfg\nError contacting service. It is probably not running.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e查看 \u003ccode\u003e/home/application/zookeeper-3.4.10/bin\u003c/code\u003e 目录下的 \u003ccode\u003ezookeeper.out\u003c/code\u003e 文件，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e017-10-10 16:06:47,701 [myid:1] - WARN  [WorkerSender[myid=1]:QuorumCnxManager@588] - Cannot open channel to 3 at election address /192.168.244.136:13888\njava.net.ConnectException: Connection refused (Connection refused)\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:589)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:562)\n\tat org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:538)\n\tat org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:452)\n\tat org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:433)\n\tat java.lang.Thread.run(Thread.java:748)\n2017-10-10 16:06:47,705 [myid:1] - INFO  [WorkerSender[myid=1]:QuorumPeer$QuorumServer@167] - Resolved hostname: 192.168.244.136 to address: /192.168.244.136\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e分别在三台虚拟机上开放 \u003ccode\u003e52181\u003c/code\u003e、\u003ccode\u003e12888\u003c/code\u003e、\u003ccode\u003e13888\u003c/code\u003e 三个端口，重新启动，即可正常启动。\u003c/p\u003e","date":1530144000,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"2bc3b5f90611b44f6fd330bd17dd52ab","publishdate":1530144000,"relpermalink":"/posts/devops/zookeeper/zookeeper-cluster-deployment/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 部署 zookeeper 集群的方法。\u003c/p\u003e","tags":["Zookeeper","DevOps"],"title":"部署 Zookeeper 集群","url":"https://xdhuxc.github.io/posts/devops/zookeeper/zookeeper-cluster-deployment/","wordcount":850},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍 Redis 的特点及优势，还有它和其他键值数据库的区别。\u003c/p\u003e\n\u003ch3 id=\"redis-简介\"\u003eRedis 简介\u003c/h3\u003e\n\u003cp\u003eREmote DIctionary Server，缩写为：Redis，是一个高性能的 key-value 数据库。\u003c/p\u003e\n\u003cp\u003eRedis 是一个开源的使用 ANSI C 语言编写、遵守 BSD 协议、支持网络、可基于内存、也可持久化的日志型、Key-Value 数据库，并提供多种编程语言的 API。\u003c/p\u003e\n\u003cp\u003e它通常被称为数据结构服务器，因为值可以是字符串，哈希表，列表， 集合和有序集合等类型。\u003c/p\u003e\n\u003ch3 id=\"redis-特点\"\u003eRedis 特点\u003c/h3\u003e\n\u003cp\u003eRedis 与其他 key - value 缓存产品有以下三个特点：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eRedis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRedis不仅仅支持简单的 key-value 类型的数据，同时还提供 list、set、zset、hash 等数据结构的存储。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRedis 支持数据的备份，即 master-slave 模式的数据备份。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"redis-优势\"\u003eRedis 优势\u003c/h3\u003e\n\u003cp\u003eRedis 的优势包括：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e性能极高：Redis能读的速度是 110000 次/s，写的速度是 81000 次/s。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e丰富的数据类型：Redis支持字符串、列表、哈希表、 集合及有序集合等大多数数据类型操作。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e原子性：Redis 的所有操作都是原子性的，同时 Redis 还支持对几个操作全并后的原子性执行。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e丰富的特性：Redis 还支持发布/订阅，通知，键过期等特性。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"redis-与其他键值数据库的区别\"\u003eRedis 与其他键值数据库的区别：\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eRedis 有着更为复杂的数据结构并且提供对它们的原子性操作，这是一个不同于其他键值数据库的进化路径。Redis 的数据类型都是基于基本数据结构的同时对程序员透明，无需进行额外的抽象。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRedis 运行在内存中，但是可以持久化到磁盘，所以在对不同数据集进行高速读写时需要权衡内存，因为数据量不能大于硬件内存。在内存数据库方面的另一个优点是，相比在磁盘上相同的复杂的数据结构，在内存中操作起来非常简单，这样 Redis 可以做很多内部复杂性很强的事情。同时，在磁盘格式方面它们是紧凑的以追加的方式产生的，因为他们并不需要进行随机访问。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e","date":1530057600,"description":"","fuzzywordcount":800,"kind":"page","lang":"zh","lastmod":1530057600,"objectID":"7d57401009a0d7029a040e3206cea526","publishdate":1530057600,"relpermalink":"/posts/storage/redis/redis-summary/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍 Redis 的特点及优势，还有它和其他键值数据库的区别。\u003c/p\u003e","tags":["Redis","数据库"],"title":"Redis 概述","url":"https://xdhuxc.github.io/posts/storage/redis/redis-summary/","wordcount":734},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了一些 git 使用过程中常用的命令，方便查看。\u003c/p\u003e\n\u003ch3 id=\"git-命令\"\u003eGit 命令\u003c/h3\u003e\n\u003ch4 id=\"tag\"\u003etag\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003etag 命令用于创建一个标签，表示一个提交点，默认情况下，基于本地当前分支的最后一个提交创建标签。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、创建本地标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit tag tagName\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、推送至远程仓库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit push origin tagName\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、查看某个 tag 的信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit show tagName\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、查看本地所有 tag\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit tag -l\n或\ngit tag\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、基于某个特定的提交创建标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit log --pretty=oneline    # 查看当前分支的提交历史，其中包含提交 ID\ngit tag -a tagName commitID # 基于特定的 commitID 提交创建标签\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、查看远程所有标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit ls-remote --tags origin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、删除标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit tag -d tagName       # 删除本地标签\ngit push origin :tagName # 删除远程标签\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、重命名标签，采取的方法是：删除旧标签，创建新标签的策略\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 如果标签只存在于本地，那么只需要删除本地旧标签，创建新的标签即可\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003egit tag oldTagName\ngit tag newTagName\ngit push origin newTagName\n\u003cspan class=\"gh\"\u003e# 如果标签已经推送至远程，则不仅要删除本地的，还要删除远程的，再重新创建和推送\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003egit tag -d oldTagName\ngit push origin:oldTagName\ngit tag newTagName\ngit push origin newTagName\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e9、迁出标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit checkout -b branchName tagName\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"clone\"\u003eclone\u003c/h4\u003e\n\u003cp\u003e1、迁出指定标签的代码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit clone --branch tagName git@github.xdhuxc/xdhuxc.git\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"remote\"\u003eremote\u003c/h4\u003e\n\u003cp\u003e1、列出已经存在的远程分支\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:xdhuxc wanghuan$ git remote\norigin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、列出已经存在的远程分支的地址\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:xdhuxc wanghuan$ git remote get-url origin\ngit@github.xdhuxc/xdhuxc.git\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、添加远程仓库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit remote add origin git@github.xdhuxc/xdhuxc.git\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"head\"\u003ehead\u003c/h4\u003e\n\u003cp\u003eHEAD指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令git reset --hard commit_id\u003c/p\u003e\n\u003cp\u003e在Git中，用HEAD表示当前版本，上一个版本就是HEAD^，上上一个版本就是HEAD^^，当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100\u003c/p\u003e\n\u003ch4 id=\"log\"\u003elog\u003c/h4\u003e\n\u003cp\u003e可以查看提交历史，包括提交的时间，作者，和提交是的说明（即-m 命令后的内容），以便确定要回退到哪个版本。\u003c/p\u003e\n\u003ch4 id=\"relog\"\u003erelog\u003c/h4\u003e\n\u003cp\u003e查看命令历史，查到每次提交的id号，即commit id,以及提交时的说明，以便确定要回到未来的哪个版本。\u003c/p\u003e\n\u003ch3 id=\"从功能到命令\"\u003e从功能到命令\u003c/h3\u003e\n\u003ch4 id=\"切换分支\"\u003e切换分支\u003c/h4\u003e\n\u003cp\u003e1、使用本地 git 命令创建新分支\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit branch xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、切换到新分支，master 分支上的内容自动同步\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit checkout xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、将新分支发布到 github 上\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit push origin xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003col start=\"4\"\u003e\n\u003cli\u003e返回当前分支的名称\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit rev-parse --abbrev-ref HEAD\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此命令会返回当前分支的名称，由于所有的代码肯定会在一个分支上，所以，此命令绝对不会出错。\u003c/p\u003e\n\u003ch4 id=\"git-将一个本地工程推向多个远程仓库\"\u003egit 将一个本地工程推向多个远程仓库\u003c/h4\u003e\n\u003cp\u003e推送时，可以同时推送至多个远程仓库\n1、添加另外一个远程仓库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit remote set-url --add origin git@github.com:xdhuxc/xdhuxc.git\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、推送\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit push origin master:master\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"设置本地分支对应的远程分支\"\u003e设置本地分支对应的远程分支\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003egit branch --set-upstream-to=origin/s0.20.2 s0.20.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此命令将本地分支 \u003ccode\u003es0.20.2\u003c/code\u003e 对应的远程分支设置为 \u003ccode\u003es0.20.2\u003c/code\u003e\u003c/p\u003e\n\u003ch4 id=\"生成ssh-key\"\u003e生成SSH-key\u003c/h4\u003e\n\u003cp\u003egithub的SSH配置如下：\u003c/p\u003e\n\u003cp\u003e1、设置GitHub用户的用户名和邮箱\n设置命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e git config --global user.name \u0026#34;xdhuxc\u0026#34; \u003cspan class=\"ni\"\u003e#设置GitHub用户的用户名\u003c/span\u003e\n\ngit config --global user.email \u0026#34;xdhuxc@163.com\u0026#34; \u003cspan class=\"ni\"\u003e#设置GitHub用户的邮箱\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看是否已经有了ssh密钥：\u003ccode\u003ecd ~/.ssh\u003c/code\u003e，如果没有密钥则不会有此文件夹，有则备份删除；生成密钥：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003essh-keygen -t rsa -C \u0026#34;xdhuxc@163.com\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e按三个“Enter”，密码为空，在此过程中，将会在 \u003ccode\u003e~/.ssh\u003c/code\u003e 目录下生成 \u003ccode\u003eid_rsa\u003c/code\u003e 和 \u003ccode\u003eid_rsa.pub\u003c/code\u003e 两个文件。\u003c/p\u003e\n\u003cp\u003e3、在github上添加SSH密钥，即添加id_rsa.pub文件中的内容至“settings”-\u0026gt;“SSH and GPG keys”。\u003c/p\u003e\n\u003cp\u003e4、测试是否能够连接成功。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003essh git@github.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1529366400,"description":"","fuzzywordcount":1200,"kind":"page","lang":"zh","lastmod":1529366400,"objectID":"1b0eeeae421a0ca588346d38e29fd46b","publishdate":1529366400,"relpermalink":"/posts/mixed/git/git-common-command/","section":"posts","summary":"\u003cp\u003e本篇博客记录了一些 git 使用过程中常用的命令，方便查看。\u003c/p\u003e","tags":["Git"],"title":"Git 常用命令备忘录","url":"https://xdhuxc.github.io/posts/mixed/git/git-common-command/","wordcount":1197},{"categories":"posts","content":"\u003cp\u003e本篇博客详细记录了在 Linux 系统中使用 iptraf 进行端口流量观察的方法，可以帮助我们分析应用程序端口的网络流入和网络流出。\u003c/p\u003e\n\u003cp\u003eiptraf 是一个基于ncurses开发的IP局域网监控工具，可以实时地监视网卡流量，可以生成各种网络统计数据，包括TCP信息、UDP统计、ICMP和OSPF信息、以太网负载信息、节点统计、IP校验和错误和其他一些信息。\u003c/p\u003e\n\u003ch3 id=\"观察端口网络流量\"\u003e观察端口网络流量\u003c/h3\u003e\n\u003cp\u003e1、安装 \u003ccode\u003eiptraf\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y iptraf-ng-1.1.4-6.el7.x86_64\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动 \u003ccode\u003eiptraf-ng\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptraf-ng\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e进入如下页面：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG626.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e使用 \u003ccode\u003e↑\u003c/code\u003e 或 \u003ccode\u003e↓\u003c/code\u003e，选择 \u003ccode\u003eConfigure\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG627.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e按 \u003ccode\u003eEnter\u003c/code\u003e，进入设置页面，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG628.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e进行适当的配置，可以让统计的结果更直观，信息更加丰富。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eReverse DNS lookups：查看连接的IP所对应的域名，在IP traffic monitor的pkt captured 对话框中就可以看到域名结果，这个不是很直观，开启后会有点影响抓包性能。\u003c/li\u003e\n\u003cli\u003eTCP/UDP service names：在有端口的地方都会把端口号换成相应的服务名，非常有用，很直观。\u003c/li\u003e\n\u003cli\u003eActivity mode：显示流量是按Kbits/s还是Kbytes/s，改为Kbytes，更符合习惯。\u003c/li\u003e\n\u003cli\u003eAdditional ports：按端口号监控额外需要监控的端口，默认只监控小于1024的。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e选择 \u003ccode\u003eAdditional ports\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG629.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e按 \u003ccode\u003eEnter\u003c/code\u003e，进入端口设置页面，设置端口范围为：\u003ccode\u003e1024~10000\u003c/code\u003e，按 \u003ccode\u003eTab\u003c/code\u003e 键跳转至第二个输入框。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG630.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e按 \u003ccode\u003eEnter\u003c/code\u003e 键保存端口设置。然后退出配置页面\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG631.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e退出 \u003ccode\u003eiptraf\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG632.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e3、重新打开iptraf\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptraf-ng\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e选择 \u003ccode\u003eStatistical breakdowns\u003c/code\u003e，\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG633.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e按 \u003ccode\u003eEnter\u003c/code\u003e 键，选择 \u003ccode\u003eBy TCP/UDP port\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG634.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e选择待检测的网卡 \u003ccode\u003eens192\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG635.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e按 \u003ccode\u003eEnter\u003c/code\u003e 键，就可以看到此网卡上的端口对应的协议类型和网络流量了。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG636.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e按 \u003ccode\u003eS\u003c/code\u003e 键，对输出信息进行排序\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG637.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e按 \u003ccode\u003eB\u003c/code\u003e 键，按照总的字节数进行排序\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/iptraf-network-flow/WechatIMG638.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e按 \u003ccode\u003eX\u003c/code\u003e 键退出。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://www.cnblogs.com/taosim/articles/4030292.html\"\u003ehttps://www.cnblogs.com/taosim/articles/4030292.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/quiet_girl/article/details/50777210\"\u003ehttps://blog.csdn.net/quiet_girl/article/details/50777210\u003c/a\u003e\u003c/p\u003e","date":1529366400,"description":"","fuzzywordcount":700,"kind":"page","lang":"zh","lastmod":1534636800,"objectID":"e81e933bf62f47d1f309469d3c5f323b","publishdate":1529366400,"relpermalink":"/posts/linux/linux-iptraf-network-flow/","section":"posts","summary":"\u003cp\u003e本篇博客详细记录了在 Linux 系统中使用 iptraf 进行端口流量观察的方法，可以帮助我们分析应用程序端口的网络流入和网络流出。\u003c/p\u003e","tags":["Linux","iptraf"],"title":"使用 iptraf 观察端口网络流量","url":"https://xdhuxc.github.io/posts/linux/linux-iptraf-network-flow/","wordcount":625},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了基于 docker 容器方式部署 MySQL 数据库管理工具 phpMyAdmin 的方法。\u003c/p\u003e\n\u003ch3 id=\"phpmyadmin\"\u003ephpmyadmin\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ephpmyadmin\u003c/code\u003e 是一个 \u003ccode\u003eMySQL\u003c/code\u003e 数据库管理工具，使用 \u003ccode\u003ephpmyadmin\u003c/code\u003e 实现在网页中连接、操作数据库，实现数据迁移。使用前，必须确保主机上数据库 \u003ccode\u003emysqld\u003c/code\u003e 服务已经启动。\u003c/p\u003e\n\u003cp\u003e1、拉取 phpMyAdmin 镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull phpmyadmin/phpmyadmin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动 phpMyAdmin 镜像\u003c/p\u003e\n\u003cp\u003e连接单个数据库时启动 phpmyadmin 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run --name=myadmin -p 8080:80 -e PMA_HOST=192.168.244.128 -e MYSQL_ROOT_PASSWORD=286X326_h -d phpmyadmin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ePMA_HOST：待连接的 MySQL 数据库服务器所在主机；\nMYSQL_ROOT_PASSWORD：MySQL 数据库 root 用户密码；\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、在同一个页面中连接多个数据库时启动 phpmyadmin 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run --name=myadmin -p 8080:80 -e PMA_HOSTS=192.168.244.128,192.168.244.134 -e PMA_ARBITRARY=1 -d phpmyadmin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ePMA_HOSTS：待连接的 MySQL 数据库所在主机 IP 地址，多个 IP 地址以 \u003cspan class=\"sb\"\u003e`,`\u003c/span\u003e 分隔；\nPMA_ARBITRARY：允许连接多个 MySQL 数据库；\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/* Arbitrary server connection */                                     \nif (isset($_ENV[\u0026#39;PMA_ARBITRARY\u0026#39;]) \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e $_ENV[\u0026#39;PMA_ARBITRARY\u0026#39;] === \u0026#39;1\u0026#39;) {                              \n    $cfg[\u0026#39;AllowArbitraryServer\u0026#39;] = true;                                                            \n} \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、访问 phpMyAdmin\u003c/p\u003e\n\u003cp\u003e访问地址为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.1.161:8080\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在启动容器时，更改端口后访问地址为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.1.161:8090/\n或\nhttp://172.20.1.161:8090/index.php\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在MySQL服务器所在主机上，以root用户登陆进去，执行如下命令，为用户赋予远程访问权限：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eGRANT ALL PRIVILEGES ON \u003cspan class=\"ge\"\u003e*.*\u003c/span\u003e TO \u0026#39;root\u0026#39;@\u0026#39;172.17.0.2\u0026#39; IDENTIFIED BY \u0026#39;286X326_h\u0026#39; WITH GRANT OPTION;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e286X326_h为数据库root用户密码\u003c/p\u003e\n\u003ch3 id=\"将-phpmyadmin-嵌入其他页面\"\u003e将 phpMyAdmin 嵌入其他页面\u003c/h3\u003e\n\u003cp\u003e进入容器中，复制 \u003ccode\u003e/www/libraries/config.default.php\u003c/code\u003e 到 \u003ccode\u003e/www\u003c/code\u003e 目录下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp /www/libraries/config.default.php /www/config.inc.php\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e更改 \u003ccode\u003e/www/config.inc.php\u003c/code\u003e 的配置参数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$cfg[\u0026#39;AllowThirdPartyFraming\u0026#39;] = true; \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 \u003ccode\u003e/www/libraries/Header.php\u003c/code\u003e 文件中的 sendHttpHeaders 函数，将 \u003ccode\u003eX-Frame-Options \u003c/code\u003e由 \u003ccode\u003edeny\u003c/code\u003e 改为 \u003ccode\u003eALLOW-FROM\u003c/code\u003e，并加入待嵌入页面的地址，例如：\u003ccode\u003eALLOW-FROM http://123.103.9.208:6081/#outer/index/28\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e if (! $GLOBALS[\u0026#39;cfg\u0026#39;][\u0026#39;AllowThirdPartyFraming\u0026#39;]) {                                          \n            header(                                                                                 \n                \u0026#39;X-Frame-Options: ALLOW-FROM http://123.103.9.208:6081/#outer/index/28\u0026#39;             \n            );                                                                                      \n        }             \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 \u003ccode\u003e/www/js/cross_framing_protection.js\u003c/code\u003e 文件中的内容如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/* vim: set expandtab sw=4 ts=4 sts=4: */\n/**\n \u003cspan class=\"k\"\u003e*\u003c/span\u003e Conditionally included if framing is not allowed\n */\nif (self == top) {\n    document.documentElement.style.display = \u0026#39;block\u0026#39;;\n    //var style_element = document.getElementById(\u0026#34;cfs-style\u0026#34;);\n    // check if style_element has already been removed\n    // to avoid frequently reported js error\n    //if (typeof(style_element) != \u0026#39;undefined\u0026#39; \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e style_element != null) {\n    //    style_element.parentNode.removeChild(style_element);\n    //}\n} else {\n    //top.location = self.location;\n    document.documentElement.style.display = \u0026#39;block\u0026#39;;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003ephpmyadmin同步功能 \u003ca href=\"http://www.360doc.com/content/12/1204/15/1440938_252069458.shtml\"\u003ehttp://www.360doc.com/content/12/1204/15/1440938_252069458.shtml\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e嵌入其他页面，需要修改配置 \u003ca href=\"http://blog.csdn.net/l6807718/article/details/51179507\"\u003ehttp://blog.csdn.net/l6807718/article/details/51179507\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e解决问题的 \u003ca href=\"http://vps.gl/vps/161.html\"\u003ehttp://vps.gl/vps/161.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e官方文档 \u003ca href=\"https://docs.phpmyadmin.net/en/latest/setup.html#installing-using-docker\"\u003ehttps://docs.phpmyadmin.net/en/latest/setup.html#installing-using-docker\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e在centos中安装phpmyadmin，包括安装httpd，php \u003ca href=\"http://www.cnblogs.com/xjxz/p/6550397.html\"\u003ehttp://www.cnblogs.com/xjxz/p/6550397.html\u003c/a\u003e\u003c/p\u003e","date":1528761600,"description":"","fuzzywordcount":800,"kind":"page","lang":"zh","lastmod":1532822400,"objectID":"87119811e45e69a7385c553747ab1622","publishdate":1528761600,"relpermalink":"/posts/storage/mysql/mysql-phpmyadmin-with-docker/","section":"posts","summary":"\u003cp\u003e本篇博客记录了基于 docker 容器方式部署 MySQL 数据库管理工具 phpMyAdmin 的方法。\u003c/p\u003e","tags":["MySQL","phpMyAdmin","数据库"],"title":"基于 docker 容器方式部署 MySQL 数据库管理工具 phpMyAdmin","url":"https://xdhuxc.github.io/posts/storage/mysql/mysql-phpmyadmin-with-docker/","wordcount":722},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 Linux 系统中使用 NTP 进行时间同步的方法。\u003c/p\u003e\n\u003cp\u003e1、将Linux系统时钟同步到远程NTP服务器，需要在系统上安装NTP以实现与NTP服务器的自动时间同步，要开始自动时间同步到远程NTP服务器，使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etimedatectl set-ntp true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行该命令后，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# timedatectl set-ntp true\nFailed to set ntp: NTP not supported.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e检查本机是否安装了 \u003ccode\u003entp\u003c/code\u003e 客户端，如果没有，使用如下命令安装：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y ntp\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、重启 \u003ccode\u003entp\u003c/code\u003e 客户端并设置开机启动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl restart ntpd\nsystemctl enable ntpd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、可看到 \u003ccode\u003eNTP synchronized\u003c/code\u003e 已经为 \u003ccode\u003eyes\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# timedatectl \n      Local time: Sat 2019-12-28 11:52:05 CST\n  Universal time: Sat 2019-12-28 03:52:05 UTC\n        RTC time: Sat 2019-12-28 03:52:04\n       Time zone: Asia/Shanghai (CST, +0800)\n     NTP enabled: yes\nNTP synchronized: yes\n RTC in local TZ: no\n      DST active: n/a\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、要禁用NTP时间同步，使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etimedatectl set-ntp false\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1526688000,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1534636800,"objectID":"e518894dff550b91f79e2c70b4c53639","publishdate":1526688000,"relpermalink":"/posts/linux/linux-ntp/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 Linux 系统中使用 NTP 进行时间同步的方法。\u003c/p\u003e","tags":["Linux","NTP"],"title":"Linux 中配置时间同步","url":"https://xdhuxc.github.io/posts/linux/linux-ntp/","wordcount":272},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了 Ansible Playbook 的使用方法。\u003c/p\u003e\n\u003ch3 id=\"ansible-playbook\"\u003eAnsible Playbook\u003c/h3\u003e\n\u003cp\u003eansible playbook 是一系列 ansible 命令的集合，使用 yaml 语言编写，playbook 命令根据自上而下的顺序依次执行。Ansible 可以完成一组复杂的动作，例如部署环境、搭建服务、修改配置等。Ansible 可以允许传输某个命令的状态到后面的指令，例如，我们可以从一台机器的文件中抓取内容并赋为变量，然后在另外一台机器中使用，这使得我们可以实现一些复杂的部署机制，这是 ansible 命令所无法实现的。\u003c/p\u003e\n\u003cp\u003eansible-playbook 的简单使用方法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eansible-playbook ./xdhuxc-play.yaml # 执行 xdhuxc-play.yaml 文件\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"简单示例\"\u003e简单示例\u003c/h4\u003e\n\u003cp\u003e下面是一个简单的 ansible-playbook 的示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: create user\n    hosts: all\n    user: root\n    gather_facts: false\n    vars:\n      user: \u0026#34;xdhuxc\u0026#34;\n    tasks:\n      \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: create user\n          user: name=\u0026#34;{{user}}\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上 playbook 实现的功能是：新增一个用户\u003c/p\u003e\n\u003cp\u003e说明如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ename：对该 playbook 实现的功能做一个描述，后面执行过程中，会打印 name 变量的值；\u003c/li\u003e\n\u003cli\u003ehosts：指定了要进行操作的主机。\u003c/li\u003e\n\u003cli\u003euser：指定了登录远程主机操作的用户。\u003c/li\u003e\n\u003cli\u003egather_facts：指定了在以下任务部分执行前，是否先执行 setup 模块获取主机相关信息。\u003c/li\u003e\n\u003cli\u003evars：指定变量。这里指定一个变量 user，其值为 xdhuxc，需要注意，变量值一定要使用双引号引住。\u003c/li\u003e\n\u003cli\u003etask：指定了一个任务，其下面的 name 参数同样是对任务的描述，在执行过程中会打印出来。user 指定了调用 user 模块，name 是 user 模块里的一个参数，而增加的用户名字调用了上面 vars 中的 user 变量的值。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如果想实现删除用户，只需要将该 playbook 文件的最后一行替换为如下行：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003euser: name=\u0026#34;{{user}}\u0026#34; state=absent remove=yes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"通过-playbook-安装-apache-示例\"\u003e通过 PlayBook 安装 Apache 示例\u003c/h4\u003e\n\u003cp\u003e通过 ansible-playbook 实现对多台主机同时安装 apache。需要注意的是，多台被管理主机的操作系统可能不同，从而apache包名不同。假设同时存在 CentOS 和 Debian 两种操作系统。具体 PlayBook 内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 安装 apache\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e hosts: all\n  remote_user: root\n  gather_facts: True\n  tasks:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: install apache on CentOS\n      yum: \n        name: httpd\n        state: latest\n      when: ansible_os_family == \u0026#34;CentOS\u0026#34;\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: install apache on Debian\n      yum: \n        name: apache2\n        state: latest\n      when: ansible_os_family == \u0026#34;Debian\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上 playbook 使用了 when 语句，同时也开启了 gather_facts setup 模块，这里的 ansible_os_family 变量就是直接使用 setup 模块获取的信息。如果有大量主机，就在运行的时候加上 -f 选项，然后指定一个合适的并发主机数量即可。\u003c/p\u003e\n\u003ch4 id=\"playbook-的构成\"\u003ePlayBook 的构成\u003c/h4\u003e\n\u003cp\u003eplaybook 是由一个或多个 play 组成的列表，play 的主要功能在于将事先归并为一组的主机修饰成通过 ansible 中的 task 定义好的角色。从根本上来讲，task 其实就是调用 ansible 的一个 module。将多个 play 组织在一个 playbook 中，即可让他们联动起来按照事先编排的顺序共同完成任务。\u003c/p\u003e\n\u003cp\u003ePlayBook 主要由以下四部分组成：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTarget section：定义将要执行 playbook 的远程主机组。\u003c/li\u003e\n\u003cli\u003eVariable section：定义 playbook 运行时需要使用的变量。\u003c/li\u003e\n\u003cli\u003eTask section：定义将要在远程主机上执行的任务列表。\u003c/li\u003e\n\u003cli\u003eHandler section：定义 task 执行完成以后需要调用的任务。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e而其一般所需的目录层为如下五个：（视具体情况可变化）\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003evars 变量层\u003c/li\u003e\n\u003cli\u003etasks 任务层\u003c/li\u003e\n\u003cli\u003ehandlers 触发条件\u003c/li\u003e\n\u003cli\u003efiles 文件\u003c/li\u003e\n\u003cli\u003etemplate 模板\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"hosts-和-users\"\u003eHosts 和 Users\u003c/h5\u003e\n\u003cp\u003ePlayBook 中的每一个 play 的目的都是为了让某个或某些主机以某个指定的用户身份执行任务。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ehosts：用于指定要执行指定任务的主机，可以是一个或多个由冒号分隔的主机组。\u003c/li\u003e\n\u003cli\u003eremote_user：用于指定远程主机上的执行任务的用户。不过 remote_user 也可用于各 task 中，也可以通过指定 sudo 的方式在远程主机上执行任务，其可用于 play 全局或某任务。此外，还可以在 sudo 时，使用 sudo_user 指定 sudo 时切换的用户。\u003c/li\u003e\n\u003cli\u003euser：与 remote_user 相同。\u003c/li\u003e\n\u003cli\u003esudo：如果设置为 yes，执行该任务组的用户在执行任务的时候，获取 root 权限。\u003c/li\u003e\n\u003cli\u003esudo_user：如果设置 user 为 xdhuxc，sudo 为 yes，sudo_user 为 wanghuan 时，则 xdhuxc 用户在执行任务时会获得 wanghuan 用户的权限。\u003c/li\u003e\n\u003cli\u003econnection：连接到远程主机的方式，默认为 ssh。\u003c/li\u003e\n\u003cli\u003egather_facts：除非明确说明不需要在远程主机上执行 setup 模块，否则默认自动执行。如果确实不需要 setup 模块传递过来的变量，则可以将该选项设置为：False\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e示例如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e hosts: webnodes\n  tasks:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: test ping connection\n    remote_user: xdhuxc\n    sudo: yes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"任务列表和-action\"\u003e任务列表和 Action\u003c/h5\u003e\n\u003cp\u003eplay 的主体部分是任务列表。任务列表中的各任务按次序逐个在 hosts 中指定的所有主机上执行，即在所有主机上完成第一个任务后，再开始第二个。在自上而下运行某 playbook 时，如果中途发生错误，所有已执行任务都将回滚。因此，发生错误时，修正 playbook 后重新执行一次即可。\u003c/p\u003e\n\u003cp\u003etask 的目的是使用指定的参数执行模块，而在模块参数中可以使用变量。模块执行是幂等的，这意味着多次执行是安全的，因为其结果均一致。每个 task 都应该有其 name，用于 playbook 的执行结果输出，建议其内容尽可能清晰地描述任务执行步骤。如果未提供 name，则 action 的结果将用于输出。\u003c/p\u003e\n\u003cp\u003e定义 task 的可以使用 \u0026quot;action: module options\u0026quot; 或 \u0026quot;module: options\u0026quot; 的格式，推荐使用后者以实现向后兼容。如果 action 一行的内容过多，也可以使用在行首使用几个空白字符进行换行。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etasks:\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: make sure apache is running\n  service: \n    name: httpd \n    state: running\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在众多的模块中，只有 command 和 shell 模块仅需要给定一个列表，而无需使用“key=value”格式，例如\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etasks:\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: disable selinux\n  command: /sbin/setenforce 0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果命令或脚本的退出码不为零，可以使用如下方式替代：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etask:\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: run this command and ignore the result\n  shell: /usr/bin/ls || /bin/true\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 ignore_errors 来忽略错误信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etask:\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: run this command and ignore the result\n  shell: /usr/bin/dockerd\n  ignore_errors: True\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"handlers\"\u003ehandlers\u003c/h5\u003e\n\u003cp\u003ehandlers 用于当关注的资源发生变化时采取一定的操作。\u003c/p\u003e\n\u003cp\u003enotify 这个 action 可用于在每个 play 的最后被触发，这样可以避免多次有改变发生时，每次都执行指定的操作，取而代之仅在所有的变化发生完成后一次性地执行指定操作。\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003enotify\u003c/code\u003e 中列出的操作称为 \u003ccode\u003ehandler\u003c/code\u003e，也即 \u003ccode\u003enotify\u003c/code\u003e 中调用 \u003ccode\u003ehandler\u003c/code\u003e 中定义的操作。\u003c/p\u003e\n\u003cp\u003e注意，在 \u003ccode\u003enotify\u003c/code\u003e 中定义内容一定要和 \u003ccode\u003etask\u003c/code\u003e 中定义的 \u003ccode\u003e- name\u003c/code\u003e 内容一样，这样才能达到触发的效果，否则会不生效。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: template configuration file\n    template: \n      src: /srv/httpd.j2\n      dest: /etc/httpd.conf\n    notify:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e restart memcached\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e restart apache\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ehandler 是 task 列表的这些 task，与前述的 task 并没有本质上的不同\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehandlers:\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: restart memcached\n service: \n   name: memcached\n   state: restarted\n\u003cspan class=\"k\"\u003e-\u003c/span\u003e name: restart apache\n service:\n   name: apache\n   state: restarted \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"tags\"\u003etags\u003c/h5\u003e\n\u003cp\u003etags 用于让用户选择运行或略过 playbook 中的部分代码。ansible 具有幂等性，因此会自动跳过没有变化的部分，即便如此，有些代码为测试其确实没有发生变化的时间依然会非常地长。此时，如果确信其没有变化就可以通过 tags 跳过这些代码片段。\u003c/p\u003e\n\u003ch5 id=\"完整的-playbook-示例\"\u003e完整的 PlayBook 示例\u003c/h5\u003e\n\u003cp\u003e/etc/ansible/hosts 文件配置如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[client]\n10.10.24.32\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e一个安装 httpd web 服务器的示例 yaml\u003c/p\u003e\n\u003cp\u003e/etc/ansible/playbook/install_web.yaml\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"k\"\u003e-\u003c/span\u003e hosts: client\n  vars:\n    http_port: 80\n    max_clients: 200\n  remote_user: root\n  tasks:\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: ensure apache is the latest version\n    yum:\n      name: httpd\n      state: latest\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: write the apache config file\n    template:\n      src: /root/httpd.j2\n      dest: /etc/httpd.conf\n    notify:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e restart apache\n  \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: ensure apache is running and enable it at boot\n    service:\n      name: httpd\n      state: started\n      enabled: yes\n  handlers:\n    \u003cspan class=\"k\"\u003e-\u003c/span\u003e name: restart apache\n      service:\n        name: httpd\n        state: restarted\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在安装 ansible 的机器上，运行如下命令执行该 playbook\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc roles]# pwd\n/etc/ansible/roles\n[root@xdhuxc roles]# ls\ninstall_web.retry  install_web.yaml\n[root@xdhuxc roles]# ansible-playbook ./install_web.yaml \n\nPLAY [client] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e***********************************************************************************************************************************************************\n\nTASK [Gathering Facts] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e**************************************************************************************************************************************************\nok: [10.10.24.32]\n\nTASK [ensure apache is the latest version] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e******************************************************************************************************************************\nok: [10.10.24.32]\n\nTASK [write the apache config file] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e*************************************************************************************************************************************\nchanged: [10.10.24.32]\n\nTASK [ensure apache is running and enable it at boot] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e*******************************************************************************************************************\nchanged: [10.10.24.32]\n\nRUNNING HANDLER [restart apache] \u003cspan class=\"ge\"\u003e**\u003c/span\u003e****************************************************************************************************************************************\nchanged: [10.10.24.32]\n\nPLAY RECAP \u003cspan class=\"ge\"\u003e**\u003c/span\u003e**************************************************************************************************************************************************************\n10.10.24.32                : ok=5    changed=3    unreachable=0    failed=0   \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1526256000,"description":"","fuzzywordcount":2600,"kind":"page","lang":"zh","lastmod":1526256000,"objectID":"2edfdbed57586230457389b19742e277","publishdate":1526256000,"relpermalink":"/posts/devops/ansible/ansible-playbook/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了 Ansible Playbook 的使用方法。\u003c/p\u003e","tags":["Ansible","DevOps"],"title":"Ansible 学习之简单入门","url":"https://xdhuxc.github.io/posts/devops/ansible/ansible-playbook/","wordcount":2564},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Ansible 的特点，和 SaltStack 的对比及其原理。\u003c/p\u003e\n\u003ch3 id=\"ansible-简介\"\u003eAnsible 简介\u003c/h3\u003e\n\u003cp\u003eAnsible 是一种集成IT系统的配置管理、应用部署、执行特定任务的运维工具。\u003c/p\u003e\n\u003cp\u003eAnsible 基于 Python 语言实现，由 Paramiko（由 Python 实现的高质量 OpenSSH 库） 和 PyYAML 两个关键模块构建。\u003c/p\u003e\n\u003ch3 id=\"ansible-特点\"\u003eAnsible 特点\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e部署简单，只需要在主控端部署 ansible 环境，被控端无需做任何操作。\u003c/li\u003e\n\u003cli\u003e默认使用 SSH（Secure Shell）协议对设备进行管理。\u003c/li\u003e\n\u003cli\u003e主从集中化管理。\u003c/li\u003e\n\u003cli\u003e配置简单，功能强大，扩展性强。\u003c/li\u003e\n\u003cli\u003e支持 API 及自定义模块，可通过 Python 轻松扩展。\u003c/li\u003e\n\u003cli\u003e通过 Playbooks 来定制强大的配置，状态管理。\u003c/li\u003e\n\u003cli\u003e对云计算平台，大数据都有很好的支持。\u003c/li\u003e\n\u003cli\u003e提供一个功能强大、操作性强的 Web 管理界面和 REST API 接口--- AWX 平台。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"ansible-与-saltstack\"\u003eAnsible 与 SaltStack\u003c/h3\u003e\n\u003ch4 id=\"相同点\"\u003e相同点\u003c/h4\u003e\n\u003cp\u003e都具备功能强大、灵活的系统管理、状态配置，都使用 YAML 格式来描述配置，两者都提供丰富的模板及 API，对云计算和大数据都有很好的支持。\u003c/p\u003e\n\u003ch4 id=\"区别\"\u003e区别\u003c/h4\u003e\n\u003cp\u003e最大的区别是 Ansible 无需在被监控主机部署任何客户端代理，默认通过 SSH 通道进行远程命令执行或下发配置。\u003c/p\u003e\n\u003ch3 id=\"ansible-使用\"\u003eAnsible 使用\u003c/h3\u003e\n\u003ch4 id=\"ansible-安装\"\u003eansible 安装\u003c/h4\u003e\n\u003cp\u003e使用 YUM 安装 ansible\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eyum install -y ansible\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"ansible-配置文件\"\u003eansible 配置文件\u003c/h4\u003e\n\u003cp\u003eansible 的配置文件在 \u003ccode\u003e/etc/ansible\u003c/code\u003e 目录下\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ls /etc/ansible/\nansible.cfg  hosts  roles\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e其中，\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eansible.cfg 是 ansible 工具的配置文件\u003c/li\u003e\n\u003cli\u003ehosts 用来配置被管理的机器\u003c/li\u003e\n\u003cli\u003eroles 是一个目录，playbook 将使用它。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"ansible-使用-1\"\u003eansible 使用\u003c/h4\u003e\n\u003cp\u003e（1）ansible 管理机与被管理机做秘钥认证\u003c/p\u003e\n\u003cp\u003e使用 ssh-keygen 生成秘钥，一路回车即可。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ssh-keygen\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/root/.ssh/id_rsa):\nCreated directory '/root/.ssh'.\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in /root/.ssh/id_rsa.\nYour public key has been saved in /root/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:dXG3C6BeEXWB0zYCji16agbNndYwJb51Ezw3WxDRiL0 root@xdhuxc\nThe key's randomart image is:\n+---[RSA 2048]----+\n|         . **=BOo|\n|        . B +O=B+|\n|         B.=.+*o=|\n|      o +.X.. E..|\n|     . +SB .   . |\n|      . +        |\n|       +         |\n|      o          |\n|                 |\n+----[SHA256]-----+\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e（2）将公钥写入被管理机\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub -p 22 root@192.168.91.130\n/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: \u0026quot;/root/.ssh/id_rsa.pub\u0026quot;\nUsage: /usr/bin/ssh-copy-id [-h|-?|-f|-n] [-i [identity_file]] [-p port] [[-o \u0026lt;ssh -o options\u0026gt;] ...] [user@]hostname\n\t-f: force mode -- copy keys without trying to check if they are already installed\n\t-n: dry run    -- no keys are actually copied\n\t-h|-?: print this help\n[root@xdhuxc ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub -p 22 root@192.168.91.130\n/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: \u0026quot;/root/.ssh/id_rsa.pub\u0026quot;\nThe authenticity of host '192.168.91.130 (192.168.91.130)' can't be established.\nECDSA key fingerprint is SHA256:9Nn+hqVia1ST1/u0qqZP+gVfeLAAwpYCsGgKlZT+8c4.\nECDSA key fingerprint is MD5:5d:ef:7a:42:ec:73:14:d4:de:38:c5:17:83:03:c7:ef.\nAre you sure you want to continue connecting (yes/no)? yes（输入yes）\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys\nroot@192.168.91.130's password: （输入被管控机密码）\n\nNumber of key(s) added: 1\n\nNow try logging into the machine, with:   \u0026quot;ssh -p '22' 'root@192.168.91.130'\u0026quot;\nand check to make sure that only the key(s) you wanted were added.\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e（3）hosts 文件中添加被管控机\n向 \u003ccode\u003e/etc/ansible/hosts\u003c/code\u003e 文件中加入被管控机信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[Client]\n192.168.91.130\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e（4） 测试 ansible\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m ping  # 操作 Client 组 （all 为操作 hosts 文件中的所有主机）\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: false,\n    \u0026quot;ping\u0026quot;: \u0026quot;pong\u0026quot;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-m：指定执行的模块，例如，-m ping，指定执行 ping 模块。\u003c/li\u003e\n\u003cli\u003e-i：指定 hosts 文件位置，默认为：/etc/ansible/hosts。\u003c/li\u003e\n\u003cli\u003e-u：指定 SSH 连接的用户名。\u003c/li\u003e\n\u003cli\u003e-k：指定远程用户密码。\u003c/li\u003e\n\u003cli\u003e-f：指定并发数。\u003c/li\u003e\n\u003cli\u003e-s：连接用户不是 root，但是需要 root 权限时使用。\u003c/li\u003e\n\u003cli\u003e-K：使用 -s 选项时，-K 指定输入 root 用户密码。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"ansible-原理\"\u003eansible 原理\u003c/h3\u003e\n\u003cp\u003eansible 的命令执行过程：\u003c/p\u003e\n\u003cp\u003e1、加载配置文件，默认为：\u003ccode\u003e/etc/ansible/ansible.cfg\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e2、匹配主机清单\u003c/p\u003e\n\u003cp\u003e3、加载指令对应的模块文件，如command，生成.py的文件到本机的临时目录，这个目录就是在 \u003ccode\u003e/etc/ansible/ansible.cfg\u003c/code\u003e 定义的\u003c/p\u003e\n\u003cp\u003e4、通过 \u003ccode\u003eansible\u003c/code\u003e 将模块或命令生成对应的临时py文件，并将该文件传输至远程服务器的对应执行用户 \u003ccode\u003e$HOME/.ansible/tmp/ansible-tmp-数字/XXX.PY\u003c/code\u003e 文件，这个目录就是在 \u003ccode\u003e/etc/ansible/ansible.cfg\u003c/code\u003e 定义的\u003c/p\u003e\n\u003cp\u003e5、给文件+x 权限\u003c/p\u003e\n\u003cp\u003e6、执行并返回结果\u003c/p\u003e\n\u003cp\u003e7、删除临时py文件，sleep 0退出\u003c/p\u003e\n\u003cp\u003e8、断开远程主机连接\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e官方文档 \u003ca href=\"https://docs.ansible.com/ansible/latest/index.html\"\u003ehttps://docs.ansible.com/ansible/latest/index.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e中文文档 \u003ca href=\"http://www.ansible.com.cn/\"\u003ehttp://www.ansible.com.cn/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e调用ansible API 示例 \u003ca href=\"https://blog.csdn.net/python_tty/article/details/73822071\"\u003ehttps://blog.csdn.net/python_tty/article/details/73822071\u003c/a\u003e\u003c/p\u003e","date":1526256000,"description":"","fuzzywordcount":1400,"kind":"page","lang":"zh","lastmod":1526256000,"objectID":"ef064c3dcab570419cccbfa3e4a90f12","publishdate":1526256000,"relpermalink":"/posts/devops/ansible/ansible-simple-use/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Ansible 的特点，和 SaltStack 的对比及其原理。\u003c/p\u003e","tags":["Ansible","DevOps"],"title":"Ansible 学习之简单入门","url":"https://xdhuxc.github.io/posts/devops/ansible/ansible-simple-use/","wordcount":1309},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 RabbitMq 的常用命令。\u003c/p\u003e\n\u003cp\u003e1、查看插件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erabbitmq-plugins list\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、开启管理插件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erabbitmq-plugins enable rabbitmq_management\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 rabbitmq\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl start rabbitmq-server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、查看 rabbitmq 的状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erabbitmqctl status\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、创建新用户\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erabbitmqctl add_user xdhuxc xdhuxc1994\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、为用户 \u003ccode\u003exdhuxc\u003c/code\u003e 赋予 \u003ccode\u003eadministrator\u003c/code\u003e 角色\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erabbitmqctl set_user_tags xdhuxc administrator\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、为用户 \u003ccode\u003exdhuxc\u003c/code\u003e 赋予权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erabbitmqctl set_permissions -p / xdhuxc \u0026#39;.*\u0026#39; \u0026#39;.*\u0026#39; \u0026#39;.*\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、查看用户及权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erabbitmqctl list_permissions\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1525824000,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1531180800,"objectID":"112a0e0a51e9750c1f7cd2be2d2cdb94","publishdate":1525824000,"relpermalink":"/posts/message/rabbitmq/rabbitmq-common-command/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 RabbitMq 的常用命令。\u003c/p\u003e","tags":["消息队列","RabbitMQ"],"title":"RabbitMQ 常用命令总结","url":"https://xdhuxc.github.io/posts/message/rabbitmq/rabbitmq-common-command/","wordcount":114},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了 Ansible 常用模块的用法。\u003c/p\u003e\n\u003ch3 id=\"模块相关命令\"\u003e模块相关命令\u003c/h3\u003e\n\u003cp\u003e（1）列出 ansible 支持的模块\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible-doc -l\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e（2）查看该模块的帮助信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible-doc ping # 查看 ping 模块的帮助信息\n\u003c/code\u003e\u003c/pre\u003e\u003cblockquote\u003e\n\u003cp\u003e以下实验均是在 IP 地址为： 192.168.91.128 的虚拟机上操作的。\n/etc/ansible/hosts 文件中配置如下：\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# This is the default ansible 'hosts' file.\n#\n# It should live in /etc/ansible/hosts\n#\n#   - Comments begin with the '#' character\n#   - Blank lines are ignored\n#   - Groups of hosts are delimited by [header] elements\n#   - You can enter hostnames or ip addresses\n#   - A hostname/ip can be a member of multiple groups\n\n# Ex 1: Ungrouped hosts, specify before any group headers.\n\n## green.example.com\n## blue.example.com\n## 192.168.100.1\n## 192.168.100.10\n[Client]\n192.168.91.130\n\n# Ex 2: A collection of hosts belonging to the 'webservers' group\n\n## [webservers]\n## alpha.example.org\n## beta.example.org\n## 192.168.1.100\n## 192.168.1.110\n\n# If you have multiple hosts following a pattern you can specify\n# them like this:\n\n## www[001:006].example.com\n\n# Ex 3: A collection of database servers in the 'dbservers' group\n\n## [dbservers]\n##\n## db01.intranet.mydomain.net\n## db02.intranet.mydomain.net\n## 10.25.1.56\n## 10.25.1.57\n\n# Here's another example of host ranges, this time there are no\n# leading 0s:\n\n## db-[99:101]-node.example.com\n\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"常用模块示例\"\u003e常用模块示例\u003c/h3\u003e\n\u003ch4 id=\"ping-模块\"\u003eping 模块\u003c/h4\u003e\n\u003cp\u003e检查指定节点机器能否连通，如果主机在线，则回复pong。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m ping\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: false,\n    \u0026quot;ping\u0026quot;: \u0026quot;pong\u0026quot;\n}\n[root@xdhuxc ~]#\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"远程命令模块commandscriptshell\"\u003e远程命令模块（command、script、shell）\u003c/h5\u003e\n\u003cp\u003ecommand 作为 ansible 的默认模块，可以运行远程权限范围所有的 shell 命令，不支持管道符。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m command -a \u0026quot;free -h\u0026quot; # 查看 Client 分组主机内存使用情况。\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e执行结果为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m command -a \u0026quot;free -h\u0026quot;\n192.168.91.130 | SUCCESS | rc=0 \u0026gt;\u0026gt;\n              total        used        free      shared  buff/cache   available\nMem:           976M        153M        599M        6.7M        223M        638M\nSwap:          2.0G          0B        2.0G\n\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003escript 的功能是在远程主机执行主控端存储的 shell 脚本文件，相当于 scp + shell 组合。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m script -a \u0026quot;/root/xdhuxc.sh string buffer\u0026quot;   # 远程执行本地脚本。\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003exdhuxc.sh 脚本的内容为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# pwd\n/root\n[root@xdhuxc ~]# ls\nxdhuxc.sh\n[root@xdhuxc ~]# cat xdhuxc.sh\n#!/usr/bin/env bash\necho \u0026quot;Hello Shell.\u0026quot;\necho $1\necho $2 \u0026gt;\u0026gt; /root/abc.sh\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e执行结果为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m script -a \u0026quot;/root/xdhuxc.sh string buffer\u0026quot;\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;rc\u0026quot;: 0,\n    \u0026quot;stderr\u0026quot;: \u0026quot;Shared connection to 192.168.91.130 closed.\\r\\n\u0026quot;,\n    \u0026quot;stdout\u0026quot;: \u0026quot;Hello Shell.\\r\\nstring\\r\\n\u0026quot;,\n    \u0026quot;stdout_lines\u0026quot;: [\n        \u0026quot;Hello Shell.\u0026quot;,\n        \u0026quot;string\u0026quot;\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在 192.168.91.130上，在 root 目录下，会产生 abc.sh 文件。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# pwd\n/root\n[root@xdhuxc ~]# ls\nabc.sh  anaconda-ks.cfg  ~None\n[root@xdhuxc ~]# cat abc.sh\nbuffer\n[root@xdhuxc ~]#\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e~None 目录下\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~None]# pwd\n/root/~None\n[root@xdhuxc ~None]# tree -a\n.\n└── .ansible\n    └── tmp\n\n2 directories, 0 files\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eshell 的功能是执行远程主机上的 shell 脚本文件，支持管道符。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m shell -a \u0026quot;/root/xdhuxc.sh\u0026quot; # 执行远程机器上的脚本。\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在 root 目录下创建 xdhuxc.sh 文件，\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# pwd\n/root\n[root@xdhuxc ~]# ll\ntotal 12\n-rw-r--r--  1 root root    7 Jun 11 22:19 abc.sh\n-rw-------. 1 root root 1424 Apr  9 21:56 anaconda-ks.cfg\ndrwx------  3 root root   22 Jun 10 11:55 ~None\n-rw-r--r--  1 root root   43 Jun 11 22:34 xdhuxc.sh   # xdhuxc.sh 没有执行权限。\n[root@xdhuxc ~]# cat xdhuxc.sh\n#!/usr/bin/env bash\necho -n \u0026quot;Hello World!\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在 xdhuxc.sh 没有被赋予执行权限时，执行 ansible 命令。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m shell -a \u0026quot;/root/xdhuxc.sh\u0026quot;\n192.168.91.130 | FAILED | rc=126 \u0026gt;\u0026gt;\n/bin/sh: /root/xdhuxc.sh: Permission deniednon-zero return code\n\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e很明显，xdhuxc.sh 没有可执行权限导致的，修改该命令，重新执行，命令执行成功。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m shell -a \u0026quot;chmod +x /root/xdhuxc.sh ; /root/xdhuxc.sh\u0026quot;\n [WARNING]: Consider using the file module with mode rather than running chmod.  If you need to use command because\nfile is insufficient you can add warn=False to this command task or set command_warnings=False in ansible.cfg to\nget rid of this message.\n\n192.168.91.130 | SUCCESS | rc=0 \u0026gt;\u0026gt;\nHello World!\n\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"copy-模块\"\u003ecopy 模块\u003c/h5\u003e\n\u003cp\u003ecopy 模块用于实现主控端向目标机器复制文件，类似于 scp 功能。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m copy -a \u0026quot;src=/root/xdhuxc.sh dest=/tmp/ owner=root group=root mode=0755\u0026quot; # 向 Client 组中主机复制 xdhuxc.sh 到 /tmp 目录下，文件属主、属组都为 root，权限为：0755\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e执行结果如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# pwd\n/root\n[root@xdhuxc ~]# ls\nxdhuxc.sh\n[root@xdhuxc ~]# ansible Client -m copy -a \u0026quot;src=/root/xdhuxc.sh dest=/tmp/ owner=root group=root mode=0755\u0026quot;\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;checksum\u0026quot;: \u0026quot;406eb4b32e5fe321308cfd40365f765685d64d58\u0026quot;,\n    \u0026quot;dest\u0026quot;: \u0026quot;/tmp/xdhuxc.sh\u0026quot;,\n    \u0026quot;gid\u0026quot;: 0,\n    \u0026quot;group\u0026quot;: \u0026quot;root\u0026quot;,\n    \u0026quot;md5sum\u0026quot;: \u0026quot;1abf4cb799e8858ab96bb7035837f248\u0026quot;,\n    \u0026quot;mode\u0026quot;: \u0026quot;0755\u0026quot;,\n    \u0026quot;owner\u0026quot;: \u0026quot;root\u0026quot;,\n    \u0026quot;size\u0026quot;: 72,\n    \u0026quot;src\u0026quot;: \u0026quot;~None/.ansible/tmp/ansible-tmp-1528728245.0-152168028566440/source\u0026quot;,\n    \u0026quot;state\u0026quot;: \u0026quot;file\u0026quot;,\n    \u0026quot;uid\u0026quot;: 0\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在 192.168.91.130 机器上\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~None]# pwd\n/root/~None\n[root@xdhuxc ~None]# tree -a\n.\n└── .ansible\n    └── tmp\n        └── ansible-tmp-1528728229.03-131422320501562\n\n3 directories, 0 files\n[root@xdhuxc ~None]# ls /tmp\nxdhuxc.sh\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"stat-模块\"\u003estat 模块\u003c/h5\u003e\n\u003cp\u003estat 模块用于获取远程文件状态信息，atime/ctime/mtime/md5/uid/gid等信息。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m stat -a \u0026quot;path=/etc/sysctl.conf\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e执行结果如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m stat -a \u0026quot;path=/etc/resolv.conf\u0026quot;\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: false,\n    \u0026quot;stat\u0026quot;: {\n        \u0026quot;atime\u0026quot;: 1528725838.9349997,\n        \u0026quot;attr_flags\u0026quot;: \u0026quot;\u0026quot;,\n        \u0026quot;attributes\u0026quot;: [],\n        \u0026quot;block_size\u0026quot;: 4096,\n        \u0026quot;blocks\u0026quot;: 8,\n        \u0026quot;charset\u0026quot;: \u0026quot;us-ascii\u0026quot;,\n        \u0026quot;checksum\u0026quot;: \u0026quot;dfebfbbbb5ea787130ffb53eaab925c743f50a56\u0026quot;,\n        \u0026quot;ctime\u0026quot;: 1528725836.281,\n        \u0026quot;dev\u0026quot;: 64768,\n        \u0026quot;device_type\u0026quot;: 0,\n        \u0026quot;executable\u0026quot;: false,\n        \u0026quot;exists\u0026quot;: true,\n        \u0026quot;gid\u0026quot;: 0,\n        \u0026quot;gr_name\u0026quot;: \u0026quot;root\u0026quot;,\n        \u0026quot;inode\u0026quot;: 17073255,\n        \u0026quot;isblk\u0026quot;: false,\n        \u0026quot;ischr\u0026quot;: false,\n        \u0026quot;isdir\u0026quot;: false,\n        \u0026quot;isfifo\u0026quot;: false,\n        \u0026quot;isgid\u0026quot;: false,\n        \u0026quot;islnk\u0026quot;: false,\n        \u0026quot;isreg\u0026quot;: true,\n        \u0026quot;issock\u0026quot;: false,\n        \u0026quot;isuid\u0026quot;: false,\n        \u0026quot;mimetype\u0026quot;: \u0026quot;text/plain\u0026quot;,\n        \u0026quot;mode\u0026quot;: \u0026quot;0644\u0026quot;,\n        \u0026quot;mtime\u0026quot;: 1528725836.281,\n        \u0026quot;nlink\u0026quot;: 1,\n        \u0026quot;path\u0026quot;: \u0026quot;/etc/resolv.conf\u0026quot;,\n        \u0026quot;pw_name\u0026quot;: \u0026quot;root\u0026quot;,\n        \u0026quot;readable\u0026quot;: true,\n        \u0026quot;rgrp\u0026quot;: true,\n        \u0026quot;roth\u0026quot;: true,\n        \u0026quot;rusr\u0026quot;: true,\n        \u0026quot;size\u0026quot;: 73,\n        \u0026quot;uid\u0026quot;: 0,\n        \u0026quot;version\u0026quot;: \u0026quot;1617439728\u0026quot;,\n        \u0026quot;wgrp\u0026quot;: false,\n        \u0026quot;woth\u0026quot;: false,\n        \u0026quot;writeable\u0026quot;: true,\n        \u0026quot;wusr\u0026quot;: true,\n        \u0026quot;xgrp\u0026quot;: false,\n        \u0026quot;xoth\u0026quot;: false,\n        \u0026quot;xusr\u0026quot;: false\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e显示了 /etc/sysctl.conf 文件的所有状态信息。\u003c/p\u003e\n\u003ch5 id=\"get_url-模块\"\u003eget_url 模块\u003c/h5\u003e\n\u003cp\u003eget_url 模块可以实现从远程主机下载指定 URL 到本地，支持 sha256sum 文件教验。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m get_url -a \u0026quot;url=http://www.baidu.com dest=/tmp/index.html mode=0440 force=yes\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e执行命令的结果为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m get_url -a \u0026quot;url=http://www.baidu.com dest=/tmp/index.html mode=0440 force=yes\u0026quot;\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;checksum_dest\u0026quot;: \u0026quot;69676fdd06a44063439b46a7df1e326eeae98ed4\u0026quot;,\n    \u0026quot;checksum_src\u0026quot;: \u0026quot;063ec2b31e5fa4d889076b948994ed4934d8ad62\u0026quot;,\n    \u0026quot;dest\u0026quot;: \u0026quot;/tmp/index.html\u0026quot;,\n    \u0026quot;gid\u0026quot;: 0,\n    \u0026quot;group\u0026quot;: \u0026quot;root\u0026quot;,\n    \u0026quot;md5sum\u0026quot;: \u0026quot;b4715e7fb51d60a983e29f3dc6d7a51a\u0026quot;,\n    \u0026quot;mode\u0026quot;: \u0026quot;0440\u0026quot;,\n    \u0026quot;msg\u0026quot;: \u0026quot;OK (unknown bytes)\u0026quot;,\n    \u0026quot;owner\u0026quot;: \u0026quot;root\u0026quot;,\n    \u0026quot;size\u0026quot;: 117044,\n    \u0026quot;src\u0026quot;: \u0026quot;/tmp/tmpXgrOKe\u0026quot;,\n    \u0026quot;state\u0026quot;: \u0026quot;file\u0026quot;,\n    \u0026quot;status_code\u0026quot;: 200,\n    \u0026quot;uid\u0026quot;: 0,\n    \u0026quot;url\u0026quot;: \u0026quot;http://www.baidu.com\u0026quot;\n}\n[root@xdhuxc ~]# ansible Client -m command -a \u0026quot;ls /tmp\u0026quot;\n192.168.91.130 | SUCCESS | rc=0 \u0026gt;\u0026gt;\nansible_EsBCHn\nindex.html                              # 下载下来的文件\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"yum-模块\"\u003eyum 模块\u003c/h5\u003e\n\u003cp\u003eyum 模块用于实现软件包管理。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m yum -a \u0026quot;name=curl state=latest\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e命令执行的结果为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m yum -a \u0026quot;name=curl state=latest\u0026quot;\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;msg\u0026quot;: \u0026quot;Repository base is listed more than once in the configuration\\nRepository updates is listed more than once in the configuration\\nRepository extras is listed more than once in the configuration\\nRepository centosplus is listed more than once in the configuration\\nRepository base is listed more than once in the configuration\\nRepository updates is listed more than once in the configuration\\nRepository extras is listed more than once in the configuration\\nRepository centosplus is listed more than once in the configuration\\nRepository base is listed more than once in the configuration\\nRepository updates is listed more than once in the configuration\\nRepository extras is listed more than once in the configuration\\nRepository centosplus is listed more than once in the configuration\\nRepository base is listed more than once in the configuration\\nRepository updates is listed more than once in the configuration\\nRepository extras is listed more than once in the configuration\\nRepository centosplus is listed more than once in the configuration\\nRepository epel is listed more than once in the configuration\\nRepository epel-debuginfo is listed more than once in the configuration\\nRepository epel-source is listed more than once in the configuration\\nhttps://mirrors.aliyun.com/centos/7.4.1708/virt/x86_64/kubernetes19/repodata/repomd.xml: [Errno 14] HTTPS Error 404 - Not Found\\nTrying other mirror.\\nTo address this issue please refer to the below knowledge base article \\n\\nhttps://access.redhat.com/articles/1320623\\n\\nIf above article doesn't help to resolve this issue please create a bug on https://bugs.centos.org/\\n\\n\u0026quot;,\n    \u0026quot;rc\u0026quot;: 0,\n    \u0026quot;results\u0026quot;: [\n        \u0026quot;Loaded plugins: fastestmirror\\nLoading mirror speeds from cached hostfile\\n * epel: mirrors.aliyun.com\\nResolving Dependencies\\n--\u0026gt; Running transaction check\\n---\u0026gt; Package curl.x86_64 0:7.29.0-42.el7 will be updated\\n---\u0026gt; Package curl.x86_64 0:7.29.0-46.el7 will be an update\\n--\u0026gt; Processing Dependency: libcurl = 7.29.0-46.el7 for package: curl-7.29.0-46.el7.x86_64\\n--\u0026gt; Running transaction check\\n---\u0026gt; Package libcurl.x86_64 0:7.29.0-42.el7 will be updated\\n---\u0026gt; Package libcurl.x86_64 0:7.29.0-46.el7 will be an update\\n--\u0026gt; Finished Dependency Resolution\\n\\nDependencies Resolved\\n\\n================================================================================\\n Package          Arch            Version                   Repository     Size\\n================================================================================\\nUpdating:\\n curl             x86_64          7.29.0-46.el7             base          268 k\\nUpdating for dependencies:\\n libcurl          x86_64          7.29.0-46.el7             base          220 k\\n\\nTransaction Summary\\n================================================================================\\nUpgrade  1 Package (+1 Dependent package)\\n\\nTotal download size: 488 k\\nDownloading packages:\\nDelta RPMs disabled because /usr/bin/applydeltarpm not installed.\\n--------------------------------------------------------------------------------\\nTotal                                              960 kB/s | 488 kB  00:00     \\nRunning transaction check\\nRunning transaction test\\nTransaction test succeeded\\nRunning transaction\\n  Updating   : libcurl-7.29.0-46.el7.x86_64                                 1/4 \\n  Updating   : curl-7.29.0-46.el7.x86_64                                    2/4 \\n  Cleanup    : curl-7.29.0-42.el7.x86_64                                    3/4 \\n  Cleanup    : libcurl-7.29.0-42.el7.x86_64                                 4/4 \\n  Verifying  : curl-7.29.0-46.el7.x86_64                                    1/4 \\n  Verifying  : libcurl-7.29.0-46.el7.x86_64                                 2/4 \\n  Verifying  : libcurl-7.29.0-42.el7.x86_64                                 3/4 \\n  Verifying  : curl-7.29.0-42.el7.x86_64                                    4/4 \\n\\nUpdated:\\n  curl.x86_64 0:7.29.0-46.el7                                                   \\n\\nDependency Updated:\\n  libcurl.x86_64 0:7.29.0-46.el7                                                \\n\\nComplete!\\n\u0026quot;\n    ]\n}\n[root@xdhuxc ~]# ansible Client -m yum -a \u0026quot;name=curl state=latest\u0026quot;\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: false,\n    \u0026quot;msg\u0026quot;: \u0026quot;\u0026quot;,\n    \u0026quot;rc\u0026quot;: 0,\n    \u0026quot;results\u0026quot;: [\n        \u0026quot;All packages providing curl are up to date\u0026quot;,\n        \u0026quot;\u0026quot;\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e从 msg 和 results 输出的信息可以看到，这就是一个 yum 安装软件包的过程。\u003c/p\u003e\n\u003ch5 id=\"cron-模块\"\u003ecron 模块\u003c/h5\u003e\n\u003cp\u003ecron 模块用于配置远程主机 crontab\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m cron -a \u0026quot;name='check' minute='1' job='ntpdate asia.pool.ntp.org'\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e运行效果：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ansible Client -m cron -a \u0026quot;name='check' minute='1' job='ntpdate asia.pool.ntp.org'\u0026quot;\n192.168.91.130 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;envs\u0026quot;: [],\n    \u0026quot;jobs\u0026quot;: [\n        \u0026quot;check\u0026quot;\n    ]\n}\n[root@xdhuxc ~]# ansible Client -m command -a \u0026quot;crontab -l\u0026quot;\n192.168.91.130 | SUCCESS | rc=0 \u0026gt;\u0026gt;\n#Ansible: check\n1 * * * * ntpdate asia.pool.ntp.org\n\n[root@xdhuxc ~]#\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"service-模块\"\u003eservice 模块\u003c/h5\u003e\n\u003cp\u003eservice 模块可以用来管理远程主机的系统服务。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m service -a \u0026quot;name=haproxy state=stopped\u0026quot;\nansible Client -m service -a \u0026quot;name=haproxy state=restarted\u0026quot;\nansible Client -m service -a \u0026quot;name=haproxy state=reloaded\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e命令执行的结果为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# systemctl status haproxy\n● haproxy.service - HAProxy Load Balancer\n   Loaded: loaded (/usr/lib/systemd/system/haproxy.service; disabled; vendor preset: disabled)\n   Active: active (running) since Mon 2018-06-11 23:17:21 CST; 2s ago\n Main PID: 2135 (haproxy-systemd)\n   Memory: 1.9M\n   CGroup: /system.slice/haproxy.service\n           ├─2135 /usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid\n           ├─2136 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\n           └─2137 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\n\nJun 11 23:17:21 xdhuxc systemd[1]: Started HAProxy Load Balancer.\nJun 11 23:17:21 xdhuxc systemd[1]: Starting HAProxy Load Balancer...\nJun 11 23:17:21 xdhuxc haproxy-systemd-wrapper[2135]: haproxy-systemd-wrapper: executing /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\n[root@xdhuxc ~]# ansible Client -m service -a \u0026quot;name=haproxy state=stopped\u0026quot;\n192.168.91.128 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;name\u0026quot;: \u0026quot;haproxy\u0026quot;,\n    \u0026quot;state\u0026quot;: \u0026quot;stopped\u0026quot;,\n    \u0026quot;status\u0026quot;: {\n        \u0026quot;ActiveEnterTimestamp\u0026quot;: \u0026quot;Mon 2018-06-11 23:17:21 CST\u0026quot;,\n        \u0026quot;ActiveEnterTimestampMonotonic\u0026quot;: \u0026quot;4444399885\u0026quot;,\n        \u0026quot;ActiveExitTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ActiveState\u0026quot;: \u0026quot;active\u0026quot;,\n        \u0026quot;After\u0026quot;: \u0026quot;basic.target system.slice network.target systemd-journald.socket syslog.target\u0026quot;,\n        \u0026quot;AllowIsolate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;AmbientCapabilities\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;AssertResult\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;AssertTimestamp\u0026quot;: \u0026quot;Mon 2018-06-11 23:17:21 CST\u0026quot;,\n        \u0026quot;AssertTimestampMonotonic\u0026quot;: \u0026quot;4444398724\u0026quot;,\n        \u0026quot;Before\u0026quot;: \u0026quot;shutdown.target\u0026quot;,\n        \u0026quot;BlockIOAccounting\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;BlockIOWeight\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;CPUAccounting\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;CPUQuotaPerSecUSec\u0026quot;: \u0026quot;infinity\u0026quot;,\n        \u0026quot;CPUSchedulingPolicy\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;CPUSchedulingPriority\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;CPUSchedulingResetOnFork\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;CPUShares\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;CanIsolate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;CanReload\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;CanStart\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;CanStop\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;CapabilityBoundingSet\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;ConditionResult\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;ConditionTimestamp\u0026quot;: \u0026quot;Mon 2018-06-11 23:17:21 CST\u0026quot;,\n        \u0026quot;ConditionTimestampMonotonic\u0026quot;: \u0026quot;4444398724\u0026quot;,\n        \u0026quot;Conflicts\u0026quot;: \u0026quot;shutdown.target\u0026quot;,\n        \u0026quot;ControlGroup\u0026quot;: \u0026quot;/system.slice/haproxy.service\u0026quot;,\n        \u0026quot;ControlPID\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;DefaultDependencies\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;Delegate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;Description\u0026quot;: \u0026quot;HAProxy Load Balancer\u0026quot;,\n        \u0026quot;DevicePolicy\u0026quot;: \u0026quot;auto\u0026quot;,\n        \u0026quot;EnvironmentFile\u0026quot;: \u0026quot;/etc/sysconfig/haproxy (ignore_errors=no)\u0026quot;,\n        \u0026quot;ExecMainCode\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ExecMainExitTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ExecMainPID\u0026quot;: \u0026quot;2135\u0026quot;,\n        \u0026quot;ExecMainStartTimestamp\u0026quot;: \u0026quot;Mon 2018-06-11 23:17:21 CST\u0026quot;,\n        \u0026quot;ExecMainStartTimestampMonotonic\u0026quot;: \u0026quot;4444399843\u0026quot;,\n        \u0026quot;ExecMainStatus\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ExecReload\u0026quot;: \u0026quot;{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\u0026quot;,\n        \u0026quot;ExecStart\u0026quot;: \u0026quot;{ path=/usr/sbin/haproxy-systemd-wrapper ; argv[]=/usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid $OPTIONS ; ignore_errors=no ; start_time=[Mon 2018-06-11 23:17:21 CST] ; stop_time=[n/a] ; pid=2135 ; code=(null) ; status=0/0 }\u0026quot;,\n        \u0026quot;FailureAction\u0026quot;: \u0026quot;none\u0026quot;,\n        \u0026quot;FileDescriptorStoreMax\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;FragmentPath\u0026quot;: \u0026quot;/usr/lib/systemd/system/haproxy.service\u0026quot;,\n        \u0026quot;GuessMainPID\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;IOScheduling\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;Id\u0026quot;: \u0026quot;haproxy.service\u0026quot;,\n        \u0026quot;IgnoreOnIsolate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;IgnoreOnSnapshot\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;IgnoreSIGPIPE\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;InactiveEnterTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;InactiveExitTimestamp\u0026quot;: \u0026quot;Mon 2018-06-11 23:17:21 CST\u0026quot;,\n        \u0026quot;InactiveExitTimestampMonotonic\u0026quot;: \u0026quot;4444399885\u0026quot;,\n        \u0026quot;JobTimeoutAction\u0026quot;: \u0026quot;none\u0026quot;,\n        \u0026quot;JobTimeoutUSec\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;KillMode\u0026quot;: \u0026quot;mixed\u0026quot;,\n        \u0026quot;KillSignal\u0026quot;: \u0026quot;15\u0026quot;,\n        \u0026quot;LimitAS\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitCORE\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitCPU\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitDATA\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitFSIZE\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitLOCKS\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitMEMLOCK\u0026quot;: \u0026quot;65536\u0026quot;,\n        \u0026quot;LimitMSGQUEUE\u0026quot;: \u0026quot;819200\u0026quot;,\n        \u0026quot;LimitNICE\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;LimitNOFILE\u0026quot;: \u0026quot;4096\u0026quot;,\n        \u0026quot;LimitNPROC\u0026quot;: \u0026quot;3818\u0026quot;,\n        \u0026quot;LimitRSS\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitRTPRIO\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;LimitRTTIME\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitSIGPENDING\u0026quot;: \u0026quot;3818\u0026quot;,\n        \u0026quot;LimitSTACK\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LoadState\u0026quot;: \u0026quot;loaded\u0026quot;,\n        \u0026quot;MainPID\u0026quot;: \u0026quot;2135\u0026quot;,\n        \u0026quot;MemoryAccounting\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;MemoryCurrent\u0026quot;: \u0026quot;2060288\u0026quot;,\n        \u0026quot;MemoryLimit\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;MountFlags\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;Names\u0026quot;: \u0026quot;haproxy.service\u0026quot;,\n        \u0026quot;NeedDaemonReload\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;Nice\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;NoNewPrivileges\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;NonBlocking\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;NotifyAccess\u0026quot;: \u0026quot;none\u0026quot;,\n        \u0026quot;OOMScoreAdjust\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;OnFailureJobMode\u0026quot;: \u0026quot;replace\u0026quot;,\n        \u0026quot;PermissionsStartOnly\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;PrivateDevices\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;PrivateNetwork\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;PrivateTmp\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;ProtectHome\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;ProtectSystem\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RefuseManualStart\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RefuseManualStop\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RemainAfterExit\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;Requires\u0026quot;: \u0026quot;basic.target\u0026quot;,\n        \u0026quot;Restart\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RestartUSec\u0026quot;: \u0026quot;100ms\u0026quot;,\n        \u0026quot;Result\u0026quot;: \u0026quot;success\u0026quot;,\n        \u0026quot;RootDirectoryStartOnly\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RuntimeDirectoryMode\u0026quot;: \u0026quot;0755\u0026quot;,\n        \u0026quot;SameProcessGroup\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;SecureBits\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;SendSIGHUP\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;SendSIGKILL\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;Slice\u0026quot;: \u0026quot;system.slice\u0026quot;,\n        \u0026quot;StandardError\u0026quot;: \u0026quot;inherit\u0026quot;,\n        \u0026quot;StandardInput\u0026quot;: \u0026quot;null\u0026quot;,\n        \u0026quot;StandardOutput\u0026quot;: \u0026quot;journal\u0026quot;,\n        \u0026quot;StartLimitAction\u0026quot;: \u0026quot;none\u0026quot;,\n        \u0026quot;StartLimitBurst\u0026quot;: \u0026quot;5\u0026quot;,\n        \u0026quot;StartLimitInterval\u0026quot;: \u0026quot;10000000\u0026quot;,\n        \u0026quot;StartupBlockIOWeight\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;StartupCPUShares\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;StatusErrno\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;StopWhenUnneeded\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;SubState\u0026quot;: \u0026quot;running\u0026quot;,\n        \u0026quot;SyslogLevelPrefix\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;SyslogPriority\u0026quot;: \u0026quot;30\u0026quot;,\n        \u0026quot;SystemCallErrorNumber\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;TTYReset\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;TTYVHangup\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;TTYVTDisallocate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;TasksAccounting\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;TasksCurrent\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;TasksMax\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;TimeoutStartUSec\u0026quot;: \u0026quot;1min 30s\u0026quot;,\n        \u0026quot;TimeoutStopUSec\u0026quot;: \u0026quot;1min 30s\u0026quot;,\n        \u0026quot;TimerSlackNSec\u0026quot;: \u0026quot;50000\u0026quot;,\n        \u0026quot;Transient\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;Type\u0026quot;: \u0026quot;simple\u0026quot;,\n        \u0026quot;UMask\u0026quot;: \u0026quot;0022\u0026quot;,\n        \u0026quot;UnitFilePreset\u0026quot;: \u0026quot;disabled\u0026quot;,\n        \u0026quot;UnitFileState\u0026quot;: \u0026quot;disabled\u0026quot;,\n        \u0026quot;Wants\u0026quot;: \u0026quot;system.slice\u0026quot;,\n        \u0026quot;WatchdogTimestamp\u0026quot;: \u0026quot;Mon 2018-06-11 23:17:21 CST\u0026quot;,\n        \u0026quot;WatchdogTimestampMonotonic\u0026quot;: \u0026quot;4444399872\u0026quot;,\n        \u0026quot;WatchdogUSec\u0026quot;: \u0026quot;0\u0026quot;\n    }\n}\n[root@xdhuxc ~]# systemctl status haproxy\n● haproxy.service - HAProxy Load Balancer\n   Loaded: loaded (/usr/lib/systemd/system/haproxy.service; disabled; vendor preset: disabled)\n   Active: inactive (dead)\n\nJun 11 23:17:21 xdhuxc systemd[1]: Started HAProxy Load Balancer.\nJun 11 23:17:21 xdhuxc systemd[1]: Starting HAProxy Load Balancer...\nJun 11 23:17:21 xdhuxc haproxy-systemd-wrapper[2135]: haproxy-systemd-wrapper: executing /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\nJun 11 23:17:51 xdhuxc systemd[1]: Stopping HAProxy Load Balancer...\nJun 11 23:17:51 xdhuxc haproxy-systemd-wrapper[2135]: haproxy-systemd-wrapper: SIGTERM -\u0026gt; 2137.\nJun 11 23:17:51 xdhuxc systemd[1]: Stopped HAProxy Load Balancer.\nJun 11 23:17:51 xdhuxc haproxy-systemd-wrapper[2135]: haproxy-systemd-wrapper: exit, haproxy RC=0\n[root@xdhuxc ~]# ansible Client -m service -a \u0026quot;name=haproxy state=restarted\u0026quot;\n192.168.91.128 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;name\u0026quot;: \u0026quot;haproxy\u0026quot;,\n    \u0026quot;state\u0026quot;: \u0026quot;started\u0026quot;,\n    \u0026quot;status\u0026quot;: {\n        \u0026quot;ActiveEnterTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ActiveExitTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ActiveState\u0026quot;: \u0026quot;inactive\u0026quot;,\n        \u0026quot;After\u0026quot;: \u0026quot;network.target syslog.target systemd-journald.socket basic.target system.slice\u0026quot;,\n        \u0026quot;AllowIsolate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;AmbientCapabilities\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;AssertResult\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;AssertTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;Before\u0026quot;: \u0026quot;shutdown.target\u0026quot;,\n        \u0026quot;BlockIOAccounting\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;BlockIOWeight\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;CPUAccounting\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;CPUQuotaPerSecUSec\u0026quot;: \u0026quot;infinity\u0026quot;,\n        \u0026quot;CPUSchedulingPolicy\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;CPUSchedulingPriority\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;CPUSchedulingResetOnFork\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;CPUShares\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;CanIsolate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;CanReload\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;CanStart\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;CanStop\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;CapabilityBoundingSet\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;ConditionResult\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;ConditionTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;Conflicts\u0026quot;: \u0026quot;shutdown.target\u0026quot;,\n        \u0026quot;ControlPID\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;DefaultDependencies\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;Delegate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;Description\u0026quot;: \u0026quot;HAProxy Load Balancer\u0026quot;,\n        \u0026quot;DevicePolicy\u0026quot;: \u0026quot;auto\u0026quot;,\n        \u0026quot;EnvironmentFile\u0026quot;: \u0026quot;/etc/sysconfig/haproxy (ignore_errors=no)\u0026quot;,\n        \u0026quot;ExecMainCode\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ExecMainExitTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ExecMainPID\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ExecMainStartTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ExecMainStatus\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;ExecReload\u0026quot;: \u0026quot;{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\u0026quot;,\n        \u0026quot;ExecStart\u0026quot;: \u0026quot;{ path=/usr/sbin/haproxy-systemd-wrapper ; argv[]=/usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid $OPTIONS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\u0026quot;,\n        \u0026quot;FailureAction\u0026quot;: \u0026quot;none\u0026quot;,\n        \u0026quot;FileDescriptorStoreMax\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;FragmentPath\u0026quot;: \u0026quot;/usr/lib/systemd/system/haproxy.service\u0026quot;,\n        \u0026quot;GuessMainPID\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;IOScheduling\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;Id\u0026quot;: \u0026quot;haproxy.service\u0026quot;,\n        \u0026quot;IgnoreOnIsolate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;IgnoreOnSnapshot\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;IgnoreSIGPIPE\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;InactiveEnterTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;InactiveExitTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;JobTimeoutAction\u0026quot;: \u0026quot;none\u0026quot;,\n        \u0026quot;JobTimeoutUSec\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;KillMode\u0026quot;: \u0026quot;mixed\u0026quot;,\n        \u0026quot;KillSignal\u0026quot;: \u0026quot;15\u0026quot;,\n        \u0026quot;LimitAS\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitCORE\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitCPU\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitDATA\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitFSIZE\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitLOCKS\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitMEMLOCK\u0026quot;: \u0026quot;65536\u0026quot;,\n        \u0026quot;LimitMSGQUEUE\u0026quot;: \u0026quot;819200\u0026quot;,\n        \u0026quot;LimitNICE\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;LimitNOFILE\u0026quot;: \u0026quot;4096\u0026quot;,\n        \u0026quot;LimitNPROC\u0026quot;: \u0026quot;3818\u0026quot;,\n        \u0026quot;LimitRSS\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitRTPRIO\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;LimitRTTIME\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LimitSIGPENDING\u0026quot;: \u0026quot;3818\u0026quot;,\n        \u0026quot;LimitSTACK\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;LoadState\u0026quot;: \u0026quot;loaded\u0026quot;,\n        \u0026quot;MainPID\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;MemoryAccounting\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;MemoryCurrent\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;MemoryLimit\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;MountFlags\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;Names\u0026quot;: \u0026quot;haproxy.service\u0026quot;,\n        \u0026quot;NeedDaemonReload\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;Nice\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;NoNewPrivileges\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;NonBlocking\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;NotifyAccess\u0026quot;: \u0026quot;none\u0026quot;,\n        \u0026quot;OOMScoreAdjust\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;OnFailureJobMode\u0026quot;: \u0026quot;replace\u0026quot;,\n        \u0026quot;PermissionsStartOnly\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;PrivateDevices\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;PrivateNetwork\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;PrivateTmp\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;ProtectHome\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;ProtectSystem\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RefuseManualStart\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RefuseManualStop\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RemainAfterExit\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;Requires\u0026quot;: \u0026quot;basic.target\u0026quot;,\n        \u0026quot;Restart\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RestartUSec\u0026quot;: \u0026quot;100ms\u0026quot;,\n        \u0026quot;Result\u0026quot;: \u0026quot;success\u0026quot;,\n        \u0026quot;RootDirectoryStartOnly\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;RuntimeDirectoryMode\u0026quot;: \u0026quot;0755\u0026quot;,\n        \u0026quot;SameProcessGroup\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;SecureBits\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;SendSIGHUP\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;SendSIGKILL\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;Slice\u0026quot;: \u0026quot;system.slice\u0026quot;,\n        \u0026quot;StandardError\u0026quot;: \u0026quot;inherit\u0026quot;,\n        \u0026quot;StandardInput\u0026quot;: \u0026quot;null\u0026quot;,\n        \u0026quot;StandardOutput\u0026quot;: \u0026quot;journal\u0026quot;,\n        \u0026quot;StartLimitAction\u0026quot;: \u0026quot;none\u0026quot;,\n        \u0026quot;StartLimitBurst\u0026quot;: \u0026quot;5\u0026quot;,\n        \u0026quot;StartLimitInterval\u0026quot;: \u0026quot;10000000\u0026quot;,\n        \u0026quot;StartupBlockIOWeight\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;StartupCPUShares\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;StatusErrno\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;StopWhenUnneeded\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;SubState\u0026quot;: \u0026quot;dead\u0026quot;,\n        \u0026quot;SyslogLevelPrefix\u0026quot;: \u0026quot;yes\u0026quot;,\n        \u0026quot;SyslogPriority\u0026quot;: \u0026quot;30\u0026quot;,\n        \u0026quot;SystemCallErrorNumber\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;TTYReset\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;TTYVHangup\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;TTYVTDisallocate\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;TasksAccounting\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;TasksCurrent\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;TasksMax\u0026quot;: \u0026quot;18446744073709551615\u0026quot;,\n        \u0026quot;TimeoutStartUSec\u0026quot;: \u0026quot;1min 30s\u0026quot;,\n        \u0026quot;TimeoutStopUSec\u0026quot;: \u0026quot;1min 30s\u0026quot;,\n        \u0026quot;TimerSlackNSec\u0026quot;: \u0026quot;50000\u0026quot;,\n        \u0026quot;Transient\u0026quot;: \u0026quot;no\u0026quot;,\n        \u0026quot;Type\u0026quot;: \u0026quot;simple\u0026quot;,\n        \u0026quot;UMask\u0026quot;: \u0026quot;0022\u0026quot;,\n        \u0026quot;UnitFilePreset\u0026quot;: \u0026quot;disabled\u0026quot;,\n        \u0026quot;UnitFileState\u0026quot;: \u0026quot;disabled\u0026quot;,\n        \u0026quot;Wants\u0026quot;: \u0026quot;system.slice\u0026quot;,\n        \u0026quot;WatchdogTimestampMonotonic\u0026quot;: \u0026quot;0\u0026quot;,\n        \u0026quot;WatchdogUSec\u0026quot;: \u0026quot;0\u0026quot;\n    }\n}\n[root@xdhuxc ~]# systemctl status haproxy\n● haproxy.service - HAProxy Load Balancer\n   Loaded: loaded (/usr/lib/systemd/system/haproxy.service; disabled; vendor preset: disabled)\n   Active: active (running) since Mon 2018-06-11 23:19:46 CST; 25s ago\n Main PID: 2351 (haproxy-systemd)\n   Memory: 1.9M\n   CGroup: /system.slice/haproxy.service\n           ├─2351 /usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid\n           ├─2354 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\n           └─2355 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\n\nJun 11 23:19:46 xdhuxc systemd[1]: Started HAProxy Load Balancer.\nJun 11 23:19:46 xdhuxc systemd[1]: Starting HAProxy Load Balancer...\nJun 11 23:19:46 xdhuxc haproxy-systemd-wrapper[2351]: haproxy-systemd-wrapper: executing /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"user-模块\"\u003euser 模块\u003c/h5\u003e\n\u003cp\u003euser 模块用来进行远程主机用户的管理。\n例如：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eansible Client -m user -a \u0026quot;name=wang comment='user wang'\u0026quot;     # 创建用户 wang\nansible Client -m user -a \u0026quot;name=wang state=absent remove=yes\u0026quot; # 删除用户 wang\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e执行命令结果如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# cat /etc/passwd | grep wang\n[root@xdhuxc ~]# ansible Client -m user -a \u0026quot;name=wang comment='user wang'\u0026quot;     # 创建用户 wang\n192.168.91.128 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;comment\u0026quot;: \u0026quot;user wang\u0026quot;,\n    \u0026quot;create_home\u0026quot;: true,\n    \u0026quot;group\u0026quot;: 1001,\n    \u0026quot;home\u0026quot;: \u0026quot;/home/wang\u0026quot;,\n    \u0026quot;name\u0026quot;: \u0026quot;wang\u0026quot;,\n    \u0026quot;shell\u0026quot;: \u0026quot;/bin/bash\u0026quot;,\n    \u0026quot;state\u0026quot;: \u0026quot;present\u0026quot;,\n    \u0026quot;system\u0026quot;: false,\n    \u0026quot;uid\u0026quot;: 1001\n}\n[root@xdhuxc ~]# cat /etc/passwd | grep wang\nwang:x:1001:1001:user wang:/home/wang:/bin/bash\n[root@xdhuxc ~]# ansible Client -m user -a \u0026quot;name=wang state=absent remove=yes\u0026quot;  # 删除用户 wang\n192.168.91.128 | SUCCESS =\u0026gt; {\n    \u0026quot;changed\u0026quot;: true,\n    \u0026quot;force\u0026quot;: false,\n    \u0026quot;name\u0026quot;: \u0026quot;wang\u0026quot;,\n    \u0026quot;remove\u0026quot;: true,\n    \u0026quot;state\u0026quot;: \u0026quot;absent\u0026quot;\n}\n[root@xdhuxc ~]# cat /etc/passwd | grep wang\n[root@xdhuxc ~]#\n\u003c/code\u003e\u003c/pre\u003e","date":1525219200,"description":"","fuzzywordcount":3200,"kind":"page","lang":"zh","lastmod":1525219200,"objectID":"8b9f0b116519dd1e4595b9574148624e","publishdate":1525219200,"relpermalink":"/posts/devops/ansible/ansible-common-model/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了 Ansible 常用模块的用法。\u003c/p\u003e","tags":["Ansible","DevOps"],"title":"Ansible 学习之常用模块","url":"https://xdhuxc.github.io/posts/devops/ansible/ansible-common-model/","wordcount":3175},{"categories":"posts","content":"\u003cp\u003e本篇博客记录些在 Python 开发中经常会用到的代码，下次使用时就可以直接愉快地复制粘贴了。\u003c/p\u003e\n\u003ch3 id=\"常用代码\"\u003e常用代码\u003c/h3\u003e\n\u003cp\u003e1、时间戳\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport time\n\ntime.strftime(\u0026#39;%Y-%m-%d %H:%M:%S\u0026#39;, time.localtime(time.time()))\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、pycharm 代码模板（Editor -\u0026gt; Code Style -\u0026gt; File and Code Template）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: utf-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# author: ${USER}\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# date: ${DATE}\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# description:\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、日志\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport logging as log\n\nlog.basicConfig(level=log.INFO,\n                datefmt=\u0026#39;%Y/%m/%d %H:%M:%S\u0026#39;,\n                format=\u0026#39;%(asctime)s - %(filename)s[line:%(lineno)d] - %(levelname)s: %(message)s\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、检查文件变动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport inotify.adapters\nimport os\n\ndef main():\n    i = inotify.adapters.Inotify()\n    dir_name = os.getenv(\u0026#39;DIR_NAME\u0026#39;, \u0026#39;/etc/envoy/\u0026#39;)\n    i.add_watch(dir_name)\n\n    os.chdir(dir_name)\n    # CREATE event for a directory:\n    os.system(\u0026#39;mkdir foo\u0026#39;)\n    # CREATE event for a file:\n    os.system(\u0026#39;echo hello \u0026gt; test.txt\u0026#39;)\n    # MODIFY event for the file:\n    os.system(\u0026#39;echo world \u0026gt;\u0026gt; test.txt\u0026#39;)\n\n    for event in i.event_gen(yield_nones=False):\n        (_, type_names, path, filename) = event\n        if \u0026#39;IN_CREATE\u0026#39; in type_names:\n            print(\u0026#39;the new configuration file is created.\u0026#39;)\n        if \u0026#39;IN_ISDIR\u0026#39; in type_names:\n            print(\u0026#39;the new directory is created.\u0026#39;)\n\nif \u003cspan class=\"gs\"\u003e__name__\u003c/span\u003e == \u0026#39;__main__\u0026#39;:\n    main()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、性能分析\u003c/p\u003e\n\u003cp\u003e1）使用 \u003ccode\u003ecProfile\u003c/code\u003e 进行性能分析\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epython -m cProfile abc.py\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）使用 \u003ccode\u003eline_profile\u003c/code\u003e 进行性能分析\n在待检测的函数上面添加 \u003ccode\u003e@profile\u003c/code\u003e 装饰器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"ni\"\u003e@profile\u003c/span\u003e   # 不用管此处的提示 \u0026#34;unresolved reference \u0026#39;profile\u0026#39;\u0026#34;\ndef func1():\n    sum = 0\n    for i in range(100000):\n        sum += i\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e运行该脚本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekernprof -l -v xdhuxc.py\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://segmentfault.com/a/1190000007518598\"\u003ehttps://segmentfault.com/a/1190000007518598\u003c/a\u003e\u003c/p\u003e","date":1524787200,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1524787200,"objectID":"b3cdb76fd762f98123caa006d2034e33","publishdate":1524787200,"relpermalink":"/posts/programming/python/python-code-example/","section":"posts","summary":"\u003cp\u003e本篇博客记录些在 Python 开发中经常会用到的代码，下次使用时就可以直接愉快地复制粘贴了。\u003c/p\u003e","tags":["Python"],"title":"Python 常用代码示例","url":"https://xdhuxc.github.io/posts/programming/python/python-code-example/","wordcount":338},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 nginx 的常用功能和其配置的详细含义。\u003c/p\u003e\n\u003ch3 id=\"nginx-简介\"\u003enginx 简介\u003c/h3\u003e\n\u003cp\u003enginx 是一个轻量级高性能的 web 服务器，它是为快速响应大量静态文件请求和高效利用系统资源而设计的。与apache使用面向进程或线程的方式处理请求不同，nginx使用异步事件驱动模型在负载下性能更突出。\u003c/p\u003e\n\u003cp\u003enginx 功能丰富，可作为 HTTP 服务器，也可作为反向代理服务器和邮件服务器，支持FastCGI、SSL、Virtual Host、URL Rewrite、Gzip等功能，并且支持很多第三方的模块扩展。\u003c/p\u003e\n\u003cp\u003e虽然nginx能高效地服务静态文件，但也有人认为nginx处理动态内容并不理想。不像apache服务器，nginx没用使用内嵌解释器的方式来处理动态内容。相反，动态内容被丢给cgi，fastcgi或者像apache这样的web服务器，然后把处理结果返回给nginx，nginx在返给浏览器。这种方式就导致部署起来会更复杂一些。出于这些原因，使用和配置nginx可能会晦涩。nginx的配置感觉更复杂或者不直接。\u003c/p\u003e\n\u003ch3 id=\"nginx-常用功能\"\u003enginx 常用功能\u003c/h3\u003e\n\u003cp\u003e1、HTTP 代理，反向代理\u003c/p\u003e\n\u003cp\u003e作为 Web 服务器最常用的功能之一，尤其是反向代理。nginx 在做反向代理时，提供性能稳定、配置灵活的转发功能。 nginx 可以根据不同的正则匹配，采取不同的转发策略，比如图片文件的转发至文件服务器、动态页面的转发至web服务器。并且， nginx 对返回结果进行错误页跳转、异常判断等。如果被分发的服务器存在异常，可以将请求重新转发给另外一台服务器，然后自动去除异常服务器。\u003c/p\u003e\n\u003cp\u003e2、负载均衡\u003c/p\u003e\n\u003cp\u003enginx 提供的负载均衡策略有两种：内置策略和扩展策略。内置策略包括：轮询，加权轮询，IP hash。扩展策略非常多，几乎涵盖所有的负载均衡算法。\u003c/p\u003e\n\u003cp\u003eIP Hash算法：对客户端请求的IP地址进行Hash操作，然后根据Hash结果将同一个客户端IP的请求分发给同一台服务器进行处理，可以解决 session 不共享的问题。\u003c/p\u003e\n\u003cp\u003e3、Web 缓存\u003c/p\u003e\n\u003cp\u003enginx 可以对不同的文件做不同的缓存处理，配置灵活，并且支持FastCGI_Cache，主要用于对 FastCGI的动态程序进行缓存。配合第三方的ngx_cache_purge，对指定的 URL 缓存内容可以进行增删管理。\u003c/p\u003e\n\u003ch3 id=\"nginx-配置文件\"\u003enginx 配置文件\u003c/h3\u003e\n\u003cp\u003enginx 的强大都是靠配置文件来实现，nginx 就是一个二进制文件 nginx 读入一个配置文件 nginx.conf (nginx.conf可能include包含若干子配置文件)来实现各种各样的功能。\u003c/p\u003e\n\u003ch4 id=\"nginx-配置文件结构\"\u003enginx 配置文件结构\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e...                           # 全局块\nevents {                      # events 块\n    ...       \n}\nhttp {                        # http 块\n    ...                       # http 全局块\n    server {                  # server 块\n        ...                   # server 全局块\n        location [PATTERN] {  # location 块  \n            ...\n        }   \n        location [PATTERN] {\n            ...\n        }\n    }\n    server {\n        ...\n    }\n    ...                       # http 块\n}\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e1、全局块\u003c/p\u003e\n\u003cp\u003e配置影响 nginx 全局的指令。一般有运行 nginx 服务器的用户组， nginx 进程 pid 存放路径，日志文件存放路径，配置文件引入，允许生成的 worker process数等。\u003c/p\u003e\n\u003cp\u003e2、events 块\u003c/p\u003e\n\u003cp\u003e配置影响 nginx 服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网络连接，开启多个网络连接序列化等。\u003c/p\u003e\n\u003cp\u003e3、http 块\u003c/p\u003e\n\u003cp\u003e可以嵌套多个 server块，配置代理、缓存、日志定义等绝大多数功能和第三方模块的配置，如文件引入、mime-type定义、日志自定义、是否使用 sendfile 传输文件、连接超时时间、单连接请求数等。\u003c/p\u003e\n\u003cp\u003e4、server 块\u003c/p\u003e\n\u003cp\u003e配置虚拟主机的相关参数，一个 http 块中可以有多个 server 块。\u003c/p\u003e\n\u003cp\u003e5、location 块\u003c/p\u003e\n\u003cp\u003e配置请求的路由，以及各种页面的处理情况。\u003c/p\u003e\n\u003ch4 id=\"nginx-配置文件示例\"\u003enginx 配置文件示例\u003c/h4\u003e\n\u003cp\u003enginx.conf文件示例\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003euser administrator administrator; # 配置用户或者用户组，默认为nobody nobody。\nworker_processes 2;               # 允许生成的进程数，设置值和CPU核心数一致，默认为：1。在nginx1.3.8和1.2.5之后的版本开始支持auto，自动匹配进程数。\npid /var/nginx/nginx.pid # 指定 nginx 进程运行文件存放地址。\nerror_log /var/log/nginx/error.log debug # 指定错误日志存放路径及级别，该设置可以放入全局块、http块、server块，日志级别依次为：debug|info|notice|warn|error|crit|alert|emerg。\nevents {\n    accept_mutex on; # 设置网络连接序列化，防止惊群现象发生，默认为：on。\n    multi_accept on; # 设置一个进程是否同时接受多个网络连接，默认为：off。\n    use epoll;        # 指定事件驱动模型，可以为：select|poll|kqueue|epoll|resig|/dev/poll|eventport。\n    worker_connections 1024; # 设置最大连接数，默认为：512。\n}\nhttp {\n    include mime.types; # 文件扩展名与文件类型映射表。\n    default_type application/octet-stream; # 指定默认文件类型，默认为：text/plain。\n    \u003cspan class=\"ni\"\u003e#access_log\u003c/span\u003e off # 取消服务日志。\n    \n    log_format  main  \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#34;$request\u0026#34; \u0026#39;\n                      \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39;\n                      \u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;;  # 自定义格式\n    access_log /var/log/nginx/access.log main; # combined为日志格式的默认值。\n    sendfile on; # 允许sendfile方式传输文件，默认为：off，可以在http块、server块、location块中定义。\n    sendfile_max_chunk 100K; # 每个进程每次调用传输数量不能大于设定的值，默认值为：0，即不设上限。\n    keepalive_timeout 65;    # 连接超时时间，默认为：75s，可以在http块、server块和location块中设置。\n    \n    upstream xdhuxc {\n        server 127.0.0.1:8080;\n        server 192.168.91.128:9090 backup; # 热备，\n    }\n    \n    error_page 404 https://www.baidu.com # 错误页。\n    \n    server {\n        listen 8080;            # 监听端口。\n        server_name 127.0.0.1;  # 监听地址。\n        keepalive_requests 120; # 单连接请求上限次数。\n        location ~*^.+$ {       # 请求的 url 过滤，正则匹配，~ 为区分大小写，~* 为不区分大小写。\n            # root path;   # 根目录。\n            # index index.html index.htm; # 设置默认页。\n            proxy_pass http://xdhuxc; # 请求转向 xdhuxc 定义的服务器列表。\n            deny 127.0.0.1; # 拒绝的IP。\n            allow 172.18.5.54; 允许的IP。\n        }\n        \n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意：\u003c/p\u003e\n\u003cp\u003e1、log_format中参数的含义\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$remote_addr 和 $http_x_forwarded_for 用以记录客户端的IP地址。\n$remote_user 用来记录客户端用户名称。\n$time_local 用来记录访问时间与时区。\n$request 用来记录请求的url与http协议。\n$status 用来记录请求状态，成功为200。\n$body_bytes_sent 记录发送给客户端文件主体内容大小。\n$http_referer 用来记录从哪个页面链接访问过来的。\n$http_user_agent 用来记录客户端浏览器的相关信息。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、惊群现象：一个网络连接到来，多个睡眠的进程被同时叫醒，但只有一个进程能获得连接，这样会影响系统性能。\u003c/p\u003e\n\u003cp\u003e3、每个指令必须有分号结尾。\u003c/p\u003e\n\u003ch3 id=\"负载均衡和反向代理配置\"\u003e负载均衡和反向代理配置\u003c/h3\u003e\n\u003ch4 id=\"代理服务配置\"\u003e代理服务配置\u003c/h4\u003e\n\u003cp\u003e1、在 http 块中有如下配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eerror_page 404 https://www.baidu.com # 设置错误页，当代理遇到状态码为404时，把错误页面导向百度。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e要想让该语句起作用，必须配合着下面的配置一起使用：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eproxy_intercept_errors on; # 如果被代理服务器返回的状态码为400或者大于400，设置的error_page配置起作用，默认为：off。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、如果我们的代理只允许接受get、post请求方法的一种，可进行如下配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eproxy_method get; # 支持客户端的请求方法，post/get。 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、设置支持的http协议版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eproxy_http_version 1.0; # nginx 服务器提供代理服务的http协议版本1.0、1.1，默认为：1.0版本。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、如果 nginx 服务器给两台 web 服务器做代理，负载均衡算法采用轮询。那么当一台服务器 web 程序不能访问时，nginx服务器分发请求还是会给这台不能访问的 web 服务器。如果这里的响应连接时间过长，就会导致客户端的页面一直在等待，严重影响客户体验。\u003c/p\u003e\n\u003cp\u003e如果负载均衡中，web 服务器乙发生这样的情况，nginx 首先会去 web 服务器甲请求，但是 nginx 在配置不当的情况下会继续分发请求到 web 服务器乙，然后等待 web 服务器乙响应，直到响应时间超时，才会把请求重新分发给 web 服务器甲。这里的响应时间如果过长，用户等待的时间就会越长。\u003c/p\u003e\n\u003cp\u003e以下配置可以作为解决方案：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eproxy_connect_timeout 1; # nginx 服务器与被代理服务器建立连接的超时时间，默认为：60s。\nproxy_read_timeout 1; # nginx 服务器向被代理服务器组发出 read 请求后，等待响应的超时时间，默认为：60s。\nproxy_send_timeout 1; # nginx 服务器向被代理服务器组发出 write 请求后，等待响应的超时时间，默认为：60s。\nproxy_ignore_client_abort on; # 客户端断网时，nginx 服务器是否中断对被代理服务器的请求，默认为：off。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、如果使用 upstream 指令配置了一组服务器作为被代理服务器，服务器中的访问算法遵循配置的负载均衡规则，同时可以使用该指令配置在发生哪些异常情况时，将请求顺次交由下一组服务器处理。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eproxy_next_upstream timeout; # 反向代理 upstream 中设置的服务器组，出现故障时，被代理服务器返回的状态值。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以设置为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eerror | timeout | invalid_header | http_500 | http_502 | http_503 | http_504 | http_404 | off \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eerror：建立连接或向被代理的服务器发送请求或读取响应信息时，服务器发生错误。\u003c/li\u003e\n\u003cli\u003etimeout：建立连接或向被代理服务器发送请求或读取响应信息时，服务器发生超时。\u003c/li\u003e\n\u003cli\u003einvalid_header：被代理服务器返回的响应头异常。\u003c/li\u003e\n\u003cli\u003eoff：无法将请求分发给被代理的服务器。\u003c/li\u003e\n\u003cli\u003ehttp_404,http_500,...：被代理服务器返回的状态码为404，500，502等。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e6、如果想通过 http 获取客户端的真实IP地址，而不是获取代理服务器的IP地址，那么需要做如下配置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eproxy_set_header Host $host; # 只要用户在浏览器中访问的域名绑定了VIP，VIP下面有RS，则就用$host；host 是访问的URL中的域名和端口，比如，www.taobaoc.com:80\nproxy_set_header X-Real-IP $remote_addr; # 把源IP（$remote_add，建立HTTP连接header里面的信息）赋值给X-Real-IP，这样在代码中，$X-Real-IP就可以获得源IP。\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # 在nginx 作为代理服务器时，设置的IP列表，会把经过的机器IP、代理机器IP都记录下来，用\u0026#34;,\u0026#34;隔开，代码中使用 \u003cspan class=\"sb\"\u003e`echo $x-forwarded-for | awk -F, \u0026#39;{print $1}\u0026#39;`\u003c/span\u003e 来作为源IP。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、nginx 代理配置的配置文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003einclude       mime.types;                  # 文件扩展名与文件类型映射表\ndefault_type  application/octet-stream;    # 设置默认文件类型，默认为text/plain\n\u003cspan class=\"gh\"\u003e#access_log off;                           # 取消服务日志    \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003elog_format main \u0026#39; $remote_addr–$remote_user [$time_local] $request $status $body_bytes_sent $http_referer $http_user_agent $http_x_forwarded_for\u0026#39;; \u003cspan class=\"ni\"\u003e#自定义格式\u003c/span\u003e\naccess_log log/access.log main;            # combined 为日志格式的默认值\nsendfile on;                               # 允许sendfile方式传输文件，默认为off，可以在http块，server块，location块。\nsendfile_max_chunk 100k;                   # 每个进程每次调用传输数量不能大于设定的值，默认为0，即不设上限。\nkeepalive_timeout 65;                      # 连接超时时间，默认为75s，可以在http，server，location块。\nproxy_connect_timeout 1;                   # nginx服务器与被代理的服务器建立连接的超时时间，默认60秒\nproxy_read_timeout 1;                      # nginx服务器想被代理服务器组发出read请求后，等待响应的超时间，默认为60秒。\nproxy_send_timeout 1;                      # nginx服务器想被代理服务器组发出write请求后，等待响应的超时间，默认为60秒。\nproxy_http_version 1.0 ;                   # Nginx服务器提供代理服务的http协议版本1.0，1.1，默认设置为1.0版本。\n\u003cspan class=\"gh\"\u003e#proxy_method get;                         # 支持客户端的请求方法。post/get；\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eproxy_ignore_client_abort on;              # 客户端断网时，nginx服务器是否终端对被代理服务器的请求。默认为off。\nproxy_ignore_headers \u0026#34;Expires\u0026#34; \u0026#34;Set-Cookie\u0026#34;;  \u003cspan class=\"ni\"\u003e#Nginx服务器不处理设置的http相应投中的头域\u003c/span\u003e，这里空格隔开可以设置多个。\nproxy_intercept_errors on;                 # 如果被代理服务器返回的状态码为400或者大于400，设置的error_page配置起作用。默认为off。\nproxy_headers_hash_max_size 1024;          # 存放http报文头的哈希表容量上限，默认为512个字符。\nproxy_headers_hash_bucket_size 128;        # nginx服务器申请存放http报文头的哈希表容量大小。默认为64个字符。\nproxy_next_upstream timeout;               # 反向代理upstream中设置的服务器组，出现故障时，被代理服务器返回的状态值。error|timeout|invalid_header|http_500|http_502|http_503|http_504|http_404|off\n\u003cspan class=\"gh\"\u003e#proxy_ssl_session_reuse on;               # 默认为：on，如果我们在错误日志中发现“SSL3_GET_FINSHED:digest check failed”的情况时，可以将该指令设置为off。\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"负载均衡配置\"\u003e负载均衡配置\u003c/h4\u003e\n\u003cp\u003eupstream 配置是写一组被代理的服务器地址，然后配置负载均衡的算法。这里的被代理服务器地址有两种写法：\u003c/p\u003e\n\u003cp\u003e1）、\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eupstream xdhuxc {\n    server 192.168.91.128:8080;\n    server 192.168.91.129:8080;\n}\nserver {\n    ...\n    location ~*^.+$ {\n        proxy_pass http://xdhuxc   # 请求转向 xdhuxc 定义的服务器列表。\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）、\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eupstream xdhuxc {\n    server http://192.168.91.128:8080;\n    server http://192.168.91.129:8080;\n}\nserver {\n    ...\n    location ~*^.+$ {\n        proxy_pass xdhuxc;         # 请求转向 xdhuxc 定义的服务器列表。\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e1、热备\u003c/p\u003e\n\u003cp\u003e如果有两台服务器，当一台服务器发生故障时，才启用第二台服务器给用户提供服务。服务器处理请求的顺序：AAAA（突然A挂了）BBBBBBB...\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eupstream xdhuxc {\n    server 192.168.91.128:8080;\n    server 192.168.91.129:8080 backup; # 热备\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、轮询\u003c/p\u003e\n\u003cp\u003enginx 默认就是轮询，其权重默认都为：1。服务器处理请求的顺序为：ABABABAB...\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eupstream xdhuxc {\n    server 192.168.91.128:8080;\n    server 192.168.91.129:8080;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、加权轮询\u003c/p\u003e\n\u003cp\u003enginx 根据配置的权重的大小而分发给不同服务器不同数量的请求。如果不设置，则默认为：1。服务器处理请求的顺序为：ABBABBABBABBABB...\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eupstream xdhuxc {\n    server 192.168.91.128:8080 weight=1;\n    server 192.168.91.129:8080 weight=2;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、ip_hash\u003c/p\u003e\n\u003cp\u003enginx 会让相同的客户端IP请求相同的服务器。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eupstream xdhuxc {\n    server 192.168.91.128:8080;\n    server 192.168.91.129:8080;\n    ip_hash;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003enginx 负载均衡配置的几个状态参数：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edown：表示当前 server 暂时不参与负载均衡。\u003c/li\u003e\n\u003cli\u003ebackup：预留的备份机器，当其他所有的非 backup 机器出现故障或者忙的时候，才会请求 backup 机器，因此这台机器的压力最轻。\u003c/li\u003e\n\u003cli\u003emax_fails：允许请求失败的次数，默认为：1。当超过最大次数时，返回 proxy_next_upstream 模块定义的错误。\u003c/li\u003e\n\u003cli\u003efail_timeout：在经历了 max_fails 次失败后，暂停服务的时间。max_fails 可以和 fail_timeout 一起使用。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e示例如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eupstream xdhuxc {\n    server 192.168.91.128:8080 weight=2 max_fails=2 fail_timeout=2;\n    server 192.168.91.129:8080 weight=1 max_fails=2 fail_timeout=1;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"nginx-中-location-的写法\"\u003enginx 中 location 的写法\u003c/h3\u003e\n\u003ch4 id=\"location-基础知识\"\u003elocation 基础知识\u003c/h4\u003e\n\u003cp\u003e1、location 是在 server 块中配置的。\u003c/p\u003e\n\u003cp\u003e2、可以根据不同的 URI 使用不同的配置（location 中配置），来处理不同的请求。\u003c/p\u003e\n\u003cp\u003e3、location 是有顺序的，会被第一个匹配的 location 处理。\u003c/p\u003e\n\u003ch4 id=\"location-配置语法\"\u003elocation 配置语法\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elocation [ = | ~ | ~* | ^~ ] uri {...}\n或\nlocation \u003cspan class=\"ni\"\u003e@name\u003c/span\u003e {...}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"location-配置可以有两种配置方法\"\u003elocation 配置可以有两种配置方法\u003c/h4\u003e\n\u003cp\u003e1、前缀 + uri （字符串/正则表达式）\u003c/p\u003e\n\u003cp\u003e2、@ + name\u003c/p\u003e\n\u003ch4 id=\"前缀含义\"\u003e前缀含义\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e=：精确匹配，必须全部相等。\n~：大小写敏感。\n~*：忽略大小写。\n^~：只需匹配 uri 部分。\n@：内部服务跳转。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"location-配置示例\"\u003elocation 配置示例\u003c/h4\u003e\n\u003cp\u003e（1）=，精确匹配\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elocation = / {\n    # 规则\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e匹配到 \u003ca href=\"http://www.xdhuxc.com/\"\u003ehttp://www.xdhuxc.com/\u003c/a\u003e  这种请求。\u003c/p\u003e\n\u003cp\u003e（2）~，大小写敏感\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elocation ~ /getUser/ {\n    # 规则\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ca href=\"http://www.xdhuxc.com/getUser/\"\u003ehttp://www.xdhuxc.com/getUser/\u003c/a\u003e 请求成功\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.xdhuxc.com/GetUser/\"\u003ehttp://www.xdhuxc.com/GetUser/\u003c/a\u003e 请求失败\u003c/p\u003e\n\u003cp\u003e（3）~*，大小写忽略\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elocation ~* /getUser/ {\n    # 规则\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这种写法会忽略 uri 部分的大小写\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.xdhuxc.com/getUser/\"\u003ehttp://www.xdhuxc.com/getUser/\u003c/a\u003e 请求成功\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.xdhuxc.com/GetUser/\"\u003ehttp://www.xdhuxc.com/GetUser/\u003c/a\u003e 请求成功\u003c/p\u003e\n\u003cp\u003e（4）^~，只匹配以 uri 开头\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elocation ^~ /image/ {\n    # 规则\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以 /image/ 开头的请求，都会匹配上\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://xdhuxc.com/image/abc.jpg\"\u003ehttp://xdhuxc.com/image/abc.jpg\u003c/a\u003e 请求成功\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://xdhuxc.com/image/cde.mp4\"\u003ehttp://xdhuxc.com/image/cde.mp4\u003c/a\u003e 请求成功\u003c/p\u003e\n\u003cp\u003e5、@，nginx 内部跳转\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elocation /image/ {\n    error_page 404 \u003cspan class=\"ni\"\u003e@image_error\u003c/span\u003e;\n}\n\nlocation \u003cspan class=\"ni\"\u003e@image_error\u003c/span\u003e {\n    # 规则\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以 /image/ 开头的请求，如果链接的状态为 404，则会匹配到 @image_error 这条规则上。\u003c/p\u003e","date":1524700800,"description":"","fuzzywordcount":5700,"kind":"page","lang":"zh","lastmod":1540771200,"objectID":"3083d607e3f35bbbddbde1d85dd8c0c3","publishdate":1524700800,"relpermalink":"/posts/mixed/nginx/nginx-function-and-configuration/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 nginx 的常用功能和其配置的详细含义。\u003c/p\u003e","tags":["Nginx"],"title":"nginx 常用功能及配置详解","url":"https://xdhuxc.github.io/posts/mixed/nginx/nginx-function-and-configuration/","wordcount":5633},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Kafka 的部署和常用命令。\u003c/p\u003e\n\u003ch3 id=\"部署-kafka\"\u003e部署 kafka\u003c/h3\u003e\n\u003ch4 id=\"原生方式部署-kafka\"\u003e原生方式部署 kafka\u003c/h4\u003e\n\u003cp\u003e1、启动 \u003ccode\u003ezookeeper\u003c/code\u003e 的命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./bin/zookeeper-server-start.sh -daemon ./config/zookeeper.properties\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、\u003ccode\u003ezookeeper.properties\u003c/code\u003e 文件内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edataDir=/xdhuxc/zookeeper/data\n\u003cspan class=\"gh\"\u003e# the port at which the clients will connect\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eclientPort=2181\n\u003cspan class=\"gh\"\u003e# disable the per-ip limit on the number of connections since this is a non-production config\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emaxClientCnxns=50\ntickTime=2000\ninitLimit=10\nsyncLimit=5\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 \u003ccode\u003ekafka\u003c/code\u003e 的命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./bin/kafka-server-start.sh -daemon ./config/server.properties\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在命令行模式下启动生产者\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./bin/kafka-console-producer.sh --broker-list 192.168.91.128:9092 --topic xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在提示符后面输入消息\u003c/p\u003e\n\u003cp\u003e在命令行模式下启动消费者\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./bin/kafka-console-consumer.sh --zookeeper 192.168.91.128:2181 --topic xdhuxc --from-beginning\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看topic是否创建成功\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./bin/kafka-topics.sh --list --zookeeper 192.168.91.128:2181\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"docker-容器部署-kafka\"\u003edocker 容器部署 kafka\u003c/h4\u003e\n\u003cp\u003e使用如下命令启动 kafka 容器：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --restart=always \\\n    --net host \\\n    --name kafka \\\n    -p 9092:9092 \\\n    -e KAFKA_ADVERTISED_HOST_NAME=192.168.91.128 \\\n    -e KAFKA_ADVERTISED_PORT=9092 \\\n    -e KAFKA_MESSAGE_MAX_BYTES=2000000 \\\n    -e KAFKA_ZOOKEEPER_CONNECT=192.168.91.128:2181 \\\n    -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://192.168.91.128:9092 \\\n    -v /xdhuxc/kafka/data:/kafka \\\n    -v /xdhuxc/kafka/logs:/opt/kafka/logs \\\n    wurstmeister/kafka\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"kafka-常用命令\"\u003ekafka 常用命令\u003c/h3\u003e\n\u003cp\u003e1、创建 topic\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebin/kafka-topics.sh --create --zookeeper 192.168.91.128:2181 --replication-factor 1 --partitions 3 --topic locallog\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看 topic\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebin/kafka-topics.sh --list --zookeeper 192.168.91.128:2181\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1523318400,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1523923200,"objectID":"74cb030cd3da6dd04efd5c62b7efee59","publishdate":1523318400,"relpermalink":"/posts/message/kafka/message-queue-kafka-install-and-command/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Kafka 的部署和常用命令。\u003c/p\u003e","tags":["Kafka"],"title":"Kafka 的部署和常用命令","url":"https://xdhuxc.github.io/posts/message/kafka/message-queue-kafka-install-and-command/","wordcount":285},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍了 redis 常用的命令。\u003c/p\u003e\n\u003ch3 id=\"实用命令\"\u003e实用命令\u003c/h3\u003e\n\u003cp\u003e1、获取所有的key\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e172.20.26.77:6379\u0026gt; keys \u003cspan class=\"ge\"\u003e*ceryx*\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、删除当前数据库中的所有Key\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eflushdb\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、删除所有数据库中的 key\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eflushall  \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、批量删除匹配通配符的 key\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis-cli -h 172.20.26.77 keys \u0026#34;s*\u0026#34; | xargs redis-cli -h 172.20.26.77 del  \n或\nredis-cli -h 172.20.17.4 -a Xdhuxc123 keys \u003cspan class=\"ge\"\u003e*menu*\u003c/span\u003e | xargs redis-cli -h 172.20.17.4 -a Xdhuxc123 del\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、设置键值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis-cli set /xdhuxc/redis/1 redis1\n或\nredis-cli set /xdhuxc/redis/1 redis11 # 更新数据\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、连接到主机为： \u003ccode\u003e127.0.0.1\u003c/code\u003e，端口为： \u003ccode\u003e6379\u003c/code\u003e ，密码为：\u003ccode\u003exdhuxc\u003c/code\u003e 的 redis 服务上\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ ./redis-cli -h 127.0.0.1 -p 6379 -a \u0026#34;xdhuxc\u0026#34;\nredis 127.0.0.1:6379\u0026gt;\nredis 127.0.0.1:6379\u0026gt; ping\npong\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"redis-键命令\"\u003eRedis 键命令\u003c/h3\u003e\n\u003cp\u003eRedis 键命令用于管理 Redis 的键。Redis 键命令的基本语法如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis 127.0.0.1:6379\u0026gt; command_name key_name\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eRedis 键的基本命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e编号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003edel key_name\u003c/td\u003e\n\u003ctd\u003e删除一个指定的键，如果该键存在\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003edump key_name\u003c/td\u003e\n\u003ctd\u003e返回存储在指定键的值的序列化版本\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003eexists key_name\u003c/td\u003e\n\u003ctd\u003e检查键是否存在\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003eexpire key_name seconds\u003c/td\u003e\n\u003ctd\u003e设置键在指定时间秒数之后到期/过期\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003eexpire key_name timestamp\u003c/td\u003e\n\u003ctd\u003e设置在指定时间戳之后键到期/过期。这里的时间是Unix时间戳格式\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003epexpire key_name milliseconds\u003c/td\u003e\n\u003ctd\u003e设置键的到期时间，以毫秒为单位\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003epexpire key_name milliseconds-timestamp\u003c/td\u003e\n\u003ctd\u003e以Unix时间戳形式来设置键的到期时间，以毫秒为单位\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003ekeys pattern\u003c/td\u003e\n\u003ctd\u003e查找与指定模式匹配的所有键\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003emove key_name database\u003c/td\u003e\n\u003ctd\u003e将键移动到另一个数据库\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003epersist key_name\u003c/td\u003e\n\u003ctd\u003e删除指定键的过期时间，键将持久保持\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003epttl key_name\u003c/td\u003e\n\u003ctd\u003e获取键的剩余到期时间，以毫秒为单位\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003erandomkey\u003c/td\u003e\n\u003ctd\u003e从Redis返回一个随机的键\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003erename old_key_name new_key_name\u003c/td\u003e\n\u003ctd\u003e更改键的名称。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e14\u003c/td\u003e\n\u003ctd\u003erenamenx key_name new_key_name\u003c/td\u003e\n\u003ctd\u003e当new_key_name不存在时，将key_name改名为new_key_name\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e15\u003c/td\u003e\n\u003ctd\u003etype key_name\u003c/td\u003e\n\u003ctd\u003e返回存储在键中的值的数据类型\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003ettl key_name\u003c/td\u003e\n\u003ctd\u003e返回给定键的剩余生存时间，以秒为单位\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/educast/article/details/37695803\"\u003ehttps://blog.csdn.net/educast/article/details/37695803\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/secretx/article/details/73498148\"\u003ehttps://blog.csdn.net/secretx/article/details/73498148\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/kexiaoling/article/details/51810919\"\u003ehttps://blog.csdn.net/kexiaoling/article/details/51810919\u003c/a\u003e\u003c/p\u003e","date":1523318400,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"233fe4e22b4e8f5816e35e1648d18dfd","publishdate":1523318400,"relpermalink":"/posts/storage/redis/redis-command/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍了 redis 常用的命令。\u003c/p\u003e","tags":["Redis","数据库"],"title":"Redis 常用命令总结","url":"https://xdhuxc.github.io/posts/storage/redis/redis-command/","wordcount":583},{"categories":"posts","content":"\u003cp\u003e本篇博客主要介绍了 redis 的常用数据类型。\u003c/p\u003e\n\u003ch3 id=\"字符串\"\u003e字符串\u003c/h3\u003e\n\u003cp\u003eRedis 中的字符串是一个字节序列，并且字符串是二进制安全的，这意味着它们的长度不由任何特殊的终止字符决定，因此，可以在一个字符串中存储高达 \u003ccode\u003e512MB\u003c/code\u003e 的任何内容。\u003c/p\u003e\n\u003cp\u003eRedis 字符串数据类型的相关命令用于管理 Redis 字符串值。基本语法格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eredis 127.0.0.1:6379\u0026gt; command_name key_name\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e常用的 Redis 字符串命令如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003eset key_name value\u003c/td\u003e\n\u003ctd\u003e设置指定键的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003eget key_name\u003c/td\u003e\n\u003ctd\u003e获取指定键的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003egetrange key_name start end\u003c/td\u003e\n\u003ctd\u003e获取存储在键上的字符串的子字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003egetset key_name value\u003c/td\u003e\n\u003ctd\u003e将给定键的值设置为value，并并返回键的旧值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003egetbit key_name offset\u003c/td\u003e\n\u003ctd\u003e对键所储存的字符串值，获取指定偏移量上的位\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003emget key_name_1, key_name_2, key_name_3,....\u003c/td\u003e\n\u003ctd\u003e获取一个或多个给定键的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003esetbit key offset value\u003c/td\u003e\n\u003ctd\u003e对键所存储的字符串值，设置或清除指定偏移量上的位\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003esetex key_name seconds value\u003c/td\u003e\n\u003ctd\u003e使用键和过期时间来设置值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003esetnx key_name value\u003c/td\u003e\n\u003ctd\u003e当键不存在时，设置键的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003esetrange key_name offset value\u003c/td\u003e\n\u003ctd\u003e从指定偏移量开始，用value覆盖给定键所存储的字符串值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003estrlen key_name\u003c/td\u003e\n\u003ctd\u003e返回键所存储的字符串值的长度\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003emset key value [key value...]\u003c/td\u003e\n\u003ctd\u003e同时设置一个或多个key-value对\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003emsetnx key value [key value...]\u003c/td\u003e\n\u003ctd\u003e同时设置一个或多个key-value对，当且仅当所有给定的键都不存在\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e14\u003c/td\u003e\n\u003ctd\u003epsetex key_name milliseconds value\u003c/td\u003e\n\u003ctd\u003e设置键的值，以毫秒为单位设置过期时间\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e15\u003c/td\u003e\n\u003ctd\u003eincr key_name\u003c/td\u003e\n\u003ctd\u003e将键中存储的整数值加1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003eincrby key_name increment\u003c/td\u003e\n\u003ctd\u003e将键的整数值按给定的数值增加\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e17\u003c/td\u003e\n\u003ctd\u003eincrbyfloat key_name increment\u003c/td\u003e\n\u003ctd\u003e将键的浮点值按给定的数值增加\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e18\u003c/td\u003e\n\u003ctd\u003edecr key_name\u003c/td\u003e\n\u003ctd\u003e将键的整数值减1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e19\u003c/td\u003e\n\u003ctd\u003edecrby key_name decrement\u003c/td\u003e\n\u003ctd\u003e按给定数值减少键的整数值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e20\u003c/td\u003e\n\u003ctd\u003eappend key_name value\u003c/td\u003e\n\u003ctd\u003e将指定值附加到键\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"散列哈希\"\u003e散列/哈希\u003c/h3\u003e\n\u003cp\u003eRedis 散列/哈希（Hash）是键值对的集合。Redis 散列/哈希是字符串字段和字符串值之间的映射。因此，哈希/散列特别适合用于存储对象。每个散列/哈希可以存储多达 \u003ccode\u003e2^32-1\u003c/code\u003e 个键值对。\u003c/p\u003e\n\u003cp\u003eRedis 哈希的基本命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003ehdel key_name field_1 [field_2]\u003c/td\u003e\n\u003ctd\u003e删除一个或多个哈希表字段\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003ehexists key_name field\u003c/td\u003e\n\u003ctd\u003e判断是否存在散列字段\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003ehget key_name field\u003c/td\u003e\n\u003ctd\u003e获取存储在指定键的哈希字段的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003ehgetall key_name\u003c/td\u003e\n\u003ctd\u003e获取存储在指定键的哈希中的所有字段和值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003ehincrby key_name field increment\u003c/td\u003e\n\u003ctd\u003e将哈希字段的整数值按给定数字增加\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003ehincrbyfloat key_name field increment\u003c/td\u003e\n\u003ctd\u003e将哈希字段的浮点值按给定数值增加\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003ehkeys key_name\u003c/td\u003e\n\u003ctd\u003e获取哈希中的所有字段\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003ehlen key_name\u003c/td\u003e\n\u003ctd\u003e获取散列中的字段数量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003ehmget key_name field_1 [field_2]\u003c/td\u003e\n\u003ctd\u003e获取所有给定哈希字段的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003ehmset key_name field_1 value_1 [field_2 value_2]\u003c/td\u003e\n\u003ctd\u003e为多个哈希字段分别设置它们的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003ehset key_name field value\u003c/td\u003e\n\u003ctd\u003e设置散列字段的字符串值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003ehsetnx key_name field value\u003c/td\u003e\n\u003ctd\u003e仅当字段不存在时，才设置散列字段的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003ehvals key_name\u003c/td\u003e\n\u003ctd\u003e获取哈希表中的所有值\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"列表\"\u003e列表\u003c/h3\u003e\n\u003cp\u003eRedis 列表只是字符串列表，按插入顺序排序。您可以向 Redis 列表的头部或尾部添加元素。列表的最大长度为\u003ccode\u003e2^32-1\u003c/code\u003e个元素。\u003c/p\u003e\n\u003cp\u003eRedis 列表的基本命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003eblpop key_name_1 [key_name_2] timeout\u003c/td\u003e\n\u003ctd\u003e删除并获取列表中的第一个元素，或阻塞，直到有一个元素可用\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003ebrpop key_name_1 [key_name_2] timeout\u003c/td\u003e\n\u003ctd\u003e删除并获取列表中的最后一个元素，或阻塞，直到有一个元素可用\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003ebrpoplpush source desitination timeout\u003c/td\u003e\n\u003ctd\u003e从列表中弹出值，将其推送到另一个列表并返回它; 或阻塞，直到一个可用\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003elindex key_name index\u003c/td\u003e\n\u003ctd\u003e通过其索引从列表获取元素\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003elinsert key_name before/after pivot value\u003c/td\u003e\n\u003ctd\u003e在列表中的另一个元素之前或之后插入元素\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003ellen key_name\u003c/td\u003e\n\u003ctd\u003e获取列表的长度\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003elpop key_name\u003c/td\u003e\n\u003ctd\u003e删除并获取列表中的第一个元素\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003elpush key_name value_1 [value_2]\u003c/td\u003e\n\u003ctd\u003e将一个或多个值添加到列表\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003elpushx key_name value\u003c/td\u003e\n\u003ctd\u003e仅当列表存在时，才向列表添加值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003elrange key_name start stop\u003c/td\u003e\n\u003ctd\u003e从列表中获取一系列元素\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003elrem key_name count value\u003c/td\u003e\n\u003ctd\u003e从列表中删除元素\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003elset key_name index value\u003c/td\u003e\n\u003ctd\u003e通过索引在列表中设置元素的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003eltrim key_name start stop\u003c/td\u003e\n\u003ctd\u003e让列表只保留指定区间内的元素，不在指定区间之内的元素都将被删除\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e14\u003c/td\u003e\n\u003ctd\u003erpop key_name\u003c/td\u003e\n\u003ctd\u003e删除并获取列表中的最后一个元素\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e15\u003c/td\u003e\n\u003ctd\u003erpoplpush source desitination\u003c/td\u003e\n\u003ctd\u003e移除列表的最后一个元素，并将该元素添加到另一个列表并返回\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003erpush key_name value_1 [value_2]\u003c/td\u003e\n\u003ctd\u003e在列表中添加一个或多个值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e17\u003c/td\u003e\n\u003ctd\u003erpushx key_name value\u003c/td\u003e\n\u003ctd\u003e为已存在的列表添加值\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"集合\"\u003e集合\u003c/h3\u003e\n\u003cp\u003eRedis集合是字符串的无序集合。集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。根据集合内元素的唯一性，第二次插入的元素将被忽略。集合中最大的元素个数为 \u003ccode\u003e$ 2^{32}-1 $\u003c/code\u003e 个。\u003c/p\u003e\n\u003cp\u003eRedis 集合常用命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003esadd key_name member_1 [member_2]\u003c/td\u003e\n\u003ctd\u003e向集合添加一个或多个成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003escard key_name\u003c/td\u003e\n\u003ctd\u003e获取集合的成员数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003esdiff key_name_1 [key_name_2]\u003c/td\u003e\n\u003ctd\u003e返回给定所有集合的差集\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003esdiffstore destination key_name_1 [key_name_2]\u003c/td\u003e\n\u003ctd\u003e返回给定所有集合的差集并存储在 destination 中\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003esinter key_name_1 [key_name_2]\u003c/td\u003e\n\u003ctd\u003e返回给定所有集合的交集\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003esinterstore destination key_name_1 [key_name_2]\u003c/td\u003e\n\u003ctd\u003e返回给定所有集合的交集并存储在 destination 中\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003esismember key_name memeber\u003c/td\u003e\n\u003ctd\u003e判断member元素是否是集合key_name的成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003esmembers key_name\u003c/td\u003e\n\u003ctd\u003e返回集合中的所有成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003esmove source destination member\u003c/td\u003e\n\u003ctd\u003e将 member 元素从 source 集合移动到 destination 集合\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003espop key_name\u003c/td\u003e\n\u003ctd\u003e从集合中删除并返回随机成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003esrandmember key_name [count]\u003c/td\u003e\n\u003ctd\u003e返回集合中一个或多个随机数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003esrem key_name member_1 [member_2]\u003c/td\u003e\n\u003ctd\u003e移除集合中一个或多个成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003esunion key_name_1 [key_name_2]\u003c/td\u003e\n\u003ctd\u003e返回所有给定集合的并集\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e14\u003c/td\u003e\n\u003ctd\u003esunionstore destination key_name_1 [key_name_2]\u003c/td\u003e\n\u003ctd\u003e所有给定集合的并集存储在 destination 集合中\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e15\u003c/td\u003e\n\u003ctd\u003esscan key_name cursor [match pattern][count count]\u003c/td\u003e\n\u003ctd\u003e迭代集合中的元素\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"有序集合\"\u003e有序集合\u003c/h3\u003e\n\u003cp\u003eRedis 有序集合类似于 Redis 集合，是不重复的字符集合， 不同之处在于，有序集合的每个成员都与分数相关联，这个分数用于 \u003ccode\u003e按最小分数到最大分数\u003c/code\u003e 来排序的有序集合。虽然元素是唯一的，但元素的分数值可以重复。\u003c/p\u003e\n\u003cp\u003eRedis 有序集合基本命令：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e命令\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003ezadd key_name score_1 member_1 [score_2, member_2]\u003c/td\u003e\n\u003ctd\u003e向有序集合添加一个或多个成员，或者更新已存在成员的分数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003ezcard key_name\u003c/td\u003e\n\u003ctd\u003e获取有序集合的成员数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003ezcount key_name min max\u003c/td\u003e\n\u003ctd\u003e计算在有序集合中指定区间分数的成员数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003ezincrby key_name increment member\u003c/td\u003e\n\u003ctd\u003e有序集合中对指定成员的分数加上增量 increment\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003ezinterstore destination numkeys key_name_1 [key_name_2...]\u003c/td\u003e\n\u003ctd\u003e计算给定的一个或多个有序集的交集并将结果集存储在新的有序集合 key 中\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003ezlexcount key_name min max\u003c/td\u003e\n\u003ctd\u003e在有序集合中计算指定字典区间内成员数量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003ezrange key_name start stop [withscores]\u003c/td\u003e\n\u003ctd\u003e通过索引区间返回有序集合成指定区间内的成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003ezrangebylex key_name min max [limit offset count]\u003c/td\u003e\n\u003ctd\u003e通过字典区间返回有序集合的成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd\u003ezrangebyscore key_name min max [withscores][limit]\u003c/td\u003e\n\u003ctd\u003e通过分数返回有序集合指定区间内的成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003ezrank key_name member\u003c/td\u003e\n\u003ctd\u003e返回有序集合中指定成员的索引\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e11\u003c/td\u003e\n\u003ctd\u003ezrem key_name member [member...]\u003c/td\u003e\n\u003ctd\u003e移除有序集合中的一个或多个成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e12\u003c/td\u003e\n\u003ctd\u003ezremrangebylex key_name min max\u003c/td\u003e\n\u003ctd\u003e移除有序集合中给定的字典区间的所有成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e13\u003c/td\u003e\n\u003ctd\u003ezremrangebyrank key_name start stop\u003c/td\u003e\n\u003ctd\u003e移除有序集合中给定的排名区间的所有成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e14\u003c/td\u003e\n\u003ctd\u003ezremrangebyscore key_name min max\u003c/td\u003e\n\u003ctd\u003e移除有序集合中给定的分数区间的所有成员\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e15\u003c/td\u003e\n\u003ctd\u003ezrevrange key_name start stop [withscores]\u003c/td\u003e\n\u003ctd\u003e返回有序集中指定区间内的成员，通过索引，分数从高到底\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003ezrevrangebyscore key_name max min [withscores]\u003c/td\u003e\n\u003ctd\u003e返回有序集中指定分数区间内的成员，分数从高到低排序\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e17\u003c/td\u003e\n\u003ctd\u003ezrevrank key_name member\u003c/td\u003e\n\u003ctd\u003e返回有序集合中指定成员的排名，有序集成员按分数值递减(从大到小)排序\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e18\u003c/td\u003e\n\u003ctd\u003ezscore key_name member\u003c/td\u003e\n\u003ctd\u003e返回有序集中，成员的分数值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e19\u003c/td\u003e\n\u003ctd\u003ezunionstore destination numkeys key_name_1 [key_name_2...]\u003c/td\u003e\n\u003ctd\u003e计算给定的一个或多个有序集的并集，并存储在新的 key 中\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e20\u003c/td\u003e\n\u003ctd\u003ezscan key_name cursor [match pattern][count count]\u003c/td\u003e\n\u003ctd\u003e迭代有序集合中的元素（包括元素成员和元素分值）\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e","date":1523318400,"description":"","fuzzywordcount":2400,"kind":"page","lang":"zh","lastmod":1530144000,"objectID":"0905285fbdc1053fa9d9a2ed94c319bc","publishdate":1523318400,"relpermalink":"/posts/storage/redis/redis-data-type/","section":"posts","summary":"\u003cp\u003e本篇博客主要介绍了 redis 的常用数据类型。\u003c/p\u003e","tags":["Redis","数据库"],"title":"Redis 常用数据类型总结","url":"https://xdhuxc.github.io/posts/storage/redis/redis-data-type/","wordcount":2332},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在使用 zookeeper 的过程中经常遇到的问题及解决方法。\u003c/p\u003e\n\u003cp\u003e1、重启zookeeper时报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eApr 23 17:08:30 localhost zookeeper: 2018-04-23 17:08:30,702 [myid:] - ERROR [main:Util@239] - Last transaction was partial.\nApr 23 17:08:30 localhost zookeeper: 2018-04-23 17:08:30,703 [myid:] - ERROR [main:ZooKeeperServerMain@63] - Unexpected exception, exiting abnormally\nApr 23 17:08:30 localhost zookeeper: java.io.EOFException\nApr 23 17:08:30 localhost zookeeper: at java.io.DataInputStream.readInt(DataInputStream.java:392)\nApr 23 17:08:30 localhost zookeeper: at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决\u003c/p\u003e\n\u003cp\u003e找到 \u003ccode\u003e/etc/zookeeper/conf/zoo.cfg\u003c/code\u003e 文件，找到 \u003ccode\u003ezookeeper\u003c/code\u003e 的数据目录，删除该数据目录，重新启动 \u003ccode\u003ezookeeper\u003c/code\u003e 即可。\u003c/p\u003e","date":1520985600,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1577516638,"objectID":"cb53b63e972acfb9468ba8e9edd67289","publishdate":1520985600,"relpermalink":"/posts/mixed/zookeeper/zookeeper-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在使用 zookeeper 的过程中经常遇到的问题及解决方法。\u003c/p\u003e","tags":["Zookeeper"],"title":"zookeeper 常见问题及解决","url":"https://xdhuxc.github.io/posts/mixed/zookeeper/zookeeper-questions-and-solutions/","wordcount":137},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了分别使用 kubeadmin 安装 Kubernetes 的详细过程，还记录了安装过程中可能出现的问题及解决方法。\u003c/p\u003e\n\u003ch3 id=\"安装-kubernetes\"\u003e安装 kubernetes\u003c/h3\u003e\n\u003cp\u003e1、修改主机名\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehostnamectl set-hostname \u0026#39;k8s-master\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、禁用 SELinux\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esetenforce 0\nsed -i --follow-symlinks \u0026#39;s/SELINUX=enforcing/SELINUX=disabled/g\u0026#39; /etc/sysconfig/selinux\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、修改内核参数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecat \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eEOF\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e  /etc/sysctl.d/kubernetes.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nvm.swappiness=0\nEOF\n\nsysctl --system\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、关闭防火墙\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl stop firewalld\nsystemctl disable firewalld\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、禁用 swap\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eswapoff -a\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 \u003ccode\u003e/etc/fstab\u003c/code\u003e 文件，注释掉 Swap 的自动挂载\u003c/p\u003e\n\u003cp\u003e6、使用如下 kubernetes repo 源 及 docker 源\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecat \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eEOF\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64\nenabled=1\ngpgcheck=1\nrepo_gpgcheck=1\ngpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg\nEOF\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、安装 docker\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo # 配置 docker repo 源\nyum list docker-ce.x86_64  --showduplicates |sort -r # 查看最新的 Docker 版本\nyum install docker-ce-18.06\nsystemctl restart docker \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e systemctl enable docker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、安装 dubeadm\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y kubeadm \nsystemctl restart kubelet \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e systemctl enable kubelet\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e9、使用 kubeadm\n执行命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekubeadm init \\\n     --kubernetes-version=v1.13.1 \\\n     --pod-network-cidr=10.244.0.0/16 \\\n     --apiserver-advertise-address=10.0.2.15\n     \n\nmkdir -p $HOME/.kube\n\\cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nchown $(id -u):$(id -g) $HOME/.kube/config\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行效果为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e75\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master ~]# kubeadm init \\\n\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003e    --kubernetes-version=v1.13.1 \\\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003e    --pod-network-cidr=10.244.0.0/16 \\\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003e\u0026gt; \u003c/span\u003e\u003cspan class=\"ge\"\u003e    --apiserver-advertise-address=10.0.2.15\n\u003c/span\u003e\u003cspan class=\"ge\"\u003e\u003c/span\u003e[init] Using Kubernetes version: v1.13.1\n[preflight] Running pre-flight checks\n\t[WARNING Hostname]: hostname \u0026#34;k8s-master\u0026#34; could not be reached\n\t[WARNING Hostname]: hostname \u0026#34;k8s-master\u0026#34;: lookup k8s-master on 10.0.2.3:53: no such host\n[preflight] Pulling images required for setting up a Kubernetes cluster\n[preflight] This might take a minute or two, depending on the speed of your internet connection\n[preflight] You can also perform this action in beforehand using \u0026#39;kubeadm config images pull\u0026#39;\n[kubelet-start] Writing kubelet environment file with flags to file \u0026#34;/var/lib/kubelet/kubeadm-flags.env\u0026#34;\n[kubelet-start] Writing kubelet configuration to file \u0026#34;/var/lib/kubelet/config.yaml\u0026#34;\n[kubelet-start] Activating the kubelet service\n[certs] Using certificateDir folder \u0026#34;/etc/kubernetes/pki\u0026#34;\n[certs] Generating \u0026#34;etcd/ca\u0026#34; certificate and key\n[certs] Generating \u0026#34;etcd/healthcheck-client\u0026#34; certificate and key\n[certs] Generating \u0026#34;etcd/server\u0026#34; certificate and key\n[certs] etcd/server serving cert is signed for DNS names [k8s-master localhost] and IPs [10.0.2.15 127.0.0.1 ::1]\n[certs] Generating \u0026#34;etcd/peer\u0026#34; certificate and key\n[certs] etcd/peer serving cert is signed for DNS names [k8s-master localhost] and IPs [10.0.2.15 127.0.0.1 ::1]\n[certs] Generating \u0026#34;apiserver-etcd-client\u0026#34; certificate and key\n[certs] Generating \u0026#34;ca\u0026#34; certificate and key\n[certs] Generating \u0026#34;apiserver\u0026#34; certificate and key\n[certs] apiserver serving cert is signed for DNS names [k8s-master kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 10.0.2.15]\n[certs] Generating \u0026#34;apiserver-kubelet-client\u0026#34; certificate and key\n[certs] Generating \u0026#34;front-proxy-ca\u0026#34; certificate and key\n[certs] Generating \u0026#34;front-proxy-client\u0026#34; certificate and key\n[certs] Generating \u0026#34;sa\u0026#34; key and public key\n[kubeconfig] Using kubeconfig folder \u0026#34;/etc/kubernetes\u0026#34;\n[kubeconfig] Writing \u0026#34;admin.conf\u0026#34; kubeconfig file\n[kubeconfig] Writing \u0026#34;kubelet.conf\u0026#34; kubeconfig file\n[kubeconfig] Writing \u0026#34;controller-manager.conf\u0026#34; kubeconfig file\n[kubeconfig] Writing \u0026#34;scheduler.conf\u0026#34; kubeconfig file\n[control-plane] Using manifest folder \u0026#34;/etc/kubernetes/manifests\u0026#34;\n[control-plane] Creating static Pod manifest for \u0026#34;kube-apiserver\u0026#34;\n[control-plane] Creating static Pod manifest for \u0026#34;kube-controller-manager\u0026#34;\n[control-plane] Creating static Pod manifest for \u0026#34;kube-scheduler\u0026#34;\n[etcd] Creating static Pod manifest for local etcd in \u0026#34;/etc/kubernetes/manifests\u0026#34;\n[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory \u0026#34;/etc/kubernetes/manifests\u0026#34;. This can take up to 4m0s\n[apiclient] All control plane components are healthy after 20.512973 seconds\n[uploadconfig] storing the configuration used in ConfigMap \u0026#34;kubeadm-config\u0026#34; in the \u0026#34;kube-system\u0026#34; Namespace\n[kubelet] Creating a ConfigMap \u0026#34;kubelet-config-1.13\u0026#34; in namespace kube-system with the configuration for the kubelets in the cluster\n[patchnode] Uploading the CRI Socket information \u0026#34;/var/run/dockershim.sock\u0026#34; to the Node API object \u0026#34;k8s-master\u0026#34; as an annotation\n[mark-control-plane] Marking the node k8s-master as control-plane by adding the label \u0026#34;node-role.kubernetes.io/master=\u0026#39;\u0026#39;\u0026#34;\n[mark-control-plane] Marking the node k8s-master as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]\n[bootstrap-token] Using token: 1n0oej.96h4zyk2j1tnp263\n[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles\n[bootstraptoken] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials\n[bootstraptoken] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token\n[bootstraptoken] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster\n[bootstraptoken] creating the \u0026#34;cluster-info\u0026#34; ConfigMap in the \u0026#34;kube-public\u0026#34; namespace\n[addons] Applied essential addon: CoreDNS\n[addons] Applied essential addon: kube-proxy\n\nYour Kubernetes master has initialized successfully!\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nYou should now deploy a pod network to the cluster.\nRun \u0026#34;kubectl apply -f [podnetwork].yaml\u0026#34; with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nYou can now join any number of machines by running the following on each node\nas root:\n\n  kubeadm join 10.0.2.15:6443 --token 1n0oej.96h4zyk2j1tnp263 --discovery-token-ca-cert-hash sha256:927f51ac11f8c874b8b9531d465cedcb8b53028f0aac003be071a2fd2acc60e4\n\n[root@k8s-master ~]# mkdir -p $HOME/.kube\n[root@k8s-master ~]# \\cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n[root@k8s-master ~]# chown $(id -u):$(id -g) $HOME/.kube/config\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e10、查看节点状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master ~]# kubectl get nodes\nNAME         STATUS     ROLES    AGE    VERSION\nk8s-master   NotReady   master   5m6s   v1.13.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时还需要配置网络插件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://docs.projectcalico.org/v3.4/getting-started/kubernetes/installation/hosted/calico.yaml\nkubectl apply -f calico.yaml\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时再查看 kubernetes 的状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master ~]# kubectl get nodes\nNAME         STATUS   ROLES    AGE   VERSION\nk8s-master   Ready    master   15m   v1.13.1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e11、重置集群\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master ~]# kubeadm reset\n[reset] WARNING: changes made to this host by \u0026#39;kubeadm init\u0026#39; or \u0026#39;kubeadm join\u0026#39; will be reverted.\n[reset] are you sure you want to proceed? [y/N]: y\n[preflight] running pre-flight checks\n[reset] Reading configuration from the cluster...\n[reset] FYI: You can look at this config file with \u0026#39;kubectl -n kube-system get cm kubeadm-config -oyaml\u0026#39;\n[reset] stopping the kubelet service\n[reset] unmounting mounted directories in \u0026#34;/var/lib/kubelet\u0026#34;\n[reset] deleting contents of stateful directories: [/var/lib/etcd /var/lib/kubelet /etc/cni/net.d /var/lib/dockershim /var/run/kubernetes]\n[reset] deleting contents of config directories: [/etc/kubernetes/manifests /etc/kubernetes/pki]\n[reset] deleting files: [/etc/kubernetes/admin.conf /etc/kubernetes/kubelet.conf /etc/kubernetes/bootstrap-kubelet.conf /etc/kubernetes/controller-manager.conf /etc/kubernetes/scheduler.conf]\n\nThe reset process does not reset or clean up iptables rules or IPVS tables.\nIf you wish to reset iptables, you must do so manually.\nFor example:\niptables -F \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e iptables -t nat -F \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e iptables -t mangle -F \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e iptables -X\n\nIf your cluster was setup to utilize IPVS, run ipvsadm --clear (or similar)\nto reset your system\u0026#39;s IPVS tables.\n\n[root@k8s-master ~]# iptables -F \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e iptables -t nat -F \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e iptables -t mangle -F \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e iptables -X\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"问题及解决\"\u003e问题及解决\u003c/h4\u003e\n\u003cp\u003e1、coredns pod 一直处于 pending 状态，使用 kubectl describe 查看后，错误信息如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eQoS Class:       Burstable\nNode-Selectors:  \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003enone\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\nTolerations:     CriticalAddonsOnly\n                 node-role.kubernetes.io/master:NoSchedule\n                 node.kubernetes.io/not-ready:NoExecute for 300s\n                 node.kubernetes.io/unreachable:NoExecute for 300s\nEvents:\n  Type     Reason            Age                 From               Message\n  ----     ------            ----                ----               -------\n  Warning  FailedScheduling  33m                 default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn\u0026#39;t tolerate.\n  Warning  FailedScheduling  32m (x3 over 32m)   default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn\u0026#39;t tolerate.\n  Warning  FailedScheduling  30m                 default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn\u0026#39;t tolerate.\n  Warning  FailedScheduling  26m (x6 over 29m)   default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn\u0026#39;t tolerate.\n  Warning  FailedScheduling  14m (x29 over 24m)  default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn\u0026#39;t tolerate.\n  Warning  FailedScheduling  12m                 default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn\u0026#39;t tolerate.\n  Warning  FailedScheduling  5m41s               default-scheduler  0/1 nodes are available: 1 node(s) had taints that the pod didn\u0026#39;t tolerate.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这是因为 kubernetes 出于安全考虑，默认情况下无法在 master 节点上部署 pod，由于我们只有一个节点，所以需要取消此限制，执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master ~]# kubectl taint nodes --all node-role.kubernetes.io/master-\nnode/k8s-master untainted\n[root@k8s-master ~]# kubectl get pods --all-namespaces\nNAMESPACE     NAME                                 READY   STATUS             RESTARTS   AGE\nkube-system   coredns-86c58d9df4-gzx76             1/1     Running            0          53m\nkube-system   coredns-86c58d9df4-vvbt9             1/1     Running            0          54m\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1520640000,"description":"","fuzzywordcount":1600,"kind":"page","lang":"zh","lastmod":1520640000,"objectID":"bced35d8e16a7e6261cc8d26947bdac8","publishdate":1520640000,"relpermalink":"/posts/kubernetes/kubernetes-installation/","section":"posts","summary":"\u003cp\u003e本篇博客记录了分别使用 kubeadmin 安装 Kubernetes 的详细过程，还记录了安装过程中可能出现的问题及解决方法。\u003c/p\u003e","tags":["Kubernetes"],"title":"使用 kubeadmin 安装 Kubernetes ","url":"https://xdhuxc.github.io/posts/kubernetes/kubernetes-installation/","wordcount":1506},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下处理 JSON 格式数据的工具 JQ 的使用。\u003c/p\u003e\n\u003ch3 id=\"jq-工具\"\u003eJQ 工具\u003c/h3\u003e\n\u003ch4 id=\"centos-安装-jq\"\u003eCentOS 安装 JQ\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -O jq https://github.com/stedolan/jq/releases/download/jq-1.5/jq-linux64\nchmod +x ./jq\nmv ./jq /usr/bin\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"jq-语法\"\u003eJQ 语法\u003c/h4\u003e\n\u003cp\u003e1、获取如下的 JSON 格式文件 xdhuxc.json 中 lastName 的值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n  \u0026#34;uid\u0026#34;: \u0026#34;2378\u0026#34;,\n  \u0026#34;nameInfo\u0026#34;: [\n    {\n      \u0026#34;firstName\u0026#34;: \u0026#34;nova\u0026#34;,\n      \u0026#34;lastName\u0026#34;: \u0026#34;jos\u0026#34;\n    }\n  ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecat xdhuxc.json | jq -r \u0026#39;.nameInfo[].lastName\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e获取如下的 JSON 格式文件 xdhuxc.json 中 value 的值\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n    \u0026#34;action\u0026#34;: \u0026#34;get\u0026#34;,\n    \u0026#34;node\u0026#34;: {\n        \u0026#34;createdIndex\u0026#34;: 356,\n        \u0026#34;key\u0026#34;: \u0026#34;token.key\u0026#34;,\n        \u0026#34;modifiedIndex\u0026#34;: 356,\n        \u0026#34;value\u0026#34;: \u0026#34;abcdefg\u0026#34;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecat xdhuxc.json | jq -r \u0026#39;.node.value\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e-r：该选项控制 jq 是输出 raw 格式内容或 JSON 格式内容。所谓 JSON 格式是指符合 JSON 标准的格式。例如，假设我们要查询 JSON 字符串 {\u0026quot;name\u0026quot;:\u0026quot;tom\u0026quot;} 中 name 的值，使用 -r 选项时返回的是 tom，不使用 -r 选项时，返回的是 \u0026quot;tom\u0026quot;，返回值多了一对双引号。\u003c/p\u003e","date":1520380800,"description":"","fuzzywordcount":300,"kind":"page","lang":"zh","lastmod":1538870400,"objectID":"6147d0c6d4a043a7c3c1a732ff7a58ea","publishdate":1520380800,"relpermalink":"/posts/tools/tools-json-jq/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下处理 JSON 格式数据的工具 JQ 的使用。\u003c/p\u003e","tags":["JSON"],"title":"JSON 格式数据工具 JQ 的使用","url":"https://xdhuxc.github.io/posts/tools/tools-json-jq/","wordcount":264},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了一个使用 Flask 开发的 Python web 程序，可以作为使用 Flask 开发 web 程序的入门教程。\u003c/p\u003e\n\u003ch3 id=\"安装-flask-环境\"\u003e安装 Flask 环境\u003c/h3\u003e\n\u003cp\u003e1、Flask 依赖两个外部库： Werkzeug 和 Jinja2 。Werkzeug 是一个 WSGI 套件。 WSGI 是 Web 应用与 多种服务器之间的标准 Python 接口，即用于开发，也用于部署。 Jinja2 是用于渲染 模板的。\u003c/p\u003e\n\u003cp\u003e2、virtualenv的基本原理是为每个项目安装一套 Python ，多套 Python 并存。但它不是真正地安装多套独立的 Python 拷贝，而是使用了一种巧妙的方法让不同的项目处于各自独立的环境中。使用虚拟环境可以方便地安装 Flask 并且可以在系统的 Python 解释器中避免包的混乱和版本冲突。Python 3.3 以后原生支持虚拟环境，命令为：pyvenv。\u003c/p\u003e\n\u003cp\u003e1）安装虚拟 \u003ccode\u003ePython\u003c/code\u003e 环境，在 \u003ccode\u003eLinux\u003c/code\u003e 或者 \u003ccode\u003eWindows\u003c/code\u003e 下，使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo pip install virtualenv\n或\nsudo easy_install virtualenv\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003eUbuntu\u003c/code\u003e 中使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo apt-get install python-virtualenv\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）使用virtualenv命令在文件夹中创建 Python 虚拟环境\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evirtualenv venv\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）每次需要使用项目时，必须先激活相应的环境\u003c/p\u003e\n\u003cp\u003eCentOS 下运行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e. venv/bin/activate\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003eWindows\u003c/code\u003e 下运行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e.\\venv\\Scripts\\activate\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果要退出虚拟环境，可以使用\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e.\\venv\\Scripts\\deactivate.bat\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4）安装 flask\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo pip install flask\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"flask-程序结构\"\u003eFlask 程序结构\u003c/h3\u003e\n\u003cp\u003e1、使用 PyCharm 新建 Flask 项目后，项目结构如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/flask/WechatIMG667.png\" width=\"300px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n只有三个文件夹（venv文件夹已经用命令行生成）和一个简单地入口类。\n\u003cp\u003e2、改造为标准的 Flask 项目\u003c/p\u003e\n\u003cp\u003e在命令行中依次使用以下命令来安装 Flask 扩展。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eE:\\PycharmProject\\xflask\u0026gt;.\\venv\\Scripts\\activate\n\n(venv) E:\\PycharmProject\\xflask\u0026gt;pip install flask-script\n(venv) E:\\PycharmProject\\xflask\u0026gt;pip install flask-sqlalchemy\n(venv) E:\\PycharmProject\\xflask\u0026gt;pip install flask-migrate\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eflask-script 可以自定义命令行命令，用来启动程序或其他任务；flask-sqlalchemy用来管理数据库的工具，支持多种数据库后台；flask-migrate是数据库迁移工具，该工具命令集成到 flask-script中，方便在命令行中进行操作。\n创建 config.py 文件，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport os\n\nbasedir = os.path.abspath(os.path.dirname(__file__))\n\nclass config:    \n    SECRET_KEY = os.environ.get(\u0026#39;SECRET_KEY\u0026#39;) or \u0026#39;this is a secret string\u0026#39; \n    SQLALCHEMY_TRACK_MODIFICATIONS = True  \n\n    \u003cspan class=\"ni\"\u003e@staticmethod\u003c/span\u003e    \n    def init_app(app):        \n        pass\n\nclass DevelopmentConfig(config):    \n    DEBUG = True    \n    SQLALCHEMY_DATABASE_URI = os.environ.get(\u0026#39;DEV_DATABASE_URL\u0026#39;) or \\        \n    \u0026#39;sqlite:///\u0026#39; + os.path.join(basedir, \u0026#39;dev\u0026#39;)\n\nclass TestingConfig(config):    \n    TESTING = True    \n    SQLALCHEMY_DATABASE_URI = os.environ.get(\u0026#39;TEST_DATABASE_URL\u0026#39;) or \\                              \n    \u0026#39;sqlite:///\u0026#39; + os.path.join(basedir, \u0026#39;test\u0026#39;)\n\nclass ProductionConfig(config):    \n    SQLALCHEMY_DATABASE_URI = os.environ.get(\u0026#39;DATABASE_URL\u0026#39;) or \\                              \n    \u0026#39;sqlite:///\u0026#39; + os.path.join(basedir, \u0026#39;data.sqlite\u0026#39;)\n\nconfig = {    \n    \u0026#39;development\u0026#39;: DevelopmentConfig,    \n    \u0026#39;testing\u0026#39;: TestingConfig,    \n    \u0026#39;production\u0026#39;: ProductionConfig,    \n    \u0026#39;default\u0026#39;: DevelopmentConfig\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003econfig 保存了一些配置变量，SQLALCHEMY_DATABASE_URI 变量在不同的配置中被赋予了不同的值，这样就可以在不同的环境中切换数据库。如果是远程数据库，则从环境变量中读取URL，否则在本地路径中创建。\u003c/p\u003e\n\u003cp\u003e创建一个 app 目录，并在此目录中创建一个 \u003ccode\u003e__init__.py\u003c/code\u003e 文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efrom flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\nfrom config import config\n\ndb = SQLAlchemy()\n\n\ndef create_app(config_name):\n    app = Flask(__name__)\n    app.config.from_object(config[config_name])\n    config[config_name].init_app(app)\n    db.init_app(app)\n\n    return app\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eCreate_app() 就是程序的工厂函数，参数就是配置类的名称，即config.py，其中保存的配置可以使用from_object()方法导入。\u003c/p\u003e\n\u003cp\u003e路由和视图函数：\n客户端把请求发送给 web服务器，web服务器再把请求发送给 Flask 程序实例，Flask程序实例需要知道每个URL请求要运行哪些代码，所以保存了一个URL到Python函数的映射关系。处理URL和函数之间关系的程序称为路由，这个函数称为视图函数。例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"ni\"\u003e@app\u003c/span\u003e.route(\u0026#39;/\u0026#39;)\ndef index():\n    return \u0026#39;\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eHello World\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这里使用app.route修饰器来定义路由，app指Flask程序实例对象，后面可以看到使用蓝本管理路由后，由蓝本实例对象来取代app。Flask 使用蓝本来定义路由，在蓝本中定义的路由处于休眠状态，直到蓝本注册到程序上后，路由真正成为程序的一部分。蓝本通常使用结构化的方式保存在包的多个模块中。\u003c/p\u003e\n\u003cp\u003e接下来在app目录中创建一个子目录main，并在main目录中创建文件 \u003ccode\u003e__init__.py\u003c/code\u003e，在 \u003ccode\u003e__init__.py\u003c/code\u003e 中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efrom flask import Blueprint\n\n\u003cspan class=\"gh\"\u003e# 实例化 Blueprint 类，两个参数分别为蓝本的名字和蓝本所在包或模块，第二个通常填 __name__ 即可\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emain = Blueprint(\u0026#39;main\u0026#39;, \u003cspan class=\"gs\"\u003e__name__\u003c/span\u003e)\n\n\nfrom . import views, errors\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e最后引用了两个文件，写在最后是为了避免循环导入依赖，因为接下来在 main 目录下创建的views.py 和 errors.py 都要导入蓝本 main。\u003c/p\u003e\n\u003cp\u003e在main目录下创建 views.py\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efrom flask import render_template\n\n\u003cspan class=\"gh\"\u003e# 导入蓝本 main\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efrom . import main\n\n\n\u003cspan class=\"ni\"\u003e@main\u003c/span\u003e.route(\u0026#39;/\u0026#39;)\ndef index():\n    return render_template(\u0026#39;index.html\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在路由的概念解释中，index函数直接返回了HTML字符串，通常不这么做。这里则使用了render_template()函数来渲染index.html，并返回。Flask 使用了 Jinja2引擎来渲染模板，模板文件都放在templates目录下，并且该目录只能命名为templates，否则Jinja2会抛出TemplateNotFound异常。\u003c/p\u003e\n\u003cp\u003e由于app是一个Python Package（在目录中包含__init__.py的目录默认成为Python Pckage），所以需要将templates放在app目录下，在app目录下创建templates目录。然后在templates下创建一个index.html和404.html模板。\nindex.html文件内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e \u003cspan class=\"na\"\u003elang\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;en\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emeta\u003c/span\u003e \u003cspan class=\"na\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;UTF-8\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eindex\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eHello World\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e404.html内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;!DOCTYPE html\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e \u003cspan class=\"na\"\u003elang\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;en\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003emeta\u003c/span\u003e \u003cspan class=\"na\"\u003echarset\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;UTF-8\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eNot Found\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eCan\u0026#39;t find request page!\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e定义errors.py，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efrom flask import render_template\nfrom . import main\n\n\n\u003cspan class=\"ni\"\u003e@main\u003c/span\u003e.app_errorhandler(404)\ndef page_not_found(e):\n    return render_template(\u0026#39;404.html\u0026#39;), 404\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e让程序的路由保存在views.py中，而错误处理交给errors.py，这两个模块已经和蓝本main关联起来了（在蓝本中导入了这两个模块）。现在需要在工厂函数中注入蓝本main，将如下代码加入到app/\u003cstrong\u003einit\u003c/strong\u003e.py中\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efrom flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\nfrom config import config\nfrom .main import main as main_blueprint\n\ndb = SQLAlchemy()\n\n\ndef create_app(config_name):\n    app = Flask(__name__)\n    app.config.from_object(config[config_name])\n    config[config_name].init_app(app)\n    db.init_app(app)\n\n    # 在工厂函数中注册蓝本 main\n    app.register_blueprint(main_blueprint)\n    return app\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建requirements.txt，程序中必须包含一个requirements.txt文件，用于记录所有的依赖包和其版本号，便于在其他电脑上创建相同的开发环境。直接在终端下使用如下命令创建requirements.txt文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epip freeze \u0026gt; requirements.txt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以后安装了新的依赖包或者升级版本后，重新执行该命令即可更新requirements.txt文件。\u003c/p\u003e\n\u003cp\u003e如果需要在另外一台电脑上创建这个虚拟环境的完全副本，运行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epip install -r requirements.txt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建启动脚本 manage.py\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport os\nfrom app import create_app, db\nfrom flask_script import Manager, Shell\nfrom flask_migrate import Migrate, MigrateCommand\n\napp = create_app(os.getenv(\u0026#39;FLASK_CONFIG\u0026#39;) or \u0026#39;default\u0026#39;)\nmanager = Manager(app)\nmigrate = Migrate(app, db)\n\n\ndef make_shell_context():\n    return dict(app=app, db=db)\n\n\nmanager.add_command(\u0026#34;shell\u0026#34;,Shell(make_context=make_shell_context))\nmanager.add_command(\u0026#39;db\u0026#39;, MigrateCommand)\n\nif \u003cspan class=\"gs\"\u003e__name__\u003c/span\u003e == \u0026#39;__main__\u0026#39;:\n    manager.run()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这个脚本首先创建程序，然后增加了两个命令：shell和db，后续可以在命令行中直接使用。\u003c/p\u003e\n\u003cp\u003e到目前为止，我们的flask程序目录结构如下：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/flask/WechatIMG668.jpeg\" width=\"500px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e接下来，运行我们的程序，在命令行中进入E:\\PycharmProject\\xflask\u0026gt;目录，执行如下命令即可运行程序：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epython manage.py runserver\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e命令行运行截图如下：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/flask/WechatIMG669.png\" width=\"500px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003eFlask 默认的本机地址为：http://127.0.0.1:5000或者http://localhost:5000，可以在浏览器中访问，如下图所示，可以按“Ctrl + C”退出程序。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/flask/WechatIMG670.png\" width=\"500px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e此时，默认只能本地访问网站，如果需要其他人也可以访问，需要指定0.0.0.0这个IP，就需要再加入参数，指定主机和端口，这样其他人访问时，只需要输入机器的IP地址，再加上端口就可以了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epython manage.py runserver --host 0.0.0.0 --port 8080\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在终端中使用上述命令启动程序\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/flask/WechatIMG671.png\" width=\"500px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在浏览器中访问如下：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/programming/python/flask/WechatIMG672.png\" width=\"500px\" height=\"200px\" /\u003e\n\u003c/center\u003e\n\u003ch4 id=\"一个-flask-项目的标准结构\"\u003e一个 Flask 项目的标准结构\u003c/h4\u003e\n\u003cp\u003eFlask 项目有四个顶级目录：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eapp：Flask程序保存在此目录中。\u003c/li\u003e\n\u003cli\u003emigrations：包含数据库迁移脚本。\u003c/li\u003e\n\u003cli\u003etests：单元测试放在此目录下。\u003c/li\u003e\n\u003cli\u003evenv：Python虚拟环境。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e同时还有一些文件，\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003erequirements.txt：列出了所有的依赖包，以便于在其他机器环境中重新生成相同的环境。\u003c/li\u003e\n\u003cli\u003econfig.py：存储配置。\u003c/li\u003e\n\u003cli\u003emanage.py：启动程序或者其他任务。\u003c/li\u003e\n\u003cli\u003egun.conf：Gunicorn配置文件。\u003c/li\u003e\n\u003c/ul\u003e","date":1519689600,"description":"","fuzzywordcount":3000,"kind":"page","lang":"zh","lastmod":1522108800,"objectID":"52cdc8c4c023b60498c5adf92a666441","publishdate":1519689600,"relpermalink":"/posts/programming/python/python-flask/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了一个使用 Flask 开发的 Python web 程序，可以作为使用 Flask 开发 web 程序的入门教程。\u003c/p\u003e","tags":["Python","Flask"],"title":"基于 Flask 开发 Python Web 程序","url":"https://xdhuxc.github.io/posts/programming/python/python-flask/","wordcount":2933},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 nginx 使用时常见的问题及解决方法。\u003c/p\u003e\n\u003cp\u003e1、启动nginx时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc nginx]# ./sbin/nginx -s reopen\nnginx: [error] invalid PID number \u0026#34;\u0026#34; in \u0026#34;/var/run/nginx.pid\u0026#34;\n[root@xdhuxc nginx]# ./sbin/nginx -s reload\nnginx: [error] invalid PID number \u0026#34;\u0026#34; in \u0026#34;/var/run/nginx.pid\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\n执行如下命令即可：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc nginx]# ./sbin/nginx -c conf/nginx.conf\n[root@xdhuxc nginx]# ./sbin/nginx -s reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1514505600,"description":"","fuzzywordcount":100,"kind":"page","lang":"zh","lastmod":1517184000,"objectID":"d0d86275f00c04159f587cc250ee18ff","publishdate":1514505600,"relpermalink":"/posts/mixed/nginx/nginx-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 nginx 使用时常见的问题及解决方法。\u003c/p\u003e","tags":["Nginx"],"title":"nginx 常见问题及解决","url":"https://xdhuxc.github.io/posts/mixed/nginx/nginx-questions-and-solutions/","wordcount":92},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了些 Linux Shell 脚本的典型示例代码，以备后查。\u003c/p\u003e\n\u003ch3 id=\"读取输入\"\u003e读取输入\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nfunction set_kubernetes_prometheus() {\n    while [ 0 ] ;\n    do\n        echo -n \u0026#34;请输入三个参数（以空格分隔开）:\u0026#34;\n        stty erase ^H\n        read P1 P2 P3\n        if [ -n \u0026#34;${P1}\u0026#34; -a -n \u0026#34;${P2}\u0026#34; -a -n \u0026#34;${P3}\u0026#34; ] ; then\n            break\n        fi\n    done\n\n    echo \u0026#34;参数 1 为：${P1}\u0026#34;\n    echo \u0026#34;参数 2 为：${P2}\u0026#34;\n    echo \u0026#34;参数 3 为：${P3}\u0026#34;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"计算三个数中的最大数\"\u003e计算三个数中的最大数\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/bin/bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# author：xdhuxc\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# time：2017-07-19\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# description：计算三个数中的最大数\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\necho \u0026#34;Please enter three numbers:\u0026#34;\n\t# -p，允许在read命令行中直接指定一个提示。\n\tread -p \u0026#34;The first number is :\u0026#34; x\n\tread -p \u0026#34;The second number is :\u0026#34; y\n\tread -p \u0026#34;The third number is : \u0026#34; z\nmax = $x\nif [ $y -ge $max ]; then\n   max = $y\nfi\nif [ $z -ge $max ]; then\n   max = $z\nfi\necho \u0026#34;The maximum number is $max\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"计算100以内的偶数的和\"\u003e计算100以内的偶数的和\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/bin/bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# author: xdhuxc\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# time: 2017-07-19\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# description：计算100以内的偶数的和\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esum = 0\nfor i in $(seq 1 100); do\n\tif [ $[$i % 2] -eq 0 ]; then\n\t\tlet sum += $i\n\tfi\ndone\necho \u0026#34;The sum is $sum.\u0026#34;\n\nsum = 0\nfor ((i=1; i\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e= 100; i++))\ndo\n\tif [ $[$i % 2] -eq 0 ]; then\n\t\tlet sum += $i\n\tfi\ndone\necho \u0026#34;The sum is $sum.\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"在某个目录下的所有文件中查找关键字\"\u003e在某个目录下的所有文件中查找关键字\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/bin/bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# author: xdhuxc\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# time: 2017-12-04\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# description：在某个目录下的所有文件中查找关键字，输出匹配文件的全路径\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# parameter 1：根目录名\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# parameter 2：查找关键字\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efunction traverse_dir(){\n    local base_dir=$1\n    local key=$2\n\n    \u003cspan class=\"ni\"\u003e#set\u003c/span\u003e -x\n    for file in $base_dir/*\n    do\n        if [ -d $file ]; then\n            traverse_dir $file $key\n        else\n            grep -w $key $file \u0026gt; /dev/null\n            if [ $? -eq 0 ]; then\n                    echo -e $file\n            fi\n        fi\n    done\n}\n\ntraverse_dir $1 $2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"加载-docker-镜像\"\u003e加载 docker 镜像\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/bin/bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# author: xdhuxc\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# time: 2017-12-04\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# description：加载当前目录下的tar格式镜像，更改镜像标签，再导出为tar格式镜像\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 加载当前目录下的镜像\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efor tar_image in ./*.tar\ndo\n\tif [ -f $tar_image ]; then\n\t\tdocker load -i $tar_image\n\tfi\ndone\n\n\u003cspan class=\"gh\"\u003e# 更改镜像标签\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edocker images | awk \u0026#39;NR \u0026gt; 1 {print $1, $2}\u0026#39; | while read old_image_name tag\ndo\n\t\u003cspan class=\"ni\"\u003e#new_image_name\u003c/span\u003e=${old_image_name//10.10.24.171/192.168.244.128}\n\tnew_image_name=${old_image_name#*\\/}\n\t# 修改镜像标签\n\tdocker tag $old_image_name:$tag $new_image_name:$tag\n\t# 删除旧的标签\n\tdocker rmi -f $old_image_name:$tag\n        # 导出为tar格式镜像\n\ttar_name=${new_image_name##*\\/}-${tag}.tar\n\tdocker save $new_image_name:$tag -o $tar_name \ndone\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"删除已经退出的docker镜像\"\u003e删除已经退出的docker镜像\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/bin/bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# author: xdhuxc\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# time: 2017-12-04\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# description：删除已经退出的docker镜像\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 删除已经退出的容器\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edocker ps -a | awk \u0026#39;NR \u0026gt; 1 {print $1}\u0026#39; | while read container_id\ndo\n    status=$(docker inspect --format={{.State.Status}} $container_id)\n\tif [ \u0026#34;$status\u0026#34;x = \u0026#34;exited\u0026#34;x ]; then\n\t\tdocker rm -f $container_id \u0026gt; /dev/null\n\tfi\ndone\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"删除所有镜像\"\u003e删除所有镜像\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/bin/bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 更改镜像标签 yonyoucloud-middleware/mesos-master 1.4.0 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edocker images | awk \u0026#39;NR \u0026gt; 1 {print $1, $2}\u0026#39; | while read old_image_name tag\ndo\n\t# 删除镜像\n\tdocker rmi $old_image_name:$tag\ndone\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"替换某文件中的键值对\"\u003e替换某文件中的键值对\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 替换某文件中的键值对\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 参数1：带文件路径的文件名\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 参数2：键\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 参数3：值\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# jdbc.url=jdbc.mysql\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 描述：如果文件中没有该键，则添加该键值对；如果有，则更新键的值\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nfunction replace_text(){\n    full_path_file=$1\n    key=$2\n    value=$3\n    grep \u0026#34;${key}=\u0026#34; ${full_path_file} \u0026gt; /dev/null 2\u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e1\n    if [ \u0026#34;$?\u0026#34; == \u0026#34;0\u0026#34; ] ; then\n        # 获取 key-value所在的行\n\n        echo \u0026#34;存在键${key}，其值为：${old_value}，替换其值为：${value}\u0026#34;\n        \u003cspan class=\"ni\"\u003e#sed\u003c/span\u003e \u0026#34;s/${key}=//g\u0026#34; ${full_path_file}\n        sed \u0026#34;s/${key}=${old_value}/${key}=${value}/g\u0026#34; ${full_path_file}\n    else\n        echo \u0026#34;不存在键 ${key}，添加键值对：${key}=${value}\u0026#34;\n        echo \u0026#34;${key}=${value}\u0026#34; \u0026gt;\u0026gt; ${full_path_file}\n    fi\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"使用cat命令向文件中追加内容\"\u003e使用cat命令向文件中追加内容\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e两个EOF之间的内容左端顶格，因为其之间的内容会原样追加到文件中\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\ncat \u0026gt;\u0026gt; /etc/profile \u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"na\"\u003eexport\u003c/span\u003e \u003cspan class=\"na\"\u003eRUN_AS_USER\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003eroot\u003c/span\u003e\n\u003cspan class=\"na\"\u003eexport\u003c/span\u003e \u003cspan class=\"na\"\u003eJAVA_HOME\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e${nexus_shell_dir}/jdk1.7.0_80\u003c/span\u003e\n\u003cspan class=\"na\"\u003eexport\u003c/span\u003e \u003cspan class=\"na\"\u003ePATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e$JAVA_HOME/bin:$PATH\u003c/span\u003e\n\u003cspan class=\"na\"\u003eEOF\u003c/span\u003e\n\u003cspan class=\"na\"\u003esource\u003c/span\u003e \u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003eetc\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003eprofile\u003c/span\u003e\n\u003cspan class=\"na\"\u003eecho\u003c/span\u003e \u003cspan class=\"err\"\u003e${\u003c/span\u003e\u003cspan class=\"na\"\u003eRUN_AS_USER\u003c/span\u003e\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"expect-的使用\"\u003eexpect 的使用\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env bash\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 安装 expect\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecommand -v expect \u0026gt; /dev/null 2\u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e1\nif [ \u0026#34;$?\u0026#34; != \u0026#34;0\u0026#34; ] ; then\n    echo -e \u0026#34;当前机器尚未安装 expect。\u0026#34;\n    echo -e \u0026#34;使用 yum 安装 except...\u0026#34;\n    yum install -y expect \nfi\n\nif [ $(command -v expect) ] ; then\n    # 生成 ssh key\n    chmod +x ssh-keygen.exp \n    ./ssh-keygen.exp \u0026gt; /dev/null 2\u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e1\n\n    # 复制 ssh key 到各机器\n    cat hosts | while read line\n    do\n        echo -e \u0026#34;${line}\u0026#34; \u0026gt; ./host.tmp\n        cat host.tmp | awk -F \u0026#39;[: ]\u0026#39; \u0026#39;{print $1, $2, $3, $4}\u0026#39; | while read target_host username password port\n        do\n        \techo -e ${target_host}\n        \techo -e ${username}\n        \techo -e ${password}\n                echo -e ${port}\n        \tif [ -n ${target_host} -a -n ${username} -a -n ${password} ] ; then\n            \t\t./ssh-copy-id.exp ${target_host} ${username} ${password} ${port}\n        \tfi\n\tdone\n    done\nfi \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"获取当前脚本的路径\"\u003e获取当前脚本的路径\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurrent_path=$(cd \u0026#34;$(dirname \u0026#34;$0\u0026#34;)\u0026#34;; pwd)\nfull_path=$(realpath $0)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行结果为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e/xdhuxc/script/tools\n/xdhuxc/script/tools/test.sh\n\u003c/code\u003e\u003c/pre\u003e","date":1512864000,"description":"","fuzzywordcount":1500,"kind":"page","lang":"zh","lastmod":1513641600,"objectID":"84618cc32e76361404b4734b46b27b35","publishdate":1512864000,"relpermalink":"/posts/linux/linux-shell-code-example/","section":"posts","summary":"\u003cp\u003e本篇博客记录了些 Linux Shell 脚本的典型示例代码，以备后查。\u003c/p\u003e","tags":["Linux","Shell"],"title":"Linux 中 Shell 脚本示例","url":"https://xdhuxc.github.io/posts/linux/linux-shell-code-example/","wordcount":1491},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了下正则表达式的常用规则，并收集些常用的正则表达式。\u003c/p\u003e\n\u003ch3 id=\"特殊字符\"\u003e特殊字符\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e^：以某个字符串开头，^a，匹配以 a 开头的字符串，^abc，匹配以 abc 开头的字符串。\u003c/li\u003e\n\u003cli\u003e*：表示 * 前面的一个字符可以重复任意多次。\u003c/li\u003e\n\u003cli\u003e.：可以表示任意一个字符。\u003c/li\u003e\n\u003cli\u003e$：以某个字符串结尾，a$，匹配以 a 结尾的字符串，abc$，匹配以 abc 结尾的字符串。\u003c/li\u003e\n\u003cli\u003e?：使用非贪婪匹配模式，从左向右匹配字符串。\u003c/li\u003e\n\u003cli\u003e+：表示 + 号前面的字符至少出现一次。\u003c/li\u003e\n\u003cli\u003e{2}：表示前面的字符恰好出现两次。\u003c/li\u003e\n\u003cli\u003e{2,}：表示前面的字符出现两次以上。\u003c/li\u003e\n\u003cli\u003e{2,5}：表示前面的字符出现 2~5 次。\u003c/li\u003e\n\u003cli\u003e|：表示多个匹配模式之间或的关系。\u003c/li\u003e\n\u003cli\u003e[]：[abcd]，表示匹配一个字符，该字符为 a，b，c，d 中的一个。\n[1~9]，表示匹配一个字符，该字符为 1~9 之中的一个。\n[^1]，表示匹配一个字符，该字符不是 1。\u003c/li\u003e\n\u003cli\u003e\\s: 表示匹配一个空格。\u003c/li\u003e\n\u003cli\u003e\\S：表示匹配一个非空格。\u003c/li\u003e\n\u003cli\u003e\\w：表示匹配一个字符，模式等同于：[a~zA~Z0~9_]。\u003c/li\u003e\n\u003cli\u003e\\W：表示匹配一个字符，该字符不在模式 [a~zA~Z0~9_] 之中。\u003c/li\u003e\n\u003cli\u003e[\\u4E00-\\u9FA5]：匹配一个汉字。\u003c/li\u003e\n\u003cli\u003e\\d：匹配数字\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"常用正则表达式\"\u003e常用正则表达式\u003c/h3\u003e\n\u003cp\u003e1）邮箱\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）域名\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(/.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+/.?\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）IP\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e((?:(?:25[0-5]|2[0-4]\\\\d|[01]?\\\\d?\\\\d)\\\\.){3}(?:25[0-5]|2[0-4]\\\\d|[01]?\\\\d?\\\\d))\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4）电话号码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d{8}$\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5）URL\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[a-zA-z]+://[^\\s]* 或 ^http://([\\w-]+\\.)+[\\w-]+(/[\\w-./?%\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e=]*)?$\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1512777600,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1515456000,"objectID":"cfb59cf493146ac46b321dd58117c5c8","publishdate":1512777600,"relpermalink":"/posts/programming/common/regular-expression/","section":"posts","summary":"\u003cp\u003e本篇博客记录了下正则表达式的常用规则，并收集些常用的正则表达式。\u003c/p\u003e","tags":["正则表达式"],"title":"正则表达式规则及常用正则表达式总结","url":"https://xdhuxc.github.io/posts/programming/common/regular-expression/","wordcount":495},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了版本控制管理工具 SVN 的安装，配置和使用。\u003c/p\u003e\n\u003ch3 id=\"svn-安装和配置\"\u003eSVN 安装和配置\u003c/h3\u003e\n\u003ch4 id=\"安装-svn-服务器\"\u003e安装 \u003ccode\u003esvn\u003c/code\u003e 服务器\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y subversion\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"查看版本\"\u003e查看版本\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esvnserve --version\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e输出如下：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG651.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003ch4 id=\"创建版本库\"\u003e创建版本库\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /root/svn   \u003cspan class=\"ni\"\u003e#创建svn仓库目录\u003c/span\u003e\nsvnadmin create /root/svn/xdhuxc  \u003cspan class=\"ni\"\u003e#使用svn管理员创建xdhuxc库\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看库中的文件\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG652.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e出现上图中的文件，说明svn代码库已经创建成功。\nSubversion目录说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edb：所有版本控制的数据存放文件\u003c/li\u003e\n\u003cli\u003ehooks：放置hook脚本文件的目录\u003c/li\u003e\n\u003cli\u003elocks：用来放置subversion建库锁定数据的目录，用来追踪存取文件库的客户端\u003c/li\u003e\n\u003cli\u003eformat：是一个文本文件，里面只放了一个整数，表示当前文件库配置的版本号\u003c/li\u003e\n\u003cli\u003econf：是这个仓库的配置文件（仓库的用户访问账号、权限等）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e进入conf目录，该目录存放当前svn版本库的配置文件：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eauthz：权限控制文件\u003c/li\u003e\n\u003cli\u003epasswd：账号密码文件\u003c/li\u003e\n\u003cli\u003esvnserve.conf：SVN服务配置文件\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"subversion-配置\"\u003esubversion 配置\u003c/h4\u003e\n\u003cp\u003e1、设置账号密码\u003c/p\u003e\n\u003cp\u003e修改 \u003ccode\u003econf/passwd\u003c/code\u003e 文件，在 \u003ccode\u003e[users]\u003c/code\u003e 块中添加用户和密码，格式为：username=password\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG653.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e2、设置权限\u003c/p\u003e\n\u003cp\u003e修改conf/authz文件，在末尾添加如下内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[/] \u003cspan class=\"ni\"\u003e#指定svn仓库目录\u003c/span\u003e，[/]代表根目录\nxdhuxc=rw  # 用户xdhuxc的权限，r：读；w：写\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG654.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e3、修改 \u003ccode\u003esvnserve.conf\u003c/code\u003e 文件\u003c/p\u003e\n\u003cp\u003e打开下面几个注释：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eanon-access = read # 匿名用户可读\nauth-access = write # 授权用户可写\npassword-db = passwd # 使用哪个文件作为账号文件\nauthz-db = authz # 使用哪个文件作为权限文件\nrealm = /root/svn/xdhuxc # 认证空间名，版本库所在目录\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意，红色箭头指向的参数，全部要定格写，即前面不能有空格\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG655.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003ch4 id=\"启动-svn-版本库\"\u003e启动 svn 版本库\u003c/h4\u003e\n\u003cp\u003e启动 \u003ccode\u003esvn\u003c/code\u003e 版本库，并查看 \u003ccode\u003esvn\u003c/code\u003e 服务是否开启，默认监听在 \u003ccode\u003e3690\u003c/code\u003e 端口\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esvnserve -d -r /root/svn/xdhuxc\nps -ef|grep svn\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-d：表示后台运行svn服务\u003c/li\u003e\n\u003cli\u003e-r：指定svn目录\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"停止-svn-命令\"\u003e停止 svn 命令\u003c/h4\u003e\n\u003cp\u003e使用如下命令停止 svn 服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekillall svnserve\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"svn-使用\"\u003esvn 使用\u003c/h3\u003e\n\u003cp\u003e1、下载并安装 \u003ccode\u003eTorwoiseSVN\u003c/code\u003e 测试\u003c/p\u003e\n\u003cp\u003e2、创建空目录 \u003ccode\u003exdhuxc-svn\u003c/code\u003e，右键并选择 \u003ccode\u003eSVN Checkout\u003c/code\u003e，\u003ccode\u003echeckout\u003c/code\u003e 就是把 \u003ccode\u003eSVN\u003c/code\u003e 服务器上的文件下载到本地工作目录内的操作，输入 \u003ccode\u003eSVN\u003c/code\u003e 服务器地址，导出文件存放目录 \u003ccode\u003exdhuxc-svn\u003c/code\u003e，点击 \u003ccode\u003eOK\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG656.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e第一次登陆时，需要输入认证信息 \u003ccode\u003exdhuxc/Xdhuxc1994\u003c/code\u003e，点击 \u003ccode\u003eOK\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG657.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e如果不是空目录，就会出现下图的提示框，选择 \u003ccode\u003eCheckout\u003c/code\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG658.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e登录成功后便可以在该工作目录里进行编辑或创建文件，操作完成后对该目录右键，选择 \u003ccode\u003eCheck commit\u003c/code\u003e 提交，这个操作等于是上传到 \u003ccode\u003eSVN\u003c/code\u003e 服务器\u003c/p\u003e\n\u003cp\u003e3、添加新文件\u003c/p\u003e\n\u003cp\u003e将文件拖放至xdhuxc-svn目录下，右键，选择“TortoiseSVN”，选择“Repo browser”，右键点击“svn://192.168.91.128”，点击“Add file”\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG659.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n选择要添加的文件 `abc.txt`，点击 `打开`\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG660.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n输入提交信息，点击 `OK`\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG661.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n可到 `linux` 服务器下验证提交结果。\n\u003ch3 id=\"svn-命令行\"\u003eSVN 命令行\u003c/h3\u003e\n\u003cp\u003e1、使用Linux的SVN命令进行checkout操作\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esvn checkout svn://192.168.91.128 /svndir\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e第一次使用checkout命令时，需要输入用户名和密码，以后就不用输入用户名和密码了\n/svndir为svn仓库文件保存目录\ncheckout下来的文件夹放到本地就叫做working copy，里面带着.svn目录，该目录是本地文件与svn服务器的连接文件，在这个目录里才能进行svn操作。svn添加文件，要先把要添加的文件放到working copy相应的目录下，执行add，再commit即可。\u003c/p\u003e\n\u003cp\u003e2、创建一个文件并添加至SVN\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecd /svndir\ntouch xyz.txt ; echo \u0026#34;XYZ\u0026#34; \u0026gt;\u0026gt; xyz.txt ; cat xyz.txt\nsvn add xyz.txt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG662.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e3、提交该文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esvn commit -m \u0026#34;XYZ commit\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG663.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e4、更新本地仓库文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esvn up\n或\nsvn update\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如下图所示：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG664.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003ch3 id=\"常见问题及解决\"\u003e常见问题及解决\u003c/h3\u003e\n\u003cp\u003e1、点击 \u003ccode\u003eCheckout\u003c/code\u003e 后，报错如下：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/tools/svn/WechatIMG665.jpeg\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e原因：\u003ccode\u003eCentOS 7\u003c/code\u003e 默认不对外开放 \u003ccode\u003e3690\u003c/code\u003e 端口，因此，开放防火墙 \u003ccode\u003e3690\u003c/code\u003e 端口，重启防火墙即可\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -I INPUT -p tcp --dport 3690 -j ACCEPT\nsystemctl restart iptables\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1512604800,"description":"","fuzzywordcount":1500,"kind":"page","lang":"zh","lastmod":1513468800,"objectID":"d3043a8a64c1d22ce706f1b84fa23cc4","publishdate":1512604800,"relpermalink":"/posts/tools/tools-svn/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了版本控制管理工具 SVN 的安装，配置和使用。\u003c/p\u003e","tags":["SVN"],"title":"SVN 的安装，配置和使用","url":"https://xdhuxc.github.io/posts/tools/tools-svn/","wordcount":1456},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了些 \u003ccode\u003eWindows\u003c/code\u003e 系统中常用的命令，在 \u003ccode\u003eWindows\u003c/code\u003e 系统中进行命令行操作时，会用到。\u003c/p\u003e\n\u003cp\u003e1、查看系统 \u003ccode\u003eBIOS\u003c/code\u003e 创建时间：\u003ccode\u003eWMIC BIOS get releasedate\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ WMIC BIOS get releasedate\nReleaseDate\n20140210000000.000000+000\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、调出Windows服务窗口：\u003ccode\u003eservices.msc\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e3、使用Windows自带的计算器：\u003ccode\u003ecalc\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e4、Windows自带的远程桌面连接命令：\u003ccode\u003emstsc\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e5、查看本机IP地址和MAC地址：\u003ccode\u003eipconfig /all\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e6、查看当前正在运行的进程：\u003ccode\u003etasklist\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e7、强制杀死进程ID为process_id的进程：\u003ccode\u003etaskkill /pid process_id -f\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e8、命令行启动或停止服务：\u003ccode\u003enet start/stop service_name\u003c/code\u003e\n例如，启动 \u003ccode\u003eMySQL\u003c/code\u003e 服务，使用命令为：\u003ccode\u003enet start mysql57\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e9、查看端口占用：\u003ccode\u003enetstat -ano|findstr \u0026quot;8080\u0026quot;\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ netstat -ano|findstr \u0026#34;8080\u0026#34;\n  TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING       8552\n  TCP    10.4.100.48:49235      192.168.8.81:8080      CLOSE_WAIT      1584\n  TCP    10.4.100.48:49653      10.10.24.177:8080      ESTABLISHED     7428\n  TCP    10.4.100.48:49655      10.10.24.177:8080      ESTABLISHED     7428\n  TCP    10.4.100.48:49657      10.10.24.177:8080      ESTABLISHED     7428\n  TCP    [::]:8080              [::]:0                 LISTENING       8552\n  TCP    [::1]:51102            [::1]:8080             TIME_WAIT       0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e10、查找某个进程：\u003ccode\u003etasklist|findstr \u0026quot;bash.exe\u0026quot;\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ tasklist|findstr \u0026#34;bash\u0026#34;\ngit-bash.exe                  9820 Console                    1      2,912 K\nbash.exe                     10064 Console                    1      8,784 K\nbash.exe                      7736 Console                    1      6,100 K\nbash.exe                      9400 Console                    1      6,068 K\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e11、查看Windows版本和激活的过期时间\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eslmgr.vbs -xpr\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e12、下载文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003estart powershell\n$client = new-object System.Net.WebClient\n$client.DownloadFile(\u0026#39;http://101.36.79.71:8081/IXC3470347d25cba57732165d795bb3beb6/sw-search-sp/software/1334d9c2b2fb7/ChromeStandalone_66.0.3359.139_Setup.exe\u0026#39;, \u0026#39;C:\\Users\\wanghuan\\Desktop\\ChromeStandalone_66.0.3359.139_Setup.exe\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e13、删除命令\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edel /S abc：递归地删除文件夹 abc 及其之下的文件，但是删除每个文件时均需要确认。\u003c/li\u003e\n\u003cli\u003edel abc.txt：删除文件 abc.txt。\u003c/li\u003e\n\u003cli\u003edel /Q：删除文件时采用安静模式。删除全局通配符时，不要求确认。\u003c/li\u003e\n\u003cli\u003erd abc：删除空文件夹 abc\u003c/li\u003e\n\u003cli\u003erd /s abc：删除文件夹 abc 及其所有子文件夹和文件\u003c/li\u003e\n\u003cli\u003erd /s/q abc：强制删除文件夹及所有子文件夹和文件，不需要确认。\u003c/li\u003e\n\u003c/ul\u003e","date":1511308800,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1511654400,"objectID":"1e190e6b7df8551a5091b8fe7e0b2d84","publishdate":1511308800,"relpermalink":"/posts/mixed/windows-command-line/","section":"posts","summary":"\u003cp\u003e本篇博客记录了些 \u003ccode\u003eWindows\u003c/code\u003e 系统中常用的命令，在 \u003ccode\u003eWindows\u003c/code\u003e 系统中进行命令行操作时，会用到。\u003c/p\u003e","tags":["Windows"],"title":"Windows 常用命令总结","url":"https://xdhuxc.github.io/posts/mixed/windows-command-line/","wordcount":591},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了 iptables 常用命令，对于运维人员，会经常需要用到。\u003c/p\u003e\n\u003ch3 id=\"linux-防火墙简介\"\u003eLinux 防火墙简介\u003c/h3\u003e\n\u003cp\u003e防火墙是用于实现 \u003ccode\u003eLinux\u003c/code\u003e 下访问控制功能的，分为硬件防火墙或者软件防火墙两种。任何一个网络中，防火墙工作的地方一定是在网络的边缘。\u003c/p\u003e\n\u003cp\u003e我们的任务就是去定义防火墙如何去工作，这就是防火墙的策略、规则，以达到让它对出入网络的IP、数据进行检测。\u003c/p\u003e\n\u003cp\u003e目前市面上比较常见的有三层、四层的防火墙，叫做\u003ccode\u003e网络层防火墙\u003c/code\u003e；还有七层的防火墙，其实就是\u003ccode\u003e代理层的网关\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e对于 TCP/IP 的七层模型来说，\u003ccode\u003e第三层是网络层\u003c/code\u003e，三层的防火墙会在这层\u003ccode\u003e对源地址和目标地址\u003c/code\u003e进行检测。而对于\u003ccode\u003e七层的防火墙\u003c/code\u003e，不论\u003ccode\u003e源端口或者目的端口，源地址或者目的地址\u003c/code\u003e是什么，都将对\u003ccode\u003e所有的东西进行检查\u003c/code\u003e。所以，从设计原理上来讲，七层防火墙更加安全，但是却带来了低效率。所以，市面上通常用的防火墙方案，都是两者结合的。又由于我们需要从防火墙所控制的这个口来访问，所以防火墙的工作效率就成了用户能够访问数据多少的一个最重要的控制，配置不好甚至有可能成为流量的瓶颈。\u003c/p\u003e\n\u003ch3 id=\"iptables\"\u003eiptables\u003c/h3\u003e\n\u003cp\u003eiptables 是 \u003ccode\u003eunix/linux\u003c/code\u003e 自带的基于包过滤的防火墙工具，可以对流入和流出服务器的数据包进行很精细的控制。iptables 主要工作在 OSI 中的二、三、四层。\u003c/p\u003e\n\u003ch4 id=\"iptables-术语\"\u003eiptables 术语\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e容器：用来形容包含或者所属的关系。\u003ccode\u003eNetfilter/iptables\u003c/code\u003e 是表的容器，\u003ccode\u003eiptables\u003c/code\u003e 包含着各个表；而 \u003ccode\u003eiptables\u003c/code\u003e 的表又是链的容器。\u003c/li\u003e\n\u003cli\u003e链（chains）：\u003ccode\u003eINPUT\u003c/code\u003e、\u003ccode\u003eOUTPUT\u003c/code\u003e、\u003ccode\u003eFORWARD\u003c/code\u003e、\u003ccode\u003ePREROUTING\u003c/code\u003e、\u003ccode\u003ePOSTRROUTING\u003c/code\u003e，链是规则的容器。\u003c/li\u003e\n\u003cli\u003e规则（Policy）：一条条过滤的语句规则。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"filter-表\"\u003efilter 表\u003c/h4\u003e\n\u003cp\u003e主要和主机自身有关，真正负责主机防火墙功能，过滤流入流出主机的数据包。filter表是iptables默认使用的表。这个表定义了三个链（Chains）：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eINPUT：负责过滤所有目标地址是主机地址的数据包，即，过滤进入主机的数据包。\u003c/li\u003e\n\u003cli\u003eFORWARD：负责转发流经主机的数据包，起转发的作用，和Nat关系很大。LVS NAT 模式，net.ipv4_forward = 1。\u003c/li\u003e\n\u003cli\u003eOUTPUT：处理所有源地址是本机地址的数据包，即，处理从主机发出去的数据包。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"nat-表\"\u003enat 表\u003c/h4\u003e\n\u003cp\u003enat表负责网络地址转换，即来源与目的IP地址和端口的转换。一般用于局域网共享上网或者特殊的端口转换服务相关。\u003c/p\u003e\n\u003cp\u003e这个表定义了三个链（Chain），nat功能就相当于网络的ACL控制，和网络交换机ACL类似。（访问控制列表（Access Control List，ACL），是路由器和交换机接口的指令列表，用来控制端口进出的数据包）\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOUTPUT：和主机发出去的数据包有关，改变主机发出数据包的目标地址。\u003c/li\u003e\n\u003cli\u003ePREROUTING：在数据包到达防火墙时进行路由判断之前执行的规则，作用是改变数据包的目的地址、目的端口等。\u003c/li\u003e\n\u003cli\u003ePOSTROUTING：在数据包离开防火墙时进行路由判断之后执行的规则，作用是改变数据包的源地址、源端口等。例如，我们的虚拟机都是192.168.30.0/16，就是出网的时候被我们的企业路由器把源地址改成了公网地址了。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eiptables命令选项输入顺序：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -t 表名 \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e-A\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003eI\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003eD\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003eR\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e 规则链名 [规则号] \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e-i\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003eo\u003c/span\u003e \u003cspan class=\"na\"\u003e网卡名\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e -p 协议名 \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e-s\u003c/span\u003e \u003cspan class=\"na\"\u003e源IP\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003e源子网\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e --sport 源端口 \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e-d\u003c/span\u003e \u003cspan class=\"na\"\u003e目标IP\u003c/span\u003e\u003cspan class=\"err\"\u003e/\u003c/span\u003e\u003cspan class=\"na\"\u003e目标子网\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e --dport 目标端口 -j 动作\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e选项如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-A：向规则链中添加条目。\u003c/li\u003e\n\u003cli\u003e-D：从规则链中删除条目。\u003c/li\u003e\n\u003cli\u003e-i：向规则链中插入条目。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e表名包括：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eraw：高级功能，如、网址过滤。\u003c/li\u003e\n\u003cli\u003emangle：数据包修改，用于实现服务质量。\u003c/li\u003e\n\u003cli\u003enet：网络地址转换，用于网关路由器。\u003c/li\u003e\n\u003cli\u003efilter：包过滤，用于防火墙规则。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e规则链名包括：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eINPUT：处理输入数据包。\u003c/li\u003e\n\u003cli\u003eOUTPUT：处理输出数据包。\u003c/li\u003e\n\u003cli\u003eFORWARD：处理转发数据包。\u003c/li\u003e\n\u003cli\u003ePREROUTING：用于目标地址转换（DNAT）\u003c/li\u003e\n\u003cli\u003ePOSTROUTING：用于源地址转换（SNAT）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e动作：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eACCEPT：接收数据包。\u003c/li\u003e\n\u003cli\u003eDROP：丢弃数据包。\u003c/li\u003e\n\u003cli\u003eREDIRECT：重定向、映射、透明代理。\u003c/li\u003e\n\u003cli\u003eSNAT：源地址转换。\u003c/li\u003e\n\u003cli\u003eDNAT：目标地址转换。\u003c/li\u003e\n\u003cli\u003eLOG：日志记录。\u003c/li\u003e\n\u003cli\u003eMASQUERADE：IP伪装（NAT），用于ADSL。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"常用命令\"\u003e常用命令\u003c/h4\u003e\n\u003cp\u003e1、清理已有 iptables 规则\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -F\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、开放指定的端口\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -A OUTPUT -j ACCEPT                                                     # 允许所有本机向外的访问。\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT                 # 允许已建立的或相关联的通行。\niptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT        # 允许访问本机22端口\niptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 7000:8000 -j ACCEPT # 开放 7000-8000 之间的所有端口\niptables -A INPUT -p tcp -m state --state NEW -m tcp --dport :7000 -j ACCEPT     # 开放 7000 及其以下的所有端口\niptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 8000: -j ACCEPT     # 开放 8000 及其以上的所有端口\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、屏蔽 IP\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -I INPUT -s 123.45.6.7 -j DROP    # 屏蔽单个IP的命令\niptables -I INPUT -s 123.0.0.0/8 -j DROP   # 屏蔽整个123.0.0.0/8网段的所有数据包，即从123.0.0.1到123.255.255.254的IP全部封杀掉。\niptables —I INPUT -s 124.45.0.0/16 -j DROP # 屏蔽整个124.45.0.0/16网段的所有数据包，即从123.45.0.1到123.45.255.254的IP全部封杀掉。\niptables -I INPUT -s 123.45.6.0/24 -j DROP # 屏蔽整个123.45.6.0/24网段的所有数据包，即从123.45.6.1到123.45.6.254的所有数据包，\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、开启防火墙22端口\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eiptables -I INPUT -p tcp --dport 22 -j accept\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、查看防火墙状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo systemctl status firewalld.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、停止防火墙\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo systemctl stop firewalld.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、停止开机自动启动\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo systemctl disable firewalld.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"docker-bridge-网络模式防火墙配置\"\u003edocker bridge 网络模式防火墙配置\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e以bridge网络模式运行Docker容器需要的防火墙配置\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e*nat\n:PREROUTING ACCEPT [27:11935]\n:INPUT ACCEPT [0:0]\n:OUTPUT ACCEPT [598:57368]\n:POSTROUTING ACCEPT [591:57092]\n:DOCKER - [0:0]\n-A PREROUTING -m addrtype --dst-type LOCAL -j DOCKER\n-A OUTPUT ! -d 127.0.0.0/8 -m addrtype --dst-type LOCAL -j DOCKER\n-A POSTROUTING -s 172.17.0.0/16 ! -o docker0 -j MASQUERADE \u003cspan class=\"ni\"\u003e#docker网桥的子网\u003c/span\u003e\n-A POSTROUTING -j MASQUERADE\nCOMMIT\n\u003cspan class=\"gh\"\u003e# Completed on Sun Sep 20 17:35:31 2015\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# Generated by iptables-save v1.4.21 on Sun Sep 20 17:35:31 2015\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e*filter\n:INPUT ACCEPT [139291:461018923]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [127386:5251162]\n:DOCKER - [0:0]\n-A FORWARD -o docker0 -j DOCKER\n-A FORWARD -o docker0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\n-A FORWARD -i docker0 ! -o docker0 -j ACCEPT\n-A FORWARD -i docker0 -o docker0 -j ACCEPT\nCOMMIT\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://man.linuxde.net/iptables\"\u003ehttp://man.linuxde.net/iptables\u003c/a\u003e\u003c/p\u003e","date":1510012800,"description":"","fuzzywordcount":2400,"kind":"page","lang":"zh","lastmod":1512604800,"objectID":"10229ee3de1d6007af8f59da84fe3c8b","publishdate":1510012800,"relpermalink":"/posts/linux/linux-firewall/","section":"posts","summary":"\u003cp\u003e本篇博客记录了 iptables 常用命令，对于运维人员，会经常需要用到。\u003c/p\u003e","tags":["Linux","iptables"],"title":"Linux 下 iptables 常用命令","url":"https://xdhuxc.github.io/posts/linux/linux-firewall/","wordcount":2301},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了基于源代码和 docker 容器方式部署 nginx 的方法。\u003c/p\u003e\n\u003ch3 id=\"基于源码安装-nginx\"\u003e基于源码安装 nginx\u003c/h3\u003e\n\u003cp\u003e1、下载 nginx安装包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e wget http://nginx.org/download/nginx-1.15.2.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、安装如下软件包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum -y install pcre pcre-devel openssl openssl-devel\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、编译并安装nginx\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./configure \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e make install\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、检测nginx是否安装成功\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewhereis nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"基于-docker-容器部署-nginx\"\u003e基于 docker 容器部署 nginx\u003c/h3\u003e\n\u003ch4 id=\"最简单的使用方法\"\u003e最简单的使用方法\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -it -p 80:80 --name nginx nginx:latest\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在浏览器地址栏中输入：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e192.168.91.128:80\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e即可访问 nginx 欢迎页面\u003c/p\u003e\n\u003ch4 id=\"在后台运行-nginx-容器\"\u003e在后台运行 nginx 容器\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d -p 80:80 --name nginx nginx:latest\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果不加端口映射，能启动容器，但是在终端和浏览器中无法访问，可能是没有默认配置或者默认配置没起作用。\u003c/p\u003e\n\u003ch4 id=\"使用自定义配置文件启动-nginx-容器\"\u003e使用自定义配置文件启动 nginx 容器\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileded=true \\\n    -p 80:80\n    -v /home/xdhuxc/nginx/logs:/var/log/nginx\n    -v /home/xdhuxc/nginx/nginx.conf:/etc/nginx/nginx.conf:rw\n    --name nginx\n    nginx:latest\n    \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e/etc/nginx/nginx.conf 为容器内 nginx 的配置文件，ro 是 readonly 的意思\u003c/p\u003e\n\u003ch3 id=\"nginx-常用命令\"\u003enginx 常用命令\u003c/h3\u003e\n\u003cp\u003e1、检测nginx配置文件 nginx.conf 格式是否正确\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enginx -t\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、重新加载 nginx 配置文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enginx -s reload\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、重启 nginx\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enginx -s reopen\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、停止 nginx\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enginx -s stop\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003eNginx中文文档 \u003ca href=\"http://www.nginx.cn/doc/\"\u003ehttp://www.nginx.cn/doc/\u003c/a\u003e\u003c/p\u003e","date":1508976000,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1509235200,"objectID":"ff7884565bed3929276d89a976e48dc2","publishdate":1508976000,"relpermalink":"/posts/mixed/nginx/nginx-install/","section":"posts","summary":"\u003cp\u003e本篇博客记录了基于源代码和 docker 容器方式部署 nginx 的方法。\u003c/p\u003e","tags":["Nginx"],"title":"安装 nginx","url":"https://xdhuxc.github.io/posts/mixed/nginx/nginx-install/","wordcount":346},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在 Linux 系统中常见的问题及解决方法，以备后查。\u003c/p\u003e\n\u003cp\u003e1、从 Mac 的终端中 scp VirtualBox 虚拟机中的文件时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewanghuans-MacBook-Pro:clickhouse_exporter wanghuan$ scp root@192.168.33.10:/vagrant/clickhouse_exporter ./\nroot@192.168.33.10: Permission denied (publickey,gssapi-keyex,gssapi-with-mic).\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：在虚拟机内部，修改 /etc/ssh/sshd_config 文件中如下参数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ePermitRootLogin yes\nPasswordAuthentication yes\nPubkeyAuthentication yes\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后重启虚拟机内 sshd 服务。\u003c/p\u003e\n\u003cp\u003e2、wget: unable to resolve host address\n问题：DNS解析的问题\n将以下内容加入\u003ccode\u003e/etc/resolv.conf\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enameserver 8.8.8.8 \u003cspan class=\"ni\"\u003e#google域名服务器\u003c/span\u003e\nnameserver 8.8.4.4 \u003cspan class=\"ni\"\u003e#google域名服务器\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、使用 \u003ccode\u003eLinux\u003c/code\u003e 服务启动 \u003ccode\u003econfd\u003c/code\u003e 进程，启动时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eMar 18 02:26:38 ip-172-27-124-70.ap-southeast-1.compute.internal confd[28240]: 2019-03-18T02:26:38Z ip-172-27-124-70.ap-southeast-1.compute.internal /usr/bin/confd[28240]: FATAL UserHomeNotFound: user home directory not found.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\n在 \u003ccode\u003econfd.service\u003c/code\u003e （\u003ccode\u003e/usr/lib/systemd/system/confd.service\u003c/code\u003e）中加入如下环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Service]\nEnvironment=\u0026#34;HOME=/root\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 \u003ccode\u003econfd\u003c/code\u003e 服务即可。\u003c/p\u003e\n\u003cp\u003e4、在 \u003ccode\u003eLinux\u003c/code\u003e 下执行脚本，报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# ./install.sh -h\n-bash: ./install.sh: /bin/bash^M: bad interpreter: No such file or directory\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：安装dos2unix，将DOS格式文本文件转换成Unix格式，使用如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y dos2unix\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用方法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edos2unix filename_1 filename_2 filename_3\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、使用curl命令从网络上下载文件时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl -L https://github.com/docker/compose/releases/download/1.21.2/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:--  0:00:05 --:--:--     0\ncurl: (35) Peer reports incompatible or unsupported protocol version.\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e（1）更新curl\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum update -y curl\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e更新curl后还是报一样的错误\u003c/p\u003e\n\u003cp\u003e（2）更新nss nspr\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum update -y nss nspr nss-util\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e更新后问题得到解决。\u003c/p\u003e\n\u003cp\u003e仅更新（1）和仅更新（2）都不起作用\u003c/p\u003e\n\u003cp\u003e6、\u003ccode\u003eCentOS 7\u003c/code\u003e 虚拟机有网卡，没有 \u003ccode\u003eIP\u003c/code\u003e 地址，进入 \u003ccode\u003e/etc/sysconfig/network-scripts\u003c/code\u003e 目录下，修改 \u003ccode\u003eifcfg-eth0\u003c/code\u003e 文件\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/linux/questions-and-solutions/WechatIMG622.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e将其中的 \u003ccode\u003eONBOOT\u003c/code\u003e 修改为 \u003ccode\u003eyes\u003c/code\u003e，然后使用 \u003ccode\u003esystemctl restart network\u003c/code\u003e 命令重启网络\u003c/p\u003e\n\u003cp\u003e注意：启动 \u003ccode\u003eWindows\u003c/code\u003e 下 \u003ccode\u003eVMware\u003c/code\u003e 相关的服务\u003c/p\u003e\n\u003cp\u003e7、使用SSH无法登陆服务器，VNC操作命令提示“fork:cannot allocate memory”，或者，在已经登录至该服务器上的终端中执行命令，所有命令均无法执行，一直提示如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# free -h\nbash: fork: Cannot allocate memory\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看最大进程数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost /]# sysctl kernel.pid_max\nkernel.pid_max = 32768\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看进程数\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# ps -eLf | wc -l\n1011\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e1）修改最大进程数，即时生效\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho 1000000 \u0026gt; /proc/sys/kernel/pid_max\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）永久生效的方式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho \u0026#34;kernel.pid_max=1000000 \u0026#34; \u0026gt;\u0026gt; /etc/sysctl.conf\nsysctl -p\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1508630400,"description":"","fuzzywordcount":800,"kind":"page","lang":"zh","lastmod":1508630400,"objectID":"aaede6b8ceaabf29a4277608ca381526","publishdate":1508630400,"relpermalink":"/posts/linux/linux-questions-and-solution/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在 Linux 系统中常见的问题及解决方法，以备后查。\u003c/p\u003e","tags":["Linux"],"title":"Linux 中常见问题及解决","url":"https://xdhuxc.github.io/posts/linux/linux-questions-and-solution/","wordcount":767},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了使用 docker 容器部署 nexus 的方法。\u003c/p\u003e\n\u003ch3 id=\"nexus-2\"\u003eNexus 2\u003c/h3\u003e\n\u003cp\u003e1、拉取Nexus镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull sonatype/nexus:2.14.5\n或\ndocker pull sonatype/nexus:oss\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动Nexus\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d -p 8081:8081 --name nexus sonatype/nexus:2.14.5\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、持久化数据时容器启动方式\u003c/p\u003e\n\u003cp\u003e创建数据目录并更改该目录的所有者，原因见其Dockerfile\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /home/xdhuxc/nexus/data \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e chown -R 200 /home/xdhuxc/nexus/data \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -p 8081:8081 \\\n    -v /home/xdhuxc/nexus/data:/sonatype-work \\\n    --name nexus \\\n    sonatype/nexus:2.14.5\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e配置文件目录：\u003ccode\u003e/sonatype-work/conf/nexus.xml\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e测试Nexus是否可访问\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl -u admin:admin123 http://localhost:8081/service/metrics/ping\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、目前，还没有找到方法将配置好的nexus.xml固化到nexus镜像中，采取的方式是：先挂载数据目录启动nexus容器，然后替换本地/home/xdhuxc/nexus/data/conf/nexus.xml文件，重启nexus容器。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -p 8081:8081 \\\n    -v /data/nexus/data:/sonatype-work \\\n    --name nexus \\\n    sonatype/nexus:2.14.5\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"相关问题\"\u003e相关问题\u003c/h3\u003e\n\u003cp\u003e1、启动nexus容器时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e2018-01-04 06:07:57,156+0000 WARN  [jetty-main-1]  org.sonatype.nexus.util.LockFile - Failed to write lock file\njava.io.FileNotFoundException: /sonatype-work/nexus.lock (Permission denied)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：根据 dockerhub 的步骤，更改数据目录的所有者，原因见Dockerfile。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir /data/nexus/data \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e chown -R 200 /data/nexus/data\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重新启动容器即可。\u003c/p\u003e","date":1508630400,"description":"","fuzzywordcount":500,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"b10ca823e50c7fb972db5eb11c2af590","publishdate":1508630400,"relpermalink":"/posts/mixed/nexus/nexus-docker/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了使用 docker 容器部署 nexus 的方法。\u003c/p\u003e","tags":["Nexus","Docker"],"title":"基于 docker 容器部署 Nexus","url":"https://xdhuxc.github.io/posts/mixed/nexus/nexus-docker/","wordcount":427},{"categories":"posts","content":"\u003cp\u003e本篇博客整理了一些使用 docker 的过程中经常使用的参数的配置，对于 docker 进阶使用会非常有帮助。\u003c/p\u003e\n\u003ch3 id=\"配置文件\"\u003e配置文件\u003c/h3\u003e\n\u003ch4 id=\"dockerservice\"\u003edocker.service\u003c/h4\u003e\n\u003cp\u003e1、\u003ccode\u003edocker.service\u003c/code\u003e 文件路径\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e/usr/lib/systemd/system/docker.service\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、\u003ccode\u003edocker.service\u003c/code\u003e 文件内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Unit]\nDescription=Docker Application Container Engine\nDocumentation=http://docs.docker.com\nAfter=network.target\nWants=docker-storage-setup.service\nRequires=docker-cleanup.timer\n\n[Service]\nType=notify\nNotifyAccess=all\nEnvironmentFile=-/run/containers/registries.conf\nEnvironmentFile=-/etc/sysconfig/docker\nEnvironmentFile=-/etc/sysconfig/docker-storage\nEnvironmentFile=-/etc/sysconfig/docker-network\nEnvironment=GOTRACEBACK=crash\nEnvironment=DOCKER_HTTP_HOST_COMPAT=1\nEnvironment=PATH=/usr/libexec/docker:/usr/bin:/usr/sbin\nExecStart=/usr/bin/dockerd-current \\\n          --add-runtime docker-runc=/usr/libexec/docker/docker-runc-current \\\n          --default-runtime=docker-runc \\\n          --exec-opt native.cgroupdriver=systemd \\\n          --userland-proxy-path=/usr/libexec/docker/docker-proxy-current \\\n          $OPTIONS \\\n          $DOCKER_STORAGE_OPTIONS \\\n          $DOCKER_NETWORK_OPTIONS \\\n          $ADD_REGISTRY \\\n          $BLOCK_REGISTRY \\\n          $INSECURE_REGISTRY\\\n      $REGISTRIES\nExecReload=/bin/kill -s HUP $MAINPID\nLimitNOFILE=1048576\nLimitNPROC=1048576\nLimitCORE=infinity\nTimeoutStartSec=0\nRestart=on-abnormal\nMountFlags=slave\nKillMode=process\n\n[Install]\nWantedBy=multi-user.target\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、启动 docker 时各参数的含义\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e参数\u003c/th\u003e\n\u003cth\u003e含义\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e-g，--graph=“/var/lib/docker”\u003c/td\u003e\n\u003ctd\u003e设置docker的运行时根目录\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-s，--storage-driver=“devicemapper”\u003c/td\u003e\n\u003ctd\u003e设置容器运行时使用指定的存储驱动为devicemapper\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e--insecure-registry 0.0.0.0/0\u003c/td\u003e\n\u003ctd\u003e允许不安全的仓库连接\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e--registry-mirror xdhuxc.docker.com\u003c/td\u003e\n\u003ctd\u003e配置镜像加速地址\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e4、docker 的日志文件写入写入到 \u003ccode\u003e/var/log/message\u003c/code\u003e 文件中，查看的命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etail -f /var/log/message | grep docker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejournalctl -fu docker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、Docker默认空间大小分为两个，一个是池空间大小，默认为100G；另一个是容器空间大小，默认为10G。\u003c/p\u003e\n\u003ch3 id=\"常用配置\"\u003e常用配置\u003c/h3\u003e\n\u003ch4 id=\"限制日志文件大小和保留文件个数\"\u003e限制日志文件大小和保留文件个数\u003c/h4\u003e\n\u003cp\u003e在 \u003ccode\u003edocker run\u003c/code\u003e 命令中增加如下参数，限制生成的 \u003ccode\u003ejson.log\u003c/code\u003e 单个文件大小和保留文件个数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -it --log-opt max-size=100m --log-opt max-file=3 nginx:latest\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003edocker-compose.yml\u003c/code\u003e 文件中的书写格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003elog_opt:\n    max-size: \u0026#39;100M\u0026#39;\n    max-file: \u0026#39;3\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当生成 \u003ccode\u003e3\u003c/code\u003e 个文件，每个文件达到 \u003ccode\u003e100M\u003c/code\u003e 时，会循环写入新的日志。\u003c/p\u003e\n\u003ch4 id=\"指定-cgroup-driver-的类型\"\u003e指定 Cgroup Driver 的类型\u003c/h4\u003e\n\u003cp\u003e在 \u003ccode\u003e/usr/lib/system/system/docker.service\u003c/code\u003e 中给 \u003ccode\u003edocker\u003c/code\u003e 进程启动命令中增加如下参数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e--exec-opt native.cgroupdriver=systemd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1508371200,"description":"","fuzzywordcount":600,"kind":"page","lang":"zh","lastmod":1509148800,"objectID":"ffacc254216d36344b4aadb301e4c3f9","publishdate":1508371200,"relpermalink":"/posts/docker/docker-configuration-parameter/","section":"posts","summary":"\u003cp\u003e本篇博客整理了一些使用 docker 的过程中经常使用的参数的配置，对于 docker 进阶使用会非常有帮助。\u003c/p\u003e","tags":["Docker"],"title":"Docker 常用参数配置","url":"https://xdhuxc.github.io/posts/docker/docker-configuration-parameter/","wordcount":562},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了配置多台机器 SSH 免密登录的详细过程，在管理多台服务器时会很有用。\u003c/p\u003e\n\u003ch3 id=\"配置-ssh-免密登录\"\u003e配置 SSH 免密登录\u003c/h3\u003e\n\u003cp\u003e现有三台虚拟机，分别为：centos_3(192.168.244.129)，centos_4(192.168.244.135)，centos_6(192.168.244.136)\u003c/p\u003e\n\u003cp\u003e1、分别在三台虚拟机的 \u003ccode\u003e/etc/hosts\u003c/code\u003e 文件中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e192.168.244.129 centos_3\n192.168.244.135 centos_4\n192.168.244.136 centos_6\n192.168.244.129 zk_master\n192.168.244.135 zk_slave1\n192.168.244.136 zk_slave2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在三台机器上分别安装 \u003ccode\u003eopenssh\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e查看机器上是否安装了\u003ccode\u003essh\u003c/code\u003e，使用命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erpm -qa|grep openssh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果没有安装，则安装openssh\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y openssh-server\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、在 \u003ccode\u003ezk_master\u003c/code\u003e 上生成密钥对\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003essh-keygen -t rsa\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e连续回车会在当前用户的目录下，即 \u003ccode\u003e/root/.ssh\u003c/code\u003e，生成隐藏目录 \u003ccode\u003e.ssh\u003c/code\u003e，该目录下有私钥文件 \u003ccode\u003eid_rsa\u003c/code\u003e，公钥文件 \u003ccode\u003eid_rsa.pub\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e4、把 \u003ccode\u003ezk_master\u003c/code\u003e 的公钥追加到 \u003ccode\u003eauthorized_keys\u003c/code\u003e 文件里\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecat /root/.ssh/id_rsa.pub \u0026gt;\u0026gt; /root/.ssh/authorized_keys\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、分别在 \u003ccode\u003ezk_slave1\u003c/code\u003e，\u003ccode\u003ezk_slave2\u003c/code\u003e 机器上按照上述步骤安装 \u003ccode\u003eopenssh\u003c/code\u003e，生成密钥对。\u003c/p\u003e\n\u003cp\u003e6、使用 \u003ccode\u003eroot\u003c/code\u003e 用户登陆 \u003ccode\u003ezk_slave1\u003c/code\u003e，把 \u003ccode\u003ezk_slave1\u003c/code\u003e 的公钥远程复制到 \u003ccode\u003ezk_master\u003c/code\u003e 机器上,然后追加到 \u003ccode\u003ezk_master\u003c/code\u003e 机器上的 \u003ccode\u003eauthorized_keys\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# copy到zk_master的root目录下，输入zk_master的密码\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003escp /root/.ssh/id_rsa.pub root@192.168.244.135:/root/\n\u003cspan class=\"gh\"\u003e# 登陆zk_master之后追加到授权文件里\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecat /root/id_rsa.pub \u0026gt;\u0026gt; /root/.ssh/authorized_keys\n\u003cspan class=\"gh\"\u003e# 删除远程传过来的zk_slave1公钥\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003erm -f /root/id_rsa.pub\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、使用 \u003ccode\u003eroot\u003c/code\u003e 用户登陆 \u003ccode\u003ezk_slave2\u003c/code\u003e，把 \u003ccode\u003ezk_slave2\u003c/code\u003e 的公钥远程复制到 \u003ccode\u003ezk_master\u003c/code\u003e 机器上,然后追加到 \u003ccode\u003ezk_master\u003c/code\u003e 机器上的 \u003ccode\u003eauthorized_keys\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# 复制到zk_master的root目录下，输入zk_master的密码\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003escp /root/.ssh/id_rsa.pub root@192.168.244.136:/root/\n\u003cspan class=\"gh\"\u003e# 登陆zk_master之后追加到授权文件里\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecat /root/id_rsa.pub \u0026gt;\u0026gt; /root/.ssh/authorized_keys\n\u003cspan class=\"gh\"\u003e# 删除远程传过来的zk_slave2公钥\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003erm -f /root/id_rsa.pub\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e8、把存有 \u003ccode\u003ezk_master\u003c/code\u003e，\u003ccode\u003ezk_slave1\u003c/code\u003e，\u003ccode\u003ezk_slave2\u003c/code\u003e 公钥文件的授权文件 \u003ccode\u003eauthorized_keys\u003c/code\u003e 文件远程复制到 \u003ccode\u003ezk_slave1\u003c/code\u003e，\u003ccode\u003ezk_slave2\u003c/code\u003e 上去\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003escp /root/.ssh/authorized_keys root@192.168.244.135:/root/.ssh\nscp /root/.ssh/authorized_keys root@192.168.244.136:/root/.ssh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e9、分别在三台机器上用远程登陆命令 \u003ccode\u003essh\u003c/code\u003e 登陆验证是否成功\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003essh zk_slave1\nssh zk_slave2\nssh zk_master\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e第一次 \u003ccode\u003essh\u003c/code\u003e 时需要输入密码，之后便可以互相免密访问。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://blog.chinaunix.net/uid-26284395-id-2949145.html\"\u003ehttp://blog.chinaunix.net/uid-26284395-id-2949145.html\u003c/a\u003e\u003c/p\u003e","date":1508198400,"description":"","fuzzywordcount":800,"kind":"page","lang":"zh","lastmod":1516579200,"objectID":"d573934cbe27644cbe6b60747e8c753e","publishdate":1508198400,"relpermalink":"/posts/common/ssh-no-password-login/","section":"posts","summary":"\u003cp\u003e本篇博客记录了配置多台机器 SSH 免密登录的详细过程，在管理多台服务器时会很有用。\u003c/p\u003e","tags":["SSH"],"title":"配置 SSH 免密登录","url":"https://xdhuxc.github.io/posts/common/ssh-no-password-login/","wordcount":798},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Python 中的异常处理。\u003c/p\u003e\n\u003cp\u003ePython 提供了两个非常重要的功能来处理 Python 程序在运行中出现的异常和错误，可以使用该功能来调试 Python 程序。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e异常处理\u003c/li\u003e\n\u003cli\u003e断言\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"python-标准异常\"\u003ePython 标准异常\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e异常名称\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eBaseException\u003c/td\u003e\n\u003ctd\u003e所有异常的基类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSystemExit\u003c/td\u003e\n\u003ctd\u003e解释器请求退出\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eKeyboardInterrupt\u003c/td\u003e\n\u003ctd\u003e用户中断执行(通常是输入^C)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eException\u003c/td\u003e\n\u003ctd\u003e常规错误的基类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eStopIteration\u003c/td\u003e\n\u003ctd\u003e迭代器没有更多的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGeneratorExit\u003c/td\u003e\n\u003ctd\u003e生成器(generator)发生异常来通知退出\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eStandardError\u003c/td\u003e\n\u003ctd\u003e所有的内建标准异常的基类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eArithmeticError\u003c/td\u003e\n\u003ctd\u003e所有数值计算错误的基类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFloatingPointError\u003c/td\u003e\n\u003ctd\u003e浮点计算错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eOverflowError\u003c/td\u003e\n\u003ctd\u003e数值运算超出最大限制\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eZeroDivisionError\u003c/td\u003e\n\u003ctd\u003e除(或取模)零 (所有数据类型)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAssertionError\u003c/td\u003e\n\u003ctd\u003e断言语句失败\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAttributeError\u003c/td\u003e\n\u003ctd\u003e对象没有这个属性\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eEOFError\u003c/td\u003e\n\u003ctd\u003e没有内建输入,到达EOF 标记\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eEnvironmentError\u003c/td\u003e\n\u003ctd\u003e操作系统错误的基类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eIOError\u003c/td\u003e\n\u003ctd\u003e输入/输出操作失败\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eOSError\u003c/td\u003e\n\u003ctd\u003e操作系统错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eWindowsError\u003c/td\u003e\n\u003ctd\u003e系统调用失败\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eImportError\u003c/td\u003e\n\u003ctd\u003e导入模块/对象失败\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eLookupError\u003c/td\u003e\n\u003ctd\u003e无效数据查询的基类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eIndexError\u003c/td\u003e\n\u003ctd\u003e序列中没有此索引(index)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eKeyError\u003c/td\u003e\n\u003ctd\u003e映射中没有这个键\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMemoryError\u003c/td\u003e\n\u003ctd\u003e内存溢出错误(对于Python 解释器不是致命的)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNameError\u003c/td\u003e\n\u003ctd\u003e未声明/初始化对象 (没有属性)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUnboundLocalError\u003c/td\u003e\n\u003ctd\u003e访问未初始化的本地变量\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eReferenceError\u003c/td\u003e\n\u003ctd\u003e弱引用(Weak reference)试图访问已经垃圾回收了的对象\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eRuntimeError\u003c/td\u003e\n\u003ctd\u003e一般的运行时错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNotImplementedError\u003c/td\u003e\n\u003ctd\u003e尚未实现的方法\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSyntaxError\u003c/td\u003e\n\u003ctd\u003ePython 语法错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eIndentationError\u003c/td\u003e\n\u003ctd\u003e缩进错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTabError\u003c/td\u003e\n\u003ctd\u003eTab 和空格混用\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSystemError\u003c/td\u003e\n\u003ctd\u003e一般的解释器系统错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTypeError\u003c/td\u003e\n\u003ctd\u003e对类型无效的操作\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eValueError\u003c/td\u003e\n\u003ctd\u003e传入无效的参数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUnicodeError\u003c/td\u003e\n\u003ctd\u003eUnicode 相关的错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUnicodeDecodeError\u003c/td\u003e\n\u003ctd\u003eUnicode 解码时的错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUnicodeEncodeError\u003c/td\u003e\n\u003ctd\u003eUnicode 编码时错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUnicodeTranslateError\u003c/td\u003e\n\u003ctd\u003eUnicode 转换时错误\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eWarning\u003c/td\u003e\n\u003ctd\u003e警告的基类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eDeprecationWarning\u003c/td\u003e\n\u003ctd\u003e关于被弃用的特征的警告\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFutureWarning\u003c/td\u003e\n\u003ctd\u003e关于构造将来语义会有改变的警告\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eOverflowWarning\u003c/td\u003e\n\u003ctd\u003e旧的关于自动提升为长整型(long)的警告\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePendingDeprecationWarning\u003c/td\u003e\n\u003ctd\u003e关于特性将会被废弃的警告\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eRuntimeWarning\u003c/td\u003e\n\u003ctd\u003e可疑的运行时行为(runtime behavior)的警告\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSyntaxWarning\u003c/td\u003e\n\u003ctd\u003e可疑的语法的警告\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUserWarning\u003c/td\u003e\n\u003ctd\u003e用户代码生成的警告\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"异常\"\u003e异常\u003c/h3\u003e\n\u003cp\u003e异常即是一个事件，该事件会在程序执行过程中发生，影响了程序的正常执行。\u003c/p\u003e\n\u003cp\u003e一般情况下，在Python无法正常处理程序时就会发生一个异常。\u003c/p\u003e\n\u003cp\u003e异常是Python对象，表示一个错误。当Python脚本发生异常时,需要捕获处理它，否则程序会终止执行。\u003c/p\u003e\n\u003ch3 id=\"异常处理\"\u003e异常处理\u003c/h3\u003e\n\u003cp\u003e捕捉异常可以使用 \u003ccode\u003etry/except\u003c/code\u003e 语句。\u003ccode\u003etry/except\u003c/code\u003e 语句用来检测 \u003ccode\u003etry\u003c/code\u003e 语句块中的错误，从而让 \u003ccode\u003eexcept\u003c/code\u003e 语句捕获异常信息并处理。\u003c/p\u003e\n\u003cp\u003e如果不想在异常发生时结束程序，只需在try里捕获它。\u003c/p\u003e\n\u003cp\u003e简单的 \u003ccode\u003etry....except...else\u003c/code\u003e 的语法\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etry:\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e语句\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e        \u003cspan class=\"ni\"\u003e#运行别的代码\u003c/span\u003e\nexcept \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e名字\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e：\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e语句\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e        \u003cspan class=\"ni\"\u003e#如果在try部份引发了\u003c/span\u003e\u0026#39;name\u0026#39;异常\nexcept \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e名字\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e，\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e数据\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e:\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e语句\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e        \u003cspan class=\"ni\"\u003e#如果引发了\u003c/span\u003e\u0026#39;name\u0026#39;异常，获得附加的数据\nelse:\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e语句\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e        \u003cspan class=\"ni\"\u003e#如果没有异常发生\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003etry的工作原理是，当开始一个try语句后，python就在当前程序的上下文中作标记，这样当异常出现时就可以回到这里，try子句先执行，接下来会发生什么依赖于执行时是否出现异常。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e当try后的语句执行时发生异常，python就跳回到try并执行第一个匹配该异常的except子句，异常处理完毕，控制流就通过整个try语句（除非在处理异常时又引发新的异常）。\u003c/li\u003e\n\u003cli\u003e如果在try后的语句里发生了异常，却没有匹配的except子句，异常将被递交到上层的try，或者到程序的最上层（这样将结束程序，并打印缺省的出错信息）。\u003c/li\u003e\n\u003cli\u003e如果在try子句执行时没有发生异常，python将执行else语句后的语句（如果有else的话），然后控制流通过整个try语句。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"使用-except-而不带任何异常类型\"\u003e使用 except 而不带任何异常类型\u003c/h4\u003e\n\u003cp\u003e可以不带任何异常类型使用except，如下实例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etry:\n    正常的操作\n   ......................\nexcept:\n    发生异常，执行这块代码\n   ......................\nelse:\n    如果没有异常执行这块代码\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上方式 \u003ccode\u003etry-except\u003c/code\u003e 语句捕获所有发生的异常。但这不是一个很好的方式,不能通过该程序识别出具体的异常信息。因为它捕获所有的异常。\u003c/p\u003e\n\u003ch4 id=\"使用-except-而带多种异常类型\"\u003e使用 except 而带多种异常类型\u003c/h4\u003e\n\u003cp\u003e可以使用相同的 except 语句来处理多个异常信息，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etry:\n    正常的操作\n   ......................\nexcept(Exception1[, Exception2[,...ExceptionN]]]):\n   发生以上多个异常中的一个，执行这块代码\n   ......................\nelse:\n    如果没有异常执行这块代码\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"try-finally-语句\"\u003etry-finally 语句\u003c/h4\u003e\n\u003cp\u003etry-finally 语句无论是否发生异常都将执行最后的代码。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etry:\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e语句\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\nfinally:\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e语句\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e    \u003cspan class=\"ni\"\u003e#退出try时总会执行\u003c/span\u003e\nraise\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当在try块中抛出一个异常，立即执行finally块代码。\u003c/p\u003e\n\u003cp\u003efinally块中的所有语句执行后，异常被再次触发，并执行except块代码。\u003c/p\u003e\n\u003cp\u003e参数的内容不同于异常。\u003c/p\u003e\n\u003ch3 id=\"异常的参数\"\u003e异常的参数\u003c/h3\u003e\n\u003cp\u003e一个异常可以带上参数，可作为输出的异常信息参数。可以通过except语句来捕获异常的参数，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etry:\n    正常的操作\n   ......................\nexcept ExceptionType, Argument:\n    你可以在这输出 Argument 的值...\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e变量接收的异常值通常包含在异常的语句中。在元组的表单中变量可以接收一个或者多个值。\u003c/p\u003e\n\u003cp\u003e元组通常包含错误字符串，错误数字，错误位置。\u003c/p\u003e\n\u003ch3 id=\"触发异常\"\u003e触发异常\u003c/h3\u003e\n\u003cp\u003e可以使用 raise 语句自己触发异常，raise语法格式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eraise [Exception [, args [, traceback]]]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e语句中Exception是异常的类型（例如，NameError）参数是一个异常参数值。该参数是可选的，如果不提供，异常的参数是\u0026quot;None\u0026quot;。\u003c/p\u003e\n\u003cp\u003e最后一个参数是可选的（在实践中很少使用），如果存在，是跟踪异常对象。\u003c/p\u003e\n\u003cp\u003e一个异常可以是一个字符串，类或对象。 Python的内核提供的异常，大多数都是实例化的类，这是一个类的实例的参数。\u003c/p\u003e\n\u003cp\u003e定义一个异常非常简单，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edef functionName( level ):\n    if level \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003e1:\u003c/span\u003e\n        \u003cspan class=\"na\"\u003eraise\u003c/span\u003e \u003cspan class=\"na\"\u003eException\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eInvalid\u003c/span\u003e \u003cspan class=\"na\"\u003elevel\u003c/span\u003e\u003cspan class=\"err\"\u003e!\u0026#34;,\u003c/span\u003e \u003cspan class=\"na\"\u003elevel\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"err\"\u003e#\u003c/span\u003e \u003cspan class=\"na\"\u003e触发异常后\u003c/span\u003e\u003cspan class=\"err\"\u003e，\u003c/span\u003e\u003cspan class=\"na\"\u003e后面的代码就不会再执行\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意：为了能够捕获异常，\u0026quot;except\u0026quot;语句必须有用相同的异常来抛出类对象或者字符串。\u003c/p\u003e\n\u003cp\u003e例如捕获以上异常，\u0026quot;except\u0026quot;语句如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etry:\n    正常逻辑\nexcept \u0026#34;Invalid level!\u0026#34;:\n    触发自定义异常    \nelse:\n    其余代码\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"用户自定义异常\"\u003e用户自定义异常\u003c/h3\u003e\n\u003cp\u003e通过创建一个新的异常类，程序可以命名它们自己的异常。异常应该是典型的继承自 \u003ccode\u003eException\u003c/code\u003e 类，通过直接或间接的方式。\u003c/p\u003e\n\u003cp\u003e以下为与 \u003ccode\u003eRuntimeError\u003c/code\u003e 相关的实例,实例中创建了一个类，基类为 \u003ccode\u003eRuntimeError\u003c/code\u003e，用于在异常触发时输出更多的信息。\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003etry\u003c/code\u003e 语句块中，用户自定义的异常后执行 \u003ccode\u003eexcept\u003c/code\u003e 块语句，变量 e 是用于创建 \u003ccode\u003eNetworkError\u003c/code\u003e 类的实例。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eclass NetworkError(RuntimeError):\n    def \u003cspan class=\"gs\"\u003e__init__\u003c/span\u003e(self, arg):\n        self.args = arg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在定义以上类后，可以触发该异常，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etry:\n    raise Networkerror(\u0026#34;Bad hostname\u0026#34;)\nexcept Networkerror,e:\n    print e.args\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1506384000,"description":"","fuzzywordcount":2400,"kind":"page","lang":"zh","lastmod":1506384000,"objectID":"5c5762c422968a167f3c95b29098f135","publishdate":1506384000,"relpermalink":"/posts/programming/python/python-exception/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Python 中的异常处理。\u003c/p\u003e","tags":["Python"],"title":"Python 中的异常处理","url":"https://xdhuxc.github.io/posts/programming/python/python-exception/","wordcount":2373},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Python 中的数据库操作。\u003c/p\u003e\n\u003cp\u003eDB-API 是一个规范，它定义了一系列必须的对象和数据库存取方式, 以便为各种各样的底层数据库系统和多种多样的数据库接口程序提供一致的访问接口 。\u003c/p\u003e\n\u003cp\u003ePython 的 DB-API，为大多数的数据库实现了接口，使用它连接各数据库后，就可以用相同的方式操作各数据库。\u003c/p\u003e\n\u003cp\u003ePython DB-API使用流程：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e引入 API 模块\u003c/li\u003e\n\u003cli\u003e获取与数据库的连接\u003c/li\u003e\n\u003cli\u003e执行SQL语句和存储过程\u003c/li\u003e\n\u003cli\u003e关闭数据库连接\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"mysqldb\"\u003eMySQLdb\u003c/h3\u003e\n\u003cp\u003eMySQLdb 是用于Python连接Mysql数据库的接口，它实现了 Python 数据库 API 规范 V2.0，基于 MySQL C API 上建立的。\u003c/p\u003e\n\u003ch4 id=\"连接-mysql-数据库\"\u003e连接 MySQL 数据库\u003c/h4\u003e\n\u003cp\u003e以下代码演示了连接 MySQL 数据库的方法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- conding: utf-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport MySQLdb\n\n\u003cspan class=\"gh\"\u003e# 打开数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb = MySQLdb.connect(\u0026#34;localhost\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;root456\u0026#34;, \u0026#34;xdhuxc\u0026#34;)\n\n\u003cspan class=\"gh\"\u003e# 使用cursor()方法获取操作游标\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor = db.cursor()\n\n\u003cspan class=\"gh\"\u003e# 使用execute方法执行SQL语句\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor.execute(\u0026#34;select version()\u0026#34;)\n\n\u003cspan class=\"gh\"\u003e# 使用fetchone()方法获取一条数据库记录\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edata = cursor.fetchone()\n\nprint \u0026#34;Database version: %s\u0026#34; % data\n\n\u003cspan class=\"gh\"\u003e# 关闭数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb.close()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"创建数据库表\"\u003e创建数据库表\u003c/h4\u003e\n\u003cp\u003e以下代码演示了创建数据库表的方法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport MySQLdb\n\n\u003cspan class=\"gh\"\u003e# 打开数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb = MySQLdb.connect(\u0026#34;localhost\u0026#34;,\u0026#34;root\u0026#34;,\u0026#34;root456\u0026#34;,\u0026#34;xdhuxc\u0026#34; )\n\n\u003cspan class=\"gh\"\u003e# 使用cursor()方法获取操作游标 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor = db.cursor()\n\n\u003cspan class=\"gh\"\u003e# 如果数据表已经存在使用 execute() 方法删除表。\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor.execute(\u0026#34;drop table if exists employee\u0026#34;)\n\n\u003cspan class=\"gh\"\u003e# 创建数据表SQL语句\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esql = \u0026#34;\u0026#34;\u0026#34;create table employee (\n         first_name char(20) not null,\n         last_name  char(20),\n         age int,  \n         sex char(1),\n         income float \n         )\n      \u0026#34;\u0026#34;\u0026#34;\n\u003cspan class=\"gh\"\u003e# 执行SQL语句\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor.execute(sql)\n\n\u003cspan class=\"gh\"\u003e# 关闭数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb.close()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"数据库插入操作\"\u003e数据库插入操作\u003c/h5\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport MySQLdb\n\n\u003cspan class=\"gh\"\u003e# 打开数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb = MySQLdb.connect(\u0026#34;localhost\u0026#34;,\u0026#34;root\u0026#34;,\u0026#34;root456\u0026#34;,\u0026#34;xdhuxc\u0026#34; )\n\n\u003cspan class=\"gh\"\u003e# 使用cursor()方法获取操作游标 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor = db.cursor()\n\n\u003cspan class=\"gh\"\u003e# SQL 插入语句\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esql = \u0026#34;\u0026#34;\u0026#34;\n         insert into employee(first_name,\n         last_name, age, sex, income)\n         values (\u0026#39;Mac\u0026#39;, \u0026#39;Mohan\u0026#39;, 20, \u0026#39;M\u0026#39;, 2000)\n      \u0026#34;\u0026#34;\u0026#34;\n\u003cspan class=\"gh\"\u003e#sql = \u0026#34;\u0026#34;\u0026#34;\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e#         insert into employee(first_name, \\\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e#         last_name, age, sex, income) \\\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e#         values (\u0026#39;%s\u0026#39;, \u0026#39;%s\u0026#39;, \u0026#39;%d\u0026#39;, \u0026#39;%c\u0026#39;, \u0026#39;%d\u0026#39; )\u0026#34; % \\\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e#         (\u0026#39;Mac\u0026#39;, \u0026#39;Mohan\u0026#39;, 20, \u0026#39;M\u0026#39;, 2000)      \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e#      \u0026#34;\u0026#34;\u0026#34;\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e      \ntry:\n   # 执行sql语句\n   cursor.execute(sql)\n   # 提交到数据库执行\n   db.commit()\nexcept:\n   # 如果有错误，则回滚\n   db.rollback()\n\n\u003cspan class=\"gh\"\u003e# 关闭数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb.close()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用变量向 SQL 语句中传递参数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003euser_name = \u0026#34;root\u0026#34;\npassword = \u0026#34;root456\u0026#34;\n\ncursor.execute(\u0026#39;insert into login values (\u0026#34;%s\u0026#34;, \u0026#34;%s\u0026#34;)\u0026#39; % (user_name, password))\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"数据库查询操作\"\u003e数据库查询操作\u003c/h4\u003e\n\u003cp\u003ePython 查询 MySQL 使用 \u003ccode\u003efetchone()\u003c/code\u003e 方法获取单条数据, 使用 \u003ccode\u003efetchall()\u003c/code\u003e 方法获取多条数据。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efetchone(): 该方法获取下一个查询结果集，结果集是一个对象。\u003c/li\u003e\n\u003cli\u003efetchall():接收全部的返回结果行。\u003c/li\u003e\n\u003cli\u003erowcount: 这是一个只读属性，并返回执行execute()方法后影响的行数。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e查询 employee 表中 salary 字段大于 1000 的所有数据：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport MySQLdb\n\n\u003cspan class=\"gh\"\u003e# 打开数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb = MySQLdb.connect(\u0026#34;localhost\u0026#34;,\u0026#34;root\u0026#34;,\u0026#34;root456\u0026#34;,\u0026#34;xdhuxc\u0026#34; )\n\n\u003cspan class=\"gh\"\u003e# 使用cursor()方法获取操作游标 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor = db.cursor()\n\n\u003cspan class=\"gh\"\u003e# SQL 查询语句\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esql = \u0026#34;select * from employee where income \u0026gt; \u0026#39;%d\u0026#39;\u0026#34; % (1000)\ntry:\n   # 执行SQL语句\n   cursor.execute(sql)\n   # 获取所有记录列表\n   results = cursor.fetchall()\n   for row in results:\n      first_name = row[0]\n      last_name = row[1]\n      age = row[2]\n      sex = row[3]\n      income = row[4]\n      # 打印结果\n      print \u0026#34;first_name=%s,last_name=%s,age=%d,sex=%s,income=%d\u0026#34; % \\\n             (first_name, last_name, age, sex, income )\nexcept:\n   print \u0026#34;Error: unable to fecth data\u0026#34;\n\n\u003cspan class=\"gh\"\u003e# 关闭数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb.close()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"数据库更新操作\"\u003e数据库更新操作\u003c/h4\u003e\n\u003cp\u003e更新操作用于更新数据表的的数据\u003c/p\u003e\n\u003cp\u003e将 EMPLOYEE 表中的 SEX 字段为 'M' 的 AGE 字段递增 1：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport MySQLdb\n\n\u003cspan class=\"gh\"\u003e# 打开数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb = MySQLdb.connect(\u0026#34;localhost\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;root456\u0026#34;, \u0026#34;xdhuxc\u0026#34; )\n\n\u003cspan class=\"gh\"\u003e# 使用cursor()方法获取操作游标 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor = db.cursor()\n\n\u003cspan class=\"gh\"\u003e# SQL 更新语句\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esql = \u0026#34;update employee set age = age + 1 where sex = \u0026#39;%c\u0026#39;\u0026#34; % (\u0026#39;M\u0026#39;)\ntry:\n   # 执行SQL语句\n   cursor.execute(sql)\n   # 提交到数据库执行\n   db.commit()\nexcept:\n   # 发生错误时回滚\n   db.rollback()\n\n\u003cspan class=\"gh\"\u003e# 关闭数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb.close()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"删除操作\"\u003e删除操作\u003c/h4\u003e\n\u003cp\u003e删除操作用于删除数据表中的数据\u003c/p\u003e\n\u003cp\u003e删除数据表 employee 中 age 大于 20 的所有数据：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport MySQLdb\n\n\u003cspan class=\"gh\"\u003e# 打开数据库连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb = MySQLdb.connect(\u0026#34;localhost\u0026#34;, \u0026#34;root\u0026#34;, \u0026#34;root456\u0026#34;, \u0026#34;xdhuxc\u0026#34;)\n\n\u003cspan class=\"gh\"\u003e# 使用cursor()方法获取操作游标 \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ecursor = db.cursor()\n\n\u003cspan class=\"gh\"\u003e# SQL 删除语句\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003esql = \u0026#34;delete from employee where age \u0026gt; \u0026#39;%d\u0026#39;\u0026#34; % (20)\ntry:\n   # 执行SQL语句\n   cursor.execute(sql)\n   # 提交修改\n   db.commit()\nexcept:\n   # 发生错误时回滚\n   db.rollback()\n\n\u003cspan class=\"gh\"\u003e# 关闭连接\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edb.close()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"执行事务\"\u003e执行事务\u003c/h4\u003e\n\u003cp\u003e事务机制可以确保数据一致性。\u003c/p\u003e\n\u003cp\u003e事务应该具有4个属性：原子性、一致性、隔离性、持久性。这四个属性通常称为ACID特性。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e原子性（atomicity）。一个事务是一个不可分割的工作单位，事务中包括的诸操作要么都做，要么都不做。\u003c/li\u003e\n\u003cli\u003e一致性（consistency）。事务必须是使数据库从一个一致性状态变到另一个一致性状态。一致性与原子性是密切相关的。\u003c/li\u003e\n\u003cli\u003e隔离性（isolation）。一个事务的执行不能被其他事务干扰。即一个事务内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。\u003c/li\u003e\n\u003cli\u003e持久性（durability）。持续性也称永久性（permanence），指一个事务一旦提交，它对数据库中数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其有任何影响。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e对于支持事务的数据库， 在Python数据库编程中，当游标建立之时，就自动开始了一个隐形的数据库事务。\ncommit() 方法提交当前游标的所有更新操作，rollback() 方法回滚当前游标的所有操作。每一个方法都开始了一个新的事务。\u003c/p\u003e\n\u003ch4 id=\"错误处理\"\u003e错误处理\u003c/h4\u003e\n\u003cp\u003eDB API中定义了一些数据库操作的错误及异常\u003c/p\u003e\n\u003cp\u003e下表列出了这些错误和异常：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e异常\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eWarning\u003c/td\u003e\n\u003ctd\u003e当有严重警告时触发，例如插入数据是被截断等等。必须是 StandardError 的子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eError\u003c/td\u003e\n\u003ctd\u003e警告以外所有其他错误类。必须是 StandardError 的子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eInterfaceError\u003c/td\u003e\n\u003ctd\u003e当有数据库接口模块本身的错误（而不是数据库的错误）发生时触发。 必须是Error的子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eDatabaseError\u003c/td\u003e\n\u003ctd\u003e和数据库有关的错误发生时触发。 必须是Error的子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eDataError\u003c/td\u003e\n\u003ctd\u003e当有数据处理时的错误发生时触发，例如：除零错误，数据超范围等等。 必须是DatabaseError的子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eOperationalError\u003c/td\u003e\n\u003ctd\u003e指非用户控制的，而是操作数据库时发生的错误。例如：连接意外断开、 数据库名未找到、事务处理失败、内存分配错误等等操作数据库是发生的错误。 必须是DatabaseError的子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eIntegrityError\u003c/td\u003e\n\u003ctd\u003e完整性相关的错误，例如外键检查失败等。必须是DatabaseError子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eInternalError\u003c/td\u003e\n\u003ctd\u003e数据库的内部错误，例如游标（cursor）失效了、事务同步失败等等。 必须是DatabaseError子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eProgrammingError\u003c/td\u003e\n\u003ctd\u003e程序错误，例如数据表（table）没找到或已存在、SQL语句语法错误、 参数数量错误等等。必须是DatabaseError的子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNotSupportedError\u003c/td\u003e\n\u003ctd\u003e不支持错误，指使用了数据库不支持的函数或API等。例如在连接对象上 使用.rollback()函数，然而数据库并不支持事务或者事务已关闭。 必须是DatabaseError的子类\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e","date":1506384000,"description":"","fuzzywordcount":2400,"kind":"page","lang":"zh","lastmod":1506384000,"objectID":"1cc2da188e4470ee43b190bba3a95982","publishdate":1506384000,"relpermalink":"/posts/programming/python/python-database/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Python 中的数据库操作。\u003c/p\u003e","tags":["Python"],"title":"Python 数据库操作","url":"https://xdhuxc.github.io/posts/programming/python/python-database/","wordcount":2368},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Python 中的面向对象 和网络编程。\u003c/p\u003e\n\u003ch3 id=\"面向对象技术的基本概念\"\u003e面向对象技术的基本概念\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e类(Class): 用来描述具有相同的属性和方法的对象的集合。它定义了该集合中每个对象所共有的属性和方法。对象是类的实例。\u003c/li\u003e\n\u003cli\u003e类变量：类变量在整个实例化的对象中是公用的。类变量定义在类中且在函数体之外。类变量通常不作为实例变量使用。\u003c/li\u003e\n\u003cli\u003e数据成员：类变量或者实例变量用于处理类及其实例对象的相关的数据。\u003c/li\u003e\n\u003cli\u003e方法重写：如果从父类继承的方法不能满足子类的需求，可以对其进行改写，这个过程叫方法的覆盖（override），也称为方法的重写。\u003c/li\u003e\n\u003cli\u003e实例变量：定义在方法中的变量，只作用于当前实例的类。\u003c/li\u003e\n\u003cli\u003e继承：即一个派生类继承基类的字段和方法。继承也允许把一个派生类的对象作为一个基类对象对待。\u003c/li\u003e\n\u003cli\u003e实例化：创建一个类的实例，类的具体对象。\u003c/li\u003e\n\u003cli\u003e方法：类中定义的函数。\u003c/li\u003e\n\u003cli\u003e对象：通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"类\"\u003e类\u003c/h3\u003e\n\u003cp\u003e使用 class 语句来创建一个新类，class 之后为类的名称并以冒号结尾，如下实例:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eclass ClassName:\n   \u0026#39;类的帮助信息\u0026#39;   \u003cspan class=\"ni\"\u003e#类文档字符串\u003c/span\u003e，帮助信息可以通过ClassName.__doc__查看。\n   class_suite  \u003cspan class=\"ni\"\u003e#类体\u003c/span\u003e，由类成员，方法，数据属性组成。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e一个简单的Python类实例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nclass Employee:\n   \u0026#39;所有员工的基类\u0026#39;\n   empCount = 0\n \n   def \u003cspan class=\"gs\"\u003e__init__\u003c/span\u003e(self, name, salary):\n      self.name = name\n      self.salary = salary\n      Employee.empCount += 1\n   \n   def displayCount(self):\n     print \u0026#34;Total Employee %d\u0026#34; % Employee.empCount\n \n   def displayEmployee(self):\n      print \u0026#34;Name : \u0026#34;, self.name,  \u0026#34;, Salary: \u0026#34;, self.salary\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eempCount 变量是一个类变量，它的值将在这个类的所有实例之间共享。你可以在内部类或外部类使用 Employee.empCount 访问。\u003c/li\u003e\n\u003cli\u003e第一种方法__init__()方法是一种特殊的方法，被称为类的构造函数或初始化方法，当创建了这个类的实例时就会调用该方法\u003c/li\u003e\n\u003cli\u003eself 代表类的实例，self 在定义类的方法时是必须有的，虽然在调用时不必传入相应的参数。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"self代表类的实例而非类\"\u003eself代表类的实例，而非类\u003c/h4\u003e\n\u003cp\u003e类的方法与普通的函数只有一个特殊的区别——它们必须有一个额外的第一个参数名称, 按照惯例它的名称是 self。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eclass Xdhuxc:\n    def xdhuxc(self):\n        print self\n        print self.__class__\n        print self.__doc__\n        print self.__module__\n\nx = Xdhuxc()\nx.xdhuxc()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上程序执行结果为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003e__main__.Xdhuxc\u003c/span\u003e \u003cspan class=\"na\"\u003einstance\u003c/span\u003e \u003cspan class=\"na\"\u003eat\u003c/span\u003e \u003cspan class=\"na\"\u003e0x02190940\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"gs\"\u003e__main__\u003c/span\u003e.Xdhuxc\nNone\n\u003cspan class=\"gs\"\u003e__main__\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e从执行结果可以看出，self 代表的是类的实例，代表当前对象的地址，而 self.\u003cstrong\u003eclass\u003c/strong\u003e 则指向类。\nself 不是 python 关键字，将它换成 xdhuxc 也是可以正常执行的\u003c/p\u003e\n\u003ch4 id=\"创建实例对象\"\u003e创建实例对象\u003c/h4\u003e\n\u003cp\u003e在 Python 中，类的实例化类似函数调用方式。使用类的名称 Employee 来实例化，并通过 \u003cstrong\u003einit\u003c/strong\u003e 方法接受参数。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026#34;创建 Employee 类的第一个对象\u0026#34;\nemp1 = Employee(\u0026#34;Zara\u0026#34;, 2000)\n\u0026#34;创建 Employee 类的第二个对象\u0026#34;\nemp2 = Employee(\u0026#34;Manni\u0026#34;, 5000)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"访问属性\"\u003e访问属性\u003c/h4\u003e\n\u003cp\u003e可以使用点(.)来访问对象的属性。使用如下类的名称访问类变量：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eemp1.displayEmployee()\nemp2.displayEmployee()\nprint \u0026#34;Total Employee %d\u0026#34; % Employee.empCount\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以添加，删除，修改类的属性，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eemp1.age = 7  # 添加一个 \u0026#39;age\u0026#39; 属性\nemp1.age = 8  # 修改 \u0026#39;age\u0026#39; 属性\ndel emp1.age  # 删除 \u0026#39;age\u0026#39; 属性\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以使用以下函数的方式来访问属性：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003egetattr(obj, name[, default]) : 访问对象的属性。\u003c/li\u003e\n\u003cli\u003ehasattr(obj,name) : 检查是否存在一个属性。\u003c/li\u003e\n\u003cli\u003esetattr(obj,name,value) : 设置一个属性。如果属性不存在，会创建一个新属性。\u003c/li\u003e\n\u003cli\u003edelattr(obj, name) : 删除属性。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e使用方式如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehasattr(emp1, \u0026#39;age\u0026#39;)    # 如果存在 \u0026#39;age\u0026#39; 属性返回 True。\ngetattr(emp1, \u0026#39;age\u0026#39;)    # 返回 \u0026#39;age\u0026#39; 属性的值\nsetattr(emp1, \u0026#39;age\u0026#39;, 8) # 添加属性 \u0026#39;age\u0026#39; 值为 8\ndelattr(empl, \u0026#39;age\u0026#39;)    # 删除属性 \u0026#39;age\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"内置类属性\"\u003e内置类属性\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003edict\u003c/strong\u003e : 类的属性（包含一个字典，由类的数据属性组成）\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003edoc\u003c/strong\u003e :类的文档字符串\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ename\u003c/strong\u003e: 类名\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003emodule\u003c/strong\u003e: 类定义所在的模块（类的全名是'\u003cstrong\u003emain\u003c/strong\u003e.className'，如果类位于一个导入模块module_name中，那么className.\u003cstrong\u003emodule\u003c/strong\u003e 等于 module_name）\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ebases\u003c/strong\u003e : 类的所有父类构成元素（包含了一个由所有父类组成的元组）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"对象销毁垃圾回收\"\u003e对象销毁(垃圾回收)\u003c/h3\u003e\n\u003cp\u003ePython 使用了引用计数这一简单技术来跟踪和回收垃圾。\n在 Python 内部记录着所有使用中的对象各有多少引用。\n一个内部跟踪变量，称为一个引用计数器。\n当对象被创建时， 就创建了一个引用计数， 当这个对象不再需要时， 也就是说， 这个对象的引用计数变为0 时， 它被垃圾回收。但是回收不是\u0026quot;立即\u0026quot;的， 由解释器在适当的时机，将垃圾对象占用的内存空间回收。\u003c/p\u003e\n\u003cp\u003e垃圾回收机制不仅针对引用计数为0的对象，同样也可以处理循环引用的情况。循环引用指的是，两个对象相互引用，但是没有其他变量引用他们。这种情况下，仅使用引用计数是不够的。Python 的垃圾收集器实际上是一个引用计数器和一个循环垃圾收集器。作为引用计数的补充， 循环垃圾收集器也会留心被分配的总量很大（及未通过引用计数销毁的那些）的对象。 在这种情况下， 解释器会暂停下来， 试图清理所有未引用的循环。\u003c/p\u003e\n\u003cp\u003e析构函数 \u003cstrong\u003edel\u003c/strong\u003e ，__del__在对象销毁的时候被调用，当对象不再被使用时，__del__方法运行。\u003c/p\u003e\n\u003ch3 id=\"类的继承\"\u003e类的继承\u003c/h3\u003e\n\u003cp\u003e面向对象的编程带来的主要好处之一是代码的重用，实现这种重用的方法之一是通过继承机制。继承完全可以理解成类之间的类型和子类型关系。\u003c/p\u003e\n\u003cp\u003e需要注意的地方：继承语法 class 派生类名（基类名）：//... 基类名写在括号里，基本类是在类定义的时候，在元组之中指明的。\u003c/p\u003e\n\u003cp\u003ePython 继承中的若干特点：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e在继承中基类的构造（\u003cstrong\u003einit\u003c/strong\u003e()方法）不会被自动调用，它需要在其派生类的构造中亲自专门调用。\u003c/li\u003e\n\u003cli\u003e在调用基类的方法时，需要加上基类的类名前缀，且需要带上self参数变量。区别于在类中调用普通函数时并不需要带上self参数\u003c/li\u003e\n\u003cli\u003ePython总是首先查找对应类型的方法，如果它不能在派生类中找到对应的方法，它才开始到基类中逐个查找。（先在本类中查找调用的方法，找不到才去基类中找）。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e如果在继承元组中列了一个以上的类，那么它就被称作\u0026quot;多重继承\u0026quot; 。\u003c/p\u003e\n\u003cp\u003e派生类的声明，与他们的父类类似，继承的基类列表跟在类名之后，语法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eclass SubClassName (ParentClass1[, ParentClass2, ...]):\n   \u0026#39;Optional class documentation string\u0026#39;\n   class_suite\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以使用issubclass()或者isinstance()方法来检测。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eissubclass() - 布尔函数判断一个类是另一个类的子类或者子孙类，语法：issubclass(sub,sup)\u003c/li\u003e\n\u003cli\u003eisinstance(obj, Class) 布尔函数如果obj是Class类的实例对象或者是一个Class子类的实例对象则返回true。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"方法重写\"\u003e方法重写\u003c/h4\u003e\n\u003cp\u003e如果父类方法的功能不能满足需求，可以在子类重写父类的方法。\u003c/p\u003e\n\u003cp\u003e基础重载方法：\u003c/p\u003e\n\u003cp\u003e下表列出了一些通用的功能，你可以在自己的类重写：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e方法\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003cth\u003e简单调用\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003einit\u003c/strong\u003e ( self [,args...] )\u003c/td\u003e\n\u003ctd\u003e构造函数\u003c/td\u003e\n\u003ctd\u003e简单的调用方法: obj = className(args)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003edel\u003c/strong\u003e( self )\u003c/td\u003e\n\u003ctd\u003e析构方法, 删除一个对象\u003c/td\u003e\n\u003ctd\u003e简单的调用方法 : del obj\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003erepr\u003c/strong\u003e( self )\u003c/td\u003e\n\u003ctd\u003e转化为供解释器读取的形式\u003c/td\u003e\n\u003ctd\u003e简单的调用方法 : repr(obj)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003estr\u003c/strong\u003e( self )\u003c/td\u003e\n\u003ctd\u003e用于将值转化为适于人阅读的形式\u003c/td\u003e\n\u003ctd\u003e简单的调用方法 : str(obj)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003ecmp\u003c/strong\u003e ( self, x )\u003c/td\u003e\n\u003ctd\u003e对象比较\u003c/td\u003e\n\u003ctd\u003e简单的调用方法 : cmp(obj, x)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch4 id=\"运算符重载\"\u003e运算符重载\u003c/h4\u003e\n\u003cp\u003ePython同样支持运算符重载，实例如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nclass Vector:\n   def \u003cspan class=\"gs\"\u003e__init__\u003c/span\u003e(self, a, b):\n      self.a = a\n      self.b = b\n \n   def \u003cspan class=\"gs\"\u003e__str__\u003c/span\u003e(self):\n      return \u0026#39;Vector (%d, %d)\u0026#39; % (self.a, self.b)\n   \n   def \u003cspan class=\"gs\"\u003e__add__\u003c/span\u003e(self,other):\n      return Vector(self.a + other.a, self.b + other.b)\n \nv1 = Vector(2,10)\nv2 = Vector(5,-2)\nprint v1 + v2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"类属性与方法\"\u003e类属性与方法\u003c/h4\u003e\n\u003ch5 id=\"类的私有属性\"\u003e类的私有属性\u003c/h5\u003e\n\u003cp\u003e__private_attrs：两个下划线开头，声明该属性为私有，不能在类的外部被使用或直接访问。在类内部的方法中使用时 self.__private_attrs。\u003c/p\u003e\n\u003ch5 id=\"类的方法\"\u003e类的方法\u003c/h5\u003e\n\u003cp\u003e在类的内部，使用 def 关键字可以为类定义一个方法，与一般函数定义不同，类方法必须包含参数 self,且为第一个参数\u003c/p\u003e\n\u003ch5 id=\"类的私有方法\"\u003e类的私有方法\u003c/h5\u003e\n\u003cp\u003e__private_method：两个下划线开头，声明该方法为私有方法，不能在类地外部调用。在类的内部调用 self.__private_methods\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nclass JustCounter:\n    __secretCount = 0  # 私有变量\n    publicCount = 0    # 公开变量\n \n    def count(self):\n        self.__secretCount += 1\n        self.publicCount += 1\n        print self.__secretCount\n \ncounter = JustCounter()\ncounter.count()\ncounter.count()\nprint counter.publicCount\nprint counter.__secretCount  # 报错，实例不能访问私有变量\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ePython不允许实例化的类访问私有数据，但可以使用 object._className__attrName 访问属性\u003c/p\u003e\n\u003ch3 id=\"单下划线双下划线头尾双下划线说明\"\u003e单下划线、双下划线、头尾双下划线说明\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003efoo\u003c/strong\u003e: 定义的是特列方法，类似 \u003cstrong\u003einit\u003c/strong\u003e() 之类的。\u003c/li\u003e\n\u003cli\u003e_foo: 以单下划线开头的表示的是 protected 类型的变量，即保护类型只能允许其本身与子类进行访问，不能用于 from module import *\u003c/li\u003e\n\u003cli\u003e__foo: 双下划线的表示的是私有类型(private)的变量, 只能是允许这个类本身进行访问了。\u003c/li\u003e\n\u003c/ul\u003e","date":1506384000,"description":"","fuzzywordcount":3100,"kind":"page","lang":"zh","lastmod":1506384000,"objectID":"66b95b4809ec7301888c9b0acc09e655","publishdate":1506384000,"relpermalink":"/posts/programming/python/python-oriented-object/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Python 中的面向对象 和网络编程。\u003c/p\u003e","tags":["Python"],"title":"Python 面向对象","url":"https://xdhuxc.github.io/posts/programming/python/python-oriented-object/","wordcount":3075},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Python 中的正则表达式。\u003c/p\u003e\n\u003cp\u003e正则表达式是一个特殊的字符序列，它能方便地检查一个字符串是否与某种模式匹配。\u003c/p\u003e\n\u003cp\u003ere 模块使 Python 语言拥有全部的正则表达式功能。\u003c/p\u003e\n\u003cp\u003ecompile 函数根据一个模式字符串和可选的标志参数生成一个正则表达式对象。该对象拥有一系列方法用于正则表达式匹配和替换。\u003c/p\u003e\n\u003cp\u003ere 模块也提供了与这些方法功能完全一致的函数，这些函数使用一个模式字符串做为它们的第一个参数。\u003c/p\u003e\n\u003ch3 id=\"正则表达式修饰符---可选标志\"\u003e正则表达式修饰符 - 可选标志\u003c/h3\u003e\n\u003cp\u003e正则表达式可以包含一些可选标志修饰符来控制匹配的模式。修饰符被指定为一个可选的标志。多个标志可以通过按位 OR(|) 它们来指定。如 re.I | re.M 被设置成 I 和 M 标志：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e修饰符\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ere.I\u003c/td\u003e\n\u003ctd\u003e使匹配对大小写不敏感\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere.L\u003c/td\u003e\n\u003ctd\u003e做本地化识别（locale-aware）匹配\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere.M\u003c/td\u003e\n\u003ctd\u003e多行匹配，影响 ^ 和 $\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere.S\u003c/td\u003e\n\u003ctd\u003e使 . 匹配包括换行在内的所有字符\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere.U\u003c/td\u003e\n\u003ctd\u003e根据Unicode字符集解析字符。这个标志影响 \\w, \\W, \\b, \\B.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere.X\u003c/td\u003e\n\u003ctd\u003e该标志通过给予更灵活的格式以便将正则表达式写得更易于理解。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"正则表达式模式\"\u003e正则表达式模式\u003c/h3\u003e\n\u003cp\u003e模式字符串使用特殊的语法来表示一个正则表达式\u003c/p\u003e\n\u003cp\u003e1、字母和数字表示他们自身。一个正则表达式模式中的字母和数字匹配同样的字符串。\u003c/p\u003e\n\u003cp\u003e2、多数字母和数字前加一个反斜杠时会拥有不同的含义。\u003c/p\u003e\n\u003cp\u003e3、标点符号只有被转义时才匹配自身，否则它们表示特殊的含义。\u003c/p\u003e\n\u003cp\u003e4、反斜杠本身需要使用反斜杠转义。\u003c/p\u003e\n\u003cp\u003e5、由于正则表达式通常都包含反斜杠，所以你最好使用原始字符串来表示它们。模式元素(如 r'\\t'，等价于 '\\t')匹配相应的特殊字符。\u003c/p\u003e\n\u003cp\u003e正则表达式模式语法中的特殊元素：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e模式\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e^\u003c/td\u003e\n\u003ctd\u003e匹配字符串的开头\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e$\u003c/td\u003e\n\u003ctd\u003e匹配字符串的末尾\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e.\u003c/td\u003e\n\u003ctd\u003e匹配任意字符，除了换行符，当re.DOTALL标记被指定时，则可以匹配包括换行符的任意字符\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e[...]\u003c/td\u003e\n\u003ctd\u003e用来表示一组字符,单独列出：[amk] 匹配 'a'，'m'或'k'\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e[^...]\u003c/td\u003e\n\u003ctd\u003e不在[]中的字符：[^abc] 匹配除了a,b,c之外的字符\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\w\u003c/td\u003e\n\u003ctd\u003e匹配字母数字及下划线\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\W\u003c/td\u003e\n\u003ctd\u003e匹配非字母数字及下划线\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\s\u003c/td\u003e\n\u003ctd\u003e匹配任意空白字符，等价于 [\\t\\n\\r\\f]\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\S\u003c/td\u003e\n\u003ctd\u003e匹配任意非空字符\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\d\u003c/td\u003e\n\u003ctd\u003e匹配任意数字，等价于 [0-9]\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\D\u003c/td\u003e\n\u003ctd\u003e匹配任意非数字\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\A\u003c/td\u003e\n\u003ctd\u003e匹配字符串开始\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\Z\u003c/td\u003e\n\u003ctd\u003e匹配字符串结束，如果是存在换行，只匹配到换行前的结束字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\z\u003c/td\u003e\n\u003ctd\u003e匹配字符串结束\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\\G\u003c/td\u003e\n\u003ctd\u003e匹配最后匹配完成的位置\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere*\u003c/td\u003e\n\u003ctd\u003e匹配0个或多个的表达式\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere+\u003c/td\u003e\n\u003ctd\u003e匹配1个或多个的表达式\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere?\u003c/td\u003e\n\u003ctd\u003e匹配0个或1个由前面的正则表达式定义的片段，非贪婪方式\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere {n,}\u003c/td\u003e\n\u003ctd\u003e精确匹配n个前面表达式。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ere {n,m}\u003c/td\u003e\n\u003ctd\u003e匹配 n 到 m 次由前面的正则表达式定义的片段，贪婪方式\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ea\u003c/td\u003e\n\u003ctd\u003eb\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e(re)\u003c/td\u003e\n\u003ctd\u003eG匹配括号内的表达式，也表示一个组\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e(?imx)\u003c/td\u003e\n\u003ctd\u003e正则表达式包含三种可选标志：i, m, 或 x 。只影响括号中的区域。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e(?-imx)\u003c/td\u003e\n\u003ctd\u003e正则表达式关闭 i, m, 或 x 可选标志。只影响括号中的区域。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e(?:re)\u003c/td\u003e\n\u003ctd\u003e类似 (...), 但是不表示一个组\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e(?imx:re)\u003c/td\u003e\n\u003ctd\u003e在括号中使用i, m, 或 x 可选标志\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e(?-imx:re)\u003c/td\u003e\n\u003ctd\u003e在括号中不使用i, m, 或 x 可选标志\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e(?#...)\u003c/td\u003e\n\u003ctd\u003e注释\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e","date":1506297600,"description":"","fuzzywordcount":1100,"kind":"page","lang":"zh","lastmod":1506297600,"objectID":"350e616d4b23e6ccbe73164621a3aa62","publishdate":1506297600,"relpermalink":"/posts/programming/python/python-regular-expression/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Python 中的正则表达式。\u003c/p\u003e","tags":["Python"],"title":"Python 中的正则表达式","url":"https://xdhuxc.github.io/posts/programming/python/python-regular-expression/","wordcount":1082},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Python 中的网络编程。\u003c/p\u003e\n\u003cp\u003ePython 提供了两个级别访问的网络服务：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e低级别的网络服务支持基本的 Socket，提供了标准的 BSD Sockets API，可以访问底层操作系统Socket接口的全部方法。\u003c/li\u003e\n\u003cli\u003e高级别的网络服务模块 SocketServer， 它提供了服务器中心类，可以简化网络服务器的开发。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"socket\"\u003eSocket\u003c/h3\u003e\n\u003cp\u003eSocket，又称“套接字”，应用程序通常通过“套接字”向网络发出请求或者应答网络请求，使主机间或者一台计算机上的进程间可以通讯。\u003c/p\u003e\n\u003ch4 id=\"socket函数\"\u003esocket()函数\u003c/h4\u003e\n\u003cp\u003ePython 中，我们用 socket（）函数来创建套接字，语法格式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esocket.socket([family[, type[, proto]]])\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efamily: 套接字家族可以使AF_UNIX或者AF_INET\u003c/li\u003e\n\u003cli\u003etype: 套接字类型可以根据是面向连接的还是非连接分为SOCK_STREAM或SOCK_DGRAM\u003c/li\u003e\n\u003cli\u003eprotocol: 一般不填默认为0.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"socket-对象内建方法\"\u003eSocket 对象(内建)方法\u003c/h4\u003e\n\u003cp\u003e（1）服务端套接字\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e函数\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003es.bind()\u003c/td\u003e\n\u003ctd\u003e绑定地址（host,port）到套接字， 在AF_INET下,以元组（host,port）的形式表示地址。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.listen()\u003c/td\u003e\n\u003ctd\u003e开始TCP监听。backlog指定在拒绝连接之前，操作系统可以挂起的最大连接数量。该值至少为1，大部分应用程序设为5就可以了。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.accept()\u003c/td\u003e\n\u003ctd\u003e被动接受TCP客户端连接,(阻塞式)等待连接的到来\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e（2）客户端套接字\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e函数\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003es.connect()\u003c/td\u003e\n\u003ctd\u003e主动初始化TCP服务器连接。一般address的格式为元组（hostname,port），如果连接出错，返回socket.error错误。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.connect_ex()\u003c/td\u003e\n\u003ctd\u003econnect()函数的扩展版本,出错时返回出错码,而不是抛出异常\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e（3）公共用途的套接字函数\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e函数\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003es.recv()\u003c/td\u003e\n\u003ctd\u003e接收TCP数据，数据以字符串形式返回，bufsize指定要接收的最大数据量。flag提供有关消息的其他信息，通常可以忽略\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.send()\u003c/td\u003e\n\u003ctd\u003e发送TCP数据，将string中的数据发送到连接的套接字。返回值是要发送的字节数量，该数量可能小于string的字节大小\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.sendall()\u003c/td\u003e\n\u003ctd\u003e完整发送TCP数据，完整发送TCP数据。将string中的数据发送到连接的套接字，但在返回之前会尝试发送所有数据。成功返回None，失败则抛出异常\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.recvfrom()\u003c/td\u003e\n\u003ctd\u003e接收UDP数据，与recv()类似，但返回值是（data,address）。其中data是包含接收数据的字符串，address是发送数据的套接字地址\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.sendto()\u003c/td\u003e\n\u003ctd\u003e发送UDP数据，将数据发送到套接字，address是形式为（ipaddr，port）的元组，指定远程地址。返回值是发送的字节数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.close()\u003c/td\u003e\n\u003ctd\u003e关闭套接字\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.getpeername()\u003c/td\u003e\n\u003ctd\u003e返回连接套接字的远程地址。返回值通常是元组（ipaddr,port）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.getsockname()\u003c/td\u003e\n\u003ctd\u003e返回套接字自己的地址。通常是一个元组(ipaddr,port)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.setsockopt(level,optname,value)\u003c/td\u003e\n\u003ctd\u003e设置给定套接字选项的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.getsockopt(level,optname[.buflen])\u003c/td\u003e\n\u003ctd\u003e返回套接字选项的值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.settimeout(timeout)\u003c/td\u003e\n\u003ctd\u003e设置套接字操作的超时期，timeout是一个浮点数，单位是秒。值为None表示没有超时期。一般，超时期应该在刚创建套接字时设置，因为它们可能用于连接的操作（如connect()）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.gettimeout()\u003c/td\u003e\n\u003ctd\u003e返回当前超时期的值，单位是秒，如果没有设置超时期，则返回None\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.fileno()\u003c/td\u003e\n\u003ctd\u003e返回套接字的文件描述符\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.setblocking(flag)\u003c/td\u003e\n\u003ctd\u003e如果flag为0，则将套接字设为非阻塞模式，否则将套接字设为阻塞模式（默认值）。非阻塞模式下，如果调用recv()没有发现任何数据，或send()调用无法立即发送数据，那么将引起socket.error异常\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003es.makefile()\u003c/td\u003e\n\u003ctd\u003e创建一个与该套接字相关连的文件\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"示例\"\u003e示例\u003c/h3\u003e\n\u003ch4 id=\"服务器端\"\u003e服务器端\u003c/h4\u003e\n\u003cp\u003e1、使用 socket 模块的 socket 函数来创建一个 socket 对象。socket 对象可以通过调用其他函数来设置一个 socket 服务。\u003c/p\u003e\n\u003cp\u003e2、可以通过调用 bind(hostname, port) 函数来指定服务的 port(端口)。\u003c/p\u003e\n\u003cp\u003e3、调用 socket 对象的 accept 方法。该方法等待客户端的连接，并返回 connection 对象，表示已连接到客户端。\u003c/p\u003e\n\u003cp\u003e代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 文件名：server.py\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport socket               # 导入 socket 模块\n\ns = socket.socket()         # 创建 socket 对象\nhost = socket.gethostname() # 获取本地主机名\nport = 12345                # 设置端口\ns.bind((host, port))        # 绑定端口\n\ns.listen(5)                 # 等待客户端连接\nwhile True:\n    c, addr = s.accept()     # 建立客户端连接。\n    print \u0026#39;连接地址：\u0026#39;, addr\n    c.send(\u0026#39;欢迎访问菜鸟教程！\u0026#39;)\n    c.close()                # 关闭连接\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"客户端\"\u003e客户端\u003c/h4\u003e\n\u003cp\u003e一个简单的客户端实例连接到以上创建的服务。端口号为 12345。\u003c/p\u003e\n\u003cp\u003esocket.connect(hosname, port ) 方法打开一个 TCP 连接到主机为 hostname 端口为 port 的服务商。连接后我们就可以从服务端后期数据，记住，操作完成后需要关闭连接。\u003c/p\u003e\n\u003cp\u003e代码如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 文件名：client.py\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nimport socket               # 导入 socket 模块\n\ns = socket.socket()         # 创建 socket 对象\nhost = socket.gethostname() # 获取本地主机名\nport = 12345                # 设置端口好\n\ns.connect((host, port))\nprint s.recv(1024)\ns.close()  \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"运行该程序\"\u003e运行该程序\u003c/h4\u003e\n\u003cp\u003e1、打开两个终端，第一个终端执行 server.py 文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ python server.py\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、第二个终端执行 client.py 文件：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ python client.py\nIt is python language\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、再打开第一个终端，就会看到有以下信息输出：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e连接地址： (\u0026#39;192.168.0.118\u0026#39;, 62461)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"internet-模块\"\u003eInternet 模块\u003c/h3\u003e\n\u003cp\u003ePython网络编程的一些重要模块\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e协议\u003c/th\u003e\n\u003cth\u003e功能\u003c/th\u003e\n\u003cth\u003e端口号\u003c/th\u003e\n\u003cth\u003ePython模块\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eHTTP\u003c/td\u003e\n\u003ctd\u003e网页访问\u003c/td\u003e\n\u003ctd\u003e80\u003c/td\u003e\n\u003ctd\u003ehttplib, urllib, xmlrpclib\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNNTP\u003c/td\u003e\n\u003ctd\u003e阅读和张贴新闻文章，俗称为\u0026quot;帖子\u0026quot;\u003c/td\u003e\n\u003ctd\u003e119\u003c/td\u003e\n\u003ctd\u003enntplib\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFTP\u003c/td\u003e\n\u003ctd\u003e文件传输\u003c/td\u003e\n\u003ctd\u003e20\u003c/td\u003e\n\u003ctd\u003eftplib, urllib\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSMTP\u003c/td\u003e\n\u003ctd\u003e发送邮件\u003c/td\u003e\n\u003ctd\u003e25\u003c/td\u003e\n\u003ctd\u003esmtplib\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePOP3\u003c/td\u003e\n\u003ctd\u003e接收邮件\u003c/td\u003e\n\u003ctd\u003e110\u003c/td\u003e\n\u003ctd\u003epoplib\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eIMAP4\u003c/td\u003e\n\u003ctd\u003e获取邮件\u003c/td\u003e\n\u003ctd\u003e143\u003c/td\u003e\n\u003ctd\u003eimaplib\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTelnet\u003c/td\u003e\n\u003ctd\u003e命令行\u003c/td\u003e\n\u003ctd\u003e23\u003c/td\u003e\n\u003ctd\u003etelnetlib\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eGopher\u003c/td\u003e\n\u003ctd\u003e信息查找\u003c/td\u003e\n\u003ctd\u003e70\u003c/td\u003e\n\u003ctd\u003egopherlib, urllib\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e","date":1506211200,"description":"","fuzzywordcount":2000,"kind":"page","lang":"zh","lastmod":1506211200,"objectID":"817a74fbf05298632859ae96c1a06727","publishdate":1506211200,"relpermalink":"/posts/programming/python/python-network/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Python 中的网络编程。\u003c/p\u003e","tags":["Python"],"title":"Python 中的网络编程","url":"https://xdhuxc.github.io/posts/programming/python/python-network/","wordcount":1963},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了 Nexus 的安装和配置。\u003c/p\u003e\n\u003ch3 id=\"nexus\"\u003eNexus\u003c/h3\u003e\n\u003cp\u003eNexus 是一个广泛使用的包管理工具，可以用来做 maven，rpm 等包的管理仓库，缓存包，供内部程序使用。\u003c/p\u003e\n\u003cp\u003eNexus 默认管理员用户名/密码为：admin/admin123，访问地址为：http://localhost:8081/nexus/ （需要开放8081端口，CentOS 7 Minimal模式安装，启动后会自动启动firewalld）\u003c/p\u003e\n\u003cp\u003e如果有问题，可以使用bin/nexus console 来排查问题\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003e/data/sonatype-work/nexus/conf/nexus.xml\u003c/code\u003e 中可以修改仓库的配置信息\u003c/p\u003e\n\u003cp\u003e使用自己的 nexus.xml 覆盖 \u003ccode\u003e/data/sonatype-work/nexus/conf/nexus.xml\u003c/code\u003e 目录下的nexus.xml文件，可以直接获得配置。注意，第一次启动Nexus时，并没有 sonatype-work 目录及其子目录，需要在覆盖 nexus.xml 文件后重新启动nexus\u003c/p\u003e\n\u003cp\u003e1、上传Nexus.tar.gz到系统根目录下并解压\u003c/p\u003e\n\u003cp\u003e2、运行nexus，命令为\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport RUN_AS_USER=root\n./nexus start\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e默认存储路径为：（Nexus根目录在/data下）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efile:/data/sonatype-work/nexus/storage/central/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"注意\"\u003e注意：\u003c/h3\u003e\n\u003cp\u003e扩充Nexus时，一定要先执行如下三步：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum clean all\nyum repolist\nyum makecache\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"配置-yumepeldocker-源\"\u003e配置 yum，epel，docker 源\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e使用阿里云或中科大的yum和epel源\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"base\"\u003eBase\u003c/h4\u003e\n\u003cp\u003e创建仓库，类型为：proxy，\u003c/p\u003e\n\u003cp\u003e仓库id：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecentos7_base #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7_base/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e名称为：CentOS7-Base\u003c/p\u003e\n\u003cp\u003eRemote Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://mirrors.aliyun.com/centos/7.3.1611/os/x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOverride Local Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efile:/data/sonatype-work/nexus/storage/Base-x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDownload Remote Indexes，选为：true\u003c/p\u003e\n\u003cp\u003e仓库路径：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://192.168.244.129:8081/nexus/content/repositories/centos7_base/\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"update\"\u003eUpdate\u003c/h4\u003e\n\u003cp\u003e创建仓库，类型为：proxy，\u003c/p\u003e\n\u003cp\u003e仓库id：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecentos7-updates #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-updates/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e名称为：CentOS7-Updates\u003c/p\u003e\n\u003cp\u003eRemote Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttps://mirrors.aliyun.com/centos/7/updates/x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOverride Local Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efile:/data/sonatype-work/nexus/storage/centos7-updates/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDownload Remote Indexes，选为：true\u003c/p\u003e\n\u003cp\u003e仓库路径：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://192.168.244.129:8081/nexus/content/repositories/centos7-updates/\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"extras\"\u003eExtras\u003c/h4\u003e\n\u003cp\u003e创建仓库，类型为：proxy，\u003c/p\u003e\n\u003cp\u003e仓库id：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecentos7-extras #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-extras/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e名称为：CentOS7-Extras\u003c/p\u003e\n\u003cp\u003eRemote Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttps://mirrors.aliyun.com/centos/7/extras/x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOverride Local Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efile:/data/sonatype-work/nexus/storage/centos7-extras/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDownload Remote Indexes，选为：true\n仓库路径：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://192.168.244.129:8081/nexus/content/repositories/centos7-extras/\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"docker\"\u003eDocker\u003c/h4\u003e\n\u003cp\u003e创建仓库，类型为：proxy，\u003c/p\u003e\n\u003cp\u003e仓库id：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecentos7-docker #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-docker/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e名称为：CentOS7-Docker\u003c/p\u003e\n\u003cp\u003eRemote Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttps://yum.dockerproject.org/repo/main/centos/7/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOverride Local Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efile:/data/sonatype-work/nexus/storage/centos7-docker/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDownload Remote Indexes，选为：true\n仓库路径：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://192.168.244.129:8081/nexus/content/repositories/centos7-docker/\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"docker-ce\"\u003eDocker CE\u003c/h4\u003e\n\u003cp\u003e创建仓库，类型为：proxy，\u003c/p\u003e\n\u003cp\u003e仓库id：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecentos7-dockerce #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-dockerce/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e名称为：CentOS7-DockerCE\u003c/p\u003e\n\u003cp\u003eRemote Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttps://download.docker.com/linux/centos/7/x86_64/stable/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOverride Local Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efile:/data/sonatype-work/nexus/storage/centos7-dockerce/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDownload Remote Indexes，选为：true\n仓库路径：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://192.168.244.129:8081/nexus/content/repositories/centos7-dockerce/\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"epel\"\u003eEPEL\u003c/h4\u003e\n\u003cp\u003e创建仓库，类型为：proxy，\u003c/p\u003e\n\u003cp\u003e仓库id：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecentos7-epel #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-epel/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e名称为：CentOS7-Docker\u003c/p\u003e\n\u003cp\u003eRemote Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttps://mirrors.aliyun.com/epel/7/x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOverride Local Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efile:/data/sonatype-work/nexus/storage/centos7-epel/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDownload Remote Indexes，选为：true\n仓库路径：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://192.168.244.129:8081/nexus/content/repositories/centos7-epel/\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"ustc-epel\"\u003eUSTC EPEL\u003c/h4\u003e\n\u003cp\u003e创建仓库，类型为：proxy，\u003c/p\u003e\n\u003cp\u003e仓库id：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecentos7-ustc-epel #则其访问路径为：http://192.168.244.129:8081/nexus/content/repositories/centos7-ustc-epel/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e名称为：CentOS7-USTC-EPEL\u003c/p\u003e\n\u003cp\u003eRemote Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttps://mirrors.ustc.edu.cn/epel/7/x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOverride Local Storage Location：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efile:/data/sonatype-work/nexus/storage/centos7-ustc-epel/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDownload Remote Indexes，选为：true\n仓库路径：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://192.168.244.129:8081/nexus/content/repositories/centos7-ustc-epel/\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"使用自定义的repo\"\u003e使用自定义的repo\u003c/h3\u003e\n\u003cp\u003exdhuxc.repo的内容如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[base]\nname=CentOS-$releasever - Base\nbaseurl=http://192.168.244.129:8081/nexus/content/repositories/centos7_base/ # 此路径为仓库路径\ngpgcheck=0\ngpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-CentOS-7\n\n[updates]\nname=CentOS-$releasever - Updates\nbaseurl=http://192.168.244.129:8081/nexus/content/repositories/centos7-updates/\ngpgcheck=0\ngpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-CentOS-7\n\n[extras]\nname=CentOS-$releasever - Extras\nhttp://192.168.244.129:8081/nexus/content/repositories/centos7-extras/\ngpgcheck=0\ngpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-CentOS-7\n\n[epel]\nname=Extra Packages for Enterprise Linux 7 - $basearch\nbaseurl=http://192.168.244.129:8081/nexus/content/repositories/centos7-epel/\nfailovermethod=priority\nenabled=1\ngpgcheck=0\ngpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-EPEL-7\n\n[dockerrepo]\nname=Docker Repository\nbaseurl=http://192.168.244.129:8081/nexus/content/repositories/centos7-docker/\nenabled=1\ngpgcheck=0\ngpgkey=http://192.168.244.129:8081/nexus/content/repositories/rpm-gpg/RPM-GPG-KEY-docker\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e复制xdhuxc.repo到/etc/yum.repos.d目录下，执行如下命令：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak\nmv xdhuxc.repo /etc/yum.repos.d/CentOS-Base.repo\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e使用自己的nexus.xml覆盖\u003ccode\u003e/data/sonatype-work/nexus/conf /nexus.xml\u003c/code\u003e目录下的nexus.xml文件，可以直接获得配置。注意，第一次启动Nexus时，并没有sonatype-work目录及其子目录，需要在覆盖nexus.xml文件后重新启动nexus\u003c/p\u003e\n\u003cp\u003e清除yum并生成缓存，执行如下命令：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eyum clean\nyum makecache\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eeple:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://mirror.premi.st/epel/7/x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://mirrors.aliyun.com/epel/6/x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003epuppetlabs\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://yum.puppetlabs.com/el/7/products/x86_64/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003epuppetlabdsdependencies\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ehttp://yum.puppetlabs.com/el/7/dependencies/x86_64/\n\u003c/code\u003e\u003c/pre\u003e","date":1506038400,"description":"","fuzzywordcount":2000,"kind":"page","lang":"zh","lastmod":1545436800,"objectID":"5e8b7d875a39a19da31ffa92a811846b","publishdate":1506038400,"relpermalink":"/posts/mixed/nexus/nexus-install-configuration/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了 Nexus 的安装和配置。\u003c/p\u003e","tags":["Nexus"],"title":"Nexus 安装和自定义配置","url":"https://xdhuxc.github.io/posts/mixed/nexus/nexus-install-configuration/","wordcount":1916},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Python 语言中的日期、时间、函数和模块。\u003c/p\u003e\n\u003ch1 id=\"一日期和时间\"\u003e一、日期和时间\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePython 程序能用很多方式处理日期和时间，转换日期格式是一个常见的功能。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003ePython 提供了一个 time 和 calendar 模块可以用于格式化日期和时间。\u003c/p\u003e\n\u003cp\u003e时间间隔是以秒为单位的浮点小数。\u003c/p\u003e\n\u003cp\u003e每个时间戳都以自从1970年1月1日午夜（历元）经过了多长时间来表示。\u003c/p\u003e\n\u003cp\u003ePython 的 time 模块下有很多函数可以转换常见日期格式。如函数time.time()用于获取当前时间戳, 如下所示：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/python\n# -*- coding: UTF-8 -*-\n\nimport time;  # 引入time模块\n\nticks = time.time()\nprint \u0026quot;当前时间戳为:\u0026quot;, ticks\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e时间戳单位最适于做日期运算。但是1970年之前的日期就无法以此表示了。太遥远的日期也不行，UNIX和Windows只支持到2038年。\u003c/p\u003e\n\u003ch2 id=\"时间元组\"\u003e时间元组\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e很多Python函数用一个元组装起来的9组数字处理时间\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e字段\u003c/th\u003e\n\u003cth\u003e值\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e0\u003c/td\u003e\n\u003ctd\u003e四位数字年\u003c/td\u003e\n\u003ctd\u003e2008\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003e月\u003c/td\u003e\n\u003ctd\u003e1到12\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003e日\u003c/td\u003e\n\u003ctd\u003e1到31\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003e小时\u003c/td\u003e\n\u003ctd\u003e0到23\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003e分钟\u003c/td\u003e\n\u003ctd\u003e0到59\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003e秒\u003c/td\u003e\n\u003ctd\u003e0到61（60或61是闰秒）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003e一周的第几日\u003c/td\u003e\n\u003ctd\u003e0到6（0是周一）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003e一年的第几日\u003c/td\u003e\n\u003ctd\u003e1到366（儒略历）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003e夏令时\u003c/td\u003e\n\u003ctd\u003e-1, 0, 1, -1是决定是否为夏令时的旗帜\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e上述也就是struct_time元组。这种结构具有如下属性：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e序号\u003c/th\u003e\n\u003cth\u003e属性\u003c/th\u003e\n\u003cth\u003e值\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e0\u003c/td\u003e\n\u003ctd\u003etm_year\u003c/td\u003e\n\u003ctd\u003e2008\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e1\u003c/td\u003e\n\u003ctd\u003etm_mon\u003c/td\u003e\n\u003ctd\u003e1到12\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2\u003c/td\u003e\n\u003ctd\u003etm_mday\u003c/td\u003e\n\u003ctd\u003e1到31\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e3\u003c/td\u003e\n\u003ctd\u003etm_hour\u003c/td\u003e\n\u003ctd\u003e0到23\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e4\u003c/td\u003e\n\u003ctd\u003etm_min\u003c/td\u003e\n\u003ctd\u003e0到59\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5\u003c/td\u003e\n\u003ctd\u003etm_sec\u003c/td\u003e\n\u003ctd\u003e0到61（60或61是闰秒）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6\u003c/td\u003e\n\u003ctd\u003etm_wday\u003c/td\u003e\n\u003ctd\u003e0到6（0是周一）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7\u003c/td\u003e\n\u003ctd\u003etm_yday\u003c/td\u003e\n\u003ctd\u003e1到366（儒略历）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd\u003etm_isdst\u003c/td\u003e\n\u003ctd\u003e-1, 0, 1, -1是决定是否为夏令时的旗帜\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch4 id=\"获取当前时间\"\u003e获取当前时间\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e从返回浮点数的时间戳方式向时间元组转换，只要将浮点数传递给如localtime之类的函数。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/python\n# -*- coding: UTF-8 -*-\n\nimport time\n\nlocaltime = time.localtime(time.time())\nprint \u0026quot;本地时间为 :\u0026quot;, localtime\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"获取格式化的时间\"\u003e获取格式化的时间\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e可以根据需求选取各种格式，但是最简单的获取可读的时间模式的函数是asctime()。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/python\n# -*- coding: UTF-8 -*-\n\nimport time\n\nlocaltime = time.asctime( time.localtime(time.time()) )\nprint \u0026quot;本地时间为 :\u0026quot;, localtime\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"格式化日期\"\u003e格式化日期\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e可以使用 time 模块的 strftime 方法来格式化日期。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003etime.strftime(format[, t])\n\u003c/code\u003e\u003c/pre\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/python\n# -*- coding: UTF-8 -*-\n\nimport time\n\n# 格式化成2016-03-20 11:45:39形式\nprint time.strftime(\u0026quot;%Y-%m-%d %H:%M:%S\u0026quot;, time.localtime()) \n\n# 格式化成Sat Mar 28 22:24:24 2016形式\nprint time.strftime(\u0026quot;%a %b %d %H:%M:%S %Y\u0026quot;, time.localtime()) \n  \n# 将格式字符串转换为时间戳\na = \u0026quot;Sat Mar 28 22:24:24 2016\u0026quot;\nprint time.mktime(time.strptime(a,\u0026quot;%a %b %d %H:%M:%S %Y\u0026quot;))\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ePython中时间日期格式化符号\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e%y 两位数的年份表示（00-99）\u003c/li\u003e\n\u003cli\u003e%Y 四位数的年份表示（000-9999）\u003c/li\u003e\n\u003cli\u003e%m 月份（01-12）\u003c/li\u003e\n\u003cli\u003e%d 月内中的一天（0-31）\u003c/li\u003e\n\u003cli\u003e%H 24小时制小时数（0-23）\u003c/li\u003e\n\u003cli\u003e%I 12小时制小时数（01-12）\u003c/li\u003e\n\u003cli\u003e%M 分钟数（00=59）\u003c/li\u003e\n\u003cli\u003e%S 秒（00-59）\u003c/li\u003e\n\u003cli\u003e%a 本地简化星期名称\u003c/li\u003e\n\u003cli\u003e%A 本地完整星期名称\u003c/li\u003e\n\u003cli\u003e%b 本地简化的月份名称\u003c/li\u003e\n\u003cli\u003e%B 本地完整的月份名称\u003c/li\u003e\n\u003cli\u003e%c 本地相应的日期表示和时间表示\u003c/li\u003e\n\u003cli\u003e%j 年内的一天（001-366）\u003c/li\u003e\n\u003cli\u003e%p 本地A.M.或P.M.的等价符\u003c/li\u003e\n\u003cli\u003e%U 一年中的星期数（00-53）星期天为星期的开始\u003c/li\u003e\n\u003cli\u003e%w 星期（0-6），星期天为星期的开始\u003c/li\u003e\n\u003cli\u003e%W 一年中的星期数（00-53）星期一为星期的开始\u003c/li\u003e\n\u003cli\u003e%x 本地相应的日期表示\u003c/li\u003e\n\u003cli\u003e%X 本地相应的时间表示\u003c/li\u003e\n\u003cli\u003e%Z 当前时区的名称\u003c/li\u003e\n\u003cli\u003e%% %号本身\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"获取某月日历\"\u003e获取某月日历\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCalendar模块有很广泛的方法用来处理年历和月历，例如打印某月的月历。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/python\n# -*- coding: UTF-8 -*-\n\nimport calendar\n\ncal = calendar.month(2016, 1)\nprint \u0026quot;以下输出2016年1月份的日历:\u0026quot;\nprint cal;\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"其他相关模块和函数\"\u003e其他相关模块和函数\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e在Python中，其他处理日期和时间的模块还有:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003edatetime模块\u003c/li\u003e\n\u003cli\u003epytz模块\u003c/li\u003e\n\u003cli\u003edateutil模块\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"二python函数\"\u003e二、Python函数\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e函数是组织好的，可重复使用的，用来实现单一，或相关联功能的代码段。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e函数能提高应用的模块性，和代码的重复利用率。Python提供了许多内建函数，比如print()。也可以自己创建函数，这被叫做用户自定义函数。\u003c/p\u003e\n\u003ch3 id=\"一定义一个函数\"\u003e（一）定义一个函数\u003c/h3\u003e\n\u003cp\u003e可以定义一个由自己想要功能的函数，以下是简单的规则：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e函数代码块以 def 关键词开头，后接函数标识符名称和圆括号()。\u003c/li\u003e\n\u003cli\u003e任何传入参数和自变量必须放在圆括号中间。圆括号之间可以用于定义参数。\u003c/li\u003e\n\u003cli\u003e函数的第一行语句可以选择性地使用文档字符串—用于存放函数说明。\u003c/li\u003e\n\u003cli\u003e函数内容以冒号起始，并且缩进。\u003c/li\u003e\n\u003cli\u003ereturn [表达式] 结束函数，选择性地返回一个值给调用方。不带表达式的return相当于返回 None。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"语法\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edef functionname( parameters ):\n   \u0026quot;函数_文档字符串\u0026quot;\n   function_suite\n   return [expression]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e默认情况下，参数值和参数名称是按函数声明中定义的的顺序匹配起来的。\u003c/p\u003e\n\u003ch3 id=\"二函数调用\"\u003e（二）函数调用\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e定义一个函数只给了函数一个名称，指定了函数里包含的参数，和代码块结构。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e这个函数的基本结构完成以后，可以通过另一个函数调用执行，也可以直接从Python提示符执行。\u003c/p\u003e\n\u003ch3 id=\"三参数传递\"\u003e（三）参数传递\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e在 python 中，类型属于对象，变量是没有类型的。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ea=[1,2,3]\na=\u0026quot;Runoob\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e[1,2,3] 是 List 类型，\u0026quot;Runoob\u0026quot; 是 String 类型，而变量 a 是没有类型，她仅仅是一个对象的引用（一个指针），可以是 List 类型对象，也可以指向 String 类型对象。\u003c/p\u003e\n\u003ch4 id=\"可更改mutable与不可更改immutable对象\"\u003e可更改(mutable)与不可更改(immutable)对象\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e在 python 中，字符串, 元组, 和 数字 是不可更改的对象，而 列表,字典 等则是可以修改的对象。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e不可变类型：变量赋值 a=5 后再赋值 a=10，这里实际是新生成一个 int 值对象 10，再让 a 指向它，而 5 被丢弃，不是改变a的值，相当于新生成了a。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e可变类型：变量赋值 la=[1,2,3,4] 后再赋值 la[2]=5 则是将 list la 的第三个元素值更改，本身la没有动，只是其内部的一部分值被修改了。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003epython 函数的参数传递：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e不可变类型：类似 c++ 的值传递，如 整数、字符串、元组。如fun（a），传递的只是a的值，没有影响a对象本身。比如在 fun（a）内部修改 a 的值，只是修改另一个复制的对象，不会影响 a 本身。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e可变类型：类似 c++ 的引用传递，如 列表，字典。如 fun（la），则是将 la 真正的传过去，修改后fun外部的la也会受影响\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003epython 中一切都是对象，严格意义我们不能说值传递还是引用传递，我们应该说传不可变对象和传可变对象。\u003c/p\u003e\n\u003ch3 id=\"四参数\"\u003e（四）参数\u003c/h3\u003e\n\u003cp\u003e调用函数时可使用的正式参数类型：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e必备参数\u003c/li\u003e\n\u003cli\u003e关键字参数\u003c/li\u003e\n\u003cli\u003e默认参数\u003c/li\u003e\n\u003cli\u003e不定长参数\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"必备参数\"\u003e必备参数\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e必备参数须以正确的顺序传入函数。调用时的数量必须和声明时的一样。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"关键字参数\"\u003e关键字参数\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e关键字参数和函数调用关系紧密，函数调用使用关键字参数来确定传入的参数值。\n使用关键字参数允许函数调用时参数的顺序与声明时不一致，因为 Python 解释器能够用参数名匹配参数值。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"缺省参数\"\u003e缺省参数\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e调用函数时，缺省参数的值如果没有传入，则被认为是默认值。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"不定长参数\"\u003e不定长参数\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e可能需要一个函数能处理比当初声明时更多的参数，这些参数叫做不定长参数，声明时不会命名。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e基本语法如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edef functionname([formal_args,] *var_args_tuple ):\n   \u0026quot;函数_文档字符串\u0026quot;\n   function_suite\n   return [expression]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e加了星号（*）的变量名会存放所有未命名的变量参数。选择不多传参数也可。\u003c/p\u003e\n\u003ch3 id=\"五匿名函数\"\u003e（五）匿名函数\u003c/h3\u003e\n\u003cp\u003epython 使用 lambda 来创建匿名函数\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003elambda只是一个表达式，函数体比def简单很多。\u003c/li\u003e\n\u003cli\u003elambda的主体是一个表达式，而不是一个代码块。仅仅能在lambda表达式中封装有限的逻辑进去。\u003c/li\u003e\n\u003cli\u003elambda函数拥有自己的命名空间，且不能访问自有参数列表之外或全局命名空间里的参数。\u003c/li\u003e\n\u003cli\u003e虽然lambda函数看起来只能写一行，却不等同于C++的内联函数，后者的目的是调用小函数时不占用栈内存从而增加运行效率。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"语法-1\"\u003e语法\u003c/h4\u003e\n\u003cp\u003elambda函数的语法只包含一个语句，如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003elambda [arg1 [,arg2,.....argn]]:expression\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"六return语句\"\u003e（六）return语句\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003ereturn语句[表达式]退出函数，选择性地向调用方返回一个表达式。不带参数值的return语句返回None。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"七变量作用域\"\u003e（七）变量作用域\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e一个程序的所有的变量并不是在哪个位置都可以访问的。访问权限决定于这个变量是在哪里赋值的。\n变量的作用域决定了在哪一部分程序你可以访问哪个特定的变量名称。两种最基本的变量作用域如下：\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e全局变量\u003c/li\u003e\n\u003cli\u003e局部变量\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e定义在函数内部的变量拥有一个局部作用域，定义在函数外的拥有全局作用域。\n局部变量只能在其被声明的函数内部访问，而全局变量可以在整个程序范围内访问。调用函数时，所有在函数内声明的变量名称都将被加入到作用域中。\u003c/p\u003e\n\u003cp\u003e全局变量想作用于函数内，需加 global修饰\n1、global---将变量定义为全局变量。可以通过定义为全局变量，实现在函数内部改变变量值。\n2、一个global语句可以同时定义多个变量，如 global x, y, z。\u003c/p\u003e\n\u003ch1 id=\"三模块\"\u003e三、模块\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePython 模块(Module)，是一个 Python 文件，以 .py 结尾，包含了 Python 对象定义和Python语句。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e模块能够有逻辑地组织Python代码段，把相关的代码分配到一个模块里能让代码更好用，更易懂。\u003c/p\u003e\n\u003cp\u003e模块能定义函数，类和变量，模块里也能包含可执行的代码。\u003c/p\u003e\n\u003ch3 id=\"import语句\"\u003eimport语句\u003c/h3\u003e\n\u003cp\u003e模块定义好后，我们可以使用 import 语句来引入模块，语法如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eimport module1[, module2[,... moduleN]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e要引用模块 math，就可以在文件最开始的地方用 import math 来引入。在调用 math 模块中的函数时，必须这样引用：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emodule_name.function_name\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e当解释器遇到 import 语句，如果模块在当前的搜索路径就会被导入。\n搜索路径是一个解释器会先进行搜索的所有目录的列表。如想要导入模块 support.py，需要把命令放在脚本的顶端。\u003c/p\u003e\n\u003cp\u003e一个模块只会被导入一次，不管执行了多少次import。这样可以防止导入模块被一遍又一遍地执行。\u003c/p\u003e\n\u003ch3 id=\"fromimport-语句\"\u003eFrom…import 语句\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePython 的 from 语句从模块中导入一个指定的部分到当前命名空间中。\n语法如下：\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efrom modname import name1[, name2[, ... nameN]]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e要导入模块 fib 的 fibonacci 函数，使用如下语句：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efrom fib import fibonacci\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e这个声明不会把整个 fib 模块导入到当前的命名空间中，它只会将 fib 里的 fibonacci 单个引入到执行这个声明的模块的全局符号表。\u003c/p\u003e\n\u003ch3 id=\"fromimport-语句-1\"\u003eFrom…import* 语句\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e把一个模块的所有内容全都导入到当前的命名空间也是可行的。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e只需使用如下声明：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efrom modname import *\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e这提供了一个简单的方法来导入一个模块中的所有项目。然而这种声明不该被过多地使用。\n例如我们想一次性引入 math 模块中所有的东西，语句如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efrom math import * \n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"搜索路径\"\u003e搜索路径\u003c/h3\u003e\n\u003cp\u003e当导入一个模块，Python 解析器对模块位置的搜索顺序是：\n1、当前目录\n2、如果不在当前目录，Python 则搜索在 shell 变量 PYTHONPATH 下的每个目录。\n3、如果都找不到，Python会查看默认路径。UNIX下，默认路径一般为/usr/local/lib/python/。\u003c/p\u003e\n\u003cp\u003e模块搜索路径存储在 system 模块的 sys.path 变量中。变量里包含当前目录，PYTHONPATH和由安装过程决定的默认目录。\u003c/p\u003e\n\u003ch4 id=\"pythonpath-变量\"\u003ePYTHONPATH 变量\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e作为环境变量，PYTHONPATH 由装在一个列表里的许多目录组成。PYTHONPATH 的语法和 shell 变量 PATH 的一样。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e在 Windows 系统，典型的 PYTHONPATH 如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eset PYTHONPATH=c:\\python27\\lib;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在 UNIX 系统，典型的 PYTHONPATH 如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eset PYTHONPATH=/usr/local/lib/python\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"命名空间和作用域\"\u003e命名空间和作用域\u003c/h4\u003e\n\u003cp\u003e变量是拥有匹配对象的名字（标识符）。命名空间是一个包含了变量名称（键）和它们各自相应的对象（值）的字典。\u003c/p\u003e\n\u003cp\u003e一个 Python 表达式可以访问局部命名空间和全局命名空间里的变量。如果一个局部变量和一个全局变量重名，则局部变量会覆盖全局变量。\u003c/p\u003e\n\u003cp\u003e每个函数都有自己的命名空间。类的方法的作用域规则和通常函数的一样。\u003c/p\u003e\n\u003cp\u003ePython 会智能地猜测一个变量是局部的还是全局的，它假设任何在函数内赋值的变量都是局部的。\n因此，如果要给函数内的全局变量赋值，必须使用 global 语句。\u003c/p\u003e\n\u003cp\u003eglobal VarName 的表达式会告诉 Python， VarName 是一个全局变量，这样 Python 就不会在局部命名空间里寻找这个变量了。\u003c/p\u003e\n\u003ch3 id=\"dir函数\"\u003edir()函数\u003c/h3\u003e\n\u003cp\u003edir() 函数一个排好序的字符串列表，内容是一个模块里定义过的名字。\n返回的列表容纳了在一个模块里定义的所有模块，变量和函数。如下一个简单的实例：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/python\n# -*- coding: UTF-8 -*-\n \n# 导入内置math模块\nimport math\n \ncontent = dir(math)\n \nprint content;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e以上实例输出结果：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e['__doc__', '__file__', '__name__', 'acos', 'asin', 'atan', \n'atan2', 'ceil', 'cos', 'cosh', 'degrees', 'e', 'exp', \n'fabs', 'floor', 'fmod', 'frexp', 'hypot', 'ldexp', 'log',\n'log10', 'modf', 'pi', 'pow', 'radians', 'sin', 'sinh', \n'sqrt', 'tan', 'tanh']\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e在这里，特殊字符串变量__name__指向模块的名字，__file__指向该模块的导入文件名。\u003c/p\u003e\n\u003ch3 id=\"globals-和-locals-函数\"\u003eglobals() 和 locals() 函数\u003c/h3\u003e\n\u003cp\u003e根据调用位置的不同，globals() 和 locals() 函数可被用来返回全局和局部命名空间里的名字。\n如果在函数内部调用 locals()，返回的是所有能在该函数里访问的命名。\n如果在函数内部调用 globals()，返回的是所有在该函数里能访问的全局名字。\n两个函数的返回类型都是字典。所以名字能用 keys() 函数获取。\u003c/p\u003e\n\u003ch3 id=\"reload函数\"\u003ereload()函数\u003c/h3\u003e\n\u003cp\u003e当一个模块被导入到一个脚本，模块顶层部分的代码只会被执行一次。\n因此，如果你想重新执行模块里顶层部分的代码，可以用 reload() 函数。该函数会重新导入之前导入过的模块。语法如下：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ereload(module_name) # 在这里，module_name要直接放模块的名字，而不是一个字符串形式\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"python中的包\"\u003ePython中的包\u003c/h3\u003e\n\u003cp\u003e包是一个分层次的文件目录结构，它定义了一个由模块及子包，和子包下的子包等组成的 Python 的应用环境。\u003c/p\u003e\n\u003cp\u003e简单来说，包就是文件夹，但该文件夹下必须存在 \u003cstrong\u003einit\u003c/strong\u003e.py 文件, 该文件的内容可以为空。\u003cstrong\u003eint\u003c/strong\u003e.py用于标识当前文件夹是一个包。\u003c/p\u003e","date":1505865600,"description":"","fuzzywordcount":4900,"kind":"page","lang":"zh","lastmod":1505865600,"objectID":"bd5dee217e476280299f0ba322803efd","publishdate":1505865600,"relpermalink":"/posts/programming/python/python-date-time/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Python 语言中的日期、时间、函数和模块。\u003c/p\u003e","tags":["Python"],"title":"Python 中的日期、时间、函数和模块","url":"https://xdhuxc.github.io/posts/programming/python/python-date-time/","wordcount":4829},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Python 语言中的数据类型。\u003c/p\u003e\n\u003ch3 id=\"python变量类型\"\u003ePython变量类型\u003c/h3\u003e\n\u003cp\u003e变量存储在内存中的值。这就意味着在创建变量时会在内存中开辟一个空间。\u003c/p\u003e\n\u003cp\u003e基于变量的数据类型，解释器会分配指定内存，并决定什么数据可以被存储在内存中。\u003c/p\u003e\n\u003cp\u003e因此，变量可以指定不同的数据类型，这些变量可以存储整数，小数或字符。\u003c/p\u003e\n\u003ch3 id=\"变量赋值\"\u003e变量赋值\u003c/h3\u003e\n\u003cp\u003ePython 中的变量赋值不需要类型声明。\u003c/p\u003e\n\u003cp\u003e每个变量在内存中创建，都包括变量的标识，名称和数据这些信息。\u003c/p\u003e\n\u003cp\u003e每个变量在使用前都必须赋值，变量赋值以后该变量才会被创建。\u003c/p\u003e\n\u003cp\u003e等号（=）用来给变量赋值。\u003c/p\u003e\n\u003cp\u003e等号（=）运算符左边是一个变量名,等号（=）运算符右边是存储在变量中的值。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/env\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \ncounter = 100 # 赋值整型变量\nmiles = 1000.0 # 浮点型\nname = \u0026#34;John\u0026#34; # 字符串\n \nprint counter\nprint miles\nprint name\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"多个变量赋值\"\u003e多个变量赋值\u003c/h3\u003e\n\u003cp\u003ePython 允许你同时为多个变量赋值。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ea = b = c = 1 # 创建一个整型对象，值为1，三个变量被分配到相同的内存空间上。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以为多个对象指定多个变量。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ea, b, c = 1, 2, \u0026#34;john\u0026#34; # 两个整型对象1和2分别分配给变量 a 和 b，字符串对象 \u0026#34;john\u0026#34; 分配给变量 c。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"标准数据类型\"\u003e标准数据类型\u003c/h3\u003e\n\u003cp\u003e在内存中存储的数据可以有多种类型。Python定义了一些标准类型，用于存储各种类型的数据。\u003c/p\u003e\n\u003cp\u003ePython有五个标准的数据类型：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNumbers（数字）\u003c/li\u003e\n\u003cli\u003eString（字符串）\u003c/li\u003e\n\u003cli\u003eList（列表）\u003c/li\u003e\n\u003cli\u003eTuple（元组）\u003c/li\u003e\n\u003cli\u003eDictionary（字典）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003epython 的所有数据类型都是类,可以通过 type() 查看该变量的数据类型。\u003c/p\u003e\n\u003ch5 id=\"数字\"\u003e数字\u003c/h5\u003e\n\u003cp\u003e数字数据类型用于存储数值，不可改变的数据类型，这意味着改变数字数据类型会分配一个新的对象。\u003c/p\u003e\n\u003cp\u003e当你指定一个值时，Number对象就会被创建，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003evar_a = 1\nvar_b = 12\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以通过使用del语句删除单个或多个对象的引用，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edel var\ndel var_a, var_b\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ePython支持四种不同的数字类型：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eint（有符号整型），通常被称为是整型或整数，是正或负整数，不带小数点。\u003c/li\u003e\n\u003cli\u003elong（长整型[也可以代表八进制和十六进制]），无限大小的整数，整数最后是一个大写或小写的L。\u003c/li\u003e\n\u003cli\u003efloat（浮点型），浮点型由整数部分与小数部分组成，浮点型也可以使用科学计数法表示。\u003c/li\u003e\n\u003cli\u003ecomplex（复数），复数由实数部分和虚数部分构成，可以用a + bj,或者complex(a,b)表示， 复数的实部a和虚部b都是浮点型。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e注意：\u003c/p\u003e\n\u003cp\u003e1、长整型也可以使用小写\u0026quot;l\u0026quot;，建议使用大写\u0026quot;L\u0026quot;，避免与数字\u0026quot;1\u0026quot;混淆。Python使用\u0026quot;L\u0026quot;来显示长整型。\u003c/p\u003e\n\u003cp\u003e2、Python还支持复数，复数由实数部分和虚数部分构成，可以\u003ccode\u003e用a + bj\u003c/code\u003e,或者\u003ccode\u003ecomplex(a,b)\u003c/code\u003e表示， 复数的实部a和虚部b都是\u003ccode\u003e浮点型\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"字符串\"\u003e字符串\u003c/h4\u003e\n\u003cp\u003e字符串或串(String)是由数字、字母、下划线组成的一串字符。\u003c/p\u003e\n\u003cp\u003e一般记为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003es=\u0026#34;a1a2···an\u0026#34;(n\u0026gt;=0) 是编程语言中表示文本的数据类型。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003epython的字串列表有2种取值顺序：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e从左到右索引，默认从0开始，最大范围是字符串长度-1；\u003c/li\u003e\n\u003cli\u003e从右到左索引，默认从-1开始，最大范围是字符串开头；\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePython不支持单字符类型，单字符也在Python也是作为一个字符串使用。\u003c/p\u003e\n\u003cp\u003e如果要实现从字符串中获取一段子字符串的话，可以使用变量[头下标:尾下标]，就可以截取相应的字符串，其中下标是从0开始算起，可以是正数或负数，下标可以为空表示取到头或尾。\n例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003es = \u0026#39;ilovepython\u0026#39;，则s[1:5]的结果为：love，取到的最大范围包括下边界、不包括上边界。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e当使用以冒号分隔的字符串，python返回一个新的对象，结果包含了以这对偏移标识的连续的内容，左边的开始是包含了下边界。\u003c/p\u003e\n\u003cp\u003e加号（+）是字符串连接运算符，星号（*）是重复操作。\u003c/p\u003e\n\u003ch4 id=\"字符串格式化\"\u003e字符串格式化\u003c/h4\u003e\n\u003cp\u003ePython 支持格式化字符串的输出 。尽管这样可能会用到非常复杂的表达式，但最基本的用法是将一个值插入到一个有字符串格式符 %s 的字符串中。\u003c/p\u003e\n\u003cp\u003e在 Python 中，字符串格式化使用与 C 中 sprintf 函数一样的语法。\n如下示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nprint \u0026#34;My name is %s and weight is %d kg!\u0026#34; % (\u0026#39;Zara\u0026#39;, 21) \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e输出结果为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eMy name is Zara and weight is 21 kg!\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"python字符串格式化符号\"\u003ePython字符串格式化符号\u003c/h4\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e符号\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e%c\u003c/td\u003e\n\u003ctd\u003e格式化字符及其ASCII码\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%s\u003c/td\u003e\n\u003ctd\u003e格式化字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%d\u003c/td\u003e\n\u003ctd\u003e格式化整数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%u\u003c/td\u003e\n\u003ctd\u003e格式化无符号整型\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%o\u003c/td\u003e\n\u003ctd\u003e格式化无符号八进制数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%x\u003c/td\u003e\n\u003ctd\u003e格式化无符号十六进制数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%X\u003c/td\u003e\n\u003ctd\u003e格式化无符号十六进制数（大写）\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%f\u003c/td\u003e\n\u003ctd\u003e格式化浮点数字，可指定小数点后的精度\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%e\u003c/td\u003e\n\u003ctd\u003e用科学计数法格式化浮点数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%E\u003c/td\u003e\n\u003ctd\u003e作用同%e，用科学计数法格式化浮点数\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%g\u003c/td\u003e\n\u003ctd\u003e%f和%e的简写\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%p\u003c/td\u003e\n\u003ctd\u003e用十六进制数格式化变量的地址\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%G\u003c/td\u003e\n\u003ctd\u003e%f 和 %E 的简写\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"python三引号\"\u003ePython三引号\u003c/h3\u003e\n\u003cp\u003epython中三引号可以将复杂的字符串进行复制:\u003c/p\u003e\n\u003cp\u003epython三引号允许一个字符串跨多行，字符串中可以包含换行符、制表符以及其他特殊字符。\u003c/p\u003e\n\u003cp\u003e三引号的语法是一对连续的单引号或者双引号（通常都是成对的用）。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026gt;\u0026gt;\u0026gt; hi = \u0026#39;\u0026#39;\u0026#39;hi \nthere\u0026#39;\u0026#39;\u0026#39;\n\u0026gt;\u0026gt;\u0026gt; hi   # repr()\n\u0026#39;hi\\nthere\u0026#39;\n\u0026gt;\u0026gt;\u0026gt; print hi  # str()\nhi \nthere  \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e三引号让程序员从引号和特殊字符串的泥潭里面解脱出来，自始至终保持一小块字符串的格式是所谓的WYSIWYG（所见即所得）格式的。\u003c/p\u003e\n\u003cp\u003e一个典型的用例是，当你需要一块HTML或者SQL时，这时用字符串组合，特殊字符串转义将会非常的繁琐。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eerrHTML = \u0026#39;\u0026#39;\u0026#39;\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eHTML\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eHEAD\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eTITLE\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\nFriends CGI Demo\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eTITLE\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eHEAD\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBODY\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eH3\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003eERROR\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eH3\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e%s\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eFORM\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eINPUT\u003c/span\u003e \u003cspan class=\"na\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003ebutton\u003c/span\u003e \u003cspan class=\"na\"\u003eVALUE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003eBack\u003c/span\u003e\n\u003cspan class=\"na\"\u003eONCLICK\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;window.history.back()\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eFORM\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eBODY\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eHTML\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u0026#39;\u0026#39;\u0026#39;\ncursor.execute(\u0026#39;\u0026#39;\u0026#39;\nCREATE TABLE users (  \nlogin VARCHAR(8), \nuid INTEGER,\nprid INTEGER)\n\u0026#39;\u0026#39;\u0026#39;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"unicode字符串\"\u003eUnicode字符串\u003c/h4\u003e\n\u003cp\u003ePython 中定义一个 Unicode 字符串和定义一个普通字符串一样简单：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026gt;\u0026gt;\u0026gt; u\u0026#39;Hello World !\u0026#39;\nu\u0026#39;Hello World !\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e引号前小写的\u0026quot;u\u0026quot;表示这里创建的是一个 Unicode 字符串。如果你想加入一个特殊字符，可以使用 Python 的 Unicode-Escape 编码。如下例所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026gt;\u0026gt;\u0026gt; u\u0026#39;Hello\\u0020World !\u0026#39;\nu\u0026#39;Hello World !\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e被替换的 \\u0020 标识表示在给定位置插入编码值为 0x0020 的 Unicode 字符（空格符）。\u003c/p\u003e\n\u003ch4 id=\"列表\"\u003e列表\u003c/h4\u003e\n\u003cp\u003eList（列表） 是 Python 中使用最频繁的数据类型。\u003c/p\u003e\n\u003cp\u003e列表可以完成大多数集合类的数据结构实现。它支持字符，数字，字符串甚至可以包含列表（即嵌套）。\u003c/p\u003e\n\u003cp\u003e列表用 [ ] 标识，是 python 最通用的复合数据类型，列表是允许更新的。\n一个列表如下所示：\nlist = [ 'runoob', 786 , 2.23, 'john', 70.2 ]\u003c/p\u003e\n\u003cp\u003e列表中值的切割也可以用到变量 [头下标:尾下标] ，就可以截取相应的列表，从左到右索引默认 0 开始，从右到左索引默认 -1 开始，下标可以为空表示取到头或尾。\u003c/p\u003e\n\u003cp\u003e加号 + 是列表连接运算符，星号 * 是重复操作。\u003c/p\u003e\n\u003cp\u003ePython已经内置确定序列的长度以及确定最大和最小的元素的方法，列表的数据项不需要具有相同的类型。\u003c/p\u003e\n\u003ch4 id=\"元组\"\u003e元组\u003c/h4\u003e\n\u003cp\u003e元组（tuple）是另一个数据类型，类似于List（列表）。\u003c/p\u003e\n\u003cp\u003e元组用\u0026quot;()\u0026quot;标识。内部元素用逗号隔开。但是元组不能二次赋值，相当于只读列表，元组是不允许更新的。\u003c/p\u003e\n\u003cp\u003e一个元组如下所示：\ntuple = ( 'runoob', 786 , 2.23, 'john', 70.2 )\u003c/p\u003e\n\u003ch4 id=\"无关闭分隔符\"\u003e无关闭分隔符\u003c/h4\u003e\n\u003cp\u003e任意无符号的对象，以逗号隔开，默认为元组，如下示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nprint \u0026#39;abc\u0026#39;, -4.24e93, 18+6.6j, \u0026#39;xyz\u0026#39;;\nx, y = 1, 2;\nprint \u0026#34;Value of x , y : \u0026#34;, x,y;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e运行的结果为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eabc -4.24e+93 (18+6.6j) xyz\nValue of x , y : 1 2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"字典\"\u003e字典\u003c/h4\u003e\n\u003cp\u003e字典（dictionary）是除列表（List）以外python之中最灵活的内置数据结构类型，是无序的对象集合。\u003c/p\u003e\n\u003cp\u003e字典（directory）与列表（list）之间的区别在于：字典当中的元素是通过键来存取的，而不是通过偏移存取。\u003c/p\u003e\n\u003cp\u003e字典是另一种可变容器模型，且可存储任意类型对象。\u003c/p\u003e\n\u003cp\u003e字典用 \u003ccode\u003e{ }\u003c/code\u003e 标识，字典由索引(key)和它对应的值value组成，字典的每个键值(key=\u0026gt;value)对用冒号(:)分割，每个对之间用逗号(,)分割，整个字典包括在花括号({})中，格式如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ed = {key1:value1, key2:value2, key3:value3}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e键必须是唯一的，但值则不必。值可以取任何数据类型，但键必须是不可变的，如字符串，数字或元组。\u003c/p\u003e\n\u003cp\u003e一个字典如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edict = {\u0026#39;name\u0026#39;:\u0026#39;john\u0026#39;, \u0026#39;code\u0026#39;:6734, \u0026#39;dept\u0026#39;:\u0026#39;sales\u0026#39;}\n或\ndict = {\u0026#39;abc\u0026#39;:456}\n或\ndict = {\u0026#39;abc\u0026#39;:123, 98.6:23}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e字典值可以没有限制地取任何python对象，既可以是标准的对象，也可以是用户定义的，但键不行。\u003c/p\u003e\n\u003cp\u003e1、不允许同一个键出现两次。创建时如果同一个键被赋值两次，后一个值会被记住。\u003c/p\u003e\n\u003cp\u003e2、由于键必须不可变，所以可以用数字、字符串或元组充当，用列表就不行，\u003c/p\u003e","date":1505692800,"description":"","fuzzywordcount":3200,"kind":"page","lang":"zh","lastmod":1505692800,"objectID":"0c6cb6eea34d46ad370802e20937318a","publishdate":1505692800,"relpermalink":"/posts/programming/python/python-data-type/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Python 语言中的数据类型。\u003c/p\u003e","tags":["Python"],"title":"Python 中的数据类型","url":"https://xdhuxc.github.io/posts/programming/python/python-data-type/","wordcount":3131},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Python 语言中的文件和输入输出流。\u003c/p\u003e\n\u003ch3 id=\"文件io\"\u003e文件I/O\u003c/h3\u003e\n\u003cp\u003e基本的的I/O函数\u003c/p\u003e\n\u003ch4 id=\"打印到屏幕\"\u003e打印到屏幕\u003c/h4\u003e\n\u003cp\u003e最简单的输出方法是用print语句，可以给它传递零个或多个用逗号隔开的表达式。此函数把传递的表达式转换成一个字符串表达式，并将结果写到标准输出。\u003c/p\u003e\n\u003ch4 id=\"读取键盘输入\"\u003e读取键盘输入\u003c/h4\u003e\n\u003cp\u003ePython提供了两个内置函数从标准输入读入一行文本，默认的标准输入是键盘。如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eraw_input\u003c/li\u003e\n\u003cli\u003einput\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"raw_input函数\"\u003eraw_input函数\u003c/h4\u003e\n\u003cp\u003eraw_input([prompt]) 函数从标准输入读取一个行，并返回一个字符串（去掉结尾的换行符）：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*- \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nxdhuxc = raw_input(\u0026#34;请输入：\u0026#34;);\nprint \u0026#34;输入的内容是: \u0026#34;, xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将提示输入任意字符串，然后在屏幕上显示相同的字符串。当输入\u0026quot;Hello Python！\u0026quot;，它的输出如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e请输入：Hello Python！\n输入的内容是:  Hello Python！\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"input-函数\"\u003einput 函数\u003c/h4\u003e\n\u003cp\u003einput([prompt]) 函数和 raw_input([prompt]) 函数基本类似，但是 input 可以接收一个Python表达式作为输入，并将运算结果返回。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*- \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nxdhuxc = input(\u0026#34;请输入：\u0026#34;);\nprint \u0026#34;输入的内容是: \u0026#34;, xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e会产生如下的对应着输入的结果：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e请输入：[x*5 for x in range(2,10,2)]\n输入的内容是:  [10, 20, 30, 40]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"打开和关闭文件\"\u003e打开和关闭文件\u003c/h3\u003e\n\u003cp\u003ePython 提供了必要的函数和方法进行默认情况下的文件基本操作。可以用 file 对象做大部分的文件操作。\u003c/p\u003e\n\u003ch4 id=\"open-函数\"\u003eopen 函数\u003c/h4\u003e\n\u003cp\u003e必须先用Python内置的open()函数打开一个文件，创建一个file对象，相关的方法才可以调用它进行读写。语法：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efile object = open(file_name [, access_mode][, buffering])\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e各个参数的含义如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efile_name：file_name变量是一个包含了你要访问的文件名称的字符串值。\u003c/li\u003e\n\u003cli\u003eaccess_mode：access_mode决定了打开文件的模式：只读，写入，追加等。所有可取值见如下的完全列表。这个参数是非强制的，默认文件访问模式为只读(r)。\u003c/li\u003e\n\u003cli\u003ebuffering：如果buffering的值被设为0，就不会有寄存。如果buffering的值取1，访问文件时会寄存行。如果将buffering的值设为大于1的整数，表明了这就是的寄存区的缓冲大小。如果取负值，寄存区的缓冲大小则为系统默认。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e不同模式打开文件的完全列表：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e模式\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003er\u003c/td\u003e\n\u003ctd\u003e以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003erb\u003c/td\u003e\n\u003ctd\u003e以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003er+\u003c/td\u003e\n\u003ctd\u003e打开一个文件用于读写。文件指针将会放在文件的开头。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003erb+\u003c/td\u003e\n\u003ctd\u003e以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eW\u003c/td\u003e\n\u003ctd\u003e打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ewb\u003c/td\u003e\n\u003ctd\u003e以二进制格式打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ew+\u003c/td\u003e\n\u003ctd\u003e打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ewb+\u003c/td\u003e\n\u003ctd\u003e以二进制格式打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ea\u003c/td\u003e\n\u003ctd\u003e打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eab\u003c/td\u003e\n\u003ctd\u003e以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ea+\u003c/td\u003e\n\u003ctd\u003e打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eab+\u003c/td\u003e\n\u003ctd\u003e以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"file-对象的属性\"\u003eFile 对象的属性\u003c/h3\u003e\n\u003cp\u003e一个文件被打开后，你有一个file对象，你可以得到有关该文件的各种信息。\u003c/p\u003e\n\u003cp\u003efile对象相关的所有属性的列表\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e属性\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003efile.closed\u003c/td\u003e\n\u003ctd\u003e返回true如果文件已被关闭，否则返回false\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003efile.mode\u003c/td\u003e\n\u003ctd\u003e返回被打开文件的访问模式\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003efile.name\u003c/td\u003e\n\u003ctd\u003e返回文件的名称\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003efile.softspace\u003c/td\u003e\n\u003ctd\u003e如果用print输出后，必须跟一个空格符，则返回false。否则返回true\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch4 id=\"close-方法\"\u003eclose() 方法\u003c/h4\u003e\n\u003cp\u003eFile 对象的 close()方法刷新缓冲区里任何还没写入的信息，并关闭该文件，这之后便不能再进行写入。\u003c/p\u003e\n\u003cp\u003e当一个文件对象的引用被重新指定给另一个文件时，Python 会关闭之前的文件。用 close()方法关闭文件是一个很好的习惯。其语法为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efileObject.close()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"读写文件\"\u003e读写文件\u003c/h4\u003e\n\u003cp\u003efile 对象提供了一系列方法，能让文件访问更轻松。使用 \u003ccode\u003eread()\u003c/code\u003e 和 \u003ccode\u003ewrite()\u003c/code\u003e 方法来读取和写入文件。\u003c/p\u003e\n\u003ch4 id=\"write方法\"\u003ewrite()方法\u003c/h4\u003e\n\u003cp\u003ewrite()方法可将任何字符串写入一个打开的文件。需要重点注意的是，Python字符串可以是二进制数据，而不是仅仅是文字。\u003c/p\u003e\n\u003cp\u003ewrite() 方法不会在字符串的结尾添加换行符 \u003ccode\u003e'\\n'\u003c/code\u003e，其语法为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efileObject.write(string) # 在这里，被传递的参数是要写入到已打开文件的内容\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"read方法\"\u003eread()方法\u003c/h4\u003e\n\u003cp\u003eread()方法从一个打开的文件中读取一个字符串。需要重点注意的是，Python字符串可以是二进制数据，而不是仅仅是文字。其语法为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efileObject.read([count]) # 在这里，被传递的参数是要从已打开文件中读取的字节计数。该方法从文件的开头开始读入，如果没有传入count，它会尝试尽可能多地读取更多的内容，很可能是直到文件的末尾。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"重命名和删除文件\"\u003e重命名和删除文件\u003c/h4\u003e\n\u003cp\u003ePython 的 os 模块提供了执行文件处理操作的方法，比如重命名和删除文件。\u003c/p\u003e\n\u003cp\u003e要使用这个模块，你必须先导入它，然后才可以调用相关的各种功能\u003c/p\u003e\n\u003cp\u003erename()方法需要两个参数，当前的文件名和新文件名。其语法格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eos.rename(current_file_name, new_file_name)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以用remove()方法删除文件，需要提供要删除的文件名作为参数。其语法格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eos.remove(file_name)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"目录\"\u003e目录\u003c/h3\u003e\n\u003cp\u003e所有文件都包含在各个不同的目录下，不过 Python 也能轻松处理。os 模块有许多方法能帮你创建，删除和更改目录。\u003c/p\u003e\n\u003cp\u003e可以使用 os 模块的 mkdir() 方法在当前目录下创建新的目录。需要提供一个包含了要创建的目录名称的参数。其语法格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eos.mkdir(\u0026#34;new_directory_name\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以用 chdir() 方法来改变当前的目录。chdir() 方法需要的一个参数是你想设成当前目录的目录名称。其语法格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eos.chdir(\u0026#34;new_directory_name\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003egetcwd() 方法显示当前的工作目录。其语法格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eos.getcwd()\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ermdir() 方法删除目录，目录名称以参数传递。在删除这个目录之前，它的所有内容应该先被清除。其语法格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eos.rmdir(\u0026#34;directory_name\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e目录的完全合规的名称必须被给出，否则会在当前目录下搜索该目录。\u003c/p\u003e","date":1505692800,"description":"","fuzzywordcount":2500,"kind":"page","lang":"zh","lastmod":1505692800,"objectID":"a0657a845cdbc37ee18b53a9818c9262","publishdate":1505692800,"relpermalink":"/posts/programming/python/python-file-and-directory/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Python 语言中的文件和输入输出流。\u003c/p\u003e","tags":["Python"],"title":"Python 中的文件和输入输出流","url":"https://xdhuxc.github.io/posts/programming/python/python-file-and-directory/","wordcount":2481},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下在 Python 邮件的发送。\u003c/p\u003e\n\u003ch3 id=\"发送邮件\"\u003e发送邮件\u003c/h3\u003e\n\u003cp\u003epython的smtplib提供了一种很方便的途径发送电子邮件。它对smtp协议进行了简单的封装。\u003c/p\u003e\n\u003cp\u003ePython创建SMTP 对象语法如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eimport smtplib\n\nsmtpObj = smtplib.SMTP( [host [, port [, local_hostname]]] )\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ehost: SMTP 服务器主机。 你可以指定主机的ip地址或者域名如: xdhuxc.com，这个是可选参数。\u003c/li\u003e\n\u003cli\u003eport: 如果你提供了 host 参数, 你需要指定 SMTP 服务使用的端口号，一般情况下 SMTP 端口号为25。\u003c/li\u003e\n\u003cli\u003elocal_hostname: 如果 SMTP 在你的本机上，你只需要指定服务器地址为 localhost 即可。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePython SMTP 对象使用 sendmail 方法发送邮件，语法如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eSMTP.sendmail(from_addr, to_addrs, msg[, mail_options, rcpt_options]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efrom_addr: 邮件发送者地址。\u003c/li\u003e\n\u003cli\u003eto_addrs: 字符串列表，邮件发送地址。\u003c/li\u003e\n\u003cli\u003emsg: 发送消息，msg 是字符串，表示邮件。我们知道邮件一般由标题，发信人，收件人，邮件内容，附件等构成，发送邮件的时候，要注意 msg 的格式。这个格式就是 smtp 协议中定义的格式\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"使用本地邮件服务器\"\u003e使用本地邮件服务器\u003c/h4\u003e\n\u003cp\u003e执行示例需要本机已安装了支持 SMTP 的服务，如：sendmail。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.header import Header\n \nsender = \u0026#39;xdhuxc@163.com\u0026#39;\nreceivers = [\u0026#39;xdhuxc@126.com\u0026#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱\n \n\u003cspan class=\"gh\"\u003e# 三个参数：第一个为文本内容，第二个 plain 设置文本格式，第三个 utf-8 设置编码\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emessage = MIMEText(\u0026#39;Python 邮件发送测试...\u0026#39;, \u0026#39;plain\u0026#39;, \u0026#39;utf-8\u0026#39;)\nmessage[\u0026#39;From\u0026#39;] = Header(\u0026#34;菜鸟教程\u0026#34;, \u0026#39;utf-8\u0026#39;)\nmessage[\u0026#39;To\u0026#39;] =  Header(\u0026#34;测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\n \nsubject = \u0026#39;Python SMTP 邮件测试\u0026#39;\nmessage[\u0026#39;Subject\u0026#39;] = Header(subject, \u0026#39;utf-8\u0026#39;)\n \n \ntry:\n    smtpObj = smtplib.SMTP(\u0026#39;localhost\u0026#39;)\n    smtpObj.sendmail(sender, receivers, message.as_string())\n    print \u0026#34;邮件发送成功\u0026#34;\nexcept smtplib.SMTPException:\n    print \u0026#34;Error: 无法发送邮件\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用三个引号来设置邮件信息，标准邮件需要三个头部信息： From, To, 和 Subject ，每个信息直接使用空行分割。\u003c/p\u003e\n\u003cp\u003e通过实例化 smtplib 模块的 SMTP 对象 smtpObj 来连接到 SMTP 访问，并使用 sendmail 方法来发送信息。\u003c/p\u003e\n\u003cp\u003e执行以上程序，如果你本机安装 sendmail（邮件传输代理程序），就会输出：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ python test.py\n邮件发送成功\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"使用其他邮件服务商的-smtp-访问qq网易google等\"\u003e使用其他邮件服务商的 SMTP 访问（QQ、网易、Google等）。\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.header import Header\n \n\u003cspan class=\"gh\"\u003e# 第三方 SMTP 服务\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003email_host=\u0026#34;smtp.163.com\u0026#34;  \u003cspan class=\"ni\"\u003e#设置服务器\u003c/span\u003e\nmail_user=\u0026#34;XXXX\u0026#34;    \u003cspan class=\"ni\"\u003e#用户名\u003c/span\u003e\nmail_pass=\u0026#34;XXXXXX\u0026#34;   \u003cspan class=\"ni\"\u003e#口令\u003c/span\u003e \n \n \nsender = \u0026#39;xdhuxc@163.com\u0026#39;\nreceivers = [\u0026#39;xdhuxc@126.com\u0026#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱\n \nmessage = MIMEText(\u0026#39;Python 邮件发送测试...\u0026#39;, \u0026#39;plain\u0026#39;, \u0026#39;utf-8\u0026#39;)\nmessage[\u0026#39;From\u0026#39;] = Header(\u0026#34;xdhuxc 测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\nmessage[\u0026#39;To\u0026#39;] =  Header(\u0026#34;测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\n \nsubject = \u0026#39;Python SMTP 邮件测试\u0026#39;\nmessage[\u0026#39;Subject\u0026#39;] = Header(subject, \u0026#39;utf-8\u0026#39;)\n \n \ntry:\n    smtpObj = smtplib.SMTP() \n    smtpObj.connect(mail_host, 25)    # 25 为 SMTP 端口号\n    smtpObj.login(mail_user,mail_pass)  \n    smtpObj.sendmail(sender, receivers, message.as_string())\n    print \u0026#34;邮件发送成功\u0026#34;\nexcept smtplib.SMTPException:\n    print \u0026#34;Error: 无法发送邮件\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"发送html格式的邮件\"\u003e发送HTML格式的邮件\u003c/h4\u003e\n\u003cp\u003ePython发送HTML格式的邮件与发送纯文本消息的邮件不同之处就是将MIMEText中_subtype设置为html。具体代码如下:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.header import Header\n \nsender = \u0026#39;xdhuxc@163.com\u0026#39;\nreceivers = [\u0026#39;xdhuxc@126.com\u0026#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱\n \nmail_msg = \u0026#34;\u0026#34;\u0026#34;\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ePython 邮件发送测试...\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ea\u003c/span\u003e \u003cspan class=\"na\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://www.xdhuxc.org\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e这是一个链接\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u0026#34;\u0026#34;\u0026#34;\nmessage = MIMEText(mail_msg, \u0026#39;html\u0026#39;, \u0026#39;utf-8\u0026#39;)\nmessage[\u0026#39;From\u0026#39;] = Header(\u0026#34;xdhuxc 测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\nmessage[\u0026#39;To\u0026#39;] =  Header(\u0026#34;测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\n \nsubject = \u0026#39;Python SMTP 邮件测试\u0026#39;\nmessage[\u0026#39;Subject\u0026#39;] = Header(subject, \u0026#39;utf-8\u0026#39;)\n \n \ntry:\n    smtpObj = smtplib.SMTP(\u0026#39;localhost\u0026#39;)\n    smtpObj.sendmail(sender, receivers, message.as_string())\n    print \u0026#34;邮件发送成功\u0026#34;\nexcept smtplib.SMTPException:\n    print \u0026#34;Error: 无法发送邮件\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"发送带附件的邮件\"\u003e发送带附件的邮件\u003c/h4\u003e\n\u003cp\u003e发送带附件的邮件，首先要创建MIMEMultipart()实例，然后构造附件，如果有多个附件，可依次构造，最后利用smtplib.smtp发送。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.mime.multipart import MIMEMultipart\nfrom email.header import Header\n \nsender = \u0026#39;xdhuxc@163.com\u0026#39;\nreceivers = [\u0026#39;xdhuxc@126.com\u0026#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱\n \n\u003cspan class=\"gh\"\u003e#创建一个带附件的实例\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emessage = MIMEMultipart()\nmessage[\u0026#39;From\u0026#39;] = Header(\u0026#34;xdhuxc 测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\nmessage[\u0026#39;To\u0026#39;] =  Header(\u0026#34;测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\nsubject = \u0026#39;Python SMTP 邮件测试\u0026#39;\nmessage[\u0026#39;Subject\u0026#39;] = Header(subject, \u0026#39;utf-8\u0026#39;)\n \n\u003cspan class=\"gh\"\u003e#邮件正文内容\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emessage.attach(MIMEText(\u0026#39;这是 xdhuxc 测试Python 邮件发送测试……\u0026#39;, \u0026#39;plain\u0026#39;, \u0026#39;utf-8\u0026#39;))\n \n\u003cspan class=\"gh\"\u003e# 构造附件1，传送当前目录下的 test.txt 文件\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eatt1 = MIMEText(open(\u0026#39;test.txt\u0026#39;, \u0026#39;rb\u0026#39;).read(), \u0026#39;base64\u0026#39;, \u0026#39;utf-8\u0026#39;)\natt1[\u0026#34;Content-Type\u0026#34;] = \u0026#39;application/octet-stream\u0026#39;\n\u003cspan class=\"gh\"\u003e# 这里的filename可以任意写，写什么名字，邮件中显示什么名字\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eatt1[\u0026#34;Content-Disposition\u0026#34;] = \u0026#39;attachment; filename=\u0026#34;test.txt\u0026#34;\u0026#39;\nmessage.attach(att1)\n \n\u003cspan class=\"gh\"\u003e# 构造附件2，传送当前目录下的 xdhuxc.txt 文件\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eatt2 = MIMEText(open(\u0026#39;xdhuxc.txt\u0026#39;, \u0026#39;rb\u0026#39;).read(), \u0026#39;base64\u0026#39;, \u0026#39;utf-8\u0026#39;)\natt2[\u0026#34;Content-Type\u0026#34;] = \u0026#39;application/octet-stream\u0026#39;\natt2[\u0026#34;Content-Disposition\u0026#34;] = \u0026#39;attachment; filename=\u0026#34;xdhuxc.txt\u0026#34;\u0026#39;\nmessage.attach(att2)\n \ntry:\n    smtpObj = smtplib.SMTP(\u0026#39;localhost\u0026#39;)\n    smtpObj.sendmail(sender, receivers, message.as_string())\n    print \u0026#34;邮件发送成功\u0026#34;\nexcept smtplib.SMTPException:\n    print \u0026#34;Error: 无法发送邮件\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"在-html-文本中添加图片\"\u003e在 HTML 文本中添加图片\u003c/h4\u003e\n\u003cp\u003e邮件的 HTML 文本中一般邮件服务商添加外链是无效的，正确添加突破的实例如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport smtplib\nfrom email.mime.image import MIMEImage\nfrom email.mime.multipart import MIMEMultipart\nfrom email.mime.text import MIMEText\nfrom email.header import Header\n \nsender = \u0026#39;xdhuxc@163.com\u0026#39;\nreceivers = [\u0026#39;xdhuxc@126.com\u0026#39;]  # 接收邮件，可设置为你的QQ邮箱或者其他邮箱\n \nmsgRoot = MIMEMultipart(\u0026#39;related\u0026#39;)\nmsgRoot[\u0026#39;From\u0026#39;] = Header(\u0026#34;xdhuxc 测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\nmsgRoot[\u0026#39;To\u0026#39;] =  Header(\u0026#34;测试\u0026#34;, \u0026#39;utf-8\u0026#39;)\nsubject = \u0026#39;Python SMTP 邮件测试\u0026#39;\nmsgRoot[\u0026#39;Subject\u0026#39;] = Header(subject, \u0026#39;utf-8\u0026#39;)\n \nmsgAlternative = MIMEMultipart(\u0026#39;alternative\u0026#39;)\nmsgRoot.attach(msgAlternative)\n \n \nmail_msg = \u0026#34;\u0026#34;\u0026#34;\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003ePython 邮件发送测试...\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ea\u003c/span\u003e \u003cspan class=\"na\"\u003ehref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://www.xdhuxc.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003exdhuxc 测试链接\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e图片演示：\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eimg\u003c/span\u003e \u003cspan class=\"na\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;cid:image1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u0026#34;\u0026#34;\u0026#34;\nmsgAlternative.attach(MIMEText(mail_msg, \u0026#39;html\u0026#39;, \u0026#39;utf-8\u0026#39;))\n \n\u003cspan class=\"gh\"\u003e# 指定图片为当前目录\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efp = open(\u0026#39;test.png\u0026#39;, \u0026#39;rb\u0026#39;)\nmsgImage = MIMEImage(fp.read())\nfp.close()\n \n\u003cspan class=\"gh\"\u003e# 定义图片 ID，在 HTML 文本中引用\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003emsgImage.add_header(\u0026#39;Content-ID\u0026#39;, \u0026#39;\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eimage1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#39;)\nmsgRoot.attach(msgImage)\n \ntry:\n    smtpObj = smtplib.SMTP(\u0026#39;localhost\u0026#39;)\n    smtpObj.sendmail(sender, receivers, msgRoot.as_string())\n    print \u0026#34;邮件发送成功\u0026#34;\nexcept smtplib.SMTPException:\n    print \u0026#34;Error: 无法发送邮件\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"使用第三方-smtp-服务发送\"\u003e使用第三方 SMTP 服务发送\u003c/h4\u003e\n\u003cp\u003e使用第三方 SMTP 服务发送邮件，SMTP服务器地址为：smtp.xxx.com，端口为：25\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.utils import formataddr\n \nmy_sender=\u0026#39;xdhuxc@126.com\u0026#39;    # 发件人邮箱账号\nmy_pass = \u0026#39;xxxxxxxxxx\u0026#39;              # 发件人邮箱密码\nmy_user=\u0026#39;xdhuxc@126.com\u0026#39;      # 收件人邮箱账号，我这边发送给自己\ndef mail():\n    ret=True\n    try:\n        msg=MIMEText(\u0026#39;填写邮件内容\u0026#39;,\u0026#39;plain\u0026#39;,\u0026#39;utf-8\u0026#39;)\n        msg[\u0026#39;From\u0026#39;]=formataddr([\u0026#34;Fromxdhuxc\u0026#34;,my_sender])  # 括号里的对应发件人邮箱昵称、发件人邮箱账号\n        msg[\u0026#39;To\u0026#39;]=formataddr([\u0026#34;FK\u0026#34;,my_user])              # 括号里的对应收件人邮箱昵称、收件人邮箱账号\n        msg[\u0026#39;Subject\u0026#39;]=\u0026#34;xdhuxc 测试发送邮件测试\u0026#34;                # 邮件的主题，也可以说是标题\n \n        server=smtplib.SMTP_SSL(\u0026#34;smtp.qq.com\u0026#34;, 465)  # 发件人邮箱中的SMTP服务器，端口是25\n        server.login(my_sender, my_pass)  # 括号中对应的是发件人邮箱账号、邮箱密码\n        server.sendmail(my_sender,[my_user,],msg.as_string())  # 括号中对应的是发件人邮箱账号、收件人邮箱账号、发送邮件\n        server.quit()  # 关闭连接\n    except Exception:  # 如果 try 中的语句没有执行，则会执行下面的 ret=False\n        ret=False\n    return ret\n \nret=mail()\nif ret:\n    print(\u0026#34;邮件发送成功\u0026#34;)\nelse:\n    print(\u0026#34;邮件发送失败\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"线程\"\u003e线程\u003c/h3\u003e\n\u003cp\u003ePython中使用线程有两种方式：函数或者用类来包装线程对象。\u003c/p\u003e\n\u003ch4 id=\"函数式\"\u003e函数式\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e调用thread模块中的start_new_thread()函数来产生新线程。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e语法如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ethread.start_new_thread ( function, args[, kwargs] )\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efunction - 线程函数。\u003c/li\u003e\n\u003cli\u003eargs - 传递给线程函数的参数,他必须是个tuple类型。\u003c/li\u003e\n\u003cli\u003ekwargs - 可选参数。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e示例：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport thread\nimport time\n \n\u003cspan class=\"gh\"\u003e# 为线程定义一个函数\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003edef print_time( threadName, delay):\n   count = 0\n   while count \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nt\"\u003e5:\u003c/span\u003e\n      \u003cspan class=\"na\"\u003etime\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003esleep\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003edelay\u003c/span\u003e\u003cspan class=\"err\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"na\"\u003ecount\u003c/span\u003e \u003cspan class=\"err\"\u003e+=\u003c/span\u003e \u003cspan class=\"na\"\u003e1\u003c/span\u003e\n      \u003cspan class=\"na\"\u003eprint\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;%\u003c/span\u003e\u003cspan class=\"na\"\u003es:\u003c/span\u003e \u003cspan class=\"err\"\u003e%\u003c/span\u003e\u003cspan class=\"na\"\u003es\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"err\"\u003e%\u003c/span\u003e \u003cspan class=\"err\"\u003e(\u003c/span\u003e \u003cspan class=\"na\"\u003ethreadName\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"na\"\u003etime\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ectime\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"na\"\u003etime\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003etime\u003c/span\u003e\u003cspan class=\"err\"\u003e())\u003c/span\u003e \u003cspan class=\"err\"\u003e)\u003c/span\u003e\n \n\u003cspan class=\"gh\"\u003e# 创建两个线程\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\u003cspan class=\"na\"\u003etry:\u003c/span\u003e\n   \u003cspan class=\"na\"\u003ethread\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003estart_new_thread\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e \u003cspan class=\"na\"\u003eprint_time\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"err\"\u003e(\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eThread-1\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e \u003cspan class=\"na\"\u003e2\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"err\"\u003e)\u003c/span\u003e \u003cspan class=\"err\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"na\"\u003ethread\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003estart_new_thread\u003c/span\u003e\u003cspan class=\"err\"\u003e(\u003c/span\u003e \u003cspan class=\"na\"\u003eprint_time\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"err\"\u003e(\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eThread-2\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;,\u003c/span\u003e \u003cspan class=\"na\"\u003e4\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e \u003cspan class=\"err\"\u003e)\u003c/span\u003e \u003cspan class=\"err\"\u003e)\u003c/span\u003e\n\u003cspan class=\"na\"\u003eexcept:\u003c/span\u003e\n   \u003cspan class=\"na\"\u003eprint\u003c/span\u003e \u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"na\"\u003eError:\u003c/span\u003e \u003cspan class=\"na\"\u003eunable\u003c/span\u003e \u003cspan class=\"na\"\u003eto\u003c/span\u003e \u003cspan class=\"na\"\u003estart\u003c/span\u003e \u003cspan class=\"na\"\u003ethread\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\n \n\u003cspan class=\"na\"\u003ewhile\u003c/span\u003e \u003cspan class=\"na\"\u003e1:\u003c/span\u003e\n   \u003cspan class=\"na\"\u003epass\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e线程的结束一般依靠线程函数的自然结束；也可以在线程函数中调用thread.exit()，他抛出SystemExit exception，达到退出线程的目的。\u003c/p\u003e\n\u003ch4 id=\"线程模块\"\u003e线程模块\u003c/h4\u003e\n\u003cp\u003ePython通过两个标准库thread和threading提供对线程的支持。thread提供了低级别的、原始的线程以及一个简单的锁。\u003c/p\u003e\n\u003cp\u003ethread 模块提供的其他方法：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethreading.currentThread(): 返回当前的线程变量。\u003c/li\u003e\n\u003cli\u003ethreading.enumerate(): 返回一个包含正在运行的线程的list。正在运行指线程启动后、结束前，不包括启动前和终止后的线程。\u003c/li\u003e\n\u003cli\u003ethreading.activeCount(): 返回正在运行的线程数量，与len(threading.enumerate())有相同的结果。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e除了使用方法外，线程模块同样提供了Thread类来处理线程，Thread类提供了以下方法:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003erun(): 用以表示线程活动的方法。\u003c/li\u003e\n\u003cli\u003estart():启动线程活动。\u003c/li\u003e\n\u003cli\u003ejoin([time]): 等待至线程中止。这阻塞调用线程直至线程的join() 方法被调用中止-正常退出或者抛出未处理的异常-或者是可选的超时发生。\u003c/li\u003e\n\u003cli\u003eisAlive(): 返回线程是否活动的。\u003c/li\u003e\n\u003cli\u003egetName(): 返回线程名。\u003c/li\u003e\n\u003cli\u003esetName(): 设置线程名。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"使用threading模块创建线程\"\u003e使用Threading模块创建线程\u003c/h4\u003e\n\u003cp\u003e使用Threading模块创建线程，直接从threading.Thread继承，然后重写__init__方法和run方法\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport threading\nimport time\n \nexitFlag = 0\n \nclass myThread (threading.Thread):   \u003cspan class=\"ni\"\u003e#继承父类threading\u003c/span\u003e.Thread\n    def \u003cspan class=\"gs\"\u003e__init__\u003c/span\u003e(self, threadID, name, counter):\n        threading.Thread.__init__(self)\n        self.threadID = threadID\n        self.name = name\n        self.counter = counter\n    def run(self):                   \u003cspan class=\"ni\"\u003e#把要执行的代码写到run函数里面\u003c/span\u003e 线程在创建后会直接运行run函数 \n        print \u0026#34;Starting \u0026#34; + self.name\n        print_time(self.name, self.counter, 5)\n        print \u0026#34;Exiting \u0026#34; + self.name\n \ndef print_time(threadName, delay, counter):\n    while counter:\n        if exitFlag:\n            threading.Thread.exit()\n        time.sleep(delay)\n        print \u0026#34;%s: %s\u0026#34; % (threadName, time.ctime(time.time()))\n        counter -= 1\n \n\u003cspan class=\"gh\"\u003e# 创建新线程\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ethread1 = myThread(1, \u0026#34;Thread-1\u0026#34;, 1)\nthread2 = myThread(2, \u0026#34;Thread-2\u0026#34;, 2)\n \n\u003cspan class=\"gh\"\u003e# 开启线程\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ethread1.start()\nthread2.start()\n \nprint \u0026#34;Exiting Main Thread\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"线程同步\"\u003e线程同步\u003c/h4\u003e\n\u003cp\u003e如果多个线程共同对某个数据修改，则可能出现不可预料的结果，为了保证数据的正确性，需要对多个线程进行同步。\u003c/p\u003e\n\u003cp\u003e使用Thread对象的Lock和Rlock可以实现简单的线程同步，这两个对象都有acquire方法和release方法，对于那些需要每次只允许一个线程操作的数据，可以将其操作放到acquire和release方法之间。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport threading\nimport time\n \nclass myThread (threading.Thread):\n    def \u003cspan class=\"gs\"\u003e__init__\u003c/span\u003e(self, threadID, name, counter):\n        threading.Thread.__init__(self)\n        self.threadID = threadID\n        self.name = name\n        self.counter = counter\n    def run(self):\n        print \u0026#34;Starting \u0026#34; + self.name\n       # 获得锁，成功获得锁定后返回True\n       # 可选的timeout参数不填时将一直阻塞直到获得锁定\n       # 否则超时后将返回False\n        threadLock.acquire()\n        print_time(self.name, self.counter, 3)\n        # 释放锁\n        threadLock.release()\n \ndef print_time(threadName, delay, counter):\n    while counter:\n        time.sleep(delay)\n        print \u0026#34;%s: %s\u0026#34; % (threadName, time.ctime(time.time()))\n        counter -= 1\n \nthreadLock = threading.Lock()\nthreads = []\n \n\u003cspan class=\"gh\"\u003e# 创建新线程\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ethread1 = myThread(1, \u0026#34;Thread-1\u0026#34;, 1)\nthread2 = myThread(2, \u0026#34;Thread-2\u0026#34;, 2)\n \n\u003cspan class=\"gh\"\u003e# 开启新线程\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ethread1.start()\nthread2.start()\n \n\u003cspan class=\"gh\"\u003e# 添加线程到线程列表\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ethreads.append(thread1)\nthreads.append(thread2)\n \n\u003cspan class=\"gh\"\u003e# 等待所有线程完成\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efor t in threads:\n    t.join()\nprint \u0026#34;Exiting Main Thread\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"线程优先级队列-queue\"\u003e线程优先级队列（ Queue）\u003c/h4\u003e\n\u003cp\u003ePython的Queue模块中提供了同步的、线程安全的队列类，包括FIFO（先入先出)队列Queue，LIFO（后入先出）队列LifoQueue，和优先级队列PriorityQueue。这些队列都实现了锁原语，能够在多线程中直接使用。可以使用队列来实现线程间的同步。\u003c/p\u003e\n\u003cp\u003eQueue模块中的常用方法:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eQueue.qsize() 返回队列的大小\u003c/li\u003e\n\u003cli\u003eQueue.empty() 如果队列为空，返回True,反之False\u003c/li\u003e\n\u003cli\u003eQueue.full() 如果队列满了，返回True,反之False\u003c/li\u003e\n\u003cli\u003eQueue.full 与 maxsize 大小对应\u003c/li\u003e\n\u003cli\u003eQueue.get([block[, timeout]])获取队列，timeout等待时间\u003c/li\u003e\n\u003cli\u003eQueue.get_nowait() 相当Queue.get(False)\u003c/li\u003e\n\u003cli\u003eQueue.put(item) 写入队列，timeout等待时间\u003c/li\u003e\n\u003cli\u003eQueue.put_nowait(item) 相当Queue.put(item, False)\u003c/li\u003e\n\u003cli\u003eQueue.task_done() 在完成一项工作之后，Queue.task_done()函数向任务已经完成的队列发送一个信号\u003c/li\u003e\n\u003cli\u003eQueue.join() 实际上意味着等到队列为空，再执行别的操作\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nimport Queue\nimport threading\nimport time\n \nexitFlag = 0\n \nclass myThread (threading.Thread):\n    def \u003cspan class=\"gs\"\u003e__init__\u003c/span\u003e(self, threadID, name, q):\n        threading.Thread.__init__(self)\n        self.threadID = threadID\n        self.name = name\n        self.q = q\n    def run(self):\n        print \u0026#34;Starting \u0026#34; + self.name\n        process_data(self.name, self.q)\n        print \u0026#34;Exiting \u0026#34; + self.name\n \ndef process_data(threadName, q):\n    while not exitFlag:\n        queueLock.acquire()\n        if not workQueue.empty():\n            data = q.get()\n            queueLock.release()\n            print \u0026#34;%s processing %s\u0026#34; % (threadName, data)\n        else:\n            queueLock.release()\n        time.sleep(1)\n \nthreadList = [\u0026#34;Thread-1\u0026#34;, \u0026#34;Thread-2\u0026#34;, \u0026#34;Thread-3\u0026#34;]\nnameList = [\u0026#34;One\u0026#34;, \u0026#34;Two\u0026#34;, \u0026#34;Three\u0026#34;, \u0026#34;Four\u0026#34;, \u0026#34;Five\u0026#34;]\nqueueLock = threading.Lock()\nworkQueue = Queue.Queue(10)\nthreads = []\nthreadID = 1\n \n\u003cspan class=\"gh\"\u003e# 创建新线程\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efor tName in threadList:\n    thread = myThread(threadID, tName, workQueue)\n    thread.start()\n    threads.append(thread)\n    threadID += 1\n \n\u003cspan class=\"gh\"\u003e# 填充队列\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003equeueLock.acquire()\nfor word in nameList:\n    workQueue.put(word)\nqueueLock.release()\n \n\u003cspan class=\"gh\"\u003e# 等待队列清空\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ewhile not workQueue.empty():\n    pass\n \n\u003cspan class=\"gh\"\u003e# 通知线程是时候退出\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eexitFlag = 1\n \n\u003cspan class=\"gh\"\u003e# 等待所有线程完成\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efor t in threads:\n    t.join()\nprint \u0026#34;Exiting Main Thread\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"json\"\u003eJSON\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eJSON(JavaScript Object Notation) 是一种轻量级的数据交换格式，易于人阅读和编写。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"json-函数\"\u003eJSON 函数\u003c/h4\u003e\n\u003cp\u003e使用 JSON 函数需要导入 json 库：import json。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e函数\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ejson.dumps\u003c/td\u003e\n\u003ctd\u003e将 Python 对象转换成 JSON 字符串\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ejson.loads\u003c/td\u003e\n\u003ctd\u003e将已编码的 JSON 字符串转换为 Python 对象\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch4 id=\"jsondumps\"\u003ejson.dumps\u003c/h4\u003e\n\u003cp\u003ejson.dumps 用于将 Python 对象转换成 JSON 字符串。\u003c/p\u003e\n\u003cp\u003e语法为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejson.dumps(obj, skipkeys=False, ensure_ascii=True, check_circular=True, allow_nan=True, cls=None, indent=None, separators=None, encoding=\u0026#34;utf-8\u0026#34;, default=None, sort_keys=False, **kw)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch5 id=\"示例\"\u003e示例\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e#!/usr/bin/python\nimport json\n\ndata = [ { 'a' : 1, 'b' : 2, 'c' : 3, 'd' : 4, 'e' : 5 } ]\n\njson = json.dumps(data)\nprint json\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e执行结果为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[{\u0026quot;a\u0026quot;: 1, \u0026quot;c\u0026quot;: 3, \u0026quot;b\u0026quot;: 2, \u0026quot;e\u0026quot;: 5, \u0026quot;d\u0026quot;: 4}]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e使用参数让 JSON 数据格式化输出：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e\u0026gt;\u0026gt;\u0026gt; import json\n\u0026gt;\u0026gt;\u0026gt; print json.dumps({'a': 'xdhuxc', 'b': 7}, sort_keys=True, indent=4, separators=(',', ': '))\n{\n    \u0026quot;a\u0026quot;: \u0026quot;xdhuxc\u0026quot;,\n    \u0026quot;b\u0026quot;: 7\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003epython 原始类型向 json 类型的转化对照表：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003ePython\u003c/th\u003e\n\u003cth\u003eJSON\u003c/th\u003e\n\u003cth\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003edict\u003c/td\u003e\n\u003ctd\u003eobject\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003elist, tuple\u003c/td\u003e\n\u003ctd\u003earray\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003estr, unicode\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eint, long, float\u003c/td\u003e\n\u003ctd\u003enumber\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTrue\u003c/td\u003e\n\u003ctd\u003etrue\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFalse\u003c/td\u003e\n\u003ctd\u003efalse\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNone\u003c/td\u003e\n\u003ctd\u003enull\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"jsonloads\"\u003ejson.loads\u003c/h3\u003e\n\u003cp\u003ejson.loads 用于解码 JSON 数据。该函数返回 Python 字段的数据类型。\u003c/p\u003e\n\u003cp\u003e语法为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ejson.loads(s[, encoding[, cls[, object_hook[, parse_float[, parse_int[, parse_constant[, object_pairs_hook[, **kw]]]]]]]])\n\u003c/code\u003e\u003c/pre\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eimport json\n\njsonData = \u0026#39;{\u0026#34;a\u0026#34;:1,\u0026#34;b\u0026#34;:2,\u0026#34;c\u0026#34;:3,\u0026#34;d\u0026#34;:4,\u0026#34;e\u0026#34;:5}\u0026#39;;\n\ntext = json.loads(jsonData)\nprint text\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上代码执行结果为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{u\u0026#39;a\u0026#39;: 1, u\u0026#39;c\u0026#39;: 3, u\u0026#39;b\u0026#39;: 2, u\u0026#39;e\u0026#39;: 5, u\u0026#39;d\u0026#39;: 4}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ejson 类型转换到 python 的类型对照表：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eJSON\u003c/th\u003e\n\u003cth\u003ePython\u003c/th\u003e\n\u003cth\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eobject\u003c/td\u003e\n\u003ctd\u003edict\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003earray\u003c/td\u003e\n\u003ctd\u003elist\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eunicode\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003enumber (int)\u003c/td\u003e\n\u003ctd\u003eint, long\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003enumber (real)\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etrue\u003c/td\u003e\n\u003ctd\u003eTrue\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003efalse\u003c/td\u003e\n\u003ctd\u003eFalse\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003enull\u003c/td\u003e\n\u003ctd\u003eNone\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e","date":1505692800,"description":"","fuzzywordcount":4900,"kind":"page","lang":"zh","lastmod":1505692800,"objectID":"7f327dc8132308f9a828a1bcf0cbdc64","publishdate":1505692800,"relpermalink":"/posts/programming/python/python-email/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下在 Python 邮件的发送。\u003c/p\u003e","tags":["Python"],"title":"Python 发送邮件","url":"https://xdhuxc.github.io/posts/programming/python/python-email/","wordcount":4804},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Python 语言中的条件语句。\u003c/p\u003e\n\u003ch3 id=\"python-条件语句\"\u003ePython 条件语句\u003c/h3\u003e\n\u003cp\u003ePython 条件语句是通过一条或多条语句的执行结果（True或者False）来决定执行的代码块\u003c/p\u003e\n\u003cp\u003ePython 程序语言指定任何非0和非空（null）值为true，0 或者 null为false\u003c/p\u003e\n\u003cp\u003ePython 编程中 if 语句用于控制程序的执行，基本形式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif 判断条件:\n    执行语句...\nelse:\n    执行语句...\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e其中\u0026quot;判断条件\u0026quot;成立时（非零），则执行后面的语句，而执行内容可以多行，以缩进来区分表示同一范围。\nelse 为可选语句，当需要在条件不成立时执行内容则可以执行相关语句\u003c/p\u003e\n\u003cp\u003eif 语句的判断条件可以用\u0026gt;（大于）、\u0026lt;(小于)、==（等于）、\u0026gt;=（大于等于）、\u0026lt;=（小于等于）来表示其关系。\u003c/p\u003e\n\u003cp\u003e当判断条件为多个值时，可以使用以下形式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif 判断条件1:\n    执行语句1……\nelif 判断条件2:\n    执行语句2……\nelif 判断条件3:\n    执行语句3……\nelse:\n    执行语句4……\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e多个条件判断时，使用 elif 来实现，如果判断需要多个条件需同时判断时，可以使用 or （或），表示两个条件有一个成立时判断条件成功；使用 and （与）时，表示只有两个条件同时成立的情况下，判断条件才成功。\u003c/p\u003e\n\u003cp\u003e当if有多个条件时可使用括号来区分判断的先后顺序，括号中的判断优先执行，此外 and 和 or 的优先级低于\u0026gt;（大于）、\u0026lt;（小于）等判断符号，即大于和小于在没有括号的情况下会比与或要优先判断。\u003c/p\u003e\n\u003cp\u003epython 复合布尔表达式计算采用短路规则，即如果通过前面的部分已经计算出整个表达式的值，则后面的部分不再计算。\u003c/p\u003e\n\u003ch3 id=\"python-循环语句\"\u003ePython 循环语句\u003c/h3\u003e\n\u003cp\u003e循环语句允许我们执行一个语句或语句组多次\u003c/p\u003e\n\u003ch4 id=\"while循环\"\u003ewhile循环\u003c/h4\u003e\n\u003cp\u003e在给定的判断条件为 true 时执行循环体，否则退出循环体。\u003c/p\u003e\n\u003cp\u003ePython 编程中 while 语句用于循环执行程序，即在某条件下，循环执行某段程序，以处理需要重复处理的相同任务。其基本形式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewhile 判断条件：\n    执行语句……\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行语句可以是单个语句或语句块。判断条件可以是任何表达式，任何非零、或非空（null）的值均为true。\n当判断条件假false时，循环结束。\n执行流程图如下：\n\u003cimg src=\"http://www.runoob.com/wp-content/uploads/2013/11/python_while_loop.jpg\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003ePython while语句执行过程\n\u003cimg src=\"http://www.runoob.com/wp-content/uploads/2013/11/loop-over-python-list-animation.gif\" alt=\"image\"\u003e\u003c/p\u003e\n\u003cp\u003ewhile 语句还有另外两个重要的命令 continue、break 来跳过循环，continue 用于跳过该次循环，break 则是用于退出循环，此外\u0026quot;判断条件\u0026quot;还可以是个常值，表示循环必定成立。\u003c/p\u003e\n\u003cp\u003e如果条件判断语句永远为 true，循环将会无限的执行下去。\u003c/p\u003e\n\u003cp\u003e注意：以上的无限循环你可以使用 \u003ccode\u003eCTRL+C\u003c/code\u003e 来中断循环。\u003c/p\u003e\n\u003cp\u003e在 python 中，\u003ccode\u003ewhile … else\u003c/code\u003e 在循环条件为 \u003ccode\u003efalse\u003c/code\u003e 时执行 \u003ccode\u003eelse\u003c/code\u003e 语句块\u003c/p\u003e\n\u003cp\u003e类似 if 语句的语法，如果你的 while 循环体中只有一条语句，你可以将该语句与 while 写在同一行中\u003c/p\u003e\n\u003ch4 id=\"for循环\"\u003efor循环\u003c/h4\u003e\n\u003cp\u003e重复执行语句\u003c/p\u003e\n\u003cp\u003ePython for 循环可以遍历任何序列的项目，如一个列表或者一个字符串。\u003c/p\u003e\n\u003cp\u003efor 循环的语法格式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efor iterating_var in sequence:\n   statements(s)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e遍历字符串和列表\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nfor letter in \u0026#39;Python\u0026#39;:     # 第一个实例\n   print \u0026#39;当前字母 :\u0026#39;, letter\n \nfruits = [\u0026#39;banana\u0026#39;, \u0026#39;apple\u0026#39;,  \u0026#39;mango\u0026#39;]\nfor fruit in fruits:        # 第二个实例\n   print \u0026#39;当前水果 :\u0026#39;, fruit\n \nprint \u0026#34;Good bye!\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e通过序列索引迭代（一种执行循环的遍历方式是通过索引）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nfruits = [\u0026#39;banana\u0026#39;, \u0026#39;apple\u0026#39;,  \u0026#39;mango\u0026#39;]\n\u003cspan class=\"gh\"\u003e# 函数 len() 返回列表的长度，即元素的个数\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 函数 range()返回一个序列的数\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efor index in range(len(fruits)):\n   print \u0026#39;当前水果 :\u0026#39;, fruits[index]\n \nprint \u0026#34;Good bye!\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 python 中，\u003ccode\u003efor … else\u003c/code\u003e 表示这样的意思，for 中的语句和普通的没有区别，else 中的语句会在循环正常执行完（即 for 不是通过 break 跳出而中断的）的情况下执行，\u003ccode\u003ewhile … else\u003c/code\u003e 也是一样。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e \nfor num in range(10,20):  # 迭代 10 到 20 之间的数字\n   for i in range(2,num): # 根据因子迭代\n      if num%i == 0:      # 确定第一个因子\n         j=num/i          # 计算第二个因子\n         print \u0026#39;%d 等于 %d * %d\u0026#39; % (num,i,j)\n         break            # 跳出当前循环\n   else:                  # 循环的 else 部分\n      print num, \u0026#39;是一个质数\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"嵌套循环\"\u003e嵌套循环\u003c/h4\u003e\n\u003cp\u003ePython 语言允许在一个循环体里面嵌入另一个循环。\u003c/p\u003e\n\u003cp\u003ePython for 循环嵌套语法\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efor iterating_var in sequence:\n   for iterating_var in sequence:\n      statements(s)\n   statements(s)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003ePython while 循环嵌套语法\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewhile expression:\n   while expression:\n      statement(s)\n   statement(s)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以在循环体内嵌入其他的循环体，如在 while 循环中可以嵌入 for 循环， 反之，你可以在 for 循环中嵌入 while 循环\u003c/p\u003e\n\u003ch3 id=\"循环控制语句\"\u003e循环控制语句\u003c/h3\u003e\n\u003cp\u003e循环控制语句可以更改语句执行的顺序\u003c/p\u003e\n\u003cp\u003ePython支持以下循环控制语句：\u003c/p\u003e\n\u003ch4 id=\"break语句\"\u003ebreak语句\u003c/h4\u003e\n\u003cp\u003e在语句块执行过程中终止循环，并且跳出整个循环\u003c/p\u003e\n\u003cp\u003ebreak 语句用来终止循环语句，即循环条件没有 False 条件或者序列还没被完全递归完，也会停止执行循环语句。\u003c/p\u003e\n\u003cp\u003ebreak 语句用在 while 和 for 循环中。\u003c/p\u003e\n\u003cp\u003e如果使用嵌套循环，break 语句将停止执行最深层的循环，并开始执行下一行代码。\u003c/p\u003e\n\u003cp\u003ePython 语言 break 语句语法\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebreak\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"continue-语句\"\u003econtinue 语句\u003c/h4\u003e\n\u003cp\u003e在语句块执行过程中终止当前循环，跳出该次循环，执行下一次循环\u003c/p\u003e\n\u003cp\u003ePython continue 语句跳出本次循环，而 break 跳出整个循环。\u003c/p\u003e\n\u003cp\u003econtinue 语句用来告诉 Python 跳过当前循环的剩余语句，然后继续进行下一轮循环。\u003c/p\u003e\n\u003cp\u003econtinue 语句用在 while 和 for 循环中。\u003c/p\u003e\n\u003cp\u003ePython 语言 continue 语句语法格式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003econtinue\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"pass-语句\"\u003epass 语句\u003c/h4\u003e\n\u003cp\u003epass是空语句，是为了保持程序结构的完整性\u003c/p\u003e\n\u003cp\u003ePython pass是空语句，是为了保持程序结构的完整性。pass 不做任何事情，一般用做占位语句。\u003c/p\u003e\n\u003cp\u003ePython 语言 pass 语句语法格式如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003epass\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1505520000,"description":"","fuzzywordcount":2000,"kind":"page","lang":"zh","lastmod":1505520000,"objectID":"703d54ce1ffdd7e9db683c7ad83a88be","publishdate":1505520000,"relpermalink":"/posts/programming/python/python-condition/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Python 语言中的条件语句。\u003c/p\u003e","tags":["Python"],"title":"Python 中的条件语句","url":"https://xdhuxc.github.io/posts/programming/python/python-condition/","wordcount":1963},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Python 语言中的运算符。\u003c/p\u003e\n\u003cp\u003ePython 语言支持以下类型的运算符：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e算术运算符\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e关系运算符\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e赋值运算符\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e逻辑运算符\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e位运算符\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e成员运算符\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e身份运算符\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e运算符优先级\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"python-算术运算符\"\u003ePython 算术运算符\u003c/h3\u003e\n\u003cp\u003e算术运算符实现对数字的运算。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e运算符\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003c/table\u003e\n\u003cul\u003e\n\u003cli\u003e| 加 - 两个对象相加\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003e| 减 - 得到负数或是一个数减去另一个数\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003e| 乘 - 两个数相乘或是返回一个被重复若干次的字符串\n/ | 除 - x除以y\n% | 取模 - 返回除法的余数\n**| 幂 - 返回x的y次幂\n//| 取整除 - 返回商的整数部分\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e注意：Python2.x 里，整数除整数，只能得出整数。如果要得到小数部分，把其中一个数改成浮点数即可。\u003c/p\u003e\n\u003ch3 id=\"python-比较运算符\"\u003ePython 比较运算符\u003c/h3\u003e\n\u003cp\u003e比较运算符用于数字的比较。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e运算符\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e==\u003c/td\u003e\n\u003ctd\u003e等于   - 比较对象是否相等\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e!=\u003c/td\u003e\n\u003ctd\u003e不等于 - 比较两个对象是否不相等\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u0026lt;\u0026gt;\u003c/td\u003e\n\u003ctd\u003e不等于 - 比较两个对象是否不相等\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cblockquote\u003e\n\u003cp\u003e| 大于   - 返回x是否大于y\n\u0026lt;  | 小于   - 返回x是否小于y\n= | 大于等于\t- 返回x是否大于等于y\n\u0026lt;= | 小于等于 -\t返回x是否小于等于y\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e注意：所有比较运算符返回1表示真，返回0表示假。这分别与特殊的变量True和False等价。注意，这些变量名的大写。\u003c/p\u003e\n\u003ch3 id=\"python-赋值运算符\"\u003ePython 赋值运算符\u003c/h3\u003e\n\u003cp\u003e赋值运算符用于为变量赋值。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e运算符\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003cth\u003e实例\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e=\u003c/td\u003e\n\u003ctd\u003e简单的赋值运算符\u003c/td\u003e\n\u003ctd\u003ec = a + b 将 a + b 的运算结果赋值为 c\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e+=\u003c/td\u003e\n\u003ctd\u003e加法赋值运算符\u003c/td\u003e\n\u003ctd\u003ec += a 等效于 c = c + a\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-=\u003c/td\u003e\n\u003ctd\u003e减法赋值运算符\u003c/td\u003e\n\u003ctd\u003ec -= a 等效于 c = c - a\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e*=\u003c/td\u003e\n\u003ctd\u003e乘法赋值运算符\u003c/td\u003e\n\u003ctd\u003ec *= a 等效于 c = c * a\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e/=\u003c/td\u003e\n\u003ctd\u003e除法赋值运算符\u003c/td\u003e\n\u003ctd\u003ec /= a 等效于 c = c / a\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e%=\u003c/td\u003e\n\u003ctd\u003e取模赋值运算符\u003c/td\u003e\n\u003ctd\u003ec %= a 等效于 c = c % a\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e**=\u003c/td\u003e\n\u003ctd\u003e幂赋值运算符\u003c/td\u003e\n\u003ctd\u003ec **= a 等效于 c = c ** a\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e//=\u003c/td\u003e\n\u003ctd\u003e取整除赋值运算符\u003c/td\u003e\n\u003ctd\u003ec //= a 等效于 c = c // a\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"python-位运算符\"\u003ePython 位运算符\u003c/h3\u003e\n\u003cp\u003e按位运算符是把数字看作二进制来进行计算的。\u003c/p\u003e\n\u003cp\u003ePython中的按位运算法则如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e运算符\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u0026amp;\u003c/td\u003e\n\u003ctd\u003e按位与运算符：参与运算的两个值,如果两个相应位都为1,则该位的结果为1,否则为0\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e按位或运算符：只要对应的二个二进位有一个为1时，结果位就为1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e^\u003c/td\u003e\n\u003ctd\u003e按位异或运算符：当两对应的二进位相异时，结果为1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e~\u003c/td\u003e\n\u003ctd\u003e按位取反运算符：对数据的每个二进制位取反,即把1变为0,把0变为1 。~x 类似于 -x-1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u0026lt;\u0026lt;\u003c/td\u003e\n\u003ctd\u003e左移动运算符：运算数的各二进位全部左移若干位，由\u0026quot;\u0026lt;\u0026lt;\u0026quot;右边的数指定移动的位数，高位丢弃，低位补0。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cblockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e| 右移动运算符：把\u0026quot;\u0026gt;\u0026gt;\u0026quot;左边的运算数的各二进位全部右移若干位，\u0026quot;\u0026gt;\u0026gt;\u0026quot;右边的数指定移动的位数\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"python-逻辑运算符\"\u003ePython 逻辑运算符\u003c/h3\u003e\n\u003cp\u003e逻辑运算符用于对操作数进行逻辑运算。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e运算符\u003c/th\u003e\n\u003cth\u003e逻辑表达式\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eand\u003c/td\u003e\n\u003ctd\u003ex and y\u003c/td\u003e\n\u003ctd\u003e布尔\u0026quot;与\u0026quot; - 如果 x 为 False，x and y 返回 False，否则它返回 y 的计算值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eor\u003c/td\u003e\n\u003ctd\u003ex or y\u003c/td\u003e\n\u003ctd\u003e布尔\u0026quot;或\u0026quot;\t- 如果 x 是非 0，它返回 x 的值，否则它返回 y 的计算值\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003enot\u003c/td\u003e\n\u003ctd\u003enot x\u003c/td\u003e\n\u003ctd\u003e布尔\u0026quot;非\u0026quot; - 如果 x 为 True，返回 False 。如果 x 为 False，它返回 True\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"python-成员运算符\"\u003ePython 成员运算符\u003c/h3\u003e\n\u003cp\u003ePython支持成员运算符，包含了一系列的成员，例如字符串，列表或元组。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e运算符\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003cth\u003e实例\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ein\u003c/td\u003e\n\u003ctd\u003e如果在指定的序列中找到值返回 True，否则返回 False\u003c/td\u003e\n\u003ctd\u003ex 在 y 序列中 , 如果 x 在 y 序列中返回 True\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003enot in\u003c/td\u003e\n\u003ctd\u003e如果在指定的序列中没有找到值返回 True，否则返回 False\u003c/td\u003e\n\u003ctd\u003ex 不在 y 序列中 , 如果 x 不在 y 序列中返回 True\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"python-身份运算符\"\u003ePython 身份运算符\u003c/h3\u003e\n\u003cp\u003e身份运算符用于比较两个对象的存储单元。\u003c/p\u003e\n\u003cp\u003eid() 函数用于获取对象内存地址。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e运算符\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003cth\u003e实例\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eis\u003c/td\u003e\n\u003ctd\u003eis 是判断两个标识符是不是引用自一个对象\u003c/td\u003e\n\u003ctd\u003ex is y, 类似 id(x) == id(y) , 如果引用的是同一个对象则返回 True，否则返回 False\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eis not\u003c/td\u003e\n\u003ctd\u003eis not 是判断两个标识符是不是引用自不同对象\u003c/td\u003e\n\u003ctd\u003ex is not y ， 类似 id(a) != id(b)。如果引用的不是同一个对象则返回结果 True，否则返回 False\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"is-和--的区别\"\u003eis 和 == 的区别\u003c/h3\u003e\n\u003cp\u003eis 用于判断两个变量引用对象是否为同一个。\u003c/p\u003e\n\u003cp\u003e== 用于判断引用变量的值是否相等。\u003c/p\u003e\n\u003ch3 id=\"python-运算符优先级\"\u003ePython 运算符优先级\u003c/h3\u003e\n\u003cp\u003e以下表格列出了从最高到最低优先级的所有运算符：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e运算符\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e**\u003c/td\u003e\n\u003ctd\u003e指数 (最高优先级)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e~+-\u003c/td\u003e\n\u003ctd\u003e按位翻转, 一元加号和减号 (最后两个的方法名为 +@ 和 -@)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cul\u003e\n\u003cli\u003e/ % // | 乘，除，取模和取整除\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cul\u003e\n\u003cli\u003e| 加法减法\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u0026lt;\u0026lt; | 右移，左移运算符\n\u0026amp; | 位 'AND'\n^ | | 位运算符\n\u0026lt;= \u0026lt; \u0026gt; \u0026gt;= | 比较运算符\n\u0026lt;\u0026gt; == != | 等于运算符\n= %= /= //= -= += *= **= | 赋值运算符\nis not is | 身份运算符\nin not in | 成员运算符\nnot or and| 逻辑运算符\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/blockquote\u003e","date":1505260800,"description":"","fuzzywordcount":1700,"kind":"page","lang":"zh","lastmod":1505260800,"objectID":"52e6e5e90668fec2ff9231d913ca2bc8","publishdate":1505260800,"relpermalink":"/posts/programming/python/python-operator/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Python 语言中的运算符。\u003c/p\u003e","tags":["Python"],"title":"Python 运算符","url":"https://xdhuxc.github.io/posts/programming/python/python-operator/","wordcount":1632},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Python 编程的基础语法。\u003c/p\u003e\n\u003ch3 id=\"python编程\"\u003ePython编程\u003c/h3\u003e\n\u003cp\u003ePython编程方式\u003c/p\u003e\n\u003ch4 id=\"交互式编程\"\u003e交互式编程\u003c/h4\u003e\n\u003cp\u003e交互式编程不需要创建脚本文件，是通过 Python 解释器的交互模式进来编写代码。\u003c/p\u003e\n\u003cp\u003e在 linux上，只需要在命令行中输入 Python 命令即可启动交互式编程，提示窗口如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ python\nPython 2.7.6 (default, Sep  9 2014, 15:04:36) \n[GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.39)] on darwin\nType \u0026#34;help\u0026#34;, \u0026#34;copyright\u0026#34;, \u0026#34;credits\u0026#34; or \u0026#34;license\u0026#34; for more information.\n\u0026gt;\u0026gt;\u0026gt; \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 Windows 上，安装 Python 时已经安装了默认的交互式编程客户端。\u003c/p\u003e\n\u003ch4 id=\"脚本式编程\"\u003e脚本式编程\u003c/h4\u003e\n\u003cp\u003e通过脚本参数调用解释器开始执行脚本，直到脚本执行完毕。当脚本执行完成后，解释器不再有效。\u003c/p\u003e\n\u003cp\u003e所有 Python 文件将以 \u003ccode\u003e.py\u003c/code\u003e 为扩展名。\u003c/p\u003e\n\u003cp\u003e假设已经设置了 Python 解释器 PATH 变量。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003exdhuxc.py\u003c/code\u003e 文件的内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# -*- coding: utf-8 -*- \n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nprint \u0026#34;Hello,Python!\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用以下命令运行程序：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ python xdhuxc.py\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用另外一种方式来执行Python脚本，修改 \u003ccode\u003exdhuxc.py\u003c/code\u003e 文件，内容如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: utf-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nprint \u0026#34;Hello, Python!\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e这里，假定 Python 解释器在 \u003ccode\u003e/usr/bin\u003c/code\u003e 目录中，使用以下命令执行脚本：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ chmod +x xdhuxc.py # 为脚本xdhuxc.py添加可执行权限\n$ ./xdhuxc.py\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"python-标识符\"\u003ePython 标识符\u003c/h3\u003e\n\u003cp\u003e在 Python 里，标识符由字母、数字、下划线组成。\u003c/p\u003e\n\u003cp\u003e在 Python 中，所有标识符可以包括英文、数字以及下划线 \u003ccode\u003e_\u003c/code\u003e，但不能以数字开头。\u003c/p\u003e\n\u003cp\u003e在 Python 中，标识符是区分大小写的。\u003c/p\u003e\n\u003cp\u003e以 \u003ccode\u003e下划线开头\u003c/code\u003e 的标识符是有特殊意义的：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e以单下划线开头 \u003ccode\u003e_foo\u003c/code\u003e 的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用 \u003ccode\u003efrom xxx import *\u003c/code\u003e 而导入；\u003c/li\u003e\n\u003cli\u003e以双下划线开头的 \u003ccode\u003e__foo\u003c/code\u003e 代表类的私有成员；\u003c/li\u003e\n\u003cli\u003e以双下划线开头和结尾的 \u003ccode\u003e__foo__\u003c/code\u003e 代表 \u003ccode\u003ePython\u003c/code\u003e 里特殊方法专用的标识，如 \u003ccode\u003e__init__()\u003c/code\u003e 代表类的构造函数。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"python-保留字\"\u003ePython 保留字\u003c/h3\u003e\n\u003cp\u003ePython 的保留字不能用作常数或变量，或任何其他标识符名称。\u003c/p\u003e\n\u003cp\u003e所有 Python 的关键字只包含小写字母。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eand\u003c/th\u003e\n\u003cth\u003eexec\u003c/th\u003e\n\u003cth\u003enot\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eassert\u003c/td\u003e\n\u003ctd\u003efinally\u003c/td\u003e\n\u003ctd\u003eor\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ebreak\u003c/td\u003e\n\u003ctd\u003efor\u003c/td\u003e\n\u003ctd\u003epass\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eclass\u003c/td\u003e\n\u003ctd\u003efrom\u003c/td\u003e\n\u003ctd\u003eprint\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003econtinue\u003c/td\u003e\n\u003ctd\u003eglobal\u003c/td\u003e\n\u003ctd\u003eraise\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003edef\u003c/td\u003e\n\u003ctd\u003eif\u003c/td\u003e\n\u003ctd\u003ereturn\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003edel\u003c/td\u003e\n\u003ctd\u003eimport\u003c/td\u003e\n\u003ctd\u003etry\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eelif\u003c/td\u003e\n\u003ctd\u003ein\u003c/td\u003e\n\u003ctd\u003ewhile\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eelse\u003c/td\u003e\n\u003ctd\u003eis\u003c/td\u003e\n\u003ctd\u003ewith\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eexcept\u003c/td\u003e\n\u003ctd\u003elambda\u003c/td\u003e\n\u003ctd\u003eyield\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"行和缩进\"\u003e行和缩进\u003c/h3\u003e\n\u003cp\u003ePython 与其他语言最大的区别就是：Python 的代码块不使用大括号 {} 来控制类，函数以及其他逻辑判断。\u003c/p\u003e\n\u003cp\u003epython 最具特色的就是用缩进来写模块。\u003c/p\u003e\n\u003cp\u003e缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。\u003c/p\u003e\n\u003cp\u003e在 Python 的代码块中，必须使用相同数量的行首缩进空格数。建议在每个缩进层次使用 单个制表符 或 两个空格 或 四个空格 , 切记不能混用\u003c/p\u003e\n\u003ch3 id=\"多行语句\"\u003e多行语句\u003c/h3\u003e\n\u003cp\u003ePython语句中一般以新行作为为语句的结束符。\u003c/p\u003e\n\u003cp\u003e在 Python 中，可以在同一行显示多条语句，方法是用分号 \u003ccode\u003e;\u003c/code\u003e 分开。\u003c/p\u003e\n\u003cp\u003e可以使用斜杠（ \\）将一行的语句分为多行显示，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etotal = item_one + \\\n        item_two + \\\n        item_three\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e语句中包含 [], {} 或 () 括号就不需要使用多行连接符，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edays = [\u0026#39;Monday\u0026#39;, \u0026#39;Tuesday\u0026#39;, \u0026#39;Wednesday\u0026#39;,\n        \u0026#39;Thursday\u0026#39;, \u0026#39;Friday\u0026#39;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"python-引号\"\u003ePython 引号\u003c/h3\u003e\n\u003cp\u003ePython 可以使用单引号 \u003ccode\u003e'\u003c/code\u003e、双引号 \u003ccode\u003e\u0026quot;\u003c/code\u003e、三引号 \u003ccode\u003e'''\u003c/code\u003e 或 \u003ccode\u003e\u0026quot;\u0026quot;\u0026quot;\u003c/code\u003e 来表示字符串，引号的开始与结束必须是相同的类型。\u003c/p\u003e\n\u003cp\u003e其中三引号可以由多行组成，是编写多行文本的快捷语法，常用于文档字符串，在文件的特定位置，被当做注释。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eword = \u0026#39;word\u0026#39;\nsentence = \u0026#34;这是一个句子。\u0026#34;\nparagraph = \u0026#34;\u0026#34;\u0026#34;这是一个段落。\n包含了多个语句\u0026#34;\u0026#34;\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"python-注释\"\u003ePython 注释\u003c/h3\u003e\n\u003cp\u003epython 中单行注释采用 \u003ccode\u003e# \u003c/code\u003e开头。\u003c/p\u003e\n\u003cp\u003e注释可以在语句或表达式行末；\u003c/p\u003e\n\u003cp\u003ePython 中多行注释使用三个单引号 \u003ccode\u003e'''\u003c/code\u003e 或三个双引号 \u003ccode\u003e\u0026quot;\u0026quot;\u0026quot;\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 文件名：test.py\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\n\u0026#39;\u0026#39;\u0026#39;\n这是多行注释，使用单引号。\n这是多行注释，使用单引号。\n这是多行注释，使用单引号。\n\u0026#39;\u0026#39;\u0026#39;\n\n\u0026#34;\u0026#34;\u0026#34;\n这是多行注释，使用双引号。\n这是多行注释，使用双引号。\n这是多行注释，使用双引号。\n\u0026#34;\u0026#34;\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"空行\"\u003e空行\u003c/h3\u003e\n\u003cp\u003e函数之间或类的方法之间用空行分隔，表示一段新的代码的开始。类和函数入口之间也用一行空行分隔，以突出函数入口的开始。\u003c/p\u003e\n\u003cp\u003e空行与代码缩进不同，空行并不是Python语法的一部分。书写时不插入空行，Python解释器运行也不会出错。但是空行的作用在于分隔两段不同功能或含义的代码，便于日后代码的维护或重构。\u003c/p\u003e\n\u003cp\u003e注意：空行也是程序代码的一部分。\u003c/p\u003e\n\u003ch3 id=\"代码组\"\u003e代码组\u003c/h3\u003e\n\u003cp\u003e缩进相同的一组语句构成一个代码块，称之代码组。\u003c/p\u003e\n\u003cp\u003e像 \u003ccode\u003eif\u003c/code\u003e、\u003ccode\u003ewhile\u003c/code\u003e、\u003ccode\u003edef\u003c/code\u003e 和 \u003ccode\u003eclass\u003c/code\u003e 这样的复合语句，首行以关键字开始，以冒号 \u003ccode\u003e:\u003c/code\u003e 结束，该行之后的一行或多行代码构成代码组。\u003c/p\u003e\n\u003cp\u003e将首行及后面的代码组称为一个子句。\n如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eif expression : \n   suite \nelif expression :  \n   suite  \nelse :  \n   suite \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"其他\"\u003e其他\u003c/h3\u003e\n\u003cp\u003e1、print 默认输出是换行的，如果要实现不换行需要在变量末尾加上逗号。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e#!/usr/bin/python\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -*- coding: UTF-8 -*-\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\nx=\u0026#34;a\u0026#34;\n\u003cspan class=\"gh\"\u003e# 换行输出\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eprint x\n\nprint \u0026#39;---------\u0026#39;\n\u003cspan class=\"gh\"\u003e# 不换行输出\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eprint x,\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、\u003ccode\u003e#!/usr/bin/python\u003c/code\u003e 的含义\u003c/p\u003e\n\u003cp\u003e脚本语言的第一行，目的就是指出，你想要你的这个文件中的代码用什么可执行程序去运行它，\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e#!/usr/bin/python\u003c/code\u003e : 是告诉操作系统执行这个脚本的时候，调用 /usr/bin 下的 python 解释器；\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e#!/usr/bin/env \u003c/code\u003e：python(推荐）: 这种用法是为了防止操作系统用户没有将 python 装在默认的 /usr/bin 路径里。当系统看到这一行的时候，首先会到 env 设置里查找 python 的安装路径，再调用对应路径下的解释器程序完成操作。\u003c/p\u003e","date":1505174400,"description":"","fuzzywordcount":1900,"kind":"page","lang":"zh","lastmod":1505174400,"objectID":"f91b7636ba954932521d11cd3bab458b","publishdate":1505174400,"relpermalink":"/posts/programming/python/python-basic-programming-syntax/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Python 编程的基础语法。\u003c/p\u003e","tags":["Python"],"title":"Python 基础语法","url":"https://xdhuxc.github.io/posts/programming/python/python-basic-programming-syntax/","wordcount":1847},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了一些其他的问题及解决方法。\u003c/p\u003e\n\u003ch3 id=\"google-浏览器配置可访问自定义的-https\"\u003eGoogle 浏览器配置可访问自定义的 \u003ccode\u003ehttps\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eWindows\u003c/code\u003e 系统下，在 \u003ccode\u003echrome\u003c/code\u003e 快捷方式的属性中，修改快捷方式中的目标，添加 \u003ccode\u003e--test-type --ignore-certificate-errors\u003c/code\u003e，最后目标项的值为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026#34;C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\u0026#34; --test-type --ignore-certificate-errors\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后使用该快捷方式打开浏览器，即可访问自定义的 \u003ccode\u003ehttps\u003c/code\u003e 地址。\u003c/p\u003e","date":1504915200,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1499558400,"objectID":"d006a00f0b10f3cf8e35a43c63aac250","publishdate":1504915200,"relpermalink":"/posts/mixed/mixed/","section":"posts","summary":"\u003cp\u003e本篇博客记录了一些其他的问题及解决方法。\u003c/p\u003e","tags":["杂项"],"title":"一些其他问题及解决方式","url":"https://xdhuxc.github.io/posts/mixed/mixed/","wordcount":134},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍下 Python 及其开发环境搭建。\u003c/p\u003e\n\u003ch3 id=\"python\"\u003ePython\u003c/h3\u003e\n\u003cp\u003ePython 是一个高层次的结合了解释性、编译性、互动性和面向对象的脚本语言。\u003c/p\u003e\n\u003ch4 id=\"python-1\"\u003ePython\u003c/h4\u003e\n\u003cp\u003ePython 的设计具有很强的可读性，相比其他语言经常使用英文关键字，其他语言的一些标点符号，它具有比其他语言更有特色语法结构。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePython 是一种解释型语言： 这意味着开发过程中没有了编译这个环节。类似于PHP和Perl语言。\u003c/li\u003e\n\u003cli\u003ePython 是交互式语言： 这意味着，您可以在一个Python提示符，直接互动执行写你的程序。\u003c/li\u003e\n\u003cli\u003ePython 是面向对象语言: 这意味着Python支持面向对象的风格或代码封装在对象的编程技术。\u003c/li\u003e\n\u003cli\u003ePython 是初学者的语言：Python 对初级程序员而言，是一种伟大的语言，它支持广泛的应用程序开发，从简单的文字处理到 WWW 浏览器再到游戏。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"python的特点\"\u003ePython的特点\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e易于学习：Python有相对较少的关键字，结构简单，和一个明确定义的语法，学习起来更加简单。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e易于阅读：Python代码定义的更清晰。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e易于维护：Python的成功在于它的源代码是相当容易维护的。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e一个广泛的标准库：Python的最大的优势之一是丰富的库，跨平台的，在UNIX，Windows和Macintosh兼容很好。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e互动模式：互动模式的支持，您可以从终端输入执行代码并获得结果的语言，互动的测试和调试代码片断。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e可移植：基于其开放源代码的特性，Python已经被移植（也就是使其工作）到许多平台。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e可扩展：如果你需要一段运行很快的关键代码，或者是想要编写一些不愿开放的算法，你可以使用C或C++完成那部分程序，然后从你的Python程序中调用。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e数据库：Python提供所有主要的商业数据库的接口。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGUI编程：Python支持GUI可以创建和移植到许多系统调用。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e可嵌入: 你可以将Python嵌入到C/C++程序，让你的程序的用户获得\u0026quot;脚本化\u0026quot;的能力。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"python-环境搭建\"\u003ePython 环境搭建\u003c/h3\u003e\n\u003cp\u003ePython可应用于多平台包括 Linux 和 Mac OS X。\u003c/p\u003e\n\u003ch4 id=\"在-linuxunix-上搭建-python-环境\"\u003e在 Linux/Unix 上搭建 Python 环境\u003c/h4\u003e\n\u003cp\u003e1、打开WEB浏览器访问 \u003ca href=\"http://www.python.org/download/\"\u003ehttp://www.python.org/download/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e2、选择适用于Unix/Linux的源码压缩包，下载并解压压缩包。\u003c/p\u003e\n\u003cp\u003e3、如果需要自定义一些选项修改Modules/Setup，执行 ./configure 脚本\u003c/p\u003e\n\u003cp\u003e4、执行命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emake\nmake install\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行以上操作后，Python会安装在 /usr/local/bin 目录中，Python库安装在/usr/local/lib/pythonXX，XX为你使用的Python的版本号。\u003c/p\u003e\n\u003ch4 id=\"在-windows-上搭建-python-开发环境\"\u003e在 Windows 上搭建 Python 开发环境\u003c/h4\u003e\n\u003cp\u003e1、打开 WEB 浏览器访问 \u003ca href=\"http://www.python.org/download/\"\u003ehttp://www.python.org/download/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e2、在下载列表中选择Window平台安装包，包格式为：python-XYZ.msi 文件 ， XYZ 为要安装的版本号。\u003c/p\u003e\n\u003cp\u003e3、要使用安装程序 python-XYZ.msi, Windows系统必须支持Microsoft Installer 2.0搭配使用。只要保存安装文件到本地计算机，然后运行它。\u003c/p\u003e\n\u003cp\u003e4、下载后，双击下载包，进入Python安装向导，安装非常简单，你只需要使用默认的设置一直点击\u0026quot;下一步\u0026quot;直到安装完成即可。\u003c/p\u003e\n\u003ch4 id=\"环境变量的设置\"\u003e环境变量的设置\u003c/h4\u003e\n\u003cp\u003e程序和可执行文件可以在许多目录，而这些路径很可能不在操作系统提供可执行文件的搜索路径中。\u003c/p\u003e\n\u003cp\u003epath(路径)存储在环境变量中，这是由操作系统维护的一个命名的字符串。这些变量包含可用的命令行解释器和其他程序的信息。\u003c/p\u003e\n\u003cp\u003eUnix或Windows中路径变量为PATH（UNIX区分大小写，Windows不区分大小写）。\u003c/p\u003e\n\u003cp\u003e1、在 Unix/Linux 中设置环境变量\u003c/p\u003e\n\u003cp\u003e在 bash shell 命令行下输入\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eexport PATH=\u0026#34;$PATH:/usr/local/bin/python\u0026#34; # /usr/local/bin/python 是 Python 的安装目录\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在 Windows 中设置环境变量\n在命令提示框中输入：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ePATH=%PATH%;C:\\Python # C:\\Python为Python的安装路径\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"python-环境变量\"\u003ePython 环境变量\u003c/h3\u003e\n\u003cp\u003ePython 中重要的环境变量\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e变量名\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003ePYTHONPATH\u003c/td\u003e\n\u003ctd\u003ePYTHONPATH是Python搜索路径，默认我们import的模块都会从PYTHONPATH里面寻找\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePYTHONSTARTUP\u003c/td\u003e\n\u003ctd\u003ePython启动后，先寻找PYTHONSTARTUP环境变量，然后执行此文件中变量指定的执行代码\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePYTHONCASEOK\u003c/td\u003e\n\u003ctd\u003e加入PYTHONCASEOK的环境变量, 就会使python导入模块的时候不区分大小写.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePYTHONHOME\u003c/td\u003e\n\u003ctd\u003e另一种模块搜索路径。它通常内嵌于的PYTHONSTARTUP或PYTHONPATH目录中，使得两个模块库更容易切换。\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"运行-python\"\u003e运行 Python\u003c/h3\u003e\n\u003cp\u003e有三种方式可以运行Python\u003c/p\u003e\n\u003ch4 id=\"交互式解释器\"\u003e交互式解释器\u003c/h4\u003e\n\u003cp\u003e可以通过命令行窗口进入 python，并在交互式解释器中开始编写 Python 代码。\u003c/p\u003e\n\u003cp\u003e可以在 Unix，DOS或任何其他提供了命令行或者shell的系统中进行 python 编码工作。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ python # Unix/Linux\n或\nC:\u0026gt;python # Windows/DOS\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"命令行脚本\"\u003e命令行脚本\u003c/h4\u003e\n\u003cp\u003e在应用程序中通过引入解释器，可以在命令行中执行Python脚本，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e$ python script_name.py # Unix/Linux\n或\nC:\u0026gt;python script_name.py # Windows/DOS\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意：在执行脚本时，请检查脚本是否有可执行权限。\u003c/p\u003e\n\u003ch4 id=\"集成开发环境\"\u003e集成开发环境\u003c/h4\u003e\n\u003cp\u003ePyCharm功能：调试、语法高亮、Project管理、代码跳转、智能提示、自动完成、单元测试、版本控制……\u003c/p\u003e\n\u003ch3 id=\"python中文编码\"\u003ePython中文编码\u003c/h3\u003e\n\u003cp\u003e在 Python 2.x 中，默认的编码格式是 ASCII 格式，在没修改编码格式时无法正确打印汉字，所以在读取中文时会报错。\u003c/p\u003e\n\u003cp\u003e解决：在文件开头加入 \u003ccode\u003e# -*- coding: utf-8 -*-\u003c/code\u003e 或者 \u003ccode\u003e#coding=utf-8\u003c/code\u003e 即可。\u003c/p\u003e\n\u003cp\u003e在 Python 3.x 中源码文件默认使用 utf-8 编码，所以可以正常解析中文，无需指定 utf-8 编码。\u003c/p\u003e","date":1504828800,"description":"","fuzzywordcount":2000,"kind":"page","lang":"zh","lastmod":1504828800,"objectID":"ab8d7b86c6fad8149b6c1034cd28968c","publishdate":1504828800,"relpermalink":"/posts/programming/python/python-introduction/","section":"posts","summary":"\u003cp\u003e本篇博客介绍下 Python 及其开发环境搭建。\u003c/p\u003e","tags":["Python"],"title":"Python 简介及开发环境搭建","url":"https://xdhuxc.github.io/posts/programming/python/python-introduction/","wordcount":1972},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在 Linux 系统中常用的命令，以备后查。\u003c/p\u003e\n\u003ch2 id=\"chown\"\u003echown\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003echown将指定文件的拥有者改为指定的用户或组，用户可以是用户名或者用户ID；组可以是组名或者组ID；文件是以空格分开的要改变权限的文件列表，支持通配符。系统管理员经常使用chown命令，在将文件拷贝到另一个用户的名录下之后，让用户拥有使用该文件的权限。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e通过chown改变文件的拥有者和群组。在更改文件的所有者或所属群组时，可以使用用户名称和用户识别码设置。普通用户不能将自己的文件改变成其他的拥有者。其操作权限一般为管理员。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003echown [options] [所有者][:[组]] 文件...\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"参数\"\u003e参数\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-c：显示更改的部分的信息\n-f：忽略错误信息\n-h：修复符号链接\n-R：处理指定目录以及其子目录下的所有文件\n-v：显示详细的处理信息\n-deference：作用于符号链接的指向，而不是链接文件本身\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、将文件 abc.txt 的所有者设置为 xdhuxc，所属组设置为 jessie。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003echown jessie:xdhuxc abc.txt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、把文件 abc.txt 所属的组设置为 jessie\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003echown :jessie abc.txt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、将akhdie目录及其所有子目录和所有文件到新的用户xdhuxc和用户组jessie\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003echown -R jessie:xdhuxc akhdie/*\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"ln\"\u003eln\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eln命令的功能是为某一个文件在另外一个位置建立一个同步的链接。\n当我们需要在不同的目录，用到相同的文件时，我们不需要在每一个需要的目录下都放一个必须相同的文件，我们只要在某个固定的目录，放上该文件，然后在 其它的目录下用ln命令链接它就可以，不必重复的占用磁盘空间。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-1\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eln [参数] [源文件或目录] [目标文件或目录]\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"链接的分类\"\u003e链接的分类\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e链接(link)，我们可以将其视为档案的别名，而链接又可分为两种 : 硬链接(hard link)与软链接(symbolic link)，硬链接的意思是一个档案可以有多个名称，而软链接的方式则是产生一个特殊的档案，该档案的内容是指向另一个档案的位置。硬链接是存在同一个文件系统中，而软链接却可以跨越不同的文件系统。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"软链接\"\u003e软链接\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e软链接，以路径的形式存在。类似于Windows操作系统中的快捷方式\u003c/li\u003e\n\u003cli\u003e软链接可以 跨文件系统 ，硬链接不可以\u003c/li\u003e\n\u003cli\u003e软链接可以对一个不存在的文件名进行链接\u003c/li\u003e\n\u003cli\u003e软链接可以对目录进行链接\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"硬链接\"\u003e硬链接\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e硬链接，以文件副本的形式存在。但不占用实际空间。\u003c/li\u003e\n\u003cli\u003e不允许给目录创建硬链接\u003c/li\u003e\n\u003cli\u003e硬链接只有在同一个文件系统中才能创建\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"注意\"\u003e注意：\u003c/h2\u003e\n\u003cp\u003e1、ln命令会保持每一处链接文件的同步性，也就是说，不论你改动了哪一处，其它的文件都会发生相同的变化；\u003c/p\u003e\n\u003cp\u003e2、ln的链接又分软链接和硬链接两种，软链接就是ln –s 源文件 目标文件，它只会在你选定的位置上生成一个文件的镜像，不会占用磁盘空间，硬链接 ln 源文件 目标文件，没有参数-s， 它会在你选定的位置上生成一个和源文件大小相同的文件，无论是软链接还是硬链接，文件都保持同步变化。\u003c/p\u003e\n\u003ch3 id=\"参数-1\"\u003e参数\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-b：删除，覆盖以前建立的链接\n-s：软链接(符号链接)\n-v：显示详细的处理过程\n-i：交互模式，文件存在则提示用户是否覆盖\n-f：强制执行\n-n：把符号链接视为一般目录\n-d：允许超级用户制作目录的硬链接\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-1\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、给文件给文件创建软链接，为abc.log文件创建软链接abc_link，如果abc.log丢失，abc_link将失效.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eln -s abc.log abc_link\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、给文件创建硬链接，为abc.log创建硬链接abc_link，abc.log与abc_link的各项属性相同\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eln abc.log abc_link\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、给目录创建软链接\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eln -sv /usr/local/src /home/xdhuxc/src\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e目录只能创建软链接。\u003c/li\u003e\n\u003cli\u003e目录创建链接必须用绝对路径，相对路径创建会不成功，会提示：符号连接的层数过多 这样的错误。\u003c/li\u003e\n\u003cli\u003e在链接目标目录中修改文件都会在源文件目录中同步变化。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"使用场合\"\u003e使用场合\u003c/h3\u003e\n\u003cp\u003e1、软链接适用场景（相当于windows的的快捷方式）\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e在文件系统中多处共享同一个较大文件时，使用软链接就可以避免创建多个副本。\u003c/li\u003e\n\u003cli\u003e维护动态库文件的版本时，使用软链接，在升级库文件后，只需修改软链接的源文件，而使用该库的程序则不需要修改。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2、硬链接使用场景\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e其实是一个指针，指向文件索引节点，系统并不为它重新分配inode.通过使用硬链接可达到备份数据(实际是备份节点)的效果。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"mkdir\"\u003emkdir\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003emkdir 命令用于创建目录\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-2\"\u003e语法：\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emkdir [options] directory_name\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"参数-2\"\u003e参数\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-p,--parents：可以是一个路径名称。此时若路径中的某些目录尚不存在,加上此选项后,系统将自动建立好那些尚不存在的目录,即一次可以建立多个目录\n-m：-mode=模式，设定权限\u0026lt;模式\u0026gt; \n-v,--verbose：每次创建新目录都显示信息\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-2\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、在当前目录下，建立一个名为 directory_name 的子目录。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emkdir directory_name\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、在当前目录下的  directory_name 目录中，建立一个名为 sub_directory_name 的子目录。 若 directory_name  目录原本不存在，则建立一个。若不加 -p，且原本 directory_name 目录不存在，则产生错误。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emkdir -p directory_name/sub_directory_name\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、创建权限为777的目录abc\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emkdir -m 777 abc\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"sudo\"\u003esudo\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003esudo命令用来以其他身份来执行命令，预设的身份为root。在/etc/sudoers中设置了可执行sudo指令的用户。若其未经授权的用户企图使用sudo，则会发出警告的邮件给管理员。用户使用sudo时，必须先输入密码，之后有5分钟的有效期限，超过期限则必须重新输入密码。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-3\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esudo [options] others\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-V：显示版本编号；\n-l 显示出自己（执行 sudo 的使用者）的权限；\n-u username/#uid 不加此参数，代表要以 root 的身份执行指令，而加了此参数，可以以 username 的身份执行指令（#uid 为该 username 的使用者号码）；\n-s 执行环境变数中的 SHELL 所指定的 shell ，或是 /etc/passwd 里所指定的 shell；\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-3\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、指定以用户xdhuxc权限执行命令\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esudo -u xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、显示sudo设置\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esudo -L\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、以root权限执行上一条命令\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esudo !!\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e4、以 xdhuxc 用户编辑 /home/xdhuxc/www 目录中的 index.html 文件\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esudo -u xdhuxc vim ~www/index.html\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"echo\"\u003eecho\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e用于字符串的输出，一般起到一个提示符的作用\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-4\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho 字符串\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"参数-3\"\u003e参数：\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-e：若字符串中出现以下字符，则加以特殊处理，而不会将它当成一般字符对待。 特殊字符有：\n\n    \\a 发出警告声\n    \\b 删除前一个字符\n    \\c 最后不加上换行符号\n    \\f 换行但光标仍旧停留在原来的位置\n    \\n 换行且光标移至行首\n    \\r 光标移至行首，但不换行\n    \\t 插入tab\n    \\v 与\\f相同\n    \\\\ 插入\\字符\n    \\nnn 插入nnn（八进制）所代表的ASCII字符\n    - help 显示帮助\n    - version 显示版本信息\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-4\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、显示普通字符串\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho \u0026quot;I will be better!\u0026quot;\n或                           # 输出为：I will be better!\necho \u0026quot;I will be better!\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、显示转义字符\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho \u0026quot;\\\u0026quot;I will be better!\\\u0026quot;\u0026quot; # 输出为：\u0026quot;I will be better!\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、显示变量\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho \u0026quot;$name will be better!\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e4、显示换行或不换行\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho -e \u0026quot;OK! \\n\u0026quot; # -e 开启转义 \\n 换行\n或\necho -e \u0026quot;OK! \\c\u0026quot; # -e 开启转义 \\c 不换行\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e5、显示结果定向至文件\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho \u0026quot;I will be better!\u0026quot; \u0026gt; mylife\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e6、原样输出字符串，不进行转义或取变量，用单引号\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho '$name\\\u0026quot;' # 输出结果为：$name\\\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e7、显示命令执行结果，使用反引号\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eecho `date` # 结果将显示当前日期\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"ps\"\u003eps\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eps命令用于显示当前进程 (process) 的状态\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-5\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eps [options] [--help]\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-1\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-A：列出所有的进程；\n-a：显示终端中包括其它用户的所有进程；\n-x：显示无控制终端的进程；\n-w：加宽显示，可以显示较多的信息；\n-au：显示较详细的信息；\n-aux：显示所有进程，也包含其他使用者的进程；\n-f：用全格式来显示。\n-e：选择全部的进程，等同于 -A。\n-L：可能的话，追加 LWP 和 NLWP 栏显示线程。\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eau(x)输出格式：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eUSER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND\nUSER：进程所有者；\nPID：进程ID号，是一个进程的唯一标识ID；\n%CPU：进程的CPU使用率；\n%MEM：进程的内存占用率；\nVSZ：进程占用的虚拟内存大小；\nRSS：\nTTY：终端；\nSTAT：进程的状态，包括；\n\n\n\nSTART：进程开始时间；\nTIME：进程执行的时间；\nCOMMAND：所执行的指令；\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-5\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、显示进程信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eps -A\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、显示root进程用户信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eps -u root\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、显示所有进程信息，连同命令行\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eps -ef\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"ps--ef-和-ps-aux-的区别\"\u003eps -ef 和 ps aux 的区别\u003c/h2\u003e\n\u003cp\u003e1、-ef 是 System V 展示风格，而 aux 是 BSD 风格。\nps -ef 的执行输出：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ps -ef | head -n 2\nUID        PID  PPID  C STIME TTY          TIME CMD\nroot         1     0  0 Jun07 ?        00:01:36 /usr/lib/systemd/systemd --switched-root --system --deserialize 21\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e字段含义：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUID：用户ID或用户名。\u003c/li\u003e\n\u003cli\u003ePID：进程ID。\u003c/li\u003e\n\u003cli\u003ePPID：父进程ID。\u003c/li\u003e\n\u003cli\u003eLWP：轻量进程（light weight process）或者线程ID。\u003c/li\u003e\n\u003cli\u003eC：CPU 用于计算执行优先级的因子。数值越大，表明该进程是 CPU 密集型运算，执行优先级会降低；数值越小，表明该进程是 I/O  密集型运算，执行优先级会提高。\u003c/li\u003e\n\u003cli\u003eNLWP：进程里的LWP（线程）数。\u003c/li\u003e\n\u003cli\u003eSTIME：进程启动的时间。\u003c/li\u003e\n\u003cli\u003eTTY：完整的终端名称。\u003c/li\u003e\n\u003cli\u003eTIME：CPU时间。\u003c/li\u003e\n\u003cli\u003eCMD：完整的启动进程所用的命令和参数。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eps aux 的执行输出\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[root@xdhuxc ~]# ps aux | head -n 2\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.0 190788  3544 ?        Ss   Jun07   1:36 /usr/lib/systemd/systemd --switched-root --system --deserialize 21\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e字段含义：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUSER：用户名称。\u003c/li\u003e\n\u003cli\u003ePID：进程ID号，是一个进程的唯一标识ID。\u003c/li\u003e\n\u003cli\u003e%CPU：进程占 CPU 的百分比。\u003c/li\u003e\n\u003cli\u003e%MEM：进程占用物理内存的百分比。\u003c/li\u003e\n\u003cli\u003eVSZ：进程占用的虚拟内存大小，单位：KB。\u003c/li\u003e\n\u003cli\u003eRSS：进程占用的物理内存大小，单位：KB。\u003c/li\u003e\n\u003cli\u003eTTY：终端名称（缩写），若为?，则表示此进程与终端无关，因为它们是由系统启动的。\u003c/li\u003e\n\u003cli\u003eSTAT：进程状态\n（1）S：睡眠。\n（2）s：表示该进程是回话的先导进程。\n（3）N：表示该进程拥有比普通优先级更低的优先级。\n（4）R：正在运行。\n（5）D：短期等待。\n（6）Z：僵死进程。\n（7）T：被跟踪或者被停止\u003c/li\u003e\n\u003cli\u003eSTARTED：进程的启动时间。\u003c/li\u003e\n\u003cli\u003eTIME：CPU 时间，即进程使用 CPU 的总时间。\u003c/li\u003e\n\u003cli\u003eCOMMAND：启动进程所用的命令和参数，如果命令过长，会被截断显示。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2、COMMAND 列如果过长，ps aux 会截断显示；而 ps -ef 则不会。\u003c/p\u003e\n\u003ch2 id=\"grep\"\u003egrep\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003egrep命令用于查找文件里符合条件的字符串。grep指令用于查找内容包含指定的范本样式的文件，如果发现某文件的内容符合所指定的范本样式，预设grep指令会把含有范本样式的那一列显示出来。若不指定任何文件名称，或是所给予的文件名为\u0026quot;-\u0026quot;，则grep指令会从标准输入设备读取数据。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e学习网址：\n\u003ca href=\"http://blog.csdn.net/xy010902100449/article/details/51426354\"\u003ehttp://blog.csdn.net/xy010902100449/article/details/51426354\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://blog.csdn.net/shuanzia/article/details/50392987\"\u003ehttp://blog.csdn.net/shuanzia/article/details/50392987\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"语法-6\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egrep [-options] pattern file_name\n或\ngrep [-options] pattern directory_name\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-2\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-c,--count：计算符合模式的列数；\n-d,--directories：当指定要查找的是目录而非文件时，必须使用这项参数，否则grep命令将回报信息并停止动作；\n-v,--recursive：查找不匹配的行；\n-o：只打印出匹配到的字符；\n-E：将范本样式为延伸的普通表示法来使用，意味着能使用扩展正则表达式；\n--color：把匹配到的字符用颜色显示出来；\n-i：不区分大小写；\n-n：在行首显示行号；\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-6\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、在当前目录中，查找后缀包含\u0026quot;sh\u0026quot;字样的文件中包含\u0026quot;test\u0026quot;字符串的文件\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egrep test *file\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、以递归的方式查找符合条件的文件。查找目录/etc/acpi 及其子目录下所有文件中包含字符串\u0026quot;update\u0026quot;的文件，并打印出该字符串所在行的内容\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egrep -r update /etc/acpi # 以递归的方式查找目录/etc/acpi下包含字符串“update”的文件\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、反向查找，打印出不符合条件行的内容，查找文件名中包含 test 的文件中不包含test 的行\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egrep -v test *test*\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"tar\"\u003etar\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003etar 是用来建立、还原备份文件的工具程序，它可以加入，解开备份文件内的文件。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-7\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003etar [options] file_name\n或\ntar [options] derictory_name\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-3\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-C destination_directory_name,--directory=destination_directory_name：解压或压缩到指定的目录。\n-f file_name,--file=file_name：指定待压缩或解压的文件\n-t,--list： 列出待解压或压缩文件的内容。\n-v,--verbose：显示命令执行的过程。\n-x,--extract,--get：从压缩文件中解压文件。\n-z,--gzip,--unzip：通过gzip命令处理压缩文件\n--exclude=pattern：去除符合模式的文件。\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-7\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、压缩文件，压缩文件a.c为abc.tar.gz\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003etar -czvf abc.tar.gz a.c \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、列出压缩文件abc.tar.gz的内容\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003etar -tzvf abc.tar.gz\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、解压文件abc.tar.gz\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003etar -zxf abc.tar.gz # 不显示解压过程\n或者\ntar -zxvf abc.tar.gz # 显示解压过程\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e4、解压文件abc.tgz\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003etar -xz abc.tgz -C /data/xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"ls\"\u003els\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003els 命令用于显示指定工作目录下的内容，列出当前工作目录的文件及子目录的文件\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-8\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003els [-options] directory_name\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-4\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-a 显示所有文件及目录 (ls默认将文件名或目录名开头为\u0026quot;.\u0026quot;的视为隐藏文档，不会列出)\n-l：除文件名称外，亦将文件型态、权限、拥有者、文件大小等资讯详细列出\n-r：将文件以相反次序显示，原定依英文字母次序；\n-t：将文件依建立时间之先后次序列出\n-A：同 -a ，但不列出 \u0026quot;.\u0026quot; (目前目录) 及 \u0026quot;..\u0026quot; (父目录)\n-F：在列出的文件名称后加一符号；例如可执行档则加 \u0026quot;*\u0026quot;, 目录则加 \u0026quot;/\u0026quot;\n-R：若目录下有文件，则以下之文件亦皆依序列出\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-8\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、列出根目录()下的所有目录\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003els /\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、列出当前工作目录下所有文件名以 s 开头的文件，越新的排越后面\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003els -ltr s*\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、将 /bin 目录及其所有子目录和文件详细信息列出\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003els -lR /bin\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e4、列出当前目录下的所有文件及子目录，目录于名称后加 \u0026quot;/\u0026quot;, 可执行文件于名称后加 \u0026quot;*\u0026quot;\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003els -AF\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"eval\"\u003eeval\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e此命令适用于那些一次扫描无法实现其功能的变量.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eeval cmd_line\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e1、eval命令将会首先扫描命令行，进行所有的替换，然后再执行命令。此命令适用于那些一次扫描无法实现其功能的变量，该命令对变量进行两次扫描，如果第一遍扫描后，cmd_line是个普通命令，则执行此命令；如果cmd_line中含有变量的间接引用，则保证间接引用的语义。这些需要进行两次扫描的变量有时候被称为复杂变量。\u003c/p\u003e\n\u003cp\u003e2、eval也可以用于回显简单变量，不一定是复杂变量。\u003c/p\u003e\n\u003ch2 id=\"rm\"\u003erm\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003erm命令用于删除一个文件或者目录\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-9\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003erm [options] file_name/directory_name\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-5\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-i：删除文件或目录前逐一询问确认；\n-f：强制删除，即使原文件或目录属性设置为只读，也直接删除，无需逐一确认；\n-r：递归删除目录及其子目录下的所有文件；\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-9\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、删除文件abc.txt\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003erm abc.txt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、递归删除当前目录下的所有文件及子目录\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003erm -r *\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"注意-1\"\u003e注意\u003c/h3\u003e\n\u003cp\u003e1、文件一旦通过rm命令删除，则无法恢复，所以必须格外小心地使用该命令。\n2、若删除目录，则必须配合选项\u0026quot;-r\u0026quot;。\u003c/p\u003e\n\u003ch2 id=\"which\"\u003ewhich\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003ewhich指令会在环境变量$PATH设置的目录里查找符合条件的文件。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-10\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewhich [file...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-6\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-V：显示版本信息\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-10\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、使用命令 which 查看命令 bash 的绝对路径\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewhich bash # 显示bash可执行程序的绝对路径 \n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"mv\"\u003emv\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003emv命令用来为文件或目录改名或将文件或目录移入其它位置。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-11\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emv [options] source destination\nmv [options] source... directory\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"参数-4\"\u003e参数\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-i：若指定目录已有同名文件，则先询问是否覆盖旧文件;\n-f：在mv操作要覆盖某已有的目标文件时不给任何指示;\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-11\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、将文件file_name_1重命名为file_name_2\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emv file_name_1 file_name_2\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、将info目录放入logs目录中。如果logs目录不存在，则该命令将info改名为logs。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emv info/ logs\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、将/usr/xdhuxc目录下的所有文件和目录移到/home目录下\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emv /usr/xdhuxc/* /home\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"scp\"\u003escp\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003escp是linux系统下基于ssh登陆进行安全的远程文件复制命令。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-12\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003escp [options] [[user@]host1:]file1 [...]  [[user@]host2]:]file2\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"参数-5\"\u003e参数\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-r：递归复制整个目录；\n-q：不显示传输进度条；\n-v：详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题；\n-P：指定数据传输用到的端口号；\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-12\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、从本地复制文件到远程主机\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003escp local_file remote_username@remote_ip:remote_folder # 指定了用户名，命令执行后需要再输入密码，仅指定了远程的目录，文件名字不变\n或\nscp local_file remote_username@remote_ip:remote_file # 指定了用户名，命令执行后需要再输入密码，指定了文件名；\n或\nscp local_file remote_ip:remote_folder # 没有指定用户名，命令执行后需要输入用户名和密码，仅指定了远程的目录，文件名字不变\n或\nscp local_file remote_ip:remote_file # 没有指定用户名，命令执行后需要输入用户名和密码，指定了文件名；\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、从本地复制目录到远程主机\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003escp -r local_folder remote_username@remote_ip:remote_folder # 指定了用户名，命令执行后需要再输入密码；\n或\nscp -r local_folder remote_ip:remote_folder # 没有指定用户名，命令执行后需要输入用户名和密码；\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"注意-2\"\u003e注意\u003c/h3\u003e\n\u003cp\u003e1、使用scp命令要确保使用的用户具有可读取远程服务器相应文件的权限，否则scp命令是无法起作用的。\u003c/p\u003e\n\u003ch2 id=\"groupadd\"\u003egroupadd\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003egroupadd命令用于创建一个新的工作组，新工作组的信息将被添加到系统文件中。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-13\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egroupadd [options] 参数\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-7\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-g：指定新建工作组的id；\n-r：创建系统工作组，系统工作组的组id小于500；\n-K：覆盖配置文件 /etc/login.defs；\n-o：允许添加组ID号不唯一的工作组\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-13\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、创建一个工作组，并设置组ID加入系统，此时在 /etc/passwd 文件中产生一个组 ID（GID） 是344的项目。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egroupadd -g 344 xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"useradd\"\u003euseradd\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003euseradd 可用来建立用户帐号。帐号建好之后，再用passwd设定帐号的密码．而可用userdel删除帐号。使用useradd指令所建立的帐号，实际上是保存在/etc/passwd文本文件中。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-14\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003euseradd [options] others\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-8\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-d directory_name：指定用户进入系统时的目录；\n-g：指定用户所属的群组；\n-m：自动创建用户进入系统时的目录；\n-r：建立系统帐号；\n-s shell_name：指定用户进入系统后所使用的shell；\n-u user_id：指定用户id\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-14\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、创建一个一般用户\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003euseradd akfdrt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、为创建的用户指定用户组\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003euseradd -g root akfdrt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、创建一个系统用户\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003euseraddd -r akfdrt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e4、为新创建的用户指定 home 目录\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003euseradd -d /home/akfdrt akfdrt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e5、创建新用户且指定用户id\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003euseradd akfdrt -u 273\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"su\"\u003esu\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003esu命令用于变更为其他使用者的身份，除 root 外，需要键入该使用者的密码。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-15\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esu [-fmp] [-c command] [-s shell] [--help] [--version] [-] [USER [ARG]]\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-9\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-c command 或 --command=command 变更为帐号为 USER 的使用者并执行指令（command）后再变回原来使用者\n-s shell 或 --shell=shell 指定要执行的 shell （bash csh tcsh 等），预设值为 /etc/passwd 内的该使用者（USER） shell;\nUSER 欲变更的使用者帐号\nARG 传入新的 shell 参数\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-15\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、变更帐号为 root 并在执行 ls 指令后退出变回原使用者\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esu -c ls root\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、变更帐号为 root 并传入 -f 参数给新执行的 shell\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esu root -f\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、变更帐号为 ajdlfw 并改变工作目录至 ajdlfw 的 home 目录\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esu - ajdlfw\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"netstat\"\u003enetstat\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003enetstat命令用于显示网络状态。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-16\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enetstat [-acCeFghilMnNoprstuvVwx][-A\u0026lt;网络类型\u0026gt;][--ip]\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-10\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-a,--all：显示所有连接中的Socket；\n-t,--tcp：显示TCP传输协议的连接状况；\n-u,--udp：显示UDP传输协议的连接状况；\n-v,--verbose：显示命令的执行过程；\n-V,--version：显示版本信息；\n-r,--route：显示路由表；\n-i,--interfaces：显示网络界面信息表单；\n-n,--numeric：直接使用IP地址，而不通过域名服务器；\n-s,--statistics：显示网络工作信息统计表；\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-16\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、显示详细的网络状况\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enetstat -a\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、显示当前用户UDP连接状况\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enetstat -nu\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、显示UDP端口号的使用情况\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enetstat -apu\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e4、显示网卡列表\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enetstat -i\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e5、显示网络统计信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enetstat -s\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e6、显示监听的套接口\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enetstat -l\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"kill\"\u003ekill\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003ekill 命令用于删除执行中的程序或工作。kill可将指定的信息送至程序。预设的信息为SIGTERM(15)，可将指定程序终止。若仍无法终止该程序，可使用SIGKILL(9)信息尝试强制删除程序。程序或工作的编号可利用ps指令或jobs指令查看。\n语法\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-17\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ekill [-s \u0026lt;信息名称或编号\u0026gt;][程序]\n或\nkill [-l \u0026lt;信息编号\u0026gt;]\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-11\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-l \u0026lt;信息编号\u0026gt; 　若不加\u0026lt;信息编号\u0026gt;选项，则-l参数会列出全部的信息名称；\n-s \u0026lt;信息名称或编号\u0026gt; 　指定要送出的信息；\n[程序] 可以是程序的PID或是PGID，也可以是工作编号。\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-17\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、杀死指定用户xdhuxc的所有进程\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ekill -9 $(ps -ef|grep xdhuxc)\n或\nkill -u xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"curl\"\u003ecurl\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003ecurl命令是一个利用URL规则在命令行下工作的文件传输工具。它支持文件的上传和下载，所以是综合传输工具，但按传统，习惯称curl为下载工具。作为一款强力工具，curl支持包括HTTP、HTTPS、ftp等众多协议，还支持POST、cookies、认证、从指定偏移处下载部分文件、用户代理字符串、限速、文件大小、进度条等特征。做网页处理流程和数据检索自动化，curl可以祝一臂之力。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-18\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecurl [options] 参数\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-12\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-o：将文件保存为命令行中指定的文件名的文件中；\n-O：使用URL中默认的文件名保存文件到本地；\n-C：可对大文件使用断点续传功能\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-18\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、 将文件下载到本地，并命名为：kjsifg.html\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecurl -o kjsifg.html http://www.gnu.org/software/gettext/manual/gettext.html\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、将文件下载到本地，并命名为gettext.html\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecurl -O http://www.gnu.org/software/gettext/manual/gettext.html\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"wget\"\u003ewget\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003ewget命令用来从指定的URL下载文件。wget非常稳定，它在带宽很窄的情况下和不稳定网络中有很强的适应性，如果是由于网络的原因下载失败，wget会不断的尝试，直到整个文件下载完毕。如果是服务器打断下载过程，它会再次联到服务器上从停止的地方继续下载。这对从那些限定了链接时间的服务器上下载大文件非常有用\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-19\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewget [options] 参数\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-13\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-r：递归下载方式；\n-v：显示详细执行过程；\n-q：不显示执行过程；\n-nv：下载时只显示更新和出错信息，不显示指令的详细执行过程；\n-c：断点续传，重新启动下载中断的文件\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-19\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、使用 wget下载单个文件，保存在当前目录，在下载的过程中会显示进度条，包含（下载完成百分比，已经下载的字节，当前下载速度，剩余下载时间）。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewget http://www.linux.net/abc.zip\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、使用 wget 下载文件并以不同的文件名保存\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewget -O wordpress.zip http://www.linux.net/download.aspx?id=1080\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、使用 wget 下载多个文件\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewget -i file_list.txt\ncat file_list \u0026lt;\u0026lt; EOF\nurl_1\nurl_2\nurl_3\nurl_4\nEOF\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"注意-3\"\u003e注意\u003c/h3\u003e\n\u003cp\u003e1、wget 默认会以最后一个符合 / 的后面的字符来命令文件，对于动态链接的下载通常文件名会不正确。\n为了解决该问题，可以使用选项 -O 来指定一个文件名。\u003c/p\u003e\n\u003ch2 id=\"cp\"\u003ecp\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003ecp命令用于复制文件或目录\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-20\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecp [options] source destination\n或\ncp [options] source... directory\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-14\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-a：此选项通常在复制目录时使用，它保留链接、文件属性，并复制目录下的所有内容。其作用等于dpR参数组合；\n-f：覆盖已经存在的目标文件而不给出提示；\n-i：在覆盖目标文件之前给出提示，要求用户确认是否覆盖，回答\u0026quot;y\u0026quot;时目标文件将被覆盖；\n-p：除复制文件的内容外，还把修改时间和访问权限也复制到新文件中；\n-r,-R：若给出的源文件是一个目录文件，此时将复制该目录下所有的子目录和文件。\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-20\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、将目录 /abc 下的所有文件及子目录复制到新目录/new_abc下\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ecp -r /abc/ /new_abc/ \n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"find\"\u003efind\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003efind命令用来在指定目录下查找文件。任何位于参数之前的字符串都将被视为欲查找的目录名。如果使用该命令时，不设置任何参数，则find命令将在当前目录下查找子目录与文件。并且将查找到的子目录和文件全部进行显示。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-21\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efind path -option [-print] [-exec -ok command] {};\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-15\"\u003e选项\u003c/h3\u003e\n\u003cp\u003efind 根据下列规则判断 path 和 expression，在命令列上第一个 - ( ) , ! 之前的部份为 path，之后的是 expression。如果 path 是空字串则使用目前路径，如果 expression 是空字串则使用 -print 为预设 expression。\u003c/p\u003e\n\u003cp\u003eexpression 中可使用的选项：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-name name, -iname name：文件名称符合 name 的文件。iname 会忽略大小写\n-type file_type：文件类型是file_type的文件\n文件类型包括：\nd：目录；\nc：字符设备文件，比如猫、键盘、鼠标等串口设备；\nb：块设备文件，比如硬盘、光驱等设备；\np：命名管道文件；\nf：普通文件；\nl：符号链接文件；\ns：套接字文件\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e可以使用 \u003ccode\u003e()\u003c/code\u003e 将运算符分隔，并使用下列运算\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eexpression_1 -and expression_2\n! expression\n-not expression\nexpression_1 -or expression_2\nexpression_1, expression_2\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-21\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、将当前目录及其子目录下所有扩展名名是 \u003ccode\u003e.c\u003c/code\u003e 的文件列出来。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efind . -name \u0026quot;*.c\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、将当前目录及其子目录中所有的普通文件列出\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efind . -type f\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、查找名字符合正则表达式的文件\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efind ./ -regex .*so.*\\.gz\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"source\"\u003esource\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003esource命令通常用于重新执行刚修改的初始化文件，使之立即生效，而不必注销并重新登录。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-22\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esource file_name\n或\nsource . file_name\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"df\"\u003edf\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003edf命令用于显示目前在Linux系统上的文件系统的磁盘使用情况统计。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-23\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edf [options]... [FILE]...\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-16\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-h：--human-readable 使用人类可读的格式，预设值是不加这个选项的\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-22\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、显示所有的信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edf -total\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"sed\"\u003esed\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003esed是一种流式编辑器，它是文本处理中非常常用的工具，能够完美地配合正则表达式使用，主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。\n处理时，把当前处理的行存储在临时缓冲区中，称为“模式空间”，接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕，接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向存储输出。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、直接编辑文件选项-i，会匹配file文件中每一行的第一个book替换为books\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esed -i 's/book/books/g' file #替换操作，s命令\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、使用后缀/g标记会替换每一行中的所有匹配\nsed 还可以用行为单位进行部分数据的搜寻并取代\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003esed 's/要被取代的字符串/新的字符串/g'\n即\nsed 's/book/books/g' file\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"awk\"\u003eawk\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eawk是一种编程语言，用于在linux/unix下对文本和数据进行处理。数据可以来自标准输入(stdin)、一个或多个文件，或其它命令的输出。它支持用户自定义函数和动态正则表达式等先进功能，是linux/unix下的一个强大编程工具。它在命令行中使用，但更多是作为脚本来使用。awk有很多内建的功能，比如数组、函数等，这是它和C语言的相同之处，灵活性是awk最大的优势。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、打印每一行的第二个和第三个字段，当使用不带参数的print时，它就打印当前行，当print的参数是以逗号进行分隔时，打印时则以空格作为定界符。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eawk '{ print $2,$3}' file_name\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"du\"\u003edu\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003edu命令用于显示目录或文件的大小，显示指定的目录或文件所占用的磁盘空间。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"语法-24\"\u003e语法\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edu [-abcDhHklmsSx][-L \u0026lt;符号连接\u0026gt;][-X \u0026lt;文件\u0026gt;][--block-size][--exclude=\u0026lt;目录或文件\u0026gt;][--max-depth=\u0026lt;目录层数\u0026gt;][--help][--version][目录或文件]\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"选项-17\"\u003e选项\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e--max-depth=\u0026lt;目录层数\u0026gt; 超过指定层数的目录后，予以忽略\n-h或--human-readable 以K，M，G为单位，以人类易读的方式显示，提高信息的可读性。\n-S或--separate-dirs 显示个别目录的大小时，并不含其子目录的大小。\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"示例-23\"\u003e示例\u003c/h3\u003e\n\u003cp\u003e1、显示指定文件所占空间，以人类易读的方式显示。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edu -h abc.log\n\u003c/code\u003e\u003c/pre\u003e","date":1504742400,"description":"","fuzzywordcount":10200,"kind":"page","lang":"zh","lastmod":1504742400,"objectID":"60ce38323bcf567cade4b613ebb69c0c","publishdate":1504742400,"relpermalink":"/posts/linux/linux-common-command/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在 Linux 系统中常用的命令，以备后查。\u003c/p\u003e","tags":["Linux"],"title":"Linux 常用命令总结","url":"https://xdhuxc.github.io/posts/linux/linux-common-command/","wordcount":10123},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在使用 docker 的过程中常见的问题及解决方法。\u003c/p\u003e\n\u003cp\u003e1、配置的镜像加速地址不生效，可能是因为同时配置了代理的缘故，取消代理的配置，重启 \u003ccode\u003edocker\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e2、使用 \u003ccode\u003edocker save\u003c/code\u003e 保存镜像，在另外的机器上重新加载该镜像，但是当 \u003ccode\u003edocker pull\u003c/code\u003e 该镜像时，还是会从 \u003ccode\u003edocker store\u003c/code\u003e 上拉取，并没有直接使用本地的，很可能是因为 \u003ccode\u003edocker save\u003c/code\u003e 和 \u003ccode\u003edocker load\u003c/code\u003e 时使用的 \u003ccode\u003edocker\u003c/code\u003e 的版本不一致，使用相同版本的 \u003ccode\u003edocker\u003c/code\u003e 试试。\u003c/p\u003e\n\u003cp\u003e3、在使用 \u003ccode\u003eVMware workstation\u003c/code\u003e 创建的虚拟机中，拉取 \u003ccode\u003edocker\u003c/code\u003e 镜像时，报错如下：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/docker/questions-and-solutions/WechatIMG639.png\" width=\"800px\" height=\"300px\" /\u003e\n\u003c/center\u003e\n\u003cp\u003e在一些实验室环境，服务器没有直接连接外网的权限，需要通过网络代理。通常会将网络代理直接配置在 \u003ccode\u003e/etc/environment\u003c/code\u003e、\u003ccode\u003e/etc/profile\u003c/code\u003e 之类的配置文件中，这对于大部分操作都是可行的。然而，\u003ccode\u003edocker\u003c/code\u003e 命令却使用不了这些代理。比如 \u003ccode\u003edocker pull\u003c/code\u003e 时需要从外网下载镜像，就会出现上述错误。\u003c/p\u003e\n\u003cp\u003e所以，需要我们配置 docker 的网络代理\u003c/p\u003e\n\u003cp\u003e1）为 \u003ccode\u003edocker\u003c/code\u003e 服务创建一个内嵌的 \u003ccode\u003esystemd\u003c/code\u003e 目录\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /etc/systemd/system/docker.service.d\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）创建 \u003ccode\u003e/etc/systemd/system/docker.service.d/http-proxy.conf\u003c/code\u003e 文件，并添加 \u003ccode\u003eHTTP_PROXY\u003c/code\u003e 环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Service]\nEnvironment=\u0026#34;HTTP_PROXY=http://10.3.15.206:8888/\u0026#34; \u0026#34;HTTPS_PROXY=http://10.3.15.206:8888/\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003e10.3.15.206\u003c/code\u003e 为代理的 \u003ccode\u003eIP\u003c/code\u003e 地址，\u003ccode\u003e8888\u003c/code\u003e 为代理的端口。可以使用 \u003ccode\u003ehttp\u003c/code\u003e 代理 \u003ccode\u003ehttps\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e3）如果还有内部的不需要使用代理来访问的 \u003ccode\u003eDocker registries\u003c/code\u003e，那么还需要指定 \u003ccode\u003eNO_PROXY\u003c/code\u003e 环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[Service]\nEnvironment=\u0026#34;HTTP_PROXY=http://[proxy-addr]:[proxy-port]/\u0026#34; \u0026#34;HTTPS_PROXY=http://[proxy-addr]:[proxy-port]/\u0026#34; \u0026#34;NO_PROXY=localhost,127.0.0.1,docker-registry.somecorporation.com\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4）更新配置并重启docker服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload\nsystemctl restart docker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e或者直接在 \u003ccode\u003e/usr/lib/system/system/docker.service\u003c/code\u003e 中添加环境变量，重启加载配置，启动 \u003ccode\u003edocker\u003c/code\u003e 服务。\u003c/p\u003e\n\u003cp\u003e1）在 \u003ccode\u003edocker.service\u003c/code\u003e 中添加如下环境变量\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eEnvironment=HTTP_PROXY=http://10.3.15.206:8888/\nEnvironment=HTTPS_PROXY=http://10.3.15.206:8888/\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）重新加载配置并重启 \u003ccode\u003edocker\u003c/code\u003e 服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload\nsystemctl restart docker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、推送镜像到私有仓库时报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker push 192.168.91.128:5000/busybox:latest\nThe push refers to a repository [192.168.91.128:5000/busybox]\nGet https://192.168.91.128:5000/v1/_ping: http: server gave HTTP response to HTTPS client\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e原因：由提示可知，Docker 客户端使用 HTTPS 协议访问 Docker Registry，Docker Registry 采用 HTTP 协议响应导致的。\u003c/p\u003e\n\u003cp\u003e解决：在 \u003ccode\u003e/etc/docker/daemon.json\u003c/code\u003e 文件中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{ \n    # 192.168.91.128为镜像仓库所在主机的IP地址\n    # 5000为镜像仓库的访问端口号\n    \u0026#34;insecure-registries\u0026#34;:[\u0026#34;192.168.91.128:5000\u0026#34;] \n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后重新启动 Docker 进程，即可拉取镜像。\u003c/p\u003e\n\u003cp\u003e5、有些非常大的docker镜像文件，在执行加载命令时，提示“no space left on device ”，如下图所示：\n\u003cimg src=\"https://thumbnail0.baidupcs.com/thumbnail/ba983385327a8fbf8f0ac2c2046d4e86?fid=766960113-250528-475660698789264\u0026amp;time=1516104000\u0026amp;rt=sh\u0026amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-ddjVf5Fp3DawhAuIVoOCL0hDxeA%3D\u0026amp;expires=8h\u0026amp;chkv=0\u0026amp;chkbd=0\u0026amp;chkpc=\u0026amp;dp-logid=367320601015891313\u0026amp;dp-callid=0\u0026amp;size=c710_u400\u0026amp;quality=100\u0026amp;vuk=-\u0026amp;ft=video\" alt=\"image\"\u003e\n但实际上，docker的工作目录存储空间足够，因此可能是docker限制了最大可加载镜像的大小，在启动 docker 的命令中添加如下参数：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e--storage-opt dm.basesize=60G --storage-opt dm.loopmetadatasize=10G\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 docker 进程，即可加载大型镜像。\u003c/p\u003e\n\u003cp\u003e6、从镜像仓库拉取镜像时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@iuap-vm-23 compose_manage]# docker pull 172.20.26.113:5000/yonyoucloud-middleware/mysql:5.6.37\n5.6.37: Pulling from yonyoucloud-middleware/mysql\n4b3659249717: Pulling fs layer \nc8583c11f183: Pulling fs layer \n7e7cf3a87134: Pulling fs layer \n00b4cfdf2950: Pulling fs layer \ndf7f67bbf575: Pulling fs layer \nb63454f1c8a6: Pulling fs layer \n2af4970f1cf4: Waiting \n07f81aa4b24b: Waiting \nec3e1cfce710: Waiting \n3cfb59dd6cbd: Waiting \n912915d933d3: Pulling fs layer \nopen /data/developercenter_enterprise/data_center/docker/data/tmp/GetImageBlob519470722: no such file or directory\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 docker\u003c/p\u003e\n\u003cp\u003e7、执行 docker ps 命令无果，重新启动 docker 时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-node containers]# systemctl status docker -l\n● docker.service - Docker Application Container Engine\n   Loaded: loaded (/usr/lib/systemd/system/docker.service; enabled; vendor preset: disabled)\n   Active: activating (start) since Thu 2018-06-28 11:28:45 CST; 59s ago\n     Docs: https://docs.docker.com\n Main PID: 15819 (dockerd)\n   Memory: 109.3M\n   CGroup: /system.slice/docker.service\n           ├─ 3109 docker-containerd-shim deaf8701233f2b6168510faddcf25144bf7dcba3351c111c5c70cb0bfa7e681a /var/run/docker/libcontainerd/deaf8701233f2b6168510faddcf25144bf7dcba3351c111c5c70cb0bfa7e681a docker-runc\n           ├─15819 /usr/bin/dockerd --storage-driver=devicemapper --insecure-registry 0.0.0.0/0 --graph=/data/docker\n           ├─15826 docker-containerd -l unix:///var/run/docker/libcontainerd/docker-containerd.sock --metrics-interval=0 --start-timeout 2m --state-dir /var/run/docker/libcontainerd/containerd --shim docker-containerd-shim --runtime docker-runc\n           └─17205 docker-containerd-shim ac94b262a5df2f482378b79eb9ce130b29f9dc8c4908d56f4633d8f44d776660 /var/run/docker/libcontainerd/ac94b262a5df2f482378b79eb9ce130b29f9dc8c4908d56f4633d8f44d776660 docker-runc\n\nJun 28 11:28:45 k8s-node systemd[1]: Starting Docker Application Container Engine...\nJun 28 11:28:45 k8s-node dockerd[15819]: time=\u0026#34;2018-06-28T11:28:45+08:00\u0026#34; level=warning msg=\u0026#34;the \\\u0026#34;-g / --graph\\\u0026#34; flag is deprecated. Please use \\\u0026#34;--data-root\\\u0026#34; instead\u0026#34;\nJun 28 11:28:45 k8s-node dockerd[15819]: time=\u0026#34;2018-06-28T11:28:45.616437324+08:00\u0026#34; level=info msg=\u0026#34;libcontainerd: new containerd process, pid: 15826\u0026#34;\nJun 28 11:28:46 k8s-node dockerd[15819]: time=\u0026#34;2018-06-28T11:28:46.622111922+08:00\u0026#34; level=warning msg=\u0026#34;failed to rename /data/docker/tmp for background deletion: %!s(\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e). Deleting synchronously\u0026#34;\nJun 28 11:28:46 k8s-node dockerd[15819]: time=\u0026#34;2018-06-28T11:28:46.644187197+08:00\u0026#34; level=warning msg=\u0026#34;devmapper: Usage of loopback devices is strongly discouraged for production use. Please use \u003cspan class=\"sb\"\u003e`--storage-opt dm.thinpooldev`\u003c/span\u003e or use \u003cspan class=\"sb\"\u003e`man docker`\u003c/span\u003e to refer to dm.thinpooldev section.\u0026#34;\nJun 28 11:28:46 k8s-node dockerd[15819]: time=\u0026#34;2018-06-28T11:28:46.688238156+08:00\u0026#34; level=warning msg=\u0026#34;devmapper: Base device already exists and has filesystem xfs on it. User specified filesystem  will be ignored.\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e首先，查看磁盘是否还有空间，\u003c/p\u003e\n\u003cp\u003e8、构建 docker 镜像时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eStep 6/7 : ADD src/template /etc/template/\nADD failed: stat /var/lib/docker/tmp/docker-builder488455212/src/template: no such file or directory\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e而实际上，该路径是正确的，可能是将该目录的上级目录放到了 .gitignore 文件中，将该目录放到 .gitignore 文件中包含的目录之外即可。\u003c/p\u003e","date":1503705600,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1508630400,"objectID":"cd75fa1cc332c01647044bf31d9dee13","publishdate":1503705600,"relpermalink":"/posts/docker/docker-questions-and-solutions/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在使用 docker 的过程中常见的问题及解决方法。\u003c/p\u003e","tags":["Docker"],"title":"Docker 中常见问题及解决","url":"https://xdhuxc.github.io/posts/docker/docker-questions-and-solutions/","wordcount":1295},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了配置 nginx 转发 marathon 管理页面到其他地址的方法。\u003c/p\u003e\n\u003cp\u003e问题描述：\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003emarathon\u003c/code\u003e 平时是带端口访问的，现在需要将其统一到 \u003ccode\u003e80\u003c/code\u003e 端口访问，使用 \u003ccode\u003enginx\u003c/code\u003e 作为代理。\u003c/p\u003e\n\u003cp\u003e一般情况下，其访问地址为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.17.4:8080\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e返回的显示地址为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.17.4:8080/ui/#/apps\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e我们注意到，浏览器地址栏中变动的部分在 \u003ccode\u003e/ui/#/\u003c/code\u003e 之后\u003c/p\u003e\n\u003cp\u003e在 \u003ccode\u003enginx\u003c/code\u003e 中配置如下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eserver {\n    listen 80;\n    \n    location ^~ /marathon/ {\n        proxy_set_header Host $http_host;\n        proxy_set_header X-Forward-For $proxy_add_x_forward_for;\n        proxy_pass http://172.20.17.4:8080/;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003e8080\u003c/code\u003e 后面的斜杠至关重要。\u003c/p\u003e\n\u003cp\u003e访问如下地址：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.17.4/marathon\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e浏览器地址栏显示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://172.20.17.4/marathon/ui/#/apps\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1503705600,"description":"","fuzzywordcount":200,"kind":"page","lang":"zh","lastmod":1508630400,"objectID":"f40a5dc8e6cd48672f75d7a53fbfdf0f","publishdate":1503705600,"relpermalink":"/posts/mixed/nginx/nginx-marathon/","section":"posts","summary":"\u003cp\u003e本篇博客记录了配置 nginx 转发 marathon 管理页面到其他地址的方法。\u003c/p\u003e","tags":["Nginx"],"title":"nginx 配置 marathon ","url":"https://xdhuxc.github.io/posts/mixed/nginx/nginx-marathon/","wordcount":178},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 \u003ccode\u003eDockerfile\u003c/code\u003e 各种命令的使用方法，对于构建 \u003ccode\u003edocker\u003c/code\u003e 镜像及运行 \u003ccode\u003eDocker\u003c/code\u003e 容器都是不可不知的。\u003c/p\u003e\n\u003ch3 id=\"dockerfile-简介\"\u003eDockerfile 简介\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eDockerfile\u003c/code\u003e 是一个文本格式的配置文件，可以使用 \u003ccode\u003eDockerfile\u003c/code\u003e 快速创建自定义镜像\u003c/p\u003e\n\u003cp\u003eDockerfile官方网址：https://github.com/docker-library\u003c/p\u003e\n\u003ch3 id=\"dockerfile-基本结构\"\u003eDockerfile 基本结构\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003eDockerfile\u003c/code\u003e 由一行行命令语句组成，并且支持以 “#” 开头的注释行。\u003c/p\u003e\n\u003cp\u003e一般而言，\u003ccode\u003eDockerfile\u003c/code\u003e 分为四个部分：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e基础镜像信息\u003c/li\u003e\n\u003cli\u003e维护者信息\u003c/li\u003e\n\u003cli\u003e镜像操作指令\u003c/li\u003e\n\u003cli\u003e容器启动时执行指令\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e一个典型的 \u003ccode\u003eDockerfile\u003c/code\u003e 如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# This dockerfile uses the ubuntu image\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# VERSION 2 - EDITION 1\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# Author: docker_user\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# Command format: Instruction [arguments / command]..\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e# 第一行必须指定基于的基础镜像\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eFROM ubuntu\n\n\u003cspan class=\"gh\"\u003e# 维护者信息\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eMAINTAINER docker_user docker_user@email.com\n\n\u003cspan class=\"gh\"\u003e# 镜像的操作指令\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eRUN echo \u0026#34;deb http://archive.ubuntu.com/ubuntu/  raring main universe\u0026#34; \u0026gt;\u0026gt; /etc/apt/sources.list\nRUN apt-get update \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get install -y nginx\nRUN echo \u0026#34;\\ndaemon off;\u0026#34; \u0026gt;\u0026gt; /etc/nginx/nginx.conf\n\n\u003cspan class=\"gh\"\u003e# 容器启动时执行指令\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003eCMD /usr/sbin/nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"指令\"\u003e指令\u003c/h3\u003e\n\u003cp\u003e指令的一般格式为：INSTRUCTION arguments，指令包括：FROM、MAINTAINER、RUN等。\u003c/p\u003e\n\u003ch4 id=\"from\"\u003eFROM\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eFROM \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \n或\nFROM \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e:\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etag\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e第一条指令必须为 \u003ccode\u003eFROM\u003c/code\u003e 指令，并且，如果在同一个 \u003ccode\u003eDockerfile\u003c/code\u003e 中创建多个镜像时，可以使用多个 \u003ccode\u003eFROM\u003c/code\u003e 指令，每个镜像一次。\u003c/p\u003e\n\u003ch4 id=\"maintainer\"\u003eMAINTAINER\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eMAINTAINER \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e指定维护者信息\u003c/p\u003e\n\u003ch4 id=\"run\"\u003eRUN\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eRUN \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ecommand\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n或\nRUN [\u0026#34;executable\u0026#34;, \u0026#34;param1\u0026#34;, \u0026#34;param2\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e前者将在 Shell 终端中运行命令，即 \u003ccode\u003e/bin/sh -c\u003c/code\u003e ；\u003c/p\u003e\n\u003cp\u003e后者则使用 \u003ccode\u003eexec\u003c/code\u003e 执行，指定使用其他终端可以通过这种方式实现，例如 \u003ccode\u003eRUN [\u0026quot;/bin/bash\u0026quot;, \u0026quot;-c\u0026quot;, \u0026quot;echo hello\u0026quot;]\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e每条RUN指令将在当前镜像基础上执行指定指令，并提交为新的镜像。\u003c/p\u003e\n\u003cp\u003e每运行一条RUN指令，镜像添加新的一层，并提交。\u003c/p\u003e\n\u003cp\u003e当命令较长时，可以使用 \u003ccode\u003e\\\u003c/code\u003e 来换行。\u003c/p\u003e\n\u003ch4 id=\"cmd\"\u003eCMD\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCMD [\u0026#34;executable\u0026#34;, \u0026#34;param1\u0026#34;, \u0026#34;param2\u0026#34;]  \u003cspan class=\"ni\"\u003e#使用\u003c/span\u003e exec 执行，推荐方式\n或\nCMD command param1 param2 # 在/bin/bash 中执行，提供给需要交互的应用\n或\nCMD [\u0026#34;param1\u0026#34;, \u0026#34;param2\u0026#34;] # 提供给 ENTRYPOINT 的默认参数\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e指定启动容器时执行的命令，每个 \u003ccode\u003eDockerfile\u003c/code\u003e 只能有一条 \u003ccode\u003eCMD\u003c/code\u003e 命令。如果指定了多条命令，只有最后一条会被执行。\u003c/p\u003e\n\u003cp\u003e如果用户启动容器时，指定了运行的命令，则会覆盖掉 \u003ccode\u003eCMD\u003c/code\u003e 指定的命令。\u003c/p\u003e\n\u003ch4 id=\"expose\"\u003eEXPOSE\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eEXPOSE \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e [\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e...]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e告诉 Docker 服务端容器暴露的端口号，供互联系统使用。\u003c/p\u003e\n\u003cp\u003e在启动容器时需要通过 \u003ccode\u003e-p\u003c/code\u003e 选项指定，\u003ccode\u003eDocker\u003c/code\u003e 主机会自动分配一个端口转发到指定的端口。\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003e-p\u003c/code\u003e，则可以具体指定哪个本地端口映射过来。\u003c/p\u003e\n\u003ch4 id=\"env\"\u003eENV\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eENV \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e指定一个环境变量，会被后续 \u003ccode\u003eRUN\u003c/code\u003e 指令使用，并在容器运行时保持\u003c/p\u003e\n\u003ch4 id=\"copy\"\u003eCOPY\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCOPY \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003esrc\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edest\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e复制本地主机的 \u003ccode\u003e\u0026lt;src\u0026gt;\u003c/code\u003e（为 \u003ccode\u003eDockerfile\u003c/code\u003e 所在目录的相对路径，文件或者目录）为容器中的 \u003ccode\u003e\u0026lt;dest\u0026gt;\u003c/code\u003e。目标路径不存在时，会自动创建。\u003c/p\u003e\n\u003cp\u003e当使用本地目录为源目录时，推荐使用 \u003ccode\u003eCOPY\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"add\"\u003eADD\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eADD \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003esrc\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edest\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e复制指定的 \u003ccode\u003e\u0026lt;src\u0026gt;\u003c/code\u003e 到容器中的 \u003ccode\u003e\u0026lt;dest\u0026gt;\u003c/code\u003e，其中 \u003ccode\u003e\u0026lt;src\u0026gt;\u003c/code\u003e 可以是 \u003ccode\u003eDockerfile\u003c/code\u003e所在目录的一个相对路径（文件或目录）；\u003c/p\u003e\n\u003cp\u003e也可以是一个 \u003ccode\u003eURL\u003c/code\u003e，还可以是一个 \u003ccode\u003etar\u003c/code\u003e 文件（自动解压为目录）。\u003c/p\u003e\n\u003ch4 id=\"entrypoint\"\u003eENTRYPOINT\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eENTRYPOINT [\u0026#34;executable\u0026#34;, \u0026#34;param1\u0026#34;, \u0026#34;param2\u0026#34;]\n或\nENTRYPOINT command param1 param2 \u003cspan class=\"ni\"\u003e#在Shell中执行\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e配置容器启动后执行的命令，并且不可被 \u003ccode\u003edocker run\u003c/code\u003e 提供的参数覆盖\u003c/p\u003e\n\u003cp\u003e每个 \u003ccode\u003eDockerfile\u003c/code\u003e 中只能有一个 \u003ccode\u003eENTRYPOINT\u003c/code\u003e，当指定多个 \u003ccode\u003eENTRYPOINT\u003c/code\u003e 时，只有最后一个生效。\u003c/p\u003e\n\u003ch4 id=\"volume\"\u003eVOLUME\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eVOLUME [\u0026#34;/data\u0026#34;]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e创建一个可以从本地主机或其他容器挂载的挂载点，一般用来存放数据库和需要保持的数据等。\u003c/p\u003e\n\u003ch4 id=\"user\"\u003eUSER\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eUSER daemon\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e指定运行容器时的用户名或 \u003ccode\u003eUID\u003c/code\u003e，后续的RUN也会使用指定用户。\u003c/p\u003e\n\u003cp\u003e当服务不需要管理员权限时，可以通过该命令指定运行用户。并且可以在之前创建所需要的用户，例如 \u003ccode\u003eRUN groupadd -r postgres \u0026amp;\u0026amp; useradd -r -g postgres postgres\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e要临时获取管理员权限，可以使用 \u003ccode\u003egosu\u003c/code\u003e，而不推荐使用 \u003ccode\u003esudo\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"workdir\"\u003eWORKDIR\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eWORKDIR /path/to/workdir\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e为后续的 \u003ccode\u003eRUN\u003c/code\u003e，\u003ccode\u003eCMD\u003c/code\u003e，\u003ccode\u003eENTRYPOINT\u003c/code\u003e 指令配置工作目录\u003c/p\u003e\n\u003cp\u003e可以使用多个 \u003ccode\u003eWORKDIR\u003c/code\u003e 指令，后续命令如果参数是相对路径，则会基于之前命令指定的路径。例如：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eWORKDIR /a\nWORKDIR b\nWORKDIR c\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e则最终路径为：\u003ccode\u003e/a/b/c\u003c/code\u003e\u003c/p\u003e\n\u003ch4 id=\"onbuild\"\u003eONBUILD\u003c/h4\u003e\n\u003cp\u003e格式为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eONBUILD [INSTRUCTION]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e配置当所创建的镜像作为其他新创建镜像的基础镜像时，所执行的操作指令。\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003eONBUILD\u003c/code\u003e 指令的镜像，推荐在标签中注明，例如 \u003ccode\u003eruby:1.9-onbuild\u003c/code\u003e。\u003c/p\u003e\n\u003ch3 id=\"主要指令\"\u003e主要指令\u003c/h3\u003e\n\u003ch4 id=\"add-和-copy\"\u003eADD 和 COPY\u003c/h4\u003e\n\u003cp\u003eADD：将主机上的文件复制到或者将网络上的文件下载到容器中的指定目录。\u003c/p\u003e\n\u003cp\u003eCOPY： 将本地目录中的文件复制到容器内的指定目录下面，从而在镜像中增加一个层。在未指定绝对路径的时候，会放到 WORKDIR 目录下面。\u003c/p\u003e\n\u003cp\u003eADD 和 COPY 之间的区别：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eADD 多了两个功能，下载 URL 和对支持的压缩格式的包进行解压，其他都一样。比如，\u003ccode\u003eADD http://foo.com/bar.go /tmp/main.go\u003c/code\u003e 会将文件从互联网上下载下来；\u003ccode\u003eADD /foo.tar.gz /tmp/\u003c/code\u003e 会将压缩文件解压再 COPY 过去。\u003c/li\u003e\n\u003cli\u003e如果不希望压缩文件复制到容器中后解压的话，那么使用 COPY。\u003c/li\u003e\n\u003cli\u003e如果需要自动下载 URL 并复制到容器的话，那么使用 ADD。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"expose-和-docker-run--p-之间的关系\"\u003eEXPOSE 和 docker run -p 之间的关系\u003c/h4\u003e\n\u003cp\u003e容器的端口必须被发布（publish）出来后才能被外界使用，Dockerfile 中的 EXPOSE 只是 \u003ccode\u003e标记\u003c/code\u003e 某个端口会被暴露出来，只有在使用了 \u003ccode\u003edocker run -p\u003c/code\u003e 或者 \u003ccode\u003edocker run -P\u003c/code\u003e 后，端口才会被 \u003ccode\u003e发布\u003c/code\u003e 出来，此时端口才能被使用。\u003c/p\u003e\n\u003cp\u003e在 Dockerfile 中没有指定 EXPOSE port 时，\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003e-P\u003c/code\u003e 参数，执行 \u003ccode\u003edocker run -d --name no-exposed-port-xdhuxc -P xdhuxc:latest\u003c/code\u003e，此时没有任何端口被发布，说明 docker 在使用了 \u003ccode\u003e-P\u003c/code\u003e 参数的情形下只是自动将 EXPOSE 的端口发布出来。\u003c/p\u003e\n\u003cp\u003e使用 \u003ccode\u003e-p\u003c/code\u003e 加上一个不存在的端口，执行 \u003ccode\u003edocker run -d --name no-exposed-port-xdhuxc -p 8888:9999 xdhuxc:latest\u003c/code\u003e，此时，9999 端口会被暴露，但是没法使用，说明 \u003ccode\u003e-p\u003c/code\u003e 会将没有暴露的端口自动暴露出来。\u003c/p\u003e\n\u003cp\u003e由此可见，\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eEXPOSE\u003c/code\u003e 或者 \u003ccode\u003e--expose\u003c/code\u003e 只是为其他命令提供所需信息的元数据，或者只是告诉容器操作人员有哪些已知选择，只是作为记录机制，也就是告诉用户哪些端口会提供服务。它保存在容器的元数据中。\u003c/li\u003e\n\u003cli\u003e使用 \u003ccode\u003e-p\u003c/code\u003e 发布特定端口，如果该端口已经被暴露出来，则发布它；如果它还没有被暴露，则它会被暴露和发布。docker 不会检查容器端口的正确性。\u003c/li\u003e\n\u003cli\u003e使用 \u003ccode\u003e-P\u003c/code\u003e 时，docker 会自动将所有已经被暴露的端口发布出来。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"cmd-和-entrypoint\"\u003eCMD 和 ENTRYPOINT\u003c/h4\u003e\n\u003cp\u003e这两个指令都指定了运行容器时所执行的命令。以下是它们共存的一些规则：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDockerfile 至少需要指定一个 CMD 或者 ENTRYPOINT 指令。\u003c/li\u003e\n\u003cli\u003eCMD 可以用来指定 ENTRYPOINT 指令的参数\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e以下是两者共存时，实际执行命令的格式\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eCMD/ENTRYPOINT\u003c/th\u003e\n\u003cth\u003e没有 ENTRYPOINT\u003c/th\u003e\n\u003cth\u003eENTRYPOINT entry_exec entry_p1\u003c/th\u003e\n\u003cth\u003eENTRYPOINT [\u0026quot;entry_exec\u0026quot;, \u0026quot;entry_p1\u0026quot;]\u003c/th\u003e\n\u003cth\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e没有 CMD\u003c/td\u003e\n\u003ctd\u003e错误，不允许\u003c/td\u003e\n\u003ctd\u003e/bin/sh -c entry_exec entry_p1\u003c/td\u003e\n\u003ctd\u003eentry_exec entry_p1\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCMD [\u0026quot;cmd_exec\u0026quot;, \u0026quot;cmd_p1\u0026quot;]\u003c/td\u003e\n\u003ctd\u003ecmd_exec cmd_p1\u003c/td\u003e\n\u003ctd\u003e/bin/sh -c entry_exec entry_p1 cmd_exec cmd_p1\u003c/td\u003e\n\u003ctd\u003eentry_exec entry_p1 cmd_exec cmd_p1\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCMD [\u0026quot;cmd_p1\u0026quot;, \u0026quot;cmd_p2\u0026quot;]\u003c/td\u003e\n\u003ctd\u003ecmd_p1 cmd_p2\u003c/td\u003e\n\u003ctd\u003e/bin/sh -c entry_exec entry_p1 cmd_p1 cmd_p2\u003c/td\u003e\n\u003ctd\u003eentry_exec entry_p1 cmd_p1 cmd_p2\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCMD cmd_exec cmd_p1\u003c/td\u003e\n\u003ctd\u003e/bin/sh -c cmd_exec cmd_p1\u003c/td\u003e\n\u003ctd\u003e/bin/sh -c entry_exec entry_p1 cmd_exec cmd_p1\u003c/td\u003e\n\u003ctd\u003eentry_exec entry_p1 cmd_exec cmd_p1\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e备注\u003c/td\u003e\n\u003ctd\u003e只有 CMD 时，执行 CMD 定义的指令\u003c/td\u003e\n\u003ctd\u003eCMD 和 ENTRYPOINT 都存在时，CMD 的指令作为 ENTRYPOINT 的参数。\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"构建-docker-镜像应该遵循的原则\"\u003e构建 Docker 镜像应该遵循的原则\u003c/h3\u003e\n\u003cp\u003e整体原则上，尽量保持镜像功能的明确和内容的精简\u003c/p\u003e\n\u003cp\u003e要点包括：\u003c/p\u003e\n\u003cp\u003e1、尽量选取满足需求但较小的基础系统镜像；\u003c/p\u003e\n\u003cp\u003e2、清理编译生成文件、安装包的缓存等临时文件；\u003c/p\u003e\n\u003cp\u003e3、安装各个软件的时候要指定准确的版本号，并避免引入不需要的依赖；\u003c/p\u003e\n\u003cp\u003e4、从安全角度考虑，应用要尽量使用系统的库和依赖；\u003c/p\u003e\n\u003cp\u003e5、如果安装应用时需要配置一些特殊的环境变量，在安装后要还原不需要保持的变量值；\u003c/p\u003e\n\u003cp\u003e6、使用 \u003ccode\u003eDockerfile\u003c/code\u003e 创建镜像时，要添加 \u003ccode\u003e.dockerignore\u003c/code\u003e 文件或使用空的工作目录；\u003c/p\u003e\n\u003ch3 id=\"使用容器时需要避免的一些做法\"\u003e使用容器时需要避免的一些做法\u003c/h3\u003e\n\u003cp\u003e1、不要在容器中保存数据。\u003c/p\u003e\n\u003cp\u003e2、将应用打包到镜像再部署，而不是更新到已有容器。\u003c/p\u003e\n\u003cp\u003e3、不要产生过大的镜像。\u003c/p\u003e\n\u003cp\u003e4、不要使用单层镜像。\u003c/p\u003e\n\u003cp\u003e5、不要从运行着的容器上产生镜像。\u003c/p\u003e\n\u003cp\u003e6、不要只是使用 \u003ccode\u003elatest\u003c/code\u003e 标签。\u003c/p\u003e\n\u003cp\u003e7、不要在容器内运行超过一个的进程。\u003c/p\u003e\n\u003cp\u003e8、不要在容器内保存 \u003ccode\u003ecredentials\u003c/code\u003e，而是要从外部通过环境变量传入。\u003c/p\u003e\n\u003cp\u003e9、不要使用 \u003ccode\u003eroot\u003c/code\u003e 用户运行容器进程。\u003c/p\u003e\n\u003cp\u003e10、不要依赖于 IP 地址，而是要从外部通过环境变量传入。\u003c/p\u003e","date":1503360000,"description":"","fuzzywordcount":2900,"kind":"page","lang":"zh","lastmod":1503360000,"objectID":"e67b3abf9918d9b189fc979f86efb1d0","publishdate":1503360000,"relpermalink":"/posts/docker/docker-dockerfile/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 \u003ccode\u003eDockerfile\u003c/code\u003e 各种命令的使用方法，对于构建 \u003ccode\u003edocker\u003c/code\u003e 镜像及运行 \u003ccode\u003eDocker\u003c/code\u003e 容器都是不可不知的。\u003c/p\u003e","tags":["Docker","Dockerfile"],"title":"Dockerfile 知识点总结","url":"https://xdhuxc.github.io/posts/docker/docker-dockerfile/","wordcount":2811},{"categories":"posts","content":"\u003cp\u003e本篇博客记录了在使用 docker 的过程中经常使用的一些命令。\u003c/p\u003e\n\u003ch2 id=\"docker-信息\"\u003eDocker 信息\u003c/h2\u003e\n\u003cp\u003e1、显示 docker 版本信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker version\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、显示 docker 系统信息，包括镜像和容器数\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker info\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"容器生命周期管理\"\u003e容器生命周期管理\u003c/h2\u003e\n\u003ch3 id=\"run\"\u003erun\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker run 用于创建一个新的容器并运行一个命令\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run [options] image [command] [args...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-a stdin: 指定标准输入输出内容类型，可选 STDIN/STDOUT/STDERR 三项；\n-d：后台运行容器，并返回容器ID；\n-i：以交互模式运行容器，通常与 -t 同时使用；\n-t：为容器重新分配一个伪输入终端，通常与 -i 同时使用；\n--name=\u0026quot;abc\u0026quot;：为容器指定一个名称；\n--dns 8.8.8.8：指定容器使用的DNS服务器，默认和宿主机一致；\n--dns-search example.com：指定容器DNS搜索域名，默认和宿主机一致；\n-h,--hostname=\u0026quot;host_name\u0026quot;：指定容器的主机名为host_name；\n-e username=\u0026quot;xdhuxc\u0026quot;：设置环境变量；\n--env-file=[]：从指定文件读入环境变量；\n--cpuset=\u0026quot;0-2\u0026quot; 或 --cpuset=\u0026quot;0,1,2\u0026quot;：绑定容器到指定CPU运行；\n-m：设置容器使用内存最大值；\n--net=\u0026quot;bridge\u0026quot;：指定容器的网络连接类型，支持 bridge、host、none、container 四种类型；\n--net=bridge：默认值，在Docker网桥上为容器创建新的网络栈；\n--net=host：让Docker不要将容器网络放到隔离的命名空间中，即不要容器化容器内的网络。此时容器使用本地主机的网络，它拥有完全的本地主机接口访问权限。容器进程可以跟主机其他root进程一样打开低范围的端口，可以访问本地网络服务，还可以让容器做一些影响整个主机系统的事情，比如重启主机。因此，使用这个选项的时候要非常小心。如果进一步使用--privileged=true参数，容器甚至会被允许直接配置主机的网络堆栈；\n--net=container：让Docker将新建容器的进程放到一个已存在容器的网络栈中，新容器进程有自己的文件系统、进程列表和资源限制，但会和已存在的容器共享IP地址和端口等网络资源，两者进程可以直接通过lo环回接口通信；\n--net=none：让Docker将新容器放到隔离的网络栈中，但是不进行网络配置。之后，用户可以自己进行配置；\n--link=[]：添加链接到另一个容器；\n--expose=[]：开放一个端口或一组端口；\n-v host_folder:container_folder：将主机目录挂载到容器目录；\n--rm：在容器运行结束时自动清理其所产生的数据；\n-w,--workdir=\u0026quot;\u0026quot;：指定容器的工作目录；\n--privileged=true：使用该参数，容器内的root用户才能拥有真正的root权限；否则，容器内的root用户只具有外部的一个普通用户权限；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、使用docker镜像nginx:latest以后台模式启动一个容器,并将容器命名为xyz_nginx。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run --name xyz_nginx -d nginx:latest \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、使用镜像 nginx:latest 以后台模式启动一个容器,并将容器的80端口映射到主机随机端口。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run -P -d nginx:latest \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、使用镜像 nginx:latest 以后台模式启动一个容器,将容器的80端口映射到主机的80端口,主机的目录 /data/xdhuxc映射到容器的 /data。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run -p 80:80 -v /data/xdhuxc:/data -d nginx:latest  \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e4、使用镜像nginx:latest以交互模式启动一个容器,在容器内执行/bin/bash命令\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run -it nginx:latest /bin/bash \n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"startstoprestart\"\u003estart/stop/restart\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker start 用于启动一个或多个已经被停止的容器\ndocker stop 用于停止一个或多个运行中的容器\ndocker restart 用于重启一个或多个停止的容器\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch5 id=\"语法-1\"\u003e语法\u003c/h5\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker start [options] container [container...]\n\ndocker stop [options] container [container...]\n\ndocker restart [options] container [container...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch5 id=\"示例-1\"\u003e示例\u003c/h5\u003e\n\u003cp\u003e1、启动已被停止的容器\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker start xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、停止运行中的容器xdhuxc\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker stop xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、重启容器myrunoob\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker restart xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"kill\"\u003ekill\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker kill 用于杀死一个运行中的容器\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-2\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker kill [options] container [container...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-1\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-s：向容器发送一个信号\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-2\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、杀掉运行中的容器xdhuxc\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker kill -s KILL xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"rm\"\u003erm\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker rm 用于删除一个或多个容器\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-3\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker rm [options] container [container...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-2\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-f：通过SIGKILL信号强制删除一个运行中的容器；\n-l：移除容器间的网络连接，而非容器本身；\n-v：删除与容器关联的卷；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-3\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、强制删除容器xdhuxc_1、xdhuxc_2\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker rm -f xdhuxc_1 xdhuxc_2\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、移除容器nginx_1对容器xdhuxc_1的连接，连接名为：nginx_xdhuxc\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker rm -l nginx_xdhuxc \n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、删除容器xdhuxc，并删除容器挂载的数据卷\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker rm -v xdhuxc\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"pauseunpause\"\u003epause/unpause\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker pause 命令用于暂停容器中的所有进程\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker unpause命令用于恢复容器中的所有进程\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-4\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker pause [options] container [container...]\ndocker unpause [options] container [container...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-4\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、暂停数据库容器db_one提供的服务\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker pause db_one\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、恢复数据库容器db_one提供的服务\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker unpause db_one \n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"create\"\u003ecreate\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker create 命令用于创建一个新的容器但不启动它\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-5\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker create [options] image [command] [args...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-5\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、使用镜像nginx:latest创建一个容器,并将容器命名为xnginx\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker create --name=xnginx nginx:latest\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"exec\"\u003eexec\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker exec 命令用于在运行的容器中执行命令\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-6\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker exec [options] container command [arg...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-3\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-d：分离模式，即在后台运行；\n-i：交互式模式，即使没有附加也保持标准输出打开；\n-t：分配一个伪终端；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-6\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、在容器xnginx中以交互模式执行容器内/root/startup.sh脚本\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker exec -it xnginx /bin/sh /root/startup.sh\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、在容器xnginx中开启一个交互模式的终端\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker exec -i -t xnginx /bin/bash\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"容器操作\"\u003e容器操作\u003c/h2\u003e\n\u003ch3 id=\"ps\"\u003eps\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker ps 命令用于显示容器\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-7\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker ps [options]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-4\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-a：显示所有容器，包括未运行的容器；\n-f：根据条件过滤显示的内容；\n--format：指定返回值的模板文件；\n-l：显示最近创建的容器；\n-n：列出最近创建的n个容器；\n--no-trunc：不截断输出；\n-q：静默模式，只显示容器编号；\n-s：显示总的文件大小；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-7\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、列出所有正在运行的容器的信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker ps\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、列出最近创建的5个容器的信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker ps -n 5\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、列出所有创建的容器ID\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker ps -a -q\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"inspect\"\u003einspect\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker inspect 命令用于获取容器或镜像的元数据\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-8\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker inspect [options] name|id [name|id...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-5\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-f：指定返回值的模板文件；\n-s：显示总的文件大小；\n--type：为指定类型返回JSON；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-8\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、获取镜像mysql:5.7的元数据信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker inspect mysql:5.6\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、获取正在运行的容器mysql的IP地址\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker inspect --format='{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' mysql\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"top\"\u003etop\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker top 命令用于查看容器中运行的进程信息，支持ps命令参数。容器运行时不一定有/bin/bash终端来交互执行top命令，而且容器还不一定有top命令，可以使用docker top来实现查看container中正在运行的进程。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-9\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker top [options] container [ps options]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-9\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、查看容器mysql的进程信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker top mysql\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、查看所有运行中容器的进程信息\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003efor i in  `docker ps |grep Up|awk '{print $1}'`;do echo \\ \u0026amp;\u0026amp; docker top $i; done\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"attach\"\u003eattach\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker attach 命令用于连接到正在运行中的容器\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-10\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker attach [options] container\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e要attach上去的容器必须正在运行，可以同时连接上同一个容器来共享屏幕。\nattach后可以通过CTRL-C来detach，但实际上，如果容器当前在运行bash，CTRL-C自然是当前行的输入，没有退出；如果容器当前正在前台运行进程，如输出nginx的access.log日志，CTRL-C不仅会导致退出容器，而且还停止了。这不是我们想要的，detach的意思按理应该是脱离容器终端，但容器依然运行。好在attach是可以带上--sig-proxy=false来确保CTRL-D或CTRL-C不会关闭容器。\u003c/p\u003e\n\u003ch4 id=\"示例-10\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、容器nginx将访问日志定向到标准输出，连接到容器查看访问信息。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker attach --sig-proxy=false nginx\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"events\"\u003eevents\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker events 命令用于从服务器获取实时事件\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-11\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker events [options]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-6\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-f：根据条件过滤事件；\n--since：从指定的时间戳后显示所有事件；\n--until：流水时间显示到指定的时间为止；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-11\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、显示 docker 2016年7月1日后的所有事件。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker events --since=\u0026quot;1467302400\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、显示 docker 镜像为mysql:5.7 2016年7月1日后的相关事件\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker events -f \u0026quot;image\u0026quot;=\u0026quot;mysql:5.7\u0026quot; --since=\u0026quot;1467302400\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e如果指定的时间是到秒级的，需要将时间转成时间戳。如果时间为日期的话，可以直接使用，如--since=\u0026quot;2016-07-01\u0026quot;。\u003c/p\u003e\n\u003ch3 id=\"logs\"\u003elogs\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker logs用于获取容器的日志\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-12\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker logs [options] container\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-7\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-f：跟踪日志输出；\n--since：显示某个开始时间的所有日志；\n-t：显示时间戳；\n--tail：仅列出最新N条容器日志；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-12\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、跟踪查看容器nginx的日志输出\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker logs -f nginx\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、查看容器nginx从2016年07月01日后的最新10条日志\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker logs --since=\u0026quot;2016-07-01\u0026quot; --tail=10 nginx\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"wait\"\u003ewait\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker wait 命令用于阻塞运行直到容器停止，然后打印出它的退出代码\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-13\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker wait [options] container [container...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-13\"\u003e示例\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker wait container\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"export\"\u003eexport\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker export 命令用于将文件系统作为一个tar归档文件导出到STDOUT\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-14\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker export [options] container\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-8\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-o：将输入内容写到文件\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-14\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、将ID为a404c6c174a2的容器按日期保存为tar文件。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker export -o mysql-`date +%Y%m%d`.tar a404c6c174a2\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"port\"\u003eport\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker port 命令用于列出指定的容器的端口映射，或者查找将PRIVATE_PORT NAT到面向公众的端口\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-15\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker port [options] container [private_port[/proto]]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-15\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、查看容器nginx的端口映射情况\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker port nginx\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"容器-rootfs-命令\"\u003e容器 rootfs 命令\u003c/h2\u003e\n\u003ch3 id=\"commit\"\u003ecommit\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker commit命令用于从容器创建一个新的镜像\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-16\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker commit [options] container [repository][:tag]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-9\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-a：提交的镜像作者；\n-c：使用Dockerfile指令来创建镜像；\n-m：提交时的说明文字；\n-p：在commit时，将容器暂停；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-16\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、将容器a404c6c174a2 保存为新的镜像，并添加提交人信息和说明信息。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker commit -a \u0026quot;xdhuxc\u0026quot; -m \u0026quot;x-mysql\u0026quot; a404c6c174a2  xmysql:1.0.0 \n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"cp\"\u003ecp\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker cp 命令用于容器与主机之间的数据复制\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-17\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker cp [options] container:src_path dest_path|-\ndocker cp [options] src_path|- container:dest_path\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-10\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-L：保持源目标中的链接\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-17\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、将主机/www/run目录复制到容器96f7f14e99ab的/www目录下。\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker cp /www/run 96f7f14e99ab:/www/\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、将主机/www/run目录复制到容器96f7f14e99ab中，目录重命名为www\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker cp /www/run 96f7f14e99ab:/www\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、将容器96f7f14e99ab的/www目录复制到主机的/tmp目录中\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker cp 96f7f14e99ab:/www /tmp/\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"diff\"\u003ediff\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker diff 命令用于检查容器里文件结构的更改\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-18\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker diff [options] container\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-18\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、查看容器mysql的文件结构更改\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker diff mysql\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"镜像仓库\"\u003e镜像仓库\u003c/h2\u003e\n\u003ch3 id=\"login\"\u003elogin\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker login 命令用于登陆到一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker logout 命令用于退出一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-19\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker login [options] [server]\ndocker logout [options] [server]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-11\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-u：登陆的用户名；\n-p：登陆的密码；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-19\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、登陆到Docker Hub\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker login -u username -p password\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、退出Docker Hub\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker logout\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"pull\"\u003epull\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker pull 命令用于从镜像仓库中拉取或者更新指定镜像\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-20\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker pull [options] name[:tag|@DIGEST]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-12\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-a：拉取所有 tagged 镜像；\n--disable-content-trust：忽略镜像的校验,默认开启；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-20\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、从 Docker Hub 下载java最新版镜像\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker pull java\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、从 Docker Hub 下载 REPOSITORY 为 java 的所有镜像\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker pull -a java\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"push\"\u003epush\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker push 命令用于将本地的镜像上传到镜像仓库，要先登陆到镜像仓库\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-21\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker push [options] name[:tag]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-13\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e--disable-content-trust：忽略镜像的校验,默认开启\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-21\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、上传本地镜像apache:latest到镜像仓库中\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker push apache:latest\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"search\"\u003esearch\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker search 命令用于从 Docker Hub 中查找镜像\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-22\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker search [options] term\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-14\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e--automated：只列出 automated build类型的镜像；\n--no-trunc：显示完整的镜像描述；\n-s：列出收藏数不小于指定值的镜像；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-22\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、从 Docker Hub 上查找所有镜像名中包含java，并且收藏数大于10的镜像\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker search -s 10 java\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"本地镜像管理\"\u003e本地镜像管理\u003c/h2\u003e\n\u003ch3 id=\"images\"\u003eimages\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker images 命令用于列出本地镜像\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-23\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker images [options] [repository[:tag]]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-15\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-a：列出本地所有的镜像（含中间映像层，默认情况下，过滤掉中间映像层）；\n--digests：显示镜像的摘要信息；\n-f：显示满足条件的镜像；\n--format：指定返回值的模板文件；\n--no-trunc：显示完整的镜像信息；\n-q：只显示镜像ID；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-23\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、查看本地镜像列表\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker images\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e2、列出本地镜像中 REPOSITORY 为 ubuntu 的镜像列表\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker images ubuntu\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"rmi\"\u003ermi\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker rmi 命令用于删除本地一个或多个镜像\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-24\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker rmi [options] image [image...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-16\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-f：强制删除；\n--no-prune：不移除该镜像的过程镜像，默认移除；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-24\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、强制删除本地镜像 \u003ccode\u003enginx:latest\u003c/code\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker rmi -f nginx:latest\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"tag\"\u003etag\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker tag命令用于标记本地镜像，将其归入某一仓库\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-25\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker tag [options] image[:tag] [registry host/][username/]name[:tag]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-25\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、将镜像 \u003ccode\u003eubuntu:15.10\u003c/code\u003e 标记为 \u003ccode\u003exdhuxc/ubuntu:v3\u003c/code\u003e 镜像\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker tag ubuntu:15.10 xdhuxc/ubuntu:v3\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"build\"\u003ebuild\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker build 命令用于使用Dockerfile创建镜像\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-26\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker build [options] path|url|-\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-17\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e--build-arg=[]：设置镜像创建时的变量；\n--cpu-shares：设置 cpu 使用权重；\n--cpu-period：限制 CPU CFS周期；\n--cpu-quota：限制 CPU CFS配额；\n--cpuset-cpus：指定使用的CPU id；\n--cpuset-mems：指定使用的内存 id；\n--disable-content-trust：忽略校验，默认开启；\n-f：指定要使用的Dockerfile路径；\n--force-rm：设置镜像过程中删除中间容器；\n--isolation：使用容器隔离技术；\n--label=[]：设置镜像使用的元数据；\n-m :设置内存最大值；\n--memory-swap：设置Swap的最大值为内存+swap，\u0026quot;-1\u0026quot;表示不限swap；\n--no-cache：创建镜像的过程不使用缓存；\n--pull：尝试去更新镜像的新版本；\n-q：静默模式，成功后只输出镜像ID；\n--rm：设置镜像成功后删除中间容器；\n--shm-size：设置/dev/shm的大小，默认值是64M；\n--ulimit：Ulimit配置。\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-26\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、使用当前目录的 \u003ccode\u003eDockerfile\u003c/code\u003e 创建镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker build -t xdhuxc/mysql:5.7 .\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、使用 URL \u003ccode\u003egithub.com/creack/docker-firefox\u003c/code\u003e 的 \u003ccode\u003eDockerfile\u003c/code\u003e 创建镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker build github.com/creack/docker-firefox\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、指定 dockerfile 构建镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker build -t xdhuxc/go-build:v1.13.11 -f Dockerfile-local .\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"history\"\u003ehistory\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker history 命令用于查看指：定镜像的创建历史\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-27\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker history [options] image\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-18\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-H：以可读的格式打印镜像大小和日期，默认为true；\n--no-trunc：显示完整的提交记录；\n-q：仅列出提交记录ID；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-27\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、查看本地镜像 \u003ccode\u003exdhuxc/mysql:5.7\u003c/code\u003e 的创建历史\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker history xdhuxc/mysql:5.7\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"save\"\u003esave\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker save 命令用于将指定的镜像保存成tar归档文件\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-28\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker save [options] image [image...]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-19\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-o：输出到的文件\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-28\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、将镜像 \u003ccode\u003exdhuxc/mysql:5.7\u003c/code\u003e 保存为 \u003ccode\u003emysql.tar\u003c/code\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker save xdhuxc/mysql:5.7 -o mysql.tar\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"import\"\u003eimport\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003edocker import 命令用于从归档文件中创建镜像\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"语法-29\"\u003e语法\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker import [options] file|URL|- [repository[:tag]]\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"选项说明-20\"\u003e选项说明\u003c/h4\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e-c：应用 docker 指令创建镜像；\n-m：提交时的说明文字；\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"示例-29\"\u003e示例\u003c/h4\u003e\n\u003cp\u003e1、从镜像归档文件 \u003ccode\u003emysql.tar\u003c/code\u003e 创建镜像，命名为 \u003ccode\u003exdhuxc/mysql:5.7\u003c/code\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker import mysql.tar xdhuxc/mysql:5.7\n\u003c/code\u003e\u003c/pre\u003e","date":1503100800,"description":"","fuzzywordcount":5600,"kind":"page","lang":"zh","lastmod":1503100800,"objectID":"1fd2af4a42d8d924f9ed456b89201622","publishdate":1503100800,"relpermalink":"/posts/docker/docker-common-command/","section":"posts","summary":"\u003cp\u003e本篇博客记录了在使用 docker 的过程中经常使用的一些命令。\u003c/p\u003e","tags":["Docker"],"title":"Docker 常用命令","url":"https://xdhuxc.github.io/posts/docker/docker-common-command/","wordcount":5531},{"categories":"posts","content":"\u003cp\u003e本篇博客整理了一些 Linux 系统中的实用命令，包括一些组合命令，可以直接修改使用。\u003c/p\u003e\n\u003ch3 id=\"杀死某个进程\"\u003e杀死某个进程\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ekill -9 $(ps -ef | grep -v grep | grep nginx | awk \u0026#39;{print $2}\u0026#39;)\n或\nps -ef|grep nginx|grep -v grep|awk \u0026#39;{print $2}\u0026#39;|xargs kill             # 杀死所有Nginx相关进程\n或\nkill -9 $(netstat -tlnup | grep 80 | awk -F \u0026#39; \u0026#39; \u0026#39;{print $7}\u0026#39; | cut -d / -f1) # 杀死占用某个端口的命令\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"查找占用某端口的进程\"\u003e查找占用某端口的进程\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003enetstat -tlnup|grep 35888|awk -F \u0026#39; \u0026#39; \u0026#39;{print $7}\u0026#39;|cut -d / -f2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"置空文件\"\u003e置空文件\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho \u0026#34;\u0026#34; \u0026gt; abc.txt # abc.txt 文件内部会有一个空行\n或\n: \u0026gt; abc.txt # abc.txt 文件内部没有空行\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"切换到-root-用户\"\u003e切换到 root 用户\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo su - # 由普通用户无密码切换到 root 用户\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"查看进程及其子进程\"\u003e查看进程及其子进程\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gh\"\u003e# -l：不截断输出，显示整个进程或线程的启动命令\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# 3376：要显示的进程 ID\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e# -a：显示命令行参数\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003epstree -a -l 3376\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"时间格式\"\u003e时间格式\u003c/h3\u003e\n\u003cp\u003e1）获得 \u003ccode\u003e2018-04-19\u003c/code\u003e 样式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edate +\u0026#34;%Y-%m-%d\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行效果如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# date +\u0026#34;%Y-%m-%d\u0026#34;\n2018-04-19\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）获得 \u003ccode\u003e20180419\u003c/code\u003e 样式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edate +\u0026#34;%Y%m%d\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行效果如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# date +\u0026#34;%Y-%m-%d\u0026#34;\n20180419\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）仅包含年月日的日期格式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edate +\u0026#34;%Y-%m-%d\u0026#34; \n或 \ndate -d today +\u0026#34;%Y-%m-%d\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行效果如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# date +\u0026#34;%Y-%m-%d\u0026#34;\n2018-04-19\n[root@localhost ~]# date -d today +\u0026#34;%Y-%m-%d\u0026#34;\n2018-04-19\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4）包含日期和时间的格式\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edate +\u0026#34;%Y-%m-%d %H:%M:%S\u0026#34; \n或 \ndate +\u0026#34;%Y-%m-%d %T\u0026#34;\n或\ndate -d today +\u0026#34;%Y-%m-%d %T\u0026#34; \n或\ndate -d today +\u0026#34;%Y-%m-%d %H:%M:%S\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e执行效果如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# date +\u0026#34;%Y-%m-%d %H:%M:%S\u0026#34;\n2018-04-19 11:39:47\n[root@localhost ~]# date +\u0026#34;%Y-%m-%d %T\u0026#34;\n2018-04-19 11:39:59\n[root@localhost ~]# date -d today +\u0026#34;%Y-%m-%d %T\u0026#34; \n2018-04-19 11:40:07\n[root@localhost ~]# date -d today +\u0026#34;%Y-%m-%d %H:%M:%S\u0026#34;\n2018-04-19 11:40:16\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"修改系统时区\"\u003e修改系统时区\u003c/h3\u003e\n\u003cp\u003e修改当前机器时间为北京时间：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改EDT时区为CST时区\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etimedatectl set-timezone Asia/Shanghai\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"获取-unix-时间戳\"\u003e获取 UNIX 时间戳\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edate +%s\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"删除文件和目录时不删除隐藏的文件和目录\"\u003e删除文件和目录时不删除隐藏的文件和目录\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003erm -r ./*\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e想删除隐藏的目录或文件，需要使用如下的命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003els -a | xargs rm -r \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e但是不能删除 \u003ccode\u003e.\u003c/code\u003e 和 \u003ccode\u003e..\u003c/code\u003e 目录，所以该命令的返回值为 \u003ccode\u003e1\u003c/code\u003e。\u003c/p\u003e\n\u003ch3 id=\"字符串替换\"\u003e字符串替换\u003c/h3\u003e\n\u003cp\u003e1）将当前目录下所有文件中的 \u003ccode\u003e127.0.0.1\u003c/code\u003e 修改为 \u003ccode\u003e172.20.15.29\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esed -i \u0026#34;s/127.0.0.1/172.20.15.29/g\u0026#34; ./*\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）将当前目录下所有文件中的 \u003ccode\u003e127.0.0.1\u003c/code\u003e 或 \u003ccode\u003elocalhost\u003c/code\u003e 修改为 \u003ccode\u003e172.20.15.29\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esed -i \u0026#34;s/\\(127.0.0.1\\|localhost\\)/172.20.15.29/g\u0026#34; ./*\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"按文件扩展名查找文件\"\u003e按文件扩展名查找文件\u003c/h3\u003e\n\u003cp\u003e查找当前目录下所有以 \u003ccode\u003e.sh\u003c/code\u003e，\u003ccode\u003e.service\u003c/code\u003e，\u003ccode\u003e.conf\u003c/code\u003e，\u003ccode\u003e.yaml\u003c/code\u003e 结尾的文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efind ./ -regex \u0026#39;.*\\.sh\\|.*\\.service\\|.*\\.conf\\|.*\\.yaml\u0026#39;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"jar-命令\"\u003ejar 命令\u003c/h3\u003e\n\u003cp\u003e1）将目录打包成war包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejar -cvfM0 abc.war */ . # java cvf 打包文件名称 要打包的目录 打包文件保存路径 \n-c：创建war包；\n-v：显示打包过程；\n-f：指定 JAR 文件名，通常这个参数是必须的；\n-M：不产生所有项的清单（MANIFEST〕文件，此参数会忽略 -m 参数；\n-0：阿拉伯数字0，表示只打包不压缩；\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）解压war包\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ejar -xvf abc.war # 解压war包\n或\nunzip abc.war -d abc/ \u003cspan class=\"ni\"\u003e#解压war包到指定的目录abc\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"关闭-selinux\"\u003e关闭 selinux\u003c/h3\u003e\n\u003cp\u003e到 \u003ccode\u003e/etc/sysconfig\u003c/code\u003e 目录下，修改 selinux 文件，设置 \u003ccode\u003eSELINUX=\u0026quot;enforcing\u0026quot;\u003c/code\u003e 为 \u003ccode\u003edisabled\u003c/code\u003e 并重启系统\u003c/p\u003e\n\u003cp\u003e使用命令 \u003ccode\u003esetenforce 0\u003c/code\u003e 临时关闭 SElinux\n使用命令 \u003ccode\u003egetenforce\u003c/code\u003e 或 \u003ccode\u003esestatus -v \u003c/code\u003e查看 SElinux 的状态\u003c/p\u003e\n\u003cp\u003e注意：\n\u003ccode\u003e/etc/sysconfig/selinux\u003c/code\u003e 文件链接到了文件\u003ccode\u003e/etc/selinux/config\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"firewalld-开放端口\"\u003efirewalld 开放端口\u003c/h3\u003e\n\u003cp\u003e使用如下命令开放端口：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003efirewall-cmd --zone=public --add-port=8004/tcp --permanent \n\u003cspan class=\"gh\"\u003e# --zone #作用域 --add-port=80/tcp  #添加端口，格式为：端口/通讯协议 --permanent  #永久生效，没有此参数重启后失效\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003efirewall-cmd --reload # 重启防火墙\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"查看指定进程的相关信息\"\u003e查看指定进程的相关信息\u003c/h3\u003e\n\u003cp\u003e1、查看如下文件中的内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@k8s-master ~]# cat /proc/4561/status\nName:\tjava\nUmask:\t0022\nState:\tS (sleeping)\nTgid:\t4561\nNgid:\t4561\nPid:\t4561\nPPid:\t1\nTracerPid:\t0\nUid:\t0\t0\t0\t0\nGid:\t0\t0\t0\t0\nFDSize:\t256\nGroups:\t0 \nVmPeak:\t19751020 kB\nVmSize:\t19751020 kB\nVmLck:\t       0 kB\nVmPin:\t       0 kB\nVmHWM:\t  207228 kB\nVmRSS:\t  207228 kB\nRssAnon:\t  192420 kB\nRssFile:\t   14808 kB\nRssShmem:\t       0 kB\nVmData:\t19575744 kB\nVmStk:\t     132 kB\nVmExe:\t       4 kB\nVmLib:\t   16344 kB\nVmPTE:\t    2336 kB\nVmSwap:\t       0 kB\nThreads:\t273\nSigQ:\t1/513396\nSigPnd:\t0000000000000000\nShdPnd:\t0000000000000000\nSigBlk:\t0000000000000000\nSigIgn:\t0000000000000003\nSigCgt:\t2000000181005ccc\nCapInh:\t0000000000000000\nCapPrm:\t0000001fffffffff\nCapEff:\t0000001fffffffff\nCapBnd:\t0000001fffffffff\nCapAmb:\t0000000000000000\nSeccomp:\t0\nCpus_allowed:\tff,ffffffff,ffffffff\nCpus_allowed_list:\t0-71\nMems_allowed:\t00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000003\nMems_allowed_list:\t0-1\nvoluntary_ctxt_switches:\t4\nnonvoluntary_ctxt_switches:\t3\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、使用如下命令查看\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eps -T -p 4561          # 2561 为进程 ID。\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1503014400,"description":"","fuzzywordcount":1300,"kind":"page","lang":"zh","lastmod":1503100800,"objectID":"3f87b7816c171ca6c89aa6561c22c0cf","publishdate":1503014400,"relpermalink":"/posts/linux/linux-practical-command/","section":"posts","summary":"\u003cp\u003e本篇博客整理了一些 Linux 系统中的实用命令，包括一些组合命令，可以直接修改使用。\u003c/p\u003e","tags":["Linux"],"title":"Linux 实用命令总结","url":"https://xdhuxc.github.io/posts/linux/linux-practical-command/","wordcount":1243},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Docker 的应用场景，优势及其相关的一些概念。\u003c/p\u003e\n\u003ch3 id=\"docker\"\u003eDocker\u003c/h3\u003e\n\u003cp\u003eDocker 是一个开源的应用容器引擎，基于 Go 语言 并遵从 Apache2.0 协议开源。 Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。 容器完全使用沙箱机制，相互之间不会有任何接口，更重要的是容器的性能开销极低。\u003c/p\u003e\n\u003ch3 id=\"docker-的应用场景\"\u003eDocker 的应用场景\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eWeb 应用的自动化打包和发布；\u003c/li\u003e\n\u003cli\u003e自动化测试和持续集成、发布；\u003c/li\u003e\n\u003cli\u003e在服务型环境中部署和调整数据库或其他的后台应用；\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"docker-的优势\"\u003eDocker 的优势\u003c/h3\u003e\n\u003cp\u003e1、更快速的交付和部署。使用Docker，开发人员可以使用镜像来快速构建一套标准的开发环境；开发完成后，测试和运维人员可以直接使用相同环境来部署代码。Docker可以快速创建和删除容器，实现快速迭代，大量节约开发、测试、部署的时间。\u003c/p\u003e\n\u003cp\u003e2、更高效的资源利用。Docker容器的运行不需要额外的虚拟化管理程序支持，它是内核级的虚拟化，可以实现更高的性能，同时对资源的额外需求很低。\u003c/p\u003e\n\u003cp\u003e3、更轻松的迁移和扩展。Docker容器几乎可以在任意的平台上运行，这种兼容性让用户可以在不同平台之间轻松地迁移应用。\u003c/p\u003e\n\u003cp\u003e4、更简单的更新管理。使用Dockerfile，只需要修改配置文件，就可以替代以往大量的更新工作。所有修改都以增量的方式进行分发和更新，从而实现自动化且高效的容器管理。\u003c/p\u003e\n\u003ch3 id=\"docker-的镜像容器和仓库\"\u003eDocker 的镜像、容器和仓库\u003c/h3\u003e\n\u003cp\u003e1、Docker的镜像概念类似于虚拟机里的镜像，是一个只读的模板，一个独立的文件系统，包括运行容器所需的数据，可以用来创建新的容器。\u003c/p\u003e\n\u003cp\u003e2、Docker容器是由Docker镜像创建的运行实例。Docker容器类似虚拟机，可以支持的操作包括启动、停止、删除等。每个容器间是相互隔离的，容器中会运行特定的应用，包含特定应用的代码及所需的依赖文件。\u003c/p\u003e\n\u003cp\u003e3、Docker 仓库是用来存储镜像的位置，Docker提供一个注册服务器（Register）来保存多个仓库，每个仓库又可以包含多个具备不同tag的镜像。Docker运行中使用的默认仓库是 Docker Hub 公共仓库。\u003c/p\u003e\n\u003ch3 id=\"docker-与虚拟机的比较\"\u003eDocker 与虚拟机的比较\u003c/h3\u003e\n\u003cp\u003e作为一种轻量级的虚拟化方式，Docker在运行应用上跟传统的虚拟机方式相比具有显著的优势：\u003c/p\u003e\n\u003cp\u003e1、Docker容器很快，启动和停止可以在秒级实现，这比传统的虚拟机方式要快得多；\u003c/p\u003e\n\u003cp\u003e2、Docker容器对系统资源需求很少，除了运行在其中的容器外，基本不消耗额外的系统资源，保证应用性能的同时，尽量减小系统开销，一台主机上可以同时运行数千个Docker容器；\u003c/p\u003e\n\u003cp\u003e3、Docker通过类似Git的操作来方便用户获取、分发和更新应用镜像，指令简明，学习成本较低；\u003c/p\u003e\n\u003cp\u003e4、Docker通过Dockerfile配置文件来支持灵活的自动化创建和部署机制，提高工作效率；\u003c/p\u003e\n\u003cp\u003e虚拟机是模拟运行的一整套操作系统（提供了运行时环境和其他系统环境）和运行在其上面的应用。\u003c/p\u003e\n\u003cp\u003eDocker 容器是独立运行的一个或一组应用，以及它们运行时所必需的环境。\u003c/p\u003e\n\u003cp\u003eDocker 技术与虚拟机技术的特性比较：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e特性\u003c/th\u003e\n\u003cth\u003e容器\u003c/th\u003e\n\u003cth\u003e虚拟机\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e启动速度\u003c/td\u003e\n\u003ctd\u003e秒级\u003c/td\u003e\n\u003ctd\u003e分钟级\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e硬盘使用\u003c/td\u003e\n\u003ctd\u003e一般为MB\u003c/td\u003e\n\u003ctd\u003e一般为GB\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e性能\u003c/td\u003e\n\u003ctd\u003e接近原生\u003c/td\u003e\n\u003ctd\u003e弱于\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e系统支持量\u003c/td\u003e\n\u003ctd\u003e单机支持上千个容器\u003c/td\u003e\n\u003ctd\u003e一般几十个\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e隔离性\u003c/td\u003e\n\u003ctd\u003e安全隔离\u003c/td\u003e\n\u003ctd\u003e完全隔离\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"对-docker-的理解\"\u003e对 docker 的理解\u003c/h3\u003e\n\u003cp\u003e从 Dockerfile 文件的内容，即系统所完成的操作来看，docker其实是在一个简化的极小版Linux操作系统中安装应用程序所需的环境，然后可以部署应用程序，与外部进行隔离，通过接口和网络与外部进行资源和信息交换。\u003c/p\u003e\n\u003cp\u003edocker = linux + 应用环境 + 应用程序\u003c/p\u003e","date":1500508800,"description":"","fuzzywordcount":1400,"kind":"page","lang":"zh","lastmod":1503619200,"objectID":"89ee974a203db67ed6a5ab4c0e66da9f","publishdate":1500508800,"relpermalink":"/posts/docker/docker-basic-knowledge/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Docker 的应用场景，优势及其相关的一些概念。\u003c/p\u003e","tags":["Docker"],"title":"docker 基础知识","url":"https://xdhuxc.github.io/posts/docker/docker-basic-knowledge/","wordcount":1373},{"categories":"posts","content":"\u003cp\u003e本篇博客介绍了 Docker 容器的一些基础知识和基本原理。\u003c/p\u003e\n\u003cp\u003e使用 docker 时，要求 Linux 内核版本必须是 3.10 及以上版本。\u003c/p\u003e\n\u003cp\u003edocker 容器的状态机：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/docker/basic-knowledge-two/docker-status.jpg\" width=\"800px\" height=\"300px\" /\u003e\n图1 · docker 容器的状态机\n\u003c/center\u003e\n\u003cp\u003e一个容器在某个时刻可能处于以下几种状态之一：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ecreated：已经被创建（使用 docker ps -a 命令可以查看），但是还没有启动（使用 docker ps 命令还无法查看）。\u003c/li\u003e\n\u003cli\u003erunning：运行中。\u003c/li\u003e\n\u003cli\u003epaused：容器的进程被暂停了。\u003c/li\u003e\n\u003cli\u003erestarting：容器的进程正在重启过程中。\u003c/li\u003e\n\u003cli\u003eexited：即 stopped 状态，表示容器之前运行过，但是现在处于停止状态，可以通过 start 命令使其重新进入 running 状态。区别于 created 状态，它是指一个新创建出来的尚未运行过的容器。\u003c/li\u003e\n\u003cli\u003edestroyed：容器被删除了，再也不存在了。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"docker-stop-和-docker-kill-命令的异同\"\u003edocker stop 和 docker kill 命令的异同\u003c/h3\u003e\n\u003ch4 id=\"docker-stop\"\u003edocker stop\u003c/h4\u003e\n\u003cp\u003e在 docker stop 命令执行的时候，会先向容器中 PID 为 1 的进程（systemd）发送系统信号 SIGTERM，然后等待容器中的应用程序终止执行。如果等待时间达到设定的超时时间（默认为：10 秒，用户可以指定特定的超时时长），会继续发送 SIGKILL 的系统信号强行 KILL 掉进程。在容器中的应用程序，可以选择忽略和不处理 SIGTERM 信号，不过一旦达到超时时间，程序就会被系统强行 kill 掉，因为 SIGKILL 信号是直接发往系统内核的，应用程序没有机会去处理它。\u003c/p\u003e\n\u003cp\u003e例如，运行 \u003ccode\u003edocker stop mysql -t 20\u003c/code\u003e 命令后：（使用 docker events 命令可以查看实时 docker 事件）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e2018-06-27T15:10:50.647582607+08:00 container kill 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (image=mysql:5.7.22, name=mysql, signal=15)\n2018-06-27T15:10:52.320188793+08:00 container die 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (exitCode=0, image=mysql:5.7.22, name=mysql)\n2018-06-27T15:10:52.456917929+08:00 network disconnect d007b6118f653475246dec898994a972d2f9a061d01ab5a339977cd70a6887bf (container=1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f, name=bridge, type=bridge)\n2018-06-27T15:10:52.524146055+08:00 volume unmount 845a3048d2138831a4e6e542dfd01794cb6524493839590a37f7936942890742 (container=1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f, driver=local)\n2018-06-27T15:10:52.537384805+08:00 container stop 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (image=mysql:5.7.22, name=mysql)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e能看到：\u003c/p\u003e\n\u003cp\u003e1、首先 docker 向容器发出 SIGTERM 信号（signal = 15）。\u003c/p\u003e\n\u003cp\u003e2、等待 20 秒（01:18 到 01:38）。\u003c/p\u003e\n\u003cp\u003e3、再发送 SIGKILL 系统信号（signal = 9）。\u003c/p\u003e\n\u003cp\u003e4、然后容器就被杀死了（die）。\u003c/p\u003e\n\u003ch4 id=\"docker-kill\"\u003edocker kill\u003c/h4\u003e\n\u003cp\u003e而 docker kill 命令会直接发出 SIGKILL 的系统信号，以强行终止容器中程序的运行。\u003c/p\u003e\n\u003cp\u003e运行 \u003ccode\u003edocker kill mysql\u003c/code\u003e 命令后：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e2018-06-27T15:22:41.785107639+08:00 container kill 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (image=mysql:5.7.22, name=mysql, signal=9)\n2018-06-27T15:22:42.003164753+08:00 container die 1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f (exitCode=137, image=mysql:5.7.22, name=mysql)\n2018-06-27T15:22:42.214308124+08:00 network disconnect d007b6118f653475246dec898994a972d2f9a061d01ab5a339977cd70a6887bf (container=1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f, name=bridge, type=bridge)\n2018-06-27T15:22:42.294946239+08:00 volume unmount 845a3048d2138831a4e6e542dfd01794cb6524493839590a37f7936942890742 (container=1cf29caed8786e1e165e5b3e3dadedf17d1846b40792e4330a6026ec03002a2f, driver=local)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可见直接发出的是 SIGKILL 信号，容器立刻就被杀掉了。\u003c/p\u003e\n\u003ch3 id=\"docker-平台的基本构成\"\u003edocker 平台的基本构成\u003c/h3\u003e\n\u003cp\u003eDocker 平台基本上由三部分组成：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e客户端：用户使用 docker 提供的工具（CLI 以及 API等）来构建、上传镜像并发布命令来创建和启动容器。\u003c/li\u003e\n\u003cli\u003edocker 主机：从 docker 镜像仓库拉取镜像并启动容器。\u003c/li\u003e\n\u003cli\u003edocker 镜像仓库：用于保存镜像，并提供镜像的上传和下载。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"docker-镜像\"\u003edocker 镜像\u003c/h3\u003e\n\u003cp\u003e在传统环境中，软件在运行之前需要经过 代码开发 -\u0026gt; 运行环境准备 -\u0026gt; 安装软件 -\u0026gt; 运行软件 等环节；\u003c/p\u003e\n\u003cp\u003e在容器环境中，中间的两个环节被镜像制作过程代替了，也就是说，镜像的制作过程也包括运行环境准备和安装软件等两个主要环节，以及一些其他环节。\u003c/p\u003e\n\u003cp\u003e镜像是动态的容器的静态表示，包括容器所要运行的应用代码以及运行时的配置。docker 镜像包括一个或多个只读层（read-only layers），因此，镜像一旦被创建就再也不能被修改了。一个运行着的 docker 容器是一个镜像的实例。从同一个镜像中运行的容器包含有相同的应用代码和运行时依赖。但是不像镜像是静态的，每个运行着的容器都有一个可写层（writable layer，也称为 container layer），位于底下的若干只读层之上，运行时的所有变化，包括对数据和文件的写和更新，都会保存在这个层中。因此，从同一个镜像运行的多个容器包含了不同的容器层。\u003c/p\u003e\n\u003cp\u003e创建一个 docker 镜像的两种方式：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e创建一个容器，运行若干命令，然后使用 docker commit 命令来生成一个新的镜像。不建议使用这种方式。\u003c/li\u003e\n\u003cli\u003e创建一个 Dockerfile，然后使用 docker build 命令来创建一个镜像。建议使用这种方式。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003edocker build 命令的过程：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e容器镜像包括元数据和文件系统，其中文件系统是指对基础镜像的文件系统的修改，元数据不影响文件系统，只是会影响容器的配置。\u003c/li\u003e\n\u003cli\u003e每个步骤都会生成一个新的镜像，新的镜像与上一次的镜像相比，要么元数据有了变化，要么文件系统有了变化，而多加了一层。\u003c/li\u003e\n\u003cli\u003edocker 在需要执行指令时，通过创建临时镜像，运行指定的命令，再通过 docker commit 来生成新的镜像。\u003c/li\u003e\n\u003cli\u003edocker 会将中间镜像都保存在缓存中，这样将来如果能直接使用的话，就不需要再从新创建了。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"镜像分层和容器层\"\u003e镜像分层和容器层\u003c/h4\u003e\n\u003cp\u003e一个 docker 镜像是基于基础镜像的多层叠加，最终构成了容器的 rootfs（根文件系统）。当 docker 创建了一个容器时，它会在基础镜像的容器层之上添加一层新的薄薄的可写容器层。接下来，所有对容器的变化，比如写新的文件，修改已有文件和删除文件，都只会作用在这个容器层之中。因此，通过不复制完整的 rootfs，docker 减少了容器所占用的空间，以及减少了容器启动所需时间。\u003c/p\u003e\n\u003ch4 id=\"cow-和镜像大小\"\u003eCOW 和镜像大小\u003c/h4\u003e\n\u003cp\u003eCOW，copy-on-write，写时复制技术，一方面带来了容器启动的快捷，另一方也造成了容器镜像大小的增加。每一次 \u003ccode\u003eRUN\u003c/code\u003e 命令都会在镜像上增加一层，每一层都会占用磁盘空间。\u003c/p\u003e\n\u003cp\u003e例如，在 Ubuntu 14.04 基础镜像中运行 \u003ccode\u003eRUN apt-get upgrade\u003c/code\u003e 会在保留基础层的同时再创建一个新层来放所有新的文件，而不是修改老的文件。因此，新的镜像大小会超过直接在老的文件系统上做更新时的文件大小。所以，为了减少镜像大小起见，所有文件相关的操作，比如删除、释放和移动等，都需要尽可能地放在一个 \u003ccode\u003eRUN\u003c/code\u003e 指令中进行。\u003c/p\u003e\n\u003ch4 id=\"镜像的内容\"\u003e镜像的内容\u003c/h4\u003e\n\u003cp\u003e容器镜像的内容，其实是一个 json 文件加上 tar 包。\u003c/p\u003e\n\u003cp\u003e1、将镜像导出为 tar 文件。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# docker images|grep nginx\nnginx                                                        latest              3f8a4339aadd        6 months ago        108MB\n[root@xdhuxc xdhuxc]# docker save nginx:latest -o nginx.tar\n[root@xdhuxc xdhuxc]# ls\nnginx.tar\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、解压 nginx.tar 文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# mkdir nginx\n[root@xdhuxc xdhuxc]# tar -xf nginx.tar -C nginx\ntar: manifest.json: implausibly old time stamp 1970-01-01 08:00:00\ntar: repositories: implausibly old time stamp 1970-01-01 08:00:00\n[root@xdhuxc xdhuxc]# ll nginx\ntotal 28\n-rw-r--r-- 1 root root 5835 Dec 27  2017 3f8a4339aadda5897b744682f5f774dc69991a81af8d715d37a616bb4c99edf5.json\ndrwxr-xr-x 2 root root 4096 Dec 27  2017 ae57c7dd09b742b01fba1af0f40503e6f7e581a7cda614f0c36fa81af4a02129\ndrwxr-xr-x 2 root root 4096 Dec 27  2017 b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa\ndrwxr-xr-x 2 root root 4096 Dec 27  2017 b6eb01f37fe4e3091b0230a181e38d2fa37b4169daab10f85782b92e7437b027\n-rw-r--r-- 1 root root  355 Jan  1  1970 manifest.json\n-rw-r--r-- 1 root root   88 Jan  1  1970 repositories\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e其中的 repositories 文件的内容，就是镜像名称、版本、最上层的 layer 的名称。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# cat nginx/repositories | python -m json.tool\n{\n    \u0026#34;nginx\u0026#34;: {\n        \u0026#34;latest\u0026#34;: \u0026#34;b6eb01f37fe4e3091b0230a181e38d2fa37b4169daab10f85782b92e7437b027\u0026#34;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e而 manifest.json 文件中保存的是镜像的元数据，包括真正包含元数据的 json 文件的名称及每一层的名称、标签等。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# cat nginx/manifest.json | python -m json.tool\n[\n    {\n        \u0026#34;Config\u0026#34;: \u0026#34;3f8a4339aadda5897b744682f5f774dc69991a81af8d715d37a616bb4c99edf5.json\u0026#34;,\n        \u0026#34;Layers\u0026#34;: [\n            \u0026#34;b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa/layer.tar\u0026#34;,\n            \u0026#34;ae57c7dd09b742b01fba1af0f40503e6f7e581a7cda614f0c36fa81af4a02129/layer.tar\u0026#34;,\n            \u0026#34;b6eb01f37fe4e3091b0230a181e38d2fa37b4169daab10f85782b92e7437b027/layer.tar\u0026#34;\n        ],\n        \u0026#34;RepoTags\u0026#34;: [\n            \u0026#34;nginx:latest\u0026#34;\n        ]\n    }\n]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3f8a4339aadda5897b744682f5f774dc69991a81af8d715d37a616bb4c99edf5.json 文件真正地包含镜像的所有元数据。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e  1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e  9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 85\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 86\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 87\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 88\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 89\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 90\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 91\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 92\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 93\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 94\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 95\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 96\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 97\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 98\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 99\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e100\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e101\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e102\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e103\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e104\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e105\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e106\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e107\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e108\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e109\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e110\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e111\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e112\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e113\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e114\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e115\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e116\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e117\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e118\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e119\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e120\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e121\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e122\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e123\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e124\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e125\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e126\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e127\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e128\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e129\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e130\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e131\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e132\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e133\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e134\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# cat nginx/3f8a4339aadda5897b744682f5f774dc69991a81af8d715d37a616bb4c99edf5.json | python -m json.tool\n{\n    \u0026#34;architecture\u0026#34;: \u0026#34;amd64\u0026#34;,\n    \u0026#34;config\u0026#34;: {\n        \u0026#34;ArgsEscaped\u0026#34;: true,\n        \u0026#34;AttachStderr\u0026#34;: false,\n        \u0026#34;AttachStdin\u0026#34;: false,\n        \u0026#34;AttachStdout\u0026#34;: false,\n        \u0026#34;Cmd\u0026#34;: [\n            \u0026#34;nginx\u0026#34;,\n            \u0026#34;-g\u0026#34;,\n            \u0026#34;daemon off;\u0026#34;\n        ],\n        \u0026#34;Domainname\u0026#34;: \u0026#34;\u0026#34;,\n        \u0026#34;Entrypoint\u0026#34;: null,\n        \u0026#34;Env\u0026#34;: [\n            \u0026#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\u0026#34;,\n            \u0026#34;NGINX_VERSION=1.13.8-1~stretch\u0026#34;,\n            \u0026#34;NJS_VERSION=1.13.8.0.1.15-1~stretch\u0026#34;\n        ],\n        \u0026#34;ExposedPorts\u0026#34;: {\n            \u0026#34;80/tcp\u0026#34;: {}\n        },\n        \u0026#34;Hostname\u0026#34;: \u0026#34;\u0026#34;,\n        \u0026#34;Image\u0026#34;: \u0026#34;sha256:dac2e319f33250a5b2eea74443b35d7fb05a382a95d21670f2628b92ffa023ce\u0026#34;,\n        \u0026#34;Labels\u0026#34;: {\n            \u0026#34;maintainer\u0026#34;: \u0026#34;NGINX Docker Maintainers \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edocker-maint\u003c/span\u003e\u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003enginx\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecom\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34;\n        },\n        \u0026#34;OnBuild\u0026#34;: [],\n        \u0026#34;OpenStdin\u0026#34;: false,\n        \u0026#34;StdinOnce\u0026#34;: false,\n        \u0026#34;StopSignal\u0026#34;: \u0026#34;SIGTERM\u0026#34;,\n        \u0026#34;Tty\u0026#34;: false,\n        \u0026#34;User\u0026#34;: \u0026#34;\u0026#34;,\n        \u0026#34;Volumes\u0026#34;: null,\n        \u0026#34;WorkingDir\u0026#34;: \u0026#34;\u0026#34;\n    },\n    \u0026#34;container\u0026#34;: \u0026#34;71cc5766414f132cf702e88d8de29527bbc2e151f8499b14fcc3540fd853b86d\u0026#34;,\n    \u0026#34;container_config\u0026#34;: {\n        \u0026#34;ArgsEscaped\u0026#34;: true,\n        \u0026#34;AttachStderr\u0026#34;: false,\n        \u0026#34;AttachStdin\u0026#34;: false,\n        \u0026#34;AttachStdout\u0026#34;: false,\n        \u0026#34;Cmd\u0026#34;: [\n            \u0026#34;/bin/sh\u0026#34;,\n            \u0026#34;-c\u0026#34;,\n            \u0026#34;#(nop) \u0026#34;,\n            \u0026#34;CMD [\\\u0026#34;nginx\\\u0026#34; \\\u0026#34;-g\\\u0026#34; \\\u0026#34;daemon off;\\\u0026#34;]\u0026#34;\n        ],\n        \u0026#34;Domainname\u0026#34;: \u0026#34;\u0026#34;,\n        \u0026#34;Entrypoint\u0026#34;: null,\n        \u0026#34;Env\u0026#34;: [\n            \u0026#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\u0026#34;,\n            \u0026#34;NGINX_VERSION=1.13.8-1~stretch\u0026#34;,\n            \u0026#34;NJS_VERSION=1.13.8.0.1.15-1~stretch\u0026#34;\n        ],\n        \u0026#34;ExposedPorts\u0026#34;: {\n            \u0026#34;80/tcp\u0026#34;: {}\n        },\n        \u0026#34;Hostname\u0026#34;: \u0026#34;71cc5766414f\u0026#34;,\n        \u0026#34;Image\u0026#34;: \u0026#34;sha256:dac2e319f33250a5b2eea74443b35d7fb05a382a95d21670f2628b92ffa023ce\u0026#34;,\n        \u0026#34;Labels\u0026#34;: {\n            \u0026#34;maintainer\u0026#34;: \u0026#34;NGINX Docker Maintainers \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edocker-maint\u003c/span\u003e\u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003enginx\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecom\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34;\n        },\n        \u0026#34;OnBuild\u0026#34;: [],\n        \u0026#34;OpenStdin\u0026#34;: false,\n        \u0026#34;StdinOnce\u0026#34;: false,\n        \u0026#34;StopSignal\u0026#34;: \u0026#34;SIGTERM\u0026#34;,\n        \u0026#34;Tty\u0026#34;: false,\n        \u0026#34;User\u0026#34;: \u0026#34;\u0026#34;,\n        \u0026#34;Volumes\u0026#34;: null,\n        \u0026#34;WorkingDir\u0026#34;: \u0026#34;\u0026#34;\n    },\n    \u0026#34;created\u0026#34;: \u0026#34;2017-12-26T18:17:01.106799157Z\u0026#34;,\n    \u0026#34;docker_version\u0026#34;: \u0026#34;17.06.2-ce\u0026#34;,\n    \u0026#34;history\u0026#34;: [\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-12T01:44:43.599554271Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c #(nop) ADD file:f30a8b5b7cdc9ba33a250899308b490baa9f7a9b29d3a85bd16200aa0a28a04a in / \u0026#34;\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-12T01:44:43.84546055Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c #(nop)  CMD [\\\u0026#34;bash\\\u0026#34;]\u0026#34;,\n            \u0026#34;empty_layer\u0026#34;: true\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-12T05:14:40.530307095Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c #(nop)  LABEL maintainer=NGINX Docker Maintainers \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003edocker-maint\u003c/span\u003e\u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"na\"\u003enginx\u003c/span\u003e\u003cspan class=\"err\"\u003e.\u003c/span\u003e\u003cspan class=\"na\"\u003ecom\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\u0026#34;,\n            \u0026#34;empty_layer\u0026#34;: true\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-26T18:14:42.009655355Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c #(nop)  ENV NGINX_VERSION=1.13.8-1~stretch\u0026#34;,\n            \u0026#34;empty_layer\u0026#34;: true\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-26T18:14:42.209098573Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c #(nop)  ENV NJS_VERSION=1.13.8.0.1.15-1~stretch\u0026#34;,\n            \u0026#34;empty_layer\u0026#34;: true\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-26T18:16:59.73279946Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c set -x \\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get update \\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get install --no-install-recommends --no-install-suggests -y gnupg1 \\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \\tNGINX_GPGKEY=573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62; \\tfound=\u0026#39;\u0026#39;; \\tfor server in \\t\\tha.pool.sks-keyservers.net \\t\\thkp://keyserver.ubuntu.com:80 \\t\\thkp://p80.pool.sks-keyservers.net:80 \\t\\tpgp.mit.edu \\t; do \\t\\techo \\\u0026#34;Fetching GPG key $NGINX_GPGKEY from $server\\\u0026#34;; \\t\\tapt-key adv --keyserver \\\u0026#34;$server\\\u0026#34; --keyserver-options timeout=10 --recv-keys \\\u0026#34;$NGINX_GPGKEY\\\u0026#34; \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e found=yes \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e break; \\tdone; \\ttest -z \\\u0026#34;$found\\\u0026#34; \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e echo \u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e2 \\\u0026#34;error: failed to fetch GPG key $NGINX_GPGKEY\\\u0026#34; \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e exit 1; \\tapt-get remove --purge --auto-remove -y gnupg1 \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e rm -rf /var/lib/apt/lists/* \\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e dpkgArch=\\\u0026#34;$(dpkg --print-architecture)\\\u0026#34; \\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e nginxPackages=\\\u0026#34; \\t\\tnginx=${NGINX_VERSION} \\t\\tnginx-module-xslt=${NGINX_VERSION} \\t\\tnginx-module-geoip=${NGINX_VERSION} \\t\\tnginx-module-image-filter=${NGINX_VERSION} \\t\\tnginx-module-njs=${NJS_VERSION} \\t\\\u0026#34; \\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e case \\\u0026#34;$dpkgArch\\\u0026#34; in \\t\\tamd64|i386) \\t\\t\\techo \\\u0026#34;deb http://nginx.org/packages/mainline/debian/ stretch nginx\\\u0026#34; \u0026gt;\u0026gt; /etc/apt/sources.list \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get update \\t\\t\\t;; \\t\\t*) \\t\\t\\techo \\\u0026#34;deb-src http://nginx.org/packages/mainline/debian/ stretch nginx\\\u0026#34; \u0026gt;\u0026gt; /etc/apt/sources.list \\t\\t\\t\\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e tempDir=\\\u0026#34;$(mktemp -d)\\\u0026#34; \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e chmod 777 \\\u0026#34;$tempDir\\\u0026#34; \\t\\t\\t\\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e savedAptMark=\\\u0026#34;$(apt-mark showmanual)\\\u0026#34; \\t\\t\\t\\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get update \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get build-dep -y $nginxPackages \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ( \\t\\t\\t\\tcd \\\u0026#34;$tempDir\\\u0026#34; \\t\\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e DEB_BUILD_OPTIONS=\\\u0026#34;nocheck parallel=$(nproc)\\\u0026#34; \\t\\t\\t\\t\\tapt-get source --compile $nginxPackages \\t\\t\\t) \\t\\t\\t\\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-mark showmanual | xargs apt-mark auto \u0026gt; /dev/null \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e { [ -z \\\u0026#34;$savedAptMark\\\u0026#34; ] || apt-mark manual $savedAptMark; } \\t\\t\\t\\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ls -lAFh \\\u0026#34;$tempDir\\\u0026#34; \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ( cd \\\u0026#34;$tempDir\\\u0026#34; \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e dpkg-scanpackages . \u0026gt; Packages ) \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e grep \u0026#39;^Package: \u0026#39; \\\u0026#34;$tempDir/Packages\\\u0026#34; \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e echo \\\u0026#34;deb [ trusted=yes ] file://$tempDir ./\\\u0026#34; \u0026gt; /etc/apt/sources.list.d/temp.list \\t\\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get -o Acquire::GzipIndexes=false update \\t\\t\\t;; \\tesac \\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e apt-get install --no-install-recommends --no-install-suggests -y \\t\\t\\t\\t\\t\\t$nginxPackages \\t\\t\\t\\t\\t\\tgettext-base \\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e rm -rf /var/lib/apt/lists/* \\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e if [ -n \\\u0026#34;$tempDir\\\u0026#34; ]; then \\t\\tapt-get purge -y --auto-remove \\t\\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e rm -rf \\\u0026#34;$tempDir\\\u0026#34; /etc/apt/sources.list.d/temp.list; \\tfi\u0026#34;\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-26T18:17:00.44958667Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c ln -sf /dev/stdout /var/log/nginx/access.log \\t\u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e ln -sf /dev/stderr /var/log/nginx/error.log\u0026#34;\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-26T18:17:00.662765942Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c #(nop)  EXPOSE 80/tcp\u0026#34;,\n            \u0026#34;empty_layer\u0026#34;: true\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-26T18:17:00.902045007Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c #(nop)  STOPSIGNAL [SIGTERM]\u0026#34;,\n            \u0026#34;empty_layer\u0026#34;: true\n        },\n        {\n            \u0026#34;created\u0026#34;: \u0026#34;2017-12-26T18:17:01.106799157Z\u0026#34;,\n            \u0026#34;created_by\u0026#34;: \u0026#34;/bin/sh -c #(nop)  CMD [\\\u0026#34;nginx\\\u0026#34; \\\u0026#34;-g\\\u0026#34; \\\u0026#34;daemon off;\\\u0026#34;]\u0026#34;,\n            \u0026#34;empty_layer\u0026#34;: true\n        }\n    ],\n    \u0026#34;os\u0026#34;: \u0026#34;linux\u0026#34;,\n    \u0026#34;rootfs\u0026#34;: {\n        \u0026#34;diff_ids\u0026#34;: [\n            \u0026#34;sha256:2ec5c0a4cb57c0af7c16ceda0b0a87a54f01f027ed33836a5669ca266cafe97a\u0026#34;,\n            \u0026#34;sha256:73e2bd4455140950d98430338783415109e4c4dcf955681d334b312b176d964a\u0026#34;,\n            \u0026#34;sha256:a103d141fc9823f04f30d1e71705001577eab94df7ac594e5e49f64e2e506c8b\u0026#34;\n        ],\n        \u0026#34;type\u0026#34;: \u0026#34;layers\u0026#34;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e而剩余的三个目录则与该镜像的三个 layers 一一对应。（使用 docker inspect nginx:latest）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u0026#34;RootFS\u0026#34;: {\n            \u0026#34;Type\u0026#34;: \u0026#34;layers\u0026#34;,\n            \u0026#34;Layers\u0026#34;: [\n                \u0026#34;sha256:2ec5c0a4cb57c0af7c16ceda0b0a87a54f01f027ed33836a5669ca266cafe97a\u0026#34;,\n                \u0026#34;sha256:73e2bd4455140950d98430338783415109e4c4dcf955681d334b312b176d964a\u0026#34;,\n                \u0026#34;sha256:a103d141fc9823f04f30d1e71705001577eab94df7ac594e5e49f64e2e506c8b\u0026#34;\n            ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e每个目录中的内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# ll nginx/b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa/\ntotal 57072\n-rw-r--r-- 1 root root      393 Dec 27  2017 json\n-rw-r--r-- 1 root root 58430976 Dec 27  2017 layer.tar\n-rw-r--r-- 1 root root        3 Dec 27  2017 VERSION\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解压 layer.tar 文件，查看其内容\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# cd nginx/b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa/\n[root@xdhuxc b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa]# mkdir layer\n[root@xdhuxc b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa]# tar -xf layer.tar -C layer\n[root@xdhuxc b539656cdce57ade73a3019a36addf1b80ae19cc951655ea264c2a6af56d1cfa]# ll layer/\ntotal 76\ndrwxr-xr-x  2 root root 4096 Dec 10  2017 bin\ndrwxr-xr-x  2 root root 4096 Nov 19  2017 boot\ndrwxr-xr-x  2 root root 4096 Dec 10  2017 dev\ndrwxr-xr-x 28 root root 4096 Dec 10  2017 etc\ndrwxr-xr-x  2 root root 4096 Nov 19  2017 home\ndrwxr-xr-x  8 root root 4096 Dec 10  2017 lib\ndrwxr-xr-x  2 root root 4096 Dec 10  2017 lib64\ndrwxr-xr-x  2 root root 4096 Dec 10  2017 media\ndrwxr-xr-x  2 root root 4096 Dec 10  2017 mnt\ndrwxr-xr-x  2 root root 4096 Dec 10  2017 opt\ndrwxr-xr-x  2 root root 4096 Nov 19  2017 proc\ndrwx------  2 root root 4096 Dec 10  2017 root\ndrwxr-xr-x  4 root root 4096 Dec 10  2017 run\ndrwxr-xr-x  2 root root 4096 Dec 10  2017 sbin\ndrwxr-xr-x  2 root root 4096 Dec 10  2017 srv\ndrwxr-xr-x  2 root root 4096 Nov 19  2017 sys\ndrwxrwxrwt  2 root root 4096 Dec 10  2017 tmp\ndrwxr-xr-x 10 root root 4096 Dec 10  2017 usr\ndrwxr-xr-x 11 root root 4096 Dec 10  2017 var\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e从以上分析可见：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edocker 镜像中主要是 tar 文件包和元数据 json 文件。\u003c/li\u003e\n\u003cli\u003edocker 镜像的打包过程，其实就是将每一层对应的文件打包过程，最后组成一个单一的 tar 文件。\u003c/li\u003e\n\u003cli\u003edocker 镜像的使用过程，其实就是将一层层的 tar 文件载入到文件系统的过程。\u003c/li\u003e\n\u003c/ul\u003e","date":1500508800,"description":"","fuzzywordcount":3400,"kind":"page","lang":"zh","lastmod":1503619200,"objectID":"160328e34f0d12f8764ee416730b4e77","publishdate":1500508800,"relpermalink":"/posts/docker/docker-basic-knowledge-two/","section":"posts","summary":"\u003cp\u003e本篇博客介绍了 Docker 容器的一些基础知识和基本原理。\u003c/p\u003e","tags":["Docker"],"title":"docker 基础知识（二）","url":"https://xdhuxc.github.io/posts/docker/docker-basic-knowledge-two/","wordcount":3343},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了 Linux 系统中命名空间和 cgroup 在 docker 中的使用。docker 容器使用 linux namespace 隔离容器中应用的运行环境，使用 cgroup 来限制应用运行时的资源，这是 docker 容器的基础。\u003c/p\u003e\n\u003ch3 id=\"linux-namespace-概念\"\u003eLinux namespace 概念\u003c/h3\u003e\n\u003cp\u003eLinux 内核从版本 2.4.19 开始陆续引入了 namespace 的概念，其目的是将某个特定的全局系统资源，通过抽象的方式，使得 namespace 中的进程看起来拥有它们自己的隔离的全局系统资源实例。\u003c/p\u003e\n\u003cp\u003eLinux 内核中实现了六种 namespace，按照引入的先后顺序，列表如下：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e命名空间名称\u003c/th\u003e\n\u003cth\u003e引入的相关内核版本\u003c/th\u003e\n\u003cth\u003e被隔离的全局系统资源\u003c/th\u003e\n\u003cth\u003e在容器语境下的隔离效果\u003c/th\u003e\n\u003cth\u003e\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eMount 命名空间\u003c/td\u003e\n\u003ctd\u003eLinux 2.4.19\u003c/td\u003e\n\u003ctd\u003e文件系统挂载点\u003c/td\u003e\n\u003ctd\u003e每个容器能看到不同的文件系统层次结构\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUTS 命名空间\u003c/td\u003e\n\u003ctd\u003eLinux 2.6.19\u003c/td\u003e\n\u003ctd\u003ehostname 和 domainname\u003c/td\u003e\n\u003ctd\u003e每个容器可以有自己的 hostname 和 domainname\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eIPC 命名空间\u003c/td\u003e\n\u003ctd\u003eLinux 2.6.19\u003c/td\u003e\n\u003ctd\u003e特定的进程间通信资源，包括 System V IPC 和 POSIX message queues\u003c/td\u003e\n\u003ctd\u003e每个容器有其自己的 System V IPC 和 POSIX 消息队列文件系统。因此，只有在同一个 IPC namespace 中的进程之间才能相互通信。\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePID 命名空间\u003c/td\u003e\n\u003ctd\u003eLinux 2.6.24\u003c/td\u003e\n\u003ctd\u003e进程 ID 数字空间（process ID number space）\u003c/td\u003e\n\u003ctd\u003e每个 PID namespace 中的进程可以有其独立的 PID；每个容器可以有其 PID 为 1 的 root 进程，也使得容器可以在不同的主机之间迁移，因为 namespace 中的进程 ID 与主机无关了，这也使得容器中的每个进程有两个 PID：容器中的 PID 和主机上的 PID。\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNetwork 命名空间\u003c/td\u003e\n\u003ctd\u003e始于 Linux 2.6.24，完成于 Linux 2.6.29\u003c/td\u003e\n\u003ctd\u003e网络相关的系统资源\u003c/td\u003e\n\u003ctd\u003e每个容器拥有其独立的网络设备、IP地址、IP路由表、/proc/net 目录、端口号等等。这也使得一个主机上多个容器内的同一个应用都可以绑定到各自容器的 80 端口上。\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eUser 命名空间\u003c/td\u003e\n\u003ctd\u003e始于 Linux 2.6.23，完成于 Linux 3.8\u003c/td\u003e\n\u003ctd\u003e用户和组 ID 空间\u003c/td\u003e\n\u003ctd\u003e在 user namespace 中的进程的用户和组 ID 可以和在宿主机上不同；每个容器可以有不同的用户和组ID，一个主机上的非特权用户可以成为 user namespace 中的特权用户。\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e简单来讲，处于某个命名空间中的进程，能看到独立的它自己的隔离的某些特定系统资源。\u003c/p\u003e\n\u003ch3 id=\"docker-容器使用-linux-namespace-做运行环境隔离\"\u003edocker 容器使用 linux namespace 做运行环境隔离\u003c/h3\u003e\n\u003cp\u003e当 docker 创建一个容器时，它会创建新的以上六种 namespace 的实例，然后把容器中的所有进程放到这些 namespace 之中，使得 docker 容器中的进程只能看到隔离的系统资源。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ns]# pwd\n/proc/3300/ns          # 3300 为容器在宿主机上的进程ID\n[root@xdhuxc ns]# ll\ntotal 0\nlrwxrwxrwx 1 1000 1000 0 Jul 11 08:47 ipc -\u0026gt; ipc:[4026532175]  # 1000 为容器在宿主机上的用户\nlrwxrwxrwx 1 1000 1000 0 Jul 11 08:47 mnt -\u0026gt; mnt:[4026532173]\nlrwxrwxrwx 1 1000 1000 0 Jul 11 08:37 net -\u0026gt; net:[4026532178]\nlrwxrwxrwx 1 1000 1000 0 Jul 11 08:47 pid -\u0026gt; pid:[4026532176]\nlrwxrwxrwx 1 1000 1000 0 Jul 11 09:00 user -\u0026gt; user:[4026531837]\nlrwxrwxrwx 1 1000 1000 0 Jul 11 08:47 uts -\u0026gt; uts:[4026532174]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"pid-命名空间\"\u003ePID 命名空间\u003c/h4\u003e\n\u003cp\u003e创建容器 zookeeper\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --restart=always \\\n    --name zookeeper \\\n    zookeeper:latest\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在容器内的 PID 是 1，PPID 为 0。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker exec -it zookeeper ps -ef\nUID        PID  PPID  C STIME TTY          TIME CMD\nzookeep+     1     0  0 14:53 ?        00:00:01 /usr/lib/jvm/java-1.8-openjdk/jr\nroot        47     0  0 14:57 pts/0    00:00:00 ps -ef\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在容器外的 PID 是 3391，PPID 是 3363，即 docker-containerd-shim 进程。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# ps -ef | grep -v grep | grep zookeeper\n1000      3391  3363  0 22:53 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3363 是 docker-containerd-shim 进程的 PID。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# ps -ef | grep -v grep | grep 3363\nroot      3363 21666  0 22:53 ?        00:00:00 docker-containerd-shim -namespace moby -workdir /var/lib/docker/containerd/daemon/io.containerd.runtime.v1.linux/moby/81cae3d22fd7ce29c2b49292bce16ac52f0cca8ea26b21b8f34e551deb7faef2 -address /var/run/docker/containerd/docker-containerd.sock -containerd-binary /usr/bin/docker-containerd -runtime-root /var/run/docker/runtime-runc -systemd-cgroup\n1000      3391  3363  0 22:53 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e我们能看到，同一个进程，在容器内外的 PID 是不同的。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e在容器内 PID 是 1，PPID 是 0.\u003c/li\u003e\n\u003cli\u003e在容器外 PID 是 3391，PPID 是 3363，即 docker-containerd-shim 进程\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e关于 containerd，containerd-shim 和 container 的关系：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/docker/docker-runc.jpg\" width=\"800px\" height=\"300px\" /\u003e\n图1 · containerd，containerd-shim 和 container 之间的关系\n\u003c/center\u003e\n\u003cul\u003e\n\u003cli\u003edocker 引擎管理着镜像，然后移交给 containerd 运行，containerd 再使用 runC 运行容器。\u003c/li\u003e\n\u003cli\u003econtainerd 是一个简单的守护进程，它可以使用 runC 管理容器，使用 gRPC 暴露容器的其他功能。它管理容器的开始、停止、暂停和销毁。由于容器运行时是孤立的引擎，引擎最终能够启动和升级而无需重新启动容器。\u003c/li\u003e\n\u003cli\u003erunC 是一个轻量级的工具，它是用来运行容器的，只用来做这一件事，并且这一件事要做好。runC 基本上是一个小命令行工具，且它可以不用通过 docker 引擎，直接就可以使用容器。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e因此，容器中的主应用在宿主机上的父进程是 containerd-shim，是它通过工具 runC 来启动这些进程的。\u003c/p\u003e\n\u003cp\u003e这也能看出来，pid 命名空间通过将宿主机上 PID 映射为容器内的 PID，使得容器内的进程看起来有个独立的 PID 空间。\u003c/p\u003e\n\u003ch4 id=\"uts-命名空间\"\u003eUTS 命名空间\u003c/h4\u003e\n\u003cp\u003e容器可以有自己的 hostname 和 domainname\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# hostname\nxdhuxc             # 宿主机的主机名\n[root@xdhuxc ~]# docker exec -it zookeeper hostname\n81cae3d22fd7       # zookeeper 容器的主机名\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"user-命名空间\"\u003euser 命名空间\u003c/h4\u003e\n\u003cp\u003e在 docker 1.10 版本之前，是不支持 user 命名空间的，也就是说，默认地，容器内的进程的运行用户就是宿主机上的 root 用户。这样的话，当宿主机上的文件或者目录作为挂载卷被映射到容器以后，容器内的进程其实是有 root 的几乎所有权限去修改这些宿主机上的目录的，这会有很大的安全问题。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# id\nuid=0(root) gid=0(root) groups=0(root)\n[root@xdhuxc ~]# docker exec -it zookeeper id\nuid=0(root) gid=0(root)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时以如下命令启动一个容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d -v /bin:/host/bin --name zookeeper zookeeper:latest\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e默认情况下，是这样子的：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# ps -ef | grep zookeeper\n1000      3300  3284  0 08:37 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg\nroot      4323  1602  0 08:48 pts/1    00:00:00 grep --color=auto zookeeper\n[root@xdhuxc ~]# docker exec -it zookeeper ps -ef\nUID        PID  PPID  C STIME TTY          TIME CMD\nzookeep+     1     0  0 00:37 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jr\nroot        43     0  0 00:48 pts/0    00:00:00 ps -ef\n[root@xdhuxc ~]# docker exec -it zookeeper whoami\nroot\n[root@xdhuxc ~]# cat /etc/passwd | grep 1000\n[root@xdhuxc ~]# docker exec -it zookeeper id\nuid=0(root) gid=0(root)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e则进程的用户在容器内和容器外都是 \u003ccode\u003eroot\u003c/code\u003e，它可以在容器内对宿主机上的 \u003ccode\u003e/bin\u003c/code\u003e 目录做任意操作，非常不安全。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003edocker\u003c/code\u003e 1.10 中引入的 \u003ccode\u003euser\u003c/code\u003e 命名空间就可以让容器有一个“假”的 \u003ccode\u003eroot\u003c/code\u003e 用户，它在容器内是 \u003ccode\u003eroot\u003c/code\u003e，在容器外是一个非 \u003ccode\u003eroot\u003c/code\u003e 用户。也就是说，\u003ccode\u003euser\u003c/code\u003e 命名空间实现了宿主机 \u003ccode\u003eusers\u003c/code\u003e 和 容器内 \u003ccode\u003eusers\u003c/code\u003e 之间的映射。\u003c/p\u003e\n\u003ch4 id=\"network-命名空间\"\u003enetwork 命名空间\u003c/h4\u003e\n\u003cp\u003e默认情况下，当 docker 实例被创建出来后，使用 \u003ccode\u003eip netns\u003c/code\u003e 命令无法看到容器实例对应的 network 命名空间，这是因为 ip netns 命令 是从 /var/run/netns 目录中读取内容的。\u003c/p\u003e\n\u003cp\u003e操作步骤：\n1、找到容器的主进程 ID\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker inspect --format \u0026#39;{{.State.Pid}}\u0026#39; zookeeper\n3300\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、创建 /var/run/netns 目录及符号链接\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# mkdir /var/run/netns\n[root@xdhuxc ~]# ln -s /proc/3300/ns/net /var/run/netns/zookeeper \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3300 是 zookeeper 容器在宿主机上的进程ID。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# ps -ef | grep -v grep | grep 3300\n1000      3300  3284  0 08:37 ?        00:01:10 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e而 1000 是容器内的 zookeeper 用户的用户ID\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebash-4.4# cat /etc/passwd|grep 1000\nzookeeper:x:1000:1000:Linux User,,,:/home/zookeeper:\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e说明在创建容器的时候，docker 自动在 /proc 目录下为每一个容器以其进程ID为目录名创建了存放包括cpu、内存、io、命名空间等各种资源的目录，删除容器时会自动删除该目录。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc 3300]# pwd\n/proc/3300\n[root@xdhuxc 3300]# ls\nattr       clear_refs       cpuset   fd       limits     mem         net        oom_score      projid_map  setgroups  statm    timers\nautogroup  cmdline          cwd      fdinfo   loginuid   mountinfo   ns         oom_score_adj  root        smaps      status   uid_map\nauxv       comm             environ  gid_map  map_files  mounts      numa_maps  pagemap        sched       stack      syscall  wchan\ncgroup     coredump_filter  exe      io       maps       mountstats  oom_adj    personality    sessionid   stat       task\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、此时，可以使用 ip netns 命令了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# ip netns\nzookeeper (id: 0)\n[root@xdhuxc ~]# ip netns exec zookeeper ip addr           \n1: lo: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eLOOPBACK\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 65536 qdisc noqueue state UNKNOWN \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n237: eth0@if238: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue state UP \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e也就是容器内的网桥信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker exec -it zookeeper ip addr\n1: lo: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eLOOPBACK\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 65536 qdisc noqueue state UNKNOWN \n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n237: eth0@if238: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eM-DOWN\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue state UP \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"docker-run-命令中-namespace-相关参数\"\u003edocker run 命令中 namespace 相关参数\u003c/h4\u003e\n\u003cp\u003edocker run 命令中如下几个参数和 namespace 相关：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e--ipc string 指定使用的 IPC 命名空间\u003c/li\u003e\n\u003cli\u003e--pid string 指定使用的 PID 命名空间\u003c/li\u003e\n\u003cli\u003e--userns string 指定使用的 User 命名空间\u003c/li\u003e\n\u003cli\u003e--uts string 指定使用的 UTS 命名空间\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"--userns\"\u003e--userns\u003c/h5\u003e\n\u003cp\u003e--userns：指定容器使用的 user 命名空间\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u0026quot;host\u0026quot;：使用 docker 所在宿主机的 user 命名空间。\u003c/li\u003e\n\u003cli\u003e\u0026quot;\u0026quot;：使用由 \u003ccode\u003e--userns-remap\u003c/code\u003e 指定的 docker daemon user 命名空间。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e可以在启用了 user 命名空间的情况下，强制某个容器运行在宿主机 user 命名空间之中：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# ps -ef|grep zookeeper\n1000      9575  9559  0 19:47 ?        00:00:01 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg\nroot      9910  8341  0 19:51 pts/1    00:00:00 grep --color=auto zookeeper\n[root@xdhuxc xdhuxc]# whoami\nroot\n[root@xdhuxc xdhuxc]# docker exec -it zookeeper whoami\nroot\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e否则默认的话，就会运行在特定的 user 命名空间之中了。\u003c/p\u003e\n\u003ch4 id=\"--pid\"\u003e--pid\u003c/h4\u003e\n\u003cp\u003e可以指定容器使用 docker 宿主机 pid 命名空间。这样，在容器中的进程，可以看到宿主机上的所有进程。注意，此时不能启用 user 命名空间。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# docker run -d --name zookeeper --pid host --userns host zookeeper:latest\n5b847849106c5d597e33f9f3c346ab2a5a5638f6978d7a3ac6c6e1f2a61e0971\n[root@xdhuxc xdhuxc]# docker exec -it zookeeper apk add procps\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.7/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.7/community/x86_64/APKINDEX.tar.gz\n(1/3) Installing libintl (0.19.8.1-r1)\n(2/3) Installing libproc (3.3.12-r3)\n(3/3) Installing procps (3.3.12-r3)\nExecuting busybox-1.27.2-r11.trigger\nOK: 91 MiB in 62 packages\n[root@xdhuxc xdhuxc]# docker exec -it zookeeper ps -ef\nUID        PID  PPID  C STIME TTY          TIME CMD\nroot         1     0  0 Jun07 ?        00:01:36 /usr/lib/systemd/systemd --switc # 删除了若干与此无关的行\nroot      3144     1  0 00:37 ?        00:03:34 /usr/bin/dockerd --storage-drive\nroot      3151  3144  0 00:37 ?        00:02:28 docker-containerd --config /var/\nroot      3420  3151  0 00:39 ?        00:00:00 docker-containerd-shim -namespac\n999       3436  3420  0 00:39 ?        00:00:00 /bin/sh /usr/lib/rabbitmq/bin/ra\n999       3549  3436  0 00:39 ?        00:00:00 /usr/lib/erlang/erts-9.3.3/bin/e\n999       3626  3436  0 00:39 ?        00:03:05 /usr/lib/erlang/erts-9.3.3/bin/b\n999       3738  3626  0 00:39 ?        00:00:01 erl_child_setup 65536\n999       3790  3738  0 00:39 ?        00:00:00 inet_gethost 4\n999       3791  3790  0 00:39 ?        00:00:00 inet_gethost 4\n993       5460     1  0 Jun30 ?        00:00:00 nginx: worker process\n993       5461     1  0 Jun30 ?        00:00:00 nginx: worker process\n993       5462     1  0 Jun30 ?        00:00:00 nginx: worker process\n993       5463     1  0 Jun30 ?        00:00:00 nginx: worker process\nroot     10185  3151  0 11:54 ?        00:00:00 docker-containerd-shim -namespac\nzookeep+ 10201 10185  4 11:54 ?        00:00:01 /usr/lib/jvm/java-1.8-openjdk/jr\nroot     10323  8341  0 11:54 ?        00:00:00 docker exec -it zookeeper ps -ef\nroot     10340 10185  0 11:54 pts/0    00:00:00 ps -ef\nroot     10347 10185  0 11:54 ?        00:00:00 docker-runc --root /var/run/dock\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"--uts\"\u003e--uts\u003c/h4\u003e\n\u003cp\u003e可以使容器使用 docker 宿主机的 uts 命名空间。此时，最明显的是，容器的 hostname 和 docker 宿主机的 hostname 是相同的。\u003c/p\u003e\n\u003cp\u003e一般情况下，创建的 docker 容器的 hostname 为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker run -d -v /bin:/host/bin --name nginx nginx:latest\n35ec0c186dfc6746b343f784bfeafd87e75c8eb256a55f0d7fe91db73522f4a9\n[root@xdhuxc ~]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\n35ec0c186dfc        nginx:latest        \u0026#34;nginx -g \u0026#39;daemon of…\u0026#34;   5 seconds ago       Up 4 seconds        80/tcp              nginx\n[root@xdhuxc ~]# docker exec -it nginx bash\nroot@35ec0c186dfc:/# hostname\n35ec0c186dfc                                # 随机生成的主机名\nroot@35ec0c186dfc:/# cat /etc/hosts\n127.0.0.1\tlocalhost\n::1\tlocalhost ip6-localhost ip6-loopback\nfe00::0\tip6-localnet\nff00::0\tip6-mcastprefix\nff02::1\tip6-allnodes\nff02::2\tip6-allrouters\n172.17.0.2\t35ec0c186dfc                    # docker 随机生成的主机名，与主机名一致\nroot@35ec0c186dfc:/# domainname\n(none)\nroot@35ec0c186dfc:/# \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e为 docker 创建的一个随机的字符串。\u003c/p\u003e\n\u003cp\u003e为新启动的容器应用宿主机的 uts 命名空间\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# docker run -d --name zookeeper --uts host zookeeper:latest\n97cb004b489cbf5e0073a14931953c6b892cbdd4da9df4c06fa7e219727e6780\n[root@xdhuxc xdhuxc]# docker exec -it zookeeper hostname\nxdhuxc                         # zookeeper 容器的主机名\n[root@xdhuxc xdhuxc]# docker exec -it zookeeper cat /etc/hosts\n127.0.0.1\tlocalhost\n::1\tlocalhost ip6-localhost ip6-loopback\nfe00::0\tip6-localnet\nff00::0\tip6-mcastprefix\nff02::1\tip6-allnodes\nff02::2\tip6-allrouters\n172.17.0.2\t97cb004b489c       # docker 为每一个容器随机生成的主机名\n[root@xdhuxc xdhuxc]# hostname\nxdhuxc                         # 宿主机的主机名\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e但是，却存在这种情况，不知道是什么含义及原因。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# docker inspect --format=\u0026#39;{{.HostConfig.UTSMode}}\u0026#39; zookeeper\nhost\n[root@xdhuxc xdhuxc]# docker inspect --format=\u0026#39;{{.Config.Hostname}}\u0026#39; zookeeper\n97cb004b489c\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e总之，docker 守护进程为每个容器都创建了六种 namespaces 的实例，使得容器中的进程都处于一种隔离的运行环境之中。\u003c/p\u003e\n\u003ch3 id=\"linux-control-groups\"\u003eLinux control groups\u003c/h3\u003e\n\u003cp\u003eLinux Cgroup 可以让我们为系统中所运行的任务（进程）的用户定义组群分配资源，比如 CPU 时间、系统内存、网络带宽或者这些资源的组合。我们可以监控配置的cgroup，拒绝 cgroup 访问某些资源，甚至在运行的系统中动态配置 cgroup。可以将 control groups 理解为 controller （system resource ）（for）（process）groups，也就是说 cgroup 以一组进程为目标进行系统资源分配和控制。\u003c/p\u003e\n\u003cp\u003ecgroup 主要提供如下功能：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eResource Limitation：限制资源使用，比如，内存使用上限，文件系统的缓存限制等。\u003c/li\u003e\n\u003cli\u003ePrioritization：优先级控制，比如，CPU 利用和磁盘 I/O 吞吐。\u003c/li\u003e\n\u003cli\u003eAccounting：一些审计或统计，主要目的是为了计费。\u003c/li\u003e\n\u003cli\u003eControl：挂起进程，恢复执行进程。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e使用 cgroup，系统管理员可以更具体地控制对系统资源的分配、优先顺序、拒绝、管理和监控，可以更好地根据任务和用户分配硬件资源，提高总体效率。\u003c/p\u003e\n\u003cp\u003e在实际的使用中，系统管理员一般会利用 cgroup 做以下几方面工作：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e隔离一个进程集合（例如，nginx 的所有进程），并限制它们所消耗的资源，比如绑定 CPU 的核。\u003c/li\u003e\n\u003cli\u003e为这组进程分配其足够使用的内存。\u003c/li\u003e\n\u003cli\u003e为这组进程分配相应的网络带宽和磁盘存储限制。\u003c/li\u003e\n\u003cli\u003e限制访问某些设备，通过设置设备的白名单来实现。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在 linux 系统中，一切皆文件。为了方便用户使用，Linux 也将 cgroup 实现成了文件系统。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# mount -t cgroup\ncgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)\ncgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)\ncgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)\ncgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)\ncgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpuacct,cpu)\ncgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)\ncgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)\ncgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)\ncgroup on /sys/fs/cgroup/net_cls type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls)\ncgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)\n[root@xdhuxc xdhuxc]# lssubsys -m\ncpuset /sys/fs/cgroup/cpuset\ncpu,cpuacct /sys/fs/cgroup/cpu,cpuacct\nmemory /sys/fs/cgroup/memory\ndevices /sys/fs/cgroup/devices\nfreezer /sys/fs/cgroup/freezer\nnet_cls /sys/fs/cgroup/net_cls\nblkio /sys/fs/cgroup/blkio\nperf_event /sys/fs/cgroup/perf_event\nhugetlb /sys/fs/cgroup/hugetlb\n[root@xdhuxc xdhuxc]# ll /sys/fs/cgroup/\ntotal 0\ndrwxr-xr-x 5 root root  0 Jul 11 20:05 blkio\nlrwxrwxrwx 1 root root 11 Jun  7 15:40 cpu -\u0026gt; cpu,cpuacct\nlrwxrwxrwx 1 root root 11 Jun  7 15:40 cpuacct -\u0026gt; cpu,cpuacct\ndrwxr-xr-x 5 root root  0 Jul 11 20:05 cpu,cpuacct\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 cpuset\ndrwxr-xr-x 5 root root  0 Jul 11 20:05 devices\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 freezer\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 hugetlb\ndrwxr-xr-x 5 root root  0 Jul 11 20:05 memory\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 net_cls\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 perf_event\ndrwxr-xr-x 5 root root  0 Jul 11 20:05 systemd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到 /sys/fs/cgroup 目录中有若干个子目录，可以认为这些都是受 cgroup 控制的资源以及这些资源的信息。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eblkio：该子系统为块设备设定输入/输出限制，比如物理设备（磁盘、固态硬盘、USB等等）。\u003c/li\u003e\n\u003cli\u003ecpu：该子系统使用调度程序提供对 CPU 的 cgroup 任务访问。\u003c/li\u003e\n\u003cli\u003ecpuacct：该子系统自动生成 cgroup 中任务所使用的 CPU 报告。\u003c/li\u003e\n\u003cli\u003ecpuset：该子系统为 cgroup 中的任务分配独立 CPU（在多核系统） 和内存节点。\u003c/li\u003e\n\u003cli\u003edevices：该子系统可允许或者拒绝 cgroup 中的任何访问设备。\u003c/li\u003e\n\u003cli\u003efreezer：该子系统挂起或者恢复 cgroup 中的任务。\u003c/li\u003e\n\u003cli\u003ememory：该子系统设定 cgroup 中任务使用的内存限制，并自动生成内存资源使用报告。\u003c/li\u003e\n\u003cli\u003enet_cls：该子系统使用等级识别符（classid）标记网络数据包，可允许 Linux 流量控制程序（tc）识别从具体 cgroup 中生成的数据包。\u003c/li\u003e\n\u003cli\u003enet_prio：该子系统用来设计网络流量的优先级。\u003c/li\u003e\n\u003cli\u003ehugetlb：该子系统主要针对于 HugeTLB 系统进行限制，这是一个大页文件系统。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在 CentOS 7.2.1511 系统中，默认看不到 net_prio 目录\u003c/p\u003e\n\u003ch4 id=\"通过-cgroup-限制进程的-cpu\"\u003e通过 cgroup 限制进程的 CPU\u003c/h4\u003e\n\u003cp\u003e编写如下 C 语言程序\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# cat xdhuxc.cpp \nint main(void){\n\tint i = 0;\n\tfor( ; ; ) {\n\t\ti++;\n\t}\n\treturn 0;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e编译并运行\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# gcc xdhuxc.cpp -o xdhuxc.out\n[root@xdhuxc xdhuxc]# ./xdhuxc.out \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 top 命令查看 CPU 占用\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTasks: 131 total,   2 running, 129 sleeping,   0 stopped,   0 zombie\n%Cpu(s): 23.2 us,  0.1 sy,  0.0 ni, 76.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem :  8010904 total,  4122568 free,   331844 used,  3556492 buff/cache\nKiB Swap:  2096124 total,  2088680 free,     7444 used.  7014016 avail Mem \n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                              \n18110 root      20   0    4164    352    280 R  99.7  0.0   2:25.39 xdhuxc.out \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e接下来，我们使用 cgroup 限制其 CPU 占用，操作如下\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# mkdir /sys/fs/cgroup/cpu/xdhuxc\n[root@xdhuxc xdhuxc]# cd /sys/fs/cgroup/cpu/xdhuxc\n[root@xdhuxc xdhuxc]# ls\ncgroup.clone_children  cpuacct.stat          cpu.cfs_period_us  cpu.rt_runtime_us  notify_on_release\ncgroup.event_control   cpuacct.usage         cpu.cfs_quota_us   cpu.shares         tasks\ncgroup.procs           cpuacct.usage_percpu  cpu.rt_period_us   cpu.stat\n[root@xdhuxc xdhuxc]# cat cpu.cfs_quota_us \n-1\n[root@xdhuxc xdhuxc]# echo 20000 \u0026gt; cpu.cfs_quota_us \n[root@xdhuxc xdhuxc]# cat cpu.cfs_quota_us \n20000\n[root@xdhuxc xdhuxc]# echo 18110 \u0026gt; tasks\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emkdir /sys/fs/cgroup/cpu/xdhuxc：创建一个 CPU 控制组 xdhuxc，创建 xdhuxc 之后，可以看到目录下自动创建了相关的文件，这些文件都是伪文件。\u003c/li\u003e\n\u003cli\u003ecpu.cfs_period_us：CPU 分配的时间周期，以微秒计算，默认为：100000.\u003c/li\u003e\n\u003cli\u003ecpu.cfs_quota_us：表示该 control group 限制占用的时间（以微秒计算），默认为：-1，表示不限制。如果设置为2000，表示占用20000/100000=20%的CPU。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在多核情况下，看到的值会不一样。另外，cfs_quota_us 也是可以大于 cfs_period_us 的，这主要是对于多核情况。有 n 个核时，一个控制组中的进程自然最多就能用到 n 倍的 cpu 时间。\u003c/p\u003e\n\u003cp\u003e这两个值在 cgroups 层次中是有限制的，下层的资源不能超过上层。具体的说，就是下层的 cpu.cfs_period_us 值不能小于上层的值，cpu.cfs_quota_us 值不能大于上层的值。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://xiezhenye.com/2013/10/%E7%94%A8-cgroups-%E7%AE%A1%E7%90%86-cpu-%E8%B5%84%E6%BA%90.html\"\u003ehttp://xiezhenye.com/2013/10/%E7%94%A8-cgroups-%E7%AE%A1%E7%90%86-cpu-%E8%B5%84%E6%BA%90.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e注意：此种方式对C，shell，python起作用，对java似乎不起作用。\u003c/p\u003e\n\u003cp\u003e然后再查看 CPU 占用\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTasks: 131 total,   2 running, 129 sleeping,   0 stopped,   0 zombie\n%Cpu(s):  4.6 us,  0.3 sy,  0.0 ni, 95.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.1 st\nKiB Mem :  8010904 total,  4123224 free,   331196 used,  3556484 buff/cache\nKiB Swap:  2096124 total,  2088680 free,     7444 used.  7014740 avail Mem \n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                              \n18110 root      20   0    4164    352    280 R  19.9  0.0   8:25.99 xdhuxc.out          \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e它占用的 CPU 几乎就是 20%，也就是我们预设的阈值。这说明通过上面的操作，成功地将这个进程运行所占用的 CPU 资源限制在某个阈值范围内了。\u003c/p\u003e\n\u003cp\u003e此时加入另一个 xdhuxc.out\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTasks: 132 total,   3 running, 129 sleeping,   0 stopped,   0 zombie\n%Cpu(s): 27.8 us,  0.2 sy,  0.0 ni, 71.8 id,  0.2 wa,  0.0 hi,  0.0 si,  0.1 st\nKiB Mem :  8010904 total,  4123328 free,   331072 used,  3556504 buff/cache\nKiB Swap:  2096124 total,  2088680 free,     7444 used.  7014856 avail Mem \n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                              \n19016 root      20   0    4164    352    280 R 100.0  0.0   1:10.95 xdhuxc.out                           \n18110 root      20   0    4164    352    280 R  20.0  0.0   9:07.16 xdhuxc.out       \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e将此 xdhuxc.out 进程的 PID 加入 tasks 文件中，则这两个进程会共享设定的 CPU 限制\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc xdhuxc]# echo 19016 \u0026gt;\u0026gt; tasks \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 top 命令查看两个 xdhuxc.out 进程的 CPU 占用\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTasks: 132 total,   3 running, 129 sleeping,   0 stopped,   0 zombie\n%Cpu(s):  6.3 us,  1.6 sy,  0.0 ni, 91.8 id,  0.0 wa,  0.0 hi,  0.0 si,  0.3 st\nKiB Mem :  8010904 total,  4123656 free,   330696 used,  3556552 buff/cache\nKiB Swap:  2096124 total,  2088680 free,     7444 used.  7015244 avail Mem \n\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                               \n18110 root      20   0    4164    352    280 R  10.7  0.0   9:28.38 xdhuxc.out                                                                                      \n19016 root      20   0    4164    352    280 R   9.3  0.0   2:16.69 xdhuxc.out                 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可见，两个进程比较平均地分享了 CPU 时间。\u003c/p\u003e\n\u003ch4 id=\"通过-cgroup-限制进程的内存\"\u003e通过 cgroup 限制进程的内存\u003c/h4\u003e\n\u003cp\u003e类似的，我们针对它占用的内存做如下操作：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc memory]# mkdir /sys/fs/cgroup/memory/xdhuxc\n[root@xdhuxc memory]# cd /sys/fs/cgroup/memory/xdhuxc\n[root@xdhuxc xdhuxc]# cat memory.limit_in_bytes \n9223372036854775807\n[root@xdhuxc xdhuxc]# pwd\n/sys/fs/cgroup/memory/xdhuxc\n[root@xdhuxc xdhuxc]# echo 128M \u0026gt; memory.limit_in_bytes \n[root@xdhuxc xdhuxc]# echo 18110 \u0026gt; tasks\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e上面的步骤会把进程ID为 18110 的进程占用的内存阈值设置为 128M，超过的话，它会被杀掉。\u003c/p\u003e\n\u003ch4 id=\"通过-cgroup-限制进程的-io\"\u003e通过 cgroup 限制进程的 I/O\u003c/h4\u003e\n\u003cp\u003e运行命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esudo dd if=/dev/sda of=/dev/null\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 iotop 命令查看 IO（此时磁盘在快速转动），此时，其读速度为：3.21G/s：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eTotal DISK READ :      38.15 M/s | Total DISK WRITE :       0.00 B/s\nActual DISK READ:      38.15 M/s | Actual DISK WRITE:       0.00 B/s\n  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO\u0026gt;    COMMAND                                                                                                     \n20322 be/4 root          5.18 G      0.00 B  0.00 % 75.31 % dd if=/dev/sda of=/dev/null\n28167 be/0 root          2.35 G      0.00 B  0.00 %  4.58 % [loop0]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e接着做下面的操作：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# mkdir /sys/fs/cgroup/blkio/xdhuxc\n[root@xdhuxc ~]# cd /sys/fs/cgroup/blkio/xdhuxc\n[root@xdhuxc xdhuxc]# echo \u0026#34;253:0 1048576\u0026#34; \u0026gt; blkio.throttle.read_bps_device # 253:0 对应主设备号和副设备号，可以通过 ls -l /dev/sda 查看\n[root@xdhuxc xdhuxc]# echo 20322 \u0026gt; tasks \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e再使用 iotop 命令查看，读速度已经降到了 1M/s 以下。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e20322 be/4 root      993.36 K/s    0.00 B/s  0.00 %  0.00 % dd if=/dev/sda of=/dev/null  \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e似乎对 /dev/vda 设备的IO速度控制不起作用。\u003c/p\u003e\n\u003cp\u003e可能只对sda设备起作用，也可能用法不对。\u003c/p\u003e\n\u003ch4 id=\"术语\"\u003e术语\u003c/h4\u003e\n\u003cp\u003ecgroups 的术语包括：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e任务：Tasks，就是系统的一个进程。\u003c/li\u003e\n\u003cli\u003e控制组：Control Group，一组按照某种标准划分的进程，其表示了某进程组。cgroup 中的资源控制都是以控制组为单位实现。一个进程可以加入到某个控制组。而资源的限制是定义在这个组上，简单来说，cgroup就是一个目录带一系列的可配置文件。\u003c/li\u003e\n\u003cli\u003e层级：Hierarchy，控制组可以组织成hierarchy的形式，即一棵控制组的树形结构（目录结构），控制组树上的子节点继承父节点的属性，简单来说，hierarchy就是在一个或多个子系统上的cgroup目录树。\u003c/li\u003e\n\u003cli\u003e子系统：Subsystem，一个子系统就是一个资源控制器，比如CPU子系统就是控制CPU时间分配的一个控制器。子系统必须附加到一个层级上才能起作用，一个子系统附加到某个层级以后，这个层级上的所有控制组群都受到这个子系统的控制。cgroup的子系统可以有很多，也在不断地增加中。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"docker-使用-cgroup-限制容器进程资源的使用\"\u003edocker 使用 cgroup 限制容器进程资源的使用\u003c/h3\u003e\n\u003cp\u003e环境信息：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker info\nContainers: 0\n Running: 0\n Paused: 0\n Stopped: 0\nImages: 1\nServer Version: 17.12.1-ce\nStorage Driver: overlay2\n Backing Filesystem: xfs\n Supports d_type: true\n Native Overlay Diff: true\nLogging Driver: json-file\nCgroup Driver: cgroupfs\nPlugins:\n Volume: local\n Network: bridge host macvlan null overlay\n Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog\nSwarm: inactive\nRuntimes: runc\nDefault Runtime: runc\nInit Binary: docker-init\ncontainerd version: 9b55aab90508bd389d7654c4baf173a981477d55\nrunc version: 9f9c96235cc97674e935002fc3d78361b696a69e\ninit version: 949e6fa\nSecurity Options:\n seccomp\n  Profile: default\nKernel Version: 3.10.0-693.el7.x86_64\nOperating System: CentOS Linux 7 (Core)\nOSType: linux\nArchitecture: x86_64\nCPUs: 1\nTotal Memory: 976.3MiB\nName: xdhuxc\nID: JC2S:MKCL:G33Y:CTUN:T5EX:A4J2:HLOM:G4DC:FPX7:ERZL:OF7G:34HV\nDocker Root Dir: /var/lib/docker\nDebug Mode (client): false\nDebug Mode (server): false\nRegistry: https://index.docker.io/v1/\nLabels:\nExperimental: false\nInsecure Registries:\n 0.0.0.0/0\n 127.0.0.0/8\nLive Restore Enabled: false\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003edocker 安装时，会在 /sys/fs/cgroup/ 目录下的各个资源目录下生成以 docker 为名字的目录，即docker控制组。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc docker]# pwd\n/sys/fs/cgroup/cpu,cpuacct/docker\n[root@xdhuxc docker]# ls\ncgroup.clone_children  cgroup.procs  cpuacct.usage         cpu.cfs_period_us  cpu.rt_period_us   cpu.shares  notify_on_release\ncgroup.event_control   cpuacct.stat  cpuacct.usage_percpu  cpu.cfs_quota_us   cpu.rt_runtime_us  cpu.stat    tasks\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e默认情况下，docker 每启动一个容器时，会在 /sys/fs/cgroup/cpu/docker/ 目录下，生成以 容器ID 为名字的目录，即当前容器的控制组，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker run -d --name=zookeeper zookeeper:latest\nc86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a\n[root@xdhuxc ~]# cd /sys/fs/cgroup/cpu/docker\n[root@xdhuxc docker]# ll\ntotal 0\ndrwxr-xr-x 2 root root 0 Jul 15 10:03 c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.clone_children\n--w--w--w- 1 root root 0 Jul 15 09:39 cgroup.event_control\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.procs\n-r--r--r-- 1 root root 0 Jul 15 09:39 cpuacct.stat\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpuacct.usage\n-r--r--r-- 1 root root 0 Jul 15 09:39 cpuacct.usage_percpu\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.cfs_period_us\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.cfs_quota_us\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.rt_period_us\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.rt_runtime_us\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.shares\n-r--r--r-- 1 root root 0 Jul 15 09:39 cpu.stat\n-rw-r--r-- 1 root root 0 Jul 15 09:39 notify_on_release\n-rw-r--r-- 1 root root 0 Jul 15 09:39 tasks\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时，cpu.cfs_quota_us 的内容为：-1，表示默认情况下并没有限制容器的 CPU 使用。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a]# pwd\n/sys/fs/cgroup/cpu/docker/c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a\n[root@xdhuxc c86c1335154d50b69a1133ef92baf56705bfdf76e7f2b7ed5d58279c764c1b9a]# cat cpu.cfs_quota_us \n-1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在容器被 stopped 后，该目录会被删除。\u003c/p\u003e\n\u003cp\u003e接下来创建一个带资源限制的 zookeeper 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc docker]# pwd\n/sys/fs/cgroup/cpu,cpuacct/docker\n[root@xdhuxc docker]# docker run -d --name zookeeper --cpu-quota 25000 --cpu-period 150000 --cpu-shares 30 zookeeper:latest\n61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6\n[root@xdhuxc docker]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS              PORTS                          NAMES\n61952fccaff9        zookeeper:latest    \u0026#34;/docker-entrypoint.…\u0026#34;   About a minute ago   Up About a minute   2181/tcp, 2888/tcp, 3888/tcp   zookeeper\n[root@xdhuxc docker]# ll\ntotal 0\ndrwxr-xr-x 2 root root 0 Jul 15 10:20 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.clone_children\n--w--w--w- 1 root root 0 Jul 15 09:39 cgroup.event_control\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.procs\n-r--r--r-- 1 root root 0 Jul 15 09:39 cpuacct.stat\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpuacct.usage\n-r--r--r-- 1 root root 0 Jul 15 09:39 cpuacct.usage_percpu\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.cfs_period_us\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.cfs_quota_us\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.rt_period_us\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.rt_runtime_us\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cpu.shares\n-r--r--r-- 1 root root 0 Jul 15 09:39 cpu.stat\n-rw-r--r-- 1 root root 0 Jul 15 09:39 notify_on_release\n-rw-r--r-- 1 root root 0 Jul 15 09:39 tasks\n[root@xdhuxc docker]# cd 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6/\n[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# ls\ncgroup.clone_children  cgroup.procs  cpuacct.usage         cpu.cfs_period_us  cpu.rt_period_us   cpu.shares  notify_on_release\ncgroup.event_control   cpuacct.stat  cpuacct.usage_percpu  cpu.cfs_quota_us   cpu.rt_runtime_us  cpu.stat    tasks\n[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# cat cpu.cfs_quota_us \n25000\n[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# cat cpu.cfs_period_us \n150000\n[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# cat cpu.shares \n30\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e以上值正是我们在启动容器时设置的资源值。\u003c/p\u003e\n\u003cp\u003edocker 会将容器中的进程的 ID 加入到各个资源对应的 tasks 文件中。\n在宿主机上查看进程\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc docker]# ps -ef | grep -v grep | grep zookeeper\nxdhuxc     2890   2879  0 10:20 ?        00:00:00 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003etasks 文件中的内容为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc 61952fccaff947c1fab3f724e349cd8c3562b92d74e053826830b3d99a3060b6]# cat tasks \n2890                # 正是宿主机上zookeeper进程的PID\n2925\n2926\n2927\n2928\n2929\n2930\n2931\n2932\n2933\n2934\n2935\n2936\n2937\n2938\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e表明 docker 是通过上面的机制来使用 cgroup 对容器的 CPU 使用进行限制的。\u003c/p\u003e\n\u003cp\u003e类似的，可以通过 docker run 中 mem 相关的参数对容器的内存使用进行限制：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e    --kernel-memory bytes            Kernel memory limit\n    --cpuset-mems string             MEMs in which to allow execution (0-3, 0,1)\n-m, --memory bytes                   Memory limit\n    --memory-reservation bytes       Memory soft limit\n    --memory-swap bytes              Swap limit equal to memory plus swap: \u0026#39;-1\u0026#39; to enable unlimited swap\n    --memory-swappiness int          Tune container memory swappiness (0 to 100) (default -1)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e例如，运行如下命令\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e40\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e41\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e42\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e43\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e44\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e45\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e46\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e47\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e48\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e49\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e50\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e51\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e52\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e53\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e54\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e55\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e56\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e57\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e58\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e59\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e60\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e61\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e62\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e63\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e64\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e65\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e66\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e67\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e68\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e69\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e70\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e71\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e72\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e73\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e74\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e75\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e76\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e77\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e78\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e79\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e80\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e81\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e82\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e83\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e84\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e85\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc docker]# docker run -d --name zookeeper --blkio-weight 100 --memory 50M --cpu-quota 25000 --cpu-period 150000 --cpu-shares 30 zookeeper:latest\nbf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n[root@xdhuxc docker]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                          NAMES\nbf59ef7c32f2        zookeeper:latest    \u0026#34;/docker-entrypoint.…\u0026#34;   4 seconds ago       Up 3 seconds        2181/tcp, 2888/tcp, 3888/tcp   zookeeper\n[root@xdhuxc docker]# ps -ef | grep -v grep | grep zookeeper\nxdhuxc     3101   3090  0 10:53 ?        00:00:02 /usr/lib/jvm/java-1.8-openjdk/jre/bin/java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /zookeeper-3.4.12/bin/../build/classes:/zookeeper-3.4.12/bin/../build/lib/*.jar:/zookeeper-3.4.12/bin/../lib/slf4j-log4j12-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/slf4j-api-1.7.25.jar:/zookeeper-3.4.12/bin/../lib/netty-3.10.6.Final.jar:/zookeeper-3.4.12/bin/../lib/log4j-1.2.17.jar:/zookeeper-3.4.12/bin/../lib/jline-0.9.94.jar:/zookeeper-3.4.12/bin/../lib/audience-annotations-0.5.0.jar:/zookeeper-3.4.12/bin/../zookeeper-3.4.12.jar:/zookeeper-3.4.12/bin/../src/java/lib/*.jar:/conf: -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /conf/zoo.cfg\n[root@xdhuxc docker]# ps -T -p 3101                # 查看进程ID为3101的进程中的线程\n   PID   SPID TTY          TIME CMD\n  3101   3101 ?        00:00:00 java\n  3101   3143 ?        00:00:00 java\n  3101   3144 ?        00:00:01 java\n  3101   3145 ?        00:00:00 java\n  3101   3146 ?        00:00:00 java\n  3101   3147 ?        00:00:00 java\n  3101   3148 ?        00:00:00 java\n  3101   3149 ?        00:00:00 java\n  3101   3150 ?        00:00:00 java\n  3101   3151 ?        00:00:00 java\n  3101   3152 ?        00:00:00 java\n  3101   3157 ?        00:00:00 java\n  3101   3158 ?        00:00:00 java\n  3101   3159 ?        00:00:00 java\n  3101   3160 ?        00:00:00 java\n[root@xdhuxc docker]# pwd\n/sys/fs/cgroup/memory/docker\n[root@xdhuxc docker]# ll\ntotal 0\ndrwxr-xr-x 2 root root 0 Jul 15 10:53 bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.clone_children\n--w--w--w- 1 root root 0 Jul 15 09:39 cgroup.event_control\n-rw-r--r-- 1 root root 0 Jul 15 09:39 cgroup.procs\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.failcnt\n--w------- 1 root root 0 Jul 15 09:39 memory.force_empty\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.failcnt\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.limit_in_bytes\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.max_usage_in_bytes\n-r--r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.slabinfo\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.tcp.failcnt\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.tcp.limit_in_bytes\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.tcp.max_usage_in_bytes\n-r--r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.tcp.usage_in_bytes\n-r--r--r-- 1 root root 0 Jul 15 09:39 memory.kmem.usage_in_bytes\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.limit_in_bytes\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.max_usage_in_bytes\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.memsw.failcnt\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.memsw.limit_in_bytes\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.memsw.max_usage_in_bytes\n-r--r--r-- 1 root root 0 Jul 15 09:39 memory.memsw.usage_in_bytes\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.move_charge_at_immigrate\n-r--r--r-- 1 root root 0 Jul 15 09:39 memory.numa_stat\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.oom_control\n---------- 1 root root 0 Jul 15 09:39 memory.pressure_level\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.soft_limit_in_bytes\n-r--r--r-- 1 root root 0 Jul 15 09:39 memory.stat\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.swappiness\n-r--r--r-- 1 root root 0 Jul 15 09:39 memory.usage_in_bytes\n-rw-r--r-- 1 root root 0 Jul 15 09:39 memory.use_hierarchy\n-rw-r--r-- 1 root root 0 Jul 15 09:39 notify_on_release\n-rw-r--r-- 1 root root 0 Jul 15 09:39 tasks\n[root@xdhuxc docker]# cd bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da/\n[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# ls\ncgroup.clone_children  memory.kmem.failcnt             memory.kmem.tcp.limit_in_bytes      memory.max_usage_in_bytes        memory.move_charge_at_immigrate  memory.stat            tasks\ncgroup.event_control   memory.kmem.limit_in_bytes      memory.kmem.tcp.max_usage_in_bytes  memory.memsw.failcnt             memory.numa_stat                 memory.swappiness\ncgroup.procs           memory.kmem.max_usage_in_bytes  memory.kmem.tcp.usage_in_bytes      memory.memsw.limit_in_bytes      memory.oom_control               memory.usage_in_bytes\nmemory.failcnt         memory.kmem.slabinfo            memory.kmem.usage_in_bytes          memory.memsw.max_usage_in_bytes  memory.pressure_level            memory.use_hierarchy\nmemory.force_empty     memory.kmem.tcp.failcnt         memory.limit_in_bytes               memory.memsw.usage_in_bytes      memory.soft_limit_in_bytes       notify_on_release\n[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# cat memory.limit_in_bytes \n52428800                   # 正是我们设置的50M的限额\n[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# cat tasks \n3101                       # zookeeper 容器进程在宿主机上的进程ID。\n3143                       # 以下是 zoookeeper 容器进程所起的线程ID。\n3144\n3145\n3146\n3147\n3148\n3149\n3150\n3151\n3152\n3157\n3158\n3159\n3160\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看 IO 限制\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# pwd\n/sys/fs/cgroup/blkio/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# ls\nblkio.io_merged                   blkio.io_serviced                blkio.leaf_weight                blkio.throttle.io_serviced        blkio.time_recursive   notify_on_release\nblkio.io_merged_recursive         blkio.io_serviced_recursive      blkio.leaf_weight_device         blkio.throttle.read_bps_device    blkio.weight           tasks\nblkio.io_queued                   blkio.io_service_time            blkio.reset_stats                blkio.throttle.read_iops_device   blkio.weight_device\nblkio.io_queued_recursive         blkio.io_service_time_recursive  blkio.sectors                    blkio.throttle.write_bps_device   cgroup.clone_children\nblkio.io_service_bytes            blkio.io_wait_time               blkio.sectors_recursive          blkio.throttle.write_iops_device  cgroup.event_control\nblkio.io_service_bytes_recursive  blkio.io_wait_time_recursive     blkio.throttle.io_service_bytes  blkio.time                        cgroup.procs\n[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# cat blkio.weight\n100                        # 正是我们设置的 blkio-weight 的值。\n[root@xdhuxc bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da]# cat tasks \n3101                       # zookeeper 容器进程在宿主机上的进程ID。\n3143                       # 以下是 zoookeeper 容器进程所起的线程ID。\n3144\n3145\n3146\n3147\n3148\n3149\n3150\n3151\n3152\n3157\n3158\n3159\n3160\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e目录 cpu 和 目录 cpuacct 为符号链接文件，都链接到了 cpu,cpuacct 目录。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc cgroup]# pwd\n/sys/fs/cgroup\n[root@xdhuxc cgroup]# ls\nblkio  cpu  cpuacct  cpu,cpuacct  cpuset  devices  freezer  hugetlb  memory  net_cls  perf_event  systemd\n[root@xdhuxc cgroup]# ll\ntotal 0\ndrwxr-xr-x 5 root root  0 Jul  4 08:52 blkio\nlrwxrwxrwx 1 root root 11 Jun  7 15:40 cpu -\u0026gt; cpu,cpuacct\nlrwxrwxrwx 1 root root 11 Jun  7 15:40 cpuacct -\u0026gt; cpu,cpuacct\ndrwxr-xr-x 5 root root  0 Jul  4 08:52 cpu,cpuacct\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 cpuset\ndrwxr-xr-x 5 root root  0 Jul  4 08:52 devices\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 freezer\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 hugetlb\ndrwxr-xr-x 5 root root  0 Jul  4 08:52 memory\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 net_cls\ndrwxr-xr-x 4 root root  0 Jun  7 15:40 perf_event\ndrwxr-xr-x 5 root root  0 Jul  4 08:52 systemd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e从上面也可以看出，目前 docker 已经几乎支持了所有的 cgroup 资源，可以限制容器对包括 network、device、cpu 和 memory 在内的资源的使用。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc cgroup]# pwd\n/sys/fs/cgroup\n[root@xdhuxc cgroup]# find ./ -name bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./blkio/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./cpuset/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./perf_event/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./freezer/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./cpu,cpuacct/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./pids/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./net_cls,net_prio/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./devices/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./hugetlb/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./memory/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n./systemd/docker/bf59ef7c32f2f9d3878e9ee9f013288031cbcfe9ec03d8efbb075c14150828da\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"限制容器的网络流量\"\u003e限制容器的网络流量\u003c/h4\u003e\n\u003cp\u003enet_cls 和 tc 一起使用可用于限制进程发出的网络包所使用的网络带宽。当使用 cgroup network controll net_cls 后，指定进程发出的所有网络包都会被加一个标签，然后就可以使用其他工具，比如 iptables 或者 traffic controller（TC）来根据网络包上的标签进行流量控制。\u003c/p\u003e\n\u003cp\u003e关于 classid，它的格式是：0xAAAABBBB，其中，AAAA 是十六进制的主 ID（major number），BBBB 是十六进制的次 ID（minor number）。因此，0x10001 表示 10:1 ，而 0x00010001 表示 1:!\u003c/p\u003e\n\u003cp\u003e1、首先，在宿主机的网卡 eth0 上做如下设置：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etc qdisc del dev eth0 root                         # 删除已有规则\ntc qdisc add dev eth0 root handle 10: htb default 12\ntc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil 1500kbit burst 10k    # 限速\ntc filter add dev eth0 protocol ip parent 10:0 prio 1 u32 match ip protocol 1 0xff flowid 10:1 # 只处理 ping 参数的网络包\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e其结果是：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e在网卡 eth0 上创建了一个 HTB root 队列，handle 10: 表示队列句柄，也就是 major number 为 10。\u003c/li\u003e\n\u003cli\u003e创建一个分类 10:1，限制它的发出网络带宽为 80 kbit（千比特每秒）\u003c/li\u003e\n\u003cli\u003e创建一个分类器，将 eth0 上 IP IMCP 协议的 major ID 为 10 的 prio 为 1 的网络流量都分类到 10:1 类别。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e2、启动容器\n容器启动后，其 init 进程在宿主机上的 PID 就被加入到 tasks 文件中了。\u003c/p\u003e\n\u003cp\u003e设置 net_cls classid：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eecho 0x100001 \u0026gt; net_cls.classid\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后在容器中启动一个 ping 进程，其 ID 也被加入到 tasks 文件中了。\u003c/p\u003e\n\u003cp\u003e3、查看 tc 情况\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etc -s -d class show dev eth0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可以看到 tc 已经在处理 ping 进程产生的数据包了。\u003c/p\u003e\n\u003cp\u003e再看一下 net_cls 和 ts 合作的限速效果：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e10488 bytes from 192.168.1.1: icmp_seq=35 ttl=63 time=12.7 ms\n10488 bytes from 192.168.1.1: icmp_seq=36 ttl=63 time=15.2 ms\n10488 bytes from 192.168.1.1: icmp_seq=37 ttl=63 time=4805 ms\n10488 bytes from 192.168.1.1: icmp_seq=38 ttl=63 time=9543 ms\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e其中，\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e后两条说使用的 tc class 规则是 tc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil 15kbit burst 10k\u003c/li\u003e\n\u003cli\u003e前两条所使用的 tc class 规则是 tc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil 10Mbit burst 10k\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"docker-run-命令中-cgroup-相关命令\"\u003edocker run 命令中 cgroup 相关命令\u003c/h4\u003e\n\u003cp\u003eblock IO:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e    --blkio-weight uint16            Block IO (relative weight), between 10 and 1000, or 0 to disable (default 0)\n    --blkio-weight-device list       Block IO weight (relative device weight) (default [])\n    --cgroup-parent string           Optional parent cgroup for the container\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eCPU:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e    --cpu-period int                 Limit CPU CFS (Completely Fair Scheduler) period\n    --cpu-quota int                  Limit CPU CFS (Completely Fair Scheduler) quota\n    --cpu-rt-period int              Limit CPU real-time period in microseconds\n    --cpu-rt-runtime int             Limit CPU real-time runtime in microseconds\n-c, --cpu-shares int                 CPU shares (relative weight)\n    --cpus decimal                   Number of CPUs\n    --cpuset-cpus string             CPUs in which to allow execution (0-3, 0,1)\n    --cpuset-mems string             MEMs in which to allow execution (0-3, 0,1)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eDevice:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e    --device list                    Add a host device to the container\n    --device-cgroup-rule list        Add a rule to the cgroup allowed devices list\n    --device-read-bps list           Limit read rate (bytes per second) from a device (default [])\n    --device-read-iops list          Limit read rate (IO per second) from a device (default [])\n    --device-write-bps list          Limit write rate (bytes per second) to a device (default [])\n    --device-write-iops list         Limit write rate (IO per second) to a device (default [])\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003eMemory:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e    --kernel-memory bytes            Kernel memory limit\n-m, --memory bytes                   Memory limit\n    --memory-reservation bytes       Memory soft limit\n    --memory-swap bytes              Swap limit equal to memory plus swap: \u0026#39;-1\u0026#39; to enable unlimited swap\n    --memory-swappiness int          Tune container memory swappiness (0 to 100) (default -1)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e注意：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ecgroup 只能限制 CPU 的使用，而不能保证 CPU 的使用。也就是说，使用 cpuset-cpus，可以让容器在指定的 CPU 或者核上运行，但是不能确保它独占这些CPU；cpu-shares 是个相对值，只有在 CPU 不够用的时候才起作用，也就是说，当 CPU 够用的时候，每个容器会分到足够的 CPU；当不够用的时候，会按照指定的比重在多个容器之间分配 CPU。\u003c/li\u003e\n\u003cli\u003e对内存来说，cgroup 可以限制容器使用内存的最大值，使用 -m 参数可以设置最多可以使用的内存。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e参考资料：\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.cnblogs.com/sammyliu/p/5878973.html\"\u003ehttp://www.cnblogs.com/sammyliu/p/5878973.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://coolshell.cn/articles/17049.html\"\u003ehttps://coolshell.cn/articles/17049.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/qinyushuang/article/details/46611709\"\u003ehttps://blog.csdn.net/qinyushuang/article/details/46611709\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.docker.com/config/containers/resource_constraints/#configure-the-realtime-scheduler\"\u003ehttps://docs.docker.com/config/containers/resource_constraints/#configure-the-realtime-scheduler\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.cnblogs.com/sammyliu/p/5886833.html\"\u003ehttp://www.cnblogs.com/sammyliu/p/5886833.html\u003c/a\u003e\u003c/p\u003e","date":1500336000,"description":"","fuzzywordcount":9900,"kind":"page","lang":"zh","lastmod":1503964800,"objectID":"12c59970bf41f5943732eb1d9af3706b","publishdate":1500336000,"relpermalink":"/posts/docker/docker-namespace-and-cgroup/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了 Linux 系统中命名空间和 cgroup 在 docker 中的使用。docker 容器使用 linux namespace 隔离容器中应用的运行环境，使用 cgroup 来限制应用运行时的资源，这是 docker 容器的基础。\u003c/p\u003e","tags":["Docker"],"title":"Linux 命名空间和 cgroup 在 docker 中的使用","url":"https://xdhuxc.github.io/posts/docker/docker-namespace-and-cgroup/","wordcount":9897},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了 Docker 的四种网络模式，在使用 docker 容器时，必须知道容器是以哪种网络模式启动，这对于访问容器中的应用和排查问题都非常重要。\u003c/p\u003e\n\u003ch3 id=\"单节点网络模式\"\u003e单节点网络模式\u003c/h3\u003e\n\u003ch4 id=\"bridge-网络模式\"\u003ebridge 网络模式\u003c/h4\u003e\n\u003cp\u003edocker 容器默认使用 bridge 网络模式，其特点如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e使用一个 linux 网桥，默认为 docker0。\u003c/li\u003e\n\u003cli\u003e使用 veth 对，一端在容器的网络命名空间中，一端在 docker0 上。\u003c/li\u003e\n\u003cli\u003e该模式下，docker 容器不具有一个公有 IP 地址，由于宿主机的 IP 地址与 veth 对的 IP 地址不在同一个网段内。\u003c/li\u003e\n\u003cli\u003edocker 采用 NAT 方式，将容器内部的服务监听的端口与宿主机的某一个端口进行绑定，使得宿主机以外的世界可以主动将网络报文发送至容器内部。\u003c/li\u003e\n\u003cli\u003e外界访问容器内的服务时，需要访问宿主机的 IP 地址以及宿主机的端口。\u003c/li\u003e\n\u003cli\u003eNAT 模式是在三层网络上的实现手段，因此肯定会影响网络的传输效率。\u003c/li\u003e\n\u003cli\u003e容器拥有独立、隔离的网络栈，让容器和宿主机以外的世界通过 NAT 建立通信。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/docker/docker-bridge.jpg\" width=\"800px\" height=\"300px\" /\u003e\n图1 · bridge 网络模式\n\u003c/center\u003e\n\u003cp\u003eiptables 的 SNTA 规则，使得从容器离开去外界的网络包的源IP地址被转换为 docker 宿主机的 IP 地址。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eChain POSTROUTING (policy ACCEPT)\ntarget     prot opt source               destination\nMASQUERADE  all  --  172.17.0.0/16        0.0.0.0/0\nMASQUERADE  all  --  172.18.0.0/16        0.0.0.0/0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"host-网络模式\"\u003ehost 网络模式\u003c/h4\u003e\n\u003cp\u003ehost 模式并没有为容器创建一个隔离的网络环境。之所以称之为 host 模式，是因为该模式下的 docker 容器会和宿主机共享同一个网络命名空间，因此 docker 容器可以和宿主机一样，使用宿主机的 eth0，实现和外界的通信。换句话说，docker 容器的 IP 地址即为宿主机 eth0 的 IP 地址。\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/docker/docker-host.jpg\" width=\"800px\" height=\"300px\" /\u003e\n图2 · host 网络模式\n\u003c/center\u003e\n\u003cp\u003e其特点如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e这种模式下的容器没有隔离的网络命名空间。\u003c/li\u003e\n\u003cli\u003e容器的 IP 地址就是 docker 宿主机的 IP 地址。\u003c/li\u003e\n\u003cli\u003e需要注意容器中服务的端口号不能与 docker 宿主机上已经使用的端口号相冲突。\u003c/li\u003e\n\u003cli\u003ehost 模式能够与其他模式共存。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"none-网络模式\"\u003enone 网络模式\u003c/h4\u003e\n\u003cp\u003e网络模式为 none，即不为 docker 容器构造任何网络环境。一旦 docker 容器采用了 none 网络模式，那么容器内部就只能使用 loopback 网络设备，不会再有其他的网络资源。docker 容器的 none 网络模式意味着不给该容器创建任何网络环境，容器只能使用 127.0.0.1 的本机网络。\u003c/p\u003e\n\u003ch4 id=\"macvlan\"\u003emacvlan\u003c/h4\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/CloudMan6/article/details/77186548\"\u003ehttps://blog.csdn.net/CloudMan6/article/details/77186548\u003c/a\u003e\n\u003ca href=\"https://blog.csdn.net/cloudman6/article/details/77338515\"\u003ehttps://blog.csdn.net/cloudman6/article/details/77338515\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/cloudvtech/article/details/79830887\"\u003ehttps://blog.csdn.net/cloudvtech/article/details/79830887\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://blog.csdn.net/cloudvtech/article/details/79830887\"\u003ehttps://blog.csdn.net/cloudvtech/article/details/79830887\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"多节点-docker-网络\"\u003e多节点 docker 网络\u003c/h3\u003e\n\u003cp\u003edocker 多节点网络模式可以分为两类：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003edocker\u003c/code\u003e 在 1.19 版本中引入的基于 \u003ccode\u003eVxLAN\u003c/code\u003e 的对跨节点网络的原生支持。\u003c/li\u003e\n\u003cli\u003e通过插件方式引入的第三方实现方案，比如 \u003ccode\u003eflannel\u003c/code\u003e，\u003ccode\u003ecalico\u003c/code\u003e 等。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"docker-原生-overlay-网络\"\u003edocker 原生 overlay 网络\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003edocker\u003c/code\u003e 1.19 版本中增加了对 \u003ccode\u003eoverlay\u003c/code\u003e 网络的原生支持。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003edocker\u003c/code\u003e 支持 \u003ccode\u003econsul\u003c/code\u003e，\u003ccode\u003eetcd\u003c/code\u003e和\u003ccode\u003ezookeeper\u003c/code\u003e 三种分布式的 key-value 存储。\u003c/p\u003e\n\u003cp\u003e其中，etcd 是一个高可用的分布式 key-value 存储系统，使用 etcd 的场景默认处理的数据都是控制数据，对于应用数据，只推荐数据量很小，但是更新、访问频繁的情况。\u003c/p\u003e\n\u003cp\u003e1、安装 etcd\n在 192.168.91.128 上使用如下命令启动 etcd 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    --net=host \\\n    --restart=always \\\n    -v /home/xdhuxc/etcd/data:/etcd-data \\\n    --name etcd \\\n    quay.io/coreos/etcd:v3.3 \\\n    /usr/local/bin/etcd \\\n    --data-dir=/etcd-data --name etcd-single \\\n    --initial-advertise-peer-urls http://192.168.91.128:2380 --listen-peer-urls http://0.0.0.0:2380 \\\n    --advertise-client-urls http://192.168.91.128:2379 --listen-client-urls http://0.0.0.0:2379 \\\n    --initial-cluster etcd-single=http://192.168.91.128:2380\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e修改 docker.service 文件，在 docker 启动参数中添加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e--cluster-store=etcd://192.168.91.128:2379\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e重启 docker 服务\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003esystemctl daemon-reload\nsystemctl restart docker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在 192.168.91.128 上创建一个 overlay 网络\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e38\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e39\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker network create --driver overlay net1            # 创建 overlay 网络 net1\n0398dac3d6513160ee035c7499332d7dcba8d2fa9643c45488996f628bf8ab91\n[root@xdhuxc ~]# docker network ls                                      # 查看当前docker网络\nNETWORK ID          NAME                DRIVER              SCOPE\nb9149e6e409b        bridge              bridge              local\nb9824657dbd0        host                host                local\n0398dac3d651        net1                overlay             global\n3b216a2f5426        none                null                local\n[root@xdhuxc ~]# docker inspect net1\n[\n    {\n        \u0026#34;Name\u0026#34;: \u0026#34;net1\u0026#34;,\n        \u0026#34;Id\u0026#34;: \u0026#34;0398dac3d6513160ee035c7499332d7dcba8d2fa9643c45488996f628bf8ab91\u0026#34;,\n        \u0026#34;Created\u0026#34;: \u0026#34;2018-07-15T14:14:48.744993416+08:00\u0026#34;,\n        \u0026#34;Scope\u0026#34;: \u0026#34;global\u0026#34;,\n        \u0026#34;Driver\u0026#34;: \u0026#34;overlay\u0026#34;,\n        \u0026#34;EnableIPv6\u0026#34;: false,\n        \u0026#34;IPAM\u0026#34;: {\n            \u0026#34;Driver\u0026#34;: \u0026#34;default\u0026#34;,\n            \u0026#34;Options\u0026#34;: {},\n            \u0026#34;Config\u0026#34;: [\n                {\n                    \u0026#34;Subnet\u0026#34;: \u0026#34;10.0.0.0/24\u0026#34;,\n                    \u0026#34;Gateway\u0026#34;: \u0026#34;10.0.0.1\u0026#34;\n                }\n            ]\n        },\n        \u0026#34;Internal\u0026#34;: false,\n        \u0026#34;Attachable\u0026#34;: false,\n        \u0026#34;Ingress\u0026#34;: false,\n        \u0026#34;ConfigFrom\u0026#34;: {\n            \u0026#34;Network\u0026#34;: \u0026#34;\u0026#34;\n        },\n        \u0026#34;ConfigOnly\u0026#34;: false,\n        \u0026#34;Containers\u0026#34;: {},\n        \u0026#34;Options\u0026#34;: {},\n        \u0026#34;Labels\u0026#34;: {}\n    }\n]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 192.168.91.130 上配置 etcd 信息到 docker.service 文件中，并重启 docker 服务。\u003c/p\u003e\n\u003cp\u003e在 192.168.91.130 上，我们也能看到这个网络 net1，这说明通过 etcd 的数据共享，网络数据已经是分布式的了，而不仅仅是本地的。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker network ls\nNETWORK ID          NAME                DRIVER              SCOPE\n2228e2935455        bridge              bridge              local\nbddcee3b802a        host                host                local\n0398dac3d651        net1                overlay             global\ne8a5f558ec10        none                null                local\n[root@xdhuxc ~]# docker inspect net1\n[\n    {\n        \u0026#34;Name\u0026#34;: \u0026#34;net1\u0026#34;,\n        \u0026#34;Id\u0026#34;: \u0026#34;0398dac3d6513160ee035c7499332d7dcba8d2fa9643c45488996f628bf8ab91\u0026#34;,\n        \u0026#34;Created\u0026#34;: \u0026#34;2018-07-15T14:14:48.744993416+08:00\u0026#34;,\n        \u0026#34;Scope\u0026#34;: \u0026#34;global\u0026#34;,\n        \u0026#34;Driver\u0026#34;: \u0026#34;overlay\u0026#34;,\n        \u0026#34;EnableIPv6\u0026#34;: false,\n        \u0026#34;IPAM\u0026#34;: {\n            \u0026#34;Driver\u0026#34;: \u0026#34;default\u0026#34;,\n            \u0026#34;Options\u0026#34;: {},\n            \u0026#34;Config\u0026#34;: [\n                {\n                    \u0026#34;Subnet\u0026#34;: \u0026#34;10.0.0.0/24\u0026#34;,\n                    \u0026#34;Gateway\u0026#34;: \u0026#34;10.0.0.1\u0026#34;\n                }\n            ]\n        },\n        \u0026#34;Internal\u0026#34;: false,\n        \u0026#34;Attachable\u0026#34;: false,\n        \u0026#34;Ingress\u0026#34;: false,\n        \u0026#34;ConfigFrom\u0026#34;: {\n            \u0026#34;Network\u0026#34;: \u0026#34;\u0026#34;\n        },\n        \u0026#34;ConfigOnly\u0026#34;: false,\n        \u0026#34;Containers\u0026#34;: {},\n        \u0026#34;Options\u0026#34;: {},\n        \u0026#34;Labels\u0026#34;: {}\n    }\n]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、在网络中创建容器\n在 192.168.91.128 上基于 net1 创建容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker run -d --name over-128 --network net1 zookeeper:latest\nadaa369ef21931f04625042949a2f757b9be94a9c67d611a2118e7fecf85f517\n[root@xdhuxc ~]# docker ps\nCONTAINER ID        IMAGE                      COMMAND                  CREATED             STATUS              PORTS                          NAMES\nadaa369ef219        zookeeper:latest           \u0026#34;/docker-entrypoint.…\u0026#34;   5 seconds ago       Up 3 seconds        2181/tcp, 2888/tcp, 3888/tcp   over-128\n609e50616c43        quay.io/coreos/etcd:v3.3   \u0026#34;/usr/local/bin/etcd…\u0026#34;   13 minutes ago      Up 9 minutes                                       etcd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# ip addr\n1: lo: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eLOOPBACK\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens33: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    link/ether 00:0c:29:25:e5:b2 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.91.128/24 brd 192.168.91.255 scope global dynamic ens33\n       valid_lft 1785sec preferred_lft 1785sec\n    inet6 fe80::63c8:5192:716b:79be/64 scope link\n       valid_lft forever preferred_lft forever\n4: docker0: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eNO-CARRIER\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue state DOWN\n    link/ether 02:42:54:4e:84:2b brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n9: docker_gwbridge: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue state UP           # 用于 NAT 网络\n    link/ether 02:42:a4:44:86:a9 brd ff:ff:ff:ff:ff:ff\n    inet 172.18.0.1/16 brd 172.18.255.255 scope global docker_gwbridge\n       valid_lft forever preferred_lft forever\n    inet6 fe80::42:a4ff:fe44:86a9/64 scope link\n       valid_lft forever preferred_lft forever\n11: veth76cddb3@if10: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue master docker_gwbridge state UP\n    link/ether c2:e5:c6:e7:dc:aa brd ff:ff:ff:ff:ff:ff link-netnsid 1\n    inet6 fe80::c0e5:c6ff:fee7:dcaa/64 scope link\n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003edocker run -d --name over-130 --network net1 zookeeper:latest\n在 192.168.91.130 上基于 net1 创建容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker run -d --name over-130 --network net1 zookeeper:latest\n516157dec4d555cbdf96783e37a27fa32566b5bcaa375f99aee1a37f7d7e7d33\n[root@xdhuxc ~]# docker ps\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                          NAMES\n516157dec4d5        zookeeper:latest    \u0026#34;/docker-entrypoint.…\u0026#34;   5 seconds ago       Up 3 seconds        2181/tcp, 2888/tcp, 3888/tcp   over-130\n[root@xdhuxc ~]#\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# ip addr\n1: lo: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eLOOPBACK\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: ens38: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    link/ether 00:0c:29:58:10:3c brd ff:ff:ff:ff:ff:ff\n    inet 192.168.91.130/24 brd 192.168.91.255 scope global dynamic ens38\n       valid_lft 1310sec preferred_lft 1310sec\n    inet6 fe80::43cc:6988:179b:cd2d/64 scope link\n       valid_lft forever preferred_lft forever\n3: docker0: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eNO-CARRIER\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue state DOWN\n    link/ether 02:42:fa:be:c4:e2 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::42:faff:febe:c4e2/64 scope link\n       valid_lft forever preferred_lft forever\n22: docker_gwbridge: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue state UP        # 用于 NAT 网络\n    link/ether 02:42:27:27:a8:1e brd ff:ff:ff:ff:ff:ff\n    inet 172.18.0.1/16 brd 172.18.255.255 scope global docker_gwbridge\n       valid_lft forever preferred_lft forever\n    inet6 fe80::42:27ff:fe27:a81e/64 scope link\n       valid_lft forever preferred_lft forever\n24: veth06aa5aa@if23: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue master docker_gwbridge state UP\n    link/ether ce:53:38:eb:84:ba brd ff:ff:ff:ff:ff:ff link-netnsid 1\n    inet6 fe80::cc53:38ff:feeb:84ba/64 scope link\n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e进入容器 over-128 中，\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker exec -it over-128 bash\nbash-4.4# ip addr\n1: lo: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eLOOPBACK\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n7: eth0@if8: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eM-DOWN\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1450 qdisc noqueue state UP\n    link/ether 02:42:0a:00:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 10.0.0.2/24 brd 10.0.0.255 scope global eth0\n       valid_lft forever preferred_lft forever\n10: eth1@if11: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eM-DOWN\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue state UP\n    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth1\n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e进入 容器 over-130 中，发现它有三块网卡：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# docker exec -it over-130 bash\nbash-4.4# ip addr\n1: lo: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eLOOPBACK\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n20: eth0@if21: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eM-DOWN\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1450 qdisc noqueue state UP\n    link/ether 02:42:0a:00:00:03 brd ff:ff:ff:ff:ff:ff\n    inet 10.0.0.3/24 brd 10.0.0.255 scope global eth0\n       valid_lft forever preferred_lft forever\n23: eth1@if24: \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eBROADCAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eMULTICAST\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eUP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eLOWER_UP\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\u003cspan class=\"na\"\u003eM-DOWN\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e mtu 1500 qdisc noqueue state UP\n    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth1\n       valid_lft forever preferred_lft forever\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e其中 \u003ccode\u003eeth1@if24\u003c/code\u003e 的网络是一个内部的网段，走的还是普通的NAT模式。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eeth0@if21\u003c/code\u003e 是 \u003ccode\u003eoverlay\u003c/code\u003e 网段上分配的IP地址，它走的是 \u003ccode\u003eoverlay\u003c/code\u003e 网络，其 \u003ccode\u003eMTU\u003c/code\u003e 是1450，而不是1500。\u003c/p\u003e\n\u003cp\u003e进一步查看它的路由表，会发现只有同一个 \u003ccode\u003eoverlay\u003c/code\u003e 网络中的容器之间的通信才会通过 \u003ccode\u003eeth0@if21\u003c/code\u003e，其他所有通信还是走的 \u003ccode\u003eeth1\u003c/code\u003e。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ebash-4.4# route -n\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\n0.0.0.0         172.18.0.1      0.0.0.0         UG    0      0        0 eth1\n10.0.0.0        0.0.0.0         255.255.255.0   U     0      0        0 eth0\n172.18.0.0      0.0.0.0         255.255.0.0     U     0      0        0 eth1\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时的网络拓扑图为：\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"/image/docker/docker-network-bridge.jpg\" width=\"800px\" height=\"300px\" /\u003e\n图3 · overlay 网络模式\n\u003c/center\u003e\n\u003cp\u003e可见：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edocker 在每个节点上创建了两个 linux 网桥，一个用于 overlay 网络（ov-000100-1de98），一个用于非 overlay 的 NAT 网络（docker_gwbridge）。\u003c/li\u003e\n\u003cli\u003e容器内的到 overlay 网络的其它容器的网络流量走 overlay 网卡，即eth0@if21，其它网络流量走 NAT 网卡，即eth1@if24。\u003c/li\u003e\n\u003cli\u003e当前 docker 创建 vxlan 隧道的ID范围为：256~1000，因而最多可以创建745个网络。因此，本例中的这个 vxlan 隧道使用的 ID 是256。\u003c/li\u003e\n\u003cli\u003edocker vxlan 驱动使用 4789 UDP 端口。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc ~]# netstat -nlup\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\nudp        0      0 0.0.0.0:68              0.0.0.0:*                           3663/dhclient\nudp        0      0 0.0.0.0:4789            0.0.0.0:*                           -\nudp        0      0 0.0.0.0:59600           0.0.0.0:*                           3663/dhclient\nudp6       0      0 :::31602                :::*                                3663/dhclient\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cul\u003e\n\u003cli\u003eoverlay 网络模型底层需要类似 consul 或 etcd 的 KV 存储系统进行消息同步。\u003c/li\u003e\n\u003cli\u003edocker overlay 不使用多播。\u003c/li\u003e\n\u003cli\u003eoverlay 网络中的容器处于一个虚拟的大二层网络中。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e从 \u003ccode\u003eover-128\u003c/code\u003e ping \u003ccode\u003eover-130\u003c/code\u003e 不通，升级内核到4.20以上就可以了。\u003c/p\u003e\n\u003ch3 id=\"参考资料\"\u003e参考资料\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"http://www.cnblogs.com/sammyliu/p/5894191.html\"\u003ehttp://www.cnblogs.com/sammyliu/p/5894191.html\u003c/a\u003e\u003c/p\u003e","date":1500076800,"description":"","fuzzywordcount":2800,"kind":"page","lang":"zh","lastmod":1503619200,"objectID":"ed49397910f453644fce58fdd98699de","publishdate":1500076800,"relpermalink":"/posts/docker/docker-network-mode/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了 Docker 的四种网络模式，在使用 docker 容器时，必须知道容器是以哪种网络模式启动，这对于访问容器中的应用和排查问题都非常重要。\u003c/p\u003e","tags":["Docker"],"title":"docker 容器网络模式总结","url":"https://xdhuxc.github.io/posts/docker/docker-network-mode/","wordcount":2768},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了 Docker Registry 的搭建和配置。\u003c/p\u003e\n\u003ch3 id=\"搭建基本的-docker-registry\"\u003e搭建基本的 Docker Registry\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e基于 Docker 镜像方式安装Docker Registry V2。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e本机为 CentOS 7 虚拟机，Minimal模式安装，IP地址为：192.168.91.128。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e开发端也为 CentOS 7 虚拟机，Minimal模式安装，IP地址为：192.168.91.129。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"安装-docker\"\u003e安装 docker\u003c/h4\u003e\n\u003cp\u003e依次执行如下命令，安装并启动 Docker\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y docker\nsystemctl enable docker\nsystemctl start docker\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"获取最新版本的-docker-registry-容器\"\u003e获取最新版本的 Docker Registry 容器\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003e可去 \u003ca href=\"https://store.docker.com/images/registry/plans/75b297cc-0ad7-4ccd-8e80-9a30e72ace7e?tab=tags\"\u003e官网\u003c/a\u003e 查找最新的版本号\n直接使用 docker 命令去官方公有镜像仓库中拉取\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull registry:2.5.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"运行容器\"\u003e运行容器\u003c/h4\u003e\n\u003cblockquote\u003e\n\u003cp\u003eV1 Registry 的仓库目录是：/tmp/registry\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eV2 Registry 的仓库目录是：/var/lib/registry\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e使用如下命令运行容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d -p 5000:5000 --restart=always -v /opt/registry:/var/lib/registry  --name=registry registry:2.5.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"访问-docker-registry\"\u003e访问 Docker Registry\u003c/h4\u003e\n\u003cp\u003e使用如下命令访问 Docker Registry\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecurl http://192.168.91.128:5000/v2/_catalog\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e如果看到类似如下的JSON格式数据，说明Docker Registry已经运行起来了。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\u0026#34;repositories\u0026#34;:[]}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"推送镜像\"\u003e推送镜像\u003c/h4\u003e\n\u003cp\u003e推送镜像时报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker push 192.168.91.128:5000/busybox:latest\nThe push refers to a repository [192.168.91.128:5000/busybox]\n6a749002dd6a: Retrying in 1 second \nreceived unexpected HTTP status: 500 Internal Server Error\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 \u003ccode\u003edocker logs registry\u003c/code\u003e 命令查看日志，发现没有创建目录的权限\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003etime=\u0026#34;2017-10-30T14:14:01Z\u0026#34; level=error msg=\u0026#34;response completed with error\u0026#34; err.code=unknown err.detail=\u0026#34;filesystem: mkdir /var/lib/registry/docker: permission denied\u0026#34; err.message=\u0026#34;unknown error\u0026#34; go.version=go1.6.4 \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：在启动命令中加入 \u003ccode\u003e--privileged=true\u003c/code\u003e 参数，即使用如下命令启动容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d --privileged=true -p 5000:5000 --restart=always -v /opt/registry:/var/lib/registry  --name=registry registry:2.5.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时，可以正确地上传镜像了\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker push 192.168.91.128:5000/busybox:latest\nThe push refers to a repository [192.168.91.128:5000/busybox]\n0271b8eebde3: Pushed \nlatest: digest: sha256:91ef6c1c52b166be02645b8efee30d1ee65362024f7da41c404681561734c465 size: 527\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"拉取镜像\"\u003e拉取镜像\u003c/h4\u003e\n\u003cp\u003e直接使用 \u003ccode\u003edocker pull\u003c/code\u003e 命令拉取镜像即可，如下所示：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost registry]# docker pull 192.168.91.128:5000/busybox:latest\nTrying to pull repository 192.168.91.128:5000/busybox ... \nlatest: Pulling from 192.168.91.128:5000/busybox\n03b1be98f3f9: Pull complete \nDigest: sha256:030fcb92e1487b18c974784dcc110a93147c9fc402188370fbfd17efabffc6af\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"带权限访问-docker-registry\"\u003e带权限访问 Docker Registry\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e控制registry的使用权限，使其只有在登录用户名和密码之后才能使用。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、创建用户名和密码\u003c/p\u003e\n\u003cp\u003e可以通过 \u003ccode\u003ehtpasswd\u003c/code\u003e 来生成 \u003ccode\u003eregistry\u003c/code\u003e 的用户名和密码文件\u003c/p\u003e\n\u003cp\u003e依次执行如下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# mkdir /etc/registry/auth/\n[root@store registry]# docker run --entrypoint htpasswd registry:2.5.2 -Bbn admin Admin123 \u0026gt;\u0026gt; /etc/registry/auth/htpasswd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e生成了存储用户名和密码的文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store auth]# pwd\n/etc/registry/auth\n[root@store auth]# ls\nhtpasswd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、启动Registry容器\u003c/p\u003e\n\u003cp\u003e现在使用如下命令启动容器（注意命令参数之间的空格）\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -p 5000:5000 \\\n    --restart=always \\\n    --name=registry \\\n    -v /etc/registry/auth/:/auth/ \\\n    -e \u0026#34;REGISTRY_AUTH=htpasswd\u0026#34; \\\n    -e \u0026#34;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm\u0026#34; \\\n    -e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \\ \u003cspan class=\"ni\"\u003e#此处为相对路径\u003c/span\u003e\n    -v /opt/registry/:/var/lib/registry/ \\\n    registry:2.5.2  \n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时，访问仓库时出现错误，需要登录才能访问\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store ~]# curl http://192.168.91.128:5000/v2/_catalog|python -m json.tool\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   134  100   134    0     0  52755      0 --:--:-- --:--:-- --:--:-- 67000\n{\n    \u0026#34;errors\u0026#34;: [\n        {\n            \u0026#34;code\u0026#34;: \u0026#34;UNAUTHORIZED\u0026#34;,\n            \u0026#34;detail\u0026#34;: [\n                {\n                    \u0026#34;Action\u0026#34;: \u0026#34;*\u0026#34;,\n                    \u0026#34;Name\u0026#34;: \u0026#34;catalog\u0026#34;,\n                    \u0026#34;Type\u0026#34;: \u0026#34;registry\u0026#34;\n                }\n            ],\n            \u0026#34;message\u0026#34;: \u0026#34;authentication required\u0026#34;\n        }\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e没有登录时，push时提示如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store ~]# docker push 192.168.91.128:5000/busybox:latest\nThe push refers to a repository [192.168.91.128:5000/busybox]\n\nno basic auth credentials\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e没有登录时，pull时提示如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store ~]# docker pull 192.168.91.128:5000/busybox:latest\nTrying to pull repository 192.168.91.128:5000/busybox ... \nPulling repository 192.168.91.128:5000/busybox\nError: image busybox:latest not found\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e登陆后即可进行正常的 \u003ccode\u003epush\u003c/code\u003e 和 \u003ccode\u003epull\u003c/code\u003e 操作\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store ~]# docker login 192.168.91.128:5000\nUsername: admin\nPassword: \nLogin Succeeded\n[root@store ~]# docker pull 192.168.91.128:5000/busybox:latest\nTrying to pull repository 192.168.91.128:5000/busybox ... \nlatest: Pulling from 192.168.91.128:5000/busybox\n03b1be98f3f9: Pull complete \nDigest: sha256:030fcb92e1487b18c974784dcc110a93147c9fc402188370fbfd17efabffc6af\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e访问镜像仓库信息时，使用如下命令：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e也可以这样使用：\u003ccode\u003ecurl -u admin:Admin123 http://192.168.91.128:5000/v2/_catalog|python -m json.tool\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store ~]# curl --user admin:Admin123 http://192.168.91.128:5000/v2/_catalog|python -m json.tool\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    29  100    29    0     0   4969      0 --:--:-- --:--:-- --:--:--  5800\n{\n    \u0026#34;repositories\u0026#34;: [\n        \u0026#34;busybox\u0026#34;\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e也可以通过宿主机浏览器访问镜像仓库，在弹出的认证对话框中输入正确的用户名和密码，登陆后即可看到所需信息。\u003c/p\u003e\n\u003ch3 id=\"使用-api-访问docker-registry\"\u003e使用 API 访问Docker Registry\u003c/h3\u003e\n\u003cp\u003e1、查询注册服务器中的仓库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl http://192.168.91.128:5000/v2/_catalog\n{\u0026#34;repositories\u0026#34;:[\u0026#34;busybox\u0026#34;,\u0026#34;nginx\u0026#34;,\u0026#34;phpmyadmin\u0026#34;]}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查询某个仓库中镜像的版本\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl http://192.168.91.128:5000/v2/busybox/tags/list\n{\u0026#34;name\u0026#34;:\u0026#34;busybox\u0026#34;,\u0026#34;tags\u0026#34;:[\u0026#34;latest\u0026#34;,\u0026#34;1.2.1\u0026#34;]}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"多用户-docker-仓库创建安全认证和应用httpblogcsdnnetdream_anarticledetails58005324\"\u003e\u003ca href=\"http://blog.csdn.net/dream_an/article/details/58005324\"\u003e多用户 Docker 仓库创建安全认证和应用\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e1、安装 docker，下载 registry 镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eyum install -y docker\nsystemctl start docker\ndocker pull registry:2.5.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、在服务器端创建自定义签发的CA证书\n执行以下命令：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p /etc/registry/certs \u003cspan class=\"err\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e openssl req \\\n    -newkey rsa:4096 -nodes -sha256 -keyout /etc/registry/certs/domain.key \\\n    -x509 -days 365 -out /etc/registry/certs/domain.crt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e填写如下信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eCountry Name (2 letter code) [XX]:CN\nState or Province Name (full name) []:ShanxiSheng\nLocality Name (eg, city) [Default City]:ShangluoShi\nOrganization Name (eg, company) [Default Company Ltd]:Xdhuxc\nOrganizational Unit Name (eg, section) []:Xdhuxc\nCommon Name (eg, your name or your server\u0026#39;s hostname) []:store.xdhuxc.com\nEmail Address []:xdhuxc@163.com\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e在 \u003ccode\u003e/etc/registry/certs\u003c/code\u003e 目录下生成了自定义签发的CA证书\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store certs]# pwd\n/etc/registry/certs\n[root@store certs]# ls\ndomain.crt  domain.key\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、添加多用户信息，创建仓库的使用者用户名和密码\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e添加多个 docker 仓库使用者的用户名和其密码\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run --entrypoint htpasswd registry:2.5.2 -Bbn admin Admin123 \u0026gt;\u0026gt; /etc/registry/auth/htpasswd\ndocker run --entrypoint htpasswd registry:2.5.2 -Bbn root Root123 \u0026gt;\u0026gt; /etc/registry/auth/htpasswd\ndocker run --entrypoint htpasswd registry:2.5.2 -Bbn xdhuxc Xdhuxc123 \u0026gt;\u0026gt; /etc/registry/auth/htpasswd\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、启动 Docker Registry 容器\n使用如下命令启动 Docker Registry 容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    -p 5000:5000 \\\n    --restart=always \\\n    --name registry \\\n    -v /etc/registry/auth:/auth \\\n    -e \u0026#34;REGISTRY_AUTH=htpasswd\u0026#34; \\\n    -e \u0026#34;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm\u0026#34; \\\n    -e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \\\n    -v /etc/registry/certs:/certs \\\n    -e REGISTRY_HTTP_TLS_CERTIFICATE=/certs/domain.crt \\\n    -e REGISTRY_HTTP_TLS_KEY=/certs/domain.key \\\n    registry:2.5.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、通过 sftp 或者 scp 将远程仓库服务器端的 domain.crt 复制到开发端指定的位置\u003c/p\u003e\n\u003cp\u003e对于 Ubuntu 系统\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003emkdir -p ~/certs.d/store.xdhuxc.com:5000\ncp ~/domain.crt /etc/docker/certs.d/store.xdhuxc.com:5000/ca.crt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e对于 Redhat 系统\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ecp ~/domain.crt /usr/local/share/ca-certificates/store.xdhuxc.com.crt\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e对于 CentOS 系统\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# scp root@192.168.91.128:/etc/registry/certs/domain.crt /etc/pki/ca-trust/source/anchors/\nThe authenticity of host \u0026#39;192.168.91.128 (192.168.91.128)\u0026#39; can\u0026#39;t be established.\nECDSA key fingerprint is SHA256:Db3KNpRrupfzz8n9hvx0ZqCKMVI17+1oHGzWxT6gShA.\nECDSA key fingerprint is MD5:4d:dc:06:bd:da:a9:fa:e4:ba:f9:02:9e:bd:7e:79:a1.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added \u0026#39;192.168.91.128\u0026#39; (ECDSA) to the list of known hosts.\nroot@192.168.91.128\u0026#39;s password: \ndomain.crt                                                                   100% 2163     1.7MB/s   00:00    \n[root@localhost ~]# /bin/update-ca-trust extract\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# scp root@192.168.91.128:/etc/registry/certs/domain.crt /etc/docker/certs.d/\nroot@192.168.91.128\u0026#39;s password: \ndomain.crt                                                                                                                               100% 2163   746.3KB/s   00:00    \n[root@localhost ~]# /bin/update-ca-trust extract\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、从官网下载镜像，重新标记，推送至私有仓库\u003c/p\u003e\n\u003cp\u003e1）从dockerhub下载镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker pull alpine\nUsing default tag: latest\nTrying to pull repository docker.io/library/alpine ... \nlatest: Pulling from docker.io/library/alpine\nb56ae66c2937: Pull complete \nDigest: sha256:b40e202395eaec699f2d0c5e01e6d6cb8e6b57d77c0e0221600cf0b5940cf3ab\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2）重新标记镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker tag docker.io/alpine:latest store.xdhuxc.com:5000/alpine:1.1.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3）推送至私有仓库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker push store.xdhuxc.com:5000/alpine:1.1.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e此时，终端显示如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eThe push refers to a repository [store.xdhuxc.com:5000/alpine]\n\nno basic auth credentials\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、登录私有的Docker Registry\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker login -u admin -p Admin123 store.xdhuxc.com:5000\nLogin Succeeded\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、此时，可以推送镜像至私有仓库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker push store.xdhuxc.com:5000/alpine:1.1.0\nThe push refers to a repository [store.xdhuxc.com:5000/alpine]\n2aebd096e0e2: Layer already exists \n1.1.0: digest: sha256:a09e6318d74f23fe68bad84259fedf5e6ce02c38537336419ee5e9abe10aa2af size: 528\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e6、也可以从仓库中拉取镜像到本地\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker pull store.xdhuxc.com:5000/alpine:1.1.0\nTrying to pull repository store.xdhuxc.com:5000/alpine ... \n1.1.0: Pulling from store.xdhuxc.com:5000/alpine\nb56ae66c2937: Pull complete \nDigest: sha256:a09e6318d74f23fe68bad84259fedf5e6ce02c38537336419ee5e9abe10aa2af\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e退出登陆后，就不能再拉取私有仓库中的镜像了\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# docker logout store.xdhuxc.com:5000\nRemove login credentials for store.xdhuxc.com:5000\n[root@localhost ~]# docker pull store.xdhuxc.com:5000/alpine:1.1.0\nTrying to pull repository store.xdhuxc.com:5000/alpine ... \nPulling repository store.xdhuxc.com:5000/alpine\nError: image alpine:1.1.0 not found\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e7、使用 HTTP API V2 在开发端访问镜像仓库\n没有附加登录用户信息时，终端输出如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost certs.d]# curl https://store.xdhuxc.com:5000/v2/alpine/tags/list | python -m json.tool\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   138  100   138    0     0    990      0 --:--:-- --:--:-- --:--:--  1000\n{\n    \u0026#34;errors\u0026#34;: [\n        {\n            \u0026#34;code\u0026#34;: \u0026#34;UNAUTHORIZED\u0026#34;,\n            \u0026#34;detail\u0026#34;: [\n                {\n                    \u0026#34;Action\u0026#34;: \u0026#34;pull\u0026#34;,\n                    \u0026#34;Name\u0026#34;: \u0026#34;alpine\u0026#34;,\n                    \u0026#34;Type\u0026#34;: \u0026#34;repository\u0026#34;\n                }\n            ],\n            \u0026#34;message\u0026#34;: \u0026#34;authentication required\u0026#34;\n        }\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用 HTTP 协议和 HTTPS 协议访问镜像仓库，结果是不同的\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# cat /etc/docker/daemon.json \n{}\n[root@localhost ~]# curl -u admin:Admin123 http://store.xdhuxc.com:5000/v2/_catalog | python -m json.tool\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    14    0    14    0     0   1722      0 --:--:-- --:--:-- --:--:--  2000\nNo JSON object could be decoded\n[root@localhost ~]# curl -u admin:Admin123 https://store.xdhuxc.com:5000/v2/_catalog | python -m json.tool\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    28  100    28    0     0    193      0 --:--:-- --:--:-- --:--:--   194\n{\n    \u0026#34;repositories\u0026#34;: [\n        \u0026#34;alpine\u0026#34;\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e附带登录用户信息访问时，可以正确访问。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl -u admin:Admin123 https://store.xdhuxc.com:5000/v2/_catalog|python -m json.tool\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    28  100    28    0     0    196      0 --:--:-- --:--:-- --:--:--   198\n{\n    \u0026#34;repositories\u0026#34;: [\n        \u0026#34;alpine\u0026#34;\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e查看镜像信息\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost ~]# curl -u admin:Admin123 https://store.xdhuxc.com:5000/v2/alpine/tags/list | python -m json.tool\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    35  100    35    0     0    282      0 --:--:-- --:--:-- --:--:--   284\n{\n    \u0026#34;name\u0026#34;: \u0026#34;alpine\u0026#34;,\n    \u0026#34;tags\u0026#34;: [\n        \u0026#34;1.1.0\u0026#34;\n    ]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"相关问题\"\u003e相关问题\u003c/h3\u003e\n\u003cp\u003e1、如果没有在开发端 \u003ccode\u003e/etc/hosts\u003c/code\u003e 中添加 Docker Registry 所在主机IP地址和域名的对应关系，会报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@localhost tls]# docker push store.xdhuxc.com:5000/nginx:1.1.0\nThe push refers to a repository [store.xdhuxc.com:5000/nginx]\nGet https://store.xdhuxc.com:5000/v1/_ping: dial tcp: lookup store.xdhuxc.com on 192.168.91.2:53: no such host\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、此时，在浏览器中无法使用域名(store.xdhuxc.com)访问镜像仓库，也就是访问地址 \u003ccode\u003ehttps://store.xdhuxc.com:5000/v2/_catalog\u003c/code\u003e，将会出现 \u003ccode\u003e找不到 store.xdhuxc.com 的服务器 DNS 地址。\u003c/code\u003e，在Windows系统的 \u003ccode\u003eC:\\Windows\\System32\\drivers\\etc\\hosts\u003c/code\u003e中添加IP地址和域名的对应关系，便可以使用域名访问了；但是可以使用IP地址直接访问镜像仓库，访问地址为：\u003ccode\u003ehttps://192.168.91.128:5000/v2/_catalog\u003c/code\u003e，均需要输入正确的用户名和密码。\u003c/p\u003e\n\u003cp\u003e3、使用自签署的证书后，登录时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@store auth]# docker login store.xdhuxc.com:5000\nUsername: admin\nPassword: \nError response from daemon: Get https://store.xdhuxc.com:5000/v1/users/: x509: certificate signed by unknown authority (possibly because of \u0026#34;crypto/rsa: verification error\u0026#34; while trying to verify candidate authority certificate \u0026#34;store.xdhuxc.com\u0026#34;)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e可能是因为将自签署的CA证书放到了 \u003ccode\u003e/etc/pki/ca-trust/source/anchors/\u003c/code\u003e 目录下，然而，docker有自己的证书存放目录，路径为： \u003ccode\u003e/etc/docker/certs.d/\u003c/code\u003e。所以，将自签署的CA证书复制到开发端的 \u003ccode\u003e/etc/docker/certs.d\u003c/code\u003e 目录下，然后重启docker进程。\n另外，根据官方资料，可以在 \u003ccode\u003e/etc/docker/certs.d\u003c/code\u003e 目录下创建 \u003ccode\u003estore.xdhuxc.com:5000\u003c/code\u003e 目录，将CA证书复制到该目录下即可，无需重启docker进程。\u003c/p\u003e\n\u003ch3 id=\"使用nginx代理域名访问-docker-registry\"\u003e使用Nginx代理，域名访问 Docker Registry\u003c/h3\u003e\n\u003cp\u003e可以使用 \u003ccode\u003eNginx\u003c/code\u003e 为 \u003ccode\u003edocker\u003c/code\u003e 私有仓库做反向代理，以便使其可以在外网访问\u003c/p\u003e\n\u003cp\u003e启动 \u003ccode\u003eregistry\u003c/code\u003e 容器的命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -p 5000:5000 \\\n    -v /home/xdhuxc/registry:/var/lib/registry \\\n    --name=registry \\\n    registry:2.6.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e启动 \u003ccode\u003enginx\u003c/code\u003e 容器的命令为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker run -d \\\n    --privileged=true \\\n    -p 80:80 \\\n    -v /home/xdhuxc/nginx/conf:/etc/nginx \\\n    --name=nginx \\\n    nginx:1.13.7\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e\u003ccode\u003enginx\u003c/code\u003e 的配置为：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eserver {\n    listen       80;\n    server_name  dockerhub.yonyoucloud.com;\n\n    proxy_set_header Host $http_host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n    location / {\n        auth_basic off;\n\t    proxy_pass http://192.168.91.128:5000;\n    }\n\n    location /_ping {\n \n        auth_basic off;\n        proxy_pass http://192.168.91.128:5000;\n    }\n\t\n    location /v1/_ping/ {\n\t\n        auth_basic off;\n        proxy_pass http://192.168.91.128:5000;\n    }\n\n    # redirect server error pages to the static page /50x.html\n    #\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e为镜像打标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker tag docker.io/registry:2.6.2 dockerhub.yonyoucloud.com/registry:2.6.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e推送至私有镜像仓库\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker push dockerhub.yonyoucloud.com/registry:2.6.2\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e推送镜像时，报错如下：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eerror parsing HTTP 413 response body: invalid character \u0026#39;\u003cspan class=\"err\"\u003e\u0026lt;\u003c/span\u003e\u0026#39; looking for beginning of value: \u0026#34;\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\\r\\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e413 Request Entity Too Large\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003etitle\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehead\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\\r\\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e \u003cspan class=\"na\"\u003ebgcolor\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\\\u0026#34;\u003cspan class=\"s\"\u003ewhite\u003c/span\u003e\\\u0026#34;\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\\r\\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ecenter\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e413 Request Entity Too Large\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003eh1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ecenter\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\\r\\n\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ehr\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u0026lt;\u003c/span\u003e\u003cspan class=\"nt\"\u003ecenter\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003enginx/1.13.7\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ecenter\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\\r\\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ebody\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\\r\\n\u003cspan class=\"p\"\u003e\u0026lt;/\u003c/span\u003e\u003cspan class=\"nt\"\u003ehtml\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\\r\\n\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：\u003c/p\u003e\n\u003cp\u003e在 nginx.conf 中添加如下语句，重启 nginx 进程或容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eclient_max_body_size 0; \u003cspan class=\"ni\"\u003e#不限制上传大型镜像\u003c/span\u003e\nchunked_transfer_encoding on;  required to avoid HTTP 411: see Issue \u003cspan class=\"ni\"\u003e#1486\u003c/span\u003e (https://github.com/docker/docker/issues/1486)\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e/etc/docker目录下daemon.json的配置\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@xdhuxc docker]# cat daemon.json\n{\n\t\u0026#34;dns\u0026#34;:[\u0026#34;127.0.0.1\u0026#34;,\u0026#34;8.8.8.8\u0026#34;,\u0026#34;192.168.91.2\u0026#34;],\n\t\u0026#34;storage-driver\u0026#34;: \u0026#34;devicemapper\u0026#34;,\n\t\u0026#34;insecure-registries\u0026#34;: [\u0026#34;0.0.0.0/0\u0026#34;]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch2 id=\"参考资料\"\u003e参考资料\u003c/h2\u003e\n\u003cp\u003e1、https://docs.docker.com/registry/deploying/#basic-configuration\u003c/p\u003e\n\u003cp\u003e2、http://blog.csdn.net/gqtcgq/article/details/51163558\u003c/p\u003e\n\u003cp\u003e3、http://blog.csdn.net/dream_an/article/details/58005324\u003c/p\u003e\n\u003cp\u003e4、http://blog.csdn.net/qq245671051/article/details/69487321\u003c/p\u003e\n\u003cp\u003e5、http://blog.csdn.net/felix_yujing/article/details/51564739\u003c/p\u003e\n\u003cp\u003e6、http://blog.csdn.net/renhuailin/article/details/50461651\u003c/p\u003e","date":1499904000,"description":"","fuzzywordcount":3600,"kind":"page","lang":"zh","lastmod":1503187200,"objectID":"d5ec0e16cef0e9757f54bcc38d9bfb9b","publishdate":1499904000,"relpermalink":"/posts/docker/docker-original-registry/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了 Docker Registry 的搭建和配置。\u003c/p\u003e","tags":["Docker"],"title":"Docker Registry 的搭建和配置","url":"https://xdhuxc.github.io/posts/docker/docker-original-registry/","wordcount":3578},{"categories":"posts","content":"\u003cp\u003e本篇博客详细介绍了 Harbor 的安装，配置和使用过程。\u003c/p\u003e\n\u003ch3 id=\"安装环境\"\u003e安装环境\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCentOS 7，Minimal模式安装\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e1、Python 2.7 及以上版本\u003c/p\u003e\n\u003cp\u003e2、Docker engine 1.10 及以上版本\u003c/p\u003e\n\u003cp\u003e3、Docker Compose 1.6.0 及以上版本\u003c/p\u003e\n\u003ch3 id=\"安装配置\"\u003e安装配置\u003c/h3\u003e\n\u003cp\u003e1、从 \u003ccode\u003ehttps://github.com/vmware/harbor\u003c/code\u003e 上下载 \u003ccode\u003ehabor\u003c/code\u003e 的离线安装版并解压\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ewget https://github.com/vmware/harbor/releases/download/v1.2.2/harbor-offline-installer-v1.2.2.tgz\ntar -xvf harbor-offline-installer-v1.2.2.tgz\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、修改配置文件\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e修改habor.cfg，将hostname改为本机IP地址（192.168.244.135）和自定义端口号（8090）\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"gu\"\u003e## Harbor的配置文件\n\u003c/span\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e\n\u003cspan class=\"gh\"\u003e#The IP address or hostname to access admin UI and registry service.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e#DO NOT use localhost or 127.0.0.1, because Harbor needs to be accessed by external clients.\n\u003c/span\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003ehostname = 192.168.244.135:8090\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e修改docker-compose.yml，将 nginx 的代理端口映射由 \u003ccode\u003e80:80\u003c/code\u003e 改为 \u003ccode\u003e8090:80\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e  proxy:\n    image: vmware/nginx-photon:1.11.13\n    container_name: nginx\n    restart: always\n    volumes:\n      - ./common/config/nginx:/etc/nginx:z\n    networks:\n      - harbor\n    ports:\n      - 8090:80\n      - 443:443\n      - 4443:4443\n    depends_on:\n      - mysql\n      - registry\n      - ui\n      - log\n    logging:\n      driver: \u0026quot;syslog\u0026quot;\n      options:\n        syslog-address: \u0026quot;tcp://127.0.0.1:1514\u0026quot;\n        tag: \u0026quot;proxy\u0026quot;\nnetworks:\n  harbor:\n    external: false\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e3、初始化安装脚本和配置文件\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./prepare\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、执行安装脚本，使用root用户执行的，因为默认的模板中有很多文件目录权限只有root用户才有权限。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e./install.sh\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e5、访问，使用默认的用户名和密码：admin/Harbor12345\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehttp://192.168.244.135:8090\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch3 id=\"基本使用\"\u003e基本使用\u003c/h3\u003e\n\u003ch4 id=\"注意事项\"\u003e注意事项\u003c/h4\u003e\n\u003cp\u003e1、在 \u003ccode\u003eharbor.cfg\u003c/code\u003e 中将 \u003ccode\u003eself_registration\u003c/code\u003e 属性设置为 \u003ccode\u003eoff\u003c/code\u003e，那么普通用户将无法自己实现注册，只能由管理员创建用户，否则在页面上可以看到注册按钮。\u003c/p\u003e\n\u003cp\u003e2、只有项目管理员及开发人员的角色才可以 \u003ccode\u003epush\u003c/code\u003e 镜像，其他角色的人员只有 \u003ccode\u003epull\u003c/code\u003e 镜像的权限。\u003c/p\u003e\n\u003ch4 id=\"上传镜像到-habor-仓库\"\u003e上传镜像到 Habor 仓库\u003c/h4\u003e\n\u003cp\u003e1、登录到待上传镜像所在的主机，为待上传镜像打上标签，名称按照如下格式：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003ehabor_registry_ip_address[:port_number]/project_name/image_name[:tag]\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e使用如下命令登录时，出现了错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e[root@centos_1 ~]# docker login -u admin -p Habor12345 192.168.244.135:8090\nError response from daemon: Get https://192.168.244.135:8090/v1/users/: http: server gave HTTP response to HTTPS client\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：修改docker镜像所在主机的\u003ccode\u003e/etc/docker/daemon.json\u003c/code\u003e文件，在文件中增加如下内容：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e{\n        # 192.168.244.135：搭建的Registry所在主机IP地址\n        # 8090：搭建的Registry的端口号\n\t\u0026#34;insecure-registries\u0026#34;:[\u0026#34;192.168.244.135:8090\u0026#34;]\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e然后重新启动docker守护进程\u003c/p\u003e\n\u003cp\u003e登录时可能会报如下错误：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003eError response from daemon: Get http://192.168.244.135:8090/v2/: unauthorized: authentication required\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e解决：使用正确的用户名和密码登录，直接将密码写在命令行中\u003c/p\u003e\n\u003cp\u003e使用如下命令登录到 Habor registry\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker login -u admin -p Harbor12345 192.168.244.135:8090\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e1、为待上传镜像打上标签\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker tag docker.io/phpmyadmin/phpmyadmin:latest 192.168.244.135:8090/core/phpmyadmin:1.0.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、推送镜像到Habor Registry\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker push 192.168.244.135:8090/core/phpmyadmin:1.0.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003ch4 id=\"从-habor-仓库拉取镜像\"\u003e从 Habor 仓库拉取镜像\u003c/h4\u003e\n\u003cp\u003e使用命令直接拉取即可\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker pull 192.168.244.135:8090/core/phpmyadmin:1.0.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1499644800,"description":"","fuzzywordcount":900,"kind":"page","lang":"zh","lastmod":1503187200,"objectID":"e2bf0e2c5dee1255edd5efa09db47361","publishdate":1499644800,"relpermalink":"/posts/docker/docker-registry-harbor/","section":"posts","summary":"\u003cp\u003e本篇博客详细介绍了 Harbor 的安装，配置和使用过程。\u003c/p\u003e","tags":["Docker","Harbor"],"title":"Harbor 镜像仓库的安装和使用","url":"https://xdhuxc.github.io/posts/docker/docker-registry-harbor/","wordcount":861},{"categories":"posts","content":"\u003cp\u003e本篇博客整理了一些 docker 实用命令，包括一些组合命令，可以直接修改使用。\u003c/p\u003e\n\u003ch3 id=\"常用命令\"\u003e常用命令\u003c/h3\u003e\n\u003cp\u003e1、从容器里面复制文件或目录到本地的某个路径\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker cp nginx:/xdhuxc/a.html ./a.html\n或\ndocker cp 980cfa7fa636:/xdhuxc/a.html ./a.html\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、查看容器的root用户密码\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker logs nginx/980cfa7fa636 2\u0026gt;\u003cspan class=\"err\"\u003e\u0026amp;\u003c/span\u003e1 | grep \u0026#39;^User:\u0026#39;|tail -n1 \n\u003cspan class=\"gh\"\u003e# Docker容器启动时的root用户的密码是随机分配的。所以，通过这种方式就可以得到redmine容器的root用户的密码了\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、获取容器状态\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker inspect --format=\u0026#39;{{.State.Status}}\u0026#39; ffbb1145d1d7/nginx\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e4、获取容器的内部IP地址\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker inspect --format=\u0026#39;{{.NetworkSettins.IPAddress}}\u0026#39; ba24b244e370/redis\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003edocker images 默认隐藏了中间状态的镜像，可以使用 docker images -a 命令来查看中间状态的镜像。\u003c/p\u003e\n\u003cp\u003edocker history 命令可以查看该镜像中每一层的信息。\u003c/p\u003e\n\u003ch3 id=\"常用组合命令\"\u003e常用组合命令\u003c/h3\u003e\n\u003cp\u003e1、删除所有 docker 镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker ps -a | awk \u0026#39;NR \u0026gt; 1 { print $1 }\u0026#39; | xargs docker rm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e2、删除为 none 的镜像\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e docker images | grep none | awk \u0026#39;{ print $3 }\u0026#39;| xargs docker rmi -f\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003cp\u003e3、删除已经退出的docker容器\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003edocker ps -a|grep Exited|awk \u0026#39;{print $1}\u0026#39;|xargs docker rm\n\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e","date":1497744000,"description":"","fuzzywordcount":400,"kind":"page","lang":"zh","lastmod":1497744000,"objectID":"1693359c94dc9b66edf6259f0d07453e","publishdate":1497744000,"relpermalink":"/posts/docker/docker-practical-command/","section":"posts","summary":"\u003cp\u003e本篇博客整理了一些 docker 实用命令，包括一些组合命令，可以直接修改使用。\u003c/p\u003e","tags":["Docker"],"title":"Docker 实用命令总结","url":"https://xdhuxc.github.io/posts/docker/docker-practical-command/","wordcount":327}]